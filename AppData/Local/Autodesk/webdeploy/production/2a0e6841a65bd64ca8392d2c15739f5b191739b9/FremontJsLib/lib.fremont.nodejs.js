/*! For license information please see lib.fremont.prod.nodejs.js.LICENSE.txt */
!function(e){var t={};function __webpack_require__(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)__webpack_require__.d(n,r,function(t){return e[t]}.bind(null,r));return n},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=553)}([function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});var r=n(642);t.FDModelingSDK=r.FDModelingSDK;var o=n(148);t.Batch=o.Batch,t.WorkingSet=o.WorkingSet;var i=n(81);t.assetSchema=i.assetSchema,t.spaceSchema=i.spaceSchema,t.spaceCollectionSchema=i.spaceCollectionSchema,t.binaryAssetSchema=i.binaryAssetSchema,t.componentSchema=i.componentSchema,t.relationshipSchema=i.relationshipSchema,t.snapshotSchema=i.snapshotSchema;var s=n(1067);t.ForgeSchemaStore=s.ForgeSchemaStore;var a=n(14);t.Asset=a.Asset,t.AssetGraph=a.AssetGraph,t.BinaryAsset=a.BinaryAsset,t.Revision=a.Revision,t.Relationship=a.Relationship,t.Snapshot=a.Snapshot,t.Space=a.Space,t.SpaceCollection=a.SpaceCollection,t.Entity=a.Entity,t.AccessControlEntity=a.AccessControlEntity,__export(n(86));var c=n(30);t.JournalType=c.JournalType,t.LogLevel=c.LogLevel,t.RelationshipDirection=c.RelationshipDirection,t.TraversalAction=c.TraversalAction,t.INFINITE_DEPTH=c.INFINITE_DEPTH,t.SyncPriority=c.SyncPriority,t.SyncSelectorType=c.SyncSelectorType;var u=n(6);t.BatchResult=u.BatchResult,t.ClosureTraverser=u.ClosureTraverser,t.ClosureV2Traverser=u.ClosureV2Traverser,t.ConsoleLogger=u.ConsoleLogger,t.EntityIdentifier=u.EntityIdentifier,t.FiltersBuilder=u.FiltersBuilder,t.PermissionContextType=u.PermissionContextType,t.PermissionContextName=u.PermissionContextName;var l=n(2);t.CommandError=l.CommandError,t.NestedError=l.NestedError,t.ServerError=l.ServerError,t.InternalError=l.InternalError,t.SDKError=l.SDKError,t.SDKErrorCode=l.SDKErrorCode,__export(n(66));var d=n(396);t.combineChanges=d.combineChanges;var p=n(1069);t.AssetGraphDMCommandDefinitions=p.commands,t.AssetGraphDMQueryDefinitions=p.queries},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(404));t.schemaTypes=o,__export(n(1070)),__export(n(113)),__export(n(88)),__export(n(167)),__export(n(1071)),__export(n(233))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(736);t.RequestRunner=r.RequestRunner;var o=n(751);t.ServerError=o.ServerError;var i=n(752);t.CommandError=i.CommandError;var s=n(303);t.InternalError=s.InternalError;var a=n(145);t.SDKError=a.SDKError,t.SDKErrorCode=a.SDKErrorCode;var c=n(304);t.NestedError=c.NestedError},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(287));t.isString=e=>"string"==typeof e||e instanceof String,t.isDefined=e=>null!=e,t.isLength=e=>"number"==typeof e&&e>-1&&e%1==0&&e<=Number.MAX_SAFE_INTEGER,t.isArrayLike=e=>t.isDefined(e)&&"function"!=typeof e&&t.isLength(e.length),t.isObject=e=>t.isDefined(e)&&("object"==typeof e||"function"==typeof e||e instanceof Object),t.isEqual=(e,t)=>JSON.stringify(e)===JSON.stringify(t),t.isBoolean=e=>!0===e||!1===e,t.isNumber=e=>"number"==typeof e,t.isDateFormatString=e=>!isNaN(Date.parse(e)),t.chunk=function chunk(e,t){if(null==t||t<1)return[];const n=[],r=e.length;let o=0;for(;o<r;)n.push(e.slice(o,o+=t));return n},t.defaults=(e,t)=>{const n=Object.assign(t||{});return void 0!==e&&Object.entries(e).forEach(([e,t])=>{void 0!==t&&(n[e]=t)}),n},t.getLogger=function getLogger(e){const t=e._pimData.connectOptions;return t&&t.logger?t.logger:()=>{}},t.get=function get(e,t,n){return(e=e[(t=Array.isArray(t)?t:t.split("."))[0]])&&t.length>1?get(e,t.slice(1),n):void 0===e?n:e},t.retry=async(e,t,n)=>{n=Object.assign({retries:2,retryOn:e=>{if(e.innerError){if("ServerError"===e.innerError.name)return!0;if("sdk_server_error"===e.innerError.code)return!0;if("L7_GEN_DOWNSTREAM_ERROR"===e.innerError.code)return!0;if(e.innerError.code&&"L7_GEN_DOWNSTREAM_ERROR"===e.innerError.code.id)return!0}return!1}},n);const{retries:r,retryOn:i}=n;return await o.default(async(n,r)=>{try{return await e()}catch(e){if(!i||i(e,r)){if(t){const n=e.innerError?e.innerError.message:e.message;t(`Retry on error: ${n}, ${JSON.stringify(e,Object.getOwnPropertyNames(e))}`)}n(e)}throw e}},{retries:r})},t.createTimeLogger=function createTimeLogger(e){const t=e;let n;return e=>{n&&console.timeEnd(n),e&&(n=`${t} : ${e}`,console.time(n))}}},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(403)),__export(n(235)),__export(n(43)),__export(n(32)),__export(n(17)),__export(n(22)),__export(n(115)),__export(n(23)),__export(n(7)),__export(n(1113)),__export(n(9)),__export(n(1115)),__export(n(1118)),__export(n(488)),__export(n(1119)),__export(n(90)),__export(n(1120)),__export(n(70)),__export(n(27))},function(e,t,n){"use strict";var r=this&&this.__await||function(e){return this instanceof r?(this.v=e,this):new r(e)},o=this&&this.__asyncGenerator||function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,i=n.apply(e,t||[]),s=[];return o={},verb("next"),verb("throw"),verb("return"),o[Symbol.asyncIterator]=function(){return this},o;function verb(e){i[e]&&(o[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||resume(e,t)}))})}function resume(e,t){try{!function step(e){e.value instanceof r?Promise.resolve(e.value.v).then(fulfill,reject):settle(s[0][2],e)}(i[e](t))}catch(e){settle(s[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),s.shift(),s.length&&resume(s[0][0],s[0][1])}},i=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},verb("next"),verb("throw"),verb("return"),t[Symbol.asyncIterator]=function(){return this},t);function verb(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){(function settle(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,o,(t=e[n](t)).done,t.value)}))}}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(0),a=n(6),c=n(517),u=n(8),l=n(1209),d=n(244),p=n(71),h=n(44),m=n(91),y=n(529),g=n(174),_={},v={},E={};let I=0,b="not synched",S="";t.setCachedEntityInitStatus=async function setCachedEntityInitStatus(e,t,n,r){const o=t.clientId+":"+t.serverUrl+":"+e.spaceCollectionId+":"+u.PIM_ENTITY_INIT_STATUS_KEY+":"+n;if(!n)throw new Error("getCachedEntityInitStatus() -> invalid entityUrn: "+n);r?v[o]=r:delete v[o]};const C=[{type:{name:u.PIM_DESIGN_ASSETS_TYPENAME}},{type:{name:u.PIM_DOCUMENTATION_ASSETS_TYPENAME}},{type:{name:u.PIM_DRAWING_ASSETS_TYPENAME}},{type:{name:u.PIM_MODEL_ASSETS_TYPENAME}},{type:{name:u.PIM_PRODUCT_ASSETS_TYPENAME}},{type:{name:u.PIM_SHEETS_ASSETS_TYPENAME}}],w=[{type:{name:u.PIM_MILESTONE_ASSETS_TYPENAME}},{type:{name:u.PIM_RELEASE_ASSETS_TYPENAME}}];async function fullDocumentSync(e,t,n,r){const o=p.createTimeLogger("FullDocumentSync with root asset Id = "+a.extractId(r.asset));o("Closure Query");const i={startAssets:[r],relationshipFilters:[{direction:"IN",type:{name:u.PIM_CONTAINS_RELATIONSHIP_TYPENAME}},{direction:"OUT",type:{name:u.PIM_CONTAINS_RELATIONSHIP_TYPENAME}},{direction:"OUT",type:{name:u.PIM_ASSEMBLYREF_RELATIONSHIP_TYPENAME}},{direction:"OUT",type:{name:u.PIM_DESCRIBES_RELATIONSHIP_TYPENAME}},{direction:"IN",type:{name:u.PIM_USE_RELATIONSHIP_TYPENAME}}],assetFilters:[...C,...w],maxDepth:0};E[n]&&await E[n],o("Sync By Closure");const c=s.AssetGraph.syncByClosure(e,t,i,{priority:++I}).then(()=>{delete E[n]}).catch(e=>{throw delete E[n],e});return E[n]=c,o(),c}function getContextHash(e,t){return t.clientId+":"+t.serverUrl+":"+e.spaceCollectionId}function getSDKInstance(e,t){const n=getContextHash(e,t);if(!_[n]||_[n].options===t)return _[n]}async function initSDKs(e,t){const n=getContextHash(e,t);if(getSDKInstance(e,t))throw new Error("Another SDK instance exists for that key");const r=new y.JournalService;await r.initSDK(e,t);const o={serverUrl:t.serverUrl,commandServerUrl:t.commandServerUrl,getToken:async function(){if(t.expiryTimeEpochSec>(new Date).getTime()/1e3)throw console.warn(`[getBearerToken]: Bearer token for clientId ${t.clientId} has expired.`),new Error("Token expired");return t.bearerToken},logger:console.info,journalSDK:r.getSdk(),schemasVersion:u.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0},i=await s.FDModelingSDK.initializeWithPIM(o);if(r.getSdk().setAutoSynchronizationMode(e.spaceCollectionId,{autoPull:!1,autoSynchronize:!1}),t.pimStateService.isJournalReorderingEnabled()&&e.spaceCollectionId){const t=(await i.getJournals().list(e.spaceCollectionId)).isolationJournals;let n=!1;for(let e of t)if(e.properties[p.JournalTagNames.LAYOUT]!==p.JOURNAL_TAG_LAYOUT.CHAIN){n=!0;break}n&&await Promise.all(t.map(async t=>{const n=await i.getJournals().getIsolated(e.spaceCollectionId,t.journalId);await p.deleteJournal(n,r.getSdk())}))}const a=await async function assignContextHash(e,t,n,r,o){return _[e]={options:n,spaceCollectionId:t.spaceCollectionId,pimsdk:r,journalService:o,rpcQueue:l.queue(h.executeWorker),fremontCommands:[]},_[e]}(n,e,t,i,r);return await async function setupDatabase(e,t){const{spaceCollectionId:n}=e,{options:r}=t,o=r.messageService;console.info("Starting synchronization for space-collection "+n),b="synching",o.sendSyncStatus(d.SyncStatus.STARTED);try{const e=await t.pimsdk.getJournals().getMain(n);await e.rebase({selector:{type:s.SyncSelectorType.SPACES,parameters:{spaces:[]}}})}catch(i){return console.log(`Synchronization for space collection ${n} failed: ${i.message}`),b="error",S=`Space Collection Sync Failed: ${i.message}, SC=${n}, stack = ${i.stack}`,r.pimStateService.getSpaceCollection(n).setEnabled("ok",!1,i.message),o.sendSyncStatus(d.SyncStatus.FAILED),void t.journalService.handleJournalSyncError(e,r)}console.info(`Initial synchronization for space collection ${n} succeeded`),b="synched",o.sendSyncStatus(d.SyncStatus.COMPLETED)}(e,a),a}let A;async function getPIMSDK(e,t){for(;A;)await A;return A=(async()=>async function _getPIMSDK(e,t){const n=getSDKInstance(e,t);return n?n.pimsdk.getNewInstanceExperimental():(await initSDKs(e,t),_getPIMSDK(e,t))}(e,t).finally(()=>{A=void 0}))()}async function getRemotePimSDK(e,t){const getBearerToken=async function(){return await m.validateToken(t.bearerToken,t.expiryTimeEpochSec)},n=Object.assign({server:t.serverUrl,getBearerToken:getBearerToken},u.DEFAULT_JOURNALING_CONFIGURATION),r=new c.NoJournalingSDK(n),o=Object.assign({serverUrl:t.serverUrl,commandServerUrl:t.commandServerUrl,getToken:getBearerToken,journalSDK:r,schemasVersion:u.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0},t);return await s.FDModelingSDK.initializeWithPIM(o)}function getJournalQueue(e,t,n,i){return o(this,arguments,(function*getJournalQueue_1(){const o=e.getJournals();let s=n;do{const e=(yield r(o.list(t))).isolationJournals.filter(e=>{if(e.parentJournalId!==s)return!1;return e.properties[p.JournalTagNames.LAYOUT]?i===e.properties[p.JournalTagNames.LAYOUT]:i===p.JOURNAL_TAG_LAYOUT.TREE});if(e.length>1)throw new Error("[getJournalQueue] Inconsistent journal order for space collection "+t);if(e.length<=0)break;const n=e[0];yield yield r({journalId:n.journalId,properties:n.properties}),s=n.journalId}while(void 0!==s)}))}t.fullDocumentSync=fullDocumentSync,t.getDocumentSyncFromLineage=function getDocumentSyncFromLineage(e){return E[e]},t.documentRootSync=async function documentRootSync(e,t,n){const r=p.createTimeLogger("RootDocumentSync with root asset Id = "+a.extractId(n));r("Closure Query");const o={startAssets:[{asset:n}],relationshipFilters:[{direction:"OUT",type:{name:u.PIM_CONTAINS_RELATIONSHIP_TYPENAME}}],assetFilters:C,maxDepth:1};r("Sync By Closure");const i=await s.AssetGraph.syncByClosure(e,t,o,{priority:++I});return r(),i},t.synchronizeLineage=async function synchronizeLineage(e,t,n,r){const o=await e.pimFindRootItemAndVersionSnapshot(t,r);if(void 0!==o)return fullDocumentSync(e,t,n,{asset:o.rootItem,snapshotContext:o.snapshot});console.info(`[onPostUpload]: Cannot find root item for versionUrn ${r} after publish. Something wrong happened.`)},t.synchronizeSpaces=async function synchronizeSpaces(e,t,n){const r=await e.getJournals().getMain(t);await r.rebase({selector:{type:s.SyncSelectorType.SPACES,parameters:{spaces:n}}})},t.getCachedEntityInitStatus=async function getCachedEntityInitStatus(e,t,n){if(!n)throw new Error("getCachedEntityInitStatus() -> invalid entityUrn: "+n);const r=t.clientId+":"+t.serverUrl+":"+e.spaceCollectionId+":"+u.PIM_ENTITY_INIT_STATUS_KEY+":"+n;return v[r]},t.getPermanentIds=async function getPermanentIds(e,t,n){let r;const o=t.getEntityStore();try{r=o.getEntityIds(a.extractId(n))}catch(e){r={entityLocalId:a.extractId(n)}}return r},t.getSDKInstance=getSDKInstance,t.initSDKs=initSDKs,t.getJournalService=async function getJournalService(e,t){const n=getContextHash(e,t);if(_[n]&&_[n].journalService)return _[n].journalService;throw new Error("JournalService not set")},t.getSdkList=function getSdkList(){return _},t.getSynchStatus=function getSynchStatus(){return b+S},t.disposeSDKInstance=async function disposeSDKInstance(e){const t=e.journalService;try{await t.getSdk().dispose()}catch(e){console.warn("An error occured while disposing l7, ignoring",e)}for(const t in _)_[t]===e&&delete _[t]},t.selectJournal=async function selectJournal(e,t){const n=e.pimsdk.getJournals(),r=await(t===s.JournalType.MAIN?n.getMain(e.spaceCollectionId):n.getRemote(e.spaceCollectionId));return e.pimsdk.getNewInstanceExperimental({journalMappings:{collections:{[e.spaceCollectionId]:await r.getId()}}})},t.getPIMSDK=getPIMSDK,t.getRemotePimSDK=getRemotePimSDK,t.getSpaceCollectionStateAppropriatePimSDK=async function getSpaceCollectionStateAppropriatePimSDK(e,t){return t.pimStateService.isSpaceCollectionEnabled(e.spaceCollectionId)?await getPIMSDK(e,t):getRemotePimSDK(0,t)},t.getOrCreateSdkInstance=async function getOrCreateSdkInstance(e,t){await getPIMSDK(e,t);const n=getSDKInstance(e,t);if(void 0===n)throw new Error("[getOrCreateSdkInstance]: Cannot find existing SDKInstance");return n},t.getJournalQueue=getJournalQueue;t.listJournalQueue=async function listJournalQueue(e,t){var n,r,o,s;const a=await getPIMSDK(e,t),c=a.getJournals(),l=e.spaceCollectionId;if(t.pimStateService.isJournalReorderingEnabled()){const e=["Journal ID","Layout","Invariant ID","Root product name","Local file version","Document type"],t=[],o=(await c.getMain(l)).getId();try{for(var d,h=i(getJournalQueue(a,l,o,p.JOURNAL_TAG_LAYOUT.CHAIN));!(d=await h.next()).done;){const e=d.value,n=a.getNewInstanceExperimental({journalMappings:{collections:{[l]:e.journalId}}}),r=await n.getJournals().get(l),o=await p.getRootItemInIsolationJournal(r),i=await n.getAsset(o||"",l);let s="(Unknown)",c="(Unknown)";if(u.getFamilyFromTypeid(i.getTypeId()).family===u.PIM_FAMILY.PRODUCT){s=n.pimGetComponentProxy(i,u.ComponentKeys.PART_NUMBER).partNumber,c="Design"}else if(u.getFamilyFromTypeid(i.getTypeId()).family===u.PIM_FAMILY.DOCUMENTATION){const e=await n.pimGetDrawingFromDocumentation(l,i);s=(null==e?void 0:e.getAttribute(u.AttributeKeys.DRAWING_NAME))||"(Unknown)",c="Drawing"}t.push([e.journalId,e.properties[p.JournalTagNames.LAYOUT],e.properties[p.JournalTagNames.INVARIANT_ID],s,e.properties[p.JournalTagNames.LOCAL_FILE_VERSION],c])}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=h.return)&&await r.call(h)}finally{if(n)throw n.error}}return g.formatTable(e,t)}{let e="";const t=(await c.getMain(l)).getId();console.log("Main journal: "+t);const{isolationJournals:n}=await c.list(l),r=n.filter(e=>e.parentJournalId===t&&e.properties[p.JournalTagNames.LAYOUT]!==p.JOURNAL_TAG_LAYOUT.CHAIN),u=["Journal ID","Layout","Local file version"];for(const t of r){e+=`designInvariant ${t.properties.invariantId}\n`;const n=[[t.journalId,t.properties[p.JournalTagNames.LAYOUT]||p.JOURNAL_TAG_LAYOUT.TREE,t.properties.localFileVersion]];try{for(var m,y=i(getJournalQueue(a,l,t.journalId,p.JOURNAL_TAG_LAYOUT.TREE));!(m=await y.next()).done;){const e=m.value;n.push([e.journalId,e.properties[p.JournalTagNames.LAYOUT]||p.JOURNAL_TAG_LAYOUT.TREE,e.properties[p.JournalTagNames.LOCAL_FILE_VERSION]])}}catch(e){o={error:e}}finally{try{m&&!m.done&&(s=y.return)&&await s.call(y)}finally{if(o)throw o.error}}e+=g.formatTable(u,n)+"\n"}return e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(700));var r=n(712);t.AssetsConverter=r.AssetsConverter;var o=n(713);t.AttributeConverter=o.AttributeConverter;var i=n(753);t.PolicyConverter=i.PolicyConverter;var s=n(754);t.BatchResult=s.BatchResult;var a=n(755);t.BatchResultBuilder=a.BatchResultBuilder;var c=n(146);t.extractId=c.extractId;var u=n(756);t.isNode=u.isNode;var l=n(757);t.ModelRegistry=l.ModelRegistry;var d=n(758);t.RequestBuilder=d.RequestBuilder;var p=n(761);t.RequestTools=p.RequestTools;var h=n(762);t.QueryRequestParamsBuilder=h.QueryRequestParamsBuilder;var m=n(102);t.FiltersBuilder=m.FiltersBuilder;var y=n(305);t.toSortingString=y.toSortingString;var g=n(307);t.FileHelper=g.FileHelper;var _=n(306);t.AUTH_PROVIDER=_.AUTH_PROVIDER;var v=n(763);t.CommandParametersAdapter=v.CommandParametersAdapter;var E=n(764);t.throwServerErrorIfNecessary=E.throwServerErrorIfNecessary;var I=n(308);t.EntityIdentifier=I.EntityIdentifier;var b=n(765);t.ClosureTraverser=b.ClosureTraverser;var S=n(1018);t.ClosureV2Traverser=S.ClosureV2Traverser;var C=n(1019);t.extractIdOrReference=C.extractIdOrReference;var w=n(386);t.isSerializableCommands=w.isSerializableCommands;var A=n(1020);t.PermissionContextType=A.PermissionContextType,t.PermissionContextName=A.PermissionContextName;var O=n(1021);t.PermissionContextConverter=O.PermissionContextConverter;var P=n(151);t.withSpan=P.withSpan;var D=n(220);t.isChangeSet=D.isChangeSet;var x=n(310);t.befriend=x.befriend;var R=n(1022);t.chunkObject=R.chunkObject;var N=n(1023);t.extractCollectionIdFromUrl=N.extractCollectionIdFromUrl},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(68),i=n(112);t.failIfExistsOnSDK=function failIfExistsOnSDK(e){Array.isArray(e)||(e=[e]);for(const t of e)if(t in r.FDModelingSDK.prototype)throw new i.PimError(o.GEN_INITIALIZATION_ERROR,`Property ${t} already injected on FDModelingSDK (multiple versions of PIM?)`)},t.validateBatchResult=function validateBatchResult(e){const t=e.getErrors();if(t.length>0)throw new i.PimError(o.SERVER_ERROR,"L2 Errors: "+t.map(e=>e.error.message).join("\n"))},t.validateRequestResult=function validateRequestResult(e){const t=e.errors||[];if(t.length>0)throw new i.PimError(o.SERVER_ERROR,"L2 Errors: "+t.map(e=>e.message).join("\n"))},t.getSkipCommit=function getSkipCommit(e){return void 0!==e&&void 0!==e.skipCommit&&e.skipCommit}},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),n(637),__export(n(10)),__export(n(18)),__export(n(1177)),__export(n(172)),__export(n(168)),__export(n(1)),__export(n(4)),__export(n(172)),__export(n(514)),__export(n(1190)),__export(n(515)),__export(n(493))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(3),i=n(22),s=n(403);async function toSnapshot(e,t,n,r){if(!o.isString(n)&&r&&r.fetch&&!n.isFetched()&&await n.fetch(),o.isString(n)){const o=r&&r.fetch||!1;n=await e.getSnapshot(n,t,{fetch:o})}return n}t.toSpaceCollection=async function toSpaceCollection(e,t,n){if(!o.isString(t)&&n&&n.fetch&&!t.isFetched()&&await t.fetch(),o.isString(t)){const r=n&&n.fetch||!1;t=await e.getSpaceCollection(t,{fetch:r})}return t},t.toRelationship=async function toRelationship(e,t,n,r){if(!o.isString(n)&&r&&r.fetch&&!n.isFetched()&&await n.fetch(),o.isString(n)){const o=r&&r.fetch||!1;n=await e.getRelationship(n,t,{fetch:o})}return n},t.toSnapshot=toSnapshot,t.toAsset=async function toAsset(e,t,n,a){if(n instanceof r.Asset&&n.isNewResource())return n;const c=i.extractId(n);let u;if(a&&a.snapshot){const n=await toSnapshot(e,t,a.snapshot,{fetch:!0}),r=(await s.listSnapshotAssets(n)).find(e=>e.id===c);r&&(u=r.revisionId)}if(o.isString(n)||u&&n.getRevisionId()!==u){const r=a&&a.fetch||!1;n=await e.getAsset(c,t,{fetch:r,revisionId:u})}else a&&a.fetch&&!n.isFetched()&&await n.fetch();return n}},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(487)),__export(n(114)),__export(n(1116)),__export(n(237)),__export(n(1117))},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("util")},function(e,t,n){(function(e){var n="[object Map]",r="[object Set]",o=/^\[object .+?Constructor\]$/,i="object"==typeof global&&global&&global.Object===Object&&global,s="object"==typeof self&&self&&self.Object===Object&&self,a=i||s||Function("return this")(),c=t&&!t.nodeType&&t,u=c&&"object"==typeof e&&e&&!e.nodeType&&e,l=u&&u.exports===c;var d,p=Function.prototype,h=Object.prototype,m=a["__core-js_shared__"],y=(d=/[^.]+$/.exec(m&&m.keys&&m.keys.IE_PROTO||""))?"Symbol(src)_1."+d:"",g=p.toString,_=h.hasOwnProperty,v=h.toString,E=RegExp("^"+g.call(_).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),I=l?a.Buffer:void 0,b=h.propertyIsEnumerable,S=I?I.isBuffer:void 0,C=function overArg(e,t){return function(n){return e(t(n))}}(Object.keys,Object),w=getNative(a,"DataView"),A=getNative(a,"Map"),O=getNative(a,"Promise"),P=getNative(a,"Set"),D=getNative(a,"WeakMap"),x=!b.call({valueOf:1},"valueOf"),R=toSource(w),N=toSource(A),M=toSource(O),L=toSource(P),j=toSource(D);function baseIsNative(e){return!(!isObject(e)||function isMasked(e){return!!y&&y in e}(e))&&(isFunction(e)||function isHostObject(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?E:o).test(toSource(e))}function getNative(e,t){var n=function getValue(e,t){return null==e?void 0:e[t]}(e,t);return baseIsNative(n)?n:void 0}var k=function baseGetTag(e){return v.call(e)};function toSource(e){if(null!=e){try{return g.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function isArguments(e){return function isArrayLikeObject(e){return function isObjectLike(e){return!!e&&"object"==typeof e}(e)&&isArrayLike(e)}(e)&&_.call(e,"callee")&&(!b.call(e,"callee")||"[object Arguments]"==v.call(e))}(w&&"[object DataView]"!=k(new w(new ArrayBuffer(1)))||A&&k(new A)!=n||O&&"[object Promise]"!=k(O.resolve())||P&&k(new P)!=r||D&&"[object WeakMap]"!=k(new D))&&(k=function(e){var t=v.call(e),o="[object Object]"==t?e.constructor:void 0,i=o?toSource(o):void 0;if(i)switch(i){case R:return"[object DataView]";case N:return n;case M:return"[object Promise]";case L:return r;case j:return"[object WeakMap]"}return t});var F=Array.isArray;function isArrayLike(e){return null!=e&&function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!isFunction(e)}var U=S||function stubFalse(){return!1};function isFunction(e){var t=isObject(e)?v.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function isEmpty(e){if(isArrayLike(e)&&(F(e)||"string"==typeof e||"function"==typeof e.splice||U(e)||isArguments(e)))return!e.length;var t=k(e);if(t==n||t==r)return!e.size;if(x||function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||h)}(e))return!C(e).length;for(var o in e)if(_.call(e,o))return!1;return!0}}).call(this,n(34)(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(143);t.AccessControlEntity=r.AccessControlEntity;var o=n(387);t.Asset=o.Asset;var i=n(1048);t.AssetGraph=i.AssetGraph;var s=n(144);t.Entity=s.Entity;var a=n(1050);t.BinaryAsset=a.BinaryAsset;var c=n(1053);t.Revision=c.Revision;var u=n(1054);t.Relationship=u.Relationship;var l=n(394);t.Snapshot=l.Snapshot;var d=n(228);t.Space=d.Space;var p=n(1060);t.SpaceCollection=p.SpaceCollection,function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(66))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MSG={OVERWRITING_ID:"PF-001: Id already exists: ",ID_CHANGE_FOR_PROPERTY_WITH_PARENT:"PR-004: Cannot change the ID of a property that has a parent. Could not change id: ",UNKNOWN_CONTEXT_SPECIFIED:"PF-009: Unknown context specified: ",UNKNOWN_TYPEID_SPECIFIED:"PF-010: Unknown typeid specified: ",NON_EXISTING_TYPEID:"PF-011: Missing template for the property you entered or one of the templates it inherits from: ",FIELD_TYPEID_IS_REQUIRED:'PF-043: Field "typeid" is required. It is the "typeid" of the resulting PropertySets Template.',OVERRIDDING_INHERITED_TYPES:"PF-057: Overriding of inherited typed properties is not allowed: ",TYPED_VALUES_MUST_DERIVE_FROM_BASE_TYPE:"PF-061: Typed values must be derived from base type: ",ENUM_TYPEID_MISSING:"PF-046: Enum: typeid missing",ENUM_VALUE_NOT_NUMBER:"PF-047: Enum: value must be a number. This is not valid: ",TYPED_VALUES_FOR_PRIMITIVES_NOT_SUPPORTED:"PF-068: Primitive types does not support typedValues: ",TYPEID_IS_NOT_ENUM:"PF-069: The provided type does not inherit from Enum: ",ONLY_ONE_CREATION_TYPE:"PF-070: A schema can only inherit from one creation type: ",OVERRIDEN_PROP_MUST_HAVE_SAME_FIELD_VALUES_AS_BASE_TYPE:"PF-071:  Overridden properties must have same ",DOT_AT_END:"PR-013: ResolvePath error: Encountered a dot at the end of path: ",DOTS_IN_SQUARE_BRACKETS:"PR-014: ResolvePath error: Encountered a dot within a square bracket. These have to be escaped. Error in path: ",INVALID_END_OF_SQUARE_BRACKETS:'PR-016: ResolvePath error: Square brackets have to be followed either by "." or by "[" or by "*". Error in path: ',UNCLOSED_BRACKETS:"PR-017: ResolvePath error: Unclosed brackets at the end of path: ",PROPERTY_ALREADY_EXISTS:"PR-006: The property already exists in this collection: ",INSERTED_EXISTING_ENTRY:"PR-007: Inserted an already existing entry: ",REMOVED_NON_EXISTING_ENTRY:"PR-008: Trying to remove a non-existing entry: ",MODIFY_NON_EXISTING_ENTRY:"PR-009: Trying to modify a not existing entry: ",INSERTED_ENTRY_WITH_PARENT:"PR-010: Trying to insert into a collection a property that already has a parent.",EMPTY_TOKEN:"PR-011: ResolvePath error: Encountered empty token in path: ",QUOTES_WITHIN_TOKEN:"PR-012: ResolvePath error: Quotes must only be at the start and the end of a path. Error in path: ",MISSING_DOT_AT_SEGMENT_START:"PR-015: Missing . or [ at segment start in path: ",CLOSING_BRACKET_WITHOUT_OPENING:"PR-018: ResolvePath error: Encountered closing bracket without corresponding opening one in path: ",INVALID_ESCAPE_SEQUENCE:"PR-019: Encountered an invalid escape sequence in path: ",UNCLOSED_QUOTATION_MARKS:"PR-020: ResolvePath error: Encountered unclosed quotation marks in path: ",ADDED_CHILD_WITHOUT_ID:"PR-022: Added child without id.",NO_PATHS_FOR_NON_PRIMITIVE_ARRAYS:"PR-023: Path resolution is not supported for primitive type arrays.",GET_PATH_SEGMENT_CALLED_FOR_NON_ENTRY:"PR-025: Internal error: _getPathSegmentForChildNode has been called for an entry that is not an entry of the collection. ",NO_NORMALIZED_CHANGESET:"PR-026: deserialize was called with a non-normalized ChangeSet.",REMOVING_NON_EXISTING_KEY:"PR-033: Trying to remove something that does not exist: ",START_OFFSET_INVALID:"PR-036: ArrayProperty: insert range - Start offset is invalid: ",CANNOT_REMOVE_WITH_DIFFERENT_PARENT:"PR-038: Internal error: Trying to remove from an array a property that has not the array as parent.",START_OFFSET_NEGATIVE:"PR-039: ArrayProperty: Modify range - Start offset cannot be negative: ",NOT_NUMBER:"PR-049: This parameter must be a number: parameter: ",IN_ARRAY_NOT_ARRAY:"PR-051: Parameter error: in_array must be an array for method: ",IN_RADIX_MUST_BE_NUMBER:"PR-055: Integer64Property.toString parameter: in_radix must be a number. This is not valid: ",IN_STRING_MUST_BE_STRING:"PR-056: Integer64Property.fromString parameter: in_string must be a string. This is not valid: ",IN_RADIX_BETWEEN_2_36:"PR-057: Integer64Property.fromString parameter: in_radix must be a number between 2 and 36. This is not valid: ",NOT_A_PROPERTY:"PR-059: NodeProperty.insert parameter is not a property. The property you passed is not a valid property.",NO_INSERT_WITH_PARENT:"PR-088: Internal error: Trying to insert a property into an array or string that already has a parent.",IN_POSITION_MUST_BE_NUMBER:"PR-093: in_position must be a number. This is not valid: ",SET_OUT_OF_BOUNDS:"PR-107: Trying to set out of bounds. ",SET_VALUES_PATH_PROPERTY:"PR-115: trying to set value to a path leading to a property: ",SET_VALUES_PATH_INVALID:"PR-116: trying to set value to an invalid path: ",ID_STRING_OR_NUMBER:"PR-119: id should be a string or a number. This is not valid: ",DESERIALIZE_EMPTY_CHANGESET:"PR-121: ValueProperty.deserialize() called on an empty changeset",INT_64_NON_INT64_TYPE:"PR-122: Tried to use (u)Int64MapProperty or (u)Int64ArrayProperty with an invalid type.",BASE_OUT_OF_RANGE:"PR-123: Base is out of range. Base should be in range [2,36]. This is not valid: ",CANNOT_UPDATE_TO_NEGATIVE:"PR-124: Cannot update value to negative: ",CANNOT_PARSE_INVALID_CHARACTERS:"PR-125: Cannot parse. String contains invalid characters: ",UNKNOWN_ENUM:"PR-028: enum value unknown: ",MODIFICATION_OF_CONSTANT_PROPERTY:"PR-140: Modifications of constants are not allowed.",NONVALUE_MAP_INSERT_PROP:"PR-161: In a map of properties, you can only insert properties.",ID_SHOULD_NOT_BE_EMPTY_STRING:"PR-179: id should not be an empty string.",VALUE_STRING_OR_NUMBER:"PR-181: in_value should be a string or a number. This is not valid: ",ARRAY_SET_ONE_ELEMENT:"PR-182: in_value should be a single element. This is not valid: ",INSERTED_IN_OWN_CHILDREN:"PR-185: Trying to insert a property in itself or in one of its children.",CANT_REMOVE_STATIC_CHILDREN:"PR-190: Can't remove static children.",DELTA_ON_PRIMITIVE_NOT_SUPPORTED:"PR-191: Apply changeset on non-properties is not supported.",TYPEID_NOT_DEFINED:"TH-001: extractVersion requires a typeid parameter",TYPEID_NOT_NATIVE:"TH-002: Passed in typeid is not a native type",REMOVING_NON_EXISTING_ID:"PR-001: Removing non existing id: ",BOOLEAN_NON_BOOL_VALUE:'PR-192: Tried to set a boolean value with a value not interpretable as "true" or "false"',ARRAY_INSERT_FORBIDDEN_IN_DEGRADED_MODE:"PR-192: Tried to insert into an array in degraded mode.",ARRAY_ACCESSOR_ON_NON_ARRAY:'PF-Cannot use "[]" to access non-array properties.',EMPTY_PATH:"Cannot resolve empty path.",DEREFERENCING_NOT_SUPPORTED:"Dereferencing properties is not supported.",UNKNOWN_PATH:"Cannot resolve unknown path: ",INVALID_PATH_IN_REFERENCE:"UT-001: References may only contain absolute repository references or empty strings",REVERSIBLE_CHANGESET_NOT_SUPPORTED:"Reversible ChangeSet are not supported.",INVALID_TYPEID_SPECIFIED:"Invalid typeid specified: ",MISSING_SCHEMA_NO_ANCESTOR_PRESENT:"Schema is not registered and no valid ancestor of this schema were found to run in degraded mode: "},t.BREAK_TRAVERSAL="BREAK",t.PROPERTY_PATH_DELIMITER=".",function(e){e[e.ALWAYS=0]="ALWAYS",e[e.NO_LEAFS=1]="NO_LEAFS",e[e.NEVER=2]="NEVER"}(t.REFERENCE_RESOLUTION||(t.REFERENCE_RESOLUTION={})),function(e){e[e.CLEAN=0]="CLEAN",e[e.PENDING_CHANGE=1]="PENDING_CHANGE",e[e.DIRTY=2]="DIRTY"}(t.MODIFIED_STATE_FLAGS||(t.MODIFIED_STATE_FLAGS={})),function(e){e.ROOT="ROOT",e.REF="REF",e.UP="UP"}(t.PATH_TOKENS||(t.PATH_TOKENS={}))},function(e,t){e.exports=require("crypto")},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(68)),__export(n(112))},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(89)),__export(n(234))},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(737),t),o(n(738),t),o(n(739),t),o(n(740),t)},function(e,t,n){"use strict";const r=n(46),o=n(16),i=n(11),s=n(1320),a=n(1321),c={};t.deepEqual=s,t.clone=function(e,n={},r=null){if("object"!=typeof e||null===e)return e;const o=r||new Map,i=o.get(e);if(i)return i;let s,a=!1;const u=Array.isArray(e);if(u)s=[],a=!0;else if(Buffer.isBuffer(e))s=Buffer.from(e);else if(e instanceof Date)s=new Date(e.getTime());else if(e instanceof RegExp)s=new RegExp(e);else if(!1!==n.prototype){const t=Object.getPrototypeOf(e);t&&t.isImmutable?s=e:(s=Object.create(t),a=!0)}else s={},a=!0;if(o.set(e,s),a){const r=c.keys(e,n);for(let i=0;i<r.length;++i){const a=r[i];if(u&&"length"===a)continue;const c=Object.getOwnPropertyDescriptor(e,a);c&&(c.get||c.set)?Object.defineProperty(s,a,c):Object.defineProperty(s,a,{enumerable:!c||c.enumerable,writable:!0,configurable:!0,value:t.clone(e[a],n,o)})}u&&(s.length=e.length)}return s},c.keys=function(e,t={}){return t.symbols?Reflect.ownKeys(e):Object.getOwnPropertyNames(e)},t.merge=function(e,n,r,o){if(t.assert(e&&"object"==typeof e,"Invalid target value: must be an object"),t.assert(null==n||"object"==typeof n,"Invalid source value: must be null, undefined, or an object"),!n)return e;if(Array.isArray(n)){t.assert(Array.isArray(e),"Cannot merge array onto an object"),!1===o&&(e.length=0);for(let r=0;r<n.length;++r)e.push(t.clone(n[r]));return e}const i=c.keys(n);for(let s=0;s<i.length;++s){const a=i[s];if("__proto__"===a||!Object.prototype.propertyIsEnumerable.call(n,a))continue;const c=n[a];c&&"object"==typeof c?!e[a]||"object"!=typeof e[a]||Array.isArray(e[a])!==Array.isArray(c)||c instanceof Date||Buffer.isBuffer(c)||c instanceof RegExp?e[a]=t.clone(c):t.merge(e[a],c,r,o):(null!=c||!1!==r)&&(e[a]=c)}return e},t.applyToDefaults=function(e,n,r){if(t.assert(e&&"object"==typeof e,"Invalid defaults value: must be an object"),t.assert(!n||!0===n||"object"==typeof n,"Invalid options value: must be true, falsy or an object"),!n)return null;const o=t.clone(e);return!0===n?o:t.merge(o,n,!0===r,!1)},t.cloneWithShallow=function(e,n,r){if(!e||"object"!=typeof e)return e;const o=c.store(e,n),i=t.clone(e,r);return c.restore(i,e,o),i},c.store=function(e,n){const r=new Map;for(let o=0;o<n.length;++o){const i=n[o],s=t.reach(e,i);"object"!=typeof s&&"function"!=typeof s||(r.set(i,s),c.reachSet(e,i,void 0))}return r},c.restore=function(e,t,n){for(const[r,o]of n)c.reachSet(e,r,o),c.reachSet(t,r,o)},c.reachSet=function(e,t,n){const r=Array.isArray(t)?t:t.split(".");let o=e;for(let e=0;e<r.length;++e){const t=r[e];e+1===r.length&&(o[t]=n),o=o[t]}},t.applyToDefaultsWithShallow=function(e,n,r){if(t.assert(e&&"object"==typeof e,"Invalid defaults value: must be an object"),t.assert(!n||!0===n||"object"==typeof n,"Invalid options value: must be true, falsy or an object"),t.assert(r&&Array.isArray(r),"Invalid keys"),!n)return null;const o=t.cloneWithShallow(e,r);if(!0===n)return o;const i=c.store(n,r);return t.merge(o,n,!1,!1),c.restore(o,n,i),o},t.intersect=function(e,t,n){if(!e||!t)return n?null:[];const r=[],o=Array.isArray(e)?new Set(e):e,i=new Set;for(const e of t)if(c.has(o,e)&&!i.has(e)){if(n)return e;r.push(e),i.add(e)}return n?null:r},c.has=function(e,t){return"function"==typeof e.has?e.has(t):void 0!==e[t]},t.contain=function(e,n,r={}){let o,i,s=null;if("object"!=typeof e||"object"!=typeof n||Array.isArray(e)||Array.isArray(n))n=[].concat(n);else{s=n;const e=Object.getOwnPropertySymbols(n).filter(Object.prototype.propertyIsEnumerable.bind(n));n=[...Object.keys(n),...e]}if(t.assert("string"==typeof e||"object"==typeof e,"Reference must be string or an object"),t.assert(n.length,"Values array cannot be empty"),r.deep){o=t.deepEqual;const e=r.hasOwnProperty("only"),n=r.hasOwnProperty("part");i={prototype:e?r.only:!!n&&!r.part,part:e?!r.only:!!n&&r.part}}else o=(e,t)=>e===t;let a=!1;const u=new Array(n.length);for(let e=0;e<u.length;++e)u[e]=0;if("string"==typeof e){let r="(";for(let e=0;e<n.length;++e){const o=n[e];t.assert("string"==typeof o,"Cannot compare string reference to non-string value"),r+=(e?"|":"")+t.escapeRegex(o)}const o=new RegExp(r+")","g");a=!!e.replace(o,(e,t)=>{const r=n.indexOf(t);return++u[r],""})}else if(Array.isArray(e)){const t=!(!r.only||!r.once);if(t&&e.length!==n.length)return!1;for(let r=0;r<e.length;++r){let s=!1;for(let a=0;a<n.length&&!1===s;++a)t&&0!==u[a]||(s=o(n[a],e[r],i)&&a);!1!==s?++u[s]:a=!0}}else{const t=c.keys(e,r);for(let r=0;r<t.length;++r){const c=t[r],l=n.indexOf(c);if(-1!==l){if(s&&!o(s[c],e[c],i))return!1;++u[l]}else a=!0}}if(r.only&&(a||!r.once))return!a;let l=!1;for(let e=0;e<u.length;++e)if(l=l||!!u[e],r.once&&u[e]>1||!r.part&&!u[e])return!1;return l},t.flatten=function(e,n){const r=n||[];for(let n=0;n<e.length;++n)Array.isArray(e[n])?t.flatten(e[n],r):r.push(e[n]);return r},t.reach=function(e,n,r){if(!1===n||null==n)return e;"string"==typeof(r=r||{})&&(r={separator:r});const o=Array.isArray(n);t.assert(!o||!r.separator,"Separator option no valid for array-based chain");const i=o?n:n.split(r.separator||".");let s=e;for(let e=0;e<i.length;++e){let o=i[e];if(Array.isArray(s)){const e=Number(o);Number.isInteger(e)&&e<0&&(o=s.length+e)}if(!s||"object"!=typeof s&&"function"!=typeof s||!(o in s)||"object"!=typeof s&&!1===r.functions){t.assert(!r.strict||e+1===i.length,"Missing segment",o,"in reach path ",n),t.assert("object"==typeof s||!0===r.functions||"function"!=typeof s,"Invalid segment",o,"in reach path ",n),s=r.default;break}s=s[o]}return s},t.reachTemplate=function(e,n,r){return n.replace(/{([^}]+)}/g,(n,o)=>{const i=t.reach(e,o,r);return null==i?"":i})},t.assert=function(e,...n){if(e)return;if(1===n.length&&n[0]instanceof Error)throw n[0];const o=n.filter(e=>""!==e).map(e=>"string"==typeof e?e:e instanceof Error?e.message:t.stringify(e));throw new r.AssertionError({message:o.join(" ")||"Unknown error",actual:!1,expected:!0,operator:"==",stackStartFunction:t.assert})},t.Bench=function(){this.ts=0,this.reset()},t.Bench.prototype.reset=function(){this.ts=t.Bench.now()},t.Bench.prototype.elapsed=function(){return t.Bench.now()-this.ts},t.Bench.now=function(){const e=process.hrtime();return 1e3*e[0]+e[1]/1e6},t.escapeRegex=function(e){return e.replace(/[\^\$\.\*\+\-\?\=\!\:\|\\\/\(\)\[\]\{\}\,]/g,"\\$&")},t.escapeHeaderAttribute=function(e){return t.assert(/^[ \w\!#\$%&'\(\)\*\+,\-\.\/\:;<\=>\?@\[\]\^`\{\|\}~\"\\]*$/.test(e),"Bad attribute value ("+e+")"),e.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')},t.escapeHtml=function(e){return a.escapeHtml(e)},t.escapeJson=function(e){return a.escapeJson(e)},t.once=function(e){if(e._hoekOnce)return e;let t=!1;const wrapped=function(...n){t||(t=!0,e(...n))};return wrapped._hoekOnce=!0,wrapped},t.ignore=function(){},t.uniqueFilename=function(e,t){t=t?"."!==t[0]?"."+t:t:"",e=i.resolve(e);const n=[Date.now(),process.pid,o.randomBytes(8).toString("hex")].join("-")+t;return i.join(e,n)},t.stringify=function(...e){try{return JSON.stringify.apply(null,e)}catch(e){return"[Cannot display object: "+e.message+"]"}},t.wait=function(e){return new Promise(t=>setTimeout(t,e))},t.block=function(){return new Promise(t.ignore)}},function(e,t){e.exports=require("fs")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(17);async function fetchUrnVersionPairs(e,t,n,r){return Promise.all(n.map(n=>{const{urn:i,revisionId:s}=n,a={fetch:!0,revisionId:s};let c;switch(r){case"Relationship":c=e.getRelationship(i,t,a);break;case"Asset":c=e.getAsset(i,t,a);break;case"Snapshot":c=e.getSnapshot(i,t,a);break;case"AssetGraph":c=e.getSpace(i,t,a);break;case"SpaceCollection":c=e.getSpaceCollection(i,a);break;default:throw new o.PimError(o.GEN_INVALID_INPUT,"Unknown source type "+r)}return c}))}t.getAllPages=async function getAllPages(e,t,n){const r=[];for(;(null==n||r.length<n)&&await e.nextPage();){const o=e.getPage(),i=o[t].call(o);if(n){const e=Math.min(i.length,n-r.length);r.push(...i.slice(0,e))}else r.push(...i)}return r},t.fetchUrnVersionPairs=fetchUrnVersionPairs,t.fetchUrns=async function fetchUrns(e,t,n,r){return fetchUrnVersionPairs(e,t,n.map(e=>({urn:e})),r)},t.convertSchemaForL8=function convertSchemaForL8(e){let t=JSON.stringify(e,null,2);return t.includes("autodesk.data:asset-1.0.0")&&(t=t.replace(/autodesk.data:asset-1.0.0/g,r.assetTypeId)),t.includes("Enum")&&(t=t.replace(/Enum/g,"NodeProperty")),JSON.parse(t)},t.extractId=function extractId(e){if(void 0===e)return"";if(e instanceof r.Entity)try{return e.getId()}catch(e){return""}return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(43);t.populateEntity=function populateEntity(e,t){if(r.createMissingComponents(e),t){if(t.components){const n=Object.keys(t.components);for(const o of n)r.setComponent(e,o,t.components[o])}if(t.attributes){const n=Object.keys(e.getAttributes()),r=Object.keys(t.attributes);for(const o of r)t.attributes[o].value&&(n.includes(o)?e.updateAttribute(o,t.attributes[o].value):e.createAttribute(o,t.attributes[o].typeid,t.attributes[o].value))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(218);t.isLocalContext=r.isLocalContext;var o=n(979);t.processQueryResults=o.processQueryResults;var i=n(980);t.processCommandResults=i.processCommandResults;var s=n(981);t.processSingleBatchResults=s.processSingleBatchResults;var a=n(982);t.storePermanentId=a.storePermanentId;var c=n(983);t.updateRewriteIds=c.updateRewriteIds;var u=n(984);t.mergeChangeSets=u.mergeChangeSets;var l=n(109);t.OfflineEntityWrapper=l.OfflineEntityWrapper;var d=n(986);t.OfflineRevisionWrapper=d.OfflineRevisionWrapper},function(e,t,n){const r=n(135),{MAX_LENGTH:o,MAX_SAFE_INTEGER:i}=n(134),{re:s,t:a}=n(77),c=n(136),{compareIdentifiers:u}=n(187);class SemVer{constructor(e,t){if(t=c(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>o)throw new TypeError(`version is longer than ${o} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?s[a.LOOSE]:s[a.FULL]);if(!n)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<i)return t}return e}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],o=e.prerelease[t];if(r("prerelease compare",t,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return u(n,o)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const n=this.build[t],o=e.build[t];if(r("prerelease compare",t,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return u(n,o)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this}}e.exports=SemVer},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(55)),__export(n(230));var r=n(1038);t.Registrator=r.Registrator},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(487);t.addAdditionalInfo=function addAdditionalInfo(e,t,n){e&&0!=e.length&&t&&e.forEach(e=>{if(t.createdBy&&e.addAdditionalInfo("createdBy",t.createdBy),t.lastModifiedBy&&e.addAdditionalInfo("lastModifiedBy",t.lastModifiedBy),n){const t=(new Date).toISOString();e.createAttribute(r.AttributeKeys.ADDITIONAL_CREATE_TIME,"String",t)}})}},function(e,t,n){"use strict";var r=n(313),o=Object.prototype.toString;function isArray(e){return"[object Array]"===o.call(e)}function isUndefined(e){return void 0===e}function isObject(e){return null!==e&&"object"==typeof e}function isPlainObject(e){if("[object Object]"!==o.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function isFunction(e){return"[object Function]"===o.call(e)}function forEach(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),isArray(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:isArray,isArrayBuffer:function isArrayBuffer(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:function isBuffer(e){return null!==e&&!isUndefined(e)&&null!==e.constructor&&!isUndefined(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function isFormData(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function isArrayBufferView(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function isString(e){return"string"==typeof e},isNumber:function isNumber(e){return"number"==typeof e},isObject:isObject,isPlainObject:isPlainObject,isUndefined:isUndefined,isDate:function isDate(e){return"[object Date]"===o.call(e)},isFile:function isFile(e){return"[object File]"===o.call(e)},isBlob:function isBlob(e){return"[object Blob]"===o.call(e)},isFunction:isFunction,isStream:function isStream(e){return isObject(e)&&isFunction(e.pipe)},isURLSearchParams:function isURLSearchParams(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function isStandardBrowserEnv(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:forEach,merge:function merge(){var e={};function assignValue(t,n){isPlainObject(e[n])&&isPlainObject(t)?e[n]=merge(e[n],t):isPlainObject(t)?e[n]=merge({},t):isArray(t)?e[n]=t.slice():e[n]=t}for(var t=0,n=arguments.length;t<n;t++)forEach(arguments[t],assignValue);return e},extend:function extend(e,t,n){return forEach(t,(function assignValue(t,o){e[o]=n&&"function"==typeof t?r(t,n):t})),e},trim:function trim(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function stripBOM(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},function(e,t){e.exports=require("events")},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(702)),__export(n(704)),__export(n(706));var r=n(708);t.RelationshipDirection=r.RelationshipDirection;var o=n(709);t.TIP_REVISION=o.TIP_REVISION;var i=n(710);t.TraversalAction=i.TraversalAction,t.INFINITE_DEPTH=i.INFINITE_DEPTH},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetClosureV2QueryName="closureQuery",t.CreateAssetCommandName="CreateAsset",t.UpdateAssetCommandName="UpdateAsset",t.DeleteAssetCommandName="DeleteAsset",t.PurgeAssetCommandName="PurgeAsset",t.RestoreAssetCommandName="RestoreAsset",t.MoveAssetBatchCommandName="MoveAssetBatch",t.CopyAssetCommandName="CopyAsset",t.GetAssetQueryName="getAsset",t.GetAssetAtRevisionQueryName="getAssetAtRevision",t.GetAssetsQueryName="getAssets",t.GetAssetRevisionsQueryName="getAssetRevisions",t.UploadBinaryAssetCommandName="UploadBinaryAsset",t.CompleteUploadCommandName="CompleteUpload",t.CreateCollectionCommandName="CreateCollection",t.UpdateCollectionCommandName="UpdateCollection",t.DeleteCollectionCommandName="DeleteCollection",t.PurgeCollectionCommandName="PurgeCollection",t.RestoreCollectionCommandName="RestoreCollection",t.GetCollectionQueryName="getCollection",t.CreateRelationshipCommandName="CreateRelationship",t.UpdateRelationshipCommandName="UpdateRelationship",t.DeleteRelationshipCommandName="DeleteRelationship",t.PurgeRelationshipCommandName="PurgeRelationship",t.RestoreRelationshipCommandName="RestoreRelationship",t.GetRelationshipQueryName="getRelationship",t.GetRelationshipsQueryName="getRelationships",t.GetRelationshipRevisionsQueryName="getRelationshipRevisions",t.CreateSnapshotCommandName="CreateSnapshot",t.UpdateSnapshotCommandName="UpdateSnapshot",t.DeleteSnapshotCommandName="DeleteSnapshot",t.PurgeSnapshotCommandName="PurgeSnapshot",t.RestoreSnapshotCommandName="RestoreSnapshot",t.AddAssetsToSnapshotCommandName="AddAssetsToSnapshot",t.RemoveAssetsFromSnapshotCommandName="RemoveAssetsFromSnapshot",t.GetSnapshotQueryName="getSnapshot",t.GetSnapshotsQueryName="getSnapshots",t.GetAssetsInSnapshotQueryName="getAssetsInSnapshot",t.CreateSpaceCommandName="CreateSpace",t.UpdateSpaceCommandName="UpdateSpace",t.DeleteSpaceCommandName="DeleteSpace",t.PurgeSpaceCommandName="PurgeSpace",t.RestoreSpaceCommandName="RestoreSpace",t.MoveSpaceBatchCommandName="MoveSpaceBatch",t.CopySpaceCommandName="CopySpace",t.RefreshPoliciesCommandName="RefreshSpacePolicies",t.GetSpaceQueryName="getSpace",t.GetSpacesQueryName="getSpaces",t.GetSpaceRevisionsQueryName="getSpaceRevisions"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0);t.BATCH_LIMIT=50,t.DEFAULT_MAX_COMMANDS_IN_PARALLEL=300,t.MAX_COMMANDS_IN_ONE_COMPONENT=10,t.PIMServiceAccessPolicyId="PIMServiceAccess",t.DefaultPermissionContext={name:r.PermissionContextName.PIM_CONTEXT,type:r.PermissionContextType.WIP_URN},t.L7_RETRY_CODES=[401,409,429,500,501,502,503],t.L7_RETRY_ERRORS=["ECONNABORTED","ETIMEDOUT","ECONNRESET","EINTR","EAGAIN","EBUSY","EADDRINUSE","ENOBUFS","ENOTCONN","ECONNREFUSED","EHOSTDOWN","EHOSTUNREACH","ENETRESET","ENETUNREACH"],t.L7_RETRY_COUNT=10,t.COMMAND_POLL_ATTEMPTS=1e6,t.COMMAND_POLL_INTERVAL=100,t.DEFAULT_JOURNALING_CONFIGURATION={commandPollingAttempts:t.COMMAND_POLL_ATTEMPTS,commandPollingInterval:t.COMMAND_POLL_INTERVAL,clientConfig:{retries:t.L7_RETRY_COUNT,retryCodes:t.L7_RETRY_CODES,retryErrors:t.L7_RETRY_ERRORS,keepAlive:!0,timeout:3e4}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(69);t.getFamily=e=>r.getFamilyFromTypeid(e.getTypeId()).family},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(76)),i=r(n(60)),s=r(n(75)),a=n(79),c=n(15),u={Uint32:new Uint32Array(1),Uint16:new Uint16Array(1),Uint8:new Uint8Array(1),Int32:new Int32Array(1),Int16:new Int16Array(1),Int8:new Int8Array(1),Float32:new Float32Array(1),Float64:new Float64Array(1)},_simpleCastFunctor=function(e,t){return e[0]=t,e[0]},stringToInt=function(e,t=10,n){if(!o.default(e))throw new Error(c.MSG.IN_STRING_MUST_BE_STRING+e);if(!i.default(t))throw new Error(c.MSG.IN_RADIX_BETWEEN_2_36+t);if(t<2||36<t)throw new Error(c.MSG.BASE_OUT_OF_RANGE+t);const r=e.trim();let s=0,u=!1,l=0,d=0;if("-"===r[0]&&(u=!0,++s),u&&!n)throw new Error(c.MSG.CANNOT_UPDATE_TO_NEGATIVE+e);for(;s<r.length;){const n=parseInt(r[s++],t);if(isNaN(n))throw new Error(c.MSG.CANNOT_PARSE_INVALID_CHARACTERS+e);d=d*t+n,l=l*t+Math.floor(d/4294967296),d%=4294967296}return u&&(l=~l,d?d=4294967296-d:++l),n?new a.Int64(d,l):new a.Uint64(d,l)};t._castFunctors={Uint64:function(e,t=10){if(e instanceof a.Uint64)return e;if("string"==typeof e)return stringToInt(e,t,!1);if("number"==typeof e)return stringToInt(String(e),t,!1);if(s.default(e)&&2===e.length)return new a.Uint64(e[0],e[1]);throw new Error(c.MSG.INT_64_NON_INT64_TYPE+" , value: "+e)},Uint32:_simpleCastFunctor.bind(void 0,u.Uint32),Uint16:_simpleCastFunctor.bind(void 0,u.Uint16),Uint8:_simpleCastFunctor.bind(void 0,u.Uint8),Int64:function(e,t=10){if(e instanceof a.Int64)return e;if("string"==typeof e)return stringToInt(e,t,!0);if("number"==typeof e)return stringToInt(String(e),t,!0);if(s.default(e)&&2===e.length)return new a.Int64(e[0],e[1]);throw new Error(c.MSG.INT_64_NON_INT64_TYPE+" , value: "+e)},Int32:_simpleCastFunctor.bind(void 0,u.Int32),Int16:_simpleCastFunctor.bind(void 0,u.Int16),Int8:_simpleCastFunctor.bind(void 0,u.Int8),Float32:_simpleCastFunctor.bind(void 0,u.Float32),Float64:_simpleCastFunctor.bind(void 0,u.Float64),String:e=>String(e),Boolean:function(e){if("boolean"==typeof e)return e;if("string"==typeof e){if("true"===e||"1"===e)return!0;if("false"===e||"0"===e)return!1}else if("number"==typeof e)return!!e;throw new Error(c.MSG.BOOLEAN_NON_BOOL_VALUE+" , value: "+e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);t.validateUserState=function validateUserState(e){if(!e)throw new r.InternalError("userState has not been properly initialized. Make sure a property factory was injected in the definitions")}},function(e,t){e.exports=require("http")},function(e,t,n){const r=n(25);e.exports=(e,t,n)=>new r(e,n).compare(new r(t,n))},function(e,t,n){class Range{constructor(e,t){if(t=o(t),e instanceof Range)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Range(e.raw,t);if(e instanceof i)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter(e=>!isNullSet(e[0])),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&isAny(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=`parseRange:${Object.keys(this.options).join(",")}:${e}`,n=r.get(t);if(n)return n;const o=this.options.loose,a=o?c[u.HYPHENRANGELOOSE]:c[u.HYPHENRANGE];e=e.replace(a,hyphenReplace(this.options.includePrerelease)),s("hyphen replace",e),e=e.replace(c[u.COMPARATORTRIM],l),s("comparator trim",e,c[u.COMPARATORTRIM]),e=(e=(e=e.replace(c[u.TILDETRIM],d)).replace(c[u.CARETTRIM],p)).split(/\s+/).join(" ");const h=o?c[u.COMPARATORLOOSE]:c[u.COMPARATOR],m=e.split(" ").map(e=>parseComparator(e,this.options)).join(" ").split(/\s+/).map(e=>replaceGTE0(e,this.options)).filter(this.options.loose?e=>!!e.match(h):()=>!0).map(e=>new i(e,this.options)),y=(m.length,new Map);for(const e of m){if(isNullSet(e))return[e];y.set(e.value,e)}y.size>1&&y.has("")&&y.delete("");const g=[...y.values()];return r.set(t,g),g}intersects(e,t){if(!(e instanceof Range))throw new TypeError("a Range is required");return this.set.some(n=>isSatisfiable(n,t)&&e.set.some(e=>isSatisfiable(e,t)&&n.every(n=>e.every(e=>n.intersects(e,t)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new a(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(testSet(this.set[t],e,this.options))return!0;return!1}}e.exports=Range;const r=new(n(662))({max:1e3}),o=n(136),i=n(138),s=n(135),a=n(25),{re:c,t:u,comparatorTrimReplace:l,tildeTrimReplace:d,caretTrimReplace:p}=n(77),isNullSet=e=>"<0.0.0-0"===e.value,isAny=e=>""===e.value,isSatisfiable=(e,t)=>{let n=!0;const r=e.slice();let o=r.pop();for(;n&&r.length;)n=r.every(e=>o.intersects(e,t)),o=r.pop();return n},parseComparator=(e,t)=>(s("comp",e,t),e=replaceCarets(e,t),s("caret",e),e=replaceTildes(e,t),s("tildes",e),e=replaceXRanges(e,t),s("xrange",e),e=replaceStars(e,t),s("stars",e),e),isX=e=>!e||"x"===e.toLowerCase()||"*"===e,replaceTildes=(e,t)=>e.trim().split(/\s+/).map(e=>replaceTilde(e,t)).join(" "),replaceTilde=(e,t)=>{const n=t.loose?c[u.TILDELOOSE]:c[u.TILDE];return e.replace(n,(t,n,r,o,i)=>{let a;return s("tilde",e,t,n,r,o,i),isX(n)?a="":isX(r)?a=`>=${n}.0.0 <${+n+1}.0.0-0`:isX(o)?a=`>=${n}.${r}.0 <${n}.${+r+1}.0-0`:i?(s("replaceTilde pr",i),a=`>=${n}.${r}.${o}-${i} <${n}.${+r+1}.0-0`):a=`>=${n}.${r}.${o} <${n}.${+r+1}.0-0`,s("tilde return",a),a})},replaceCarets=(e,t)=>e.trim().split(/\s+/).map(e=>replaceCaret(e,t)).join(" "),replaceCaret=(e,t)=>{s("caret",e,t);const n=t.loose?c[u.CARETLOOSE]:c[u.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(t,n,o,i,a)=>{let c;return s("caret",e,t,n,o,i,a),isX(n)?c="":isX(o)?c=`>=${n}.0.0${r} <${+n+1}.0.0-0`:isX(i)?c="0"===n?`>=${n}.${o}.0${r} <${n}.${+o+1}.0-0`:`>=${n}.${o}.0${r} <${+n+1}.0.0-0`:a?(s("replaceCaret pr",a),c="0"===n?"0"===o?`>=${n}.${o}.${i}-${a} <${n}.${o}.${+i+1}-0`:`>=${n}.${o}.${i}-${a} <${n}.${+o+1}.0-0`:`>=${n}.${o}.${i}-${a} <${+n+1}.0.0-0`):(s("no pr"),c="0"===n?"0"===o?`>=${n}.${o}.${i}${r} <${n}.${o}.${+i+1}-0`:`>=${n}.${o}.${i}${r} <${n}.${+o+1}.0-0`:`>=${n}.${o}.${i} <${+n+1}.0.0-0`),s("caret return",c),c})},replaceXRanges=(e,t)=>(s("replaceXRanges",e,t),e.split(/\s+/).map(e=>replaceXRange(e,t)).join(" ")),replaceXRange=(e,t)=>{e=e.trim();const n=t.loose?c[u.XRANGELOOSE]:c[u.XRANGE];return e.replace(n,(n,r,o,i,a,c)=>{s("xRange",e,n,r,o,i,a,c);const u=isX(o),l=u||isX(i),d=l||isX(a),p=d;return"="===r&&p&&(r=""),c=t.includePrerelease?"-0":"",u?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&p?(l&&(i=0),a=0,">"===r?(r=">=",l?(o=+o+1,i=0,a=0):(i=+i+1,a=0)):"<="===r&&(r="<",l?o=+o+1:i=+i+1),"<"===r&&(c="-0"),n=`${r+o}.${i}.${a}${c}`):l?n=`>=${o}.0.0${c} <${+o+1}.0.0-0`:d&&(n=`>=${o}.${i}.0${c} <${o}.${+i+1}.0-0`),s("xRange return",n),n})},replaceStars=(e,t)=>(s("replaceStars",e,t),e.trim().replace(c[u.STAR],"")),replaceGTE0=(e,t)=>(s("replaceGTE0",e,t),e.trim().replace(c[t.includePrerelease?u.GTE0PRE:u.GTE0],"")),hyphenReplace=e=>(t,n,r,o,i,s,a,c,u,l,d,p,h)=>`${n=isX(r)?"":isX(o)?`>=${r}.0.0${e?"-0":""}`:isX(i)?`>=${r}.${o}.0${e?"-0":""}`:s?">="+n:`>=${n}${e?"-0":""}`} ${c=isX(u)?"":isX(l)?`<${+u+1}.0.0-0`:isX(d)?`<${u}.${+l+1}.0-0`:p?`<=${u}.${l}.${d}-${p}`:e?`<${u}.${l}.${+d+1}-0`:"<="+c}`.trim(),testSet=(e,t,n)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(s(e[n].semver),e[n].semver!==i.ANY&&e[n].semver.prerelease.length>0){const r=e[n].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class BaseDataArray{constructor(e,t,n){this.buffer=new e(n),this.bufferConstructor=e,this.castFunctor=t,this.size=n}get length(){return this.size}getValue(e){if((e=void 0===e?0:e)>=this.size||e<0)throw new Error("Trying to access out of bounds!");return this.buffer[e]}getValueRange(e,t){if(e>=this.size||t>this.size||e<0||t<0)throw new Error("Trying to access out of bounds!");return this.buffer.subarray(e,t)}serialize(){const e=new Array(this.size);for(let t=0;t<this.size;t++)e[t]=this.buffer[t];return e}deserialize(e){const t=e,n=e.length;n!==this.size&&(this.resize(n),this.size=n);for(let e=0;e<n;e++)this.buffer[e]=t[e]}setValue(e,t){if(!(e<this.buffer.length))throw new Error("DataArray setValue idx is out of bounds.");this.buffer[e]=this.castFunctor(t)}removeRange(e,t){if(!(e+t<this.buffer.length+1))throw new Error("DataArray removeRange offset + deleteCount is out of bounds.");this.buffer=this._removeElementsFromArray(this.buffer,e,t),this.size=this.size-t}insertRange(e,t){const n=new Array(t.length);for(let e=0;e<t.length;e++)n[e]=this.castFunctor(t[e]);this.buffer=this._insert(this.buffer,e,n),this.size=this.size+n.length}set(e=0,t){if(t instanceof Array||t instanceof this.getBufferCtor())this.buffer.set(t,e);else{if(!(t instanceof BaseDataArray))throw new Error("DataArray set() must be called with Array, TypedArray or DataArray");this.buffer.set(t.getBuffer(),e)}}push(e){const t=this.buffer.length;this.size>t-1&&this._alloc(2*this.size||1),this.setValue(this.size,e),this.size++}getBuffer(){return this.buffer}getBufferCtor(){return this.bufferConstructor}iterate(e){const t=this.size;for(let n=0;n<t;n++)e(this.buffer[n])}copy(){const e=new this.bufferConstructor(this.size);return e.set(this.buffer),e}resize(e){return this._alloc(e),this.size=e,this}_insert(e,t,n){const r=this.size+n.length,o=new e.constructor(r);return o.set(e.subarray(0,t)),o.set(n,t),o.set(e.subarray(t,this.size),t+n.length),o}_removeElementsFromArray(e,t,n){const r=this.size-n,o=new e.constructor(r);return o.set(e.subarray(0,t)),o.set(e.subarray(t+n,this.size),t),o}_alloc(e){return this.buffer=resizeBuffer(this.bufferConstructor,this.buffer,e),this}}t.BaseDataArray=BaseDataArray;const resizeBuffer=function(e,t,n){const r=new e(n),o=t,i=t.length>n;return r.set(i?o.subarray(0,n):o),r}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.propagation=t.metrics=t.trace=t.context=void 0,o(n(791),t),o(n(792),t),o(n(323),t),o(n(793),t),o(n(324),t),o(n(325),t),o(n(794),t),o(n(795),t),o(n(796),t),o(n(797),t),o(n(798),t),o(n(799),t),o(n(800),t),o(n(326),t),o(n(327),t),o(n(801),t),o(n(802),t),o(n(803),t),o(n(804),t),o(n(805),t),o(n(806),t),o(n(807),t),o(n(328),t),o(n(330),t),o(n(331),t),o(n(808),t),o(n(809),t),o(n(810),t),o(n(811),t),o(n(812),t),o(n(813),t),o(n(814),t),o(n(815),t),o(n(329),t),o(n(816),t),o(n(817),t),o(n(818),t);var i=n(149);Object.defineProperty(t,"Context",{enumerable:!0,get:function(){return i.Context}});var s=n(333);t.context=s.ContextAPI.getInstance();var a=n(824);t.trace=a.TraceAPI.getInstance();var c=n(825);t.metrics=c.MetricsAPI.getInstance();var u=n(826);t.propagation=u.PropagationAPI.getInstance(),t.default={trace:t.trace,metrics:t.metrics,context:t.context,propagation:t.propagation}},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(114),o=n(18),i=n(1),s=n(113),a=n(68),c=n(112),u=n(486),l=n(69),d=n(3);function getComponent(e,t){const n=e.getComponent(t);if(!n)throw new c.PimError(a.GEN_COMPONENT_NOT_FOUND,`Component ${t} not found in object`);return{typeid:n.getTypeid(),value:n.getValues()}}function setComponent(e,t,n){let r;if(e.listComponents().includes(t)){const o=getComponent(e,t);if(r=function difference(e,t){return function changes(e,t){const n=Array(),r=Object.keys(e);for(const o of r)d.isEqual(e[o],t[o])||(d.isArrayLike(e[o])?n[o]=e[o]:n[o]=d.isObject(e[o])&&d.isObject(t[o])?changes(e[o],t[o]):e[o]);return n}(e,t)}(n.value,o.value),0===Object.keys(r).length)return}else r=n.value;let o=e.getComponent(t);if(void 0===o){if(void 0===n.typeid)throw new c.PimError(a.GEN_MISSING_TYPEID,"Missing typeid in component value");o=e.createComponent(t,n.typeid)}else if(o.getTypeid()!==n.typeid&&void 0!==n.typeid)throw new c.PimError(a.GEN_INVALID_TYPEID,"Cannot update a component with a new typeid");o.setValues(r)}function isSoftDeleted(e){try{const t=getComponent(e,r.ComponentKeys.DELETE_STATUS);return t&&t.value.modelComponent||!1}catch(e){return!1}}function isFileSoftDeleted(e){try{const t=getComponent(e,r.ComponentKeys.DELETE_STATUS);return t&&t.value.file||!1}catch(e){return!1}}function isFileUnsupported(e){try{const t=getComponent(e,r.ComponentKeys.DELETE_STATUS);return t&&t.value.unsupported||!1}catch(e){return!1}}t.createMissingComponents=function createMissingComponents(e){const t=l.parseTypeId(i.schemaTypes.Data_Component_V1_0_0.typeid);if(!t)throw new c.PimError(a.GEN_INVALID_INPUT,"Internal Schema Consistency Error");const n=e.listComponents(),r={family:t.family};u.iterateSchemaInheritanceTree(e.getTypeId(),t=>{const i=o.schemaManager.getSchema(t);if(i&&i.properties)for(const t of i.properties)n.includes(t.id)||u.schemaInheritsFrom(t.typeid,r)&&(e.createComponent(t.id,t.typeid),n.push(t.id))})},t.getComponent=getComponent,t.setComponent=setComponent,t.isSoftDeleted=isSoftDeleted,t.isFileSoftDeleted=isFileSoftDeleted,t.isFileUnsupported=isFileUnsupported,t.removeDeleteStatus=function removeDeleteStatus(e){try{const t=getComponent(e,r.ComponentKeys.DELETE_STATUS);!t||t.value.file||t.value.modelComponent||t.value.unsupported||e.removeComponent(r.ComponentKeys.DELETE_STATUS)}catch(e){return}},t.softDeleteEntity=function softDeleteEntity(e,t){isSoftDeleted(e)||setComponent(e,r.ComponentKeys.DELETE_STATUS,{typeid:t,value:{modelComponent:!0}})},t.restoreEntity=function restoreEntity(e,t){!0===isSoftDeleted(e)&&(setComponent(e,r.ComponentKeys.DELETE_STATUS,{typeid:t,value:{modelComponent:!1}}),!1===isFileSoftDeleted(e)&&!1===isFileUnsupported(e)&&e.removeComponent(r.ComponentKeys.DELETE_STATUS))},t.snapshotComponent=function snapshotComponent(e){e.snapshotComponentTypeid||(e.snapshotComponentTypeid=o.getFamilyTypeId(s.PIM_COMPONENT_FAMILY.SNAPSHOT,s.PIM_DEFAULT_SCHEMAS_VERSION));const t=(new Date).toISOString(),n={};return void 0!==e.createTime?n.createTime=new Date(e.createTime).toISOString():n.createTime=t,void 0!==e.lastModifiedTime&&(n.lastModifiedTime=new Date(e.lastModifiedTime).toISOString()),n.lastModifiedTime=n.lastModifiedTime||n.createTime,(e.lastModifiedUserId||e.createUserId)&&(n.lastModifiedUserId=e.lastModifiedUserId||e.createUserId),void 0!==e.createUserId&&(n.createUserId=e.createUserId),void 0!==e.description&&(n.description=e.description),void 0!==e.name&&(n.name=e.name),{typeid:e.snapshotComponentTypeid,value:n}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(245)),i=n(5),s=n(49);async function errorOutCommand(e,t){throw e.progress="ERROR",e.error=e.result=t,new Error(t)}function toCommand(e){return{id:e.id,progress:e.progress,type:e.type,error:e.error,result:e.result}}async function awaitCommand(e,t,n){const r=await i.getSDKInstance(e,t);if(r){const e=r.fremontCommands.find(e=>e.id===n);if(e&&e.promise)return await e.promise.catch(e=>{}).then(()=>e);if(e)return e;throw new Error("Unknown CommandID")}throw new Error("SDK Context not found")}t.executeWorker=async function executeWorker(e){e.progress="PROCESSING";const t="-".repeat(80);console.info(t),console.info(`[${e.type}]: Start`);const n=(new Date).getTime();if(e._resolve){const t=e._resolve;e._resolve=void 0,setImmediate(()=>t())}e.promise&&await e.promise.catch(e=>{s.reportTelemetry({componentName:"Worker",componentAttributes:{extInfo:s.ReportType.HandlerError,misc:"Exception "+e.message,stack:e.stack},logLocation:s.LogLocation.Telemetry,logLevel:s.LogLevel.Severe})}),console.info(`[${e.type}]: End (${(new Date).getTime()-n} ms)`),console.info(t)},t.queueFremontCommand=function queueFremontCommand(e,t,n,r,s){const a={id:o.default(),type:n.name,progress:"QUEUED"};a.promise=new Promise(e=>{a._resolve=e}).then(o=>async function executeQueuedEvent(e,t,n,r,o,i){let s=n;const a=await t.documentIdentityService.generateInvariantId(e,t,r.docId,r.lineageUrn),c=t.pimStateService.isSpaceCollectionEnabled(e.spaceCollectionId);let u=!0;if(a){const e=t.pimStateService.getDocument(a);u=!e||e.enabled}if(!u&&(null==i?void 0:i.documentDisabledExecutor))s=null==i?void 0:i.documentDisabledExecutor;else if(!u)return errorOutCommand(o,`Document ${a} is disabled`);if(!c&&(null==i?void 0:i.spaceCollectionDisabledExecutor))s=null==i?void 0:i.spaceCollectionDisabledExecutor;else if(!c)return errorOutCommand(o,`Space collection ${e.spaceCollectionId} is disabled`);return s(r)}(e,t,n,r,a,s)).catch(async o=>{var s,c;a.error=o.message+(o.details?": "+o.details:"")||o;const u=(null===(s=o.innerError)||void 0===s?void 0:s.trackingId)||"";console.info(`An error occured while running the operation ${n.name}: ${a.error} ${o.stack} ${u}`),a.progress="ERROR";const l=await t.documentIdentityService.generateInvariantId(e,t,r.docId,r.lineageUrn);if(!l)throw o;const d=i.getSDKInstance(e,t);return t.pimStateService.disableDocument(l,e.spaceCollectionId,null==d?void 0:d.pimsdk,null===(c=null==d?void 0:d.journalService)||void 0===c?void 0:c.getSdk(),o).then(()=>{throw o})}).then(e=>(a.progress="SUCCESS",a.result=e,e));const c=i.getSDKInstance(e,t);if(!c)throw new Error(`SDK Instance could not be found for clientID ${t.clientId}, and space collection ${e.spaceCollectionId}`);return c.rpcQueue.push(a),c.fremontCommands.push(a),a.id},t.toCommand=toCommand,t.getFremontEventQueue=async function getFremontEventQueue(e,t){const n=await i.getSDKInstance(e,t);return n?n.fremontCommands.map(toCommand):[]},t.getFremontCommand=async function getFremontCommand(e,t,n){const r=await i.getSDKInstance(e,t);if(r){const e=r.fremontCommands.find(e=>e.id===n);if(e)return toCommand(e)}},t.awaitCommand=awaitCommand,t.awaitAllCommands=async function awaitAllCommands(e,t){const n=await i.getSDKInstance(e,t);if(n)for(const r of n.fremontCommands)await awaitCommand(e,t,r.id)}},function(e,t,n){"use strict";const r=n(20),o=n(544),i=n(50),s=n(254),a=n(255),c=n(545);let u=null,l=null,d=null;const p={Set:n(546),defaults:{abortEarly:!0,convert:!0,allowUnknown:!1,skipFunctions:!1,stripUnknown:!1,language:{},presence:"optional",strip:!1,noDefaults:!1,escapeHtml:!1}};e.exports=p.Any=class{constructor(){l=l||n(120),this.isJoi=!0,this._type="any",this._settings=null,this._valids=new p.Set,this._invalids=new p.Set,this._tests=[],this._refs=[],this._flags={},this._description=null,this._unit=null,this._notes=[],this._tags=[],this._examples=[],this._meta=[],this._inner={}}_init(){return this}get schemaType(){return this._type}createError(e,t,n,r,o=this._flags){return s.create(e,t,n,r,o)}createOverrideError(e,t,n,r,o,i){return s.create(e,t,n,r,this._flags,o,i)}checkOptions(e){d=d||n(1323);const t=d.options.validate(e);if(t.error)throw new Error(t.error.details[0].message)}clone(){const e=Object.create(Object.getPrototypeOf(this));e.isJoi=!0,e._currentJoi=this._currentJoi,e._type=this._type,e._settings=this._settings,e._baseType=this._baseType,e._valids=this._valids.slice(),e._invalids=this._invalids.slice(),e._tests=this._tests.slice(),e._refs=this._refs.slice(),e._flags=r.clone(this._flags),e._description=this._description,e._unit=this._unit,e._notes=this._notes.slice(),e._tags=this._tags.slice(),e._examples=this._examples.slice(),e._meta=this._meta.slice(),e._inner={};const t=Object.keys(this._inner);for(let n=0;n<t.length;++n){const r=t[n];e._inner[r]=this._inner[r]?this._inner[r].slice():null}return e}concat(e){r.assert(e instanceof p.Any,"Invalid schema object"),r.assert("any"===this._type||"any"===e._type||e._type===this._type,"Cannot merge type",this._type,"with another type:",e._type);let t=this.clone();if("any"===this._type&&"any"!==e._type){const n=e.clone(),r=["_settings","_valids","_invalids","_tests","_refs","_flags","_description","_unit","_notes","_tags","_examples","_meta","_inner"];for(let e=0;e<r.length;++e)n[r[e]]=t[r[e]];t=n}if(t._settings=t._settings?o.concat(t._settings,e._settings):e._settings,t._valids.merge(e._valids,e._invalids),t._invalids.merge(e._invalids,e._valids),t._tests.push(...e._tests),t._refs.push(...e._refs),t._flags.empty&&e._flags.empty){t._flags.empty=t._flags.empty.concat(e._flags.empty);const n=Object.assign({},e._flags);delete n.empty,r.merge(t._flags,n)}else if(e._flags.empty){t._flags.empty=e._flags.empty;const n=Object.assign({},e._flags);delete n.empty,r.merge(t._flags,n)}else r.merge(t._flags,e._flags);t._description=e._description||t._description,t._unit=e._unit||t._unit,t._notes.push(...e._notes),t._tags.push(...e._tags),t._examples.push(...e._examples),t._meta.push(...e._meta);const n=Object.keys(e._inner),i="object"===t._type;for(let r=0;r<n.length;++r){const o=n[r],s=e._inner[o];if(s){const e=t._inner[o];if(e)if(i&&"children"===o){const t={};for(let n=0;n<e.length;++n)t[e[n].key]=n;for(let n=0;n<s.length;++n){const r=s[n].key;t[r]>=0?e[t[r]]={key:r,schema:e[t[r]].schema.concat(s[n].schema)}:e.push(s[n])}}else t._inner[o]=t._inner[o].concat(s);else t._inner[o]=s.slice()}}return t}_test(e,t,n,r){const o=this.clone();return o._tests.push({func:n,name:e,arg:t,options:r}),o}_testUnique(e,t,n,r){const o=this.clone();return o._tests=o._tests.filter(t=>t.name!==e),o._tests.push({func:n,name:e,arg:t,options:r}),o}options(e){r.assert(!e.context,"Cannot override context"),this.checkOptions(e);const t=this.clone();return t._settings=o.concat(t._settings,e),t}strict(e){const t=this.clone(),n=void 0!==e&&!e;return t._settings=o.concat(t._settings,{convert:n}),t}raw(e){const t=void 0===e||e;if(this._flags.raw===t)return this;const n=this.clone();return n._flags.raw=t,n}error(e,t={self:!1}){r.assert(e&&(e instanceof Error||"function"==typeof e),"Must provide a valid Error object or a function");const n=Object.keys(t).filter(e=>!["self"].includes(e));r.assert(0===n.length,`Options ${n} are unknown`);const o=this.clone();return o._flags.error=e,t.self&&(o._flags.selfError=!0),o}allow(...e){const t=this.clone();e=r.flatten(e);for(let n=0;n<e.length;++n){const o=e[n];r.assert(void 0!==o,"Cannot call allow/valid/invalid with undefined"),t._invalids.remove(o),t._valids.add(o,t._refs)}return t}valid(...e){const t=this.allow(...e);return t._flags.allowOnly=!0,t}invalid(...e){const t=this.clone();e=r.flatten(e);for(let n=0;n<e.length;++n){const o=e[n];r.assert(void 0!==o,"Cannot call allow/valid/invalid with undefined"),t._valids.remove(o),t._invalids.add(o,t._refs)}return t}required(){if("required"===this._flags.presence)return this;const e=this.clone();return e._flags.presence="required",e}optional(){if("optional"===this._flags.presence)return this;const e=this.clone();return e._flags.presence="optional",e}forbidden(){if("forbidden"===this._flags.presence)return this;const e=this.clone();return e._flags.presence="forbidden",e}strip(){if(this._flags.strip)return this;const e=this.clone();return e._flags.strip=!0,e}applyFunctionToChildren(e,t,n=[],r){if(1!==(e=[].concat(e)).length||""!==e[0]){r=r?r+".":"";const t=(""===e[0]?e.slice(1):e).map(e=>r+e);throw new Error("unknown key(s) "+t.join(", "))}return this[t](...n)}default(e,t){"function"!=typeof e||i.isRef(e)||(!e.description&&t&&(e.description=t),this._flags.func||r.assert("string"==typeof e.description&&e.description.length>0,"description must be provided when default value is a function"));const n=this.clone();return n._flags.default=e,i.push(n._refs,e),n}empty(e){const t=this.clone();return void 0===e?delete t._flags.empty:t._flags.empty=l.schema(this._currentJoi,e),t}when(e,t){r.assert(t&&"object"==typeof t,"Invalid options"),r.assert(void 0!==t.then||void 0!==t.otherwise,'options must have at least one of "then" or "otherwise"');const o=t.hasOwnProperty("then")?this.concat(l.schema(this._currentJoi,t.then)):void 0,i=t.hasOwnProperty("otherwise")?this.concat(l.schema(this._currentJoi,t.otherwise)):void 0;u=u||n(547);const s={then:o,otherwise:i};Object.prototype.hasOwnProperty.call(t,"is")&&(s.is=t.is);const a=u.when(e,s);return a._flags.presence="ignore",a._baseType=this,a}description(e){r.assert(e&&"string"==typeof e,"Description must be a non-empty string");const t=this.clone();return t._description=e,t}notes(e){r.assert(e&&("string"==typeof e||Array.isArray(e)),"Notes must be a non-empty string or array");const t=this.clone();return t._notes=t._notes.concat(e),t}tags(e){r.assert(e&&("string"==typeof e||Array.isArray(e)),"Tags must be a non-empty string or array");const t=this.clone();return t._tags=t._tags.concat(e),t}meta(e){r.assert(void 0!==e,"Meta cannot be undefined");const t=this.clone();return t._meta=t._meta.concat(e),t}example(...e){r.assert(e.length>0,"Missing examples");const t=[];for(let n=0;n<e.length;++n){const i=[].concat(e[n]);r.assert(i.length<=2,"Bad example format at index "+n);const c=i[0];let u=i[1];if(void 0!==u){r.assert(u&&"object"==typeof u,`Options for example at index ${n} must be an object`);const e=Object.keys(u).filter(e=>!["parent","context"].includes(e));r.assert(0===e.length,`Unknown example options ${e} at index ${n}`)}else u={};const l=new a("",[],u.parent||null),d=this._validate(c,l,o.concat(p.defaults,u.context?{context:u.context}:null));r.assert(!d.errors,`Bad example at index ${n}:`,d.errors&&s.process(d.errors,c));const h={value:c};Object.keys(u).length&&(h.options=u),t.push(h)}const n=this.clone();return n._examples=t,n}unit(e){r.assert(e&&"string"==typeof e,"Unit name must be a non-empty string");const t=this.clone();return t._unit=e,t}_prepareEmptyValue(e){return"string"==typeof e&&this._flags.trim?e.trim():e}_validate(e,t,n,r){const i=e;if(t=t||new a("",[],null,r),this._settings){const e=n===p.defaults;e&&this._settings[c.settingsCache]?n=this._settings[c.settingsCache]:(n=o.concat(n,this._settings),e&&(this._settings[c.settingsCache]=n))}let u=[];if(this._coerce){const r=this._coerce(e,t,n);if(r.errors)return e=r.value,u=u.concat(r.errors),this._finalizeValue(e,i,u,t,n);e=r.value}this._flags.empty&&!this._flags.empty._validate(this._prepareEmptyValue(e),null,p.defaults).errors&&(e=void 0);const l=this._flags.presence||n.presence;if("optional"===l){if(void 0===e){if(!(this._flags.hasOwnProperty("default")&&void 0===this._flags.default)||"object"!==this._type)return this._finalizeValue(e,i,u,t,n);e={}}}else{if("required"===l&&void 0===e)return u.push(this.createError("any.required",null,t,n)),this._finalizeValue(e,i,u,t,n);if("forbidden"===l)return void 0===e||u.push(this.createError("any.unknown",null,t,n)),this._finalizeValue(e,i,u,t,n)}let d=this._valids.get(e,t,n,this._flags.insensitive);if(d)return n.convert&&(e=d.value),this._finalizeValue(e,i,u,t,n);if(this._invalids.has(e,t,n,this._flags.insensitive)&&(u.push(this.createError(""===e?"any.empty":"any.invalid",{value:e,invalids:this._invalids.values({stripUndefined:!0})},t,n)),n.abortEarly))return this._finalizeValue(e,i,u,t,n);if(this._base){const r=this._base(e,t,n);if(r.errors)return e=r.value,u=u.concat(r.errors),this._finalizeValue(e,i,u,t,n);if(r.value!==e){if(e=r.value,d=this._valids.get(e,t,n,this._flags.insensitive),d)return e=d.value,this._finalizeValue(e,i,u,t,n);if(this._invalids.has(e,t,n,this._flags.insensitive)&&(u.push(this.createError(""===e?"any.empty":"any.invalid",{value:e,invalids:this._invalids.values({stripUndefined:!0})},t,n)),n.abortEarly))return this._finalizeValue(e,i,u,t,n)}}if(this._flags.allowOnly&&(u.push(this.createError("any.allowOnly",{value:e,valids:this._valids.values({stripUndefined:!0})},t,n)),n.abortEarly))return this._finalizeValue(e,i,u,t,n);for(let r=0;r<this._tests.length;++r){const o=this._tests[r].func.call(this,e,t,n);if(o instanceof s.Err){if(u.push(o),n.abortEarly)return this._finalizeValue(e,i,u,t,n)}else e=o}return this._finalizeValue(e,i,u,t,n)}_finalizeValue(e,t,n,o,s){let a;if(void 0!==e)a=this._flags.raw?t:e;else if(s.noDefaults)a=e;else if(i.isRef(this._flags.default))a=this._flags.default(o.parent,s);else if("function"!=typeof this._flags.default||this._flags.func&&!this._flags.default.description)a=r.clone(this._flags.default);else{let e;null!==o.parent&&this._flags.default.length>0&&(e=[r.clone(o.parent),s]);const t=p._try(this._flags.default,e);a=t.value,t.error&&n.push(this.createError("any.default",{error:t.error},o,s))}if(n.length&&"function"==typeof this._flags.error&&(!this._flags.selfError||n.some(e=>o.path.length===e.path.length))){const e=this._flags.error.call(this,n);n="string"==typeof e?[this.createOverrideError("override",{reason:n},o,s,e)]:[].concat(e).map(e=>e instanceof Error?e:this.createOverrideError(e.type||"override",e.context,o,s,e.message,e.template))}return{value:this._flags.strip?void 0:a,finalValue:a,errors:n.length?n:null}}_validateWithOptions(e,t,n){t&&this.checkOptions(t);const r=o.concat(p.defaults,t),i=this._validate(e,null,r),a=s.process(i.errors,e);return n?n(a,i.value):{error:a,value:i.value,then:(e,t)=>a?Promise.reject(a).catch(t):Promise.resolve(i.value).then(e),catch:e=>a?Promise.reject(a).catch(e):Promise.resolve(i.value)}}validate(e,t,n){return"function"==typeof t?this._validateWithOptions(e,null,t):this._validateWithOptions(e,t,n)}describe(){const e={type:this._type},t=Object.keys(this._flags);if(t.length)if(["empty","default","lazy","label"].some(e=>this._flags.hasOwnProperty(e))){e.flags={};for(let n=0;n<t.length;++n){const r=t[n];"empty"===r?e.flags[r]=this._flags[r].describe():"default"===r?i.isRef(this._flags[r])?e.flags[r]=this._flags[r].toString():"function"==typeof this._flags[r]?e.flags[r]={description:this._flags[r].description,function:this._flags[r]}:e.flags[r]=this._flags[r]:"lazy"===r||"label"===r||(e.flags[r]=this._flags[r])}}else e.flags=this._flags;this._settings&&(e.options=r.clone(this._settings)),this._baseType&&(e.base=this._baseType.describe()),this._description&&(e.description=this._description),this._notes.length&&(e.notes=this._notes),this._tags.length&&(e.tags=this._tags),this._meta.length&&(e.meta=this._meta),this._examples.length&&(e.examples=this._examples),this._unit&&(e.unit=this._unit);const n=this._valids.values();n.length&&(e.valids=n.map(e=>i.isRef(e)?e.toString():e));const o=this._invalids.values();o.length&&(e.invalids=o.map(e=>i.isRef(e)?e.toString():e)),e.rules=[];for(let t=0;t<this._tests.length;++t){const n=this._tests[t],r={name:n.name};void 0!==n.arg&&(r.arg=i.isRef(n.arg)?n.arg.toString():n.arg);const o=n.options;if(o){if(o.hasRef){r.arg={};const e=Object.keys(n.arg);for(let t=0;t<e.length;++t){const o=e[t],s=n.arg[o];r.arg[o]=i.isRef(s)?s.toString():s}}"string"==typeof o.description?r.description=o.description:"function"==typeof o.description&&(r.description=o.description(r.arg))}e.rules.push(r)}e.rules.length||delete e.rules;const s=this._getLabel();return s&&(e.label=s),e}label(e){r.assert(e&&"string"==typeof e,"Label name must be a non-empty string");const t=this.clone();return t._flags.label=e,t}_getLabel(e){return this._flags.label||e}},p.Any.prototype.isImmutable=!0,p.Any.prototype.only=p.Any.prototype.equal=p.Any.prototype.valid,p.Any.prototype.disallow=p.Any.prototype.not=p.Any.prototype.invalid,p.Any.prototype.exist=p.Any.prototype.required,p._try=function(e,t=[]){let n,r;try{r=e(...t)}catch(e){n=e}return{value:r,error:n}}},function(e,t){e.exports=require("assert")},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(341),t);var i=n(103);Object.defineProperty(t,"ErrorCode",{enumerable:!0,get:function(){return i.ErrorCode}}),o(n(866),t),o(n(976),t);var s=n(369);Object.defineProperty(t,"Store",{enumerable:!0,get:function(){return s.Store}});var a=n(107);Object.defineProperty(t,"StoreError",{enumerable:!0,get:function(){return a.StoreError}})},function(e,t,n){var r=n(345),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(522);var o;!function(e){e.UncaughtException="UncaughtException",e.UnhandledPromiseRejection="UnhandledPromiseRejection",e.HandlerCompletion="HandlerCompletion",e.HandlerError="HandlerError",e.MigrationTriggered="MigrationTriggered",e.MigrationError="MigrationError",e.MigrationComplete="MigrationComplete",e.DocumentSync="DocumentSync",e.DocumentPublished="DocumentPublished",e.SyncFailure="SyncFailure",e.ClearUserCache="ClearUserCache",e.InitializationError="InitializationError"}(o=t.ReportType||(t.ReportType={})),function(e){e.Console="Console",e.Telemetry="Telemetry",e.All="All"}(t.LogLocation||(t.LogLocation={})),function(e){e.Severe="Severe",e.Warning="Warning",e.Info="Info",e.Config="Config",e.Debug="Debug",e.Trace="Trace"}(t.LogLevel||(t.LogLevel={}));class TelemetryTracker{constructor(e){TelemetryTracker._socket=e}report(e){if(e.componentAttributes.fremontJsLibVersion=r.ADSK_PACKAGE_INFO.version,e.componentAttributes.extInfo!=o.HandlerCompletion||"getDocumentStatus"!=e.componentName)if(TelemetryTracker._socket)try{TelemetryTracker._socket.emit("trackTelemetryReport",e)}catch(e){console.error("Telemetry report cannot be sent, error: "+e.toString())}else console.info("Telemetry report cannot be sent, socket not initialized")}}t.TelemetryTracker=TelemetryTracker,t.reportTelemetry=()=>{},t.initTelemetryReporting=function initTelemetryReporting(e){t.reportTelemetry=e}},function(e,t,n){"use strict";const r=n(20);t.create=function(e,t){r.assert("string"==typeof e,"Invalid reference key:",e);const n=r.clone(t),ref=function(e,t){return r.reach(ref.isContext?t.context:e,ref.key,n)};return ref.isContext=e[0]===(n&&n.contextPrefix||"$"),ref.key=ref.isContext?e.slice(1):e,ref.path=ref.key.split(n&&n.separator||"."),ref.depth=ref.path.length,ref.root=ref.path[0],ref.isJoi=!0,ref.toString=function(){return(ref.isContext?"context:":"ref:")+ref.key},ref},t.isRef=function(e){return"function"==typeof e&&e.isJoi},t.push=function(e,n){t.isRef(n)&&!n.isContext&&e.push(n.root)}},function(e,t){e.exports=require("url")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1),i=n(22),s=n(115),a=n(9),c=n(3);t.getSkipValidation=e=>void 0!==e&&void 0!==e.skipValidation&&e.skipValidation;const getFamily=e=>s.getFamilyFromTypeid(e.getTypeId()).family;async function filterRelationshipQuery(e,t,n=!1){const r=await i.getAllPages(e,"getRelationships");return n&&console.debug("not implemented yet"),r.filter(e=>!t||t.includes(getFamily(e)))}async function getRelationship(e,t,n,r=!1){return filterRelationshipQuery(await e.getRelationships(t),n,r)}t.ensureFamily=(e,t)=>t.includes(getFamily(e)),t.createModelValidator=async function createModelValidator(e){if(!t.ensureFamily(e,[o.PIM_FAMILY.DESIGN]))return!1;const n=await getRelationship(e,{direction:r.RelationshipDirection.outgoing},[o.PIM_FAMILY.CONTAINS]);if(n.length){if((await Promise.all(n.map(async e=>{const t=await e.getTo({fetch:!0});return getFamily(e)!==o.PIM_FAMILY.CONTAINS||getFamily(t)!==o.PIM_FAMILY.MODEL}))).includes(!1))return!1}return!0},t.createDesignValidator=async function createDesignValidator(e){if(!t.ensureFamily(e,[o.PIM_FAMILY.PRODUCT]))return!1;const n=await getRelationship(e,{direction:r.RelationshipDirection.outgoing},[o.PIM_FAMILY.CONTAINS]);if(n.length>0){if((await Promise.all(n.map(async e=>{const t=await e.getTo({fetch:!0});return getFamily(e)!==o.PIM_FAMILY.CONTAINS||getFamily(t)!==o.PIM_FAMILY.DESIGN}))).includes(!1))return!1}return!0},t.createDrawingValidator=async function createDrawingValidator(e){if(!t.ensureFamily(e,[o.PIM_FAMILY.DOCUMENTATION]))return!1;const n=await getRelationship(e,{direction:r.RelationshipDirection.outgoing,filter:{"type.name":o.PIM_CONTAINS_RELATIONSHIP_TYPENAME}},[o.PIM_FAMILY.CONTAINS]);if(n.length>0){if((await Promise.all(n.map(async e=>{const t=await e.getTo({fetch:!0});return getFamily(t)!==o.PIM_FAMILY.DRAWING}))).includes(!1))return!1}return!0},t.createSheetsValidator=async function createSheetsValidator(e){if(!t.ensureFamily(e,[o.PIM_FAMILY.DRAWING]))return!1;const n=await getRelationship(e,{direction:r.RelationshipDirection.outgoing},[o.PIM_FAMILY.CONTAINS]);if(n.length){if((await Promise.all(n.map(async e=>{const t=await e.getTo({fetch:!0});return getFamily(e)!==o.PIM_FAMILY.CONTAINS||getFamily(t)!==o.PIM_FAMILY.SHEETS}))).includes(!1))return!1}return!0},t.createAssemblyRefValidator=async function createAssemblyRefValidator(e,n){return!(!t.ensureFamily(e,[o.PIM_FAMILY.MODEL])||!t.ensureFamily(n,[o.PIM_FAMILY.MODEL]))&&e.getId()!==n.getId()},t.createDescribesValidator=async function createDescribesValidator(e,n){return!(!t.ensureFamily(e,[o.PIM_FAMILY.SHEETS])||!t.ensureFamily(n,[o.PIM_FAMILY.MODEL]))},t.createChildProductRelationshipValidator=async function createChildProductRelationshipValidator(e,n,r){if(!t.ensureFamily(n,[o.PIM_FAMILY.PRODUCT])||!t.ensureFamily(r,[o.PIM_FAMILY.PRODUCT]))return!1;const i=e.getRelationships({fromAsset:n,toAsset:r});return!((await filterRelationshipQuery(i,[o.PIM_FAMILY.CONTAINS])).length>0)},t.createChildProductStructureValidator=async function createChildProductStructureValidator(e){return!!t.ensureFamily(e,[o.PIM_FAMILY.PRODUCT])},t.createVersionSnapshotValidator=async function createVersionSnapshotValidator(e,t,n){return c.isString(t)&&(t=await e.getSpaceCollection(t,{fetch:!1})),n=await a.toAsset(e,t,n,{fetch:!0}),getFamily(n)!==o.PIM_FAMILY.PRODUCT?{pass:!1}:{pass:!0,spaceCollection:t,asset:n}},t.createDocumentationVersionSnapshotValidator=async function createDocumentationVersionSnapshotValidator(e,t,n){return c.isString(t)&&(t=await e.getSpaceCollection(t,{fetch:!1})),n=await a.toAsset(e,t,n,{fetch:!0}),getFamily(n)!==o.PIM_FAMILY.DOCUMENTATION?{pass:!1}:{pass:!0,spaceCollection:t,asset:n}}},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(118)),__export(n(528)),__export(n(529)),__export(n(535)),__export(n(1260)),__export(n(244))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(35);t._castFunctors=r._castFunctors;var o=n(298);t.ValueProperty=o.ValueProperty;var i=n(692);t.BoolProperty=i.BoolProperty;var s=n(693);t.EnumProperty=s.EnumProperty;var a=n(300);t.Integer64Property=a.Integer64Property;var c=n(694);t.Uint8Property=c.Uint8Property,t.Uint16Property=c.Uint16Property,t.Uint32Property=c.Uint32Property,t.Uint64Property=c.Uint64Property;var u=n(299);t.Int8Property=u.Int8Property,t.Int16Property=u.Int16Property,t.Int32Property=u.Int32Property,t.Int64Property=u.Int64Property;var l=n(695);t.Float32Property=l.Float32Property,t.Float64Property=l.Float64Property;var d=n(696);t.StringProperty=d.StringProperty;var p=n(697);t.Int8ArrayProperty=p.Int8ArrayProperty,t.Int16ArrayProperty=p.Int16ArrayProperty,t.Int32ArrayProperty=p.Int32ArrayProperty,t.Int64ArrayProperty=p.Int64ArrayProperty,t.Uint8ArrayProperty=p.Uint8ArrayProperty,t.Uint16ArrayProperty=p.Uint16ArrayProperty,t.Uint32ArrayProperty=p.Uint32ArrayProperty,t.Uint64ArrayProperty=p.Uint64ArrayProperty,t.Float32ArrayProperty=p.Float32ArrayProperty,t.Float64ArrayProperty=p.Float64ArrayProperty,t.BoolArrayProperty=p.BoolArrayProperty,t.StringArrayProperty=p.StringArrayProperty,t.ValueArrayProperty=p.ValueArrayProperty;var h=n(698);t.EnumArrayProperty=h.EnumArrayProperty;var m=n(699);t.Int8MapProperty=m.Int8MapProperty,t.Int16MapProperty=m.Int16MapProperty,t.Int32MapProperty=m.Int32MapProperty,t.Int64MapProperty=m.Int64MapProperty,t.Uint8MapProperty=m.Uint8MapProperty,t.Uint16MapProperty=m.Uint16MapProperty,t.Uint32MapProperty=m.Uint32MapProperty,t.Uint64MapProperty=m.Uint64MapProperty,t.Float32MapProperty=m.Float32MapProperty,t.Float64MapProperty=m.Float64MapProperty,t.BoolMapProperty=m.BoolMapProperty,t.StringMapProperty=m.StringMapProperty,t.ValueMapProperty=m.ValueMapProperty},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(863);t.AssetCommandsRegistry=r.AssetCommandsRegistry;var o=n(987);t.CollectionCommandsRegistry=o.CollectionCommandsRegistry;var i=n(988);t.EntityCommandsRegistry=i.EntityCommandsRegistry;var s=n(989);t.SpaceCommandsRegistry=s.SpaceCommandsRegistry;var a=n(373);t.RelationshipCommandsRegistry=a.RelationshipCommandsRegistry;var c=n(990);t.SnapshotCommandsRegistry=c.SnapshotCommandsRegistry;var u=n(385);t.BinaryAssetCommandsRegistry=u.BinaryAssetCommandsRegistry},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(1297)),__export(n(1298)),__export(n(1299)),__export(n(1300)),__export(n(1301)),__export(n(1302)),__export(n(1303)),__export(n(1304)),__export(n(1305)),__export(n(1306)),__export(n(1308)),__export(n(1309)),__export(n(1310)),__export(n(1311)),__export(n(1312)),__export(n(1313)),__export(n(1314)),__export(n(1315)),__export(n(1316)),__export(n(1317)),__export(n(1318)),__export(n(1319))},function(e,t){e.exports=require("https")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(643);t.PropertyFactory=r.PropertyFactory;var o=n(289);t.PropertyTemplate=o.PropertyTemplate;var i=n(301);t.PropertyTemplateWrapper=i.PropertyTemplateWrapper,function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(97))},function(e,t,n){(function(e){var n="[object Arguments]",r="[object Function]",o="[object GeneratorFunction]",i="[object Map]",s="[object Set]",a=/\w*$/,c=/^\[object .+?Constructor\]$/,u=/^(?:0|[1-9]\d*)$/,l={};l[n]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object DataView]"]=l["[object Boolean]"]=l["[object Date]"]=l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l[i]=l["[object Number]"]=l["[object Object]"]=l["[object RegExp]"]=l[s]=l["[object String]"]=l["[object Symbol]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l["[object Error]"]=l[r]=l["[object WeakMap]"]=!1;var d="object"==typeof global&&global&&global.Object===Object&&global,p="object"==typeof self&&self&&self.Object===Object&&self,h=d||p||Function("return this")(),m=t&&!t.nodeType&&t,y=m&&"object"==typeof e&&e&&!e.nodeType&&e,g=y&&y.exports===m;function addMapEntry(e,t){return e.set(t[0],t[1]),e}function addSetEntry(e,t){return e.add(t),e}function arrayReduce(e,t,n,r){var o=-1,i=e?e.length:0;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}function isHostObject(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function mapToArray(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function overArg(e,t){return function(n){return e(t(n))}}function setToArray(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var _,v=Array.prototype,E=Function.prototype,I=Object.prototype,b=h["__core-js_shared__"],S=(_=/[^.]+$/.exec(b&&b.keys&&b.keys.IE_PROTO||""))?"Symbol(src)_1."+_:"",C=E.toString,w=I.hasOwnProperty,A=I.toString,O=RegExp("^"+C.call(w).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),P=g?h.Buffer:void 0,D=h.Symbol,x=h.Uint8Array,R=overArg(Object.getPrototypeOf,Object),N=Object.create,M=I.propertyIsEnumerable,L=v.splice,j=Object.getOwnPropertySymbols,k=P?P.isBuffer:void 0,F=overArg(Object.keys,Object),U=getNative(h,"DataView"),V=getNative(h,"Map"),B=getNative(h,"Promise"),J=getNative(h,"Set"),$=getNative(h,"WeakMap"),G=getNative(Object,"create"),q=toSource(U),H=toSource(V),Y=toSource(B),K=toSource(J),z=toSource($),W=D?D.prototype:void 0,Q=W?W.valueOf:void 0;function Hash(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ListCache(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function MapCache(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Stack(e){this.__data__=new ListCache(e)}function arrayLikeKeys(e,t){var r=ee(e)||function isArguments(e){return function isArrayLikeObject(e){return function isObjectLike(e){return!!e&&"object"==typeof e}(e)&&isArrayLike(e)}(e)&&w.call(e,"callee")&&(!M.call(e,"callee")||A.call(e)==n)}(e)?function baseTimes(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],o=r.length,i=!!o;for(var s in e)!t&&!w.call(e,s)||i&&("length"==s||isIndex(s,o))||r.push(s);return r}function assignValue(e,t,n){var r=e[t];w.call(e,t)&&eq(r,n)&&(void 0!==n||t in e)||(e[t]=n)}function assocIndexOf(e,t){for(var n=e.length;n--;)if(eq(e[n][0],t))return n;return-1}function baseClone(e,t,c,u,d,p,h){var m;if(u&&(m=p?u(e,d,p,h):u(e)),void 0!==m)return m;if(!isObject(e))return e;var y=ee(e);if(y){if(m=function initCloneArray(e){var t=e.length,n=e.constructor(t);t&&"string"==typeof e[0]&&w.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!t)return function copyArray(e,t){var n=-1,r=e.length;t||(t=Array(r));for(;++n<r;)t[n]=e[n];return t}(e,m)}else{var g=Z(e),_=g==r||g==o;if(te(e))return function cloneBuffer(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}(e,t);if("[object Object]"==g||g==n||_&&!p){if(isHostObject(e))return p?e:{};if(m=function initCloneObject(e){return"function"!=typeof e.constructor||isPrototype(e)?{}:function baseCreate(e){return isObject(e)?N(e):{}}(R(e))}(_?{}:e),!t)return function copySymbols(e,t){return copyObject(e,X(e),t)}(e,function baseAssign(e,t){return e&&copyObject(t,keys(t),e)}(m,e))}else{if(!l[g])return p?e:{};m=function initCloneByTag(e,t,n,r){var o=e.constructor;switch(t){case"[object ArrayBuffer]":return cloneArrayBuffer(e);case"[object Boolean]":case"[object Date]":return new o(+e);case"[object DataView]":return function cloneDataView(e,t){var n=t?cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function cloneTypedArray(e,t){var n=t?cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(e,r);case i:return function cloneMap(e,t,n){return arrayReduce(t?n(mapToArray(e),!0):mapToArray(e),addMapEntry,new e.constructor)}(e,r,n);case"[object Number]":case"[object String]":return new o(e);case"[object RegExp]":return function cloneRegExp(e){var t=new e.constructor(e.source,a.exec(e));return t.lastIndex=e.lastIndex,t}(e);case s:return function cloneSet(e,t,n){return arrayReduce(t?n(setToArray(e),!0):setToArray(e),addSetEntry,new e.constructor)}(e,r,n);case"[object Symbol]":return function cloneSymbol(e){return Q?Object(Q.call(e)):{}}(e)}}(e,g,baseClone,t)}}h||(h=new Stack);var v=h.get(e);if(v)return v;if(h.set(e,m),!y)var E=c?function getAllKeys(e){return function baseGetAllKeys(e,t,n){var r=t(e);return ee(e)?r:function arrayPush(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}(r,n(e))}(e,keys,X)}(e):keys(e);return function arrayEach(e,t){for(var n=-1,r=e?e.length:0;++n<r&&!1!==t(e[n],n,e););return e}(E||e,(function(n,r){E&&(n=e[r=n]),assignValue(m,r,baseClone(n,t,c,u,r,e,h))})),m}function baseIsNative(e){return!(!isObject(e)||function isMasked(e){return!!S&&S in e}(e))&&(isFunction(e)||isHostObject(e)?O:c).test(toSource(e))}function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new x(t).set(new x(e)),t}function copyObject(e,t,n,r){n||(n={});for(var o=-1,i=t.length;++o<i;){var s=t[o],a=r?r(n[s],e[s],s,n,e):void 0;assignValue(n,s,void 0===a?e[s]:a)}return n}function getMapData(e,t){var n=e.__data__;return function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function getNative(e,t){var n=function getValue(e,t){return null==e?void 0:e[t]}(e,t);return baseIsNative(n)?n:void 0}Hash.prototype.clear=function hashClear(){this.__data__=G?G(null):{}},Hash.prototype.delete=function hashDelete(e){return this.has(e)&&delete this.__data__[e]},Hash.prototype.get=function hashGet(e){var t=this.__data__;if(G){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return w.call(t,e)?t[e]:void 0},Hash.prototype.has=function hashHas(e){var t=this.__data__;return G?void 0!==t[e]:w.call(t,e)},Hash.prototype.set=function hashSet(e,t){return this.__data__[e]=G&&void 0===t?"__lodash_hash_undefined__":t,this},ListCache.prototype.clear=function listCacheClear(){this.__data__=[]},ListCache.prototype.delete=function listCacheDelete(e){var t=this.__data__,n=assocIndexOf(t,e);return!(n<0)&&(n==t.length-1?t.pop():L.call(t,n,1),!0)},ListCache.prototype.get=function listCacheGet(e){var t=this.__data__,n=assocIndexOf(t,e);return n<0?void 0:t[n][1]},ListCache.prototype.has=function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1},ListCache.prototype.set=function listCacheSet(e,t){var n=this.__data__,r=assocIndexOf(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},MapCache.prototype.clear=function mapCacheClear(){this.__data__={hash:new Hash,map:new(V||ListCache),string:new Hash}},MapCache.prototype.delete=function mapCacheDelete(e){return getMapData(this,e).delete(e)},MapCache.prototype.get=function mapCacheGet(e){return getMapData(this,e).get(e)},MapCache.prototype.has=function mapCacheHas(e){return getMapData(this,e).has(e)},MapCache.prototype.set=function mapCacheSet(e,t){return getMapData(this,e).set(e,t),this},Stack.prototype.clear=function stackClear(){this.__data__=new ListCache},Stack.prototype.delete=function stackDelete(e){return this.__data__.delete(e)},Stack.prototype.get=function stackGet(e){return this.__data__.get(e)},Stack.prototype.has=function stackHas(e){return this.__data__.has(e)},Stack.prototype.set=function stackSet(e,t){var n=this.__data__;if(n instanceof ListCache){var r=n.__data__;if(!V||r.length<199)return r.push([e,t]),this;n=this.__data__=new MapCache(r)}return n.set(e,t),this};var X=j?overArg(j,Object):function stubArray(){return[]},Z=function baseGetTag(e){return A.call(e)};function isIndex(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||u.test(e))&&e>-1&&e%1==0&&e<t}function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||I)}function toSource(e){if(null!=e){try{return C.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function eq(e,t){return e===t||e!=e&&t!=t}(U&&"[object DataView]"!=Z(new U(new ArrayBuffer(1)))||V&&Z(new V)!=i||B&&"[object Promise]"!=Z(B.resolve())||J&&Z(new J)!=s||$&&"[object WeakMap]"!=Z(new $))&&(Z=function(e){var t=A.call(e),n="[object Object]"==t?e.constructor:void 0,r=n?toSource(n):void 0;if(r)switch(r){case q:return"[object DataView]";case H:return i;case Y:return"[object Promise]";case K:return s;case z:return"[object WeakMap]"}return t});var ee=Array.isArray;function isArrayLike(e){return null!=e&&function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!isFunction(e)}var te=k||function stubFalse(){return!1};function isFunction(e){var t=isObject(e)?A.call(e):"";return t==r||t==o}function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function keys(e){return isArrayLike(e)?arrayLikeKeys(e):function baseKeys(e){if(!isPrototype(e))return F(e);var t=[];for(var n in Object(e))w.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}e.exports=function cloneDeep(e){return baseClone(e,!0,!0)}}).call(this,n(34)(e))},function(e,t){var n=Object.prototype.toString;e.exports=function isNumber(e){return"number"==typeof e||function isObjectLike(e){return!!e&&"object"==typeof e}(e)&&"[object Number]"==n.call(e)}},function(e,t){var n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/,o=/^\./,i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,a=/^\[object .+?Constructor\]$/,c="object"==typeof global&&global&&global.Object===Object&&global,u="object"==typeof self&&self&&self.Object===Object&&self,l=c||u||Function("return this")();var d,p=Array.prototype,h=Function.prototype,m=Object.prototype,y=l["__core-js_shared__"],g=(d=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+d:"",_=h.toString,v=m.hasOwnProperty,E=m.toString,I=RegExp("^"+_.call(v).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),b=l.Symbol,S=p.splice,C=getNative(l,"Map"),w=getNative(Object,"create"),A=b?b.prototype:void 0,O=A?A.toString:void 0;function Hash(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ListCache(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function MapCache(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function assocIndexOf(e,t){for(var n,r,o=e.length;o--;)if((n=e[o][0])===(r=t)||n!=n&&r!=r)return o;return-1}function baseGet(e,t){for(var o=0,i=(t=function isKey(e,t){if(D(e))return!1;var o=typeof e;if("number"==o||"symbol"==o||"boolean"==o||null==e||isSymbol(e))return!0;return r.test(e)||!n.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:function castPath(e){return D(e)?e:P(e)}(t)).length;null!=e&&o<i;)e=e[toKey(t[o++])];return o&&o==i?e:void 0}function baseIsNative(e){return!(!isObject(e)||function isMasked(e){return!!g&&g in e}(e))&&(function isFunction(e){var t=isObject(e)?E.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)||function isHostObject(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?I:a).test(function toSource(e){if(null!=e){try{return _.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function getMapData(e,t){var n=e.__data__;return function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function getNative(e,t){var n=function getValue(e,t){return null==e?void 0:e[t]}(e,t);return baseIsNative(n)?n:void 0}Hash.prototype.clear=function hashClear(){this.__data__=w?w(null):{}},Hash.prototype.delete=function hashDelete(e){return this.has(e)&&delete this.__data__[e]},Hash.prototype.get=function hashGet(e){var t=this.__data__;if(w){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return v.call(t,e)?t[e]:void 0},Hash.prototype.has=function hashHas(e){var t=this.__data__;return w?void 0!==t[e]:v.call(t,e)},Hash.prototype.set=function hashSet(e,t){return this.__data__[e]=w&&void 0===t?"__lodash_hash_undefined__":t,this},ListCache.prototype.clear=function listCacheClear(){this.__data__=[]},ListCache.prototype.delete=function listCacheDelete(e){var t=this.__data__,n=assocIndexOf(t,e);return!(n<0)&&(n==t.length-1?t.pop():S.call(t,n,1),!0)},ListCache.prototype.get=function listCacheGet(e){var t=this.__data__,n=assocIndexOf(t,e);return n<0?void 0:t[n][1]},ListCache.prototype.has=function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1},ListCache.prototype.set=function listCacheSet(e,t){var n=this.__data__,r=assocIndexOf(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},MapCache.prototype.clear=function mapCacheClear(){this.__data__={hash:new Hash,map:new(C||ListCache),string:new Hash}},MapCache.prototype.delete=function mapCacheDelete(e){return getMapData(this,e).delete(e)},MapCache.prototype.get=function mapCacheGet(e){return getMapData(this,e).get(e)},MapCache.prototype.has=function mapCacheHas(e){return getMapData(this,e).has(e)},MapCache.prototype.set=function mapCacheSet(e,t){return getMapData(this,e).set(e,t),this};var P=memoize((function(e){e=function toString(e){return null==e?"":function baseToString(e){if("string"==typeof e)return e;if(isSymbol(e))return O?O.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)}(e);var t=[];return o.test(e)&&t.push(""),e.replace(i,(function(e,n,r,o){t.push(r?o.replace(s,"$1"):n||e)})),t}));function toKey(e){if("string"==typeof e||isSymbol(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function memoize(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var memoized=function(){var n=arguments,r=t?t.apply(this,n):n[0],o=memoized.cache;if(o.has(r))return o.get(r);var i=e.apply(this,n);return memoized.cache=o.set(r,i),i};return memoized.cache=new(memoize.Cache||MapCache),memoized}memoize.Cache=MapCache;var D=Array.isArray;function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function isSymbol(e){return"symbol"==typeof e||function isObjectLike(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==E.call(e)}e.exports=function get(e,t,n){var r=null==e?void 0:baseGet(e,t);return void 0===r?n:r}},function(e,t,n){e.exports=n(768)},function(e,t,n){var r=n(878),o=n(883);e.exports=function getNative(e,t){var n=o(e,t);return r(n)?n:void 0}},function(e,t){e.exports=function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){e.exports=function isObjectLike(e){return null!=e&&"object"==typeof e}},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(81));t.assetTypeId=o.assetSchema.typeid,t.binaryAssetTypeId=o.binaryAssetSchema.typeid,t.spaceTypeId=o.spaceSchema.typeid,t.assetGraphTypeId=o.assetGraphSchema.typeid,t.spaceCollectionTypeId=o.spaceCollectionSchema.typeid,t.relationshipTypeId=o.relationshipSchema.typeid,t.snapshotTypeId=o.snapshotSchema.typeid,t.componentTypeId=o.componentSchema.typeid},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(6);t.QueryResult=class QueryResult{constructor(e,t){this.collectionId=t.spaceCollectionId,this.sdkCore=e,this.queryParameters=t}getPage(){return this.page}nextPage(e){return r(this,void 0,void 0,(function*(){let t;const n=void 0===e?this.queryParameters.limit:e;if(this.page){const e=this.page.getNextPageUrl();if(e)if(this.page.getCommandName()){const r=o.RequestTools.extractParamsFromUrl(e),i=Object.assign(Object.assign({},this.queryParameters),{cursor:r.params.cursor,limit:n});t=yield this.sdkCore.getDataConnector().journalQuery(this.page.getCommandName(),i)}else t=yield this.sdkCore.getDataConnector().executeQueryUrl(e,n);else if(this.page.getCommandName()&&this.page.getOffset()>-1){const e=Object.assign(Object.assign({},this.queryParameters),{offset:this.page.getOffset(),limit:n});t=yield this.sdkCore.getDataConnector().journalQuery(this.page.getCommandName(),e)}}else t=yield this.queryPage();return t?(this.page=this.createPage(t,t.pagination.offset,t.pagination.limit),!0):(this.page=void 0,!1)}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class ErrorCode{constructor(e,t){this.id=e,this.description=t}}t.ErrorCode=ErrorCode,t.UNKNOWN=new ErrorCode("UNKNOWN","Unknown error"),t.GEN_INITIALIZATION_ERROR=new ErrorCode("GEN_INITIALIZATION_ERROR","A required step in library initialization failed"),t.GEN_INVALID_INPUT=new ErrorCode("GEN_INVALID_INPUT","The input value is not in the right format."),t.GEN_ERROR_COMMAND=new ErrorCode("GEN_ERROR_COMMAND","The command execution failed."),t.GEN_MISSING_TYPEID=new ErrorCode("GEN_MISSING_TYPEID","The typeid is missing."),t.GEN_INVALID_TYPEID=new ErrorCode("GEN_INVALID_TYPEID","The typeid provided is invalid."),t.GEN_COMPONENT_NOT_FOUND=new ErrorCode("GEN_COMPONENT_NOT_FOUND","Component not found."),t.GEN_UNKNOWN_TYPEID=new ErrorCode("GEN_UNKNOWN_TYPEID","The typeid is unknown. Cannot build an asset based on it."),t.GEN_INCOMPATIBLE_TYPEID=new ErrorCode("GEN_INCOMPATIBLE_TYPEID","The actual typeid is incompatible with the requested typeid."),t.GEN_NOT_IMPLEMENTED=new ErrorCode("GEN_NOT_IMPLEMENTED","Not implemented."),t.GEN_NOT_INITIALIZED=new ErrorCode("GEN_NOT_INITIALIZED","Not initialized."),t.NOT_FOUND_PRODUCT=new ErrorCode("NOT_FOUND_PRODUCT","The product was not found."),t.NOT_FOUND_MODEL=new ErrorCode("NOT_FOUND_MODEL","The model was not found."),t.NOT_FOUND_ASSET=new ErrorCode("NOT_FOUND_ASSET","The asset was not found."),t.NOT_FOUND_SPACE=new ErrorCode("NOT_FOUND_SPACE","The space was not found."),t.NOT_FOUND_BRANCH=new ErrorCode("NOT_FOUND_BRANCH","The branch was not found."),t.INVALID_MODEL=new ErrorCode("INVALID_MODEL","Invalid model asset"),t.MULTI_MODELS_OF_SAME_F3DCOMPONENT=new ErrorCode("MULTI_MODELS_OF_SAME_F3DCOMPONENT","Multi model assets of same f3d component"),t.HAS_INCOMPLETE_MODEL_ASSETS=new ErrorCode("HAS_INCOMPLETE_MODEL_ASSETS","Has incomplete model assets"),t.MULTI_VALID_VERSION_SNAPSHOTS=new ErrorCode("MULTI_VALID_VERSION_SNAPSHOTS","Multiple version snapshot found for given version urn."),t.HAS_INCOMPLETE_VERSION_SNAPSHOTS=new ErrorCode("HAS_INCOMPLETE_VERSION_SNAPSHOTS","Has incomplete snapshot."),t.NOT_FOUND_SPACE_COLLECTION=new ErrorCode("NOT_FOUND_SPACE_COLLECTION","The space collection was not found."),t.NOT_FOUND_RELATIONSHIP=new ErrorCode("NOT_FOUND_RELATIONSHIP","The relationship was not found."),t.NOT_FOUND_SNAPSHOT=new ErrorCode("NOT_FOUND_SNAPSHOT","The snapshot was not found."),t.NOT_FOUND_VERSION_SNAPSHOT=new ErrorCode("NOT_FOUND_VERSION_SNAPSHOT","The version snapshot was not found."),t.NO_VALID_VERSION_SNAPSHOT=new ErrorCode("NO_VALID_VERSION_SNAPSHOT","The valid snapshot with version component was not found."),t.INVALID_ASSEMBLYREF=new ErrorCode("INVALID_ASSEMBLYREF","The relationship is not a valid AssemblyRef."),t.CAN_NOT_DELETE_CAM=new ErrorCode("CAN_NOT_DELETE_CAM","The cam is associated with more than one product."),t.COMMAND_RESULT_NOT_RETURNED=new ErrorCode("COMMAND_RESULT_NOT_RETURNED","The command does not return result."),t.COMMAND_NOT_FOUND=new ErrorCode("COMMAND_NOT_FOUND","The command is not found."),t.PINNED_RELATIONSHIP_NOT_SUPPORTED=new ErrorCode("PINNED_RELATIONSHIP_NOT_SUPPORTED","Pinned relationship not supported by HFDM"),t.SERVER_ERROR=new ErrorCode("SERVER_ERROR","An error occured in L2"),t.COMMAND_SERVER_URL_NOT_PROVIDED=new ErrorCode("COMMAND_SERVER_URL_NOT_PROVIDED","No commandServerUrl provided."),t.INVALID_CATEGORY=new ErrorCode("INVALID_CATEGORY","No valid category provided."),t.DESIGN_CONFLICT=new ErrorCode("DESIGN_CONFLICT","The input value is not valid, design already exists."),t.UNEXPECTED_RELEASE_DATA=new ErrorCode("UNEXPECTED_RELEASE_DATA","The release data is following an unexpected model"),t.UNSUPPORTED_ASSET_TYPE=new ErrorCode("UNSUPPORTED_ASSET_TYPE","Unsupported asset type"),t.ILLEGAL_STATE_PROCESS_DATA_NOT_IN_PROCESS_SPACE=new ErrorCode("ILLEGAL_STATE_PROCESS_DATA_NOT_IN_PROCESS_SPACE","The target lifecycle or release asset does not belong to a process space")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(168),o=n(113),i=n(112),s=n(68),a=n(169);t.parseTypeId=e=>{const t=r.TYPEID_REGEX.exec(e);return t&&t.groups?t.groups:null},t.getFamilyFromTypeid=e=>{if(!e.match(r.TYPEID_REGEX))throw new i.PimError(s.GEN_INVALID_TYPEID,`Typeid ${e} is invalid`);const n=t.parseTypeId(e);return n&&(n.prefixFamily||(n.prefixFamily=n.family)),{prefixFamily:n&&n.prefixFamily||"",family:n&&n.family||o.PIM_FAMILY.UNKNOWN,provider:n&&n.provider||"",pimType:n&&n.pimType||""}},t.getNameFromTypeid=e=>{const{prefixFamily:n,family:r,provider:o,pimType:i}=t.getFamilyFromTypeid(e);return`${o}.${i}:${n}.${r}`},t.typeMatch=function typeMatch(e,n){if("string"==typeof n)return e===n;if(n instanceof RegExp)return!!n.exec(e);const r=t.parseTypeId(e);if(!r)return!1;for(const e in n)if(n[e]!==r[e])return!1;return!0},t.typeidSort=(e,t)=>{const n=e.toLowerCase(),r=t.toLowerCase();return n>r?-1:n<r?1:0},t.isCompatibleWith=function isCompatibleWith(e,n){if((e=a.asTypeid(e))===(n=a.asTypeid(n)))return!0;if(t.getFamilyFromTypeid(e).family!==t.getFamilyFromTypeid(n).family)return!1;const r=t.parseTypeId(e),o=t.parseTypeId(n);return!(!r||!o)&&(r.majorVersion===o.majorVersion&&!(r.minorVersion<o.minorVersion))}},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(489)),__export(n(238)),__export(n(490)),__export(n(491))},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(173)),__export(n(117)),__export(n(520)),__export(n(1212)),__export(n(519))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(118);t.updateDocumentModel=function updateDocumentModel(e,t,n,r){return"SUCCESS"===e.progress?t.lastOperation=n:"ERROR"===e.progress?(console.log(`[${r}] PimStateService: ERROR - RPC queue operation failed [${e.error}].\n      Disabling PIM operations on document id: ${t.id}`),t.enabled=!1,t.failOperation=n,t.errorMessage=e.error):console.log(`[documentSaved] PimStateService: ERROR - Unrecognized RPC queue status:\n      ${e.progress}. Skipping state change for document id: ${t.id}`),t},t.updateDocumentLastOperation=function updateDocumentLastOperation(e,t,n,o){if(t){let e=n.getDocument(t);e?n.setDocumentLastOperation(t,o):(e=new r.DocumentStateModel(t,!0),e.lastOperation=o,n.addDocument(e))}else console.error(`[${e}]: Missing invariant id.\n     Cannot update document state for document id: ${t}`)}},function(e,t,n){var r=n(579),o=r.Buffer;function copyProps(e,t){for(var n in e)t[n]=e[n]}function SafeBuffer(e,t,n){return o(e,t,n)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?e.exports=r:(copyProps(r,t),t.Buffer=SafeBuffer),copyProps(o,SafeBuffer),SafeBuffer.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return o(e,t,n)},SafeBuffer.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=o(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},SafeBuffer.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o(e)},SafeBuffer.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,n){"use strict";e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),EMPTY_BUFFER:Buffer.alloc(0),NOOP:()=>{}}},function(e,t){var n=Array.isArray;e.exports=n},function(e,t){var n=Object.prototype.toString,r=Array.isArray;e.exports=function isString(e){return"string"==typeof e||!r(e)&&function isObjectLike(e){return!!e&&"object"==typeof e}(e)&&"[object String]"==n.call(e)}},function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:r}=n(134),o=n(135),i=(t=e.exports={}).re=[],s=t.src=[],a=t.t={};let c=0;const createToken=(e,t,n)=>{const r=c++;o(r,t),a[e]=r,s[r]=t,i[r]=new RegExp(t,n?"g":void 0)};createToken("NUMERICIDENTIFIER","0|[1-9]\\d*"),createToken("NUMERICIDENTIFIERLOOSE","[0-9]+"),createToken("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),createToken("MAINVERSION",`(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})`),createToken("MAINVERSIONLOOSE",`(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})`),createToken("PRERELEASEIDENTIFIER",`(?:${s[a.NUMERICIDENTIFIER]}|${s[a.NONNUMERICIDENTIFIER]})`),createToken("PRERELEASEIDENTIFIERLOOSE",`(?:${s[a.NUMERICIDENTIFIERLOOSE]}|${s[a.NONNUMERICIDENTIFIER]})`),createToken("PRERELEASE",`(?:-(${s[a.PRERELEASEIDENTIFIER]}(?:\\.${s[a.PRERELEASEIDENTIFIER]})*))`),createToken("PRERELEASELOOSE",`(?:-?(${s[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[a.PRERELEASEIDENTIFIERLOOSE]})*))`),createToken("BUILDIDENTIFIER","[0-9A-Za-z-]+"),createToken("BUILD",`(?:\\+(${s[a.BUILDIDENTIFIER]}(?:\\.${s[a.BUILDIDENTIFIER]})*))`),createToken("FULLPLAIN",`v?${s[a.MAINVERSION]}${s[a.PRERELEASE]}?${s[a.BUILD]}?`),createToken("FULL",`^${s[a.FULLPLAIN]}$`),createToken("LOOSEPLAIN",`[v=\\s]*${s[a.MAINVERSIONLOOSE]}${s[a.PRERELEASELOOSE]}?${s[a.BUILD]}?`),createToken("LOOSE",`^${s[a.LOOSEPLAIN]}$`),createToken("GTLT","((?:<|>)?=?)"),createToken("XRANGEIDENTIFIERLOOSE",s[a.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*"),createToken("XRANGEIDENTIFIER",s[a.NUMERICIDENTIFIER]+"|x|X|\\*"),createToken("XRANGEPLAIN",`[v=\\s]*(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:${s[a.PRERELEASE]})?${s[a.BUILD]}?)?)?`),createToken("XRANGEPLAINLOOSE",`[v=\\s]*(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:${s[a.PRERELEASELOOSE]})?${s[a.BUILD]}?)?)?`),createToken("XRANGE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAIN]}$`),createToken("XRANGELOOSE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAINLOOSE]}$`),createToken("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),createToken("COERCERTL",s[a.COERCE],!0),createToken("LONETILDE","(?:~>?)"),createToken("TILDETRIM",`(\\s*)${s[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",createToken("TILDE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAIN]}$`),createToken("TILDELOOSE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAINLOOSE]}$`),createToken("LONECARET","(?:\\^)"),createToken("CARETTRIM",`(\\s*)${s[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",createToken("CARET",`^${s[a.LONECARET]}${s[a.XRANGEPLAIN]}$`),createToken("CARETLOOSE",`^${s[a.LONECARET]}${s[a.XRANGEPLAINLOOSE]}$`),createToken("COMPARATORLOOSE",`^${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]})$|^$`),createToken("COMPARATOR",`^${s[a.GTLT]}\\s*(${s[a.FULLPLAIN]})$|^$`),createToken("COMPARATORTRIM",`(\\s*)${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]}|${s[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",createToken("HYPHENRANGE",`^\\s*(${s[a.XRANGEPLAIN]})\\s+-\\s+(${s[a.XRANGEPLAIN]})\\s*$`),createToken("HYPHENRANGELOOSE",`^\\s*(${s[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[a.XRANGEPLAINLOOSE]})\\s*$`),createToken("STAR","(<|>)?=?\\s*\\*"),createToken("GTE0","^\\s*>=\\s*0.0.0\\s*$"),createToken("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},function(e,t,n){const{MAX_LENGTH:r}=n(134),{re:o,t:i}=n(77),s=n(25),a=n(136);e.exports=(e,t)=>{if(t=a(t),e instanceof s)return e;if("string"!=typeof e)return null;if(e.length>r)return null;if(!(t.loose?o[i.LOOSE]:o[i.FULL]).test(e))return null;try{return new s(e,t)}catch(e){return null}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(60)),i=n(15);class Integer64{constructor(e=0,t=0){this._low=e,this._high=t}getValueHigh(){return this._high}getValueLow(){return this._low}toString(e=10){if(!o.default(e))throw new Error(i.MSG.IN_RADIX_MUST_BE_NUMBER+e);if(e<2||36<e)throw new Error(i.MSG.BASE_OUT_OF_RANGE+e);let t=this.getValueHigh(),n=this.getValueLow(),r="";const s=this.isSigned();s&&(t=~t,n=4294967296-n);do{const o=t%e*4294967296+n;t=Math.floor(t/e),n=Math.floor(o/e),r=(o%e).toString(e)+r}while(t||n);return s?"-"+r:r}}t.Integer64=Integer64;class Int64 extends Integer64{clone(){return new Int64(this._low,this._high)}isSigned(){return!!(2147483648&this._high)}}t.Int64=Int64;class Uint64 extends Integer64{clone(){return new Uint64(this._low,this._high)}isSigned(){return!1}}t.Uint64=Uint64},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.SPACES="spaces",e.COLLECTION="collection",e.COLLECTION_LEGACY="collection_legacy",e.NOOP="noop",e.BOOTSTRAP="bootstrap"}(r=t.SyncSelectorType||(t.SyncSelectorType={})),t.collectionSelector={type:r.COLLECTION,parameters:{}},t.collectionLegacySelector={type:r.COLLECTION_LEGACY,parameters:{}},t.noopSelector={type:r.NOOP,parameters:{}},t.bootstrapSelector={type:r.BOOTSTRAP,parameters:{}},t.toSpacesSyncSelector=e=>({type:r.SPACES,parameters:{spaces:e}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(714));t.componentSchema=o.default;const i=r(n(715));t.assetSchema=i.default;const s=r(n(716));t.assetGraphSchema=s.default;const a=r(n(717));t.binaryAssetSchema=a.default;const c=r(n(718));t.snapshotSchema=c.default;const u=r(n(719));t.spaceSchema=u.default;const l=r(n(720));t.spaceCollectionSchema=l.default;const d=r(n(721));t.spaceCollectionDeprecatedSchema=d.default;const p=r(n(722));t.relationshipSchema=p.default;const h=r(n(723));t.permissionContextSchema=h.default,function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(724)),t.getSchemas=()=>[o.default,i.default,s.default,a.default,d.default,c.default,u.default,l.default,p.default,h.default],t.getSchemasTypeids=()=>t.getSchemas().map(e=>e.typeid),t.sdkCoreSchemaStore={getSchema:e=>t.getSchemas().find(t=>t.typeid===e)}},function(e,t,n){var r=n(349),o=n(903),i=n(106);e.exports=function keys(e){return i(e)?r(e):o(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(991);t.CollectionQueriesRegistry=r.CollectionQueriesRegistry;var o=n(377);t.RelationshipQueriesRegistry=o.RelationshipQueriesRegistry;var i=n(223);t.SnapshotQueriesRegistry=i.SnapshotQueriesRegistry;var s=n(996);t.SpaceQueriesRegistry=s.SpaceQueriesRegistry;var a=n(378);t.AssetQueriesRegistry=a.AssetQueriesRegistry;var c=n(997);t.SnapshotAssetsQueriesRegistry=c.SnapshotAssetsQueriesRegistry;var u=n(1017);t.RevisionQueriesRegistry=u.RevisionQueriesRegistry},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(24),i=n(36),s=n(221),a=n(164),c=n(222),u=n(375),l=n(993),d=n(2);class EntityQueriesRegistry{static getLocally(e,t,n,o){return r(this,void 0,void 0,(function*(){i.validateUserState(o);const r=yield e.getEntity(t.id,t.revisionId);if(!r)throw new d.SDKError(`With status: 403 for id ${t.id}: Unknown entity`);return n(r,t.spaceCollectionId)}))}static queryLocally(e,t,n,o){return r(this,void 0,void 0,(function*(){i.validateUserState(o);const r=t.limit||c.DEFAULT_QUERY_USER_LIMIT,s=new u.LocalFilterHelper(`entityType=='${n.entityType}';${t.filter||""}`,n.nativeKeys||EntityQueriesRegistry.nativeKeys,n.customKeyMapper),d={filters:s.getNativeFilter(),limit:c.QUERY_BUFFER_SIZE};let p=t.offset||0,h=[],m=[];do{try{d.offset=p,h=(yield e.queryEntities(d)).items}catch(e){throw new Error("Unable to query entities")}if(0===h.length){if(0===m.length)return;break}m=m.concat(a.applyFilter(h,s.getNonNativeFilter(),n.customKeyMapper,n.customComparisonResolver)),p+=d.limit}while(m.length<r&&h.length>=d.limit);let y=d.offset;m.length<=r?y+=d.limit:(m=m.slice(0,r),y+=h.indexOf(m[m.length-1])+1);const g=l.processCommaList(t.include),_=m.map(e=>{if(e)return n.packageEntity(e,t.spaceCollectionId,g)});return{results:_,pagination:{limit:r,offset:_.length<r?-1:y}}}))}}t.EntityQueriesRegistry=EntityQueriesRegistry,EntityQueriesRegistry.nativeKeys=["entityType"],EntityQueriesRegistry.customKeyMapper=e=>"type"===e?"staticData.metadata.type":"entityType"===e?"staticData.metadata.entityType":s.getKeyMapper(e),EntityQueriesRegistry.customComparisonResolver=(e,t)=>{},EntityQueriesRegistry.packageEntity=(e,t)=>{const n=o.OfflineEntityWrapper.initialize(e);return{id:e.entityPermanentId||e.permanentId||e.entityId,parentId:n.getParentId(),components:n.getFullComponentView(),attributes:n.getAttributes(),revisionId:e.revisionPermanentId||e.revisionId,typeid:n.getTypeId(),spaceCollectionId:t,createdBy:n.getCreatedBy(),lastModifiedBy:n.getLastModifiedBy()}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(47),t),o(n(379),t)},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(388)),__export(n(1025))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.QueryPage=class QueryPage{constructor(e,t="",n=-1,r=0){this.nextPageUrl=e.pagination.nextUrl,this.queryName=t,this.offset=n,this.limit=r}getNextPageUrl(){return this.nextPageUrl}getCommandName(){return this.queryName}getOffset(){return this.offset}getLimit(){return this.limit}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.AS_SAVED="AS-SAVED",e.AS_LATEST="AS-LATEST",e.SNAPSHOT_CONSTRAINED="SNAPSHOT-CONSTRAINED",e.FULL="FULL"}(t.TopologyTypes||(t.TopologyTypes={})),function(e){e.BRUTE_FORCE="BRUTE-FORCE",e.CLOSUREV2="CLOSUREV2"}(t.TopologyStrategies||(t.TopologyStrategies={}))},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(168)),i=n(168),s=n(1),a=n(169),c=n(69),u=n(234);class SchemaManager{constructor(e){this.schemasVersion=e,this.registerSchemas()}static schemasVersion(e){return e||(e=s.PIM_DEFAULT_SCHEMAS_VERSION),SchemaManager.pimSchemaManagerMap[e]||(SchemaManager.pimSchemaManagerMap[e]=new SchemaManager(e)),SchemaManager.pimSchemaManagerMap[e]}getSchemasVersion(){return this.schemasVersion}static isSchemaManagerRegistered(){return SchemaManager.registeredSchemas&&!SchemaManager.registeredSchemas.size}getSupportedSchemasVersions(){const e=[];for(const t of Object.entries(s.PIM_SCHEMAS_VERSIONS))Number.isNaN(Number(t[0]))&&e.push(t[1]);return e}getFamilyTypeId(e,t){if(t||(t=this.schemasVersion),t!==s.PIM_SCHEMAS_VERSIONS.VERSION_0_1_0&&t!==s.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0)throw new Error("getFamilyTypeId(): Unknown schemasVersion value: "+t);return u.SchemasVersions[t][e].typeid}getFamilyType(e,t){if(t||(t=this.schemasVersion),t!==s.PIM_SCHEMAS_VERSIONS.VERSION_0_1_0&&t!==s.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0)throw new Error("getFamilyTypeId(): Unknown schemasVersion value: "+t);return u.SchemasVersions[t][e]}isCompatibleWith(e,t){if((e=a.asTypeid(e))===(t=a.asTypeid(t)))return!0;if(c.getFamilyFromTypeid(e).family!==c.getFamilyFromTypeid(t).family)return!1;if(this.isDiscontinued(e))return!1;const n=c.parseTypeId(e),r=c.parseTypeId(t);return!(!n||!r)&&(n.majorVersion===r.majorVersion&&!(n.minorVersion<r.minorVersion))}registerSchemas(){for(const e of o.getSchemaTemplates()){SchemaManager.registeredSchemas.set(e.typeid,e);const t=c.getFamilyFromTypeid(e.typeid);t.family&&"autodesk"===t.provider&&"product"===t.pimType&&s.PIM_FAMILY_PREFIXES.includes(t.prefixFamily)&&this._addToMap(t.family,e.typeid)}}isDiscontinued(e){return o.isDiscontinued(e)}splitTypeAndVersion(e){return e.map(e=>{const[t,n]=e.split("-");return{type:t,version:n}})}registerCustomSchema(e,t){this._addToMap(e,t.typeid),SchemaManager.registeredSchemas.set(t.typeid,t)}getAllRegisteredTypeIds(){return Array.from(SchemaManager.registeredSchemas.keys())}searchFamily(e){for(const[t,n]of SchemaManager.schemaFamilies)if(n.has(e))return t}isTypeid(e){return!!e.match(i.TYPEID_REGEX)}isItem(e){const t=a.asTypeid(e);return[s.PIM_FAMILY.PRODUCT,s.PIM_FAMILY.CAM].includes(this.getFamilyName(t))}getLatestFamilyTypeId(e){const t=SchemaManager.schemaFamilies.get(e);if(t)return[...t].sort(c.typeidSort)[0]}getFamilyTypeIds(e){const t=SchemaManager.schemaFamilies.get(e);return t?Array.from(t):[]}getRegisteredFamilies(){return Array.from(SchemaManager.schemaFamilies.keys())}getSchema(e,t){o.isDiscontinued(e)&&!t&&console.warn(`Warning: The schema ${e} is discontinued, and should not be used anymore ${(new Error).stack}`);return SchemaManager.registeredSchemas.get(e)}getFamilyName(e){const t=c.getFamilyFromTypeid(e);return t.family||t.prefixFamily}_addToMap(e,t){if(SchemaManager.schemaFamilies.has(e)){const n=SchemaManager.schemaFamilies.get(e);if(n)return void n.add(t)}else SchemaManager.schemaFamilies.set(e,new Set([t]))}}t.SchemaManager=SchemaManager,SchemaManager.schemaFamilies=new Map,SchemaManager.registeredSchemas=new Map,SchemaManager.pimSchemaManagerMap={},t.getSchemaManager=function getSchemaManager(e){if(!e)throw new Error("schemaManager::getSchemaManager() -> schemasVersion param must be provided by caller");const t=SchemaManager.schemasVersion(e);return SchemaManager.isSchemaManagerRegistered()||t.registerSchemas(),t},t.schemaManager=SchemaManager.schemasVersion(s.PIM_SCHEMAS_VERSIONS.VERSION_0_1_0),t.getFamilyTypeId=function getFamilyTypeId(e,t){if(!t)throw new Error("schemaManager::getFamilyTypeId -> schemasVersion is required.");return t||(t=s.PIM_DEFAULT_SCHEMAS_VERSION),SchemaManager.schemasVersion(t).getFamilyTypeId(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(10),i=n(32),s=n(27);t.createSpace=function createSpace(e,t){try{const n=t&&t.permissionContext?t.permissionContext:void 0,a=t&&t.spaceTypeId?t.spaceTypeId:r.assetGraphTypeId,c=t&&void 0!==t.inheritPermissions?t.inheritPermissions:!n,u=e.createSpace(a,{inheritParentPermissions:c});t&&t.schemasVersion&&u.createAttribute(o.AttributeKeys.SCHEMAS_VERSION,"String",t.schemasVersion);const l=t&&t.additionalInfo?t.additionalInfo:void 0;if(s.addAdditionalInfo([u],l),n){const addPermissionContext=e=>{if("string"==typeof e)u.addPermissionContext(i.DefaultPermissionContext.name,i.DefaultPermissionContext.type,e);else{const t=e;u.addPermissionContext(t.name,t.type,t.value)}};if(n instanceof Array)for(let e=0;e<n.length;e++)addPermissionContext(n[e]);else addPermissionContext(n)}const d=t&&t.accessPolicyId?t.accessPolicyId:void 0;return d&&u.assignPolicy(d),u}catch(e){throw new Error("Failed to create space: "+e.message)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1215),o=n(5),i=n(53),s=n(244),a=n(535),c=n(49),u=n(251);!function(e){e.FDEV="fdev",e.DEV="dev",e.STAGING="staging",e.PRODUCTION="production",e.UNKNOWN="unknown"}(t.APPLICATION_TYPES||(t.APPLICATION_TYPES={}));t.pimStateService=new a.PimStateService;const l={string:e=>"string"==typeof e?e:new Error("Expected string, got "+typeof e),istring:e=>"string"==typeof e?e:new Error("Expected string, got "+typeof e),boolean:e=>"boolean"==typeof e?e:new Error("Expected boolean, got "+typeof e),object:e=>{if("string"==typeof e)try{if(!e)return{};return JSON.parse(e)}catch(e){return e}else if("object"==typeof e)return e;return new Error("Expected object, got "+typeof e)},ComponentMap:e=>{if("string"==typeof e)try{if(!e)return{};return JSON.parse(e)}catch(e){return e}else if("object"==typeof e)return e;return new Error("Expected string with JSON content, got "+typeof e)},JSONPatch:e=>{if("string"==typeof e)try{if(!e)return{};return JSON.parse(e)}catch(e){return e}else if("object"==typeof e)return e;return new Error("Expected string with JSON content, got "+typeof e)}};async function getConvertedArguments(e,t){const n=[];return await Promise.all(e.arguments.map(e=>{const r=e.split(":"),o=r[0],i=r[1],s=l[i](t[o]);if(s instanceof Error)throw new Error(`Argument ${o} fails the validation checks : ${s.message}`);n.push(s)})),n}async function scheduleBearerTokenRefresh(e){for(;;){const t=Math.round((new Date).getTime()/1e3),n=e.options.expiryTimeEpochSec-t;console.info(`[scheduleBearerTokenRefresh]: Token expiring in ${n} seconds`);const r=Math.max(1e4,1e3*(n-600));if(await u.sleep(r),n<=600)break}!0!==e.closed&&function refreshBearerToken(e,t){e.emit(s.MessageEvent.REFRESH_TOKEN,e.options.clientId,(n,r)=>{const o=e.options;if(null!=n)console.error("Refresh token failed: "+n);else{console.debug("Refresh token succeeded");const e=JSON.parse(r);o.bearerToken=e.bearerToken,o.expiryTimeEpochSec=e.expiryTime}scheduleBearerTokenRefresh(e),t(n,r)})}(e,e=>{null!=e&&console.error(e)})}async function rehydrateDocumentIdentityService(e,t,n){n.pimStateService.getSpaceCollection(e).enabled()&&(await n.documentIdentityService.rehydrateState(t,n),console.log("[rpcHandler]: Document Identity service rehydrate request completed for space collection: "+e))}t.validateToken=async function validateToken(e,t){return new Promise((n,r)=>{Math.round((new Date).getTime()/1e3)>t?r(new Error("Token has expired")):n(e)})},t.registerServices=function registerServices(e,n,a){let u={documentIdentityService:new i.DocumentIdentityService,messageService:new s.MessageService(e),pimStateService:t.pimStateService},l={spaceCollectionId:"",testing:!1};const d=Object.assign(e,{options:u,bearerTokenScheduler:!1});for(const i of n)e.on(i.name+":__initialize",async(n,i)=>{if("string"==typeof n&&(n=JSON.parse(n)),u.clientId&&n.clientId!==u.clientId)return void i(`Cannot reinitialize if a new clientId (old value is ${u.clientId}, new is ${n.clientId})`);const{version:s,serverUrl:p,commandServerUrl:h,migrationServerUrl:m,clientId:y,bearerToken:g,expiryTimeEpochSec:_,spaceCollectionId:v,pid:E,journaling:I,fusionTeamUrl:b,userFolder:S,featureFlags:C,applicationType:w,testing:A,clearUserCache:O}=n;if(l.spaceCollectionId=v,l.testing=A||!1,u=Object.assign(u||{},{version:s,bearerToken:g,expiryTimeEpochSec:_,serverUrl:p,commandServerUrl:h,migrationServerUrl:m,clientId:y,socket:e,journaling:I,fusionTeamUrl:b,userFolder:S,featureFlags:C,applicationType:w,clearUserCache:O}),d.bearerTokenScheduler||(d.bearerTokenScheduler=!0,scheduleBearerTokenRefresh(d)),E&&a(E),t.pimStateService.getSpaceCollection(v).setFeatureFlags(u.featureFlags),!u.userFolder||0===u.userFolder.length){const e="Failed to initialize FremontJsLib because userFolder was not set";return c.reportTelemetry({componentName:"rpcHandler",componentAttributes:{extInfo:c.ReportType.InitializationError,misc:e},logLocation:c.LogLocation.All,logLevel:c.LogLevel.Severe}),void i("[rpcHandler]: "+e)}u.clearUserCache&&await r.clearUserCacheCommandHandler(l,u),await o.getPIMSDK(l,u),rehydrateDocumentIdentityService(v,l,u).catch(e=>{console.log("[rpcHandler]: Failed to rehydrate document identity service state.\n          Error: "+e)}),i(null,"{}")}),Object.keys(i.functions).forEach(t=>{e.on(i.name+":"+t,async(e,n)=>{"string"==typeof e&&(e=JSON.parse(e)),console.info("[rpcHandler]: Receiving command "+t);const r=i.functions[t],o=Object.assign({},l);if(e.context){for(const t of["spaceCollectionId","testing"])e.context.hasOwnProperty(t)&&(o[t]=e.context[t]);e.context.expiryTimeEpochSec>u.expiryTimeEpochSec&&(u.bearerToken=e.context.bearerToken,u.expiryTimeEpochSec=e.context.expiryTimeEpochSec)}const s=e.args;try{const e=await getConvertedArguments(r,s),t=await r.handler(o,u,...e);n(null,JSON.stringify(t))}catch(e){const r=`Call to handler ${t} failed: ${e.message} ${JSON.stringify(e)}`;console.info(r,e.stack),n(r)}})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(72),o=n(44);t.invokeStateHandler=async function invokeStateHandler(e,t,n,i,s,a){if(!a)throw new Error(`[${e}] Missing invariant id. Unable to change document state\n     for commandId: ${s}`);{const c=await o.awaitCommand(n,i,s);let u=i.pimStateService.getDocument(a);if(!u)throw new Error(`[${e}] Document not found in state model.\n       Cannot change state. invariantId: ${a}`);u=r.updateDocumentModel(c,u,t,e),i.pimStateService.addDocument(u)}}},function(e,t,n){"undefined"==typeof process||"renderer"===process.type?e.exports=n(563):e.exports=n(565)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(95);t.TypeIdHelper=r.TypeIdHelper},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(15),o={BaseProperty:{inherits:[],primitive:!1},ContainerProperty:{inherits:["BaseProperty"],primitive:!1},NodeProperty:{inherits:["ContainerProperty"],primitive:!1},String:{inherits:["ContainerProperty"],primitive:!0},Float32:{inherits:["BaseProperty"],primitive:!0},Float64:{inherits:["BaseProperty"],primitive:!0},Int8:{inherits:["BaseProperty"],primitive:!0},Uint8:{inherits:["BaseProperty"],primitive:!0},Int16:{inherits:["BaseProperty"],primitive:!0},Uint16:{inherits:["BaseProperty"],primitive:!0},Int32:{inherits:["BaseProperty"],primitive:!0},Uint32:{inherits:["BaseProperty"],primitive:!0},Bool:{inherits:["BaseProperty"],primitive:!0},Reference:{inherits:["BaseProperty"],primitive:!0},Enum:{inherits:["Int32"],primitive:!0},Int64:{inherits:["BaseProperty"],primitive:!0},Uint64:{inherits:["BaseProperty"],primitive:!0}},i=[],s=[];Object.keys(o).forEach(e=>{o[e].primitive?i.push(e):s.push(e)});t.TypeIdHelper=class TypeIdHelper{static isPrimitiveType(e){return void 0!==e&&""!==e&&("enum<"===e.substr(0,5)||"Reference<"===e.substr(0,10)||i.indexOf(e)>=0)}static isTemplateTypeid(e){return"string"==typeof e&&-1!==e.indexOf(":")}static isReservedType(e){return s.indexOf(e)>=0}static extractVersion(e){if(!e)throw new Error(r.MSG.TYPEID_NOT_DEFINED);const t=e.split("-");return{version:t[1],typeidWithoutVersion:t[0]}}static extractContext(e){const t=e.indexOf("<");if(-1!==t&&">"===e[e.length-1]){let n=e.substr(t+1,e.length-t-2),r=e.substr(0,t);""===n&&(n="set"!==r?"BaseProperty":"NamedProperty");let o=!1;return"enum"!==r&&"enum<"!==n.substr(0,5)||(o=!0,"enum"===r?r="single":n=n.substr(5,n.length-6)),"Reference"===r&&(n="Reference<"+n+">",r="single"),{typeid:n,context:r,isEnum:o}}return{typeid:e,context:"single",isEnum:!1}}static createSerializationTypeId(e,t,n){return"BaseProperty"===e?t+"<>":n?""===t||"single"===t?"enum<"+e+">":t+"<enum<"+e+">>":t+"<"+e+">"}static isReferenceTypeId(e){return"Reference"===e||"Reference<"===e.substr(0,10)&&">"===e.substr(-1)}static extractReferenceTargetTypeIdFromReference(e){return"Reference<"===e.substr(0,10)?e.substr(10,e.length-11):"BaseProperty"}static isSchemaTypeid(e){return"string"==typeof e&&-1!==e.indexOf(":")}static extractTypeId(e){const t=e.match(/\<(.*?)\>/);return null!==t&&t.length>0?t[0].replace(/[\<\>]/gi,""):e}static nativeInheritsFrom(e,t){if(!e||!t)throw new Error(r.MSG.TYPEID_NOT_DEFINED);if("Reference<"===e.substr(0,10)&&(e="Reference"),"Reference<"===t.substr(0,10)&&(t="Reference"),!o[e])throw new Error(r.MSG.TYPEID_NOT_NATIVE+e);if(!o[t])throw new Error(r.MSG.TYPEID_NOT_NATIVE+t);if("BaseProperty"===t||e===t)return!0;if("BaseProperty"===e)return!1;const n=o[e].inherits;for(const e of n)if(this.nativeInheritsFrom(e,t))return!0;return!1}static getPrimitiveTypeIds(){return i}static getReservedTypeIds(){return s}static isCreationType(e){return-1!==["ContainerProperty","NodeProperty","Enum"].indexOf(e)}}},function(e,t){var n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/,o=/^\./,i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,a=/^\[object .+?Constructor\]$/,c=/^(?:0|[1-9]\d*)$/,u="object"==typeof global&&global&&global.Object===Object&&global,l="object"==typeof self&&self&&self.Object===Object&&self,d=u||l||Function("return this")();var p,h=Array.prototype,m=Function.prototype,y=Object.prototype,g=d["__core-js_shared__"],_=(p=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||""))?"Symbol(src)_1."+p:"",v=m.toString,E=y.hasOwnProperty,I=y.toString,b=RegExp("^"+v.call(E).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),S=d.Symbol,C=h.splice,w=getNative(d,"Map"),A=getNative(Object,"create"),O=S?S.prototype:void 0,P=O?O.toString:void 0;function Hash(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ListCache(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function MapCache(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function assignValue(e,t,n){var r=e[t];E.call(e,t)&&eq(r,n)&&(void 0!==n||t in e)||(e[t]=n)}function assocIndexOf(e,t){for(var n=e.length;n--;)if(eq(e[n][0],t))return n;return-1}function baseIsNative(e){return!(!isObject(e)||function isMasked(e){return!!_&&_ in e}(e))&&(function isFunction(e){var t=isObject(e)?I.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)||function isHostObject(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?b:a).test(function toSource(e){if(null!=e){try{return v.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function baseSet(e,t,o,i){if(!isObject(e))return e;for(var s=-1,a=(t=function isKey(e,t){if(x(e))return!1;var o=typeof e;if("number"==o||"symbol"==o||"boolean"==o||null==e||isSymbol(e))return!0;return r.test(e)||!n.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:function castPath(e){return x(e)?e:D(e)}(t)).length,c=a-1,u=e;null!=u&&++s<a;){var l=toKey(t[s]),d=o;if(s!=c){var p=u[l];void 0===(d=i?i(p,l,u):void 0)&&(d=isObject(p)?p:isIndex(t[s+1])?[]:{})}assignValue(u,l,d),u=u[l]}return e}function getMapData(e,t){var n=e.__data__;return function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function getNative(e,t){var n=function getValue(e,t){return null==e?void 0:e[t]}(e,t);return baseIsNative(n)?n:void 0}function isIndex(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||c.test(e))&&e>-1&&e%1==0&&e<t}Hash.prototype.clear=function hashClear(){this.__data__=A?A(null):{}},Hash.prototype.delete=function hashDelete(e){return this.has(e)&&delete this.__data__[e]},Hash.prototype.get=function hashGet(e){var t=this.__data__;if(A){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return E.call(t,e)?t[e]:void 0},Hash.prototype.has=function hashHas(e){var t=this.__data__;return A?void 0!==t[e]:E.call(t,e)},Hash.prototype.set=function hashSet(e,t){return this.__data__[e]=A&&void 0===t?"__lodash_hash_undefined__":t,this},ListCache.prototype.clear=function listCacheClear(){this.__data__=[]},ListCache.prototype.delete=function listCacheDelete(e){var t=this.__data__,n=assocIndexOf(t,e);return!(n<0)&&(n==t.length-1?t.pop():C.call(t,n,1),!0)},ListCache.prototype.get=function listCacheGet(e){var t=this.__data__,n=assocIndexOf(t,e);return n<0?void 0:t[n][1]},ListCache.prototype.has=function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1},ListCache.prototype.set=function listCacheSet(e,t){var n=this.__data__,r=assocIndexOf(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},MapCache.prototype.clear=function mapCacheClear(){this.__data__={hash:new Hash,map:new(w||ListCache),string:new Hash}},MapCache.prototype.delete=function mapCacheDelete(e){return getMapData(this,e).delete(e)},MapCache.prototype.get=function mapCacheGet(e){return getMapData(this,e).get(e)},MapCache.prototype.has=function mapCacheHas(e){return getMapData(this,e).has(e)},MapCache.prototype.set=function mapCacheSet(e,t){return getMapData(this,e).set(e,t),this};var D=memoize((function(e){e=function toString(e){return null==e?"":function baseToString(e){if("string"==typeof e)return e;if(isSymbol(e))return P?P.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)}(e);var t=[];return o.test(e)&&t.push(""),e.replace(i,(function(e,n,r,o){t.push(r?o.replace(s,"$1"):n||e)})),t}));function toKey(e){if("string"==typeof e||isSymbol(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function memoize(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var memoized=function(){var n=arguments,r=t?t.apply(this,n):n[0],o=memoized.cache;if(o.has(r))return o.get(r);var i=e.apply(this,n);return memoized.cache=o.set(r,i),i};return memoized.cache=new(memoize.Cache||MapCache),memoized}function eq(e,t){return e===t||e!=e&&t!=t}memoize.Cache=MapCache;var x=Array.isArray;function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function isSymbol(e){return"symbol"==typeof e||function isObjectLike(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==I.call(e)}e.exports=function set(e,t,n){return null==e?e:baseSet(e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(98);t.BaseProperty=r.BaseProperty;var o=n(140);t.ContainerProperty=o.ContainerProperty;var i=n(679);t.ArrayProperty=i.ArrayProperty;var s=n(296);t.IndexedCollectionBaseProperty=s.IndexedCollectionBaseProperty;var a=n(690);t.MapProperty=a.MapProperty;var c=n(691);t.NodeProperty=c.NodeProperty;var u=n(54);t.ValueProperty=u.ValueProperty,t.Uint8Property=u.Uint8Property,t.Uint16Property=u.Uint16Property,t.Uint32Property=u.Uint32Property,t.Uint64Property=u.Uint64Property,t.Int8Property=u.Int8Property,t.Int16Property=u.Int16Property,t.Int32Property=u.Int32Property,t.Int64Property=u.Int64Property,t.EnumProperty=u.EnumProperty,t.Float32Property=u.Float32Property,t.Float64Property=u.Float64Property,t.BoolProperty=u.BoolProperty,t.StringProperty=u.StringProperty,t.ValueArrayProperty=u.ValueArrayProperty,t.Int8ArrayProperty=u.Int8ArrayProperty,t.Int16ArrayProperty=u.Int16ArrayProperty,t.Int32ArrayProperty=u.Int32ArrayProperty,t.Int64ArrayProperty=u.Int64ArrayProperty,t.Uint8ArrayProperty=u.Uint8ArrayProperty,t.Uint16ArrayProperty=u.Uint16ArrayProperty,t.Uint32ArrayProperty=u.Uint32ArrayProperty,t.Uint64ArrayProperty=u.Uint64ArrayProperty,t.Float32ArrayProperty=u.Float32ArrayProperty,t.Float64ArrayProperty=u.Float64ArrayProperty,t.BoolArrayProperty=u.BoolArrayProperty,t.StringArrayProperty=u.StringArrayProperty,t.EnumArrayProperty=u.EnumArrayProperty,t.ValueMapProperty=u.ValueMapProperty,t.Int8MapProperty=u.Int8MapProperty,t.Int16MapProperty=u.Int16MapProperty,t.Int32MapProperty=u.Int32MapProperty,t.Int64MapProperty=u.Int64MapProperty,t.Uint8MapProperty=u.Uint8MapProperty,t.Uint16MapProperty=u.Uint16MapProperty,t.Uint32MapProperty=u.Uint32MapProperty,t.Uint64MapProperty=u.Uint64MapProperty,t.Float32MapProperty=u.Float32MapProperty,t.Float64MapProperty=u.Float64MapProperty,t.BoolMapProperty=u.BoolMapProperty,t.StringMapProperty=u.StringMapProperty},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(76)),i=r(n(60)),s=n(15),a=n(94);t.BaseProperty=class BaseProperty{constructor(e){this._isDirty=!0,this._id=e.id?e.id:"",this._context=e.context?e.context:this.getDefaultContext(),this._typeid=e.typeid?e.typeid:this.getDefaultTypeid(),this._isConstant=!1,this._parent=void 0,this._listeners=[]}getDefaultTypeid(){return"BaseProperty"}getDefaultContext(){return"single"}getTypeid(){return this._typeid}get isDirty(){return this._isDirty}set isDirty(e){const t=this._isDirty;this._isDirty=e,t!==this.isDirty&&this.notifyListeners()}isDegraded(){return void 0!==this._remoteVersion}getContext(){return this._context}setRemoteVersion(e){this._remoteVersion=e}getFullTypeid(e=!1){return this._typeid}isRoot(){return void 0===this._parent}isDescendantOf(e){return e.isAncestorOf(this)}getParent(){return this._parent}getId(){return this._id}isPrimitiveType(){return a.TypeIdHelper.isPrimitiveType(this._typeid)}prettyPrint(e){this._prettyPrint("","",e)}getAbsolutePath(){const e=[],t=this.isRoot()?[]:[this.getParent().getPathSegmentForChildNode(this)];this.traverseUp((function(n){n.getParent()?t.push(n.getParent().getPathSegmentForChildNode(n)):e.length>0&&t.push(e[0].getAbsolutePath().slice(1))}));let n=t.reverse().join("");return n[0]===s.PROPERTY_PATH_DELIMITER&&(n=n.substr(1)),n="/"+n,n}traverseUp(e){if(this._parent){return e(this._parent)!==s.BREAK_TRAVERSAL?this._parent.traverseUp(e):s.BREAK_TRAVERSAL}}getRoot(){let e;return e=this._parent?this._parent.getRoot():this,e}_isLeaf(){return!1}_setParent(e){this._parent=e}_setId(e){if(!o.default(e)&&!i.default(e))throw new Error(s.MSG.ID_STRING_OR_NUMBER+e);if(void 0!==this._parent)throw new Error(s.MSG.ID_CHANGE_FOR_PROPERTY_WITH_PARENT+this._id+" to id: "+e);return this._id=String(e),e}_getIndirectPath(e){const t=[],n=this;return e.traverseUp((function(e){if(t.push("../"),e===n)return s.BREAK_TRAVERSAL;const r=n._getDirectPath(e);return r?(t.push(r),s.BREAK_TRAVERSAL):void 0}))===s.BREAK_TRAVERSAL?t.join(""):void 0}_getDirectPath(e){const t=[];let n=void 0;if(e===this?n=s.BREAK_TRAVERSAL:this.getParent()&&(t.push(this.getParent().getPathSegmentForChildNode(this)),n=this.traverseUp((function(n){if(n===e)return s.BREAK_TRAVERSAL;const r=n.getParent();r&&t.push(r.getPathSegmentForChildNode(n))}))),n===s.BREAK_TRAVERSAL){let e=t.reverse().join("");return e[0]===s.PROPERTY_PATH_DELIMITER&&(e=e.substr(1)),e}}_getAllRelativePaths(e){const t=this._getDirectPath(e);if(void 0!==t)return[t];{const t=this._getIndirectPath(e);return t?[t]:[]}}getRelativePath(e){return(this._getAllRelativePaths(e)||[])[0]}_checkIsNotReadOnly(e){if(this._isConstant&&e)throw new Error(s.MSG.MODIFICATION_OF_CONSTANT_PROPERTY)}_setAsConstant(){this._isConstant=!0}_unsetAsConstant(){this._isConstant=!1}_validateInsertIn(e,t){if(void 0!==this._parent)throw new Error(s.MSG.INSERTED_ENTRY_WITH_PARENT);let n=e;for(;void 0!==n;){if(n===this)throw new Error(s.MSG.INSERTED_IN_OWN_CHILDREN);n=n.getParent()}}getExtendedTypeid(){let e=this._typeid;return this._remoteVersion&&(e=`${a.TypeIdHelper.extractVersion(e).typeidWithoutVersion}-${this._remoteVersion}`),"single"!==this._context?`${this._context}<${e}>`:e}_setDirty(e){this._isDirty||(this.isDirty=!0),this._parent&&this._parent._setDirty(this._id)}clean(){this._isDirty&&(this.cleanSelf(),this._parent&&this._parent.childWasCleaned(this._id))}cleanSelf(){this.isDirty=!1}addOnDirtyListener(e){this._listeners.push(e)}notifyListeners(){for(const e of this._listeners)e(this,this.isDirty)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(676);t.ChangeSet=r.ChangeSet;var o=n(678);t.ChangeSetOperations=o.ChangeSetOperations},function(e,t){var n=/^(?:0|[1-9]\d*)$/;function arrayEach(e,t){for(var n=-1,r=e?e.length:0;++n<r&&!1!==t(e[n],n,e););return e}var r=Object.prototype,o=r.hasOwnProperty,i=r.toString,s=r.propertyIsEnumerable,a=function overArg(e,t){return function(n){return e(t(n))}}(Object.keys,Object);function arrayLikeKeys(e,t){var n=l(e)||function isArguments(e){return function isArrayLikeObject(e){return function isObjectLike(e){return!!e&&"object"==typeof e}(e)&&isArrayLike(e)}(e)&&o.call(e,"callee")&&(!s.call(e,"callee")||"[object Arguments]"==i.call(e))}(e)?function baseTimes(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],r=n.length,a=!!r;for(var c in e)!t&&!o.call(e,c)||a&&("length"==c||isIndex(c,r))||n.push(c);return n}var c=function createBaseEach(e,t){return function(n,r){if(null==n)return n;if(!isArrayLike(n))return e(n,r);for(var o=n.length,i=t?o:-1,s=Object(n);(t?i--:++i<o)&&!1!==r(s[i],i,s););return n}}((function baseForOwn(e,t){return e&&u(e,t,keys)})),u=function createBaseFor(e){return function(t,n,r){for(var o=-1,i=Object(t),s=r(t),a=s.length;a--;){var c=s[e?a:++o];if(!1===n(i[c],c,i))break}return t}}();function baseKeys(e){if(!function isPrototype(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||r;return e===n}(e))return a(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}function isIndex(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||n.test(e))&&e>-1&&e%1==0&&e<t}var l=Array.isArray;function isArrayLike(e){return null!=e&&function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!function isFunction(e){var t=function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?i.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)}function keys(e){return isArrayLike(e)?arrayLikeKeys(e):baseKeys(e)}function identity(e){return e}e.exports=function forEach(e,t){return(l(e)?arrayEach:c)(e,"function"==typeof t?t:identity)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.MAIN="main",e.REMOTE="remote",e.ISOLATED="isolated"}(t.JournalType||(t.JournalType={}))},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(61)),i=r(n(198)),s=n(306),a={$eq:"==",$gt:"=gt=",$gte:"=ge=",$lt:"=lt=",$lte:"=le=",$ne:"!=",$in:"=in=",$nin:"=out="},c={$or:",",$and:";"};class FiltersBuilder{constructor(e){this.filters=e?FiltersBuilder.optimize("string"==typeof e?FiltersBuilder.parseToObject(e):e):{}}appendCondition(e,t,n="$eq"){if(void 0!==t)if(this.filters[e]||(this.filters[e]={}),"$eq"===n||"$ne"===n){let r;s.attributesMultiple.includes(e)?(r=this.filters[e][n]?"string"==typeof this.filters[e][n]?[this.filters[e][n]]:this.filters[e][n]:[],"string"==typeof t?r.push(t):r=[...r,...t]):r=t,"$eq"===n?this.filters[e]={$eq:r}:this.filters[e].$ne=r}else this.filters[e][n]=t;return this}toObject(){return this.filters}build(){const e=FiltersBuilder.containerToRSQL(this.filters);return e.length?e:void 0}static optimize(e){const t=new Map,n=new Array,r={};return FiltersBuilder.optimizeBranch(e,t,n),t.forEach((e,t)=>{r[t]=e}),n.length>1?r.$and=n:n.length>0&&(r.$or=n[0]),r}static optimizeBranch(e,t,n){if(Object.keys(i.default(e,["$and","$or"])).forEach(n=>{const r=e[n];if(t.has(n)){const e=t.get(n);t.set(n,FiltersBuilder.concatAttributeConditions(e,r,s.attributesMultiple.includes(n)))}else t.set(n,"string"==typeof e[n]||Array.isArray(e[n])?{$eq:e[n]}:e[n])}),e.$and&&e.$and.forEach(e=>{FiltersBuilder.optimizeBranch(e,t,n)}),e.$or){const t=[];e.$or.forEach(e=>{t.push(FiltersBuilder.optimize(e))}),n.push(t)}}static concatAttributeConditions(e,t,n=!1){const r=i.default(e,["$eq","$ne"]),o=i.default(t,["$eq","$ne"]);let s={},a={};if(Object.keys(r).filter(e=>Object.keys(o).includes(e)).length>0)throw new Error("Inconsistency: multiples conditions with same operator for the same attribute");if(!n&&e.$eq&&t.$eq)throw new Error("Inconsistency: multiples conditions with same operator for the same attribute");if(!n&&e.$ne&&t.$ne)throw new Error("Inconsistency: multiples conditions with same operator for the same attribute");return s=e.$eq||t.$eq?{$eq:[...e.$eq?e.$eq:[],...t.$eq?t.$eq:[]]}:{},a=e.$ne||t.$ne?{$ne:[...e.$ne?e.$ne:[],...t.$ne?t.$ne:[]]}:{},Object.assign(Object.assign(Object.assign(Object.assign({},r),o),s),a)}static containerToRSQL(e,t=";"){return Object.keys(e).sort().map(t=>{const n=e[t];return Object.keys(c).includes(t)?`(${n.map(e=>Object.keys(e).length>1?`(${FiltersBuilder.containerToRSQL(e)})`:FiltersBuilder.containerToRSQL(e)).sort().join(c[t])})`:"object"==typeof n?FiltersBuilder.comparisonToRSQL(t,n):FiltersBuilder.valueToRSQL(t,n)}).join(t)}static comparisonToRSQL(e,t){const n=s.attributesMultiple.includes(e);return Object.keys(t).sort().map(r=>{const o=t[r];return!n||"$eq"!==r&&"$ne"!==r?"$in"===r||"$nin"===r?FiltersBuilder.valuesToRSQL(e,o,r):FiltersBuilder.valueToRSQL(e,o,r):FiltersBuilder.multipleValuesToRSQL(e,o,r)}).join(";")}static valuesToRSQL(e,t,n){return`${e}${o.default(a,n)}(${`"${t.join('","')}"`})`}static multipleValuesToRSQL(e,t,n){return"string"==typeof t?FiltersBuilder.valueToRSQL(e,t,n):t.map(t=>FiltersBuilder.valueToRSQL(e,t,n)).join(";")}static valueToRSQL(e,t,n="$eq"){return`${e}${o.default(a,n)}"${t}"`}static setType(e){let t=e;const n=/^(["']{1})(.*)(["']{1})$/g.exec(e);if(n)t=n[2];else if("true"===e)t=!0;else if("false"===e)t=!1;else if(isNaN(Number(e))){if(/(\d{4})-(\d{2})-(\d{2})/g.exec(e)&&Date.parse(e)){const n=new Date(e).toISOString();t=new Date(`"${n}"`)}}else t=Number(e);return t}static parseToObject(e){let t="";const n=[],r=[];let o=!1;const i=[";",","],s=["=in=","=out="];for(let a=0;a<e.length;a++){const c=e[a];if(-1!==i.indexOf(c))if(o)t+=c;else{let e=r[r.length-1];for(t&&(n.push(t),t="");-1!==i.indexOf(e);)e===c?r.pop():n.push(r.pop()),e=r[r.length-1];r.push(c)}else if("("===c)-1!==s.indexOf(t.substring(t.length-4,t.length))||-1!==s.indexOf(t.substring(t.length-5,t.length))?(o=!0,t+=c):r.push(c);else if(")"===c)if(o)o=!1,t+=c;else{for(t&&(n.push(t),t="");"("!==r[r.length-1];)n.push(r.pop());r.pop()}else t+=c}for(t&&(n.push(t),t="");r.length>0;)n.push(r.pop());const a=[];let c=[];for(let e=0;e<n.length;e++)if(-1!==i.indexOf(n[e])){const t={},r=[];switch(n[e]){case";":case",":if(e===n.length-1||1===a.length&&1===c.length)for(;c.length>0;)r.push(c.shift());for(;a.length>0;)r.push(a.shift());";"===n[e]?t.$and=r:t.$or=r;break;default:throw new Error("Logical operator not supported.")}c.push(t)}else{if(/(\$\w+:)/g.exec(n[e]))throw new Error("Injection detected.");const t=/(.*)(==|!=|=gt=|=ge=|=lt=|=le=|=in=|=out=|=~)(.*)/g.exec(n[e]);let r,o,i;try{[,r,i,o]=t}catch(e){throw new Error("Wrong RSQL query. No operator found.")}let s=FiltersBuilder.setType(o);const c={},u=new Array;switch(i){case"==":c[r]={$eq:s};break;case"!=":c[r]={$ne:s};break;case"=gt=":c[r]={$gt:s};break;case"=ge=":c[r]={$gte:s};break;case"=lt=":c[r]={$lt:s};break;case"=le=":c[r]={$lte:s};break;case"=in=":s=s.replace("(",""),s=s.replace(")",""),s.split(",").forEach(e=>{u.push(FiltersBuilder.setType(e.trim()))}),c[r]={$in:u};break;case"=out=":s=s.replace("(",""),s=s.replace(")",""),s.split(",").forEach(e=>{u.push(FiltersBuilder.setType(e.trim()))}),c[r]={$nin:u};break;case"=~":c[r]={$regex:s};break;default:throw new Error("Operator not supported.")}a.push(c)}return 1===a.length&&0===c.length&&(c=a),c[0]||null}}t.FiltersBuilder=FiltersBuilder},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCode=void 0;class ErrorCode{constructor(e,t){this.id=e,this.description=t}}t.ErrorCode=ErrorCode,ErrorCode.UNKNOWN=new ErrorCode("UNKNOWN","Unknown error"),ErrorCode.L5_GEN_INVALID_VALUE=new ErrorCode("L5_GEN_INVALID_VALUE","A required value is empty, null or undefined."),ErrorCode.L5_GEN_DUPLICATE_ID=new ErrorCode("L5_GEN_DUPLICATE_ID","A provided ID to insert already exists in store."),ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST=new ErrorCode("L5_ENTITY_STORE_ENTITY_NOT_EXIST","The requested Entity does not exist in current EntityStore."),ErrorCode.L5_ENTITY_STORE_ENTITY_ALREADY_EXIST=new ErrorCode("L5_ENTITY_STORE_ENTITY_ALREADY_EXIST","The entity already exists in current EntityStore."),ErrorCode.L5_ENTITY_STORE_MV_ALREADY_EXIST=new ErrorCode("L5_ENTITY_STORE_MV_ALREADY_EXIST","The materialized view already exists for current revision."),ErrorCode.L5_ENTITY_QUERY_FIELD_NOT_ALLOWED=new ErrorCode("L5_ENTITY_QUERY_FIELD_NOT_ALLOWED","The field is not allowed."),ErrorCode.L5_QUERY_OPERATOR_NOT_SUPPORTED=new ErrorCode("L5_QUERY_OPERATOR_NOT_SUPPORTED","The operator is not supported."),ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST=new ErrorCode("L5_JOURNAL_STORE_JOURNAL_NOT_EXIST","The requested Journal does not exist in current JournalStore."),ErrorCode.L5_JOURNAL_STORE_PARENT_JOURNAL_NOT_EXIST=new ErrorCode("L5_JOURNAL_STORE_PARENT_JOURNAL_NOT_EXIST","The requested parent Journal does not exist in the current JournalStore."),ErrorCode.L5_JOURNAL_STORE_JOURNAL_ALREADY_EXIST=new ErrorCode("L5_JOURNAL_STORE_JOURNAL_ALREADY_EXIST","The journal already exists in the current journal store."),ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST=new ErrorCode("L5_JOURNAL_STORE_COMMAND_NOT_EXIST","The requested Command does not exist in the current JournalStore."),ErrorCode.L5_ENTITY_STORE_REVISION_ALREADY_EXIST=new ErrorCode("L5_ENTITY_STORE_REVISION_ALREADY_EXIST","The revision already exists for the specified journal."),ErrorCode.L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL=new ErrorCode("L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL","The requested revision does not exist for the specified journal or the journal does not exist"),ErrorCode.L5_ENTITY_STORE_REVISION_NOT_EXIST=new ErrorCode("L5_ENTITY_STORE_REVISION_NOT_EXIST","The requested revision does not exist for the specified entity."),ErrorCode.L5_ENTITY_STORE_ENTITY_IS_REMOVED=new ErrorCode("L5_ENTITY_STORE_ENTITY_IS_REMOVED","The requested entity was already removed"),ErrorCode.L5_ENTITY_STORE_ENTITY_IS_NOT_REMOVED=new ErrorCode("L5_ENTITY_STORE_ENTITY_IS_NOT_REMOVED","The requested entity has not been removed from the journal"),ErrorCode.L5_ENTITY_STORE_CANNOT_UPDATE_ENTITY_TYPE=new ErrorCode("L5_ENTITY_STORE_CANNOT_UPDATE_ENTITY_TYPE","The entity type cannot be updated"),ErrorCode.L5_ENTITY_STORE_CANNOT_DELETE_ENTITY=new ErrorCode("L5_ENTITY_STORE_CANNOT_DELETE_ENTITY","The entity cannot be deleted"),ErrorCode.L5_JOURNAL_STORE_COLLECTION_NOT_EXIST=new ErrorCode("L5_JOURNAL_STORE_COLLECTION_NOT_EXIST","The requested Collection does not exist in current JournalStore."),ErrorCode.L5_JOURNAL_STORE_TRANSFER_CONFLICT=new ErrorCode("L5_JOURNAL_STORE_TRANSFER_CONFLICT","There was a conflict transferring data.")},function(e,t,n){var r=n(105),o=n(879),i=n(880),s=r?r.toStringTag:void 0;e.exports=function baseGetTag(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?o(e):i(e)}},function(e,t,n){var r=n(48).Symbol;e.exports=r},function(e,t,n){var r=n(344),o=n(209);e.exports=function isArrayLike(e){return null!=e&&o(e.length)&&!r(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StoreError=void 0;class StoreError extends Error{constructor(e,t,n){super(t),this.code=e,this.details=t,this.innerError=n}toJSON(){var e;return{code:this.code.id,details:null!==(e=this.details)&&void 0!==e?e:this.code.description,error:JSON.stringify(this.innerError)}}}t.StoreError=StoreError},function(e,t,n){var r=n(104),o=n(65);e.exports=function isSymbol(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==r(e)}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(61)),i=r(n(96)),s=r(n(13)),a=n(6),c=n(2),u=n(219);class OfflineEntityWrapper{static initialize(e,t){const n=new OfflineEntityWrapper,r={};if(n.entityInfo=r,e){const l=o.default(e,["staticData"]);l&&(i.default(r,["staticDataChanges"],l),i.default(r,["staticDataChanges","attributes"],a.AttributeConverter.convertAttributesToSerializedChangeset(o.default(r,["staticDataChanges","attributes"]))));const d=o.default(e,["data"]);s.default(d)||(Array.isArray(d)?(n.fullComponentView=u.ChangesetMerger.mergeAndNormalizeChangesetList(d.map(e=>e.components||{})),n.assets=u.ChangesetMerger.mergeAndNormalizeChangesetList(d.map(e=>OfflineEntityWrapper.alignAsset(e.assets)||{}))):(n.fullComponentView=d.components,n.assets=OfflineEntityWrapper.alignAsset(d.assets)));const p=o.default(e,["parentEntityId"]);p&&n.setParentId(p);const h=o.default(e,["createdBy"]);h&&n.setCreatedBy(h);const m=o.default(e,["lastModifiedBy"]);if(m&&n.setLastModifiedBy(m),void 0!==t&&n.getEntityType()!==t)throw new c.InternalError(`Trying to build wrapper for ${t} but entity type is ${n.getEntityType()}`)}return n}getFullEntity(){return this.entityInfo}getEntityType(){return o.default(this.entityInfo,["staticDataChanges","metadata","entityType"])}setEntityType(e){return i.default(this.entityInfo,["staticDataChanges","metadata","entityType"],e)}getTypeId(){return o.default(this.entityInfo,["staticDataChanges","metadata","type"])}setTypeId(e){return i.default(this.entityInfo,["staticDataChanges","metadata","type"],e)}getSpaceId(){return this.getParentId()}setAsPlaceholder(){i.default(this.entityInfo,["staticDataChanges","metadata","isPlaceholder"],!0)}setSpaceId(e){return this.setParentId(e),this.getParentId()}getSpaceCollectionId(){return o.default(this.entityInfo,["staticDataChanges","metadata","spaceCollectionId"])}setSpaceCollectionId(e){return i.default(this.entityInfo,["staticDataChanges","metadata","spaceCollectionId"],e)}getAttributes(){return o.default(this.entityInfo,["staticDataChanges","attributes"])}setAttributes(e){i.default(this.entityInfo,["staticDataChanges","attributes"],u.ChangesetMerger.mergeAndNormalizeChangesetList([this.getAttributes()||{},a.AttributeConverter.convertAttributesToSerializedChangeset(e)]))}getComponentsChanges(){return o.default(this.entityInfo,["dataChanges","components"])}getFullComponentView(){return this.fullComponentView}getCreatedBy(){return o.default(this.entityInfo,["staticDataChanges","createdBy"])}setCreatedBy(e){i.default(this.entityInfo,["staticDataChanges","createdBy"],e)}getLastModifiedBy(){return o.default(this.entityInfo,["staticDataChanges","lastModifiedBy"])}setLastModifiedBy(e){i.default(this.entityInfo,["staticDataChanges","lastModifiedBy"],e)}setComponents(e){this.fullComponentView=u.ChangesetMerger.mergeAndNormalizeChangesetList([this.fullComponentView,e]),i.default(this.entityInfo,["dataChanges","components"],e)}getId(){return o.default(this.entityInfo,["entityId"])}setId(e){i.default(this.entityInfo,["entityId"],e)}getRevisionId(){return o.default(this.entityInfo,["revisionId"])}setRevisionId(e){i.default(this.entityInfo,["revisionId"],e)}getParentId(){return o.default(this.entityInfo,["parentEntityId"])}setParentId(e){i.default(this.entityInfo,["parentEntityId"],e)}setAssets(e){this.assets=e,i.default(this.entityInfo,["dataChanges","assets"],e)}getAssets(){return this.assets}setFromId(e){i.default(this.entityInfo,["staticDataChanges","metadata","from","assetId"],e)}getFromId(){return o.default(this.entityInfo,["staticDataChanges","metadata","from","assetId"])}setToId(e){i.default(this.entityInfo,["staticDataChanges","metadata","to","assetId"],e)}getToId(){return o.default(this.entityInfo,["staticDataChanges","metadata","to","assetId"])}setFromSnapshotId(e){i.default(this.entityInfo,["staticDataChanges","metadata","from","snapshotId"],e)}getFromSnapshotId(){return o.default(this.entityInfo,["staticDataChanges","metadata","from","snapshotId"])}setToSnapshotId(e){i.default(this.entityInfo,["staticDataChanges","metadata","to","snapshotId"],e)}getToSnapshotId(){return o.default(this.entityInfo,["staticDataChanges","metadata","to","snapshotId"])}static alignAsset(e){return!e||s.default(e)?{}:e.insert||e.modify||e.remove?e:a.AssetsConverter.convertAssetsToChangeSet(e).serializedChangeSet}}t.OfflineEntityWrapper=OfflineEntityWrapper},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2),o=n(163);t.validateServerCommandResponse=function validateServerCommandResponse(e){let t;if(t="FAILED"===e.status?new r.CommandError(e.result.error.message,e.result.error.trackingId,e.result.error):o.validateNotProcessedResponse(e),t)throw new r.ServerError(t.message,t.code,t.innerError);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(231);t.CreateEntityBlueprint=r.CreateEntityBlueprint;var o=n(1047);t.UpdateEntityBlueprint=o.UpdateEntityBlueprint},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class PimError extends Error{constructor(e,t,n){super(`${e.description}${t?": "+t:""}`),this.code=e,this.details=t,this.innerError=n,this.stack=(new Error).stack}}t.PimError=PimError},function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.VERSION_0_1_0="0.1.0",e.VERSION_1_0_0="1.0.0"}(r=t.PIM_SCHEMAS_VERSIONS||(t.PIM_SCHEMAS_VERSIONS={})),t.PIM_DEFAULT_SCHEMAS_VERSION=r.VERSION_1_0_0,function(e){e.ASSEMBLY_REF="assemblyRef",e.CONTAINED="contained",e.CONTAINS="contains",e.DESCRIBES="describes",e.DERIVED="derived",e.USE="use",e.XREF="xRef",e.DESIGN="design",e.ITEM="item",e.MODEL="model",e.DRAWING="drawing",e.PRODUCT="product",e.CAM="cam",e.DOCUMENTATION="documentation",e.SHEETS="sheets",e.LIFECYCLE="lifecycle",e.RELEASE="release",e.MILESTONE="milestone",e.SNAPSHOT="snapshot",e.UNKNOWN="unknown",e.PROCESS="process"}(o=t.PIM_FAMILY||(t.PIM_FAMILY={})),function(e){e.ACE_MANAGED_EXTENSION="components.aceManageExtension",e.CAM="components.cam",e.COMPONENT_INSTANCE="components.componentInstance",e.DELETE_STATUS="components.deleteStatus",e.DRAWING="components.drawing",e.ECO="components.eco",e.ERROR="components.error",e.INTERNAL_COMPONENT="components.internalComponent",e.INTERNAL_FLAG="components.internalFlag",e.ITEM_NUMBER="components.itemNumber",e.LIFECYCLE="components.lifecycle",e.MATERIAL="components.material",e.MILESTONE="components.milestone",e.NAME="components.name",e.PART_NUMBER="components.partNumber",e.PHYSICAL_PROPERTIES="components.physicalProperties",e.PRODUCT="components.product",e.RELEASE="components.release",e.SNAPSHOT="components.snapshot",e.REVISION="components.revision",e.TRANSFORMATION="components.transformation",e.VERSION="components.version",e.WIP_REFERENCE="components.WIPReference",e.ERROR_STATUS="components.errorStatus",e.UNKNOWN="unknown"}(t.PIM_COMPONENT_FAMILY||(t.PIM_COMPONENT_FAMILY={})),t.PIM_FAMILIES=Object.values(o),t.PIM_FAMILY_PREFIX={ASSETS:"assets",RELATIONSHIP:"relationship",SNAPSHOT:"snapshot",ASSETGRAPH:"assetgraph"},t.PIM_FAMILY_PREFIXES=Object.values(t.PIM_FAMILY_PREFIX),t.ITEM_FAMILIES=[o.PRODUCT,o.CAM]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentKeys={PRODUCT:"product",PART_NUMBER:"partNumber",PHYSICAL_PROPERTIES:"physicalProperties",MATERIAL:"material",SNAPSHOT:"snapshot",WIP_REFERENCE:"wipReference",DELETE_STATUS:"deleteStatus",VERSION:"version",COMPONENT_INSTANCE:"componentInstance",INTERNAL_FLAG:"internalFlag",ERROR_STATUS:"errorStatus"}},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(486)),__export(n(69)),__export(n(169))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(7),i=n(1),s=n(43),a=n(17),c=n(33),u=n(3),l=n(493),d=n(70);async function getAssetAndRevisionIdsForSnapshot(e,t){const n={startAssets:[{asset:e}],relationshipFilters:[{direction:"OUT",type:{name:i.PIM_CONTAINS_RELATIONSHIP_TYPENAME}}],include:{assetComponents:!0},maxDepth:0},o=(await e.getSpace({fetch:!1,assumeTypeId:r.assetGraphTypeId})).getClosureV2Traverser(n),a=new Set,u={};await o.traverse(n.startAssets,async e=>{const n=e.asset,o=e.asset.getRevisionId();if(t.includes(c.getFamily(n))){const e=n.spaceId;return(s.isSoftDeleted(n)||s.isFileSoftDeleted(n))&&a.add(e),((e,t,n)=>{u[e]=u[e]||[],u[e].push({id:n.getId(),revisionId:t})})(e,o,n),r.TraversalAction.Continue}return r.TraversalAction.AbortThis});const l=[];for(const e in u)a.has(e)||l.push(...u[e]);return l}async function createVersionSnapshotWithAssets(e,t,n,r,o){if((r=r||{}).createTime&&!u.isDateFormatString(r.createTime)||r.lastModifiedTime&&!u.isDateFormatString(r.lastModifiedTime))throw new a.PimError(a.GEN_ERROR_COMMAND,"Invalid date format string");const i=e.pimGetSchemasVersion(),s=d.getPimSchemaFactory(i);return await e.pimCreateSnapshot(t,n,s.getVersionSnapshotPayload(r),o)}t.createVersionSnapshotWithAssets=createVersionSnapshotWithAssets,o.failIfExistsOnSDK("pimCreateVersionSnapshot"),r.FDModelingSDK.prototype.pimCreateVersionSnapshot=async function(e,t,n,r){if(l.getSkipValidation(r))e=u.isString(e)?await this.getSpaceCollection(e):e,t=u.isString(t)?await this.getAsset(t,e,{fetch:!0}):t;else{const n=await l.createVersionSnapshotValidator(this,e,t);if(!n.pass)throw new a.PimError(a.GEN_ERROR_COMMAND,"Could not create the snapshot on this product");t=n.asset,e=n.spaceCollection}const o=await getAssetAndRevisionIdsForSnapshot(t,[i.PIM_FAMILY.PRODUCT,i.PIM_FAMILY.DESIGN,i.PIM_FAMILY.MODEL]);return await createVersionSnapshotWithAssets(this,e,o,n)},o.failIfExistsOnSDK("pimCreateDocumentationVersionSnapshot"),r.FDModelingSDK.prototype.pimCreateDocumentationVersionSnapshot=async function(e,t,n,r){if(l.getSkipValidation(r))e=u.isString(e)?await this.getSpaceCollection(e):e,t=u.isString(t)?await this.getAsset(t,e,{fetch:!0}):t;else{const n=await l.createDocumentationVersionSnapshotValidator(this,e,t);if(!n.pass)throw new a.PimError(a.GEN_ERROR_COMMAND,"Could not create the snapshot on this documentation");t=n.asset,e=n.spaceCollection}const o=await getAssetAndRevisionIdsForSnapshot(t,[i.PIM_FAMILY.DOCUMENTATION,i.PIM_FAMILY.DRAWING,i.PIM_FAMILY.SHEETS]);return await createVersionSnapshotWithAssets(this,e,o,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(245),o=n(5),i=n(1211),s=n(519),a=n(173);function makeJournalId(){return r.v4()}function matchesLayout(e,t){const n=e.pimStateService.isJournalReorderingEnabled(),r=t[a.JournalTagNames.LAYOUT]?t[a.JournalTagNames.LAYOUT]:a.JOURNAL_TAG_LAYOUT.TREE;return n&&r===a.JOURNAL_TAG_LAYOUT.CHAIN||!n&&r===a.JOURNAL_TAG_LAYOUT.TREE}function checkInvariantId(e,t,n,r){if(!n&&!r)return!1;if(!e.documentIdentityService)return console.log("[journal]: Missing documentIdentityService. Cannot check invariant id."),!1;return e.documentIdentityService.findInvariantIdSync(r,n)===t}async function addTagsToJournal(e,t){const n=await e.getProperties();await e.setProperties(Object.assign(Object.assign({},n),t))}async function getTagValueFromJournal(e,t){return(await e.getProperties())[t]}async function isJournalInUse(e){return!!(await e.getProperties())[a.JournalTagNames.IN_USE_UPLOAD]}async function cleanJournalChain(e,t,n){await Promise.all(t.isolationJournals.map(async t=>{if(n(t))return await e.reset(t.journalId),e.deleteIsolationJournal(t.journalId)}))}async function findTailIsolationJournalId(e,t){const n=e.isolationJournals;if(0===n.length)return;if(1===n.length)return n[0].properties[a.JournalTagNames.LAYOUT]===a.JOURNAL_TAG_LAYOUT.CHAIN?n[0].journalId:void 0;const buildPair=(e,t)=>`${e}->${t}`,r=new Set,o=new Set,i=new Set;for(const c of n)if(c.properties[a.JournalTagNames.LAYOUT]===a.JOURNAL_TAG_LAYOUT.CHAIN){if(c.parentJournalId){if(r.has(buildPair(c.parentJournalId,c.journalId)))throw await cleanJournalChain(t,e,s.isChainJournalPredicate),new Error("No tail isolation journal found. This may indicate a circular dependency.");r.add(buildPair(c.journalId,c.parentJournalId))}null!==c.parentJournalId&&(o.delete(c.parentJournalId),i.add(c.parentJournalId)),i.has(c.journalId)||o.add(c.journalId)}if(o.size>1)throw await cleanJournalChain(t,e,s.isChainJournalPredicate),new Error("More than 1 tail journal found: "+Array.from(o));return 0!==o.size?o.keys().next().value:void 0}t.makeJournalId=makeJournalId,t.matchesLayout=matchesLayout,t.checkInvariantId=checkInvariantId,t.addTagsToJournal=addTagsToJournal,t.removeTagFromJournal=async function removeTagFromJournal(e,t){const n=await e.getProperties();delete n[t],await e.setProperties(n)},t.getLocalSnapshotTag=async function getLocalSnapshotTag(e){const t=await e.getProperties();return t[a.JOURNAL_PIM_PROPERTIES.SNAPSHOT_ID]?t[a.JOURNAL_PIM_PROPERTIES.SNAPSHOT_ID]:void 0},t.addLocalSnapshotTagToJournal=async function addLocalSnapshotTagToJournal(e,t){await addTagsToJournal(e,{[a.JOURNAL_PIM_PROPERTIES.SNAPSHOT_ID]:t})},t.updateNewSpacesInJournal=async function updateNewSpacesInJournal(e,t){const n=await getTagValueFromJournal(e,a.JOURNAL_PIM_PROPERTIES.NEW_SPACES);await addTagsToJournal(e,{[a.JOURNAL_PIM_PROPERTIES.NEW_SPACES]:[...n||[],...t]})},t.getRootItemIdTag=async function getRootItemIdTag(e){const t=await e.getProperties();return t[a.JOURNAL_PIM_PROPERTIES.ROOT_ITEM_ID]?t[a.JOURNAL_PIM_PROPERTIES.ROOT_ITEM_ID]:void 0},t.getInvariantIdTag=async function getInvariantIdTag(e){const t=await e.getProperties();return t[a.JournalTagNames.INVARIANT_ID]?t[a.JournalTagNames.INVARIANT_ID]:void 0},t.addRootItemIdTag=async function addRootItemIdTag(e,t){await addTagsToJournal(e,{[a.JOURNAL_PIM_PROPERTIES.ROOT_ITEM_ID]:t})},t.getTagValueFromJournal=getTagValueFromJournal,t.isJournalInUse=isJournalInUse,t.deleteJournal=async function deleteJournal(e,t){await isJournalInUse(e)||(await t.reset(e.getId()),await e.delete())},t.getRootItemInIsolationJournal=async function getRootItemInIsolationJournal(e){return(await e.getProperties())[a.JOURNAL_PIM_PROPERTIES.ROOT_ITEM_ID]},t.setRootItemInIsolationJournal=async function setRootItemInIsolationJournal(e,t){await addTagsToJournal(e,{[a.JOURNAL_PIM_PROPERTIES.ROOT_ITEM_ID]:t})},t.cleanJournalChain=cleanJournalChain,t.findTailIsolationJournalId=findTailIsolationJournalId,t.makeOrGetIsolationJournal=async function makeOrGetIsolationJournal(e,t,n,r,o,s){const{pimsdk:c,options:u,journalService:l,spaceCollectionId:d}=e,p=await c.getJournals().list(d);if(!p)throw new Error("Could not get journals from sdk");let h=makeJournalId();const m=u.pimStateService.isJournalReorderingEnabled(),y=p.isolationJournals.filter(e=>{const t=e.properties[a.JournalTagNames.INVARIANT_ID];return matchesLayout(u,e.properties)&&checkInvariantId(u,t,s,r)}).sort((e,t)=>{const n=e.properties,r=t.properties;if(!n.localFileVersion||!r.localFileVersion)throw new Error("Missing drawing version on journal");return Number(r.localFileVersion)-Number(n.localFileVersion)});if(y.length>0&&y[0].properties.localFileVersion&&y[0].properties.localFileVersion>n)throw new Error("local file version is less than last journal version");let g;if(y.length>0&&y[0].journalId!==h&&!o&&console.info("Creating nested isolation journal. In-progress journals are:",y.map(e=>e.journalId).join(", ")),y.length>0)if(o){if(g=await c.getJournals().getIsolated(d,y[0].journalId),h=y[0].journalId,m){const e=await findTailIsolationJournalId(p,l.getSdk());if(!e)throw new Error("No tail journal found for collection "+d);h!==e&&(console.log(`Journal reordering enabled. Moving journal ${h} to tail ${e}.`),await g.setParent(e,{mode:"single",rebase:!1,recursiveRebase:!1})),await i.purgeRelationshipCommands(c,g,d)}}else{if(y[0].properties.localFileVersion===n)throw new Error("A journal for that version already exists, but clobber was not specified");{console.info(`Creating nested journal for ${t}, version ${n}`),h=makeJournalId();const e=await c.getJournals().getIsolated(d,y[0].journalId),r=[a.JOURNAL_PIM_PROPERTIES.ROOT_ITEM_ID],o=await e.getProperties(),i={};for(const e of r)o[e]&&(i[e]=o[e]);if(m){const e=await findTailIsolationJournalId(p,l.getSdk());if(!e)throw new Error("No tail journal found for collection "+d);const t=await c.getJournals().getIsolated(d,e);g=await t.isolate(h)}else g=await e.isolate(h);await addTagsToJournal(g,i)}}else{let e;if(m){const t=await findTailIsolationJournalId(p,l.getSdk());t&&(e=await c.getJournals().getIsolated(d,t))}e||(e=await c.getJournals().getMain(d)),h=makeJournalId(),g=await e.isolate(h)}if(await isJournalInUse(g))throw new Error("Journal already in use, being uploaded");const _=m?a.JOURNAL_TAG_LAYOUT.CHAIN:a.JOURNAL_TAG_LAYOUT.TREE;return await async function attachJournalToDocument(e,t,n,r,o){const i={[a.JournalTagNames.LINEAGE_URN]:t,[a.JournalTagNames.INVARIANT_ID]:n,[a.JournalTagNames.LOCAL_FILE_VERSION]:r,[a.JournalTagNames.LAYOUT]:o};await addTagsToJournal(e,i)}(g,s,t,n,_),g},t.getSdkForSpaceCollectionId=async function getSdkForSpaceCollectionId(e,t,n,r,i){const s=o.getSDKInstance({spaceCollectionId:e,testing:!1},t);if(!s)return{sdk:void 0,journal:void 0};const{pimsdk:a}=s;if(t.documentIdentityService.findInvariantIdSync(r,n)&&null!=i&&null!=i&&i>=0){const o=await(await a.getJournals().list(e)).isolationJournals.filter(e=>{const o=e.properties.invariantId;return checkInvariantId(t,o,n,r)&&i===e.properties.localFileVersion});if(o.length>0){const t=a.getNewInstanceExperimental({journalMappings:{collections:{[e]:o[0].journalId}}}),n=await t.getJournals().getIsolated(e,o[0].journalId);return{sdk:t,journal:n}}return{sdk:void 0,journal:void 0}}return{sdk:a,journal:await a.getJournals().getMain(e)}},t.resetJournal=async function resetJournal(e,t){await t.reset(e.getId())}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.OPENING="Opening",e.OPENED="Opened",e.SAVING="Saving",e.SAVED="Saved",e.PREUPLOADING="PreUploading",e.PREUPLOADED="PreUploaded",e.UPLOADING="Uploading",e.UPLOADED="Uploaded",e.FILE_UPLOADED="FileUploaded",e.UNDEFINED="Undefined",e.ERROR_STATE="Error"}(r=t.DocumentOperationState||(t.DocumentOperationState={}));t.DocumentStateModel=class DocumentStateModel{constructor(e,t){this.id=e,this.enabled=t,this.failOperation=void 0,this.errorMessage=void 0,this.lastOperation=r.UNDEFINED,this.milestone={create:!1}}}},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(1274)),__export(n(1275)),__export(n(1278)),__export(n(1279)),__export(n(1280)),__export(n(1281))},function(e,t,n){"use strict";const r=n(20),o=n(50);t.schema=function(e,t){return null!=t&&"object"==typeof t?t.isJoi?t:Array.isArray(t)?e.alternatives().try(t):t instanceof RegExp?e.string().regex(t):t instanceof Date?e.date().valid(t):e.object().keys(t):"string"==typeof t?e.string().valid(t):"number"==typeof t?e.number().valid(t):"boolean"==typeof t?e.boolean().valid(t):o.isRef(t)?e.valid(t):(r.assert(null===t,"Invalid schema content:",t),e.valid(null))},t.ref=function(e){return o.isRef(e)?e:o.create(e)}},function(e,t,n){"use strict";n.r(t),n.d(t,"nanoid",(function(){return nanoid})),n.d(t,"customAlphabet",(function(){return customAlphabet})),n.d(t,"customRandom",(function(){return customRandom})),n.d(t,"urlAlphabet",(function(){return i})),n.d(t,"random",(function(){return random}));var r=n(16),o=n.n(r);let i="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW";let s,a,random=e=>{!s||s.length<e?(s=Buffer.allocUnsafe(32*e),o.a.randomFillSync(s),a=0):a+e>s.length&&(o.a.randomFillSync(s),a=0);let t=s.subarray(a,a+e);return a+=e,t},customRandom=(e,t,n)=>{let r=(2<<31-Math.clz32(e.length-1|1))-1,o=Math.ceil(1.6*r*t/e.length);return()=>{let i="";for(;;){let s=n(o),a=o;for(;a--;)if(i+=e[s[a]&r]||"",i.length===t)return i}}},customAlphabet=(e,t)=>customRandom(e,t,random),nanoid=(e=21)=>{let t=random(e),n="";for(;e--;)n+=i[63&t[e]];return n}},function(e,t,n){var r=n(559),o=n(178),i=n(561),s=n(562);t.protocol=3;var a=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},c=s(a),u={type:"error",data:"parser error"};function encodeBuffer(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=e.data,i=new Buffer(1);return i[0]=a[e.type],r(Buffer.concat([i,o]))}function map(e,t,n){for(var r=new Array(e.length),o=i(e.length,n),s=0;s<e.length;s++)t(e[s],(function(e,t){r[s]=t,o(e,r)}))}function bufferToString(e){for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);return t}function stringToBuffer(e){for(var t=new Buffer(e.length),n=0,r=e.length;n<r;n++)t.writeUInt8(e.charCodeAt(n),n);return t}function arrayBufferToBuffer(e){for(var t=new Uint8Array(e.buffer||e),n=e.byteLength||e.length,r=e.byteOffset||0,o=new Buffer(n),i=0;i<n;i++)o[i]=t[r+i];return o}function encodeOneBinaryPacket(e,n){t.encodePacket(e,!0,!0,(function onBinaryPacketEncode(e){var t,r=""+e.length;if("string"==typeof e){(t=new Buffer(r.length+2))[0]=0;for(var o=0;o<r.length;o++)t[o+1]=parseInt(r[o],10);return t[t.length-1]=255,n(null,Buffer.concat([t,stringToBuffer(e)]))}for((t=new Buffer(r.length+2))[0]=1,o=0;o<r.length;o++)t[o+1]=parseInt(r[o],10);t[t.length-1]=255,n(null,Buffer.concat([t,e]))}))}t.encodePacket=function(e,t,n,o){if("function"==typeof t&&(o=t,t=null),"function"==typeof n&&(o=n,n=null),Buffer.isBuffer(e.data))return encodeBuffer(e,t,o);if(e.data&&(e.data.buffer||e.data)instanceof ArrayBuffer)return encodeBuffer({type:e.type,data:arrayBufferToBuffer(e.data)},t,o);var i=a[e.type];return void 0!==e.data&&(i+=n?r.encode(String(e.data),{strict:!1}):String(e.data)),o(""+i)},t.encodeBase64Packet=function(e,t){var n=Buffer.isBuffer(e.data)?e.data:arrayBufferToBuffer(e.data),r="b"+a[e.type];return t(r+=n.toString("base64"))},t.decodePacket=function(e,n,o){if(void 0===e)return u;var i;if("string"==typeof e)return"b"===(i=e.charAt(0))?t.decodeBase64Packet(e.substr(1),n):o&&!1===(e=function tryDecode(e){try{e=r.decode(e,{strict:!1})}catch(e){return!1}return e}(e))?u:Number(i)==i&&c[i]?e.length>1?{type:c[i],data:e.substring(1)}:{type:c[i]}:u;if("arraybuffer"===n){var s=new Uint8Array(e);return i=s[0],{type:c[i],data:s.buffer.slice(1)}}return e instanceof ArrayBuffer&&(e=arrayBufferToBuffer(e)),i=e[0],{type:c[i],data:e.slice(1)}},t.decodeBase64Packet=function(e,t){var n=c[e.charAt(0)],r=new Buffer(e.substr(1),"base64");if("arraybuffer"===t){for(var o=new Uint8Array(r.length),i=0;i<o.length;i++)o[i]=r[i];r=o.buffer}return{type:n,data:r}},t.encodePayload=function(e,n,r){if("function"==typeof n&&(r=n,n=null),n&&o(e))return t.encodePayloadAsBinary(e,r);if(!e.length)return r("0:");map(e,(function encodeOne(e,r){t.encodePacket(e,n,!1,(function(e){r(null,function setLengthHeader(e){return e.length+":"+e}(e))}))}),(function(e,t){return r(t.join(""))}))},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);if("function"==typeof n&&(r=n,n=null),""===e)return r(u,0,1);for(var o,i,s,a="",c=0,l=e.length;c<l;c++){var d=e.charAt(c);if(":"===d){if(""===a||a!=(o=Number(a)))return r(u,0,1);if(a!=(i=e.substr(c+1,o)).length)return r(u,0,1);if(i.length){if(s=t.decodePacket(i,n,!1),u.type===s.type&&u.data===s.data)return r(u,0,1);if(!1===r(s,c+o,l))return}c+=o,a=""}else a+=d}return""!==a?r(u,0,1):void 0},t.encodePayloadAsBinary=function(e,t){if(!e.length)return t(new Buffer(0));map(e,encodeOneBinaryPacket,(function(e,n){return t(Buffer.concat(n))}))},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var o,i=e,s=[];i.length>0;){var a="",c=0===i[0];for(o=1;255!==i[o];o++){if(a.length>310)return r(u,0,1);a+=""+i[o]}i=i.slice(a.length+1);var l=parseInt(a,10),d=i.slice(1,l+1);c&&(d=bufferToString(d)),s.push(d),i=i.slice(l+1)}var p=s.length;for(o=0;o<p;o++){var h=s[o];r(t.decodePacket(h,n,!0),o,p)}}},function(e,t){e.exports=require("tty")},function(e,t,n){"use strict";var r=process.argv,o=r.indexOf("--"),hasFlag=function(e){e="--"+e;var t=r.indexOf(e);return-1!==t&&(-1===o||t<o)};e.exports=!(!("FORCE_COLOR"in process.env)&&(hasFlag("no-color")||hasFlag("no-colors")||hasFlag("color=false")||!(hasFlag("color")||hasFlag("colors")||hasFlag("color=true")||hasFlag("color=always"))&&(process.stdout&&!process.stdout.isTTY||"win32"!==process.platform&&!("COLORTERM"in process.env)&&("dumb"===process.env.TERM||!/^screen|^xterm|^vt100|color|ansi|cygwin|linux/i.test(process.env.TERM)))))},function(e,t){e.exports=require("zlib")},function(e,t,n){"use strict";const r=n(73),o=n(262),i=n(125),s=n(179),a=r.Buffer,c=a.from([0,0,255,255]),u=a.from([0]),l=Symbol("write-in-progress"),d=Symbol("pending-close"),p=Symbol("total-length"),h=Symbol("callback"),m=Symbol("buffers"),y=Symbol("error"),g=Symbol("owner");let _;function deflateOnData(e){this[m].push(e),this[p]+=e.length}function inflateOnData(e){this[p]+=e.length,this[g]._maxPayload<1||this[p]<=this[g]._maxPayload?this[m].push(e):(this[y]=new Error("max payload size exceeded"),this[y].closeCode=1009,this.removeListener("data",inflateOnData),this.reset())}function inflateOnError(e){this[g]._inflate=null,this[h](e)}e.exports=class PerMessageDeflate{constructor(e,t,n){if(this._maxPayload=0|n,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!_){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;_=new o({concurrency:e})}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){var t;return e=this.normalizeParams(e),t=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params=t,t}cleanup(){this._inflate&&(this._inflate[l]?this._inflate[d]=!0:(this._inflate.close(),this._inflate=null)),this._deflate&&(this._deflate[l]?this._deflate[d]=!0:(this._deflate.close(),this._deflate=null))}acceptAsServer(e){const t={};if(!e.some(e=>{if(!(!1===this._options.serverNoContextTakeover&&e.server_no_context_takeover||!1===this._options.serverMaxWindowBits&&e.server_max_window_bits||"number"==typeof this._options.serverMaxWindowBits&&"number"==typeof e.server_max_window_bits&&this._options.serverMaxWindowBits>e.server_max_window_bits||"number"==typeof this._options.clientMaxWindowBits&&!e.client_max_window_bits))return(this._options.serverNoContextTakeover||e.server_no_context_takeover)&&(t.server_no_context_takeover=!0),(this._options.clientNoContextTakeover||!1!==this._options.clientNoContextTakeover&&e.client_no_context_takeover)&&(t.client_no_context_takeover=!0),"number"==typeof this._options.serverMaxWindowBits?t.server_max_window_bits=this._options.serverMaxWindowBits:"number"==typeof e.server_max_window_bits&&(t.server_max_window_bits=e.server_max_window_bits),"number"==typeof this._options.clientMaxWindowBits?t.client_max_window_bits=this._options.clientMaxWindowBits:!1!==this._options.clientMaxWindowBits&&"number"==typeof e.client_max_window_bits&&(t.client_max_window_bits=e.client_max_window_bits),!0}))throw new Error("Doesn't support the offered configuration");return t}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Invalid value for "client_no_context_takeover"');if("number"==typeof this._options.clientMaxWindowBits&&(!t.client_max_window_bits||t.client_max_window_bits>this._options.clientMaxWindowBits)||!1===this._options.clientMaxWindowBits&&t.client_max_window_bits)throw new Error('Invalid value for "client_max_window_bits"');return t}normalizeParams(e){return e.map(e=>(Object.keys(e).forEach(t=>{var n=e[t];if(n.length>1)throw new Error("Multiple extension parameters for "+t);switch(n=n[0],t){case"server_no_context_takeover":case"client_no_context_takeover":if(!0!==n)throw new Error(`invalid extension parameter value for ${t} (${n})`);e[t]=!0;break;case"server_max_window_bits":case"client_max_window_bits":if("string"==typeof n&&(n=parseInt(n,10),Number.isNaN(n)||n<i.Z_MIN_WINDOWBITS||n>i.Z_MAX_WINDOWBITS))throw new Error(`invalid extension parameter value for ${t} (${n})`);if(!this._isServer&&!0===n)throw new Error("Missing extension parameter value for "+t);e[t]=n;break;default:throw new Error(`Not defined extension parameter (${t})`)}}),e))}decompress(e,t,n){_.push(r=>{this._decompress(e,t,(e,t)=>{r(),n(e,t)})})}compress(e,t,n){_.push(r=>{this._compress(e,t,(e,t)=>{r(),n(e,t)})})}_decompress(e,t,n){const r=this._isServer?"client":"server";if(!this._inflate){const e=r+"_max_window_bits",t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=i.createInflateRaw({windowBits:t}),this._inflate[p]=0,this._inflate[m]=[],this._inflate[g]=this,this._inflate.on("error",inflateOnError),this._inflate.on("data",inflateOnData)}this._inflate[h]=n,this._inflate[l]=!0,this._inflate.write(e),t&&this._inflate.write(c),this._inflate.flush(()=>{const e=this._inflate[y];if(e)return this._inflate.close(),this._inflate=null,void n(e);const o=s.concat(this._inflate[m],this._inflate[p]);t&&this.params[r+"_no_context_takeover"]||this._inflate[d]?(this._inflate.close(),this._inflate=null):(this._inflate[l]=!1,this._inflate[p]=0,this._inflate[m]=[]),n(null,o)})}_compress(e,t,n){if(!e||0===e.length)return void process.nextTick(n,null,u);const r=this._isServer?"server":"client";if(!this._deflate){const e=r+"_max_window_bits",t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=i.createDeflateRaw({memLevel:this._options.memLevel,level:this._options.level,flush:i.Z_SYNC_FLUSH,windowBits:t}),this._deflate[p]=0,this._deflate[m]=[],this._deflate.on("data",deflateOnData)}this._deflate[l]=!0,this._deflate.write(e),this._deflate.flush(i.Z_SYNC_FLUSH,()=>{var e=s.concat(this._deflate[m],this._deflate[p]);t&&(e=e.slice(0,e.length-4)),t&&this.params[r+"_no_context_takeover"]||this._deflate[d]?(this._deflate.close(),this._deflate=null):(this._deflate[l]=!1,this._deflate[p]=0,this._deflate[m]=[]),n(null,e)})}}},function(e,t,n){"use strict";const r=n(73).Buffer;t.BINARY_TYPES=["nodebuffer","arraybuffer","fragments"],t.GUID="258EAFA5-E914-47DA-95CA-C5AB0DC85B11",t.EMPTY_BUFFER=r.alloc(0),t.NOOP=()=>{}},function(e,t,n){var r=n(585)("socket.io-parser"),o=n(589),i=n(590),s=n(268),a=n(269);function Encoder(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=Encoder,t.Decoder=Decoder;var c=t.ERROR+'"encode error"';function encodeAsString(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var o=function tryStringify(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===o)return c;n+=o}return r("encoded %j as %s",e,n),n}function Decoder(){this.reconstructor=null}function BinaryReconstructor(e){this.reconPack=e,this.buffers=[]}function error(e){return{type:t.ERROR,data:"parser error: "+e}}Encoder.prototype.encode=function(e,n){(r("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)?function encodeAsBinary(e,t){i.removeBlobs(e,(function writeEncoding(e){var n=i.deconstructPacket(e),r=encodeAsString(n.packet),o=n.buffers;o.unshift(r),t(o)}))}(e,n):n([encodeAsString(e)])},o(Decoder.prototype),Decoder.prototype.add=function(e){var n;if("string"==typeof e)n=function decodeString(e){var n=0,o={type:Number(e.charAt(0))};if(null==t.types[o.type])return error("unknown packet type "+o.type);if(t.BINARY_EVENT===o.type||t.BINARY_ACK===o.type){for(var i="";"-"!==e.charAt(++n)&&(i+=e.charAt(n),n!=e.length););if(i!=Number(i)||"-"!==e.charAt(n))throw new Error("Illegal attachments");o.attachments=Number(i)}if("/"===e.charAt(n+1))for(o.nsp="";++n;){if(","===(c=e.charAt(n)))break;if(o.nsp+=c,n===e.length)break}else o.nsp="/";var a=e.charAt(n+1);if(""!==a&&Number(a)==a){for(o.id="";++n;){var c;if(null==(c=e.charAt(n))||Number(c)!=c){--n;break}if(o.id+=e.charAt(n),n===e.length)break}o.id=Number(o.id)}if(e.charAt(++n)){var u=function tryParse(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(n));if(!(!1!==u&&(o.type===t.ERROR||s(u))))return error("invalid payload");o.data=u}return r("decoded %s as %j",e,o),o}(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new BinaryReconstructor(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!a(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},Decoder.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},BinaryReconstructor.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=i.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},BinaryReconstructor.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,n){"undefined"==typeof process||"renderer"===process.type?e.exports=n(591):e.exports=n(593)},function(e,t,n){"use strict";const r=n(262),o=n(125),i=n(131),{kStatusCode:s,NOOP:a}=n(74),c=Buffer.from([0,0,255,255]),u=Buffer.from([0]),l=Symbol("permessage-deflate"),d=Symbol("total-length"),p=Symbol("callback"),h=Symbol("buffers"),m=Symbol("error");let y;function deflateOnData(e){this[h].push(e),this[d]+=e.length}function inflateOnData(e){this[d]+=e.length,this[l]._maxPayload<1||this[d]<=this[l]._maxPayload?this[h].push(e):(this[m]=new RangeError("Max payload size exceeded"),this[m][s]=1009,this.removeListener("data",inflateOnData),this.reset())}function inflateOnError(e){this[l]._inflate=null,e[s]=1007,this[p](e)}e.exports=class PerMessageDeflate{constructor(e,t,n){if(this._maxPayload=0|n,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!y){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;y=new r({concurrency:e})}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate&&(this._deflate[p]&&this._deflate[p](),this._deflate.close(),this._deflate=null)}acceptAsServer(e){const t=this._options,n=e.find(e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits));if(!n)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(n.server_no_context_takeover=!0),t.clientNoContextTakeover&&(n.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(n.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?n.client_max_window_bits=t.clientMaxWindowBits:!0!==n.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete n.client_max_window_bits,n}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach(e=>{Object.keys(e).forEach(t=>{let n=e[t];if(n.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(n=n[0],"client_max_window_bits"===t){if(!0!==n){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}else if("server_max_window_bits"===t){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==n)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}e[t]=n})}),e}decompress(e,t,n){y.push(r=>{this._decompress(e,t,(e,t)=>{r(),n(e,t)})})}compress(e,t,n){y.push(r=>{this._compress(e,t,(e,t)=>{r(),(e||t)&&n(e,t)})})}_decompress(e,t,n){const r=this._isServer?"client":"server";if(!this._inflate){const e=r+"_max_window_bits",t="number"!=typeof this.params[e]?o.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=o.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[l]=this,this._inflate[d]=0,this._inflate[h]=[],this._inflate.on("error",inflateOnError),this._inflate.on("data",inflateOnData)}this._inflate[p]=n,this._inflate.write(e),t&&this._inflate.write(c),this._inflate.flush(()=>{const e=this._inflate[m];if(e)return this._inflate.close(),this._inflate=null,void n(e);const o=i.concat(this._inflate[h],this._inflate[d]);t&&this.params[r+"_no_context_takeover"]?(this._inflate.close(),this._inflate=null):(this._inflate[d]=0,this._inflate[h]=[]),n(null,o)})}_compress(e,t,n){if(!e||0===e.length)return void process.nextTick(n,null,u);const r=this._isServer?"server":"client";if(!this._deflate){const e=r+"_max_window_bits",t="number"!=typeof this.params[e]?o.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=o.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[d]=0,this._deflate[h]=[],this._deflate.on("error",a),this._deflate.on("data",deflateOnData)}this._deflate[p]=n,this._deflate.write(e),this._deflate.flush(o.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let e=i.concat(this._deflate[h],this._deflate[d]);t&&(e=e.slice(0,e.length-4)),this._deflate[p]=null,t&&this.params[r+"_no_context_takeover"]?(this._deflate.close(),this._deflate=null):(this._deflate[d]=0,this._deflate[h]=[]),n(null,e)})}}},function(e,t,n){"use strict";const{EMPTY_BUFFER:r}=n(74);function concat(e,t){if(0===e.length)return r;if(1===e.length)return e[0];const n=Buffer.allocUnsafe(t);let o=0;for(let t=0;t<e.length;t++){const r=e[t];n.set(r,o),o+=r.length}return o<t?n.slice(0,o):n}function _mask(e,t,n,r,o){for(let i=0;i<o;i++)n[r+i]=e[i]^t[3&i]}function _unmask(e,t){const n=e.length;for(let r=0;r<n;r++)e[r]^=t[3&r]}function toArrayBuffer(e){return e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}function toBuffer(e){if(toBuffer.readOnly=!0,Buffer.isBuffer(e))return e;let t;return e instanceof ArrayBuffer?t=Buffer.from(e):ArrayBuffer.isView(e)?t=function viewToBuffer(e){const t=Buffer.from(e.buffer);if(e.byteLength!==e.buffer.byteLength)return t.slice(e.byteOffset,e.byteOffset+e.byteLength);return t}(e):(t=Buffer.from(e),toBuffer.readOnly=!1),t}try{const t=n(!function webpackMissingModule(){var e=new Error("Cannot find module 'bufferutil'");throw e.code="MODULE_NOT_FOUND",e}()),r=t.BufferUtil||t;e.exports={concat:concat,mask(e,t,n,o,i){i<48?_mask(e,t,n,o,i):r.mask(e,t,n,o,i)},toArrayBuffer:toArrayBuffer,toBuffer:toBuffer,unmask(e,t){e.length<32?_unmask(e,t):r.unmask(e,t)}}}catch(t){e.exports={concat:concat,mask:_mask,toArrayBuffer:toArrayBuffer,toBuffer:toBuffer,unmask:_unmask}}},function(e,t,n){"use strict";function YError(e){this.name="YError",this.message=e||"yargs error",Error.captureStackTrace(this,YError)}YError.prototype=Object.create(Error.prototype),YError.prototype.constructor=YError,e.exports=YError},function(e,t){var n=/^(?:0|[1-9]\d*)$/;function apply(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var r=Object.prototype,o=r.hasOwnProperty,i=r.toString,s=r.propertyIsEnumerable,a=Math.max;function arrayLikeKeys(e,t){var n=c(e)||function isArguments(e){return function isArrayLikeObject(e){return function isObjectLike(e){return!!e&&"object"==typeof e}(e)&&isArrayLike(e)}(e)&&o.call(e,"callee")&&(!s.call(e,"callee")||"[object Arguments]"==i.call(e))}(e)?function baseTimes(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],r=n.length,a=!!r;for(var u in e)!t&&!o.call(e,u)||a&&("length"==u||isIndex(u,r))||n.push(u);return n}function assignInDefaults(e,t,n,i){return void 0===e||eq(e,r[n])&&!o.call(i,n)?t:e}function assignValue(e,t,n){var r=e[t];o.call(e,t)&&eq(r,n)&&(void 0!==n||t in e)||(e[t]=n)}function baseKeysIn(e){if(!isObject(e))return function nativeKeysIn(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=function isPrototype(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||r;return e===n}(e),n=[];for(var i in e)("constructor"!=i||!t&&o.call(e,i))&&n.push(i);return n}function baseRest(e,t){return t=a(void 0===t?e.length-1:t,0),function(){for(var n=arguments,r=-1,o=a(n.length-t,0),i=Array(o);++r<o;)i[r]=n[t+r];r=-1;for(var s=Array(t+1);++r<t;)s[r]=n[r];return s[t]=i,apply(e,this,s)}}function isIndex(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||n.test(e))&&e>-1&&e%1==0&&e<t}function eq(e,t){return e===t||e!=e&&t!=t}var c=Array.isArray;function isArrayLike(e){return null!=e&&function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!function isFunction(e){var t=isObject(e)?i.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)}function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var u=function createAssigner(e){return baseRest((function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,s=o>2?n[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,s&&function isIterateeCall(e,t,n){if(!isObject(n))return!1;var r=typeof t;if("number"==r?isArrayLike(n)&&isIndex(t,n.length):"string"==r&&t in n)return eq(n[t],e);return!1}(n[0],n[1],s)&&(i=o<3?void 0:i,o=1),t=Object(t);++r<o;){var a=n[r];a&&e(t,a,r,i)}return t}))}((function(e,t,n,r){!function copyObject(e,t,n,r){n||(n={});for(var o=-1,i=t.length;++o<i;){var s=t[o],a=r?r(n[s],e[s],s,n,e):void 0;assignValue(n,s,void 0===a?e[s]:a)}return n}(t,function keysIn(e){return isArrayLike(e)?arrayLikeKeys(e,!0):baseKeysIn(e)}(t),e,r)})),l=baseRest((function(e){return e.push(void 0,assignInDefaults),apply(u,void 0,e)}));e.exports=l},function(e,t){const n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:n,MAX_SAFE_COMPONENT_LENGTH:16}},function(e,t){const n="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n},function(e,t){const n=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:n.filter(t=>e[t]).reduce((e,t)=>(e[t]=!0,e),{}):{}},function(e,t,n){const r=n(38);e.exports=(e,t,n)=>r(e,t,n)>0},function(e,t,n){const r=Symbol("SemVer ANY");class Comparator{static get ANY(){return r}constructor(e,t){if(t=o(t),e instanceof Comparator){if(e.loose===!!t.loose)return e;e=e.value}c("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===r?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(e){const t=this.options.loose?i[s.COMPARATORLOOSE]:i[s.COMPARATOR],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new u(n[2],this.options.loose):this.semver=r}toString(){return this.value}test(e){if(c("Comparator.test",e,this.options.loose),this.semver===r||e===r)return!0;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}return a(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Comparator))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new l(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new l(this.value,t).test(e.semver);const n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),r=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,i=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),s=a(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=a(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||r||o&&i||s||c}}e.exports=Comparator;const o=n(136),{re:i,t:s}=n(77),a=n(292),c=n(135),u=n(25),l=n(39)},function(e,t,n){const r=n(39);e.exports=(e,t,n)=>{try{t=new r(t,n)}catch(e){return!1}return t.test(e)}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(141)),s=r(n(13)),a=r(n(75)),c=r(n(96)),u=n(98),l=n(15),d=o(n(293)),p=n(194),h=n(675),m=n(99),y=n(95);class ContainerProperty extends u.BaseProperty{constructor(e){super(e),this.staticChildren=e.children?e.children:{},this.propertyFactory=e.propertyFactory}getDefaultTypeid(){return"ContainerProperty"}get(e){return this.staticChildren[e]}isAncestorOf(e){let t=e.getParent();for(;t;){if(t===this)return!0;t=t.getParent()}return!1}isDynamic(){return!1}getEntriesReadOnly(){const e={},t=this.getIds();for(const n of t)e[n]=this.get(n);return e}getIds(){return Object.keys(this.staticChildren)}getValues(){const e=this.getIds(),t={};for(const n of e){const e=this.get(n);void 0===e?t[n]=void 0:e instanceof u.BaseProperty&&p.isPrimitive(e)&&"single"===e.getContext()&&e.isPrimitiveType()?t[n]=e.getValue():void 0!==e.getValues?t[n]=e.getValues():t[n]=e}return t}has(e){return void 0!==this.staticChildren[e]}resolvePath(e,t=[]){let n=[],r=t;if(a.default(e)){if(s.default(n))throw new Error(l.MSG.EMPTY_PATH)}else n=d.default.tokenizePathString(e,r);s.default(r)&&(r=[d.TOKEN_TYPES.PATH_SEGMENT_TOKEN]);let o=this;for(let e=0;e<n.length;e++){switch(r[e]){case d.TOKEN_TYPES.ARRAY_TOKEN:if(!(a.default(o)&&o instanceof ContainerProperty))throw new Error(l.MSG.ARRAY_ACCESSOR_ON_NON_ARRAY);{if(h.isValueContainer(o))throw new Error(l.MSG.NO_PATHS_FOR_NON_PRIMITIVE_ARRAYS);const t=parseInt(n[e],10);o=o.get(t)}throw new Error(l.MSG.DEREFERENCING_NOT_SUPPORTED);case d.TOKEN_TYPES.DEREFERENCE_TOKEN:throw new Error(l.MSG.DEREFERENCING_NOT_SUPPORTED);case d.TOKEN_TYPES.PATH_ROOT_TOKEN:o=o.getRoot();break;case d.TOKEN_TYPES.PATH_SEGMENT_TOKEN:o=o.get(n[e]);break;case d.TOKEN_TYPES.RAISE_LEVEL_TOKEN:o=o.getParent()}if(void 0===o)throw new Error(l.MSG.UNKNOWN_PATH+n[e])}return o}setValues(e){this._setValues(e,!1,!1)}traverseDown(e){return this._traverse(e,"")}getPathSegmentForChildNode(e){return l.PROPERTY_PATH_DELIMITER+d.default.quotePathSegmentIfNeeded(e.getId())}_setValues(e,t,n=!1){for(const r of Object.keys(e)){const o=e[r],s=this.get(r);if(p.isPrimitive(s))s.setValue(o);else if(s instanceof ContainerProperty&&i.default(o))s._setValues(o,t,n);else{if(s instanceof u.BaseProperty){const e=s.getTypeid();throw new Error(l.MSG.SET_VALUES_PATH_PROPERTY+r+", of type: "+e)}if(void 0===s)throw new Error(l.MSG.SET_VALUES_PATH_INVALID+r)}}}_append(e,t){const n=e.getId();if(void 0===this.staticChildren[n])this.staticChildren[n]=e,e._setParent(this);else{if(!t)throw new Error(l.MSG.OVERWRITING_ID+n);const r=this.staticChildren[n];if(!(r instanceof ContainerProperty&&"ContainerProperty"===r.getTypeid()&&"single"===r.getContext()))throw new Error(l.MSG.OVERRIDDING_INHERITED_TYPES+n);if(r.getTypeid()!==e.getTypeid())throw new Error(l.MSG.OVERRIDDING_INHERITED_TYPES+n);r._merge(e)}}_merge(e){for(const t of Object.keys(e.staticChildren))this._append(e.staticChildren[t],!0)}_remove(e){if(void 0===this.staticChildren[e])throw new Error(l.MSG.REMOVING_NON_EXISTING_ID+e);this.staticChildren[e]._setParent(void 0),delete this.staticChildren[e]}getChildrenIds(){return Object.keys(this.staticChildren)}_traverse(e,t){let n;t&&(t+=l.PROPERTY_PATH_DELIMITER);for(const r of this.getChildrenIds()){const o=this.get(r);if(!(o instanceof u.BaseProperty))continue;const i=t+d.default.quotePathSegmentIfNeeded(o.getId());if(n=e(o,i),n===l.BREAK_TRAVERSAL||(o instanceof ContainerProperty&&(n=o._traverse(e,i)),n===l.BREAK_TRAVERSAL))return l.BREAK_TRAVERSAL}}_getChildrenCount(){return Object.keys(this.staticChildren).length}_prettyPrint(e,t,n){let r="";switch(this._context){case"map":r="Map of ";break;case"set":r="Set of "}n(e+t+this.getId()+" ("+r+this.getTypeid()+"):"),e+="  ";for(const t of this.getIds())this.get(t)._prettyPrint(e,"",n)}_setAsConstant(){super._setAsConstant(),this.traverseDown((function(e,t){e._setAsConstant()}))}_unsetAsConstant(){super._unsetAsConstant(),this.traverseDown((e,t)=>{e._unsetAsConstant()})}_coveredByPaths(e,t){const n=d.default.getPathCoverage(e,t);if(n.coverageExtent===d.CoverageExtent.FULLY_COVERED)return!0;if(n.coverageExtent===d.CoverageExtent.PARTLY_COVERED){let t,r,o;if(this.isPrimitiveType()){t="single"===this.getContext()?[]:this.getIds();for(let i=0;i<t.length;i++)if(o=this.get(t[i]),r=d.default.getChildAbsolutePathCanonical(e,t[i]),d.default.getPathCoverage(r,n.pathList).coverageExtent===d.CoverageExtent.UNCOVERED)return!1}else{t=this.getIds();for(let i=0;i<t.length;i++)if(o=this.get(t[i]),r=d.default.getChildAbsolutePathCanonical(e,t[i]),!o._coveredByPaths(r,n.pathList))return!1}return!0}return!1}serialize(){return new m.ChangeSet(this._serialize())}_serialize(){const e={};return this._isDirty&&Object.entries(this.staticChildren).forEach(t=>{const n=t[0],r=t[1],o=r.getExtendedTypeid();c.default(e,[o,n],r._serialize())}),e}deserialize(e){this._deserialize(e.serializedChangeSet)}_deserialize(e,t){t&&(this._remoteVersion=t),m.ChangeSet.isEmpty(e)||Object.entries(e).forEach(([e,t])=>{const n=y.TypeIdHelper.extractTypeId(e);let r;this.propertyFactory.checkForDegradedModeNeed(n)&&(r=y.TypeIdHelper.extractVersion(n).version),Object.entries(t).forEach(([e,t])=>{const n=this.staticChildren[e];if(void 0===n&&!this._remoteVersion)throw new Error(l.MSG.MODIFY_NON_EXISTING_ENTRY);null!=n&&n._deserialize(t,r)})})}applyChangeSet(e){this._applyChangeSet(e.serializedChangeSet)}_applyChangeSet(e){Object.keys(e).forEach(t=>{m.ChangeSet.isReservedKeyword(t)||Object.keys(e[t]).forEach(n=>{const r=this.resolvePath(n);r&&r._applyChangeSet(e[t][n])})})}isClean(){const e=Object.entries(this.staticChildren);let t=!1;for(const n of e){if(n[1].isDirty){t=!0;break}}return!t}childWasCleaned(e){this.isClean()&&super.clean()}clean(){this.traverseDown(e=>{e.cleanSelf()}),super.clean()}}t.ContainerProperty=ContainerProperty},function(e,t){e.exports=function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(40);t.BaseDataArray=r.BaseDataArray;const o=n(294);t.UniversalDataArray=o.UniversalDataArray;const i=n(680);t.BoolDataArray=i.BoolDataArray;const s=n(681);t.Int8DataArray=s.Int8DataArray;const a=n(682);t.Int16DataArray=a.Int16DataArray;const c=n(683);t.Int32DataArray=c.Int32DataArray;const u=n(684);t.Uint8DataArray=u.Uint8DataArray;const l=n(685);t.Uint16DataArray=l.Uint16DataArray;const d=n(686);t.Uint32DataArray=d.Uint32DataArray;const p=n(687);t.Float32DataArray=p.Float32DataArray;const h=n(688);t.Float64DataArray=h.Float64DataArray},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(144),o=n(2);class AccessControlEntity extends r.Entity{constructor(e,t,n,r){super(e,t,n,r),this.inheritParentPermissions=!0,this.policies=this.propertyFactory.create("NodeProperty"),this.policies.clean(),this.policies.addOnDirtyListener(this.propertyListener.bind(this))}isDirty(){return this.policies.isDirty||super.isDirty()}assignPolicy(e){if(void 0!==this.policies.get(e))throw new o.SDKError(`A policy with id: "${e}" already exists on this resource.`);const t=this.propertyFactory.create("Bool");this.policies.insert(e,t)}unassignPolicy(e){if(void 0===this.policies.get(e)){if(this.newResource)throw new o.SDKError(`A policy with id: "${e}" does not exists on this resource.`);const t=this.propertyFactory.create("Bool");this.policies.insert(e,t);this.policies.get(e).clean()}this.policies.remove(e)}cleanDirtyness(){super.cleanDirtyness(),this.policies.clean()}serialize(){const e=super.serialize();return e.policies=this.policies.serialize().serializedChangeSet,this.newResource&&(e.inheritParentPermissions=this.inheritParentPermissions),e}initWithData(e,t){super.initWithData(e,t),void 0!==e.inheritParentPermissions&&(this.inheritParentPermissions=e.inheritParentPermissions)}}t.AccessControlEntity=AccessControlEntity},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(13)),s=n(6),a=n(81),c=n(2);t.Entity=class Entity{constructor(e,t,n,r){if(this.fetched=!1,this.revisionId=null,this.id=t,this.sdkCore=e,this.spaceCollectionId=n,this.typeid=r,void 0===this.spaceCollectionId)throw new c.InternalError("Missing space collection on proxy creation - corrupt Entity "+t);if(void 0===this.typeid)throw new c.InternalError("Missing typeid on proxy creation - corrupt Entity "+t);""===this.id?(this.sdkCore.touch(this),this.newResource=!0):this.newResource=!1,this.propertyFactory=this.sdkCore.propertyFactory,this.components=this.propertyFactory.create("NodeProperty"),this.components.clean(),this.components.addOnDirtyListener(this.propertyListener.bind(this)),this.attributes=this.propertyFactory.create("NodeProperty"),this.attributes.clean(),this.attributes.addOnDirtyListener(this.propertyListener.bind(this))}getTypeId(){return this.typeid}isFetched(){return this.fetched}getSpaceCollectionID(){return s.extractId(this.spaceCollectionId)}propertyListener(e,t){t?this.sdkCore.touch(this):this.isDirty()||this.sdkCore.unTouch(this)}isNewResource(){return this.newResource}isDirty(){return this.components.isDirty||this.attributes.isDirty||this.newResource}getId(){if(this.newResource)throw new c.SDKError("Cannot call getId on a new entity until it has been saved");return s.extractId(this.id)}fetch(e=!1){return r(this,void 0,void 0,(function*(){if(this.newResource)throw new c.SDKError("Cannot call fetch on a new entity until it has been saved");this.clearData();const t=yield this.fetchPayload(e);return this.initWithData(t,!0),this}))}initWithData(e,t){const n=void 0!==e.components,r=void 0!==e.attributes;i.default(e.components)||this.components._deserialize(e.components.data||e.components),i.default(e.attributes)||this.attributes._deserialize(e.attributes.data||e.attributes),this.cleanDirtyness(),void 0!==e.revisionId&&(this.revisionId=e.revisionId),this.createdBy=e.createdBy?{userId:e.createdBy.userId,date:new Date(e.createdBy.date),serviceId:e.createdBy.serviceId}:void 0,this.lastModifiedBy=e.lastModifiedBy?{userId:e.lastModifiedBy.userId,date:new Date(e.lastModifiedBy.date),serviceId:e.lastModifiedBy.serviceId}:void 0,this.fetched=t||n&&r}serialize(){const e={typeid:this.typeid,spaceCollectionId:this.spaceCollectionId,components:this.components.serialize().serializedChangeSet,attributes:this.attributes.serialize().serializedChangeSet};return this.newResource||(e.resourceId=this.id),this.attachAdditionalDataToParameters(e),e}purge(){return r(this,void 0,void 0,(function*(){const e=yield this.sdkCore.getDataConnector().handleSingleEntityCommands([this.getPurgeCommand()],s.extractId(this.spaceCollectionId));s.throwServerErrorIfNecessary(e)}))}delete(){return r(this,void 0,void 0,(function*(){const e=yield this.sdkCore.getDataConnector().handleSingleEntityCommands([this.getDeleteCommand()],s.extractId(this.spaceCollectionId));s.throwServerErrorIfNecessary(e),this.upgrade(e)}))}restore(){return r(this,void 0,void 0,(function*(){const e=yield this.sdkCore.getDataConnector().handleSingleEntityCommands([this.restoreInternal()],s.extractId(this.spaceCollectionId));s.throwServerErrorIfNecessary(e),this.upgrade(e)}))}getSaveCommands(){let e;return this.newResource?(e=this.getCreateCommands(),this.sdkCore.unTouch(this)):e=this.isDirty()?this.getUpdateCommands():[],e}attachAdditionalDataToParameters(e){if(this.additionalData)for(const[t,n]of this.additionalData)void 0===e[t]&&(t in["attributes","components","policies","typeid","permissionContext","scopeUrn"]||(e[t]=n));return e}save(){return r(this,void 0,void 0,(function*(){return s.withSpan(this.sdkCore.getTracingOptions(),"create","entity",()=>r(this,void 0,void 0,(function*(){if(!this.isNewResource&&!this.isDirty())return this.sdkCore.logger.debug("Nothing to save on "+this.getId()),{successes:[],errors:[],pendingCommands:[]};this.sdkCore.beginBatch(),this.sdkCore.touch(this);return(yield this.sdkCore.endBatch()).getStatus(this)})))}))}upgrade(e,t=!1){const{successes:n}=e;if(n&&n.length>0){const e=n[n.length-1];this.revisionId=e.revisionId,this.newResource&&(this.id=e.resourceId,this.newResource=!1),t&&this.cleanDirtyness(),this.lastModifiedBy=void 0}}getComponent(e){return this.components.get(e)}listComponents(){return this.components.getIds()}createComponent(e,t){if(t!==a.componentSchema.typeid&&!this.propertyFactory.inheritsFrom(t,a.componentSchema.typeid))throw new c.SDKError("Schemas which define components must inherit from "+a.componentSchema.typeid);if(void 0!==this.components.get(e))throw new c.SDKError(`Component with id: ${e} already exists on this resource.`);const n=this.propertyFactory.create(t);return this.components.insert(e,n),n}removeComponent(e){if(!this.components.has(e)){if(this.newResource||this.fetched)throw new c.SDKError(`A component with id: ${e} does not exist on this resource.`);{const t=this.propertyFactory.create("Bool");this.components.insert(e,t);this.components.get(e).clean()}}this.components.remove(e)}getAttributes(){const e={},t=this.attributes.getValues(),n=Object.keys(t);for(const r of n){const n=t[r];e[r]=n.value}return e}getAttribute(e){const t=this.attributes.get(e);return t?t.get("value").getValue():void 0}getAttributeTypeId(e){const t=this.attributes.get(e);return t?t.get("type").getValue():void 0}getRevisionId(){if(this.isDirty())throw new c.SDKError("Cannot get the RevisionId from an entity that has unsaved changes.");return this.revisionId}getLastRevisionId(){return this.revisionId}createAttribute(e,t,n){if(void 0!==this.attributes.get(e))throw new c.SDKError(`An Attribute with id "${e}" already exists on this resource.`);const r=this.propertyFactory.create(s.AttributeConverter.convertTypeToAttributeTypeid(t),"single",{value:n,category:"application",type:t});this.attributes.insert(e,r)}updateAttribute(e,t){const n=this.attributes.get(e);if(!n)throw new c.SDKError(`An attribute with id: ${e} does not exist on this resource.`);n.get("value").setValue(t)}removeAttribute(e){if(!this.attributes.has(e)){if(this.newResource||this.fetched)throw new c.SDKError(`An attribute with id: ${e} does not exist on this resource.`);{const t=this.propertyFactory.create("Bool");this.attributes.insert(e,t);this.attributes.get(e).clean()}}this.attributes.remove(e)}addToCurrentBatch(){if(!this.sdkCore.touch(this))throw new c.SDKError("Trying add an entity to a batch when there are no active batches.")}addAdditionalInfo(e,t){this.additionalData=this.additionalData||new Map,this.additionalData.set(e,t)}clearData(){this.fetched=!1,this.components=this.propertyFactory.create("NodeProperty"),this.components.clean(),this.components.addOnDirtyListener(this.propertyListener.bind(this)),this.attributes=this.propertyFactory.create("NodeProperty"),this.attributes.clean(),this.attributes.addOnDirtyListener(this.propertyListener.bind(this))}cleanDirtyness(){this.components.clean(),this.attributes.clean(),this.additionalData=void 0}getCreatedBy(){return this.createdBy}getLastModifiedBy(){return this.lastModifiedBy}}},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0});const o=n(304),i=n(197);var s;!function(e){e.GENERAL_ERROR="sdk_general_error",e.INTERNAL_ERROR="sdk_internal_error",e.COMMAND_ERROR="sdk_command_error",e.SERVER_ERROR="sdk_server_error"}(s=t.SDKErrorCode||(t.SDKErrorCode={}));class SDKError extends o.NestedError{constructor(e,t,n,r){super(e,t,r||SDKError.name),this.code=n&&n.code?n.code:s.GENERAL_ERROR,this.detailCode=n&&n.detailCode?n.detailCode:"",this.trackingId=n&&n.trackingId?n.trackingId:""}toString(){return`code: ${this.code}, message: ${this.message},\n      detailCode: ${this.detailCode}, trackingId: ${this.trackingId}`}}r([i.NonEnumerable],SDKError.prototype,"code",void 0),r([i.NonEnumerable],SDKError.prototype,"detailCode",void 0),r([i.NonEnumerable],SDKError.prototype,"trackingId",void 0),t.SDKError=SDKError},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(144);t.extractId=function extractId(e){return void 0===e?"":e instanceof r.Entity?e.getId():e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(759);t.urls=r.urls;var o=n(760);t.headers=o.headers},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(309);t.Batch=r.Batch;var o=n(312);t.DataConnector=o.DataConnector;var i=n(339);t.OSSClient=i.OSSClient;var s=n(858);t.SDKCore=s.SDKCore;var a=n(860);t.WorkingSet=a.WorkingSet;var c=n(861);t.Topology=c.Topology;var u=n(862);t.TopologyV2=u.TopologyV2},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(819),t),o(n(332),t),o(n(820),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.API_BACKWARDS_COMPATIBILITY_VERSION=t.makeGetter=t._global=t.GLOBAL_TRACE_API_KEY=t.GLOBAL_PROPAGATION_API_KEY=t.GLOBAL_METRICS_API_KEY=t.GLOBAL_CONTEXT_MANAGER_API_KEY=void 0;var r=n(821);t.GLOBAL_CONTEXT_MANAGER_API_KEY=Symbol.for("io.opentelemetry.js.api.context"),t.GLOBAL_METRICS_API_KEY=Symbol.for("io.opentelemetry.js.api.metrics"),t.GLOBAL_PROPAGATION_API_KEY=Symbol.for("io.opentelemetry.js.api.propagation"),t.GLOBAL_TRACE_API_KEY=Symbol.for("io.opentelemetry.js.api.trace"),t._global=r._globalThis,t.makeGetter=function makeGetter(e,t,n){return function(r){return r===e?t:n}},t.API_BACKWARDS_COMPATIBILITY_VERSION=0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(41),o=n(859);t.withSpan=function withSpan(e,t,n,i){if(e){const s=o.getTracer(e.tracer),a=`${t} ${n}`,c=s.startSpan(a,{kind:void 0===e.kind?r.SpanKind.CLIENT:e.kind});return c.setAttribute("component","Forge Data SDK"),s.withSpan(c,()=>{try{const e=i();return c.end(),e}catch(e){throw c.setAttributes({error:"true",message:e.message}),c.end(),e}})}return i()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntityType=void 0,function(e){e.ENTITY="entity",e.RELATIONSHIP="relationship"}(t.EntityType||(t.EntityType={}))},function(e,t,n){(function(e){var r;(function(){var o="Expected a function",i="__lodash_placeholder__",s=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],a="[object Arguments]",c="[object Array]",u="[object Boolean]",l="[object Date]",d="[object Error]",p="[object Function]",h="[object GeneratorFunction]",m="[object Map]",y="[object Number]",g="[object Object]",_="[object RegExp]",v="[object Set]",E="[object String]",I="[object Symbol]",b="[object WeakMap]",S="[object ArrayBuffer]",C="[object DataView]",w="[object Float32Array]",A="[object Float64Array]",O="[object Int8Array]",P="[object Int16Array]",D="[object Int32Array]",x="[object Uint8Array]",R="[object Uint16Array]",N="[object Uint32Array]",M=/\b__p \+= '';/g,L=/\b(__p \+=) '' \+/g,j=/(__e\(.*?\)|\b__t\)) \+\n'';/g,k=/&(?:amp|lt|gt|quot|#39);/g,F=/[&<>"']/g,U=RegExp(k.source),V=RegExp(F.source),B=/<%-([\s\S]+?)%>/g,J=/<%([\s\S]+?)%>/g,$=/<%=([\s\S]+?)%>/g,G=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,q=/^\w*$/,H=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Y=/[\\^$.*+?()[\]{}|]/g,K=RegExp(Y.source),z=/^\s+/,W=/\s/,Q=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,X=/\{\n\/\* \[wrapped with (.+)\] \*/,Z=/,? & /,ee=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,te=/[()=,{}\[\]\/\s]/,ne=/\\(\\)?/g,re=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,oe=/\w*$/,ie=/^[-+]0x[0-9a-f]+$/i,se=/^0b[01]+$/i,ae=/^\[object .+?Constructor\]$/,ce=/^0o[0-7]+$/i,ue=/^(?:0|[1-9]\d*)$/,le=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,de=/($^)/,pe=/['\n\r\u2028\u2029\\]/g,he="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",fe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",me="[\\ud800-\\udfff]",ye="["+fe+"]",ge="["+he+"]",_e="\\d+",ve="[\\u2700-\\u27bf]",Ee="[a-z\\xdf-\\xf6\\xf8-\\xff]",Ie="[^\\ud800-\\udfff"+fe+_e+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",be="\\ud83c[\\udffb-\\udfff]",Se="[^\\ud800-\\udfff]",Ce="(?:\\ud83c[\\udde6-\\uddff]){2}",we="[\\ud800-\\udbff][\\udc00-\\udfff]",Ae="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Oe="(?:"+Ee+"|"+Ie+")",Te="(?:"+Ae+"|"+Ie+")",Pe="(?:"+ge+"|"+be+")"+"?",De="[\\ufe0e\\ufe0f]?"+Pe+("(?:\\u200d(?:"+[Se,Ce,we].join("|")+")[\\ufe0e\\ufe0f]?"+Pe+")*"),xe="(?:"+[ve,Ce,we].join("|")+")"+De,Re="(?:"+[Se+ge+"?",ge,Ce,we,me].join("|")+")",Ne=RegExp("['’]","g"),Me=RegExp(ge,"g"),Le=RegExp(be+"(?="+be+")|"+Re+De,"g"),je=RegExp([Ae+"?"+Ee+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[ye,Ae,"$"].join("|")+")",Te+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[ye,Ae+Oe,"$"].join("|")+")",Ae+"?"+Oe+"+(?:['’](?:d|ll|m|re|s|t|ve))?",Ae+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",_e,xe].join("|"),"g"),ke=RegExp("[\\u200d\\ud800-\\udfff"+he+"\\ufe0e\\ufe0f]"),Fe=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ue=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ve=-1,Be={};Be[w]=Be[A]=Be[O]=Be[P]=Be[D]=Be[x]=Be["[object Uint8ClampedArray]"]=Be[R]=Be[N]=!0,Be[a]=Be[c]=Be[S]=Be[u]=Be[C]=Be[l]=Be[d]=Be[p]=Be[m]=Be[y]=Be[g]=Be[_]=Be[v]=Be[E]=Be[b]=!1;var Je={};Je[a]=Je[c]=Je[S]=Je[C]=Je[u]=Je[l]=Je[w]=Je[A]=Je[O]=Je[P]=Je[D]=Je[m]=Je[y]=Je[g]=Je[_]=Je[v]=Je[E]=Je[I]=Je[x]=Je["[object Uint8ClampedArray]"]=Je[R]=Je[N]=!0,Je[d]=Je[p]=Je[b]=!1;var $e={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ge=parseFloat,qe=parseInt,He="object"==typeof global&&global&&global.Object===Object&&global,Ye="object"==typeof self&&self&&self.Object===Object&&self,Ke=He||Ye||Function("return this")(),ze=t&&!t.nodeType&&t,We=ze&&"object"==typeof e&&e&&!e.nodeType&&e,Qe=We&&We.exports===ze,Xe=Qe&&He.process,Ze=function(){try{var e=We&&We.require&&We.require("util").types;return e||Xe&&Xe.binding&&Xe.binding("util")}catch(e){}}(),et=Ze&&Ze.isArrayBuffer,tt=Ze&&Ze.isDate,nt=Ze&&Ze.isMap,rt=Ze&&Ze.isRegExp,ot=Ze&&Ze.isSet,it=Ze&&Ze.isTypedArray;function apply(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function arrayAggregator(e,t,n,r){for(var o=-1,i=null==e?0:e.length;++o<i;){var s=e[o];t(r,s,n(s),e)}return r}function arrayEach(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function arrayEachRight(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function arrayEvery(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function arrayFilter(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var s=e[n];t(s,n,e)&&(i[o++]=s)}return i}function arrayIncludes(e,t){return!!(null==e?0:e.length)&&baseIndexOf(e,t,0)>-1}function arrayIncludesWith(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}function arrayMap(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}function arrayPush(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}function arrayReduce(e,t,n,r){var o=-1,i=null==e?0:e.length;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}function arrayReduceRight(e,t,n,r){var o=null==e?0:e.length;for(r&&o&&(n=e[--o]);o--;)n=t(n,e[o],o,e);return n}function arraySome(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var st=baseProperty("length");function baseFindKey(e,t,n){var r;return n(e,(function(e,n,o){if(t(e,n,o))return r=n,!1})),r}function baseFindIndex(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}function baseIndexOf(e,t,n){return t==t?function strictIndexOf(e,t,n){var r=n-1,o=e.length;for(;++r<o;)if(e[r]===t)return r;return-1}(e,t,n):baseFindIndex(e,baseIsNaN,n)}function baseIndexOfWith(e,t,n,r){for(var o=n-1,i=e.length;++o<i;)if(r(e[o],t))return o;return-1}function baseIsNaN(e){return e!=e}function baseMean(e,t){var n=null==e?0:e.length;return n?baseSum(e,t)/n:NaN}function baseProperty(e){return function(t){return null==t?void 0:t[e]}}function basePropertyOf(e){return function(t){return null==e?void 0:e[t]}}function baseReduce(e,t,n,r,o){return o(e,(function(e,o,i){n=r?(r=!1,e):t(n,e,o,i)})),n}function baseSum(e,t){for(var n,r=-1,o=e.length;++r<o;){var i=t(e[r]);void 0!==i&&(n=void 0===n?i:n+i)}return n}function baseTimes(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function baseTrim(e){return e?e.slice(0,trimmedEndIndex(e)+1).replace(z,""):e}function baseUnary(e){return function(t){return e(t)}}function baseValues(e,t){return arrayMap(t,(function(t){return e[t]}))}function cacheHas(e,t){return e.has(t)}function charsStartIndex(e,t){for(var n=-1,r=e.length;++n<r&&baseIndexOf(t,e[n],0)>-1;);return n}function charsEndIndex(e,t){for(var n=e.length;n--&&baseIndexOf(t,e[n],0)>-1;);return n}function countHolders(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}var at=basePropertyOf({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),ct=basePropertyOf({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function escapeStringChar(e){return"\\"+$e[e]}function hasUnicode(e){return ke.test(e)}function mapToArray(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function overArg(e,t){return function(n){return e(t(n))}}function replaceHolders(e,t){for(var n=-1,r=e.length,o=0,s=[];++n<r;){var a=e[n];a!==t&&a!==i||(e[n]=i,s[o++]=n)}return s}function setToArray(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function setToPairs(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function stringSize(e){return hasUnicode(e)?function unicodeSize(e){var t=Le.lastIndex=0;for(;Le.test(e);)++t;return t}(e):st(e)}function stringToArray(e){return hasUnicode(e)?function unicodeToArray(e){return e.match(Le)||[]}(e):function asciiToArray(e){return e.split("")}(e)}function trimmedEndIndex(e){for(var t=e.length;t--&&W.test(e.charAt(t)););return t}var ut=basePropertyOf({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var lt=function runInContext(e){var t,n=(e=null==e?Ke:lt.defaults(Ke.Object(),e,lt.pick(Ke,Ue))).Array,r=e.Date,W=e.Error,he=e.Function,fe=e.Math,me=e.Object,ye=e.RegExp,ge=e.String,_e=e.TypeError,ve=n.prototype,Ee=he.prototype,Ie=me.prototype,be=e["__core-js_shared__"],Se=Ee.toString,Ce=Ie.hasOwnProperty,we=0,Ae=(t=/[^.]+$/.exec(be&&be.keys&&be.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"",Oe=Ie.toString,Te=Se.call(me),Pe=Ke._,De=ye("^"+Se.call(Ce).replace(Y,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xe=Qe?e.Buffer:void 0,Re=e.Symbol,Le=e.Uint8Array,ke=xe?xe.allocUnsafe:void 0,$e=overArg(me.getPrototypeOf,me),He=me.create,Ye=Ie.propertyIsEnumerable,ze=ve.splice,We=Re?Re.isConcatSpreadable:void 0,Xe=Re?Re.iterator:void 0,Ze=Re?Re.toStringTag:void 0,st=function(){try{var e=getNative(me,"defineProperty");return e({},"",{}),e}catch(e){}}(),dt=e.clearTimeout!==Ke.clearTimeout&&e.clearTimeout,pt=r&&r.now!==Ke.Date.now&&r.now,ht=e.setTimeout!==Ke.setTimeout&&e.setTimeout,ft=fe.ceil,mt=fe.floor,yt=me.getOwnPropertySymbols,gt=xe?xe.isBuffer:void 0,_t=e.isFinite,vt=ve.join,Et=overArg(me.keys,me),It=fe.max,bt=fe.min,St=r.now,Ct=e.parseInt,wt=fe.random,At=ve.reverse,Ot=getNative(e,"DataView"),Tt=getNative(e,"Map"),Pt=getNative(e,"Promise"),Dt=getNative(e,"Set"),xt=getNative(e,"WeakMap"),Rt=getNative(me,"create"),Nt=xt&&new xt,Mt={},Lt=toSource(Ot),jt=toSource(Tt),kt=toSource(Pt),Ft=toSource(Dt),Ut=toSource(xt),Vt=Re?Re.prototype:void 0,Bt=Vt?Vt.valueOf:void 0,Jt=Vt?Vt.toString:void 0;function lodash(e){if(isObjectLike(e)&&!Kn(e)&&!(e instanceof LazyWrapper)){if(e instanceof LodashWrapper)return e;if(Ce.call(e,"__wrapped__"))return wrapperClone(e)}return new LodashWrapper(e)}var $t=function(){function object(){}return function(e){if(!isObject(e))return{};if(He)return He(e);object.prototype=e;var t=new object;return object.prototype=void 0,t}}();function baseLodash(){}function LodashWrapper(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function LazyWrapper(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Hash(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ListCache(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function MapCache(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function SetCache(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new MapCache;++t<n;)this.add(e[t])}function Stack(e){var t=this.__data__=new ListCache(e);this.size=t.size}function arrayLikeKeys(e,t){var n=Kn(e),r=!n&&Yn(e),o=!n&&!r&&Wn(e),i=!n&&!r&&!o&&tr(e),s=n||r||o||i,a=s?baseTimes(e.length,ge):[],c=a.length;for(var u in e)!t&&!Ce.call(e,u)||s&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||isIndex(u,c))||a.push(u);return a}function arraySample(e){var t=e.length;return t?e[baseRandom(0,t-1)]:void 0}function arraySampleSize(e,t){return shuffleSelf(copyArray(e),baseClamp(t,0,e.length))}function arrayShuffle(e){return shuffleSelf(copyArray(e))}function assignMergeValue(e,t,n){(void 0!==n&&!eq(e[t],n)||void 0===n&&!(t in e))&&baseAssignValue(e,t,n)}function assignValue(e,t,n){var r=e[t];Ce.call(e,t)&&eq(r,n)&&(void 0!==n||t in e)||baseAssignValue(e,t,n)}function assocIndexOf(e,t){for(var n=e.length;n--;)if(eq(e[n][0],t))return n;return-1}function baseAggregator(e,t,n,r){return Gt(e,(function(e,o,i){t(r,e,n(e),i)})),r}function baseAssign(e,t){return e&&copyObject(t,keys(t),e)}function baseAssignValue(e,t,n){"__proto__"==t&&st?st(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function baseAt(e,t){for(var r=-1,o=t.length,i=n(o),s=null==e;++r<o;)i[r]=s?void 0:get(e,t[r]);return i}function baseClamp(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}function baseClone(e,t,n,r,o,i){var s,c=1&t,d=2&t,b=4&t;if(n&&(s=o?n(e,r,o,i):n(e)),void 0!==s)return s;if(!isObject(e))return e;var M=Kn(e);if(M){if(s=function initCloneArray(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&Ce.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!c)return copyArray(e,s)}else{var L=nn(e),j=L==p||L==h;if(Wn(e))return cloneBuffer(e,c);if(L==g||L==a||j&&!o){if(s=d||j?{}:initCloneObject(e),!c)return d?function copySymbolsIn(e,t){return copyObject(e,tn(e),t)}(e,function baseAssignIn(e,t){return e&&copyObject(t,keysIn(t),e)}(s,e)):function copySymbols(e,t){return copyObject(e,en(e),t)}(e,baseAssign(s,e))}else{if(!Je[L])return o?e:{};s=function initCloneByTag(e,t,n){var r=e.constructor;switch(t){case S:return cloneArrayBuffer(e);case u:case l:return new r(+e);case C:return function cloneDataView(e,t){var n=t?cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case w:case A:case O:case P:case D:case x:case"[object Uint8ClampedArray]":case R:case N:return cloneTypedArray(e,n);case m:return new r;case y:case E:return new r(e);case _:return function cloneRegExp(e){var t=new e.constructor(e.source,oe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case v:return new r;case I:return function cloneSymbol(e){return Bt?me(Bt.call(e)):{}}(e)}}(e,L,c)}}i||(i=new Stack);var k=i.get(e);if(k)return k;i.set(e,s),er(e)?e.forEach((function(r){s.add(baseClone(r,t,n,r,e,i))})):Xn(e)&&e.forEach((function(r,o){s.set(o,baseClone(r,t,n,o,e,i))}));var F=M?void 0:(b?d?getAllKeysIn:getAllKeys:d?keysIn:keys)(e);return arrayEach(F||e,(function(r,o){F&&(r=e[o=r]),assignValue(s,o,baseClone(r,t,n,o,e,i))})),s}function baseConformsTo(e,t,n){var r=n.length;if(null==e)return!r;for(e=me(e);r--;){var o=n[r],i=t[o],s=e[o];if(void 0===s&&!(o in e)||!i(s))return!1}return!0}function baseDelay(e,t,n){if("function"!=typeof e)throw new _e(o);return an((function(){e.apply(void 0,n)}),t)}function baseDifference(e,t,n,r){var o=-1,i=arrayIncludes,s=!0,a=e.length,c=[],u=t.length;if(!a)return c;n&&(t=arrayMap(t,baseUnary(n))),r?(i=arrayIncludesWith,s=!1):t.length>=200&&(i=cacheHas,s=!1,t=new SetCache(t));e:for(;++o<a;){var l=e[o],d=null==n?l:n(l);if(l=r||0!==l?l:0,s&&d==d){for(var p=u;p--;)if(t[p]===d)continue e;c.push(l)}else i(t,d,r)||c.push(l)}return c}lodash.templateSettings={escape:B,evaluate:J,interpolate:$,variable:"",imports:{_:lodash}},lodash.prototype=baseLodash.prototype,lodash.prototype.constructor=lodash,LodashWrapper.prototype=$t(baseLodash.prototype),LodashWrapper.prototype.constructor=LodashWrapper,LazyWrapper.prototype=$t(baseLodash.prototype),LazyWrapper.prototype.constructor=LazyWrapper,Hash.prototype.clear=function hashClear(){this.__data__=Rt?Rt(null):{},this.size=0},Hash.prototype.delete=function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Hash.prototype.get=function hashGet(e){var t=this.__data__;if(Rt){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Ce.call(t,e)?t[e]:void 0},Hash.prototype.has=function hashHas(e){var t=this.__data__;return Rt?void 0!==t[e]:Ce.call(t,e)},Hash.prototype.set=function hashSet(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Rt&&void 0===t?"__lodash_hash_undefined__":t,this},ListCache.prototype.clear=function listCacheClear(){this.__data__=[],this.size=0},ListCache.prototype.delete=function listCacheDelete(e){var t=this.__data__,n=assocIndexOf(t,e);return!(n<0)&&(n==t.length-1?t.pop():ze.call(t,n,1),--this.size,!0)},ListCache.prototype.get=function listCacheGet(e){var t=this.__data__,n=assocIndexOf(t,e);return n<0?void 0:t[n][1]},ListCache.prototype.has=function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1},ListCache.prototype.set=function listCacheSet(e,t){var n=this.__data__,r=assocIndexOf(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},MapCache.prototype.clear=function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Tt||ListCache),string:new Hash}},MapCache.prototype.delete=function mapCacheDelete(e){var t=getMapData(this,e).delete(e);return this.size-=t?1:0,t},MapCache.prototype.get=function mapCacheGet(e){return getMapData(this,e).get(e)},MapCache.prototype.has=function mapCacheHas(e){return getMapData(this,e).has(e)},MapCache.prototype.set=function mapCacheSet(e,t){var n=getMapData(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},SetCache.prototype.add=SetCache.prototype.push=function setCacheAdd(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},SetCache.prototype.has=function setCacheHas(e){return this.__data__.has(e)},Stack.prototype.clear=function stackClear(){this.__data__=new ListCache,this.size=0},Stack.prototype.delete=function stackDelete(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Stack.prototype.get=function stackGet(e){return this.__data__.get(e)},Stack.prototype.has=function stackHas(e){return this.__data__.has(e)},Stack.prototype.set=function stackSet(e,t){var n=this.__data__;if(n instanceof ListCache){var r=n.__data__;if(!Tt||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new MapCache(r)}return n.set(e,t),this.size=n.size,this};var Gt=createBaseEach(baseForOwn),qt=createBaseEach(baseForOwnRight,!0);function baseEvery(e,t){var n=!0;return Gt(e,(function(e,r,o){return n=!!t(e,r,o)})),n}function baseExtremum(e,t,n){for(var r=-1,o=e.length;++r<o;){var i=e[r],s=t(i);if(null!=s&&(void 0===a?s==s&&!isSymbol(s):n(s,a)))var a=s,c=i}return c}function baseFilter(e,t){var n=[];return Gt(e,(function(e,r,o){t(e,r,o)&&n.push(e)})),n}function baseFlatten(e,t,n,r,o){var i=-1,s=e.length;for(n||(n=isFlattenable),o||(o=[]);++i<s;){var a=e[i];t>0&&n(a)?t>1?baseFlatten(a,t-1,n,r,o):arrayPush(o,a):r||(o[o.length]=a)}return o}var Ht=createBaseFor(),Yt=createBaseFor(!0);function baseForOwn(e,t){return e&&Ht(e,t,keys)}function baseForOwnRight(e,t){return e&&Yt(e,t,keys)}function baseFunctions(e,t){return arrayFilter(t,(function(t){return isFunction(e[t])}))}function baseGet(e,t){for(var n=0,r=(t=castPath(t,e)).length;null!=e&&n<r;)e=e[toKey(t[n++])];return n&&n==r?e:void 0}function baseGetAllKeys(e,t,n){var r=t(e);return Kn(e)?r:arrayPush(r,n(e))}function baseGetTag(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Ze&&Ze in me(e)?function getRawTag(e){var t=Ce.call(e,Ze),n=e[Ze];try{e[Ze]=void 0;var r=!0}catch(e){}var o=Oe.call(e);r&&(t?e[Ze]=n:delete e[Ze]);return o}(e):function objectToString(e){return Oe.call(e)}(e)}function baseGt(e,t){return e>t}function baseHas(e,t){return null!=e&&Ce.call(e,t)}function baseHasIn(e,t){return null!=e&&t in me(e)}function baseIntersection(e,t,r){for(var o=r?arrayIncludesWith:arrayIncludes,i=e[0].length,s=e.length,a=s,c=n(s),u=1/0,l=[];a--;){var d=e[a];a&&t&&(d=arrayMap(d,baseUnary(t))),u=bt(d.length,u),c[a]=!r&&(t||i>=120&&d.length>=120)?new SetCache(a&&d):void 0}d=e[0];var p=-1,h=c[0];e:for(;++p<i&&l.length<u;){var m=d[p],y=t?t(m):m;if(m=r||0!==m?m:0,!(h?cacheHas(h,y):o(l,y,r))){for(a=s;--a;){var g=c[a];if(!(g?cacheHas(g,y):o(e[a],y,r)))continue e}h&&h.push(y),l.push(m)}}return l}function baseInvoke(e,t,n){var r=null==(e=parent(e,t=castPath(t,e)))?e:e[toKey(last(t))];return null==r?void 0:apply(r,e,n)}function baseIsArguments(e){return isObjectLike(e)&&baseGetTag(e)==a}function baseIsEqual(e,t,n,r,o){return e===t||(null==e||null==t||!isObjectLike(e)&&!isObjectLike(t)?e!=e&&t!=t:function baseIsEqualDeep(e,t,n,r,o,i){var s=Kn(e),p=Kn(t),h=s?c:nn(e),b=p?c:nn(t),w=(h=h==a?g:h)==g,A=(b=b==a?g:b)==g,O=h==b;if(O&&Wn(e)){if(!Wn(t))return!1;s=!0,w=!1}if(O&&!w)return i||(i=new Stack),s||tr(e)?equalArrays(e,t,n,r,o,i):function equalByTag(e,t,n,r,o,i,s){switch(n){case C:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case S:return!(e.byteLength!=t.byteLength||!i(new Le(e),new Le(t)));case u:case l:case y:return eq(+e,+t);case d:return e.name==t.name&&e.message==t.message;case _:case E:return e==t+"";case m:var a=mapToArray;case v:var c=1&r;if(a||(a=setToArray),e.size!=t.size&&!c)return!1;var p=s.get(e);if(p)return p==t;r|=2,s.set(e,t);var h=equalArrays(a(e),a(t),r,o,i,s);return s.delete(e),h;case I:if(Bt)return Bt.call(e)==Bt.call(t)}return!1}(e,t,h,n,r,o,i);if(!(1&n)){var P=w&&Ce.call(e,"__wrapped__"),D=A&&Ce.call(t,"__wrapped__");if(P||D){var x=P?e.value():e,R=D?t.value():t;return i||(i=new Stack),o(x,R,n,r,i)}}if(!O)return!1;return i||(i=new Stack),function equalObjects(e,t,n,r,o,i){var s=1&n,a=getAllKeys(e),c=a.length,u=getAllKeys(t).length;if(c!=u&&!s)return!1;var l=c;for(;l--;){var d=a[l];if(!(s?d in t:Ce.call(t,d)))return!1}var p=i.get(e),h=i.get(t);if(p&&h)return p==t&&h==e;var m=!0;i.set(e,t),i.set(t,e);var y=s;for(;++l<c;){d=a[l];var g=e[d],_=t[d];if(r)var v=s?r(_,g,d,t,e,i):r(g,_,d,e,t,i);if(!(void 0===v?g===_||o(g,_,n,r,i):v)){m=!1;break}y||(y="constructor"==d)}if(m&&!y){var E=e.constructor,I=t.constructor;E==I||!("constructor"in e)||!("constructor"in t)||"function"==typeof E&&E instanceof E&&"function"==typeof I&&I instanceof I||(m=!1)}return i.delete(e),i.delete(t),m}(e,t,n,r,o,i)}(e,t,n,r,baseIsEqual,o))}function baseIsMatch(e,t,n,r){var o=n.length,i=o,s=!r;if(null==e)return!i;for(e=me(e);o--;){var a=n[o];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++o<i;){var c=(a=n[o])[0],u=e[c],l=a[1];if(s&&a[2]){if(void 0===u&&!(c in e))return!1}else{var d=new Stack;if(r)var p=r(u,l,c,e,t,d);if(!(void 0===p?baseIsEqual(l,u,3,r,d):p))return!1}}return!0}function baseIsNative(e){return!(!isObject(e)||function isMasked(e){return!!Ae&&Ae in e}(e))&&(isFunction(e)?De:ae).test(toSource(e))}function baseIteratee(e){return"function"==typeof e?e:null==e?identity:"object"==typeof e?Kn(e)?baseMatchesProperty(e[0],e[1]):baseMatches(e):property(e)}function baseKeys(e){if(!isPrototype(e))return Et(e);var t=[];for(var n in me(e))Ce.call(e,n)&&"constructor"!=n&&t.push(n);return t}function baseKeysIn(e){if(!isObject(e))return function nativeKeysIn(e){var t=[];if(null!=e)for(var n in me(e))t.push(n);return t}(e);var t=isPrototype(e),n=[];for(var r in e)("constructor"!=r||!t&&Ce.call(e,r))&&n.push(r);return n}function baseLt(e,t){return e<t}function baseMap(e,t){var r=-1,o=isArrayLike(e)?n(e.length):[];return Gt(e,(function(e,n,i){o[++r]=t(e,n,i)})),o}function baseMatches(e){var t=getMatchData(e);return 1==t.length&&t[0][2]?matchesStrictComparable(t[0][0],t[0][1]):function(n){return n===e||baseIsMatch(n,e,t)}}function baseMatchesProperty(e,t){return isKey(e)&&isStrictComparable(t)?matchesStrictComparable(toKey(e),t):function(n){var r=get(n,e);return void 0===r&&r===t?hasIn(n,e):baseIsEqual(t,r,3)}}function baseMerge(e,t,n,r,o){e!==t&&Ht(t,(function(i,s){if(o||(o=new Stack),isObject(i))!function baseMergeDeep(e,t,n,r,o,i,s){var a=safeGet(e,n),c=safeGet(t,n),u=s.get(c);if(u)return void assignMergeValue(e,n,u);var l=i?i(a,c,n+"",e,t,s):void 0,d=void 0===l;if(d){var p=Kn(c),h=!p&&Wn(c),m=!p&&!h&&tr(c);l=c,p||h||m?Kn(a)?l=a:isArrayLikeObject(a)?l=copyArray(a):h?(d=!1,l=cloneBuffer(c,!0)):m?(d=!1,l=cloneTypedArray(c,!0)):l=[]:isPlainObject(c)||Yn(c)?(l=a,Yn(a)?l=toPlainObject(a):isObject(a)&&!isFunction(a)||(l=initCloneObject(c))):d=!1}d&&(s.set(c,l),o(l,c,r,i,s),s.delete(c));assignMergeValue(e,n,l)}(e,t,s,n,baseMerge,r,o);else{var a=r?r(safeGet(e,s),i,s+"",e,t,o):void 0;void 0===a&&(a=i),assignMergeValue(e,s,a)}}),keysIn)}function baseNth(e,t){var n=e.length;if(n)return isIndex(t+=t<0?n:0,n)?e[t]:void 0}function baseOrderBy(e,t,n){t=t.length?arrayMap(t,(function(e){return Kn(e)?function(t){return baseGet(t,1===e.length?e[0]:e)}:e})):[identity];var r=-1;return t=arrayMap(t,baseUnary(getIteratee())),function baseSortBy(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(baseMap(e,(function(e,n,o){return{criteria:arrayMap(t,(function(t){return t(e)})),index:++r,value:e}})),(function(e,t){return function compareMultiple(e,t,n){var r=-1,o=e.criteria,i=t.criteria,s=o.length,a=n.length;for(;++r<s;){var c=compareAscending(o[r],i[r]);if(c){if(r>=a)return c;var u=n[r];return c*("desc"==u?-1:1)}}return e.index-t.index}(e,t,n)}))}function basePickBy(e,t,n){for(var r=-1,o=t.length,i={};++r<o;){var s=t[r],a=baseGet(e,s);n(a,s)&&baseSet(i,castPath(s,e),a)}return i}function basePullAll(e,t,n,r){var o=r?baseIndexOfWith:baseIndexOf,i=-1,s=t.length,a=e;for(e===t&&(t=copyArray(t)),n&&(a=arrayMap(e,baseUnary(n)));++i<s;)for(var c=0,u=t[i],l=n?n(u):u;(c=o(a,l,c,r))>-1;)a!==e&&ze.call(a,c,1),ze.call(e,c,1);return e}function basePullAt(e,t){for(var n=e?t.length:0,r=n-1;n--;){var o=t[n];if(n==r||o!==i){var i=o;isIndex(o)?ze.call(e,o,1):baseUnset(e,o)}}return e}function baseRandom(e,t){return e+mt(wt()*(t-e+1))}function baseRepeat(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=mt(t/2))&&(e+=e)}while(t);return n}function baseRest(e,t){return cn(overRest(e,t,identity),e+"")}function baseSample(e){return arraySample(values(e))}function baseSampleSize(e,t){var n=values(e);return shuffleSelf(n,baseClamp(t,0,n.length))}function baseSet(e,t,n,r){if(!isObject(e))return e;for(var o=-1,i=(t=castPath(t,e)).length,s=i-1,a=e;null!=a&&++o<i;){var c=toKey(t[o]),u=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=s){var l=a[c];void 0===(u=r?r(l,c,a):void 0)&&(u=isObject(l)?l:isIndex(t[o+1])?[]:{})}assignValue(a,c,u),a=a[c]}return e}var Kt=Nt?function(e,t){return Nt.set(e,t),e}:identity,zt=st?function(e,t){return st(e,"toString",{configurable:!0,enumerable:!1,value:constant(t),writable:!0})}:identity;function baseShuffle(e){return shuffleSelf(values(e))}function baseSlice(e,t,r){var o=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var s=n(i);++o<i;)s[o]=e[o+t];return s}function baseSome(e,t){var n;return Gt(e,(function(e,r,o){return!(n=t(e,r,o))})),!!n}function baseSortedIndex(e,t,n){var r=0,o=null==e?r:e.length;if("number"==typeof t&&t==t&&o<=2147483647){for(;r<o;){var i=r+o>>>1,s=e[i];null!==s&&!isSymbol(s)&&(n?s<=t:s<t)?r=i+1:o=i}return o}return baseSortedIndexBy(e,t,identity,n)}function baseSortedIndexBy(e,t,n,r){var o=0,i=null==e?0:e.length;if(0===i)return 0;for(var s=(t=n(t))!=t,a=null===t,c=isSymbol(t),u=void 0===t;o<i;){var l=mt((o+i)/2),d=n(e[l]),p=void 0!==d,h=null===d,m=d==d,y=isSymbol(d);if(s)var g=r||m;else g=u?m&&(r||p):a?m&&p&&(r||!h):c?m&&p&&!h&&(r||!y):!h&&!y&&(r?d<=t:d<t);g?o=l+1:i=l}return bt(i,4294967294)}function baseSortedUniq(e,t){for(var n=-1,r=e.length,o=0,i=[];++n<r;){var s=e[n],a=t?t(s):s;if(!n||!eq(a,c)){var c=a;i[o++]=0===s?0:s}}return i}function baseToNumber(e){return"number"==typeof e?e:isSymbol(e)?NaN:+e}function baseToString(e){if("string"==typeof e)return e;if(Kn(e))return arrayMap(e,baseToString)+"";if(isSymbol(e))return Jt?Jt.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function baseUniq(e,t,n){var r=-1,o=arrayIncludes,i=e.length,s=!0,a=[],c=a;if(n)s=!1,o=arrayIncludesWith;else if(i>=200){var u=t?null:Xt(e);if(u)return setToArray(u);s=!1,o=cacheHas,c=new SetCache}else c=t?[]:a;e:for(;++r<i;){var l=e[r],d=t?t(l):l;if(l=n||0!==l?l:0,s&&d==d){for(var p=c.length;p--;)if(c[p]===d)continue e;t&&c.push(d),a.push(l)}else o(c,d,n)||(c!==a&&c.push(d),a.push(l))}return a}function baseUnset(e,t){return null==(e=parent(e,t=castPath(t,e)))||delete e[toKey(last(t))]}function baseUpdate(e,t,n,r){return baseSet(e,t,n(baseGet(e,t)),r)}function baseWhile(e,t,n,r){for(var o=e.length,i=r?o:-1;(r?i--:++i<o)&&t(e[i],i,e););return n?baseSlice(e,r?0:i,r?i+1:o):baseSlice(e,r?i+1:0,r?o:i)}function baseWrapperValue(e,t){var n=e;return n instanceof LazyWrapper&&(n=n.value()),arrayReduce(t,(function(e,t){return t.func.apply(t.thisArg,arrayPush([e],t.args))}),n)}function baseXor(e,t,r){var o=e.length;if(o<2)return o?baseUniq(e[0]):[];for(var i=-1,s=n(o);++i<o;)for(var a=e[i],c=-1;++c<o;)c!=i&&(s[i]=baseDifference(s[i]||a,e[c],t,r));return baseUniq(baseFlatten(s,1),t,r)}function baseZipObject(e,t,n){for(var r=-1,o=e.length,i=t.length,s={};++r<o;){var a=r<i?t[r]:void 0;n(s,e[r],a)}return s}function castArrayLikeObject(e){return isArrayLikeObject(e)?e:[]}function castFunction(e){return"function"==typeof e?e:identity}function castPath(e,t){return Kn(e)?e:isKey(e,t)?[e]:un(toString(e))}var Wt=baseRest;function castSlice(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:baseSlice(e,t,n)}var Qt=dt||function(e){return Ke.clearTimeout(e)};function cloneBuffer(e,t){if(t)return e.slice();var n=e.length,r=ke?ke(n):new e.constructor(n);return e.copy(r),r}function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new Le(t).set(new Le(e)),t}function cloneTypedArray(e,t){var n=t?cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function compareAscending(e,t){if(e!==t){var n=void 0!==e,r=null===e,o=e==e,i=isSymbol(e),s=void 0!==t,a=null===t,c=t==t,u=isSymbol(t);if(!a&&!u&&!i&&e>t||i&&s&&c&&!a&&!u||r&&s&&c||!n&&c||!o)return 1;if(!r&&!i&&!u&&e<t||u&&n&&o&&!r&&!i||a&&n&&o||!s&&o||!c)return-1}return 0}function composeArgs(e,t,r,o){for(var i=-1,s=e.length,a=r.length,c=-1,u=t.length,l=It(s-a,0),d=n(u+l),p=!o;++c<u;)d[c]=t[c];for(;++i<a;)(p||i<s)&&(d[r[i]]=e[i]);for(;l--;)d[c++]=e[i++];return d}function composeArgsRight(e,t,r,o){for(var i=-1,s=e.length,a=-1,c=r.length,u=-1,l=t.length,d=It(s-c,0),p=n(d+l),h=!o;++i<d;)p[i]=e[i];for(var m=i;++u<l;)p[m+u]=t[u];for(;++a<c;)(h||i<s)&&(p[m+r[a]]=e[i++]);return p}function copyArray(e,t){var r=-1,o=e.length;for(t||(t=n(o));++r<o;)t[r]=e[r];return t}function copyObject(e,t,n,r){var o=!n;n||(n={});for(var i=-1,s=t.length;++i<s;){var a=t[i],c=r?r(n[a],e[a],a,n,e):void 0;void 0===c&&(c=e[a]),o?baseAssignValue(n,a,c):assignValue(n,a,c)}return n}function createAggregator(e,t){return function(n,r){var o=Kn(n)?arrayAggregator:baseAggregator,i=t?t():{};return o(n,e,getIteratee(r,2),i)}}function createAssigner(e){return baseRest((function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,s=o>2?n[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,s&&isIterateeCall(n[0],n[1],s)&&(i=o<3?void 0:i,o=1),t=me(t);++r<o;){var a=n[r];a&&e(t,a,r,i)}return t}))}function createBaseEach(e,t){return function(n,r){if(null==n)return n;if(!isArrayLike(n))return e(n,r);for(var o=n.length,i=t?o:-1,s=me(n);(t?i--:++i<o)&&!1!==r(s[i],i,s););return n}}function createBaseFor(e){return function(t,n,r){for(var o=-1,i=me(t),s=r(t),a=s.length;a--;){var c=s[e?a:++o];if(!1===n(i[c],c,i))break}return t}}function createCaseFirst(e){return function(t){var n=hasUnicode(t=toString(t))?stringToArray(t):void 0,r=n?n[0]:t.charAt(0),o=n?castSlice(n,1).join(""):t.slice(1);return r[e]()+o}}function createCompounder(e){return function(t){return arrayReduce(words(deburr(t).replace(Ne,"")),e,"")}}function createCtor(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=$t(e.prototype),r=e.apply(n,t);return isObject(r)?r:n}}function createFind(e){return function(t,n,r){var o=me(t);if(!isArrayLike(t)){var i=getIteratee(n,3);t=keys(t),n=function(e){return i(o[e],e,o)}}var s=e(t,n,r);return s>-1?o[i?t[s]:s]:void 0}}function createFlow(e){return flatRest((function(t){var n=t.length,r=n,i=LodashWrapper.prototype.thru;for(e&&t.reverse();r--;){var s=t[r];if("function"!=typeof s)throw new _e(o);if(i&&!a&&"wrapper"==getFuncName(s))var a=new LodashWrapper([],!0)}for(r=a?r:n;++r<n;){var c=getFuncName(s=t[r]),u="wrapper"==c?Zt(s):void 0;a=u&&isLaziable(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?a[getFuncName(u[0])].apply(a,u[3]):1==s.length&&isLaziable(s)?a[c]():a.thru(s)}return function(){var e=arguments,r=e[0];if(a&&1==e.length&&Kn(r))return a.plant(r).value();for(var o=0,i=n?t[o].apply(this,e):r;++o<n;)i=t[o].call(this,i);return i}}))}function createHybrid(e,t,r,o,i,s,a,c,u,l){var d=128&t,p=1&t,h=2&t,m=24&t,y=512&t,g=h?void 0:createCtor(e);return function wrapper(){for(var _=arguments.length,v=n(_),E=_;E--;)v[E]=arguments[E];if(m)var I=getHolder(wrapper),b=countHolders(v,I);if(o&&(v=composeArgs(v,o,i,m)),s&&(v=composeArgsRight(v,s,a,m)),_-=b,m&&_<l){var S=replaceHolders(v,I);return createRecurry(e,t,createHybrid,wrapper.placeholder,r,v,S,c,u,l-_)}var C=p?r:this,w=h?C[e]:e;return _=v.length,c?v=reorder(v,c):y&&_>1&&v.reverse(),d&&u<_&&(v.length=u),this&&this!==Ke&&this instanceof wrapper&&(w=g||createCtor(w)),w.apply(C,v)}}function createInverter(e,t){return function(n,r){return function baseInverter(e,t,n,r){return baseForOwn(e,(function(e,o,i){t(r,n(e),o,i)})),r}(n,e,t(r),{})}}function createMathOperation(e,t){return function(n,r){var o;if(void 0===n&&void 0===r)return t;if(void 0!==n&&(o=n),void 0!==r){if(void 0===o)return r;"string"==typeof n||"string"==typeof r?(n=baseToString(n),r=baseToString(r)):(n=baseToNumber(n),r=baseToNumber(r)),o=e(n,r)}return o}}function createOver(e){return flatRest((function(t){return t=arrayMap(t,baseUnary(getIteratee())),baseRest((function(n){var r=this;return e(t,(function(e){return apply(e,r,n)}))}))}))}function createPadding(e,t){var n=(t=void 0===t?" ":baseToString(t)).length;if(n<2)return n?baseRepeat(t,e):t;var r=baseRepeat(t,ft(e/stringSize(t)));return hasUnicode(t)?castSlice(stringToArray(r),0,e).join(""):r.slice(0,e)}function createRange(e){return function(t,r,o){return o&&"number"!=typeof o&&isIterateeCall(t,r,o)&&(r=o=void 0),t=toFinite(t),void 0===r?(r=t,t=0):r=toFinite(r),function baseRange(e,t,r,o){for(var i=-1,s=It(ft((t-e)/(r||1)),0),a=n(s);s--;)a[o?s:++i]=e,e+=r;return a}(t,r,o=void 0===o?t<r?1:-1:toFinite(o),e)}}function createRelationalOperation(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=toNumber(t),n=toNumber(n)),e(t,n)}}function createRecurry(e,t,n,r,o,i,s,a,c,u){var l=8&t;t|=l?32:64,4&(t&=~(l?64:32))||(t&=-4);var d=[e,t,o,l?i:void 0,l?s:void 0,l?void 0:i,l?void 0:s,a,c,u],p=n.apply(void 0,d);return isLaziable(e)&&sn(p,d),p.placeholder=r,setWrapToString(p,e,t)}function createRound(e){var t=fe[e];return function(e,n){if(e=toNumber(e),(n=null==n?0:bt(toInteger(n),292))&&_t(e)){var r=(toString(e)+"e").split("e");return+((r=(toString(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Xt=Dt&&1/setToArray(new Dt([,-0]))[1]==1/0?function(e){return new Dt(e)}:noop;function createToPairs(e){return function(t){var n=nn(t);return n==m?mapToArray(t):n==v?setToPairs(t):function baseToPairs(e,t){return arrayMap(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function createWrap(e,t,r,s,a,c,u,l){var d=2&t;if(!d&&"function"!=typeof e)throw new _e(o);var p=s?s.length:0;if(p||(t&=-97,s=a=void 0),u=void 0===u?u:It(toInteger(u),0),l=void 0===l?l:toInteger(l),p-=a?a.length:0,64&t){var h=s,m=a;s=a=void 0}var y=d?void 0:Zt(e),g=[e,t,r,s,a,h,m,c,u,l];if(y&&function mergeData(e,t){var n=e[1],r=t[1],o=n|r,s=o<131,a=128==r&&8==n||128==r&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!s&&!a)return e;1&r&&(e[2]=t[2],o|=1&n?0:4);var c=t[3];if(c){var u=e[3];e[3]=u?composeArgs(u,c,t[4]):c,e[4]=u?replaceHolders(e[3],i):t[4]}(c=t[5])&&(u=e[5],e[5]=u?composeArgsRight(u,c,t[6]):c,e[6]=u?replaceHolders(e[5],i):t[6]);(c=t[7])&&(e[7]=c);128&r&&(e[8]=null==e[8]?t[8]:bt(e[8],t[8]));null==e[9]&&(e[9]=t[9]);return e[0]=t[0],e[1]=o,e}(g,y),e=g[0],t=g[1],r=g[2],s=g[3],a=g[4],!(l=g[9]=void 0===g[9]?d?0:e.length:It(g[9]-p,0))&&24&t&&(t&=-25),t&&1!=t)_=8==t||16==t?function createCurry(e,t,r){var o=createCtor(e);return function wrapper(){for(var i=arguments.length,s=n(i),a=i,c=getHolder(wrapper);a--;)s[a]=arguments[a];var u=i<3&&s[0]!==c&&s[i-1]!==c?[]:replaceHolders(s,c);if((i-=u.length)<r)return createRecurry(e,t,createHybrid,wrapper.placeholder,void 0,s,u,void 0,void 0,r-i);var l=this&&this!==Ke&&this instanceof wrapper?o:e;return apply(l,this,s)}}(e,t,l):32!=t&&33!=t||a.length?createHybrid.apply(void 0,g):function createPartial(e,t,r,o){var i=1&t,s=createCtor(e);return function wrapper(){for(var t=-1,a=arguments.length,c=-1,u=o.length,l=n(u+a),d=this&&this!==Ke&&this instanceof wrapper?s:e;++c<u;)l[c]=o[c];for(;a--;)l[c++]=arguments[++t];return apply(d,i?r:this,l)}}(e,t,r,s);else var _=function createBind(e,t,n){var r=1&t,o=createCtor(e);return function wrapper(){var t=this&&this!==Ke&&this instanceof wrapper?o:e;return t.apply(r?n:this,arguments)}}(e,t,r);return setWrapToString((y?Kt:sn)(_,g),e,t)}function customDefaultsAssignIn(e,t,n,r){return void 0===e||eq(e,Ie[n])&&!Ce.call(r,n)?t:e}function customDefaultsMerge(e,t,n,r,o,i){return isObject(e)&&isObject(t)&&(i.set(t,e),baseMerge(e,t,void 0,customDefaultsMerge,i),i.delete(t)),e}function customOmitClone(e){return isPlainObject(e)?void 0:e}function equalArrays(e,t,n,r,o,i){var s=1&n,a=e.length,c=t.length;if(a!=c&&!(s&&c>a))return!1;var u=i.get(e),l=i.get(t);if(u&&l)return u==t&&l==e;var d=-1,p=!0,h=2&n?new SetCache:void 0;for(i.set(e,t),i.set(t,e);++d<a;){var m=e[d],y=t[d];if(r)var g=s?r(y,m,d,t,e,i):r(m,y,d,e,t,i);if(void 0!==g){if(g)continue;p=!1;break}if(h){if(!arraySome(t,(function(e,t){if(!cacheHas(h,t)&&(m===e||o(m,e,n,r,i)))return h.push(t)}))){p=!1;break}}else if(m!==y&&!o(m,y,n,r,i)){p=!1;break}}return i.delete(e),i.delete(t),p}function flatRest(e){return cn(overRest(e,void 0,flatten),e+"")}function getAllKeys(e){return baseGetAllKeys(e,keys,en)}function getAllKeysIn(e){return baseGetAllKeys(e,keysIn,tn)}var Zt=Nt?function(e){return Nt.get(e)}:noop;function getFuncName(e){for(var t=e.name+"",n=Mt[t],r=Ce.call(Mt,t)?n.length:0;r--;){var o=n[r],i=o.func;if(null==i||i==e)return o.name}return t}function getHolder(e){return(Ce.call(lodash,"placeholder")?lodash:e).placeholder}function getIteratee(){var e=lodash.iteratee||iteratee;return e=e===iteratee?baseIteratee:e,arguments.length?e(arguments[0],arguments[1]):e}function getMapData(e,t){var n=e.__data__;return function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function getMatchData(e){for(var t=keys(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,isStrictComparable(o)]}return t}function getNative(e,t){var n=function getValue(e,t){return null==e?void 0:e[t]}(e,t);return baseIsNative(n)?n:void 0}var en=yt?function(e){return null==e?[]:(e=me(e),arrayFilter(yt(e),(function(t){return Ye.call(e,t)})))}:stubArray,tn=yt?function(e){for(var t=[];e;)arrayPush(t,en(e)),e=$e(e);return t}:stubArray,nn=baseGetTag;function hasPath(e,t,n){for(var r=-1,o=(t=castPath(t,e)).length,i=!1;++r<o;){var s=toKey(t[r]);if(!(i=null!=e&&n(e,s)))break;e=e[s]}return i||++r!=o?i:!!(o=null==e?0:e.length)&&isLength(o)&&isIndex(s,o)&&(Kn(e)||Yn(e))}function initCloneObject(e){return"function"!=typeof e.constructor||isPrototype(e)?{}:$t($e(e))}function isFlattenable(e){return Kn(e)||Yn(e)||!!(We&&e&&e[We])}function isIndex(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&ue.test(e))&&e>-1&&e%1==0&&e<t}function isIterateeCall(e,t,n){if(!isObject(n))return!1;var r=typeof t;return!!("number"==r?isArrayLike(n)&&isIndex(t,n.length):"string"==r&&t in n)&&eq(n[t],e)}function isKey(e,t){if(Kn(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!isSymbol(e))||(q.test(e)||!G.test(e)||null!=t&&e in me(t))}function isLaziable(e){var t=getFuncName(e),n=lodash[t];if("function"!=typeof n||!(t in LazyWrapper.prototype))return!1;if(e===n)return!0;var r=Zt(n);return!!r&&e===r[0]}(Ot&&nn(new Ot(new ArrayBuffer(1)))!=C||Tt&&nn(new Tt)!=m||Pt&&"[object Promise]"!=nn(Pt.resolve())||Dt&&nn(new Dt)!=v||xt&&nn(new xt)!=b)&&(nn=function(e){var t=baseGetTag(e),n=t==g?e.constructor:void 0,r=n?toSource(n):"";if(r)switch(r){case Lt:return C;case jt:return m;case kt:return"[object Promise]";case Ft:return v;case Ut:return b}return t});var rn=be?isFunction:stubFalse;function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ie)}function isStrictComparable(e){return e==e&&!isObject(e)}function matchesStrictComparable(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in me(n)))}}function overRest(e,t,r){return t=It(void 0===t?e.length-1:t,0),function(){for(var o=arguments,i=-1,s=It(o.length-t,0),a=n(s);++i<s;)a[i]=o[t+i];i=-1;for(var c=n(t+1);++i<t;)c[i]=o[i];return c[t]=r(a),apply(e,this,c)}}function parent(e,t){return t.length<2?e:baseGet(e,baseSlice(t,0,-1))}function reorder(e,t){for(var n=e.length,r=bt(t.length,n),o=copyArray(e);r--;){var i=t[r];e[r]=isIndex(i,n)?o[i]:void 0}return e}function safeGet(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var sn=shortOut(Kt),an=ht||function(e,t){return Ke.setTimeout(e,t)},cn=shortOut(zt);function setWrapToString(e,t,n){var r=t+"";return cn(e,function insertWrapDetails(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(Q,"{\n/* [wrapped with "+t+"] */\n")}(r,function updateWrapDetails(e,t){return arrayEach(s,(function(n){var r="_."+n[0];t&n[1]&&!arrayIncludes(e,r)&&e.push(r)})),e.sort()}(function getWrapDetails(e){var t=e.match(X);return t?t[1].split(Z):[]}(r),n)))}function shortOut(e){var t=0,n=0;return function(){var r=St(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function shuffleSelf(e,t){var n=-1,r=e.length,o=r-1;for(t=void 0===t?r:t;++n<t;){var i=baseRandom(n,o),s=e[i];e[i]=e[n],e[n]=s}return e.length=t,e}var un=function memoizeCapped(e){var t=memoize(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(H,(function(e,n,r,o){t.push(r?o.replace(ne,"$1"):n||e)})),t}));function toKey(e){if("string"==typeof e||isSymbol(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function toSource(e){if(null!=e){try{return Se.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function wrapperClone(e){if(e instanceof LazyWrapper)return e.clone();var t=new LodashWrapper(e.__wrapped__,e.__chain__);return t.__actions__=copyArray(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var ln=baseRest((function(e,t){return isArrayLikeObject(e)?baseDifference(e,baseFlatten(t,1,isArrayLikeObject,!0)):[]})),dn=baseRest((function(e,t){var n=last(t);return isArrayLikeObject(n)&&(n=void 0),isArrayLikeObject(e)?baseDifference(e,baseFlatten(t,1,isArrayLikeObject,!0),getIteratee(n,2)):[]})),pn=baseRest((function(e,t){var n=last(t);return isArrayLikeObject(n)&&(n=void 0),isArrayLikeObject(e)?baseDifference(e,baseFlatten(t,1,isArrayLikeObject,!0),void 0,n):[]}));function findIndex(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=null==n?0:toInteger(n);return o<0&&(o=It(r+o,0)),baseFindIndex(e,getIteratee(t,3),o)}function findLastIndex(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return void 0!==n&&(o=toInteger(n),o=n<0?It(r+o,0):bt(o,r-1)),baseFindIndex(e,getIteratee(t,3),o,!0)}function flatten(e){return(null==e?0:e.length)?baseFlatten(e,1):[]}function head(e){return e&&e.length?e[0]:void 0}var hn=baseRest((function(e){var t=arrayMap(e,castArrayLikeObject);return t.length&&t[0]===e[0]?baseIntersection(t):[]})),fn=baseRest((function(e){var t=last(e),n=arrayMap(e,castArrayLikeObject);return t===last(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?baseIntersection(n,getIteratee(t,2)):[]})),mn=baseRest((function(e){var t=last(e),n=arrayMap(e,castArrayLikeObject);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?baseIntersection(n,void 0,t):[]}));function last(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var yn=baseRest(pullAll);function pullAll(e,t){return e&&e.length&&t&&t.length?basePullAll(e,t):e}var gn=flatRest((function(e,t){var n=null==e?0:e.length,r=baseAt(e,t);return basePullAt(e,arrayMap(t,(function(e){return isIndex(e,n)?+e:e})).sort(compareAscending)),r}));function reverse(e){return null==e?e:At.call(e)}var _n=baseRest((function(e){return baseUniq(baseFlatten(e,1,isArrayLikeObject,!0))})),vn=baseRest((function(e){var t=last(e);return isArrayLikeObject(t)&&(t=void 0),baseUniq(baseFlatten(e,1,isArrayLikeObject,!0),getIteratee(t,2))})),En=baseRest((function(e){var t=last(e);return t="function"==typeof t?t:void 0,baseUniq(baseFlatten(e,1,isArrayLikeObject,!0),void 0,t)}));function unzip(e){if(!e||!e.length)return[];var t=0;return e=arrayFilter(e,(function(e){if(isArrayLikeObject(e))return t=It(e.length,t),!0})),baseTimes(t,(function(t){return arrayMap(e,baseProperty(t))}))}function unzipWith(e,t){if(!e||!e.length)return[];var n=unzip(e);return null==t?n:arrayMap(n,(function(e){return apply(t,void 0,e)}))}var In=baseRest((function(e,t){return isArrayLikeObject(e)?baseDifference(e,t):[]})),bn=baseRest((function(e){return baseXor(arrayFilter(e,isArrayLikeObject))})),Sn=baseRest((function(e){var t=last(e);return isArrayLikeObject(t)&&(t=void 0),baseXor(arrayFilter(e,isArrayLikeObject),getIteratee(t,2))})),Cn=baseRest((function(e){var t=last(e);return t="function"==typeof t?t:void 0,baseXor(arrayFilter(e,isArrayLikeObject),void 0,t)})),wn=baseRest(unzip);var An=baseRest((function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,unzipWith(e,n)}));function chain(e){var t=lodash(e);return t.__chain__=!0,t}function thru(e,t){return t(e)}var On=flatRest((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,interceptor=function(t){return baseAt(t,e)};return!(t>1||this.__actions__.length)&&r instanceof LazyWrapper&&isIndex(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:thru,args:[interceptor],thisArg:void 0}),new LodashWrapper(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(interceptor)}));var Tn=createAggregator((function(e,t,n){Ce.call(e,n)?++e[n]:baseAssignValue(e,n,1)}));var Pn=createFind(findIndex),Dn=createFind(findLastIndex);function forEach(e,t){return(Kn(e)?arrayEach:Gt)(e,getIteratee(t,3))}function forEachRight(e,t){return(Kn(e)?arrayEachRight:qt)(e,getIteratee(t,3))}var xn=createAggregator((function(e,t,n){Ce.call(e,n)?e[n].push(t):baseAssignValue(e,n,[t])}));var Rn=baseRest((function(e,t,r){var o=-1,i="function"==typeof t,s=isArrayLike(e)?n(e.length):[];return Gt(e,(function(e){s[++o]=i?apply(t,e,r):baseInvoke(e,t,r)})),s})),Nn=createAggregator((function(e,t,n){baseAssignValue(e,n,t)}));function map(e,t){return(Kn(e)?arrayMap:baseMap)(e,getIteratee(t,3))}var Mn=createAggregator((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var Ln=baseRest((function(e,t){if(null==e)return[];var n=t.length;return n>1&&isIterateeCall(e,t[0],t[1])?t=[]:n>2&&isIterateeCall(t[0],t[1],t[2])&&(t=[t[0]]),baseOrderBy(e,baseFlatten(t,1),[])})),jn=pt||function(){return Ke.Date.now()};function ary(e,t,n){return t=n?void 0:t,createWrap(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)}function before(e,t){var n;if("function"!=typeof t)throw new _e(o);return e=toInteger(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}var kn=baseRest((function(e,t,n){var r=1;if(n.length){var o=replaceHolders(n,getHolder(kn));r|=32}return createWrap(e,r,t,n,o)})),Fn=baseRest((function(e,t,n){var r=3;if(n.length){var o=replaceHolders(n,getHolder(Fn));r|=32}return createWrap(t,r,e,n,o)}));function debounce(e,t,n){var r,i,s,a,c,u,l=0,d=!1,p=!1,h=!0;if("function"!=typeof e)throw new _e(o);function invokeFunc(t){var n=r,o=i;return r=i=void 0,l=t,a=e.apply(o,n)}function leadingEdge(e){return l=e,c=an(timerExpired,t),d?invokeFunc(e):a}function shouldInvoke(e){var n=e-u;return void 0===u||n>=t||n<0||p&&e-l>=s}function timerExpired(){var e=jn();if(shouldInvoke(e))return trailingEdge(e);c=an(timerExpired,function remainingWait(e){var n=t-(e-u);return p?bt(n,s-(e-l)):n}(e))}function trailingEdge(e){return c=void 0,h&&r?invokeFunc(e):(r=i=void 0,a)}function debounced(){var e=jn(),n=shouldInvoke(e);if(r=arguments,i=this,u=e,n){if(void 0===c)return leadingEdge(u);if(p)return Qt(c),c=an(timerExpired,t),invokeFunc(u)}return void 0===c&&(c=an(timerExpired,t)),a}return t=toNumber(t)||0,isObject(n)&&(d=!!n.leading,s=(p="maxWait"in n)?It(toNumber(n.maxWait)||0,t):s,h="trailing"in n?!!n.trailing:h),debounced.cancel=function cancel(){void 0!==c&&Qt(c),l=0,r=u=i=c=void 0},debounced.flush=function flush(){return void 0===c?a:trailingEdge(jn())},debounced}var Un=baseRest((function(e,t){return baseDelay(e,1,t)})),Vn=baseRest((function(e,t,n){return baseDelay(e,toNumber(t)||0,n)}));function memoize(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new _e(o);var memoized=function(){var n=arguments,r=t?t.apply(this,n):n[0],o=memoized.cache;if(o.has(r))return o.get(r);var i=e.apply(this,n);return memoized.cache=o.set(r,i)||o,i};return memoized.cache=new(memoize.Cache||MapCache),memoized}function negate(e){if("function"!=typeof e)throw new _e(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}memoize.Cache=MapCache;var Bn=Wt((function(e,t){var n=(t=1==t.length&&Kn(t[0])?arrayMap(t[0],baseUnary(getIteratee())):arrayMap(baseFlatten(t,1),baseUnary(getIteratee()))).length;return baseRest((function(r){for(var o=-1,i=bt(r.length,n);++o<i;)r[o]=t[o].call(this,r[o]);return apply(e,this,r)}))})),Jn=baseRest((function(e,t){return createWrap(e,32,void 0,t,replaceHolders(t,getHolder(Jn)))})),$n=baseRest((function(e,t){return createWrap(e,64,void 0,t,replaceHolders(t,getHolder($n)))})),Gn=flatRest((function(e,t){return createWrap(e,256,void 0,void 0,void 0,t)}));function eq(e,t){return e===t||e!=e&&t!=t}var qn=createRelationalOperation(baseGt),Hn=createRelationalOperation((function(e,t){return e>=t})),Yn=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike(e)&&Ce.call(e,"callee")&&!Ye.call(e,"callee")},Kn=n.isArray,zn=et?baseUnary(et):function baseIsArrayBuffer(e){return isObjectLike(e)&&baseGetTag(e)==S};function isArrayLike(e){return null!=e&&isLength(e.length)&&!isFunction(e)}function isArrayLikeObject(e){return isObjectLike(e)&&isArrayLike(e)}var Wn=gt||stubFalse,Qn=tt?baseUnary(tt):function baseIsDate(e){return isObjectLike(e)&&baseGetTag(e)==l};function isError(e){if(!isObjectLike(e))return!1;var t=baseGetTag(e);return t==d||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!isPlainObject(e)}function isFunction(e){if(!isObject(e))return!1;var t=baseGetTag(e);return t==p||t==h||"[object AsyncFunction]"==t||"[object Proxy]"==t}function isInteger(e){return"number"==typeof e&&e==toInteger(e)}function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function isObjectLike(e){return null!=e&&"object"==typeof e}var Xn=nt?baseUnary(nt):function baseIsMap(e){return isObjectLike(e)&&nn(e)==m};function isNumber(e){return"number"==typeof e||isObjectLike(e)&&baseGetTag(e)==y}function isPlainObject(e){if(!isObjectLike(e)||baseGetTag(e)!=g)return!1;var t=$e(e);if(null===t)return!0;var n=Ce.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Se.call(n)==Te}var Zn=rt?baseUnary(rt):function baseIsRegExp(e){return isObjectLike(e)&&baseGetTag(e)==_};var er=ot?baseUnary(ot):function baseIsSet(e){return isObjectLike(e)&&nn(e)==v};function isString(e){return"string"==typeof e||!Kn(e)&&isObjectLike(e)&&baseGetTag(e)==E}function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&baseGetTag(e)==I}var tr=it?baseUnary(it):function baseIsTypedArray(e){return isObjectLike(e)&&isLength(e.length)&&!!Be[baseGetTag(e)]};var nr=createRelationalOperation(baseLt),rr=createRelationalOperation((function(e,t){return e<=t}));function toArray(e){if(!e)return[];if(isArrayLike(e))return isString(e)?stringToArray(e):copyArray(e);if(Xe&&e[Xe])return function iteratorToArray(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Xe]());var t=nn(e);return(t==m?mapToArray:t==v?setToArray:values)(e)}function toFinite(e){return e?(e=toNumber(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function toInteger(e){var t=toFinite(e),n=t%1;return t==t?n?t-n:t:0}function toLength(e){return e?baseClamp(toInteger(e),0,4294967295):0}function toNumber(e){if("number"==typeof e)return e;if(isSymbol(e))return NaN;if(isObject(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=baseTrim(e);var n=se.test(e);return n||ce.test(e)?qe(e.slice(2),n?2:8):ie.test(e)?NaN:+e}function toPlainObject(e){return copyObject(e,keysIn(e))}function toString(e){return null==e?"":baseToString(e)}var or=createAssigner((function(e,t){if(isPrototype(t)||isArrayLike(t))copyObject(t,keys(t),e);else for(var n in t)Ce.call(t,n)&&assignValue(e,n,t[n])})),ir=createAssigner((function(e,t){copyObject(t,keysIn(t),e)})),sr=createAssigner((function(e,t,n,r){copyObject(t,keysIn(t),e,r)})),ar=createAssigner((function(e,t,n,r){copyObject(t,keys(t),e,r)})),cr=flatRest(baseAt);var ur=baseRest((function(e,t){e=me(e);var n=-1,r=t.length,o=r>2?t[2]:void 0;for(o&&isIterateeCall(t[0],t[1],o)&&(r=1);++n<r;)for(var i=t[n],s=keysIn(i),a=-1,c=s.length;++a<c;){var u=s[a],l=e[u];(void 0===l||eq(l,Ie[u])&&!Ce.call(e,u))&&(e[u]=i[u])}return e})),lr=baseRest((function(e){return e.push(void 0,customDefaultsMerge),apply(mr,void 0,e)}));function get(e,t,n){var r=null==e?void 0:baseGet(e,t);return void 0===r?n:r}function hasIn(e,t){return null!=e&&hasPath(e,t,baseHasIn)}var dr=createInverter((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Oe.call(t)),e[t]=n}),constant(identity)),pr=createInverter((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Oe.call(t)),Ce.call(e,t)?e[t].push(n):e[t]=[n]}),getIteratee),hr=baseRest(baseInvoke);function keys(e){return isArrayLike(e)?arrayLikeKeys(e):baseKeys(e)}function keysIn(e){return isArrayLike(e)?arrayLikeKeys(e,!0):baseKeysIn(e)}var fr=createAssigner((function(e,t,n){baseMerge(e,t,n)})),mr=createAssigner((function(e,t,n,r){baseMerge(e,t,n,r)})),yr=flatRest((function(e,t){var n={};if(null==e)return n;var r=!1;t=arrayMap(t,(function(t){return t=castPath(t,e),r||(r=t.length>1),t})),copyObject(e,getAllKeysIn(e),n),r&&(n=baseClone(n,7,customOmitClone));for(var o=t.length;o--;)baseUnset(n,t[o]);return n}));var gr=flatRest((function(e,t){return null==e?{}:function basePick(e,t){return basePickBy(e,t,(function(t,n){return hasIn(e,n)}))}(e,t)}));function pickBy(e,t){if(null==e)return{};var n=arrayMap(getAllKeysIn(e),(function(e){return[e]}));return t=getIteratee(t),basePickBy(e,n,(function(e,n){return t(e,n[0])}))}var _r=createToPairs(keys),vr=createToPairs(keysIn);function values(e){return null==e?[]:baseValues(e,keys(e))}var Er=createCompounder((function(e,t,n){return t=t.toLowerCase(),e+(n?capitalize(t):t)}));function capitalize(e){return Or(toString(e).toLowerCase())}function deburr(e){return(e=toString(e))&&e.replace(le,at).replace(Me,"")}var Ir=createCompounder((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),br=createCompounder((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Sr=createCaseFirst("toLowerCase");var Cr=createCompounder((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var wr=createCompounder((function(e,t,n){return e+(n?" ":"")+Or(t)}));var Ar=createCompounder((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Or=createCaseFirst("toUpperCase");function words(e,t,n){return e=toString(e),void 0===(t=n?void 0:t)?function hasUnicodeWord(e){return Fe.test(e)}(e)?function unicodeWords(e){return e.match(je)||[]}(e):function asciiWords(e){return e.match(ee)||[]}(e):e.match(t)||[]}var Tr=baseRest((function(e,t){try{return apply(e,void 0,t)}catch(e){return isError(e)?e:new W(e)}})),Pr=flatRest((function(e,t){return arrayEach(t,(function(t){t=toKey(t),baseAssignValue(e,t,kn(e[t],e))})),e}));function constant(e){return function(){return e}}var Dr=createFlow(),xr=createFlow(!0);function identity(e){return e}function iteratee(e){return baseIteratee("function"==typeof e?e:baseClone(e,1))}var Rr=baseRest((function(e,t){return function(n){return baseInvoke(n,e,t)}})),Nr=baseRest((function(e,t){return function(n){return baseInvoke(e,n,t)}}));function mixin(e,t,n){var r=keys(t),o=baseFunctions(t,r);null!=n||isObject(t)&&(o.length||!r.length)||(n=t,t=e,e=this,o=baseFunctions(t,keys(t)));var i=!(isObject(n)&&"chain"in n&&!n.chain),s=isFunction(e);return arrayEach(o,(function(n){var r=t[n];e[n]=r,s&&(e.prototype[n]=function(){var t=this.__chain__;if(i||t){var n=e(this.__wrapped__),o=n.__actions__=copyArray(this.__actions__);return o.push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,arrayPush([this.value()],arguments))})})),e}function noop(){}var Mr=createOver(arrayMap),Lr=createOver(arrayEvery),jr=createOver(arraySome);function property(e){return isKey(e)?baseProperty(toKey(e)):function basePropertyDeep(e){return function(t){return baseGet(t,e)}}(e)}var kr=createRange(),Fr=createRange(!0);function stubArray(){return[]}function stubFalse(){return!1}var Ur=createMathOperation((function(e,t){return e+t}),0),Vr=createRound("ceil"),Br=createMathOperation((function(e,t){return e/t}),1),Jr=createRound("floor");var $r,Gr=createMathOperation((function(e,t){return e*t}),1),qr=createRound("round"),Hr=createMathOperation((function(e,t){return e-t}),0);return lodash.after=function after(e,t){if("function"!=typeof t)throw new _e(o);return e=toInteger(e),function(){if(--e<1)return t.apply(this,arguments)}},lodash.ary=ary,lodash.assign=or,lodash.assignIn=ir,lodash.assignInWith=sr,lodash.assignWith=ar,lodash.at=cr,lodash.before=before,lodash.bind=kn,lodash.bindAll=Pr,lodash.bindKey=Fn,lodash.castArray=function castArray(){if(!arguments.length)return[];var e=arguments[0];return Kn(e)?e:[e]},lodash.chain=chain,lodash.chunk=function chunk(e,t,r){t=(r?isIterateeCall(e,t,r):void 0===t)?1:It(toInteger(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var i=0,s=0,a=n(ft(o/t));i<o;)a[s++]=baseSlice(e,i,i+=t);return a},lodash.compact=function compact(e){for(var t=-1,n=null==e?0:e.length,r=0,o=[];++t<n;){var i=e[t];i&&(o[r++]=i)}return o},lodash.concat=function concat(){var e=arguments.length;if(!e)return[];for(var t=n(e-1),r=arguments[0],o=e;o--;)t[o-1]=arguments[o];return arrayPush(Kn(r)?copyArray(r):[r],baseFlatten(t,1))},lodash.cond=function cond(e){var t=null==e?0:e.length,n=getIteratee();return e=t?arrayMap(e,(function(e){if("function"!=typeof e[1])throw new _e(o);return[n(e[0]),e[1]]})):[],baseRest((function(n){for(var r=-1;++r<t;){var o=e[r];if(apply(o[0],this,n))return apply(o[1],this,n)}}))},lodash.conforms=function conforms(e){return function baseConforms(e){var t=keys(e);return function(n){return baseConformsTo(n,e,t)}}(baseClone(e,1))},lodash.constant=constant,lodash.countBy=Tn,lodash.create=function create(e,t){var n=$t(e);return null==t?n:baseAssign(n,t)},lodash.curry=function curry(e,t,n){var r=createWrap(e,8,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return r.placeholder=curry.placeholder,r},lodash.curryRight=function curryRight(e,t,n){var r=createWrap(e,16,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return r.placeholder=curryRight.placeholder,r},lodash.debounce=debounce,lodash.defaults=ur,lodash.defaultsDeep=lr,lodash.defer=Un,lodash.delay=Vn,lodash.difference=ln,lodash.differenceBy=dn,lodash.differenceWith=pn,lodash.drop=function drop(e,t,n){var r=null==e?0:e.length;return r?baseSlice(e,(t=n||void 0===t?1:toInteger(t))<0?0:t,r):[]},lodash.dropRight=function dropRight(e,t,n){var r=null==e?0:e.length;return r?baseSlice(e,0,(t=r-(t=n||void 0===t?1:toInteger(t)))<0?0:t):[]},lodash.dropRightWhile=function dropRightWhile(e,t){return e&&e.length?baseWhile(e,getIteratee(t,3),!0,!0):[]},lodash.dropWhile=function dropWhile(e,t){return e&&e.length?baseWhile(e,getIteratee(t,3),!0):[]},lodash.fill=function fill(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&isIterateeCall(e,t,n)&&(n=0,r=o),function baseFill(e,t,n,r){var o=e.length;for((n=toInteger(n))<0&&(n=-n>o?0:o+n),(r=void 0===r||r>o?o:toInteger(r))<0&&(r+=o),r=n>r?0:toLength(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},lodash.filter=function filter(e,t){return(Kn(e)?arrayFilter:baseFilter)(e,getIteratee(t,3))},lodash.flatMap=function flatMap(e,t){return baseFlatten(map(e,t),1)},lodash.flatMapDeep=function flatMapDeep(e,t){return baseFlatten(map(e,t),1/0)},lodash.flatMapDepth=function flatMapDepth(e,t,n){return n=void 0===n?1:toInteger(n),baseFlatten(map(e,t),n)},lodash.flatten=flatten,lodash.flattenDeep=function flattenDeep(e){return(null==e?0:e.length)?baseFlatten(e,1/0):[]},lodash.flattenDepth=function flattenDepth(e,t){return(null==e?0:e.length)?baseFlatten(e,t=void 0===t?1:toInteger(t)):[]},lodash.flip=function flip(e){return createWrap(e,512)},lodash.flow=Dr,lodash.flowRight=xr,lodash.fromPairs=function fromPairs(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var o=e[t];r[o[0]]=o[1]}return r},lodash.functions=function functions(e){return null==e?[]:baseFunctions(e,keys(e))},lodash.functionsIn=function functionsIn(e){return null==e?[]:baseFunctions(e,keysIn(e))},lodash.groupBy=xn,lodash.initial=function initial(e){return(null==e?0:e.length)?baseSlice(e,0,-1):[]},lodash.intersection=hn,lodash.intersectionBy=fn,lodash.intersectionWith=mn,lodash.invert=dr,lodash.invertBy=pr,lodash.invokeMap=Rn,lodash.iteratee=iteratee,lodash.keyBy=Nn,lodash.keys=keys,lodash.keysIn=keysIn,lodash.map=map,lodash.mapKeys=function mapKeys(e,t){var n={};return t=getIteratee(t,3),baseForOwn(e,(function(e,r,o){baseAssignValue(n,t(e,r,o),e)})),n},lodash.mapValues=function mapValues(e,t){var n={};return t=getIteratee(t,3),baseForOwn(e,(function(e,r,o){baseAssignValue(n,r,t(e,r,o))})),n},lodash.matches=function matches(e){return baseMatches(baseClone(e,1))},lodash.matchesProperty=function matchesProperty(e,t){return baseMatchesProperty(e,baseClone(t,1))},lodash.memoize=memoize,lodash.merge=fr,lodash.mergeWith=mr,lodash.method=Rr,lodash.methodOf=Nr,lodash.mixin=mixin,lodash.negate=negate,lodash.nthArg=function nthArg(e){return e=toInteger(e),baseRest((function(t){return baseNth(t,e)}))},lodash.omit=yr,lodash.omitBy=function omitBy(e,t){return pickBy(e,negate(getIteratee(t)))},lodash.once=function once(e){return before(2,e)},lodash.orderBy=function orderBy(e,t,n,r){return null==e?[]:(Kn(t)||(t=null==t?[]:[t]),Kn(n=r?void 0:n)||(n=null==n?[]:[n]),baseOrderBy(e,t,n))},lodash.over=Mr,lodash.overArgs=Bn,lodash.overEvery=Lr,lodash.overSome=jr,lodash.partial=Jn,lodash.partialRight=$n,lodash.partition=Mn,lodash.pick=gr,lodash.pickBy=pickBy,lodash.property=property,lodash.propertyOf=function propertyOf(e){return function(t){return null==e?void 0:baseGet(e,t)}},lodash.pull=yn,lodash.pullAll=pullAll,lodash.pullAllBy=function pullAllBy(e,t,n){return e&&e.length&&t&&t.length?basePullAll(e,t,getIteratee(n,2)):e},lodash.pullAllWith=function pullAllWith(e,t,n){return e&&e.length&&t&&t.length?basePullAll(e,t,void 0,n):e},lodash.pullAt=gn,lodash.range=kr,lodash.rangeRight=Fr,lodash.rearg=Gn,lodash.reject=function reject(e,t){return(Kn(e)?arrayFilter:baseFilter)(e,negate(getIteratee(t,3)))},lodash.remove=function remove(e,t){var n=[];if(!e||!e.length)return n;var r=-1,o=[],i=e.length;for(t=getIteratee(t,3);++r<i;){var s=e[r];t(s,r,e)&&(n.push(s),o.push(r))}return basePullAt(e,o),n},lodash.rest=function rest(e,t){if("function"!=typeof e)throw new _e(o);return baseRest(e,t=void 0===t?t:toInteger(t))},lodash.reverse=reverse,lodash.sampleSize=function sampleSize(e,t,n){return t=(n?isIterateeCall(e,t,n):void 0===t)?1:toInteger(t),(Kn(e)?arraySampleSize:baseSampleSize)(e,t)},lodash.set=function set(e,t,n){return null==e?e:baseSet(e,t,n)},lodash.setWith=function setWith(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:baseSet(e,t,n,r)},lodash.shuffle=function shuffle(e){return(Kn(e)?arrayShuffle:baseShuffle)(e)},lodash.slice=function slice(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&isIterateeCall(e,t,n)?(t=0,n=r):(t=null==t?0:toInteger(t),n=void 0===n?r:toInteger(n)),baseSlice(e,t,n)):[]},lodash.sortBy=Ln,lodash.sortedUniq=function sortedUniq(e){return e&&e.length?baseSortedUniq(e):[]},lodash.sortedUniqBy=function sortedUniqBy(e,t){return e&&e.length?baseSortedUniq(e,getIteratee(t,2)):[]},lodash.split=function split(e,t,n){return n&&"number"!=typeof n&&isIterateeCall(e,t,n)&&(t=n=void 0),(n=void 0===n?4294967295:n>>>0)?(e=toString(e))&&("string"==typeof t||null!=t&&!Zn(t))&&!(t=baseToString(t))&&hasUnicode(e)?castSlice(stringToArray(e),0,n):e.split(t,n):[]},lodash.spread=function spread(e,t){if("function"!=typeof e)throw new _e(o);return t=null==t?0:It(toInteger(t),0),baseRest((function(n){var r=n[t],o=castSlice(n,0,t);return r&&arrayPush(o,r),apply(e,this,o)}))},lodash.tail=function tail(e){var t=null==e?0:e.length;return t?baseSlice(e,1,t):[]},lodash.take=function take(e,t,n){return e&&e.length?baseSlice(e,0,(t=n||void 0===t?1:toInteger(t))<0?0:t):[]},lodash.takeRight=function takeRight(e,t,n){var r=null==e?0:e.length;return r?baseSlice(e,(t=r-(t=n||void 0===t?1:toInteger(t)))<0?0:t,r):[]},lodash.takeRightWhile=function takeRightWhile(e,t){return e&&e.length?baseWhile(e,getIteratee(t,3),!1,!0):[]},lodash.takeWhile=function takeWhile(e,t){return e&&e.length?baseWhile(e,getIteratee(t,3)):[]},lodash.tap=function tap(e,t){return t(e),e},lodash.throttle=function throttle(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new _e(o);return isObject(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),debounce(e,t,{leading:r,maxWait:t,trailing:i})},lodash.thru=thru,lodash.toArray=toArray,lodash.toPairs=_r,lodash.toPairsIn=vr,lodash.toPath=function toPath(e){return Kn(e)?arrayMap(e,toKey):isSymbol(e)?[e]:copyArray(un(toString(e)))},lodash.toPlainObject=toPlainObject,lodash.transform=function transform(e,t,n){var r=Kn(e),o=r||Wn(e)||tr(e);if(t=getIteratee(t,4),null==n){var i=e&&e.constructor;n=o?r?new i:[]:isObject(e)&&isFunction(i)?$t($e(e)):{}}return(o?arrayEach:baseForOwn)(e,(function(e,r,o){return t(n,e,r,o)})),n},lodash.unary=function unary(e){return ary(e,1)},lodash.union=_n,lodash.unionBy=vn,lodash.unionWith=En,lodash.uniq=function uniq(e){return e&&e.length?baseUniq(e):[]},lodash.uniqBy=function uniqBy(e,t){return e&&e.length?baseUniq(e,getIteratee(t,2)):[]},lodash.uniqWith=function uniqWith(e,t){return t="function"==typeof t?t:void 0,e&&e.length?baseUniq(e,void 0,t):[]},lodash.unset=function unset(e,t){return null==e||baseUnset(e,t)},lodash.unzip=unzip,lodash.unzipWith=unzipWith,lodash.update=function update(e,t,n){return null==e?e:baseUpdate(e,t,castFunction(n))},lodash.updateWith=function updateWith(e,t,n,r){return r="function"==typeof r?r:void 0,null==e?e:baseUpdate(e,t,castFunction(n),r)},lodash.values=values,lodash.valuesIn=function valuesIn(e){return null==e?[]:baseValues(e,keysIn(e))},lodash.without=In,lodash.words=words,lodash.wrap=function wrap(e,t){return Jn(castFunction(t),e)},lodash.xor=bn,lodash.xorBy=Sn,lodash.xorWith=Cn,lodash.zip=wn,lodash.zipObject=function zipObject(e,t){return baseZipObject(e||[],t||[],assignValue)},lodash.zipObjectDeep=function zipObjectDeep(e,t){return baseZipObject(e||[],t||[],baseSet)},lodash.zipWith=An,lodash.entries=_r,lodash.entriesIn=vr,lodash.extend=ir,lodash.extendWith=sr,mixin(lodash,lodash),lodash.add=Ur,lodash.attempt=Tr,lodash.camelCase=Er,lodash.capitalize=capitalize,lodash.ceil=Vr,lodash.clamp=function clamp(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=toNumber(n))==n?n:0),void 0!==t&&(t=(t=toNumber(t))==t?t:0),baseClamp(toNumber(e),t,n)},lodash.clone=function clone(e){return baseClone(e,4)},lodash.cloneDeep=function cloneDeep(e){return baseClone(e,5)},lodash.cloneDeepWith=function cloneDeepWith(e,t){return baseClone(e,5,t="function"==typeof t?t:void 0)},lodash.cloneWith=function cloneWith(e,t){return baseClone(e,4,t="function"==typeof t?t:void 0)},lodash.conformsTo=function conformsTo(e,t){return null==t||baseConformsTo(e,t,keys(t))},lodash.deburr=deburr,lodash.defaultTo=function defaultTo(e,t){return null==e||e!=e?t:e},lodash.divide=Br,lodash.endsWith=function endsWith(e,t,n){e=toString(e),t=baseToString(t);var r=e.length,o=n=void 0===n?r:baseClamp(toInteger(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},lodash.eq=eq,lodash.escape=function escape(e){return(e=toString(e))&&V.test(e)?e.replace(F,ct):e},lodash.escapeRegExp=function escapeRegExp(e){return(e=toString(e))&&K.test(e)?e.replace(Y,"\\$&"):e},lodash.every=function every(e,t,n){var r=Kn(e)?arrayEvery:baseEvery;return n&&isIterateeCall(e,t,n)&&(t=void 0),r(e,getIteratee(t,3))},lodash.find=Pn,lodash.findIndex=findIndex,lodash.findKey=function findKey(e,t){return baseFindKey(e,getIteratee(t,3),baseForOwn)},lodash.findLast=Dn,lodash.findLastIndex=findLastIndex,lodash.findLastKey=function findLastKey(e,t){return baseFindKey(e,getIteratee(t,3),baseForOwnRight)},lodash.floor=Jr,lodash.forEach=forEach,lodash.forEachRight=forEachRight,lodash.forIn=function forIn(e,t){return null==e?e:Ht(e,getIteratee(t,3),keysIn)},lodash.forInRight=function forInRight(e,t){return null==e?e:Yt(e,getIteratee(t,3),keysIn)},lodash.forOwn=function forOwn(e,t){return e&&baseForOwn(e,getIteratee(t,3))},lodash.forOwnRight=function forOwnRight(e,t){return e&&baseForOwnRight(e,getIteratee(t,3))},lodash.get=get,lodash.gt=qn,lodash.gte=Hn,lodash.has=function has(e,t){return null!=e&&hasPath(e,t,baseHas)},lodash.hasIn=hasIn,lodash.head=head,lodash.identity=identity,lodash.includes=function includes(e,t,n,r){e=isArrayLike(e)?e:values(e),n=n&&!r?toInteger(n):0;var o=e.length;return n<0&&(n=It(o+n,0)),isString(e)?n<=o&&e.indexOf(t,n)>-1:!!o&&baseIndexOf(e,t,n)>-1},lodash.indexOf=function indexOf(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=null==n?0:toInteger(n);return o<0&&(o=It(r+o,0)),baseIndexOf(e,t,o)},lodash.inRange=function inRange(e,t,n){return t=toFinite(t),void 0===n?(n=t,t=0):n=toFinite(n),function baseInRange(e,t,n){return e>=bt(t,n)&&e<It(t,n)}(e=toNumber(e),t,n)},lodash.invoke=hr,lodash.isArguments=Yn,lodash.isArray=Kn,lodash.isArrayBuffer=zn,lodash.isArrayLike=isArrayLike,lodash.isArrayLikeObject=isArrayLikeObject,lodash.isBoolean=function isBoolean(e){return!0===e||!1===e||isObjectLike(e)&&baseGetTag(e)==u},lodash.isBuffer=Wn,lodash.isDate=Qn,lodash.isElement=function isElement(e){return isObjectLike(e)&&1===e.nodeType&&!isPlainObject(e)},lodash.isEmpty=function isEmpty(e){if(null==e)return!0;if(isArrayLike(e)&&(Kn(e)||"string"==typeof e||"function"==typeof e.splice||Wn(e)||tr(e)||Yn(e)))return!e.length;var t=nn(e);if(t==m||t==v)return!e.size;if(isPrototype(e))return!baseKeys(e).length;for(var n in e)if(Ce.call(e,n))return!1;return!0},lodash.isEqual=function isEqual(e,t){return baseIsEqual(e,t)},lodash.isEqualWith=function isEqualWith(e,t,n){var r=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===r?baseIsEqual(e,t,void 0,n):!!r},lodash.isError=isError,lodash.isFinite=function isFinite(e){return"number"==typeof e&&_t(e)},lodash.isFunction=isFunction,lodash.isInteger=isInteger,lodash.isLength=isLength,lodash.isMap=Xn,lodash.isMatch=function isMatch(e,t){return e===t||baseIsMatch(e,t,getMatchData(t))},lodash.isMatchWith=function isMatchWith(e,t,n){return n="function"==typeof n?n:void 0,baseIsMatch(e,t,getMatchData(t),n)},lodash.isNaN=function isNaN(e){return isNumber(e)&&e!=+e},lodash.isNative=function isNative(e){if(rn(e))throw new W("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return baseIsNative(e)},lodash.isNil=function isNil(e){return null==e},lodash.isNull=function isNull(e){return null===e},lodash.isNumber=isNumber,lodash.isObject=isObject,lodash.isObjectLike=isObjectLike,lodash.isPlainObject=isPlainObject,lodash.isRegExp=Zn,lodash.isSafeInteger=function isSafeInteger(e){return isInteger(e)&&e>=-9007199254740991&&e<=9007199254740991},lodash.isSet=er,lodash.isString=isString,lodash.isSymbol=isSymbol,lodash.isTypedArray=tr,lodash.isUndefined=function isUndefined(e){return void 0===e},lodash.isWeakMap=function isWeakMap(e){return isObjectLike(e)&&nn(e)==b},lodash.isWeakSet=function isWeakSet(e){return isObjectLike(e)&&"[object WeakSet]"==baseGetTag(e)},lodash.join=function join(e,t){return null==e?"":vt.call(e,t)},lodash.kebabCase=Ir,lodash.last=last,lodash.lastIndexOf=function lastIndexOf(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r;return void 0!==n&&(o=(o=toInteger(n))<0?It(r+o,0):bt(o,r-1)),t==t?function strictLastIndexOf(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):baseFindIndex(e,baseIsNaN,o,!0)},lodash.lowerCase=br,lodash.lowerFirst=Sr,lodash.lt=nr,lodash.lte=rr,lodash.max=function max(e){return e&&e.length?baseExtremum(e,identity,baseGt):void 0},lodash.maxBy=function maxBy(e,t){return e&&e.length?baseExtremum(e,getIteratee(t,2),baseGt):void 0},lodash.mean=function mean(e){return baseMean(e,identity)},lodash.meanBy=function meanBy(e,t){return baseMean(e,getIteratee(t,2))},lodash.min=function min(e){return e&&e.length?baseExtremum(e,identity,baseLt):void 0},lodash.minBy=function minBy(e,t){return e&&e.length?baseExtremum(e,getIteratee(t,2),baseLt):void 0},lodash.stubArray=stubArray,lodash.stubFalse=stubFalse,lodash.stubObject=function stubObject(){return{}},lodash.stubString=function stubString(){return""},lodash.stubTrue=function stubTrue(){return!0},lodash.multiply=Gr,lodash.nth=function nth(e,t){return e&&e.length?baseNth(e,toInteger(t)):void 0},lodash.noConflict=function noConflict(){return Ke._===this&&(Ke._=Pe),this},lodash.noop=noop,lodash.now=jn,lodash.pad=function pad(e,t,n){e=toString(e);var r=(t=toInteger(t))?stringSize(e):0;if(!t||r>=t)return e;var o=(t-r)/2;return createPadding(mt(o),n)+e+createPadding(ft(o),n)},lodash.padEnd=function padEnd(e,t,n){e=toString(e);var r=(t=toInteger(t))?stringSize(e):0;return t&&r<t?e+createPadding(t-r,n):e},lodash.padStart=function padStart(e,t,n){e=toString(e);var r=(t=toInteger(t))?stringSize(e):0;return t&&r<t?createPadding(t-r,n)+e:e},lodash.parseInt=function parseInt(e,t,n){return n||null==t?t=0:t&&(t=+t),Ct(toString(e).replace(z,""),t||0)},lodash.random=function random(e,t,n){if(n&&"boolean"!=typeof n&&isIterateeCall(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=toFinite(e),void 0===t?(t=e,e=0):t=toFinite(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=wt();return bt(e+o*(t-e+Ge("1e-"+((o+"").length-1))),t)}return baseRandom(e,t)},lodash.reduce=function reduce(e,t,n){var r=Kn(e)?arrayReduce:baseReduce,o=arguments.length<3;return r(e,getIteratee(t,4),n,o,Gt)},lodash.reduceRight=function reduceRight(e,t,n){var r=Kn(e)?arrayReduceRight:baseReduce,o=arguments.length<3;return r(e,getIteratee(t,4),n,o,qt)},lodash.repeat=function repeat(e,t,n){return t=(n?isIterateeCall(e,t,n):void 0===t)?1:toInteger(t),baseRepeat(toString(e),t)},lodash.replace=function replace(){var e=arguments,t=toString(e[0]);return e.length<3?t:t.replace(e[1],e[2])},lodash.result=function result(e,t,n){var r=-1,o=(t=castPath(t,e)).length;for(o||(o=1,e=void 0);++r<o;){var i=null==e?void 0:e[toKey(t[r])];void 0===i&&(r=o,i=n),e=isFunction(i)?i.call(e):i}return e},lodash.round=qr,lodash.runInContext=runInContext,lodash.sample=function sample(e){return(Kn(e)?arraySample:baseSample)(e)},lodash.size=function size(e){if(null==e)return 0;if(isArrayLike(e))return isString(e)?stringSize(e):e.length;var t=nn(e);return t==m||t==v?e.size:baseKeys(e).length},lodash.snakeCase=Cr,lodash.some=function some(e,t,n){var r=Kn(e)?arraySome:baseSome;return n&&isIterateeCall(e,t,n)&&(t=void 0),r(e,getIteratee(t,3))},lodash.sortedIndex=function sortedIndex(e,t){return baseSortedIndex(e,t)},lodash.sortedIndexBy=function sortedIndexBy(e,t,n){return baseSortedIndexBy(e,t,getIteratee(n,2))},lodash.sortedIndexOf=function sortedIndexOf(e,t){var n=null==e?0:e.length;if(n){var r=baseSortedIndex(e,t);if(r<n&&eq(e[r],t))return r}return-1},lodash.sortedLastIndex=function sortedLastIndex(e,t){return baseSortedIndex(e,t,!0)},lodash.sortedLastIndexBy=function sortedLastIndexBy(e,t,n){return baseSortedIndexBy(e,t,getIteratee(n,2),!0)},lodash.sortedLastIndexOf=function sortedLastIndexOf(e,t){if(null==e?0:e.length){var n=baseSortedIndex(e,t,!0)-1;if(eq(e[n],t))return n}return-1},lodash.startCase=wr,lodash.startsWith=function startsWith(e,t,n){return e=toString(e),n=null==n?0:baseClamp(toInteger(n),0,e.length),t=baseToString(t),e.slice(n,n+t.length)==t},lodash.subtract=Hr,lodash.sum=function sum(e){return e&&e.length?baseSum(e,identity):0},lodash.sumBy=function sumBy(e,t){return e&&e.length?baseSum(e,getIteratee(t,2)):0},lodash.template=function template(e,t,n){var r=lodash.templateSettings;n&&isIterateeCall(e,t,n)&&(t=void 0),e=toString(e),t=sr({},t,r,customDefaultsAssignIn);var o,i,s=sr({},t.imports,r.imports,customDefaultsAssignIn),a=keys(s),c=baseValues(s,a),u=0,l=t.interpolate||de,d="__p += '",p=ye((t.escape||de).source+"|"+l.source+"|"+(l===$?re:de).source+"|"+(t.evaluate||de).source+"|$","g"),h="//# sourceURL="+(Ce.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ve+"]")+"\n";e.replace(p,(function(t,n,r,s,a,c){return r||(r=s),d+=e.slice(u,c).replace(pe,escapeStringChar),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),a&&(i=!0,d+="';\n"+a+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=c+t.length,t})),d+="';\n";var m=Ce.call(t,"variable")&&t.variable;if(m){if(te.test(m))throw new W("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(i?d.replace(M,""):d).replace(L,"$1").replace(j,"$1;"),d="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var y=Tr((function(){return he(a,h+"return "+d).apply(void 0,c)}));if(y.source=d,isError(y))throw y;return y},lodash.times=function times(e,t){if((e=toInteger(e))<1||e>9007199254740991)return[];var n=4294967295,r=bt(e,4294967295);e-=4294967295;for(var o=baseTimes(r,t=getIteratee(t));++n<e;)t(n);return o},lodash.toFinite=toFinite,lodash.toInteger=toInteger,lodash.toLength=toLength,lodash.toLower=function toLower(e){return toString(e).toLowerCase()},lodash.toNumber=toNumber,lodash.toSafeInteger=function toSafeInteger(e){return e?baseClamp(toInteger(e),-9007199254740991,9007199254740991):0===e?e:0},lodash.toString=toString,lodash.toUpper=function toUpper(e){return toString(e).toUpperCase()},lodash.trim=function trim(e,t,n){if((e=toString(e))&&(n||void 0===t))return baseTrim(e);if(!e||!(t=baseToString(t)))return e;var r=stringToArray(e),o=stringToArray(t);return castSlice(r,charsStartIndex(r,o),charsEndIndex(r,o)+1).join("")},lodash.trimEnd=function trimEnd(e,t,n){if((e=toString(e))&&(n||void 0===t))return e.slice(0,trimmedEndIndex(e)+1);if(!e||!(t=baseToString(t)))return e;var r=stringToArray(e);return castSlice(r,0,charsEndIndex(r,stringToArray(t))+1).join("")},lodash.trimStart=function trimStart(e,t,n){if((e=toString(e))&&(n||void 0===t))return e.replace(z,"");if(!e||!(t=baseToString(t)))return e;var r=stringToArray(e);return castSlice(r,charsStartIndex(r,stringToArray(t))).join("")},lodash.truncate=function truncate(e,t){var n=30,r="...";if(isObject(t)){var o="separator"in t?t.separator:o;n="length"in t?toInteger(t.length):n,r="omission"in t?baseToString(t.omission):r}var i=(e=toString(e)).length;if(hasUnicode(e)){var s=stringToArray(e);i=s.length}if(n>=i)return e;var a=n-stringSize(r);if(a<1)return r;var c=s?castSlice(s,0,a).join(""):e.slice(0,a);if(void 0===o)return c+r;if(s&&(a+=c.length-a),Zn(o)){if(e.slice(a).search(o)){var u,l=c;for(o.global||(o=ye(o.source,toString(oe.exec(o))+"g")),o.lastIndex=0;u=o.exec(l);)var d=u.index;c=c.slice(0,void 0===d?a:d)}}else if(e.indexOf(baseToString(o),a)!=a){var p=c.lastIndexOf(o);p>-1&&(c=c.slice(0,p))}return c+r},lodash.unescape=function unescape(e){return(e=toString(e))&&U.test(e)?e.replace(k,ut):e},lodash.uniqueId=function uniqueId(e){var t=++we;return toString(e)+t},lodash.upperCase=Ar,lodash.upperFirst=Or,lodash.each=forEach,lodash.eachRight=forEachRight,lodash.first=head,mixin(lodash,($r={},baseForOwn(lodash,(function(e,t){Ce.call(lodash.prototype,t)||($r[t]=e)})),$r),{chain:!1}),lodash.VERSION="4.17.21",arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){lodash[e].placeholder=lodash})),arrayEach(["drop","take"],(function(e,t){LazyWrapper.prototype[e]=function(n){n=void 0===n?1:It(toInteger(n),0);var r=this.__filtered__&&!t?new LazyWrapper(this):this.clone();return r.__filtered__?r.__takeCount__=bt(n,r.__takeCount__):r.__views__.push({size:bt(n,4294967295),type:e+(r.__dir__<0?"Right":"")}),r},LazyWrapper.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),arrayEach(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;LazyWrapper.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:getIteratee(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),arrayEach(["head","last"],(function(e,t){var n="take"+(t?"Right":"");LazyWrapper.prototype[e]=function(){return this[n](1).value()[0]}})),arrayEach(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");LazyWrapper.prototype[e]=function(){return this.__filtered__?new LazyWrapper(this):this[n](1)}})),LazyWrapper.prototype.compact=function(){return this.filter(identity)},LazyWrapper.prototype.find=function(e){return this.filter(e).head()},LazyWrapper.prototype.findLast=function(e){return this.reverse().find(e)},LazyWrapper.prototype.invokeMap=baseRest((function(e,t){return"function"==typeof e?new LazyWrapper(this):this.map((function(n){return baseInvoke(n,e,t)}))})),LazyWrapper.prototype.reject=function(e){return this.filter(negate(getIteratee(e)))},LazyWrapper.prototype.slice=function(e,t){e=toInteger(e);var n=this;return n.__filtered__&&(e>0||t<0)?new LazyWrapper(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=toInteger(t))<0?n.dropRight(-t):n.take(t-e)),n)},LazyWrapper.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},LazyWrapper.prototype.toArray=function(){return this.take(4294967295)},baseForOwn(LazyWrapper.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=lodash[r?"take"+("last"==t?"Right":""):t],i=r||/^find/.test(t);o&&(lodash.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,a=t instanceof LazyWrapper,c=s[0],u=a||Kn(t),interceptor=function(e){var t=o.apply(lodash,arrayPush([e],s));return r&&l?t[0]:t};u&&n&&"function"==typeof c&&1!=c.length&&(a=u=!1);var l=this.__chain__,d=!!this.__actions__.length,p=i&&!l,h=a&&!d;if(!i&&u){t=h?t:new LazyWrapper(this);var m=e.apply(t,s);return m.__actions__.push({func:thru,args:[interceptor],thisArg:void 0}),new LodashWrapper(m,l)}return p&&h?e.apply(this,s):(m=this.thru(interceptor),p?r?m.value()[0]:m.value():m)})})),arrayEach(["pop","push","shift","sort","splice","unshift"],(function(e){var t=ve[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);lodash.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var o=this.value();return t.apply(Kn(o)?o:[],e)}return this[n]((function(n){return t.apply(Kn(n)?n:[],e)}))}})),baseForOwn(LazyWrapper.prototype,(function(e,t){var n=lodash[t];if(n){var r=n.name+"";Ce.call(Mt,r)||(Mt[r]=[]),Mt[r].push({name:t,func:n})}})),Mt[createHybrid(void 0,2).name]=[{name:"wrapper",func:void 0}],LazyWrapper.prototype.clone=function lazyClone(){var e=new LazyWrapper(this.__wrapped__);return e.__actions__=copyArray(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=copyArray(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=copyArray(this.__views__),e},LazyWrapper.prototype.reverse=function lazyReverse(){if(this.__filtered__){var e=new LazyWrapper(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},LazyWrapper.prototype.value=function lazyValue(){var e=this.__wrapped__.value(),t=this.__dir__,n=Kn(e),r=t<0,o=n?e.length:0,i=function getView(e,t,n){var r=-1,o=n.length;for(;++r<o;){var i=n[r],s=i.size;switch(i.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=bt(t,e+s);break;case"takeRight":e=It(e,t-s)}}return{start:e,end:t}}(0,o,this.__views__),s=i.start,a=i.end,c=a-s,u=r?a:s-1,l=this.__iteratees__,d=l.length,p=0,h=bt(c,this.__takeCount__);if(!n||!r&&o==c&&h==c)return baseWrapperValue(e,this.__actions__);var m=[];e:for(;c--&&p<h;){for(var y=-1,g=e[u+=t];++y<d;){var _=l[y],v=_.iteratee,E=_.type,I=v(g);if(2==E)g=I;else if(!I){if(1==E)continue e;break e}}m[p++]=g}return m},lodash.prototype.at=On,lodash.prototype.chain=function wrapperChain(){return chain(this)},lodash.prototype.commit=function wrapperCommit(){return new LodashWrapper(this.value(),this.__chain__)},lodash.prototype.next=function wrapperNext(){void 0===this.__values__&&(this.__values__=toArray(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},lodash.prototype.plant=function wrapperPlant(e){for(var t,n=this;n instanceof baseLodash;){var r=wrapperClone(n);r.__index__=0,r.__values__=void 0,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},lodash.prototype.reverse=function wrapperReverse(){var e=this.__wrapped__;if(e instanceof LazyWrapper){var t=e;return this.__actions__.length&&(t=new LazyWrapper(this)),(t=t.reverse()).__actions__.push({func:thru,args:[reverse],thisArg:void 0}),new LodashWrapper(t,this.__chain__)}return this.thru(reverse)},lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=function wrapperValue(){return baseWrapperValue(this.__wrapped__,this.__actions__)},lodash.prototype.first=lodash.prototype.head,Xe&&(lodash.prototype[Xe]=function wrapperToIterator(){return this}),lodash}();Ke._=lt,void 0===(r=function(){return lt}.call(t,n,t,e))||(e.exports=r)}).call(this)}).call(this,n(34)(e))},function(e,t,n){var r=n(868),o=n(869),i=n(870),s=n(871),a=n(872);function ListCache(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ListCache.prototype.clear=r,ListCache.prototype.delete=o,ListCache.prototype.get=i,ListCache.prototype.has=s,ListCache.prototype.set=a,e.exports=ListCache},function(e,t,n){var r=n(205);e.exports=function assocIndexOf(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(63)(Object,"create");e.exports=r},function(e,t,n){var r=n(892);e.exports=function getMapData(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},function(e,t,n){var r=n(347),o=n(348);e.exports=function copyObject(e,t,n,i){var s=!n;n||(n={});for(var a=-1,c=t.length;++a<c;){var u=t[a],l=i?i(n[u],e[u],u,n,e):void 0;void 0===l&&(l=e[u]),s?o(n,u,l):r(n,u,l)}return n}},function(e,t){e.exports=function baseUnary(e){return function(t){return e(t)}}},function(e,t,n){var r=n(914),o=n(206),i=n(915),s=n(916),a=n(917),c=n(104),u=n(346),l=u(r),d=u(o),p=u(i),h=u(s),m=u(a),y=c;(r&&"[object DataView]"!=y(new r(new ArrayBuffer(1)))||o&&"[object Map]"!=y(new o)||i&&"[object Promise]"!=y(i.resolve())||s&&"[object Set]"!=y(new s)||a&&"[object WeakMap]"!=y(new a))&&(y=function(e){var t=c(e),n="[object Object]"==t?e.constructor:void 0,r=n?u(n):"";if(r)switch(r){case l:return"[object DataView]";case d:return"[object Map]";case p:return"[object Promise]";case h:return"[object Set]";case m:return"[object WeakMap]"}return t}),e.exports=y},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.paginationHelper=t.sortHelper=t.filterHelper=void 0;const o=r(n(930)),i=r(n(367)),s=n(47),a=n(107),c=n(103),u=["$or","$and"],resolveBooleanOperation=(e,t)=>{if(u.includes(t.name)){const{nestedFilters:n,booleanOperation:r}=t;return r(e,n)}const{fn:n}=t;return n(e)},l={$eq:(e,t,n)=>i.default(e,t)===n,$gt:(e,t,n)=>i.default(e,t)>n,$gte:(e,t,n)=>i.default(e,t)>=n,$lt:(e,t,n)=>i.default(e,t)<n,$lte:(e,t,n)=>i.default(e,t)<=n,$ne:(e,t,n)=>i.default(e,t)!==n,$in:(e,t,n)=>n.includes(i.default(e,t)),$nin:(e,t,n)=>!n.includes(i.default(e,t)),$or:(e,t)=>t.map(t=>resolveBooleanOperation(e,t)).some(e=>e),$and:(e,t)=>!t.map(t=>resolveBooleanOperation(e,t)).some(e=>!e)},flat=e=>e.reduce((e,t)=>e.concat(t),[]),getFiltersFields=(e,t,n)=>e?flat(Object.entries(e).map(([e,r])=>{if(u.includes(e))return flat([{name:e||"$and",booleanOperation:l[e],nestedFilters:flat(r.map(t=>flat(getFiltersFields(t,e,"$or"===e))))}]);{"object"!=typeof r&&(r={$eq:r});const o=Object.entries(r);if(o.length>0){const r=[];return o.forEach(t=>{if(!Object.prototype.hasOwnProperty.call(l,t[0]))throw new a.StoreError(c.ErrorCode.L5_QUERY_OPERATOR_NOT_SUPPORTED,`The operator ${t[0]} is not supported.`);r.push({name:t[0],fn:n=>l[t[0]](n,e,t[1])})}),n?r:{name:t||"$and",booleanOperation:l.$and,nestedFilters:r}}}return[]})):[];t.filterHelper=(e,t)=>{const n=getFiltersFields(t);return e.filter(e=>{return t=e,!n.map(e=>{const{booleanOperation:n,nestedFilters:r}=e;return n(t,r)}).some(e=>!e);var t})},t.sortHelper=(e,t)=>{let n;if(Array.isArray(t)){const r=[];t.forEach(e=>{r.push({property:e.substring(1,e.length),order:"+"===e.substring(0,1)?"asc":"desc"})}),n=o.default(e,r.map(e=>e.property),r.map(e=>e.order))}else{const r=[],i=[];Object.entries(t).forEach(([e,t])=>{r.push(e),i.push(t)}),n=o.default(e,r,i)}return n},t.paginationHelper=(e,t,n)=>{let r=e;const o=null!=t?t:s.PaginationConstants.OFFSET,i=null!=n?n:s.PaginationConstants.LIMIT;return i>0&&(r=r.slice(t,i+o)),{items:r,offset:o,limit:i}}},function(e,t,n){var r=n(108);e.exports=function toKey(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);t.validateNotProcessedResponse=function validateNotProcessedResponse(e){if("NOT_PROCESSED"===e.status)return new r.CommandError("Command not processed after configured number of retries. commandId="+e.commandId,e.trackingId||"")}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(13)),i=n(102),s=n(374),a=n(221),c=n(992),u=n(2);t.applyFilter=function applyFilter(e,t,n=a.getKeyMapper,r){let l=e;if(!o.default(t)){const o="string"==typeof t?i.FiltersBuilder.parseToObject(t):t;if(o.invalid)throw new u.SDKError(`Invalid filter ${t}. This is a local mode error. Equivalent server error is: With status: 400.`);l=s.filterHelper(e,o,n,c.getValueResolver,r)}return l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommandQueryRegistry=t.COMMAND_REMOTE_SYNC=t.COMMAND_EXECUTION_NOOP=t.COMMAND_NOOP=void 0;const r=n(19);t.COMMAND_NOOP="__noop__",t.COMMAND_EXECUTION_NOOP="__execution_noop__",t.COMMAND_REMOTE_SYNC="__remote_sync_command__";const o=[t.COMMAND_NOOP,t.COMMAND_REMOTE_SYNC,t.COMMAND_EXECUTION_NOOP];t.CommandQueryRegistry=class CommandQueryRegistry{constructor(){this.commandRegistry=new Map,this.queryRegistry=new Map}funcAreEquals(e,t){return!e&&!t||e&&t&&e.toString()===t.toString()}commandsAreEqual(e,t){return e.serverCommandName===t.serverCommandName&&this.funcAreEquals(e.createPayload,t.createPayload)&&this.funcAreEquals(e.processResults,t.processResults)&&this.funcAreEquals(e.executeLocally,t.executeLocally)&&this.funcAreEquals(e.rewriteIds,t.rewriteIds)}queriesAreEqual(e,t){return e.serverQueryEndpoint===t.serverQueryEndpoint&&this.funcAreEquals(e.createPayload,t.createPayload)&&this.funcAreEquals(e.processResults,t.processResults)&&this.funcAreEquals(e.executeLocally,t.executeLocally)&&this.funcAreEquals(e.rewriteIds,e.rewriteIds)}registerCommandsAndQueries(e){if(!e)throw new r.JournalError(r.JournalErrorCode.L7_GEN_NULL_VALUE,"CommandQueryDefinitions");const t=e.commands||{};Object.keys(t).forEach(e=>{this.registerCommand(e,t[e])});const n=e.queries||{};Object.keys(n).forEach(e=>{this.registerQuery(e,n[e])})}getRegisteredCommand(e){if(!e)throw new r.JournalError(r.JournalErrorCode.L7_GEN_NULL_VALUE,"commandName");return this.commandRegistry.get(e)}registerCommand(e,t){if(!e)throw new r.JournalError(r.JournalErrorCode.L7_GEN_NULL_VALUE,"commandName");if(!t)throw new r.JournalError(r.JournalErrorCode.L7_GEN_NULL_VALUE,"commandDef");if(!t.createPayload||!t.processResults||!t.serverCommandName)throw new r.JournalError(r.JournalErrorCode.L7_COMMAND_NOT_REGISTERED,`Command '${e}' has missing fields that are required.`);if(o.includes(e))throw new r.JournalError(r.JournalErrorCode.L7_COMMAND_NAME_NOT_ALLOWED,`Command with name '${e}' is not allowed.`);if(this.commandRegistry.has(e)){const n=this.commandRegistry.get(e);if(n&&!this.commandsAreEqual(n,t))throw new r.JournalError(r.JournalErrorCode.L7_COMMAND_ALREADY_REGISTERED,`Command with name '${e}' is already registered.`)}this.commandRegistry.set(e,t)}getRegisteredCommands(){return this.commandRegistry}registerQuery(e,t){if(!e)throw new r.JournalError(r.JournalErrorCode.L7_GEN_NULL_VALUE,"queryName");if(this.queryRegistry.has(e)){const n=this.queryRegistry.get(e);if(n&&!this.queriesAreEqual(n,t))throw new r.JournalError(r.JournalErrorCode.L7_QUERY_ALREADY_REGISTERED,e+" is already registered.")}if(!t)throw new r.JournalError(r.JournalErrorCode.L7_GEN_NULL_VALUE,"queryDef");if(!t.createPayload||!t.processResults||!t.serverQueryEndpoint)throw new r.JournalError(r.JournalErrorCode.L7_QUERY_NOT_REGISTERED,t+" has missing fields that are required.");this.queryRegistry.set(e,t)}getRegisteredQuery(e){if(!e)throw new r.JournalError(r.JournalErrorCode.L7_GEN_NULL_VALUE,"queryName");return this.queryRegistry.get(e)}getRegisteredQueries(){return this.queryRegistry}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(67),o=n(389),i=n(14),s=n(6);class RevisionsQueryResult extends r.QueryResult{createPage(e){const t=[],{results:n}=e;for(const e of n){const n=[];if(e.snapshotted)for(const t of e.snapshots){const e=s.extractCollectionIdFromUrl(t.url),r=this.sdkCore.buildModel(i.snapshotTypeId,t.type||i.snapshotTypeId,t.id,e);n.push(r)}const r=new i.Revision(e,n);t.push(r)}return new o.RevisionsQueryPage(e,t)}}t.RevisionsQueryResult=RevisionsQueryResult},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.INTERNAL="Internal",e.EXTERNAL="External"}(t.ComponentInstanceType||(t.ComponentInstanceType={})),function(e){e.UNDER_CONSTRUCTION="underConstruction"}(t.F3DComponentCreateStatus||(t.F3DComponentCreateStatus={})),function(e){e.PartName="Part Name",e.PartNumber="Part Number",e.Description="Description"}(t.Properties||(t.Properties={})),function(e){e.Material="material"}(t.MassProperties||(t.MassProperties={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1072);t.schemas=r.schemas;const o=n(1112),i=n(404);t.SchemaTypeBase=i.SchemaTypeBase;const s=n(169);t.TYPEID_REGEX=/^((?<provider>[a-zA-Z]+)(\.(?<pimType>\S+))?:)?((?<prefixFamily>\S+)\.)?(?<family>\S+)-(?<majorVersion>\d+)\.(?<minorVersion>\d+)\.(?<patchVersion>\d+)$/;const a={};Object.values(r.schemas).map(e=>a[e.typeid]=e),t.getSchemaByTypeId=e=>a[e],t.getSchemaTemplates=()=>Object.values(r.schemas),t.getSchemaTypeIds=()=>Object.keys(a);const c=[r.schemas.Product_AssetsLifecycle_V0_0_2,r.schemas.Product_AssetsLifecycle_V1_0_0].reduce((e,t)=>(e[t.typeid]=t,e),{});t.isDiscontinued=e=>void 0!==c[s.asTypeid(e)],t.SCHEMA_REVISION=o.majorVersionSum},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asTypeid=function asTypeid(e){return"string"==typeof e?e:e.typeid}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAssetAndRevisionIds=function getAssetAndRevisionIds(e){const t=[];for(const n of Object.values(e))t.push({id:n.product.getId(),revisionId:n.product.getRevisionId()},{id:n.design.getId(),revisionId:n.design.getRevisionId()},{id:n.model.getId(),revisionId:n.model.getRevisionId()});return t},t.getDocumentAssetsAndRevisionIds=function getDocumentAssetsAndRevisionIds(e,t){e.push({id:t.documentation.getId(),revisionId:t.documentation.getRevisionId()},{id:t.drawing.getId(),revisionId:t.drawing.getRevisionId()},{id:t.sheets.getId(),revisionId:t.sheets.getRevisionId()})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1),o=n(4),i=n(239),s=n(10),a=n(509);async function getF3dVersionPIMDataFromSnapshot(e,t,n){const r=await e.pimGetRootProductFromSnapshot(t,n);if(!r)throw new Error("Fail to find root product from snapshot: "+n.getId());const o=await a.getPimDataFromRootProduct(e,r,n);if(!o)throw new Error("Fail to find root lineagePIMData from product: "+r.getId());const i=await e.pimGetAssemblyRefFromProduct(t,r,n);return{compAndProducts:o.compAndProducts,rootProductStructure:o.rootProductStructure,versionSnapshot:n,assemblyRefs:i}}async function getF2dPIMDataFromLineage(e,t,n){const r=await e.pimFindRootItem(t,n);if(!r)throw new Error("Fail to find documentation from lineage: "+n);const o=await e.pimGetDrawingFromDocumentation(t,r);if(!o)throw new Error("Fail to find drawing from documentation: "+r.getId());const i=await e.pimGetSheetsFromDocumentation(t,r);if(!i)throw new Error("Fail to find sheets from documentation: "+r.getId());return{documentationSpace:await r.getSpace(),documentation:r,drawing:o,sheets:i[0]}}t.getF3dVersionPIMDataFromSnapshot=getF3dVersionPIMDataFromSnapshot,t.getF2dPIMDataFromLineage=getF2dPIMDataFromLineage,t.getOrPurgeHalfWayCreatedPIMVersionData=async function getOrPurgeHalfWayCreatedPIMVersionData(e,t,n,a,c,u){const l=await i.getVersionSnapshot(e,t,a,!0);if(l){const n=l.getAttribute(s.AttributeKeys.INCOMPLETE);if(n===s.IncompleteState.COMPLETE||n===s.IncompleteState.CONTENT_READY){const n=await getF3dVersionPIMDataFromSnapshot(e,t,l);return{compAndProducts:n.compAndProducts,rootProductStructure:n.rootProductStructure,versionSnapshot:l,assemblyRefs:n.assemblyRefs,isNewlyCreated:!1}}await o.purgeEntitiesOfF3DComponents(e,t,c),await o.purgeEntities([l],u)}else{const i=await e.pimFindRootItem(t,n);if(!i)return;i.isFetched()||await i.fetch();const a=i.getAttribute(s.AttributeKeys.CREATE_STATUS);r.F3DComponentCreateStatus.UNDER_CONSTRUCTION===a&&await o.purgeEntitiesOfF3DComponents(e,t,c)}},t.getOrPurgeF2dVersionSnapshotData=async function getOrPurgeF2dVersionSnapshotData(e,t,n,r,a,c){const u=await i.getVersionSnapshot(e,t,n,!0);if(!u)return;const l=u.getAttribute(s.AttributeKeys.INCOMPLETE);if(l!==s.IncompleteState.COMPLETE&&l!==s.IncompleteState.CONTENT_READY)a||await o.purgeEntitiesOfF2DComponents(e,t,r),await o.purgeEntities([u],c);else{if(!a)try{a=await getF2dPIMDataFromLineage(e,t,r)}catch(n){await o.purgeEntitiesOfF2DComponents(e,t,r),await o.purgeEntities([u],c)}if(a)return{documentationStructure:a,versionSnapshot:u}}}},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(241)),__export(n(510)),__export(n(1186)),__export(n(511)),__export(n(512)),__export(n(513))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JournalTagNames={IN_USE_UPLOAD:"inUse-upload",LINEAGE_URN:"lineageURN",INVARIANT_ID:"invariantId",LOCAL_FILE_VERSION:"localFileVersion",LAYOUT:"layout"},function(e){e.TREE="fremontjs:tree",e.CHAIN="fremontjs:chain"}(t.JOURNAL_TAG_LAYOUT||(t.JOURNAL_TAG_LAYOUT={})),function(e){e.ROOT_ITEM_ID="rootItemId",e.SNAPSHOT_ID="localSnapshot",e.NEW_SPACES="newSpaces"}(t.JOURNAL_PIM_PROPERTIES||(t.JOURNAL_PIM_PROPERTIES={}))},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(72)),__export(n(536)),__export(n(1262))},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(1268)),__export(n(1273))},function(e,t){e.exports=require("querystring")},function(e,t,n){var r=n(29).EventEmitter,o=n(122),i=n(12),s=n(93)("engine:transport");function noop(){}function Transport(e){this.readyState="open",this.discarded=!1}e.exports=Transport,i.inherits(Transport,r),Transport.prototype.discard=function(){this.discarded=!0},Transport.prototype.onRequest=function(e){s("setting request"),this.req=e},Transport.prototype.close=function(e){"closed"!==this.readyState&&"closing"!==this.readyState&&(this.readyState="closing",this.doClose(e||noop))},Transport.prototype.onError=function(e,t){if(this.listeners("error").length){var n=new Error(e);n.type="TransportError",n.description=t,this.emit("error",n)}else s("ignored transport error %s (%s)",e,t)},Transport.prototype.onPacket=function(e){this.emit("packet",e)},Transport.prototype.onData=function(e){this.onPacket(o.decodePacket(e))},Transport.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){var r=n(560),o=Object.prototype.toString,i="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);e.exports=function hasBinary(e){if(!e||"object"!=typeof e)return!1;if(r(e)){for(var t=0,n=e.length;t<n;t++)if(hasBinary(e[t]))return!0;return!1}if("function"==typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(e)||"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||i&&e instanceof Blob||s&&e instanceof File)return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return hasBinary(e.toJSON(),!0);for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&hasBinary(e[o]))return!0;return!1}},function(e,t,n){"use strict";const r=n(73).Buffer,concat=(e,t)=>{const n=r.allocUnsafe(t);for(var o=0,i=0;i<e.length;i++){const t=e[i];t.copy(n,o),o+=t.length}return n};try{const t=n(!function webpackMissingModule(){var e=new Error("Cannot find module 'bufferutil'");throw e.code="MODULE_NOT_FOUND",e}());e.exports=Object.assign({concat:concat},t.BufferUtil||t)}catch(t){const mask=(e,t,n,r,o)=>{for(var i=0;i<o;i++)n[r+i]=e[i]^t[3&i]},unmask=(e,t)=>{const n=e.length;for(var r=0;r<n;r++)e[r]^=t[3&r]};e.exports={concat:concat,mask:mask,unmask:unmask}}},function(e,t){e.exports=require("stream")},function(e,t,n){"use strict";e.exports=function argsert(e,t,n){try{let i=0,s={demanded:[],optional:[]};"object"==typeof e?(n=t,t=e):s=r.parseCommand("cmd "+e);const a=[].slice.call(t);for(;a.length&&void 0===a[a.length-1];)a.pop();if((n=n||a.length)<s.demanded.length)throw new o(`Not enough arguments provided. Expected ${s.demanded.length} but received ${a.length}.`);const c=s.demanded.length+s.optional.length;if(n>c)throw new o(`Too many arguments provided. Expected max ${c} but received ${n}.`);s.demanded.forEach(e=>{const t=guessType(a.shift());0===e.cmd.filter(e=>e===t||"*"===e).length&&argumentTypeError(t,e.cmd,i,!1),i+=1}),s.optional.forEach(e=>{if(0===a.length)return;const t=guessType(a.shift());0===e.cmd.filter(e=>e===t||"*"===e).length&&argumentTypeError(t,e.cmd,i,!0),i+=1})}catch(e){console.warn(e.stack)}};const r=n(278)(),o=n(132),i=["first","second","third","fourth","fifth","sixth"];function guessType(e){return Array.isArray(e)?"array":null===e?"null":typeof e}function argumentTypeError(e,t,n,r){throw new o(`Invalid ${i[n]||"manyith"} argument. Expected ${t.join(" or ")} but received ${e}.`)}},function(e,t,n){"use strict";const r=n(183),o=n(614),i=n(615),stringWidth=e=>{if("string"!=typeof e||0===e.length)return 0;if(0===(e=r(e)).length)return 0;e=e.replace(i(),"  ");let t=0;for(let n=0;n<e.length;n++){const r=e.codePointAt(n);r<=31||r>=127&&r<=159||(r>=768&&r<=879||(r>65535&&n++,t+=o(r)?2:1))}return t};e.exports=stringWidth,e.exports.default=stringWidth},function(e,t,n){"use strict";const r=n(613);e.exports=e=>"string"==typeof e?e.replace(r(),""):e},function(e,t,n){"use strict";e.exports=function objFilter(e,t){const n={};return t=t||((e,t)=>!0),Object.keys(e||{}).forEach(r=>{t(r,e[r])&&(n[r]=e[r])}),n}},function(e,t){function webpackEmptyContext(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,e.exports=webpackEmptyContext,webpackEmptyContext.id=185},function(e,t,n){"use strict";const r=n(644),o=n(645);class AggregateError extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t=(e=[...e].map(e=>e instanceof Error?e:null!==e&&"object"==typeof e?Object.assign(new Error(e.message),e):new Error(e))).map(e=>"string"==typeof e.stack?o(e.stack).replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""):String(e)).join("\n");t="\n"+r(t,4),super(t),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(const e of this._errors)yield e}}e.exports=AggregateError},function(e,t){const n=/^[0-9]+$/,compareIdentifiers=(e,t)=>{const r=n.test(e),o=n.test(t);return r&&o&&(e=+e,t=+t),e===t?0:r&&!o?-1:o&&!r?1:e<t?-1:1};e.exports={compareIdentifiers:compareIdentifiers,rcompareIdentifiers:(e,t)=>compareIdentifiers(t,e)}},function(e,t,n){const r=n(38);e.exports=(e,t,n)=>0===r(e,t,n)},function(e,t,n){const r=n(25);e.exports=(e,t,n)=>{const o=new r(e,n),i=new r(t,n);return o.compare(i)||o.compareBuild(i)}},function(e,t,n){const r=n(38);e.exports=(e,t,n)=>r(e,t,n)<0},function(e,t,n){const r=n(38);e.exports=(e,t,n)=>r(e,t,n)>=0},function(e,t,n){const r=n(38);e.exports=(e,t,n)=>r(e,t,n)<=0},function(e,t,n){const r=n(25),o=n(138),{ANY:i}=o,s=n(39),a=n(139),c=n(137),u=n(190),l=n(192),d=n(191);e.exports=(e,t,n,p)=>{let h,m,y,g,_;switch(e=new r(e,p),t=new s(t,p),n){case">":h=c,m=l,y=u,g=">",_=">=";break;case"<":h=u,m=d,y=c,g="<",_="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(e,t,p))return!1;for(let n=0;n<t.set.length;++n){const r=t.set[n];let s=null,a=null;if(r.forEach(e=>{e.semver===i&&(e=new o(">=0.0.0")),s=s||e,a=a||e,h(e.semver,s.semver,p)?s=e:y(e.semver,a.semver,p)&&(a=e)}),s.operator===g||s.operator===_)return!1;if((!a.operator||a.operator===g)&&m(e,a.semver))return!1;if(a.operator===_&&y(e,a.semver))return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPrimitive=function isPrimitive(e){return"value"in e&&"function"==typeof e.setValue&&"function"==typeof e.getValue}},function(e,t){var n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/,o=/^\./,i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,s=/\\(\\)?/g,a=/^\[object .+?Constructor\]$/,c=/^(?:0|[1-9]\d*)$/,u="object"==typeof global&&global&&global.Object===Object&&global,l="object"==typeof self&&self&&self.Object===Object&&self,d=u||l||Function("return this")();var p,h=Array.prototype,m=Function.prototype,y=Object.prototype,g=d["__core-js_shared__"],_=(p=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||""))?"Symbol(src)_1."+p:"",v=m.toString,E=y.hasOwnProperty,I=y.toString,b=RegExp("^"+v.call(E).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),S=d.Symbol,C=y.propertyIsEnumerable,w=h.splice,A=getNative(d,"Map"),O=getNative(Object,"create"),P=S?S.prototype:void 0,D=P?P.toString:void 0;function Hash(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ListCache(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function MapCache(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function assocIndexOf(e,t){for(var n,r,o=e.length;o--;)if((n=e[o][0])===(r=t)||n!=n&&r!=r)return o;return-1}function baseHas(e,t){return null!=e&&E.call(e,t)}function baseIsNative(e){return!(!isObject(e)||function isMasked(e){return!!_&&_ in e}(e))&&(isFunction(e)||function isHostObject(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?b:a).test(function toSource(e){if(null!=e){try{return v.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function getMapData(e,t){var n=e.__data__;return function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function getNative(e,t){var n=function getValue(e,t){return null==e?void 0:e[t]}(e,t);return baseIsNative(n)?n:void 0}function hasPath(e,t,o){for(var i,s=-1,a=(t=function isKey(e,t){if(R(e))return!1;var o=typeof e;if("number"==o||"symbol"==o||"boolean"==o||null==e||isSymbol(e))return!0;return r.test(e)||!n.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:function castPath(e){return R(e)?e:x(e)}(t)).length;++s<a;){var u=toKey(t[s]);if(!(i=null!=e&&o(e,u)))break;e=e[u]}return i||!!(a=e?e.length:0)&&isLength(a)&&function isIndex(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||c.test(e))&&e>-1&&e%1==0&&e<t}(u,a)&&(R(e)||function isArguments(e){return function isArrayLikeObject(e){return isObjectLike(e)&&function isArrayLike(e){return null!=e&&isLength(e.length)&&!isFunction(e)}(e)}(e)&&E.call(e,"callee")&&(!C.call(e,"callee")||"[object Arguments]"==I.call(e))}(e))}Hash.prototype.clear=function hashClear(){this.__data__=O?O(null):{}},Hash.prototype.delete=function hashDelete(e){return this.has(e)&&delete this.__data__[e]},Hash.prototype.get=function hashGet(e){var t=this.__data__;if(O){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return E.call(t,e)?t[e]:void 0},Hash.prototype.has=function hashHas(e){var t=this.__data__;return O?void 0!==t[e]:E.call(t,e)},Hash.prototype.set=function hashSet(e,t){return this.__data__[e]=O&&void 0===t?"__lodash_hash_undefined__":t,this},ListCache.prototype.clear=function listCacheClear(){this.__data__=[]},ListCache.prototype.delete=function listCacheDelete(e){var t=this.__data__,n=assocIndexOf(t,e);return!(n<0)&&(n==t.length-1?t.pop():w.call(t,n,1),!0)},ListCache.prototype.get=function listCacheGet(e){var t=this.__data__,n=assocIndexOf(t,e);return n<0?void 0:t[n][1]},ListCache.prototype.has=function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1},ListCache.prototype.set=function listCacheSet(e,t){var n=this.__data__,r=assocIndexOf(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},MapCache.prototype.clear=function mapCacheClear(){this.__data__={hash:new Hash,map:new(A||ListCache),string:new Hash}},MapCache.prototype.delete=function mapCacheDelete(e){return getMapData(this,e).delete(e)},MapCache.prototype.get=function mapCacheGet(e){return getMapData(this,e).get(e)},MapCache.prototype.has=function mapCacheHas(e){return getMapData(this,e).has(e)},MapCache.prototype.set=function mapCacheSet(e,t){return getMapData(this,e).set(e,t),this};var x=memoize((function(e){e=function toString(e){return null==e?"":function baseToString(e){if("string"==typeof e)return e;if(isSymbol(e))return D?D.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)}(e);var t=[];return o.test(e)&&t.push(""),e.replace(i,(function(e,n,r,o){t.push(r?o.replace(s,"$1"):n||e)})),t}));function toKey(e){if("string"==typeof e||isSymbol(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function memoize(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var memoized=function(){var n=arguments,r=t?t.apply(this,n):n[0],o=memoized.cache;if(o.has(r))return o.get(r);var i=e.apply(this,n);return memoized.cache=o.set(r,i),i};return memoized.cache=new(memoize.Cache||MapCache),memoized}memoize.Cache=MapCache;var R=Array.isArray;function isFunction(e){var t=isObject(e)?I.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function isObjectLike(e){return!!e&&"object"==typeof e}function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&"[object Symbol]"==I.call(e)}e.exports=function has(e,t){return null!=e&&hasPath(e,t,baseHas)}},function(e,t,n){(function(e){var n="[object Arguments]",r="[object Map]",o="[object Object]",i="[object Set]",s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/,c=/^\./,u=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,l=/\\(\\)?/g,d=/^\[object .+?Constructor\]$/,p=/^(?:0|[1-9]\d*)$/,h={};h["[object Float32Array]"]=h["[object Float64Array]"]=h["[object Int8Array]"]=h["[object Int16Array]"]=h["[object Int32Array]"]=h["[object Uint8Array]"]=h["[object Uint8ClampedArray]"]=h["[object Uint16Array]"]=h["[object Uint32Array]"]=!0,h[n]=h["[object Array]"]=h["[object ArrayBuffer]"]=h["[object Boolean]"]=h["[object DataView]"]=h["[object Date]"]=h["[object Error]"]=h["[object Function]"]=h[r]=h["[object Number]"]=h[o]=h["[object RegExp]"]=h[i]=h["[object String]"]=h["[object WeakMap]"]=!1;var m="object"==typeof global&&global&&global.Object===Object&&global,y="object"==typeof self&&self&&self.Object===Object&&self,g=m||y||Function("return this")(),_=t&&!t.nodeType&&t,v=_&&"object"==typeof e&&e&&!e.nodeType&&e,E=v&&v.exports===_&&m.process,I=function(){try{return E&&E.binding("util")}catch(e){}}(),b=I&&I.isTypedArray;function arrayPush(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}function arraySome(e,t){for(var n=-1,r=e?e.length:0;++n<r;)if(t(e[n],n,e))return!0;return!1}function isHostObject(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function mapToArray(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function overArg(e,t){return function(n){return e(t(n))}}function setToArray(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var S,C=Array.prototype,w=Function.prototype,A=Object.prototype,O=g["__core-js_shared__"],P=(S=/[^.]+$/.exec(O&&O.keys&&O.keys.IE_PROTO||""))?"Symbol(src)_1."+S:"",D=w.toString,x=A.hasOwnProperty,R=A.toString,N=RegExp("^"+D.call(x).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),M=g.Symbol,L=g.Uint8Array,j=overArg(Object.getPrototypeOf,Object),k=A.propertyIsEnumerable,F=C.splice,U=Object.getOwnPropertySymbols,V=overArg(Object.keys,Object),B=getNative(g,"DataView"),J=getNative(g,"Map"),$=getNative(g,"Promise"),G=getNative(g,"Set"),q=getNative(g,"WeakMap"),H=getNative(Object,"create"),Y=toSource(B),K=toSource(J),z=toSource($),W=toSource(G),Q=toSource(q),X=M?M.prototype:void 0,Z=X?X.valueOf:void 0,ee=X?X.toString:void 0;function Hash(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ListCache(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function MapCache(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function SetCache(e){var t=-1,n=e?e.length:0;for(this.__data__=new MapCache;++t<n;)this.add(e[t])}function Stack(e){this.__data__=new ListCache(e)}function arrayLikeKeys(e,t){var n=ie(e)||isArguments(e)?function baseTimes(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],r=n.length,o=!!r;for(var i in e)!t&&!x.call(e,i)||o&&("length"==i||isIndex(i,r))||n.push(i);return n}function assocIndexOf(e,t){for(var n=e.length;n--;)if(eq(e[n][0],t))return n;return-1}function baseGet(e,t){for(var n=0,r=(t=isKey(t,e)?[t]:castPath(t)).length;null!=e&&n<r;)e=e[toKey(t[n++])];return n&&n==r?e:void 0}function baseHasIn(e,t){return null!=e&&t in Object(e)}function baseIsEqual(e,t,s,a,c){return e===t||(null==e||null==t||!isObject(e)&&!isObjectLike(t)?e!=e&&t!=t:function baseIsEqualDeep(e,t,s,a,c,u){var l=ie(e),d=ie(t),p="[object Array]",h="[object Array]";l||(p=(p=re(e))==n?o:p);d||(h=(h=re(t))==n?o:h);var m=p==o&&!isHostObject(e),y=h==o&&!isHostObject(t),g=p==h;if(g&&!m)return u||(u=new Stack),l||se(e)?equalArrays(e,t,s,a,c,u):function equalByTag(e,t,n,o,s,a,c){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new L(e),new L(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return eq(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case r:var u=mapToArray;case i:var l=2&a;if(u||(u=setToArray),e.size!=t.size&&!l)return!1;var d=c.get(e);if(d)return d==t;a|=1,c.set(e,t);var p=equalArrays(u(e),u(t),o,s,a,c);return c.delete(e),p;case"[object Symbol]":if(Z)return Z.call(e)==Z.call(t)}return!1}(e,t,p,s,a,c,u);if(!(2&c)){var _=m&&x.call(e,"__wrapped__"),v=y&&x.call(t,"__wrapped__");if(_||v){var E=_?e.value():e,I=v?t.value():t;return u||(u=new Stack),s(E,I,a,c,u)}}if(!g)return!1;return u||(u=new Stack),function equalObjects(e,t,n,r,o,i){var s=2&o,a=keys(e),c=a.length,u=keys(t).length;if(c!=u&&!s)return!1;var l=c;for(;l--;){var d=a[l];if(!(s?d in t:x.call(t,d)))return!1}var p=i.get(e);if(p&&i.get(t))return p==t;var h=!0;i.set(e,t),i.set(t,e);var m=s;for(;++l<c;){d=a[l];var y=e[d],g=t[d];if(r)var _=s?r(g,y,d,t,e,i):r(y,g,d,e,t,i);if(!(void 0===_?y===g||n(y,g,r,o,i):_)){h=!1;break}m||(m="constructor"==d)}if(h&&!m){var v=e.constructor,E=t.constructor;v==E||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof E&&E instanceof E||(h=!1)}return i.delete(e),i.delete(t),h}(e,t,s,a,c,u)}(e,t,baseIsEqual,s,a,c))}function baseIsNative(e){return!(!isObject(e)||function isMasked(e){return!!P&&P in e}(e))&&(isFunction(e)||isHostObject(e)?N:d).test(toSource(e))}function baseIteratee(e){return"function"==typeof e?e:null==e?identity:"object"==typeof e?ie(e)?function baseMatchesProperty(e,t){if(isKey(e)&&isStrictComparable(t))return matchesStrictComparable(toKey(e),t);return function(n){var r=function get(e,t,n){var r=null==e?void 0:baseGet(e,t);return void 0===r?n:r}(n,e);return void 0===r&&r===t?function hasIn(e,t){return null!=e&&function hasPath(e,t,n){t=isKey(t,e)?[t]:castPath(t);var r,o=-1,i=t.length;for(;++o<i;){var s=toKey(t[o]);if(!(r=null!=e&&n(e,s)))break;e=e[s]}if(r)return r;return!!(i=e?e.length:0)&&isLength(i)&&isIndex(s,i)&&(ie(e)||isArguments(e))}(e,t,baseHasIn)}(n,e):baseIsEqual(t,r,void 0,3)}}(e[0],e[1]):function baseMatches(e){var t=function getMatchData(e){var t=keys(e),n=t.length;for(;n--;){var r=t[n],o=e[r];t[n]=[r,o,isStrictComparable(o)]}return t}(e);if(1==t.length&&t[0][2])return matchesStrictComparable(t[0][0],t[0][1]);return function(n){return n===e||function baseIsMatch(e,t,n,r){var o=n.length,i=o,s=!r;if(null==e)return!i;for(e=Object(e);o--;){var a=n[o];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++o<i;){var c=(a=n[o])[0],u=e[c],l=a[1];if(s&&a[2]){if(void 0===u&&!(c in e))return!1}else{var d=new Stack;if(r)var p=r(u,l,c,e,t,d);if(!(void 0===p?baseIsEqual(l,u,r,3,d):p))return!1}}return!0}(n,e,t)}}(e):function property(e){return isKey(e)?function baseProperty(e){return function(t){return null==t?void 0:t[e]}}(toKey(e)):function basePropertyDeep(e){return function(t){return baseGet(t,e)}}(e)}(e)}function baseKeysIn(e){if(!isObject(e))return function nativeKeysIn(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=isPrototype(e),n=[];for(var r in e)("constructor"!=r||!t&&x.call(e,r))&&n.push(r);return n}function castPath(e){return ie(e)?e:oe(e)}function equalArrays(e,t,n,r,o,i){var s=2&o,a=e.length,c=t.length;if(a!=c&&!(s&&c>a))return!1;var u=i.get(e);if(u&&i.get(t))return u==t;var l=-1,d=!0,p=1&o?new SetCache:void 0;for(i.set(e,t),i.set(t,e);++l<a;){var h=e[l],m=t[l];if(r)var y=s?r(m,h,l,t,e,i):r(h,m,l,e,t,i);if(void 0!==y){if(y)continue;d=!1;break}if(p){if(!arraySome(t,(function(e,t){if(!p.has(t)&&(h===e||n(h,e,r,o,i)))return p.add(t)}))){d=!1;break}}else if(h!==m&&!n(h,m,r,o,i)){d=!1;break}}return i.delete(e),i.delete(t),d}function getAllKeysIn(e){return function baseGetAllKeys(e,t,n){var r=t(e);return ie(e)?r:arrayPush(r,n(e))}(e,keysIn,ne)}function getMapData(e,t){var n=e.__data__;return function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function getNative(e,t){var n=function getValue(e,t){return null==e?void 0:e[t]}(e,t);return baseIsNative(n)?n:void 0}Hash.prototype.clear=function hashClear(){this.__data__=H?H(null):{}},Hash.prototype.delete=function hashDelete(e){return this.has(e)&&delete this.__data__[e]},Hash.prototype.get=function hashGet(e){var t=this.__data__;if(H){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return x.call(t,e)?t[e]:void 0},Hash.prototype.has=function hashHas(e){var t=this.__data__;return H?void 0!==t[e]:x.call(t,e)},Hash.prototype.set=function hashSet(e,t){return this.__data__[e]=H&&void 0===t?"__lodash_hash_undefined__":t,this},ListCache.prototype.clear=function listCacheClear(){this.__data__=[]},ListCache.prototype.delete=function listCacheDelete(e){var t=this.__data__,n=assocIndexOf(t,e);return!(n<0)&&(n==t.length-1?t.pop():F.call(t,n,1),!0)},ListCache.prototype.get=function listCacheGet(e){var t=this.__data__,n=assocIndexOf(t,e);return n<0?void 0:t[n][1]},ListCache.prototype.has=function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1},ListCache.prototype.set=function listCacheSet(e,t){var n=this.__data__,r=assocIndexOf(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},MapCache.prototype.clear=function mapCacheClear(){this.__data__={hash:new Hash,map:new(J||ListCache),string:new Hash}},MapCache.prototype.delete=function mapCacheDelete(e){return getMapData(this,e).delete(e)},MapCache.prototype.get=function mapCacheGet(e){return getMapData(this,e).get(e)},MapCache.prototype.has=function mapCacheHas(e){return getMapData(this,e).has(e)},MapCache.prototype.set=function mapCacheSet(e,t){return getMapData(this,e).set(e,t),this},SetCache.prototype.add=SetCache.prototype.push=function setCacheAdd(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},SetCache.prototype.has=function setCacheHas(e){return this.__data__.has(e)},Stack.prototype.clear=function stackClear(){this.__data__=new ListCache},Stack.prototype.delete=function stackDelete(e){return this.__data__.delete(e)},Stack.prototype.get=function stackGet(e){return this.__data__.get(e)},Stack.prototype.has=function stackHas(e){return this.__data__.has(e)},Stack.prototype.set=function stackSet(e,t){var n=this.__data__;if(n instanceof ListCache){var r=n.__data__;if(!J||r.length<199)return r.push([e,t]),this;n=this.__data__=new MapCache(r)}return n.set(e,t),this};var te=U?overArg(U,Object):stubArray,ne=U?function(e){for(var t=[];e;)arrayPush(t,te(e)),e=j(e);return t}:stubArray,re=function baseGetTag(e){return R.call(e)};function isIndex(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||p.test(e))&&e>-1&&e%1==0&&e<t}function isKey(e,t){if(ie(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!isSymbol(e))||(a.test(e)||!s.test(e)||null!=t&&e in Object(t))}function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||A)}function isStrictComparable(e){return e==e&&!isObject(e)}function matchesStrictComparable(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}(B&&"[object DataView]"!=re(new B(new ArrayBuffer(1)))||J&&re(new J)!=r||$&&"[object Promise]"!=re($.resolve())||G&&re(new G)!=i||q&&"[object WeakMap]"!=re(new q))&&(re=function(e){var t=R.call(e),n=t==o?e.constructor:void 0,s=n?toSource(n):void 0;if(s)switch(s){case Y:return"[object DataView]";case K:return r;case z:return"[object Promise]";case W:return i;case Q:return"[object WeakMap]"}return t});var oe=memoize((function(e){e=function toString(e){return null==e?"":function baseToString(e){if("string"==typeof e)return e;if(isSymbol(e))return ee?ee.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(e)}(e);var t=[];return c.test(e)&&t.push(""),e.replace(u,(function(e,n,r,o){t.push(r?o.replace(l,"$1"):n||e)})),t}));function toKey(e){if("string"==typeof e||isSymbol(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function toSource(e){if(null!=e){try{return D.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function memoize(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var memoized=function(){var n=arguments,r=t?t.apply(this,n):n[0],o=memoized.cache;if(o.has(r))return o.get(r);var i=e.apply(this,n);return memoized.cache=o.set(r,i),i};return memoized.cache=new(memoize.Cache||MapCache),memoized}function eq(e,t){return e===t||e!=e&&t!=t}function isArguments(e){return function isArrayLikeObject(e){return isObjectLike(e)&&isArrayLike(e)}(e)&&x.call(e,"callee")&&(!k.call(e,"callee")||R.call(e)==n)}memoize.Cache=MapCache;var ie=Array.isArray;function isArrayLike(e){return null!=e&&isLength(e.length)&&!isFunction(e)}function isFunction(e){var t=isObject(e)?R.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function isObjectLike(e){return!!e&&"object"==typeof e}function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&"[object Symbol]"==R.call(e)}var se=b?function baseUnary(e){return function(t){return e(t)}}(b):function baseIsTypedArray(e){return isObjectLike(e)&&isLength(e.length)&&!!h[R.call(e)]};function keys(e){return isArrayLike(e)?arrayLikeKeys(e):function baseKeys(e){if(!isPrototype(e))return V(e);var t=[];for(var n in Object(e))x.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}function keysIn(e){return isArrayLike(e)?arrayLikeKeys(e,!0):baseKeysIn(e)}function identity(e){return e}function stubArray(){return[]}e.exports=function omitBy(e,t){return function pickBy(e,t){return null==e?{}:function basePickBy(e,t,n){for(var r=-1,o=t.length,i={};++r<o;){var s=t[r],a=e[s];n(a,s)&&(i[s]=a)}return i}(e,getAllKeysIn(e),baseIteratee(t))}(e,function negate(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}(baseIteratee(t)))}}).call(this,n(34)(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NonEnumerable=(e,t,n)=>{if(n)return n.enumerable=!1,n;Object.defineProperty(e,t,{set(e){Object.defineProperty(this,t,{value:e,enumerable:!1,writable:!0,configurable:!0})},enumerable:!1,configurable:!0})}},function(e,t){var n=/^\[object .+?Constructor\]$/,r=/^(?:0|[1-9]\d*)$/,o="object"==typeof global&&global&&global.Object===Object&&global,i="object"==typeof self&&self&&self.Object===Object&&self,s=o||i||Function("return this")();function apply(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function arrayIncludes(e,t){return!!(e?e.length:0)&&function baseIndexOf(e,t,n){if(t!=t)return function baseFindIndex(e,t,n,r){var o=e.length,i=n+(r?1:-1);for(;r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}(e,baseIsNaN,n);var r=n-1,o=e.length;for(;++r<o;)if(e[r]===t)return r;return-1}(e,t,0)>-1}function arrayIncludesWith(e,t,n){for(var r=-1,o=e?e.length:0;++r<o;)if(n(t,e[r]))return!0;return!1}function arrayMap(e,t){for(var n=-1,r=e?e.length:0,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}function arrayPush(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}function baseIsNaN(e){return e!=e}function cacheHas(e,t){return e.has(t)}function overArg(e,t){return function(n){return e(t(n))}}var a,c=Array.prototype,u=Function.prototype,l=Object.prototype,d=s["__core-js_shared__"],p=(a=/[^.]+$/.exec(d&&d.keys&&d.keys.IE_PROTO||""))?"Symbol(src)_1."+a:"",h=u.toString,m=l.hasOwnProperty,y=l.toString,g=RegExp("^"+h.call(m).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_=s.Symbol,v=overArg(Object.getPrototypeOf,Object),E=l.propertyIsEnumerable,I=c.splice,b=_?_.isConcatSpreadable:void 0,S=Object.getOwnPropertySymbols,C=Math.max,w=getNative(s,"Map"),A=getNative(Object,"create");function Hash(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ListCache(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function MapCache(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function SetCache(e){var t=-1,n=e?e.length:0;for(this.__data__=new MapCache;++t<n;)this.add(e[t])}function arrayLikeKeys(e,t){var n=D(e)||isArguments(e)?function baseTimes(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],r=n.length,o=!!r;for(var i in e)!t&&!m.call(e,i)||o&&("length"==i||isIndex(i,r))||n.push(i);return n}function assocIndexOf(e,t){for(var n,r,o=e.length;o--;)if((n=e[o][0])===(r=t)||n!=n&&r!=r)return o;return-1}function baseIsNative(e){return!(!isObject(e)||function isMasked(e){return!!p&&p in e}(e))&&(isFunction(e)||function isHostObject(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?g:n).test(function toSource(e){if(null!=e){try{return h.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function baseKeysIn(e){if(!isObject(e))return function nativeKeysIn(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=function isPrototype(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||l;return e===n}(e),n=[];for(var r in e)("constructor"!=r||!t&&m.call(e,r))&&n.push(r);return n}function getAllKeysIn(e){return function baseGetAllKeys(e,t,n){var r=t(e);return D(e)?r:arrayPush(r,n(e))}(e,keysIn,P)}function getMapData(e,t){var n=e.__data__;return function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function getNative(e,t){var n=function getValue(e,t){return null==e?void 0:e[t]}(e,t);return baseIsNative(n)?n:void 0}Hash.prototype.clear=function hashClear(){this.__data__=A?A(null):{}},Hash.prototype.delete=function hashDelete(e){return this.has(e)&&delete this.__data__[e]},Hash.prototype.get=function hashGet(e){var t=this.__data__;if(A){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return m.call(t,e)?t[e]:void 0},Hash.prototype.has=function hashHas(e){var t=this.__data__;return A?void 0!==t[e]:m.call(t,e)},Hash.prototype.set=function hashSet(e,t){return this.__data__[e]=A&&void 0===t?"__lodash_hash_undefined__":t,this},ListCache.prototype.clear=function listCacheClear(){this.__data__=[]},ListCache.prototype.delete=function listCacheDelete(e){var t=this.__data__,n=assocIndexOf(t,e);return!(n<0)&&(n==t.length-1?t.pop():I.call(t,n,1),!0)},ListCache.prototype.get=function listCacheGet(e){var t=this.__data__,n=assocIndexOf(t,e);return n<0?void 0:t[n][1]},ListCache.prototype.has=function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1},ListCache.prototype.set=function listCacheSet(e,t){var n=this.__data__,r=assocIndexOf(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},MapCache.prototype.clear=function mapCacheClear(){this.__data__={hash:new Hash,map:new(w||ListCache),string:new Hash}},MapCache.prototype.delete=function mapCacheDelete(e){return getMapData(this,e).delete(e)},MapCache.prototype.get=function mapCacheGet(e){return getMapData(this,e).get(e)},MapCache.prototype.has=function mapCacheHas(e){return getMapData(this,e).has(e)},MapCache.prototype.set=function mapCacheSet(e,t){return getMapData(this,e).set(e,t),this},SetCache.prototype.add=SetCache.prototype.push=function setCacheAdd(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},SetCache.prototype.has=function setCacheHas(e){return this.__data__.has(e)};var O=S?overArg(S,Object):stubArray,P=S?function(e){for(var t=[];e;)arrayPush(t,O(e)),e=v(e);return t}:stubArray;function isFlattenable(e){return D(e)||isArguments(e)||!!(b&&e&&e[b])}function isIndex(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||r.test(e))&&e>-1&&e%1==0&&e<t}function toKey(e){if("string"==typeof e||function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&"[object Symbol]"==y.call(e)}(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function isArguments(e){return function isArrayLikeObject(e){return isObjectLike(e)&&isArrayLike(e)}(e)&&m.call(e,"callee")&&(!E.call(e,"callee")||"[object Arguments]"==y.call(e))}var D=Array.isArray;function isArrayLike(e){return null!=e&&function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!isFunction(e)}function isFunction(e){var t=isObject(e)?y.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function isObjectLike(e){return!!e&&"object"==typeof e}function keysIn(e){return isArrayLike(e)?arrayLikeKeys(e,!0):baseKeysIn(e)}var x=function baseRest(e,t){return t=C(void 0===t?e.length-1:t,0),function(){for(var n=arguments,r=-1,o=C(n.length-t,0),i=Array(o);++r<o;)i[r]=n[t+r];r=-1;for(var s=Array(t+1);++r<t;)s[r]=n[r];return s[t]=i,apply(e,this,s)}}((function(e,t){return null==e?{}:(t=arrayMap(function baseFlatten(e,t,n,r,o){var i=-1,s=e.length;for(n||(n=isFlattenable),o||(o=[]);++i<s;){var a=e[i];t>0&&n(a)?t>1?baseFlatten(a,t-1,n,r,o):arrayPush(o,a):r||(o[o.length]=a)}return o}(t,1),toKey),function basePick(e,t){return function basePickBy(e,t,n){var r=-1,o=t.length,i={};for(;++r<o;){var s=t[r],a=e[s];n(a,s)&&(i[s]=a)}return i}(e=Object(e),t,(function(t,n){return n in e}))}(e,function baseDifference(e,t,n,r){var o=-1,i=arrayIncludes,s=!0,a=e.length,c=[],u=t.length;if(!a)return c;n&&(t=arrayMap(t,function baseUnary(e){return function(t){return e(t)}}(n))),r?(i=arrayIncludesWith,s=!1):t.length>=200&&(i=cacheHas,s=!1,t=new SetCache(t));e:for(;++o<a;){var l=e[o],d=n?n(l):l;if(l=r||0!==l?l:0,s&&d==d){for(var p=u;p--;)if(t[p]===d)continue e;c.push(l)}else i(t,d,r)||c.push(l)}return c}(getAllKeysIn(e),t)))}));function stubArray(){return[]}e.exports=x},function(e,t,n){"use strict";var r=n(28);function encode(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function buildURL(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(r.isURLSearchParams(t))o=t.toString();else{var i=[];r.forEach(t,(function serialize(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function parseValue(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),i.push(encode(t)+"="+encode(e))})))})),o=i.join("&")}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},function(e,t,n){"use strict";var r=n(317);e.exports=function createError(e,t,n,o,i){var s=new Error(e);return r(s,t,n,o,i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=void 0,function(e){e[e.ERROR=0]="ERROR",e[e.WARN=1]="WARN",e[e.INFO=2]="INFO",e[e.DEBUG=3]="DEBUG"}(t.LogLevel||(t.LogLevel={}))},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(829),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getParentSpanContext=t.setExtractedSpanContext=t.getExtractedSpanContext=t.setActiveSpan=t.getActiveSpan=t.ACTIVE_SPAN_KEY=void 0;const r=n(149);t.ACTIVE_SPAN_KEY=r.Context.createKey("OpenTelemetry Context Key ACTIVE_SPAN");const o=r.Context.createKey("OpenTelemetry Context Key EXTRACTED_SPAN_CONTEXT");function getActiveSpan(e){return e.getValue(t.ACTIVE_SPAN_KEY)||void 0}function getExtractedSpanContext(e){return e.getValue(o)||void 0}t.getActiveSpan=getActiveSpan,t.setActiveSpan=function setActiveSpan(e,n){return e.setValue(t.ACTIVE_SPAN_KEY,n)},t.getExtractedSpanContext=getExtractedSpanContext,t.setExtractedSpanContext=function setExtractedSpanContext(e,t){return e.setValue(o,t)},t.getParentSpanContext=function getParentSpanContext(e){var t;return(null===(t=getActiveSpan(e))||void 0===t?void 0:t.context())||getExtractedSpanContext(e)}},function(e,t,n){var r=n(154),o=n(873),i=n(874),s=n(875),a=n(876),c=n(877);function Stack(e){var t=this.__data__=new r(e);this.size=t.size}Stack.prototype.clear=o,Stack.prototype.delete=i,Stack.prototype.get=s,Stack.prototype.has=a,Stack.prototype.set=c,e.exports=Stack},function(e,t){e.exports=function eq(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var r=n(63)(n(48),"Map");e.exports=r},function(e,t,n){var r=n(884),o=n(891),i=n(893),s=n(894),a=n(895);function MapCache(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}MapCache.prototype.clear=r,MapCache.prototype.delete=o,MapCache.prototype.get=i,MapCache.prototype.has=s,MapCache.prototype.set=a,e.exports=MapCache},function(e,t,n){(function(e){var r=n(48),o=n(901),i=t&&!t.nodeType&&t,s=i&&"object"==typeof e&&e&&!e.nodeType&&e,a=s&&s.exports===i?r.Buffer:void 0,c=(a?a.isBuffer:void 0)||o;e.exports=c}).call(this,n(34)(e))},function(e,t){e.exports=function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t,n){(function(e){var r=n(345),o=t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,s=i&&i.exports===o&&r.process,a=function(){try{var e=i&&i.require&&i.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=a}).call(this,n(34)(e))},function(e,t){var n=Object.prototype;e.exports=function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t,n){var r=n(349),o=n(906),i=n(106);e.exports=function keysIn(e){return i(e)?r(e,!0):o(e)}},function(e,t,n){var r=n(911),o=n(354),i=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),r(s(e),(function(t){return i.call(e,t)})))}:o;e.exports=a},function(e,t,n){var r=n(360);e.exports=function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},function(e,t,n){var r=n(362),o=n(162);e.exports=function baseGet(e,t){for(var n=0,i=(t=r(t,e)).length;null!=e&&n<i;)e=e[o(t[n++])];return n&&n==i?e:void 0}},function(e,t,n){var r=n(42),o=n(108),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function isKey(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!o(e))||(s.test(e)||!i.test(e)||null!=t&&e in Object(t))}},function(e,t,n){var r=n(937),o=n(950),i=n(368),s=n(42),a=n(954);e.exports=function baseIteratee(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?s(e)?o(e[0],e[1]):r(e):a(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLocalContext=function isLocalContext(e){return null!=e}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(196)),i=r(n(13)),s=r(n(59)),a=n(220),c=n(985);class ChangesetMerger{static mergeChangesets(e,t){if(i.default(e)&&i.default(t))return e;if(i.default(t))return e;if(i.default(e))return s.default(t);if(!a.isChangeSet(e))throw new Error("The source object is not a changeset");if(!a.isChangeSet(t))throw new Error("The applied object is not a changeset.");return ChangesetMerger.handleRemove(e,t),ChangesetMerger.handleInsert(e,t),ChangesetMerger.handleModify(e,t),e}static mergeChangesetList(e){if(0===e.length)return{};let t=s.default(e[0]);for(const n of e.slice(1))t=ChangesetMerger.mergeChangesets(t,n);return ChangesetMerger.cleanupChangeSet(t)}static handleInsert(e,t){var n,r,o,i;const s=e;if(void 0===t.insert)return e;for(const[e,u]of Object.entries(t.insert))for(const[t,l]of Object.entries(u)){let u=!1;if(s.remove&&s.remove.includes(t)){u=!0;const n=s.remove.indexOf(t);n>=0&&s.remove.splice(n,1),ChangesetMerger.setValueInChangeset(s,"modify",e,t,l)}else void 0!==(null===(r=null===(n=s.insert)||void 0===n?void 0:n[e])||void 0===r?void 0:r[t])?(u=!0,a.isChangeSet(l)&&a.isChangeSet(s.insert[e][t])&&!c.isArrayChangeSet(l)?s.insert[e][t]=ChangesetMerger.mergeChangesets(s.insert[e][t],l):ChangesetMerger.setValueInChangeset(s,"insert",e,t,l)):void 0!==(null===(i=null===(o=s.modify)||void 0===o?void 0:o[e])||void 0===i?void 0:i[t])&&(u=!0,a.isChangeSet(l)&&a.isChangeSet(s.modify[e][t])&&!c.isArrayChangeSet(l)?s.modify[e][t]=ChangesetMerger.mergeChangesets(s.modify[e][t],l):ChangesetMerger.setValueInChangeset(s,"modify",e,t,l));u||ChangesetMerger.setValueInChangeset(s,"insert",e,t,l)}return s}static handleModify(e,t){var n,r,o,i,s,u,l,d;const p=e;if(void 0===t.modify)return e;for(const[e,h]of Object.entries(t.modify))for(const[t,m]of Object.entries(h)){let h=!1;if(p.remove&&p.remove.includes(t)){const e=p.remove.indexOf(t);e>=0&&p.remove.splice(e,1)}else void 0!==(null===(r=null===(n=p.insert)||void 0===n?void 0:n[e])||void 0===r?void 0:r[t])?(h=!0,a.isChangeSet(m)&&a.isChangeSet(p.insert[e][t])?c.isArrayChangeSet(m)?ChangesetMerger.setValueInChangeset(p,"insert",e,t,m):p.insert[e][t]=ChangesetMerger.mergeChangesets(p.insert[e][t],m):"object"==typeof(null===(i=null===(o=p.insert)||void 0===o?void 0:o[e])||void 0===i?void 0:i[t])&&"object"==typeof m?ChangesetMerger.mergeStaticChangesets(null===(u=null===(s=p.insert)||void 0===s?void 0:s[e])||void 0===u?void 0:u[t],m):ChangesetMerger.setValueInChangeset(p,"insert",e,t,m)):void 0!==(null===(d=null===(l=p.modify)||void 0===l?void 0:l[e])||void 0===d?void 0:d[t])&&(h=!0,a.isChangeSet(m)&&a.isChangeSet(p.modify[e][t])&&!c.isArrayChangeSet(m)?p.modify[e][t]=ChangesetMerger.mergeChangesets(p.modify[e][t],m):ChangesetMerger.setValueInChangeset(p,"modify",e,t,m));h||ChangesetMerger.setValueInChangeset(p,"modify",e,t,m)}return p}static handleRemove(e,t){const n=e;if(void 0===t.remove)return e;for(const e of t.remove){let t=!1;if(n.insert)for(const r of Object.keys(n.insert))n.insert[r]&&void 0!==n.insert[r][e]&&(delete n.insert[r][e],t=!0);if(!t&&n.modify)for(const t of Object.keys(n.modify))delete n.modify[t][e];t||(n.remove?n.remove.includes(e)||n.remove.push(e):n.remove=[e])}return n}static mergeStaticChangesets(e,t){var n;if(i.default(e))return t;if(i.default(t))return e;const r=e;for(const[e,o]of Object.entries(t))for(const[t,i]of Object.entries(o))void 0!==(null===(n=null==r?void 0:r[e])||void 0===n?void 0:n[t])&&void 0!==i&&(r[e][t]=i);return r}static setValueInChangeset(e,t,n,r,o){const i=e;if(void 0!==o)if("remove"===t){const e=i[t];void 0===e?i[t]=[r]:e.push(r)}else{const e=i[t];void 0===e?i[t]={[n]:{[r]:o}}:e&&void 0===e[n]?e[n]={[r]:o}:e[n][r]=o}}static cleanupChangeSet(e){if(i.default(e))return e;if(!a.isChangeSet(e))throw new Error("[cleanupChangeset] The object passed is not a changeset");const t=s.default(e);return t.insert&&(t.insert=o.default(t.insert,i.default)),t.modify&&(t.modify=o.default(t.modify,i.default)),o.default(t,i.default)}static normalizeChangeset(e){var t;if(i.default(e))return e;if(!a.isChangeSet(e))throw new Error("[normalizeChangeSet] Cannot normalize input: Not a changeset.");const n={insert:e.insert};if(void 0!==e.modify)if(void 0===n.insert)n.insert=e.modify;else for(const[r,o]of Object.entries(e.modify))if(void 0===(null===(t=n.insert)||void 0===t?void 0:t[r]))n.insert[r]=o;else for(const[e,t]of Object.entries(o))a.isChangeSet(t)?n.insert[r][e]=this.normalizeChangeset(t):n.insert[r][e]=t;return n}static mergeAndNormalizeChangesetList(e){return ChangesetMerger.normalizeChangeset(ChangesetMerger.mergeChangesetList(e))}}t.ChangesetMerger=ChangesetMerger},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeSet=function isChangeSet(e){return e.insert||e.modify||e.remove}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r={type:"staticData.metadata.type"};t.getKeyMapper=e=>r[e]||e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_QUERY_USER_LIMIT=100,t.QUERY_BUFFER_SIZE=512},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(24),i=n(374),s=n(84),a=n(2);class SnapshotQueriesRegistry{static getLocally(e,t,n){return r(this,void 0,void 0,(function*(){return s.EntityQueriesRegistry.getLocally(e,t,SnapshotQueriesRegistry.packageSnapshot,n)}))}static queryLocally(e,t,n){return r(this,void 0,void 0,(function*(){return s.EntityQueriesRegistry.queryLocally(e,t,{customKeyMapper:SnapshotQueriesRegistry.customKeyMapper,customComparisonResolver:SnapshotQueriesRegistry.customComparisonResolver,packageEntity:SnapshotQueriesRegistry.packageSnapshot,entityType:"Snapshot",nativeKeys:SnapshotQueriesRegistry.nativeKeys},n)}))}}t.SnapshotQueriesRegistry=SnapshotQueriesRegistry,SnapshotQueriesRegistry.nativeKeys=[...s.EntityQueriesRegistry.nativeKeys,"snapshotId"],SnapshotQueriesRegistry.customKeyMapper=e=>"snapshotId"===e?["entityId","entityPermanentId"]:s.EntityQueriesRegistry.customKeyMapper(e),SnapshotQueriesRegistry.customComparisonResolver=(e,t)=>{if("asset.id"===e||"asset.revision.id"===e)return(n,r,o,s)=>{const a=s(n,e);return"$eq"===t?a.includes(o):"$ne"===t?a.some(e=>!o.includes(e)):"$in"===t?a.some(e=>o.includes(e)):i.comparisonOperators[t]}},SnapshotQueriesRegistry.packageSnapshot=(e,t,n)=>{const r=o.OfflineEntityWrapper.initialize(e),i=e.entityPermanentId||e.permanentId;return n&&n.forEach(e=>{if("snapshot_assets"!==e&&"snapshot_components"!==e&&"snapshot_attributes"!==e)throw new a.SDKError("With status: 400. Invalid include "+e)}),{id:i||e.entityId,parentId:r.getParentId(),components:!n||n.includes("snapshot_components")?r.getFullComponentView():void 0,attributes:!n||n.includes("snapshot_attributes")?r.getAttributes():void 0,revisionId:e.revisionId,typeid:r.getTypeId(),spaceCollectionId:t,assets:r.getAssets(),createdBy:r.getCreatedBy(),lastModifiedBy:r.getLastModifiedBy()}}},function(e,t){var n=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=/^(?:0|[1-9]\d*)$/,a=parseInt,c=Object.prototype.toString,u=Math.ceil,l=Math.max;function baseSlice(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(o);++r<o;)i[r]=e[r+t];return i}function isIterateeCall(e,t,n){if(!isObject(n))return!1;var r=typeof t;return!!("number"==r?function isArrayLike(e){return null!=e&&function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!function isFunction(e){var t=isObject(e)?c.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)}(n)&&function isIndex(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||s.test(e))&&e>-1&&e%1==0&&e<t}(t,n.length):"string"==r&&t in n)&&function eq(e,t){return e===t||e!=e&&t!=t}(n[t],e)}function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function chunk(e,t,s){t=(s?isIterateeCall(e,t,s):void 0===t)?1:l(function toInteger(e){var t=function toFinite(e){if(!e)return 0===e?e:0;if((e=function toNumber(e){if("number"==typeof e)return e;if(function isSymbol(e){return"symbol"==typeof e||function isObjectLike(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==c.call(e)}(e))return NaN;if(isObject(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var s=o.test(e);return s||i.test(e)?a(e.slice(2),s?2:8):r.test(e)?NaN:+e}(e))===1/0||e===-1/0){return 17976931348623157e292*(e<0?-1:1)}return e==e?e:0}(e),s=t%1;return t==t?s?t-s:t:0}(t),0);var d=e?e.length:0;if(!d||t<1)return[];for(var p=0,h=0,m=Array(u(d/t));p<d;)m[h++]=baseSlice(e,p,p+=t);return m}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(380),t),o(n(999),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Command=void 0;t.Command=class Command{constructor(e,t){this.id=e,this.journalStore=t}async getData(){return this.journalStore.getCommand(this.id)}async getCommandName(){return(await this.getData()).commandName}async getParameters(){return(await this.getData()).parameters}getLocalIdStore(){return this.journalStore.getCommandLocalIdStore(this.id)}setLocalIdStore(e){return this.journalStore.setCommandLocalIdStore(this.id,e)}async getModifiedEntities(){return this.journalStore.getCommandModifiedEntities(this.id)}async addInputEntities(e){await this.journalStore.addCommandInputEntities(this.id,e)}async addModifiedEntity(e){var t,n;const r={};r[e.entityId]=e.revisionId,await(null===(n=(t=this.journalStore).addCommandModifiedEntities)||void 0===n?void 0:n.call(t,this.id,r))}async setStatus(e){await this.journalStore.updateCommand(this.id,{status:e})}async getJournalId(){const{journalId:e}=await this.getData();return e}}},function(e,t){var n=e.exports=function(e){return new Traverse(e)};function Traverse(e){this.value=e}function walk(e,t,n){var s=[],a=[],c=!0;return function walker(e){var u=n?copy(e):e,l={},d=!0,p={node:u,node_:e,path:[].concat(s),parent:a[a.length-1],parents:a,key:s.slice(-1)[0],isRoot:0===s.length,level:s.length,circular:null,update:function(e,t){p.isRoot||(p.parent.node[p.key]=e),p.node=e,t&&(d=!1)},delete:function(e){delete p.parent.node[p.key],e&&(d=!1)},remove:function(e){o(p.parent.node)?p.parent.node.splice(p.key,1):delete p.parent.node[p.key],e&&(d=!1)},keys:null,before:function(e){l.before=e},after:function(e){l.after=e},pre:function(e){l.pre=e},post:function(e){l.post=e},stop:function(){c=!1},block:function(){d=!1}};if(!c)return p;function updateState(){if("object"==typeof p.node&&null!==p.node){p.keys&&p.node_===p.node||(p.keys=r(p.node)),p.isLeaf=0==p.keys.length;for(var t=0;t<a.length;t++)if(a[t].node_===e){p.circular=a[t];break}}else p.isLeaf=!0,p.keys=null;p.notLeaf=!p.isLeaf,p.notRoot=!p.isRoot}updateState();var h=t.call(p,p.node);return void 0!==h&&p.update&&p.update(h),l.before&&l.before.call(p,p.node),d?("object"!=typeof p.node||null===p.node||p.circular||(a.push(p),updateState(),forEach(p.keys,(function(e,t){s.push(e),l.pre&&l.pre.call(p,p.node[e],e);var r=walker(p.node[e]);n&&i.call(p.node,e)&&(p.node[e]=r.node),r.isLast=t==p.keys.length-1,r.isFirst=0==t,l.post&&l.post.call(p,r),s.pop()})),a.pop()),l.after&&l.after.call(p,p.node),p):p}(e).node}function copy(e){if("object"==typeof e&&null!==e){var t;if(o(e))t=[];else if(function isDate(e){return"[object Date]"===toS(e)}(e))t=new Date(e.getTime?e.getTime():e);else if(function isRegExp(e){return"[object RegExp]"===toS(e)}(e))t=new RegExp(e);else if(function isError(e){return"[object Error]"===toS(e)}(e))t={message:e.message};else if(function isBoolean(e){return"[object Boolean]"===toS(e)}(e))t=new Boolean(e);else if(function isNumber(e){return"[object Number]"===toS(e)}(e))t=new Number(e);else if(function isString(e){return"[object String]"===toS(e)}(e))t=new String(e);else if(Object.create&&Object.getPrototypeOf)t=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)t={};else{var n=e.constructor&&e.constructor.prototype||e.__proto__||{},T=function(){};T.prototype=n,t=new T}return forEach(r(e),(function(n){t[n]=e[n]})),t}return e}Traverse.prototype.get=function(e){for(var t=this.value,n=0;n<e.length;n++){var r=e[n];if(!t||!i.call(t,r)){t=void 0;break}t=t[r]}return t},Traverse.prototype.has=function(e){for(var t=this.value,n=0;n<e.length;n++){var r=e[n];if(!t||!i.call(t,r))return!1;t=t[r]}return!0},Traverse.prototype.set=function(e,t){for(var n=this.value,r=0;r<e.length-1;r++){var o=e[r];i.call(n,o)||(n[o]={}),n=n[o]}return n[e[r]]=t,t},Traverse.prototype.map=function(e){return walk(this.value,e,!0)},Traverse.prototype.forEach=function(e){return this.value=walk(this.value,e,!1),this.value},Traverse.prototype.reduce=function(e,t){var n=1===arguments.length,r=n?this.value:t;return this.forEach((function(t){this.isRoot&&n||(r=e.call(this,r,t))})),r},Traverse.prototype.paths=function(){var e=[];return this.forEach((function(t){e.push(this.path)})),e},Traverse.prototype.nodes=function(){var e=[];return this.forEach((function(t){e.push(this.node)})),e},Traverse.prototype.clone=function(){var e=[],t=[];return function clone(n){for(var o=0;o<e.length;o++)if(e[o]===n)return t[o];if("object"==typeof n&&null!==n){var i=copy(n);return e.push(n),t.push(i),forEach(r(n),(function(e){i[e]=clone(n[e])})),e.pop(),t.pop(),i}return n}(this.value)};var r=Object.keys||function keys(e){var t=[];for(var n in e)t.push(n);return t};function toS(e){return Object.prototype.toString.call(e)}var o=Array.isArray||function isArray(e){return"[object Array]"===Object.prototype.toString.call(e)},forEach=function(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n++)t(e[n],n,e)};forEach(r(Traverse.prototype),(function(e){n[e]=function(t){var n=[].slice.call(arguments,1),r=new Traverse(t);return r[e].apply(r,n)}}));var i=Object.hasOwnProperty||function(e,t){return t in e}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(143),i=n(66),s=n(6),a=n(102),c=n(86),u=n(26),l=n(2),d=n(81),p=n(111);class Space extends o.AccessControlEntity{constructor(e,t,n,r){super(e,t,n,r),this.permissionContexts=this.propertyFactory.create("NodeProperty"),this.permissionContexts.clean(),this.permissionContexts.addOnDirtyListener(this.propertyListener.bind(this))}isDirty(){return super.isDirty()||this.permissionContexts.isDirty}getCreateCommands(){const e=s.CommandParametersAdapter.toCreateSpace(this.serialize());return this.attachAdditionalDataToParameters(e),[new p.CreateEntityBlueprint(this,u.CreateSpaceCommandName,e)]}getUpdateCommands(){const e=s.CommandParametersAdapter.toUpdateSpace(this.serialize());return this.attachAdditionalDataToParameters(e),[new p.UpdateEntityBlueprint(this,u.UpdateSpaceCommandName,e)]}move(e){return r(this,void 0,void 0,(function*(){const t=s.extractId(e),n=s.extractId(this.spaceCollectionId),r={spaceCollectionId:n,resourceId:n,toSpaceCollectionId:t,entitiesToMove:[this.getId()]},o={commandName:u.MoveSpaceBatchCommandName,parameters:r,dependsOn:void 0},i=yield this.sdkCore.getDataConnector().handleSingleEntityCommands([o],r.spaceCollectionId);if(!i)throw new l.InternalError("Move was called within a subbatch. This should not happen.");return s.throwServerErrorIfNecessary(i),this.spaceCollectionId=t,this.upgrade(i),i}))}copy(e){return r(this,void 0,void 0,(function*(){const t=s.extractId(this.spaceCollectionId),n=e?s.extractId(e):t,r={spaceCollectionId:t,resourceId:t,toSpaceCollectionId:n,entitiesToCopy:[this.getId()]},o={commandName:u.CopySpaceCommandName,parameters:r,dependsOn:void 0},a=yield this.sdkCore.getDataConnector().handleSingleEntityCommands([o],r.spaceCollectionId);if(!a)throw new l.InternalError("Move was called within a subbatch. This should not happen.");s.throwServerErrorIfNecessary(a);const c=a.successes[0];return this.sdkCore.buildModel(i.spaceTypeId,this.typeid,c.resourceId,n,{initialData:{spaceCollectionId:n},fetched:!1,revisionId:c.revisionId})}))}getRevisions(e={}){const t=(new s.QueryRequestParamsBuilder).filter(e.filter).sort(e.sort).limit(e.limit).param("spaceCollectionId",s.extractId(this.spaceCollectionId)).param("id",this.id).build();return new c.SpaceRevisionsQueryResult(this.sdkCore,t)}fetchPayload(e){return r(this,void 0,void 0,(function*(){return Space.fetchPayload(this.sdkCore,{spaceCollectionId:s.extractId(this.spaceCollectionId),id:this.id,revisionId:e||!this.revisionId?void 0:this.revisionId})}))}static fetchPayload(e,t){return r(this,void 0,void 0,(function*(){return e.getDataConnector().journalQuery(u.GetSpaceQueryName,t)}))}createAsset(e=i.assetTypeId){return this.sdkCore.buildModel(i.assetTypeId,e,"",this.spaceCollectionId,{initialData:{spaceId:this,spaceCollectionId:this.spaceCollectionId},fetched:!1})}getAssets(e={}){const t=(new s.QueryRequestParamsBuilder).filter(new a.FiltersBuilder(e.filter).appendCondition("spaceId",this.id)).sort(e.sort).limit(e.limit).param("spaceCollectionId",s.extractId(this.spaceCollectionId)).build();return new c.AssetsQueryResult(this.sdkCore,t)}addPermissionContext(e,t,n){if(this.permissionContexts.has(e))throw new l.SDKError(`A permission context with name "${e}" already exists on this resource.`);const r=this.sdkCore.propertyFactory.create(d.permissionContextSchema.typeid,"single",{type:t,value:n});this.permissionContexts.insert(e,r)}modifyPermissionContext(e,t){if(void 0===this.permissionContexts.get(e))throw new l.SDKError(`A permission context with name: ${e} does not exist on this resource.`);this.permissionContexts.get(e).setValues({value:t})}removePermissionContext(e){if(void 0===this.permissionContexts.get(e))throw new l.SDKError(`A permission context with name: ${e} does not exist on this resource.`);this.permissionContexts.remove(e)}refreshPermissionContext(){return r(this,void 0,void 0,(function*(){const e=s.extractId(this.spaceCollectionId),t={spaceCollectionId:e,resourceId:this.getId()},n={commandName:u.RefreshPoliciesCommandName,parameters:t,dependsOn:void 0};return this.sdkCore.getDataConnector().handleSingleEntityCommands([n],e)}))}serialize(){const e=super.serialize();return e.permissionContext=this.permissionContexts.serialize().serializedChangeSet,e}getDeleteCommand(){const e={spaceCollectionId:s.extractId(this.spaceCollectionId),resourceId:this.getId()};return{commandName:u.DeleteSpaceCommandName,parameters:e,dependsOn:void 0}}getPurgeCommand(){const e={spaceCollectionId:s.extractId(this.spaceCollectionId),resourceId:this.getId()};return{commandName:u.PurgeSpaceCommandName,parameters:e,dependsOn:void 0}}restoreInternal(){const e={spaceCollectionId:s.extractId(this.spaceCollectionId),resourceId:this.getId()};return{commandName:u.RestoreSpaceCommandName,parameters:e,dependsOn:void 0}}clearData(){super.clearData(),this.permissionContexts=this.propertyFactory.create("NodeProperty"),this.permissionContexts.clean(),this.permissionContexts.addOnDirtyListener(this.propertyListener.bind(this))}cleanDirtyness(){super.cleanDirtyness(),this.permissionContexts=this.propertyFactory.create("NodeProperty"),this.permissionContexts.clean(),this.permissionContexts.addOnDirtyListener(this.propertyListener.bind(this))}}t.Space=Space},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(87);class AssetQueryPage extends r.QueryPage{constructor(e,t,n,r,o){super(e,n,r,o),this.assets=t}getAssets(){return this.assets}}t.AssetQueryPage=AssetQueryPage},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(1027)),__export(n(1028)),__export(n(1029)),__export(n(1034)),__export(n(1035)),__export(n(1036)),__export(n(1037)),__export(n(31))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(393);class CreateEntityBlueprint extends r.EntityBlueprint{getCreatedEntities(){return[this.entity]}getCreationIdentifier(e){return`$.${this.getCommandId()}.result.resourceId`}getRevisionIdentifier(e){return`$.${this.getCommandId()}.result.revisionId`}}t.CreateEntityBlueprint=CreateEntityBlueprint},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);t.CommandBlueprint=class CommandBlueprint{assignCommandId(e){if(void 0!==this.assignedId)throw new r.InternalError("Cannot mutate a blueprint's command id");this.assignedId=e}getCommandId(){if(void 0===this.assignedId)throw new r.InternalError("Getting a command blueprint's command Id before it was assigned");return this.assignedId}getCreationIdentifier(e){throw new r.InternalError("No resources are created by this blueprint")}getRevisionIdentifier(e){throw new r.InternalError("No resources are revised by this blueprint")}getCreatedEntities(){return[]}getRevisedEntities(){return this.getCreatedEntities()}getRedefinedEntities(){return[]}canDependOnPreviousBatches(e){return!1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PIM_CONTAINS_RELATIONSHIP_TYPENAME="autodesk.product:relationship.contains",t.PIM_ASSEMBLYREF_RELATIONSHIP_TYPENAME="autodesk.product:relationship.assemblyRef",t.PIM_DESCRIBES_RELATIONSHIP_TYPENAME="autodesk.product:relationship.describes",t.PIM_USE_RELATIONSHIP_TYPENAME="autodesk.product:relationship.use",t.PIM_DESIGN_ASSETS_TYPENAME="autodesk.product:assets.design",t.PIM_DOCUMENTATION_ASSETS_TYPENAME="autodesk.product:assets.documentation",t.PIM_DRAWING_ASSETS_TYPENAME="autodesk.product:assets.drawing",t.PIM_MILESTONE_ASSETS_TYPENAME="autodesk.product:assets.milestone",t.PIM_MODEL_ASSETS_TYPENAME="autodesk.product:assets.model",t.PIM_PRODUCT_ASSETS_TYPENAME="autodesk.product:assets.product",t.PIM_RELEASE_ASSETS_TYPENAME="autodesk.product:assets.release",t.PIM_SHEETS_ASSETS_TYPENAME="autodesk.product:assets.sheets",t.PIM_LIFECYCLE_ASSETS_TYPENAME="autodesk.product:assets.lifecycle",t.PIM_MILESTONE_COMPONENTS_TYPENAME="autodesk.product:components.milestone",t.PIM_REVISION_COMPONENTS_TYPENAME="autodesk.product:components.revision",t.PIM_VERSION_COMPONENTS_TYPENAME="autodesk.product:components.version",t.PIM_SNAPSHOT_COMPONENTS_TYPENAME="autodesk.product:components.snapshot"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1),o={[r.PIM_FAMILY.ASSEMBLY_REF]:r.schemaTypes.Product_RelationshipAssemblyRef_V1_0_0,[r.PIM_FAMILY.ASSEMBLY_REF]:r.schemaTypes.Product_RelationshipAssemblyRef_V1_0_0,[r.PIM_FAMILY.CAM]:r.schemaTypes.Product_AssetsCam_V2_0_0,[r.PIM_FAMILY.CONTAINED]:r.schemaTypes.Product_RelationshipContained_V2_0_0,[r.PIM_FAMILY.CONTAINS]:r.schemaTypes.Product_RelationshipContains_V2_0_0,[r.PIM_FAMILY.DESIGN]:r.schemaTypes.Product_AssetsDesign_V5_0_0,[r.PIM_FAMILY.DRAWING]:r.schemaTypes.Product_AssetsDrawing_V2_0_0,[r.PIM_FAMILY.ITEM]:r.schemaTypes.Product_AssetsItem_V1_0_0,[r.PIM_FAMILY.MODEL]:r.schemaTypes.Product_AssetsModel_V1_0_0,[r.PIM_FAMILY.LIFECYCLE]:r.schemaTypes.Product_AssetsLifecycle_V2_0_0,[r.PIM_FAMILY.PRODUCT]:r.schemaTypes.Product_AssetsProduct_V3_0_0,[r.PIM_FAMILY.RELEASE]:r.schemaTypes.Product_AssetsRelease_V2_0_0,[r.PIM_FAMILY.SNAPSHOT]:r.schemaTypes.Product_Snapshot_V1_0_0,[r.PIM_FAMILY.USE]:r.schemaTypes.Product_RelationshipUse_V1_0_0,[r.PIM_FAMILY.XREF]:r.schemaTypes.Product_RelationshipXRef_V2_0_0,[r.PIM_FAMILY.PROCESS]:r.schemaTypes.Product_AssetgraphProcess_V1_0_0,[r.PIM_COMPONENT_FAMILY.ACE_MANAGED_EXTENSION]:r.schemaTypes.Data_ComponentsAceManageExtensionWorkspace_V2_0_0,[r.PIM_COMPONENT_FAMILY.CAM]:r.schemaTypes.Product_ComponentsCam_V2_0_0,[r.PIM_COMPONENT_FAMILY.COMPONENT_INSTANCE]:r.schemaTypes.Product_ComponentsComponentInstance_V1_0_0,[r.PIM_COMPONENT_FAMILY.DELETE_STATUS]:r.schemaTypes.Product_ComponentsDeleteStatus_V1_0_0,[r.PIM_COMPONENT_FAMILY.DRAWING]:r.schemaTypes.Product_ComponentsDrawing_V2_0_0,[r.PIM_COMPONENT_FAMILY.ECO]:r.schemaTypes.Product_ComponentsEco_V1_0_0,[r.PIM_COMPONENT_FAMILY.ERROR]:r.schemaTypes.Product_ComponentsError_V1_0_0,[r.PIM_COMPONENT_FAMILY.INTERNAL_COMPONENT]:r.schemaTypes.Product_ComponentsInternalComponent_V2_0_0,[r.PIM_COMPONENT_FAMILY.INTERNAL_FLAG]:r.schemaTypes.Product_ComponentsInternalFlag_V1_0_0,[r.PIM_COMPONENT_FAMILY.ITEM_NUMBER]:r.schemaTypes.Product_ComponentsItemNumber_V1_0_0,[r.PIM_COMPONENT_FAMILY.LIFECYCLE]:r.schemaTypes.Product_ComponentsLifecycle_V1_1_0,[r.PIM_COMPONENT_FAMILY.MATERIAL]:r.schemaTypes.Product_ComponentsMaterial_V1_0_0,[r.PIM_COMPONENT_FAMILY.MILESTONE]:r.schemaTypes.Product_ComponentsMilestone_V2_0_0,[r.PIM_COMPONENT_FAMILY.NAME]:r.schemaTypes.Product_ComponentsName_V1_0_0,[r.PIM_COMPONENT_FAMILY.PART_NUMBER]:r.schemaTypes.Product_ComponentsPartNumber_V2_0_0,[r.PIM_COMPONENT_FAMILY.PHYSICAL_PROPERTIES]:r.schemaTypes.Product_ComponentsPhysicalProperties_V5_0_0,[r.PIM_COMPONENT_FAMILY.PRODUCT]:r.schemaTypes.Product_ComponentsProduct_V3_0_0,[r.PIM_COMPONENT_FAMILY.RELEASE]:r.schemaTypes.Product_ComponentsRelease_V2_0_0,[r.PIM_COMPONENT_FAMILY.REVISION]:r.schemaTypes.Product_ComponentsRevision_V1_0_0,[r.PIM_COMPONENT_FAMILY.VERSION]:r.schemaTypes.Product_ComponentsVersion_V1_0_0,[r.PIM_COMPONENT_FAMILY.SNAPSHOT]:r.schemaTypes.Product_ComponentsSnapshot_V1_0_0,[r.PIM_COMPONENT_FAMILY.TRANSFORMATION]:r.schemaTypes.Product_ComponentsTransformation_V1_0_0,[r.PIM_COMPONENT_FAMILY.WIP_REFERENCE]:r.schemaTypes.Product_ComponentsWIPReference_V1_0_0,[r.PIM_FAMILY.DOCUMENTATION]:r.schemaTypes.Product_AssetsDocumentation_V1_0_0,[r.PIM_FAMILY.SHEETS]:r.schemaTypes.Product_AssetsSheets_V1_0_0,[r.PIM_FAMILY.DERIVED]:r.schemaTypes.Product_RelationshipDerived_V1_0_0,[r.PIM_FAMILY.DESCRIBES]:r.schemaTypes.Product_RelationshipDescribes_V1_0_0,[r.PIM_COMPONENT_FAMILY.UNKNOWN]:r.schemaTypes.Data_Component_V1_0_0,[r.PIM_FAMILY.MILESTONE]:r.schemaTypes.Product_AssetsMilestone_V1_0_0,[r.PIM_COMPONENT_FAMILY.ERROR_STATUS]:r.schemaTypes.Product_ComponentsErrorStatus_V1_0_0},i=Object.assign(Object.assign({},o),{[r.PIM_FAMILY.CAM]:r.schemaTypes.Product_AssetsCam_V3_0_0,[r.PIM_FAMILY.DESIGN]:r.schemaTypes.Product_AssetsDesign_V6_0_0,[r.PIM_FAMILY.DRAWING]:r.schemaTypes.Product_AssetsDrawing_V3_0_0,[r.PIM_FAMILY.MODEL]:r.schemaTypes.Product_AssetsModel_V2_0_0,[r.PIM_FAMILY.DOCUMENTATION]:r.schemaTypes.Product_AssetsDocumentation_V1_0_0,[r.PIM_FAMILY.PRODUCT]:r.schemaTypes.Product_AssetsProduct_V4_0_0,[r.PIM_FAMILY.SHEETS]:r.schemaTypes.Product_AssetsSheets_V1_0_0,[r.PIM_FAMILY.DERIVED]:r.schemaTypes.Product_RelationshipDerived_V1_0_0,[r.PIM_FAMILY.DESCRIBES]:r.schemaTypes.Product_RelationshipDescribes_V1_0_0,[r.PIM_COMPONENT_FAMILY.PART_NUMBER]:r.schemaTypes.Product_ComponentsPartNumber_V2_1_0,[r.PIM_COMPONENT_FAMILY.WIP_REFERENCE]:r.schemaTypes.Product_ComponentsWIPReference_V2_0_0,[r.PIM_COMPONENT_FAMILY.ERROR_STATUS]:r.schemaTypes.Product_ComponentsErrorStatus_V1_0_0,[r.PIM_COMPONENT_FAMILY.DELETE_STATUS]:r.schemaTypes.Product_ComponentsDeleteStatus_V1_1_0});t.SchemasVersions={[r.PIM_SCHEMAS_VERSIONS.VERSION_0_1_0]:o,[r.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0]:i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(112),o=n(68);t.setEntityAttribute=function setEntityAttribute(e,t,n,i){if(void 0!==e.getAttribute(t)){if(i&&i!==e.getAttributeTypeId(t))throw new r.PimError(o.GEN_INCOMPATIBLE_TYPEID);e.updateAttribute(t,n||"")}else e.createAttribute(t,i||"String",n||"")},t.removeEntityAttribute=function removeEntityAttribute(e,t){void 0!==e.getAttribute(t)&&e.removeAttribute(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(9),o=n(22),i=n(1);t.getSheetsFromLineage=async function getSheetsFromLineage(e,t,n){t=await r.toSpaceCollection(e,t,{fetch:!1});const s=await o.getAllPages(t.getAssets({filter:{"attribute.wipLineageUrn":n,"type.name":i.PIM_SHEETS_ASSETS_TYPENAME}}),"getAssets");return s.length?s:void 0}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.PIM="PIM",e.LEGACY="LEGACY",e.ALL="ALL"}(t.MILESTONE_SCOPES||(t.MILESTONE_SCOPES={})),function(e){e.GENERATE_ITEM_NUMBER="GenerateManageItemNumber",e.QUICK_RELEASE_ASSET="QuickReleaseAsset",e.CREATE_MILESTONE="CreateMilestone",e.UPDATE_MILESTONE="UpdateMilestone"}(r=t.COMMANDS_NAMES||(t.COMMANDS_NAMES={})),t.PIM_ENTITY_INIT_STATUS_KEY="initStatus",function(e){e.Unknown="unknown",e.Pending="pending",e.Ready=""}(t.PIMEntityInitStatus||(t.PIMEntityInitStatus={}));class PIMCommandDefinition{constructor(e,t,n){this.commandType=e,this.payload=t,this.requestContext=n}}t.PIMCommandDefinition=PIMCommandDefinition;t.GenerateItemNumberCommandDefinition=class GenerateItemNumberCommandDefinition extends PIMCommandDefinition{constructor(e,t){super(r.GENERATE_ITEM_NUMBER,e,t)}};t.QuickReleaseCommandDefinition=class QuickReleaseCommandDefinition extends PIMCommandDefinition{constructor(e,t){super(r.QUICK_RELEASE_ASSET,e,t)}};t.CreateMilestoneCommandDefinition=class CreateMilestoneCommandDefinition extends PIMCommandDefinition{constructor(e,t){super(r.CREATE_MILESTONE,e,t)}};t.UpdateMilestoneCommandDefinition=class UpdateMilestoneCommandDefinition extends PIMCommandDefinition{constructor(e,t){super(r.UPDATE_MILESTONE,e,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(489);t.getProductStructurePayload=function getProductStructurePayload(e,t,n){const o=r.getPimSchemaFactory(e);return{product:o.getProductPayload(t),design:o.getDesignPayload(t),model:o.getModelPayload(t,n)}},t.getErrorProductStructurePayload=function getErrorProductStructurePayload(e,t,n){const o=r.getPimSchemaFactory(e);return{product:o.getProductPayload(t),design:o.getDesignPayload(t),model:o.getErrorModelPayload(t,n)}},t.getDocumentationStructurePayload=function getDocumentationStructurePayload(e,t){const n=r.getPimSchemaFactory(e);return{documentation:n.getDocumentationPayload(),drawing:n.getDrawingPayload(t),sheets:n.getSheetsPayload(t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1),i=n(22),s=n(9),a=n(7),c=n(494);async function getVersionSnapshots(e,t,n,r){const a=await s.toSpaceCollection(e,t),c={"attribute.wipVersionUrn":n};c["has.component.type.name"]=r?o.PIM_SNAPSHOT_COMPONENTS_TYPENAME:o.PIM_VERSION_COMPONENTS_TYPENAME;const u=a.getSnapshots({filter:c,limit:5}),l=await i.getAllPages(u,"getSnapshots",5),d=[];return l.forEach(e=>{"versionSnapshot"===e.getAttribute("name")&&d.push(e)}),d}async function getVersionSnapshot(e,t,n,r){const log=t=>{e._pimData&&e._pimData.logger(t)},o=await getVersionSnapshots(e,t,n,r);if(0!==o.length)return 1!==o.length&&log(`[getVersionSnapshot]: Found ${o.length} snapshots for wipVersionUrn ${n} in spaceCollection ${t}`),c.decideVersionSnapshotToUse(o,r);log("[getVersionSnapshot]: Found no snapshots")}a.failIfExistsOnSDK("pimGetVersionSnapshot"),t.getVersionSnapshots=getVersionSnapshots,t.getVersionSnapshot=getVersionSnapshot,r.FDModelingSDK.prototype.pimGetVersionSnapshot=async function(e,t,n){return await getVersionSnapshot(this,e,t,n)}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function bytesToUuid(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(4),o=n(1),i=n(242);function getModelPropsFromAsset(e,t,n){return e.pimGetSchemasVersion()===o.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0?function getModelPropsFromAsset_V1_0_0(e,t,n){const s=r.getFamilyFromTypeid(t.getTypeId()).family;if(s===o.PIM_FAMILY.PRODUCT){const r=e.pimGetComponentProxy(t,"partNumber");n[i.PIMModelDataPropKey.partName]=r.partName,n[i.PIMModelDataPropKey.partNumber]=r.partNumber,n[i.PIMModelDataPropKey.description]=r.description}else if(s===o.PIM_FAMILY.DESIGN){const r=e.pimGetComponentProxy(t,"material");n[i.PIMModelDataPropKey.material]=r.name}}(e,t,n):function getModelPropsFromAsset_V0_1_0(e,t,n){const s=r.getFamilyFromTypeid(t.getTypeId()).family;if(s===o.PIM_FAMILY.PRODUCT){const r=e.pimGetComponentProxy(t,"partNumber",o.schemaTypes.Product_ComponentsPartNumber_V2_0_0);n[i.PIMModelDataPropKey.partName]=r.partName,n[i.PIMModelDataPropKey.partNumber]=r.partNumber;const s=e.pimGetComponentProxy(t,"product",o.schemaTypes.Product_ComponentsProduct_V3_0_0);n[i.PIMModelDataPropKey.description]=s.description}else if(s===o.PIM_FAMILY.DESIGN){const r=e.pimGetComponentProxy(t,"physicalProperties",o.schemaTypes.Product_ComponentsPhysicalProperties_V5_0_0);n[i.PIMModelDataPropKey.material]=r.material}}(e,t,n)}function getModelDataProps(e,t){const n={};for(const r of Object.keys(t)){const o=t[r],i={};for(const t of o)getModelPropsFromAsset(e,t,i);n[r]=i}return n}function getModelAssets(e,t){const n=new Map;for(const e of t){r.getFamilyFromTypeid(e.getTypeId()).family===o.PIM_FAMILY.MODEL&&n.set(e.getId(),e)}return n}async function getConflictModelDataFromAssets(e,t){const n={};if(0==t.length)return n;const r={};for(const e of t){const t=(await e.getSpace({fetch:!1})).getId();r[t]?r[t].push(e):r[t]=[e]}return n.properties=getModelDataProps(e,r),n.modelsWithCad=getModelAssets(0,t),n.spaceAndAssets=r,n}t.getModelDataProps=getModelDataProps,t.getModelAssets=getModelAssets,t.getConflictModelDataFromAssets=getConflictModelDataFromAssets,t.getConflictModelData=async function getConflictModelData(e,t,n){let o=await async function getSnapshotAssets(e){const t=await r.getAllPages(e.getAssets({include:["attributes","components"]}),"getAssets");return await Promise.all(t.map(async e=>await e.fetch())),t}(t);return n&&n.advanceToLatest&&(o=await Promise.all(o.map(e=>e.getLatestAsset({fetch:!0})))),await getConflictModelDataFromAssets(e,o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.partName="partName",e.partNumber="partNumber",e.description="description",e.material="material"}(t.PIMModelDataPropKey||(t.PIMModelDataPropKey={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1196);var o;!function(e){e.STATUS="status",e.ENABLE_JOURNAL="journalReordering",e.HELP="help",e.DIFF="diff",e.WAIT="wait"}(o=t.FremontTextCommands||(t.FremontTextCommands={})),t.FremontTextCommandRegistry={[o.ENABLE_JOURNAL]:{handler:r.journalReorderingTextCommandHandler,description:"Enable/Disable journal reordering. If no parameter is provided, will return the current state.",parameters:["on","off"]},[o.STATUS]:{handler:r.statusTextCommandHandler,description:"Show status of FremontJS (sync, states, versionInfo, queue, featureflag)."},[o.HELP]:{handler:r.helpReorderingTextCommandHandler,description:"Show this message."},[o.DIFF]:{handler:r.diffTextCommandHandler,description:"Return yes/no if remote and local are equal."},[o.WAIT]:{handler:r.waitTextCommandHandler,description:"Block until pim is in a useable state."}},t.getTextCommand=function getTextCommand(e){const n=e;return t.FremontTextCommandRegistry[n]}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.STARTED="Started",e.COMPLETED="Completed",e.FAILED="Failed"}(t.SyncStatus||(t.SyncStatus={})),function(e){e.SYNC_STATUS="syncStatus",e.REFRESH_TOKEN="refreshToken",e.MILESTONE="milestoneCreated"}(r=t.MessageEvent||(t.MessageEvent={}));class MessageService{constructor(e){MessageService._socket=e}sendMessage(e,t,n){MessageService._socket?n?MessageService._socket.emit(e,t,n):MessageService._socket.emit(e,t):console.log("No socket define. Cannot send message")}sendSyncStatus(e){this.sendMessage(r.SYNC_STATUS,{message:"Sync "+e})}sendMilestoneResponse(e){this.sendMessage(r.MILESTONE,e)}}t.MessageService=MessageService},function(e,t,n){var r=n(1210),o=n(496),i=o;i.v1=r,i.v4=o,e.exports=i},function(e,t,n){e.exports=minimatch,minimatch.Minimatch=Minimatch;var r={sep:"/"};try{r=n(11)}catch(e){}var o=minimatch.GLOBSTAR=Minimatch.GLOBSTAR={},i=n(1217),s={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},a=function charSet(e){return e.split("").reduce((function(e,t){return e[t]=!0,e}),{})}("().*{}+?[]^$\\!");var c=/\/+/;function ext(e,t){e=e||{},t=t||{};var n={};return Object.keys(t).forEach((function(e){n[e]=t[e]})),Object.keys(e).forEach((function(t){n[t]=e[t]})),n}function minimatch(e,t,n){if("string"!=typeof t)throw new TypeError("glob pattern string required");return n||(n={}),!(!n.nocomment&&"#"===t.charAt(0))&&(""===t.trim()?""===e:new Minimatch(t,n).match(e))}function Minimatch(e,t){if(!(this instanceof Minimatch))return new Minimatch(e,t);if("string"!=typeof e)throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),"/"!==r.sep&&(e=e.split(r.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function braceExpand(e,t){if(t||(t=this instanceof Minimatch?this.options:{}),void 0===(e=void 0===e?this.pattern:e))throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:i(e)}minimatch.filter=function filter(e,t){return t=t||{},function(n,r,o){return minimatch(n,e,t)}},minimatch.defaults=function(e){if(!e||!Object.keys(e).length)return minimatch;var t=minimatch,n=function minimatch(n,r,o){return t.minimatch(n,r,ext(e,o))};return n.Minimatch=function Minimatch(n,r){return new t.Minimatch(n,ext(e,r))},n},Minimatch.defaults=function(e){return e&&Object.keys(e).length?minimatch.defaults(e).Minimatch:Minimatch},Minimatch.prototype.debug=function(){},Minimatch.prototype.make=function make(){if(this._made)return;var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();var n=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error);this.debug(this.pattern,n),n=this.globParts=n.map((function(e){return e.split(c)})),this.debug(this.pattern,n),n=n.map((function(e,t,n){return e.map(this.parse,this)}),this),this.debug(this.pattern,n),n=n.filter((function(e){return-1===e.indexOf(!1)})),this.debug(this.pattern,n),this.set=n},Minimatch.prototype.parseNegate=function parseNegate(){var e=this.pattern,t=!1,n=this.options,r=0;if(n.nonegate)return;for(var o=0,i=e.length;o<i&&"!"===e.charAt(o);o++)t=!t,r++;r&&(this.pattern=e.substr(r));this.negate=t},minimatch.braceExpand=function(e,t){return braceExpand(e,t)},Minimatch.prototype.braceExpand=braceExpand,Minimatch.prototype.parse=function parse(e,t){if(e.length>65536)throw new TypeError("pattern is too long");var n=this.options;if(!n.noglobstar&&"**"===e)return o;if(""===e)return"";var r,i="",c=!!n.nocase,l=!1,d=[],p=[],h=!1,m=-1,y=-1,g="."===e.charAt(0)?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",_=this;function clearStateChar(){if(r){switch(r){case"*":i+="[^/]*?",c=!0;break;case"?":i+="[^/]",c=!0;break;default:i+="\\"+r}_.debug("clearStateChar %j %j",r,i),r=!1}}for(var v,E=0,I=e.length;E<I&&(v=e.charAt(E));E++)if(this.debug("%s\t%s %s %j",e,E,i,v),l&&a[v])i+="\\"+v,l=!1;else switch(v){case"/":return!1;case"\\":clearStateChar(),l=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,E,i,v),h){this.debug("  in class"),"!"===v&&E===y+1&&(v="^"),i+=v;continue}_.debug("call clearStateChar %j",r),clearStateChar(),r=v,n.noext&&clearStateChar();continue;case"(":if(h){i+="(";continue}if(!r){i+="\\(";continue}d.push({type:r,start:E-1,reStart:i.length,open:s[r].open,close:s[r].close}),i+="!"===r?"(?:(?!(?:":"(?:",this.debug("plType %j %j",r,i),r=!1;continue;case")":if(h||!d.length){i+="\\)";continue}clearStateChar(),c=!0;var b=d.pop();i+=b.close,"!"===b.type&&p.push(b),b.reEnd=i.length;continue;case"|":if(h||!d.length||l){i+="\\|",l=!1;continue}clearStateChar(),i+="|";continue;case"[":if(clearStateChar(),h){i+="\\"+v;continue}h=!0,y=E,m=i.length,i+=v;continue;case"]":if(E===y+1||!h){i+="\\"+v,l=!1;continue}if(h){var S=e.substring(y+1,E);try{RegExp("["+S+"]")}catch(e){var C=this.parse(S,u);i=i.substr(0,m)+"\\["+C[0]+"\\]",c=c||C[1],h=!1;continue}}c=!0,h=!1,i+=v;continue;default:clearStateChar(),l?l=!1:!a[v]||"^"===v&&h||(i+="\\"),i+=v}h&&(S=e.substr(y+1),C=this.parse(S,u),i=i.substr(0,m)+"\\["+C[0],c=c||C[1]);for(b=d.pop();b;b=d.pop()){var w=i.slice(b.reStart+b.open.length);this.debug("setting tail",i,b),w=w.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(e,t,n){return n||(n="\\"),t+t+n+"|"})),this.debug("tail=%j\n   %s",w,w,b,i);var A="*"===b.type?"[^/]*?":"?"===b.type?"[^/]":"\\"+b.type;c=!0,i=i.slice(0,b.reStart)+A+"\\("+w}clearStateChar(),l&&(i+="\\\\");var O=!1;switch(i.charAt(0)){case".":case"[":case"(":O=!0}for(var P=p.length-1;P>-1;P--){var D=p[P],x=i.slice(0,D.reStart),R=i.slice(D.reStart,D.reEnd-8),N=i.slice(D.reEnd-8,D.reEnd),M=i.slice(D.reEnd);N+=M;var L=x.split("(").length-1,j=M;for(E=0;E<L;E++)j=j.replace(/\)[+*?]?/,"");var k="";""===(M=j)&&t!==u&&(k="$"),i=x+R+M+k+N}""!==i&&c&&(i="(?=.)"+i);O&&(i=g+i);if(t===u)return[i,c];if(!c)return function globUnescape(e){return e.replace(/\\(.)/g,"$1")}(e);var F=n.nocase?"i":"";try{var U=new RegExp("^"+i+"$",F)}catch(e){return new RegExp("$.")}return U._glob=e,U._src=i,U};var u={};minimatch.makeRe=function(e,t){return new Minimatch(e,t||{}).makeRe()},Minimatch.prototype.makeRe=function makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,n=t.noglobstar?"[^/]*?":t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",r=t.nocase?"i":"",i=e.map((function(e){return e.map((function(e){return e===o?n:"string"==typeof e?function regExpEscape(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(e):e._src})).join("\\/")})).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,r)}catch(e){this.regexp=!1}return this.regexp},minimatch.match=function(e,t,n){var r=new Minimatch(t,n=n||{});return e=e.filter((function(e){return r.match(e)})),r.options.nonull&&!e.length&&e.push(t),e},Minimatch.prototype.match=function match(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var n=this.options;"/"!==r.sep&&(e=e.split(r.sep).join("/"));e=e.split(c),this.debug(this.pattern,"split",e);var o,i,s=this.set;for(this.debug(this.pattern,"set",s),i=e.length-1;i>=0&&!(o=e[i]);i--);for(i=0;i<s.length;i++){var a=s[i],u=e;if(n.matchBase&&1===a.length&&(u=[o]),this.matchOne(u,a,t))return!!n.flipNegate||!this.negate}return!n.flipNegate&&this.negate},Minimatch.prototype.matchOne=function(e,t,n){var r=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var i=0,s=0,a=e.length,c=t.length;i<a&&s<c;i++,s++){this.debug("matchOne loop");var u,l=t[s],d=e[i];if(this.debug(t,l,d),!1===l)return!1;if(l===o){this.debug("GLOBSTAR",[t,l,d]);var p=i,h=s+1;if(h===c){for(this.debug("** at the end");i<a;i++)if("."===e[i]||".."===e[i]||!r.dot&&"."===e[i].charAt(0))return!1;return!0}for(;p<a;){var m=e[p];if(this.debug("\nglobstar while",e,p,t,h,m),this.matchOne(e.slice(p),t.slice(h),n))return this.debug("globstar found match!",p,a,m),!0;if("."===m||".."===m||!r.dot&&"."===m.charAt(0)){this.debug("dot detected!",e,p,t,h);break}this.debug("globstar swallow a segment, and continue"),p++}return!(!n||(this.debug("\n>>> no match, partial?",e,p,t,h),p!==a))}if("string"==typeof l?(u=r.nocase?d.toLowerCase()===l.toLowerCase():d===l,this.debug("string match",l,d,u)):(u=d.match(l),this.debug("pattern match",l,d,u)),!u)return!1}if(i===a&&s===c)return!0;if(i===a)return n;if(s===c)return i===a-1&&""===e[i];throw new Error("wtf?")}},function(e,t,n){"use strict";function posix(e){return"/"===e.charAt(0)}function win32(e){var t=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(e),n=t[1]||"",r=Boolean(n&&":"!==n.charAt(1));return Boolean(t[2]||r)}e.exports="win32"===process.platform?win32:posix,e.exports.posix=posix,e.exports.win32=win32},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IDENTIFIERS=t.DEFAULT_PRIORITY_QUEUE_WORKER_SIZE=t.ENTITY_FILTER_LIMIT=t.SYNC_ENTITY_LIMIT=t.MAX_SPACE_CHUNK_SIZE=void 0,t.MAX_SPACE_CHUNK_SIZE=20,t.SYNC_ENTITY_LIMIT=50,t.ENTITY_FILTER_LIMIT=50,t.DEFAULT_PRIORITY_QUEUE_WORKER_SIZE=20,function(e){e.TOKENS="tokens",e.SPACES="spaces",e.ASSETS="assets",e.SNAPSHOTS="snapshots",e.RELATIONSHIPS="relationships",e.COLLECTIONS="collections"}(t.IDENTIFIERS||(t.IDENTIFIERS={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeset=void 0,t.isChangeset=function isChangeset(e){return e.insert||e.modify||e.remove}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SqliteUtils=void 0;const r=n(85),o={$eq:"=",$gt:">",$gte:">=",$lt:"<",$lte:"<=",$ne:"!=",$in:"IN",$nin:"NOT IN",$like:"LIKE"},i={$or:" OR ",$and:" AND "},s=["NOT IN","!="],a={removed:e=>e?1:0},c={journalId:"command.journalId as journalId",commandId:"command.commandId as commandId",commandName:"commandName",status:"status",modifiedDate:"modifiedDate",parameters:"parameters",dependsOn:"commandDependencies.dependencyId as dependsOn",inputEntities:"commandInputEntity.entityId as inputEntities",modifiedEntities:"COALESCE(entity.permanentId, entity.localId) as modifiedEntities"},u={dependsOn:" JOIN commandDependencies ON command.commandId = commandDependencies.commandId ",inputEntities:" JOIN commandInputEntity ON command.commandId = commandInputEntity.commandId ",modifiedEntities:" JOIN entityRevision ON command.commandId = entityRevision.commandId\n  LEFT JOIN entity ON entityRevision.entityIdx = entity.entityIdx "},l={dependsOn:" AND (\n    SELECT count(1)\n    FROM commandDependencies\n    WHERE commandDependencies.commandId = command.commandId\n      AND commandDependencies.dependencyId IN (<<-LIST->>)\n  ) = <<-LENGTH->> ",inputEntities:" AND (\n    SELECT count(1)\n    FROM commandInputEntity\n    WHERE commandInputEntity.commandId = command.commandId\n      AND commandInputEntity.entityId IN (<<-LIST->>)\n  ) = <<-LENGTH->> ",modifiedEntities:" AND (\n      SELECT count(1)\n      FROM entityRevision\n      INNER JOIN entity ON entityRevision.entityIdx = entity.entityIdx \n      WHERE entityRevision.commandId = command.commandId\n      AND COALESCE(entity.permanentId, entity.localId) IN (<<-LIST->>)\n    ) = <<-LENGTH->> "};class SqliteUtils{static async getEntityIdxFromEntityId(e,t){return new Promise((n,r)=>{e.get("SELECT entityIdx from entity where permanentId = ? OR localId = ?",[t,t],(e,t)=>{e?r(e):n(t?t.entityIdx:t)})})}static async getLastEntityRevIdForJournalId(e,t,n){return new Promise((r,o)=>{e.get("SELECT revisionId from entityRevision where entityIdx = ? AND journalId = ?\n      ORDER BY revisionDate DESC LIMIT 1",[t,n],(e,t)=>{e?o(e):r(t?t.revisionId:t)})})}static async getEntityFromEntityId(e,t){return new Promise((n,r)=>{e.get("SELECT * from entity where permanentId = ? OR localId = ?",[t,t],(e,t)=>{e?r(e):n(t)})})}static doesJournalExist(e,t){return SqliteUtils.doesJournalsExist(e,t)}static async doesJournalsExist(e,...t){return new Promise((n,r)=>{e.get("SELECT COUNT(*) as c FROM journal where "+t.map(()=>"journalId = ?").join(" OR "),t,(e,o)=>{e?r(e):n(o.c===t.length)})})}static async doesCommandExist(e,t){return new Promise((n,r)=>{e.get("SELECT 1 FROM command where commandId = ?",[t],(e,t)=>{e?r(e):n(!!t)})})}static async getParentJournalId(e,t){return new Promise((n,r)=>{e.get("SELECT parentJournalId FROM journal where journalId = ?",[t],(e,t)=>{e?r(e):n(t?t.parentJournalId:t)})})}static sortToSQL(e,t={mappingFields:{},allowedFields:[]}){if(!e)return"";return(Array.isArray(e)?e:Object.entries(e)).map(e=>{var n,o,i,s,a,c,u,l,d;if("string"==typeof e){if(e.startsWith("-")){const s=null!==(n=SqliteUtils.keyToJsonData(e.substr(1),t))&&void 0!==n?n:e.substr(1);if(!SqliteUtils.isFieldAllowed(s,null!==(o=t.allowedFields)&&void 0!==o?o:[]))throw new r.StoreError(r.ErrorCode.L5_ENTITY_QUERY_FIELD_NOT_ALLOWED,`Field ${s} is not allowed.`);return(t.mappingFields&&null!==(i=t.mappingFields[s])&&void 0!==i?i:s)+" DESC"}const u=e.startsWith("+")?e.substr(1):e,l=null!==(s=SqliteUtils.keyToJsonData(u,t))&&void 0!==s?s:u;if(!SqliteUtils.isFieldAllowed(l,null!==(a=t.allowedFields)&&void 0!==a?a:[]))throw new r.StoreError(r.ErrorCode.L5_ENTITY_QUERY_FIELD_NOT_ALLOWED,`Field ${l} is not allowed.`);return(t.mappingFields&&null!==(c=t.mappingFields[l])&&void 0!==c?c:l)+" ASC"}const p=null!==(u=SqliteUtils.keyToJsonData(e[0],t))&&void 0!==u?u:e[0];if(!SqliteUtils.isFieldAllowed(p,null!==(l=t.allowedFields)&&void 0!==l?l:[]))throw new r.StoreError(r.ErrorCode.L5_ENTITY_QUERY_FIELD_NOT_ALLOWED,`Field ${p} is not allowed.`);return`${t.mappingFields&&null!==(d=t.mappingFields[p])&&void 0!==d?d:p} ${e[1].toUpperCase()}`}).join(", ")}static filtersToSQL(e,t={nullableFields:[],mappingFields:{}}){if(!e)return"";const n=Object.keys(i);return Object.entries(e).map(([e,r])=>n.includes(e)?`(${r.map(e=>`(${SqliteUtils.filtersToSQL(e,t)})`).join(i[e])})`:r&&"object"==typeof r?SqliteUtils.comparisonToSQL(e,r,t):SqliteUtils.valueToSQL(e,r,"$eq",t)).join(" AND ")}static getFiltersFields(e){if(!e)return[];const t=Object.values(e).map(e=>e&&"object"==typeof e?SqliteUtils.getFiltersFields(e):(Array.isArray(e)&&e.map(e=>SqliteUtils.getFiltersFields(e)),"")),n=Object.keys(o).concat(Object.keys(i));return(Array.isArray(e)?[]:Object.keys(e)).concat(...t).filter(e=>e&&!n.includes(e))}static isFieldAllowed(e,t){return e.startsWith("json_extract")||t.includes(e)}static valuesToSQL(e,t,n,i){var a,c,u;const l=SqliteUtils.keyToJsonData(e,i);if(!SqliteUtils.isFieldAllowed(null!=l?l:e,null!==(a=i.allowedFields)&&void 0!==a?a:[]))throw new r.StoreError(r.ErrorCode.L5_ENTITY_QUERY_FIELD_NOT_ALLOWED,`Field ${l} is not allowed.`);const d=o[n],p=""+t.map(t=>""+SqliteUtils.transformFieldValue(e,t)).join(","),h=null!=l?l:i.mappingFields&&null!==(c=i.mappingFields[e])&&void 0!==c?c:e,m=`${h} ${d} (${p})`;return s.includes(d)&&(null===(u=i.nullableFields)||void 0===u?void 0:u.includes(e))?`(${h} IS NULL OR ${m})`:m}static valueToSQL(e,t,n="$eq",i){var a,c,u;const l=SqliteUtils.keyToJsonData(e,i);if(!SqliteUtils.isFieldAllowed(null!=l?l:e,null!==(a=i.allowedFields)&&void 0!==a?a:[]))throw new r.StoreError(r.ErrorCode.L5_ENTITY_QUERY_FIELD_NOT_ALLOWED,`Field ${l} is not allowed.`);const d=o[n];if(!d)throw new r.StoreError(r.ErrorCode.L5_QUERY_OPERATOR_NOT_SUPPORTED,`The operator ${n} is not supported.`);const p=SqliteUtils.transformFieldValue(e,t),h=null!=l?l:i.mappingFields&&null!==(c=i.mappingFields[e])&&void 0!==c?c:e,m=`${h} ${d} ${p}`;return s.includes(d)&&(null===(u=i.nullableFields)||void 0===u?void 0:u.includes(e))?`(${h} IS NULL OR ${m})`:m}static comparisonToSQL(e,t,n){return`(${Object.entries(t).map(([t,r])=>"$in"===t||"$nin"===t?SqliteUtils.valuesToSQL(e,r,t,n):SqliteUtils.valueToSQL(e,r,t,n)).join(" OR ")})`}static keyToJsonData(e,t){var n,r,o;let i;if(e.startsWith("data.")){const r=null===(n=t.mappingFields)||void 0===n?void 0:n.data;i=`json_extract(${null!=r?r:"data"}, '$.${e.substr(5)}')`}else if(e.startsWith("staticData.")){const n=null===(r=t.mappingFields)||void 0===r?void 0:r.staticData;i=`json_extract(${null!=n?n:"staticData"}, '$.${e.substr(11)}')`}else if(e.startsWith("properties.")){const n=null===(o=t.mappingFields)||void 0===o?void 0:o.properties;i=`json_extract(${null!=n?n:"properties"}, '$.${e.substr(11)}')`}return i}static transformFieldValue(e,t){return a[e]?a[e](t):"string"==typeof t?`'${t}'`:t}static getJoinTypeFromFilter(e){return e&&e.length>0?" INNER ":" LEFT "}static getMultipleValuesFieldSQLFilter(e,t){return e.replace("<<-LIST->>",t.map(e=>"?").join(", ")).replace("<<-LENGTH->>",t.length.toString())}static getSQLQueryFromJournalCommandFields(e,t,n){let r=`SELECT ${t.map(e=>c[e]).join(", ")} FROM command`;t.forEach(e=>{"dependsOn"===e&&(r+=SqliteUtils.getJoinTypeFromFilter(n.dependsOn),r+=u[e]),"inputEntities"===e&&(r+=SqliteUtils.getJoinTypeFromFilter(n.inputEntities),r+=u[e]),"modifiedEntities"===e&&(r+=SqliteUtils.getJoinTypeFromFilter(n.modifiedEntities),r+=u[e])});const o=[e];return r+=" WHERE command.journalId = ?",n.commandId&&(r+=" AND command.commandId = ?",o.push(n.commandId)),n.commandName&&(r+=" AND command.commandName = ?",o.push(n.commandName)),n.modifiedDate&&(r+=" AND command.modifiedDate = ?",o.push(new Date(n.modifiedDate).toISOString())),n.status&&(r+=" AND command.status = ?",o.push(n.status.toUpperCase())),n.dependsOn&&(r+=SqliteUtils.getMultipleValuesFieldSQLFilter(l.dependsOn,n.dependsOn),o.push(...n.dependsOn)),n.inputEntities&&(r+=SqliteUtils.getMultipleValuesFieldSQLFilter(l.inputEntities,n.inputEntities),o.push(...n.inputEntities)),n.modifiedEntities&&(r+=SqliteUtils.getMultipleValuesFieldSQLFilter(l.modifiedEntities,n.modifiedEntities),o.push(...n.modifiedEntities)),{sql:r,queryParams:o}}static splitFilters(e,t){return Object.entries(e).reduce((e,[n,r])=>(!function allIncludedInFilterNames(e,t){const n=Object.keys(i);for(const[r,o]of Object.entries(e))if(n.includes(r)){for(const e of o)if(!allIncludedInFilterNames(e,t))return!1}else if(!t.some(e=>r.startsWith(e+".")||e===r))return!1;return!0}({[n]:r},t)?e.others[n]=r:e.includeNames[n]=r,e),{includeNames:{},others:{}})}}t.SqliteUtils=SqliteUtils},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(287));t.retry=async(e,t)=>{t=Object.assign({retries:3,retryOn:e=>e.innerError&&"ServerError"===e.innerError.name},t);const{retries:n,retryOn:r}=t;return await o.default(async(t,n)=>{try{return await e()}catch(e){throw r&&!r(e,n)||t(e),e}},{retries:n})},t.sleep=async function sleep(e){return new Promise(t=>setTimeout(t,e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),o=n(71),i=n(119),s=n(44),a=n(5),c=n(53),u=n(72),l=n(92),d="documentUploaded";t.queueDocumentUploaded=async function queueDocumentUploaded(e,t,n,p){const h=await t.documentIdentityService.generateInvariantId(e,t,n.docId,n.newLineageUrn),m=s.queueFremontCommand(e,t,(async function documentPostUploadExecutor(e){const{data:t,context:n,options:s}=e;if(u.updateDocumentLastOperation(d,h,s.pimStateService,c.DocumentOperationState.UPLOADING),!s||!await a.getJournalService(n,s))throw console.log(`[${d}]: Journaling service is not defined. Cannot handle event.`),new Error("[documentUploaded]: Journaling service is not defined. Cannot handle event.");if(!h)throw new Error(`[${d}]: Missing invariant id.`);let l={};try{const r=await a.getOrCreateSdkInstance(e.context,e.options);if(!r)return console.log("[documentUploaded]: No SDKInstance found. Cannot handle event."),{};l=await i.onPostUpload(n,r,p,t)}catch(i){console.log(`[${d}]: Error uploading design ${e.data.newLineageUrn}`);const c=await a.getPIMSDK(n,s),u=s.pimStateService.getMilestone(h);throw u.create&&(o.createMilestoneAndSendResponse(c,s.messageService,n.spaceCollectionId,u,t.newVersionUrn,r.MILESTONE_SCOPES.LEGACY),s.pimStateService.setMilestone(h,{create:!1})),i}return console.log(`[${d}]: Finished upload for ${t.newLineageUrn} version ${t.newVersionUrn}`),l}),{scId:e.spaceCollectionId,data:n,context:e,options:t,lineageUrn:n.newLineageUrn,docId:n.docId,hubFallbackMigrationTrigger:!0});return l.invokeStateHandler(d,c.DocumentOperationState.UPLOADED,e,t,m,h).catch(e=>{console.log(`[${d}]: Failed while trying to update state for\n       document id: ${h}. Error - `,e)}),m}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(44),o=n(119),i=n(5),s=n(53),a=n(72),c=n(92);t.queuePreDocumentUpload=async function queuePreDocumentUpload(e,t,n,u){const l=await t.documentIdentityService.generateInvariantId(e,t,n.docId,n.lineageUrn),d=r.queueFremontCommand(e,t,(async function documentPreUploadExecutor(n){if(console.log("[preDocumentUpload]: Received event"),a.updateDocumentLastOperation("preDocumentUpload",l,t.pimStateService,s.DocumentOperationState.PREUPLOADING),!n.options||!await i.getJournalService(n.context,n.options)){throw new Error("[preDocumentUpload]: Journaling service is not defined. Cannot handle event.")}const r=await i.getOrCreateSdkInstance(n.context,n.options);if(!r)return console.log("[preDocumentUpload]: No SDKInstance found. Cannot handle event."),{};const c=await o.onPreUpload(e,r,u,n.data);return console.log("[preDocumentUpload] Finished for "+n.data.docId),c}),{scId:e.spaceCollectionId,data:n,context:e,options:t,lineageUrn:n.lineageUrn,docId:n.docId});return c.invokeStateHandler("preDocumentUpload",s.DocumentOperationState.PREUPLOADED,e,t,d,l).catch(e=>{console.log(`[preDocumentUpload]: Failed while trying to update state for\n       document id: ${l}. Error - `,e)}),d}},function(e,t,n){"use strict";const r=n(20),o=n(1322),i={annotations:Symbol("joi-annotations"),stringify:function(e,n){const r=typeof e;if(null===e)return"null";if("string"===r)return e;if(e instanceof t.Err||"function"===r||"symbol"===r)return e.toString();if("object"===r){if(Array.isArray(e)){let t="";for(let r=0;r<e.length;++r)t=t+(t.length?", ":"")+i.stringify(e[r],n);return n?"["+t+"]":t}return e.toString()}return JSON.stringify(e)}};t.Err=class{constructor(e,t,n,r,i,s,a){this.isJoi=!0,this.type=e,this.context=t||{},this.context.key=n.path[n.path.length-1],this.context.label=n.key,this.path=n.path,this.options=r,this.flags=i,this.message=s,this.template=a;const c=this.options.language;this.flags.label?this.context.label=this.flags.label:!c||""!==this.context.label&&null!==this.context.label||(this.context.label=c.root||o.errors.root)}toString(){if(this.message)return this.message;let e;this.template&&(e=this.template);const t=this.options.language;if(e=e||r.reach(t,this.type)||r.reach(o.errors,this.type),void 0===e)return`Error code "${this.type}" is not defined, your custom type is missing the correct language definition`;let n=r.reach(t,"messages.wrapArrays");if("boolean"!=typeof n&&(n=o.errors.messages.wrapArrays),null===e){const e=i.stringify(this.context.reason,n);return n?e.slice(1,-1):e}const s=/{{!?label}}/.test(e),a=e.length>2&&"!"===e[0]&&"!"===e[1];if(a&&(e=e.slice(2)),!s&&!a){const n=r.reach(t,"key");e="string"==typeof n?n+e:r.reach(o.errors,"key")+e}const c=e.replace(/{{(!?)([^}]+)}}/g,(e,t,o)=>{const s=r.reach(this.context,o),a=i.stringify(s,n);return t&&this.options.escapeHtml?r.escapeHtml(a):a});return this.toString=()=>c,c}},t.create=function(e,n,r,o,i,s,a){return new t.Err(e,n,r,o,i,s,a)},t.process=function(e,t){if(!e)return null;let n="";const r=[],processErrors=function(e,t,o){for(let i=0;i<e.length;++i){const s=e[i];if(s instanceof Error)return s;if(s.flags.error&&"function"!=typeof s.flags.error&&(!s.flags.selfError||!s.context.reason))return s.flags.error;let a;if(void 0===t&&(a=s.toString(),n=n+(n?". ":"")+a),s.context.reason){const e=processErrors(s.context.reason,s.path,"override"===s.type?s.message:null);if(e)return e}else r.push({message:o||a||s.toString(),path:s.path,type:s.type,context:s.context})}},o=processErrors(e);if(o)return o;const s=new Error(n);return s.isJoi=!0,s.name="ValidationError",s.details=r,s._object=t,s.annotate=i.annotate,s},i.safeStringify=function(e,t){return JSON.stringify(e,i.serializer(),t)},i.serializer=function(){const e=[],t=[],cycleReplacer=(n,r)=>t[0]===r?"[Circular ~]":"[Circular ~."+e.slice(0,t.indexOf(r)).join(".")+"]";return function(n,r){if(t.length>0){const o=t.indexOf(this);~o?(t.length=o+1,e.length=o+1,e[o]=n):(t.push(this),e.push(n)),~t.indexOf(r)&&(r=cycleReplacer.call(this,n,r))}else t.push(r);if(r){const e=r[i.annotations];if(e){if(Array.isArray(r)){const t=[];for(let n=0;n<r.length;++n)e.errors[n]&&t.push(`_$idx$_${e.errors[n].sort().join(", ")}_$end$_`),t.push(r[n]);r=t}else{const t=Object.keys(e.errors);for(let n=0;n<t.length;++n){const o=t[n];r[`${o}_$key$_${e.errors[o].sort().join(", ")}_$end$_`]=r[o],r[o]=void 0}const n=Object.keys(e.missing);for(let t=0;t<n.length;++t){const o=n[t];r[`_$miss$_${o}|${e.missing[o]}_$end$_`]="__missing__"}}return r}}return r===1/0||r===-1/0||Number.isNaN(r)||"function"==typeof r||"symbol"==typeof r?"["+r.toString()+"]":r}},i.annotate=function(e){const t=e?"":"[31m",n=e?"":"[41m",o=e?"":"[0m";if("object"!=typeof this._object)return this.details[0].message;const s=r.clone(this._object||{});for(let e=this.details.length-1;e>=0;--e){const t=e+1,n=this.details[e],r=n.path;let o=s;for(let e=0;;++e){const s=r[e];if(o.isImmutable&&(o=o.clone()),!(e+1<r.length&&o[s]&&"string"!=typeof o[s])){const e=o[i.annotations]=o[i.annotations]||{errors:{},missing:{}},r=o[s],a=s||n.context.label;void 0!==r?(e.errors[a]=e.errors[a]||[],e.errors[a].push(t)):e.missing[a]=t;break}o=o[s]}}const a=/_\$key\$_([, \d]+)_\$end\$_"/g,c=/"_\$miss\$_([^|]+)\|(\d+)_\$end\$_": "__missing__"/g,u=/\s*"_\$idx\$_([, \d]+)_\$end\$_",?\n(.*)/g,l=/"\[(NaN|Symbol.*|-?Infinity|function.*|\(.*)]"/g;let d=i.safeStringify(s,2).replace(a,(e,n)=>`" ${t}[${n}]${o}`).replace(c,(e,r,i)=>`${n}"${r}"${o}${t} [${i}]: -- missing --${o}`).replace(u,(e,n,r)=>`\n${r} ${t}[${n}]${o}`).replace(l,(e,t)=>t);d=`${d}\n${t}`;for(let e=0;e<this.details.length;++e){d=`${d}\n[${e+1}] ${this.details[e].message}`}return d+=o,d}},function(e,t,n){"use strict";e.exports=class{constructor(e,t,n,r){this.key=e,this.path=t,this.parent=n,this.reference=r}}},function(e,t,n){var r=n(558),o=n(575);e.exports=t={polling:function polling(e){return"string"==typeof e._query.j?new o(e):new r(e)},websocket:n(576)},t.polling.upgradesTo=["websocket"]},function(e,t,n){var r=n(177),o=n(122),i=n(125),s=n(566),a=n(12),c=n(93)("engine:polling"),u={gzip:i.createGzip,deflate:i.createDeflate};function Polling(e){r.call(this,e),this.closeTimeout=3e4,this.maxHttpBufferSize=null,this.httpCompression=null}e.exports=Polling,a.inherits(Polling,r),Polling.prototype.name="polling",Polling.prototype.onRequest=function(e){var t=e.res;"GET"===e.method?this.onPollRequest(e,t):"POST"===e.method?this.onDataRequest(e,t):(t.writeHead(500),t.end())},Polling.prototype.onPollRequest=function(e,t){if(this.req)return c("request overlap"),this.onError("overlap from client"),t.writeHead(500),void t.end();c("setting request"),this.req=e,this.res=t;var n=this;function onClose(){n.onError("poll connection closed prematurely")}e.cleanup=function cleanup(){e.removeListener("close",onClose),n.req=n.res=null},e.on("close",onClose),this.writable=!0,this.emit("drain"),this.writable&&this.shouldClose&&(c("triggering empty send to append close packet"),this.send([{type:"noop"}]))},Polling.prototype.onDataRequest=function(e,t){if(this.dataReq)return this.onError("data request overlap from client"),t.writeHead(500),void t.end();var n="application/octet-stream"===e.headers["content-type"];this.dataReq=e,this.dataRes=t;var r=n?Buffer.concat([]):"",o=this;function cleanup(){e.removeListener("data",onData),e.removeListener("end",onEnd),e.removeListener("close",onClose),o.dataReq=o.dataRes=r=null}function onClose(){cleanup(),o.onError("data request connection closed prematurely")}function onData(t){var i;n?i=(r=Buffer.concat([r,t])).length:(r+=t,i=Buffer.byteLength(r)),i>o.maxHttpBufferSize&&(r=n?Buffer.concat([]):"",e.connection.destroy())}function onEnd(){o.onData(r);t.writeHead(200,o.headers(e,{"Content-Type":"text/html","Content-Length":2})),t.end("ok"),cleanup()}e.on("close",onClose),n||e.setEncoding("utf8"),e.on("data",onData),e.on("end",onEnd)},Polling.prototype.onData=function(e){c('received "%s"',e);var t=this;o.decodePayload(e,(function(e){if("close"===e.type)return c("got xhr close packet"),t.onClose(),!1;t.onPacket(e)}))},Polling.prototype.onClose=function(){this.writable&&this.send([{type:"noop"}]),r.prototype.onClose.call(this)},Polling.prototype.send=function(e){this.writable=!1,this.shouldClose&&(c("appending close packet to payload"),e.push({type:"close"}),this.shouldClose(),this.shouldClose=null);var t=this;o.encodePayload(e,this.supportsBinary,(function(n){var r=e.some((function(e){return e.options&&e.options.compress}));t.write(n,{compress:r})}))},Polling.prototype.write=function(e,t){c('writing "%s"',e);var n=this;this.doWrite(e,t,(function(){n.req.cleanup()}))},Polling.prototype.doWrite=function(e,t,n){var r=this,o="string"==typeof e,i={"Content-Type":o?"text/plain; charset=UTF-8":"application/octet-stream"};if(this.httpCompression&&t.compress)if((o?Buffer.byteLength(e):e.length)<this.httpCompression.threshold)respond(e);else{var a=s(this.req).encodings(["gzip","deflate"]);a?this.compress(e,a,(function(e,t){if(e)return r.res.writeHead(500),r.res.end(),void n(e);i["Content-Encoding"]=a,respond(t)})):respond(e)}else respond(e);function respond(e){i["Content-Length"]="string"==typeof e?Buffer.byteLength(e):e.length,r.res.writeHead(200,r.headers(r.req,i)),r.res.end(e),n()}},Polling.prototype.compress=function(e,t,n){c("compressing");var r=[],o=0;u[t](this.httpCompression).on("error",n).on("data",(function(e){r.push(e),o+=e.length})).on("end",(function(){n(null,Buffer.concat(r,o))})).end(e)},Polling.prototype.doClose=function(e){c("closing");var t,n=this;function onClose(){clearTimeout(t),e(),n.onClose()}this.dataReq&&(c("aborting ongoing data request"),this.dataReq.destroy()),this.writable?(c("transport writable - closing right away"),this.send([{type:"close"}]),onClose()):this.discarded?(c("transport discarded - closing right away"),onClose()):(c("transport not writable - buffering orderly close"),this.shouldClose=onClose,t=setTimeout(onClose,this.closeTimeout))},Polling.prototype.headers=function(e,t){t=t||{};var n=e.headers["user-agent"];return n&&(~n.indexOf(";MSIE")||~n.indexOf("Trident/"))&&(t["X-XSS-Protection"]="0"),this.emit("headers",t),t}},function(e,t,n){function createDebug(e){var n;function debug(){if(debug.enabled){var e=debug,r=+new Date,o=r-(n||r);e.diff=o,e.prev=n,e.curr=r,n=r;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var a=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;a++;var o=t.formatters[r];if("function"==typeof o){var s=i[a];n=o.call(e,s),i.splice(a,1),a--}return n})),t.formatArgs.call(e,i);var c=debug.log||t.log||console.log.bind(console);c.apply(e,i)}}return debug.namespace=e,debug.enabled=t.enabled(e),debug.useColors=t.useColors(),debug.color=function selectColor(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),debug.destroy=destroy,"function"==typeof t.init&&t.init(debug),t.instances.push(debug),debug}function destroy(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=createDebug.debug=createDebug.default=createDebug).coerce=function coerce(e){return e instanceof Error?e.stack||e.message:e},t.disable=function disable(){t.enable("")},t.enable=function enable(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function enabled(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(564),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,n){var r=n(29).EventEmitter,o=n(12),i=n(93)("engine:socket");function Socket(e,t,n,r){this.id=e,this.server=t,this.upgrading=!1,this.upgraded=!1,this.readyState="opening",this.writeBuffer=[],this.packetsFn=[],this.sentCallbackFn=[],this.cleanupFn=[],this.request=r,r.websocket&&r.websocket._socket?this.remoteAddress=r.websocket._socket.remoteAddress:this.remoteAddress=r.connection.remoteAddress,this.checkIntervalTimer=null,this.upgradeTimeoutTimer=null,this.pingTimeoutTimer=null,this.setTransport(n),this.onOpen()}e.exports=Socket,o.inherits(Socket,r),Socket.prototype.onOpen=function(){this.readyState="open",this.transport.sid=this.id,this.sendPacket("open",JSON.stringify({sid:this.id,upgrades:this.getAvailableUpgrades(),pingInterval:this.server.pingInterval,pingTimeout:this.server.pingTimeout})),this.server.initialPacket&&this.sendPacket("message",this.server.initialPacket),this.emit("open"),this.setPingTimeout()},Socket.prototype.onPacket=function(e){if("open"===this.readyState)switch(i("packet"),this.emit("packet",e),this.setPingTimeout(),e.type){case"ping":i("got ping"),this.sendPacket("pong"),this.emit("heartbeat");break;case"error":this.onClose("parse error");break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else i("packet received with closed socket")},Socket.prototype.onError=function(e){i("transport error"),this.onClose("transport error",e)},Socket.prototype.setPingTimeout=function(){var e=this;clearTimeout(e.pingTimeoutTimer),e.pingTimeoutTimer=setTimeout((function(){e.onClose("ping timeout")}),e.server.pingInterval+e.server.pingTimeout)},Socket.prototype.setTransport=function(e){var t=this.onError.bind(this),n=this.onPacket.bind(this),r=this.flush.bind(this),o=this.onClose.bind(this,"transport close");this.transport=e,this.transport.once("error",t),this.transport.on("packet",n),this.transport.on("drain",r),this.transport.once("close",o),this.setupSendCallback(),this.cleanupFn.push((function(){e.removeListener("error",t),e.removeListener("packet",n),e.removeListener("drain",r),e.removeListener("close",o)}))},Socket.prototype.maybeUpgrade=function(e){i('might upgrade socket transport from "%s" to "%s"',this.transport.name,e.name),this.upgrading=!0;var t=this;function onPacket(n){"ping"===n.type&&"probe"===n.data?(e.send([{type:"pong",data:"probe"}]),t.emit("upgrading",e),clearInterval(t.checkIntervalTimer),t.checkIntervalTimer=setInterval(check,100)):"upgrade"===n.type&&"closed"!==t.readyState?(i("got upgrade packet - upgrading"),cleanup(),t.transport.discard(),t.upgraded=!0,t.clearTransport(),t.setTransport(e),t.emit("upgrade",e),t.setPingTimeout(),t.flush(),"closing"===t.readyState&&e.close((function(){t.onClose("forced close")}))):(cleanup(),e.close())}function check(){"polling"===t.transport.name&&t.transport.writable&&(i("writing a noop packet to polling for fast upgrade"),t.transport.send([{type:"noop"}]))}function cleanup(){t.upgrading=!1,clearInterval(t.checkIntervalTimer),t.checkIntervalTimer=null,clearTimeout(t.upgradeTimeoutTimer),t.upgradeTimeoutTimer=null,e.removeListener("packet",onPacket),e.removeListener("close",onTransportClose),e.removeListener("error",onError),t.removeListener("close",onClose)}function onError(t){i("client did not complete upgrade - %s",t),cleanup(),e.close(),e=null}function onTransportClose(){onError("transport closed")}function onClose(){onError("socket closed")}t.upgradeTimeoutTimer=setTimeout((function(){i("client did not complete upgrade - closing transport"),cleanup(),"open"===e.readyState&&e.close()}),this.server.upgradeTimeout),e.on("packet",onPacket),e.once("close",onTransportClose),e.once("error",onError),t.once("close",onClose)},Socket.prototype.clearTransport=function(){for(var e=this.cleanupFn.length,t=0;t<e;t++)this.cleanupFn.shift()();this.transport.on("error",(function(){i("error triggered by discarded transport")})),this.transport.close(),clearTimeout(this.pingTimeoutTimer)},Socket.prototype.onClose=function(e,t){if("closed"!==this.readyState){this.readyState="closed",clearTimeout(this.pingTimeoutTimer),clearInterval(this.checkIntervalTimer),this.checkIntervalTimer=null,clearTimeout(this.upgradeTimeoutTimer);var n=this;process.nextTick((function(){n.writeBuffer=[]})),this.packetsFn=[],this.sentCallbackFn=[],this.clearTransport(),this.emit("close",e,t)}},Socket.prototype.setupSendCallback=function(){var e=this;function onDrain(){if(e.sentCallbackFn.length>0){var t=e.sentCallbackFn.splice(0,1)[0];if("function"==typeof t)i("executing send callback"),t(e.transport);else if(Array.isArray(t)){i("executing batch send callback");for(var n=t.length,r=0;r<n;r++)"function"==typeof t[r]&&t[r](e.transport)}}}this.transport.on("drain",onDrain),this.cleanupFn.push((function(){e.transport.removeListener("drain",onDrain)}))},Socket.prototype.send=Socket.prototype.write=function(e,t,n){return this.sendPacket("message",e,t,n),this},Socket.prototype.sendPacket=function(e,t,n,r){if("function"==typeof n&&(r=n,n=null),(n=n||{}).compress=!1!==n.compress,"closing"!==this.readyState&&"closed"!==this.readyState){i('sending packet "%s" (%s)',e,t);var o={type:e,options:n};t&&(o.data=t),this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.packetsFn.push(r),this.flush()}},Socket.prototype.flush=function(){if("closed"!==this.readyState&&this.transport.writable&&this.writeBuffer.length){i("flushing buffer to transport"),this.emit("flush",this.writeBuffer),this.server.emit("flush",this,this.writeBuffer);var e=this.writeBuffer;this.writeBuffer=[],this.transport.supportsFraming?this.sentCallbackFn.push.apply(this.sentCallbackFn,this.packetsFn):this.sentCallbackFn.push(this.packetsFn),this.packetsFn=[],this.transport.send(e),this.emit("drain"),this.server.emit("drain",this)}},Socket.prototype.getAvailableUpgrades=function(){for(var e=[],t=this.server.upgrades(this.transport.name),n=0,r=t.length;n<r;++n){var o=t[n];-1!==this.server.transports.indexOf(o)&&e.push(o)}return e},Socket.prototype.close=function(e){"open"===this.readyState&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",this.closeTransport.bind(this,e)):this.closeTransport(e))},Socket.prototype.closeTransport=function(e){e&&this.transport.discard(),this.transport.close(this.onClose.bind(this,"forced close"))}},function(e,t,n){"use strict";const r=n(29),o=n(16),i=n(261),s=n(57),a=n(37),c=n(51),u=n(126),l=n(580),d=n(263),p=n(127),h=n(264),m=n(266),y=[8,13];class WebSocket extends r{constructor(e,t,n){super(),t?"string"==typeof t?t=[t]:Array.isArray(t)||(n=t,t=[]):t=[],this.readyState=WebSocket.CONNECTING,this.bytesReceived=0,this.extensions={},this.protocol="",this._binaryType=p.BINARY_TYPES[0],this._finalize=this.finalize.bind(this),this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage="",this._closeTimer=null,this._finalized=!1,this._closeCode=1006,this._receiver=null,this._sender=null,this._socket=null,this._ultron=null,Array.isArray(e)?initAsServerClient.call(this,e[0],e[1],n):initAsClient.call(this,e,t,n)}get CONNECTING(){return WebSocket.CONNECTING}get CLOSING(){return WebSocket.CLOSING}get CLOSED(){return WebSocket.CLOSED}get OPEN(){return WebSocket.OPEN}get bufferedAmount(){var e=0;return this._socket&&(e=this._socket.bufferSize+this._sender._bufferedBytes),e}get binaryType(){return this._binaryType}set binaryType(e){p.BINARY_TYPES.indexOf(e)<0||(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}setSocket(e,t){e.setTimeout(0),e.setNoDelay(),this._receiver=new h(this.extensions,this._maxPayload,this.binaryType),this._sender=new m(e,this.extensions),this._ultron=new i(e),this._socket=e,this._ultron.on("close",this._finalize),this._ultron.on("error",this._finalize),this._ultron.on("end",this._finalize),t.length>0&&e.unshift(t),this._ultron.on("data",e=>{this.bytesReceived+=e.length,this._receiver.add(e)}),this._receiver.onmessage=e=>this.emit("message",e),this._receiver.onping=e=>{this.pong(e,!this._isServer,!0),this.emit("ping",e)},this._receiver.onpong=e=>this.emit("pong",e),this._receiver.onclose=(e,t)=>{this._closeFrameReceived=!0,this._closeMessage=t,this._closeCode=e,this._finalized||this.close(e,t)},this._receiver.onerror=(e,t)=>{this._closeMessage="",this._closeCode=t,this.readyState=WebSocket.CLOSING,this.emit("error",e),this.finalize(!0)},this.readyState=WebSocket.OPEN,this.emit("open")}finalize(e){if(!this._finalized){if(this.readyState=WebSocket.CLOSING,this._finalized=!0,"object"==typeof e&&this.emit("error",e),!this._socket)return this.emitClose();clearTimeout(this._closeTimer),this._closeTimer=null,this._ultron.destroy(),this._ultron=null,this._socket.on("error",p.NOOP),e?this._socket.destroy():this._socket.end(),this._socket=null,this._sender=null,this._receiver.cleanup(()=>this.emitClose()),this._receiver=null}}emitClose(){this.readyState=WebSocket.CLOSED,this.emit("close",this._closeCode,this._closeMessage),this.extensions[u.extensionName]&&this.extensions[u.extensionName].cleanup(),this.extensions=null,this.removeAllListeners()}pause(){if(this.readyState!==WebSocket.OPEN)throw new Error("not opened");this._socket.pause()}resume(){if(this.readyState!==WebSocket.OPEN)throw new Error("not opened");this._socket.resume()}close(e,t){if(this.readyState!==WebSocket.CLOSED)return this.readyState===WebSocket.CONNECTING?(this._req.abort(),void this.finalize(new Error("closed before the connection is established"))):void(this.readyState!==WebSocket.CLOSING?(this.readyState=WebSocket.CLOSING,this._sender.close(e,t,!this._isServer,e=>{e||(this._closeFrameSent=!0,this._finalized||(this._closeFrameReceived&&this._socket.end(),this._closeTimer=setTimeout(this._finalize,3e4,!0)))})):this._closeFrameSent&&this._closeFrameReceived&&this._socket.end())}ping(e,t,n){if(this.readyState!==WebSocket.OPEN){if(n)return;throw new Error("not opened")}"number"==typeof e&&(e=e.toString()),void 0===t&&(t=!this._isServer),this._sender.ping(e||p.EMPTY_BUFFER,t)}pong(e,t,n){if(this.readyState!==WebSocket.OPEN){if(n)return;throw new Error("not opened")}"number"==typeof e&&(e=e.toString()),void 0===t&&(t=!this._isServer),this._sender.pong(e||p.EMPTY_BUFFER,t)}send(e,t,n){if("function"==typeof t&&(n=t,t={}),this.readyState!==WebSocket.OPEN){if(!n)throw new Error("not opened");return void n(new Error("not opened"))}"number"==typeof e&&(e=e.toString());const r=Object.assign({binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0},t);this.extensions[u.extensionName]||(r.compress=!1),this._sender.send(e||p.EMPTY_BUFFER,r,n)}terminate(){if(this.readyState!==WebSocket.CLOSED)return this.readyState===WebSocket.CONNECTING?(this._req.abort(),void this.finalize(new Error("closed before the connection is established"))):void this.finalize(!0)}}function initAsServerClient(e,t,n){this.protocolVersion=n.protocolVersion,this._maxPayload=n.maxPayload,this.extensions=n.extensions,this.protocol=n.protocol,this._isServer=!0,this.setSocket(e,t)}function initAsClient(e,t,n){if(n=Object.assign({protocolVersion:y[1],protocol:t.join(","),perMessageDeflate:!0,handshakeTimeout:null,localAddress:null,headers:null,family:null,origin:null,agent:null,host:null,checkServerIdentity:null,rejectUnauthorized:null,passphrase:null,ciphers:null,ecdhCurve:null,cert:null,key:null,pfx:null,ca:null},n),-1===y.indexOf(n.protocolVersion))throw new Error(`unsupported protocol version: ${n.protocolVersion} (supported versions: ${y.join(", ")})`);this.protocolVersion=n.protocolVersion,this._isServer=!1,this.url=e;const r=c.parse(e),i="ws+unix:"===r.protocol;if(!(r.host||i&&r.path))throw new Error("invalid url");const l="wss:"===r.protocol||"https:"===r.protocol,h=o.randomBytes(16).toString("base64"),m=l?s:a;var g;const _={port:r.port||(l?443:80),host:r.hostname,path:"/",headers:{"Sec-WebSocket-Version":n.protocolVersion,"Sec-WebSocket-Key":h,Connection:"Upgrade",Upgrade:"websocket"}};if(n.headers&&Object.assign(_.headers,n.headers),n.perMessageDeflate&&(g=new u(!0!==n.perMessageDeflate?n.perMessageDeflate:{},!1),_.headers["Sec-WebSocket-Extensions"]=d.format({[u.extensionName]:g.offer()})),n.protocol&&(_.headers["Sec-WebSocket-Protocol"]=n.protocol),n.origin&&(n.protocolVersion<13?_.headers["Sec-WebSocket-Origin"]=n.origin:_.headers.Origin=n.origin),n.host&&(_.headers.Host=n.host),r.auth&&(_.auth=r.auth),n.localAddress&&(_.localAddress=n.localAddress),n.family&&(_.family=n.family),i){const e=r.path.split(":");_.socketPath=e[0],_.path=e[1]}else r.path&&("/"!==r.path.charAt(0)?_.path="/"+r.path:_.path=r.path);var v=n.agent;(null!=n.rejectUnauthorized||n.checkServerIdentity||n.passphrase||n.ciphers||n.ecdhCurve||n.cert||n.key||n.pfx||n.ca)&&(n.passphrase&&(_.passphrase=n.passphrase),n.ciphers&&(_.ciphers=n.ciphers),n.ecdhCurve&&(_.ecdhCurve=n.ecdhCurve),n.cert&&(_.cert=n.cert),n.key&&(_.key=n.key),n.pfx&&(_.pfx=n.pfx),n.ca&&(_.ca=n.ca),n.checkServerIdentity&&(_.checkServerIdentity=n.checkServerIdentity),null!=n.rejectUnauthorized&&(_.rejectUnauthorized=n.rejectUnauthorized),v||(v=new m.Agent(_))),v&&(_.agent=v),this._req=m.get(_),n.handshakeTimeout&&this._req.setTimeout(n.handshakeTimeout,()=>{this._req.abort(),this.finalize(new Error("opening handshake has timed out"))}),this._req.on("error",e=>{this._req.aborted||(this._req=null,this.finalize(e))}),this._req.on("response",e=>{this.emit("unexpected-response",this._req,e)||(this._req.abort(),this.finalize(new Error(`unexpected server response (${e.statusCode})`)))}),this._req.on("upgrade",(e,t,r)=>{if(this.emit("headers",e.headers,e),this.readyState!==WebSocket.CONNECTING)return;this._req=null;const i=o.createHash("sha1").update(h+p.GUID,"binary").digest("base64");if(e.headers["sec-websocket-accept"]!==i)return t.destroy(),this.finalize(new Error("invalid server key"));const s=e.headers["sec-websocket-protocol"],a=(n.protocol||"").split(/, */);var c;if(!n.protocol&&s?c="server sent a subprotocol even though none requested":n.protocol&&!s?c="server sent no subprotocol even though requested":s&&-1===a.indexOf(s)&&(c="server responded with an invalid protocol"),c)return t.destroy(),this.finalize(new Error(c));if(s&&(this.protocol=s),g)try{const t=d.parse(e.headers["sec-websocket-extensions"]);t[u.extensionName]&&(g.accept(t[u.extensionName]),this.extensions[u.extensionName]=g)}catch(e){return t.destroy(),void this.finalize(new Error("invalid Sec-WebSocket-Extensions header"))}this.setSocket(t,r)})}WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,["open","error","close","message"].forEach(e=>{Object.defineProperty(WebSocket.prototype,"on"+e,{get(){const t=this.listeners(e);for(var n=0;n<t.length;n++)if(t[n]._listener)return t[n]._listener},set(t){const n=this.listeners(e);for(var r=0;r<n.length;r++)n[r]._listener&&this.removeListener(e,n[r]);this.addEventListener(e,t)}})}),WebSocket.prototype.addEventListener=l.addEventListener,WebSocket.prototype.removeEventListener=l.removeEventListener,e.exports=WebSocket},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,o=0;function Ultron(e){if(!(this instanceof Ultron))return new Ultron(e);this.id=o++,this.ee=e}Ultron.prototype.on=function on(e,t,n){return t.__ultron=this.id,this.ee.on(e,t,n),this},Ultron.prototype.once=function once(e,t,n){return t.__ultron=this.id,this.ee.once(e,t,n),this},Ultron.prototype.remove=function remove(){var e,t=arguments,n=this.ee;if(1===t.length&&"string"==typeof t[0])t=t[0].split(/[, ]+/);else if(!t.length)if(n.eventNames)t=n.eventNames();else if(n._events){for(e in t=[],n._events)r.call(n._events,e)&&t.push(e);Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n._events)))}for(var o=0;o<t.length;o++)for(var i=n.listeners(t[o]),s=0;s<i.length;s++){if((e=i[s]).listener){if(e.listener.__ultron!==this.id)continue}else if(e.__ultron!==this.id)continue;n.removeListener(t[o],e)}return this},Ultron.prototype.destroy=function destroy(){return!!this.ee&&(this.remove(),this.ee=null,!0)},e.exports=Ultron},function(e,t,n){"use strict";function Queue(e){if(!(this instanceof Queue))return new Queue(e);e=e||{},this.concurrency=e.concurrency||1/0,this.pending=0,this.jobs=[],this.cbs=[],this._done=done.bind(this)}function done(){this.pending--,this._run()}["push","unshift","splice"].forEach((function(e){Queue.prototype[e]=function(){var t=Array.prototype[e].apply(this.jobs,arguments);return this._run(),t}})),Object.defineProperty(Queue.prototype,"length",{get:function(){return this.pending+this.jobs.length}}),Queue.prototype._run=function(){if(this.pending!==this.concurrency){if(this.jobs.length){var e=this.jobs.shift();this.pending++,e(this._done),this._run()}if(0===this.pending)for(;0!==this.cbs.length;){var t=this.cbs.pop();process.nextTick(t)}}},Queue.prototype.onDone=function(e){"function"==typeof e&&(this.cbs.push(e),this._run())},e.exports=Queue},function(e,t,n){"use strict";const r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function push(e,t,n){Object.prototype.hasOwnProperty.call(e,t)?e[t].push(n):e[t]=[n]}e.exports={format:function format(e){return Object.keys(e).map(t=>{var n=e[t];return Array.isArray(n)||(n=[n]),n.map(e=>[t].concat(Object.keys(e).map(t=>{var n=e[t];return Array.isArray(n)||(n=[n]),n.map(e=>!0===e?t:`${t}=${e}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function parse(e){const t={};if(void 0===e||""===e)return t;for(var n,o,i={},s=!1,a=!1,c=!1,u=-1,l=-1,d=0;d<e.length;d++){const h=e.charCodeAt(d);if(void 0===n)if(-1===l&&1===r[h])-1===u&&(u=d);else if(32===h||9===h)-1===l&&-1!==u&&(l=d);else{if(59!==h&&44!==h)throw new Error("unexpected character at index "+d);{if(-1===u)throw new Error("unexpected character at index "+d);-1===l&&(l=d);const r=e.slice(u,l);44===h?(push(t,r,i),i={}):n=r,u=l=-1}}else if(void 0===o)if(-1===l&&1===r[h])-1===u&&(u=d);else if(32===h||9===h)-1===l&&-1!==u&&(l=d);else if(59===h||44===h){if(-1===u)throw new Error("unexpected character at index "+d);-1===l&&(l=d),push(i,e.slice(u,l),!0),44===h&&(push(t,n,i),i={},n=void 0),u=l=-1}else{if(61!==h||-1===u||-1!==l)throw new Error("unexpected character at index "+d);o=e.slice(u,d),u=l=-1}else if(a){if(1!==r[h])throw new Error("unexpected character at index "+d);-1===u?u=d:s||(s=!0),a=!1}else if(c)if(1===r[h])-1===u&&(u=d);else if(34===h&&-1!==u)c=!1,l=d;else{if(92!==h)throw new Error("unexpected character at index "+d);a=!0}else if(34===h&&61===e.charCodeAt(d-1))c=!0;else if(-1===l&&1===r[h])-1===u&&(u=d);else if(-1===u||32!==h&&9!==h){if(59!==h&&44!==h)throw new Error("unexpected character at index "+d);if(-1===u)throw new Error("unexpected character at index "+d);-1===l&&(l=d);var p=e.slice(u,l);s&&(p=p.replace(/\\/g,""),s=!1),push(i,o,p),44===h&&(push(t,n,i),i={},n=void 0),o=void 0,u=l=-1}else-1===l&&(l=d)}if(-1===u||c)throw new Error("unexpected end of input");-1===l&&(l=d);const h=e.slice(u,l);return void 0===n?push(t,h,{}):(void 0===o?push(i,h,!0):push(i,o,s?h.replace(/\\/g,""):h),push(t,n,i)),t}}},function(e,t,n){"use strict";const r=n(73),o=n(126),i=n(581),s=n(179),a=n(265),c=n(127),u=r.Buffer;function toBuffer(e,t){return 1===e.length?e[0]:e.length>1?s.concat(e,t):c.EMPTY_BUFFER}e.exports=class Receiver{constructor(e,t,n){this._binaryType=n||c.BINARY_TYPES[0],this._extensions=e||{},this._maxPayload=0|t,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._fragmented=0,this._masked=!1,this._fin=!1,this._mask=null,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._cleanupCallback=null,this._hadError=!1,this._dead=!1,this._loop=!1,this.onmessage=null,this.onclose=null,this.onerror=null,this.onping=null,this.onpong=null,this._state=0}readBuffer(e){var t,n,r=0;if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length)return t=this._buffers[0].slice(0,e),this._buffers[0]=this._buffers[0].slice(e),t;for(t=u.allocUnsafe(e);e>0;)e>=(n=this._buffers[0].length)?(this._buffers[0].copy(t,r),r+=n,this._buffers.shift()):(this._buffers[0].copy(t,r,0,e),this._buffers[0]=this._buffers[0].slice(e)),e-=n;return t}hasBufferedBytes(e){return this._bufferedBytes>=e||(this._loop=!1,this._dead&&this.cleanup(this._cleanupCallback),!1)}add(e){this._dead||(this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop())}startLoop(){for(this._loop=!0;this._loop;)switch(this._state){case 0:this.getInfo();break;case 1:this.getPayloadLength16();break;case 2:this.getPayloadLength64();break;case 3:this.getMask();break;case 4:this.getData();break;default:this._loop=!1}}getInfo(){if(!this.hasBufferedBytes(2))return;const e=this.readBuffer(2);if(0!=(48&e[0]))return void this.error(new Error("RSV2 and RSV3 must be clear"),1002);const t=64==(64&e[0]);if(!t||this._extensions[o.extensionName]){if(this._fin=128==(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return void this.error(new Error("RSV1 must be clear"),1002);if(!this._fragmented)return void this.error(new Error("invalid opcode: "+this._opcode),1002);this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void this.error(new Error("invalid opcode: "+this._opcode),1002);this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return void this.error(new Error("invalid opcode: "+this._opcode),1002);if(!this._fin)return void this.error(new Error("FIN must be set"),1002);if(t)return void this.error(new Error("RSV1 must be clear"),1002);if(this._payloadLength>125)return void this.error(new Error("invalid payload length"),1002)}this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&e[1]),126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength()}else this.error(new Error("RSV1 must be clear"),1002)}getPayloadLength16(){this.hasBufferedBytes(2)&&(this._payloadLength=this.readBuffer(2).readUInt16BE(0,!0),this.haveLength())}getPayloadLength64(){if(!this.hasBufferedBytes(8))return;const e=this.readBuffer(8),t=e.readUInt32BE(0,!0);t>Math.pow(2,21)-1?this.error(new Error("max payload size exceeded"),1009):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4,!0),this.haveLength())}haveLength(){this._opcode<8&&this.maxPayloadExceeded(this._payloadLength)||(this._masked?this._state=3:this._state=4)}getMask(){this.hasBufferedBytes(4)&&(this._mask=this.readBuffer(4),this._state=4)}getData(){var e=c.EMPTY_BUFFER;if(this._payloadLength){if(!this.hasBufferedBytes(this._payloadLength))return;e=this.readBuffer(this._payloadLength),this._masked&&s.unmask(e,this._mask)}this._opcode>7?this.controlMessage(e):this._compressed?(this._state=5,this.decompress(e)):this.pushFragment(e)&&this.dataMessage()}decompress(e){this._extensions[o.extensionName].decompress(e,this._fin,(e,t)=>{e?this.error(e,1009===e.closeCode?1009:1007):(this.pushFragment(t)&&this.dataMessage(),this.startLoop())})}dataMessage(){if(this._fin){const t=this._messageLength,n=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){var e;e="nodebuffer"===this._binaryType?toBuffer(n,t):"arraybuffer"===this._binaryType?function toArrayBuffer(e){if(0===e.byteOffset&&e.byteLength===e.buffer.byteLength)return e.buffer;return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}(toBuffer(n,t)):n,this.onmessage(e)}else{const e=toBuffer(n,t);if(!i(e))return void this.error(new Error("invalid utf8 sequence"),1007);this.onmessage(e.toString())}}this._state=0}controlMessage(e){if(8!==this._opcode)9===this._opcode?this.onping(e):this.onpong(e),this._state=0;else if(0===e.length)this.onclose(1e3,""),this._loop=!1,this.cleanup(this._cleanupCallback);else if(1===e.length)this.error(new Error("invalid payload length"),1002);else{const t=e.readUInt16BE(0,!0);if(!a.isValidErrorCode(t))return void this.error(new Error("invalid status code: "+t),1002);const n=e.slice(2);if(!i(n))return void this.error(new Error("invalid utf8 sequence"),1007);this.onclose(t,n.toString()),this._loop=!1,this.cleanup(this._cleanupCallback)}}error(e,t){this.onerror(e,t),this._hadError=!0,this._loop=!1,this.cleanup(this._cleanupCallback)}maxPayloadExceeded(e){if(0===e||this._maxPayload<1)return!1;const t=this._totalPayloadLength+e;return t<=this._maxPayload?(this._totalPayloadLength=t,!1):(this.error(new Error("max payload size exceeded"),1009),!0)}pushFragment(e){if(0===e.length)return!0;const t=this._messageLength+e.length;return this._maxPayload<1||t<=this._maxPayload?(this._messageLength=t,this._fragments.push(e),!0):(this.error(new Error("max payload size exceeded"),1009),!1)}cleanup(e){this._dead=!0,this._hadError||!this._loop&&5!==this._state?(this._extensions=null,this._fragments=null,this._buffers=null,this._mask=null,this._cleanupCallback=null,this.onmessage=null,this.onclose=null,this.onerror=null,this.onping=null,this.onpong=null,e&&e()):this._cleanupCallback=e}}},function(e,t,n){"use strict";e.exports={isValidErrorCode:function(e){return e>=1e3&&e<=1013&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},1e3:"normal",1001:"going away",1002:"protocol error",1003:"unsupported data",1004:"reserved",1005:"reserved for extensions",1006:"reserved for extensions",1007:"inconsistent or invalid data",1008:"policy violation",1009:"message too big",1010:"extension handshake missing",1011:"an unexpected condition prevented the request from being fulfilled",1012:"service restart",1013:"try again later"}},function(e,t,n){"use strict";const r=n(73),o=n(16),i=n(126),s=n(179),a=n(265),c=n(127),u=r.Buffer;class Sender{constructor(e,t){this._extensions=t||{},this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){const n=e.length<1024||t.mask&&t.readOnly;var r=t.mask?6:2,i=e.length;e.length>=65536?(r+=8,i=127):e.length>125&&(r+=2,i=126);const a=u.allocUnsafe(n?e.length+r:r);if(a[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(a[0]|=64),126===i?a.writeUInt16BE(e.length,2,!0):127===i&&(a.writeUInt32BE(0,2,!0),a.writeUInt32BE(e.length,6,!0)),!t.mask)return a[1]=i,n?(e.copy(a,r),[a]):[a,e];const c=o.randomBytes(4);return a[1]=128|i,a[r-4]=c[0],a[r-3]=c[1],a[r-2]=c[2],a[r-1]=c[3],n?(s.mask(e,c,a,r,e.length),[a]):(s.mask(e,c,e,0,e.length),[a,e])}close(e,t,n,r){var o;if(void 0===e)e=1e3;else if("number"!=typeof e||!a.isValidErrorCode(e))throw new Error("first argument must be a valid error code number");void 0===t||""===t?1e3===e?o=c.EMPTY_BUFFER:(o=u.allocUnsafe(2)).writeUInt16BE(e,0,!0):((o=u.allocUnsafe(2+u.byteLength(t))).writeUInt16BE(e,0,!0),o.write(t,2)),this._deflating?this.enqueue([this.doClose,o,n,r]):this.doClose(o,n,r)}doClose(e,t,n){this.sendFrame(Sender.frame(e,{fin:!0,rsv1:!1,opcode:8,mask:t,readOnly:!1}),n)}ping(e,t){var n=!0;u.isBuffer(e)||(e instanceof ArrayBuffer?e=u.from(e):ArrayBuffer.isView(e)?e=viewToBuffer(e):(e=u.from(e),n=!1)),this._deflating?this.enqueue([this.doPing,e,t,n]):this.doPing(e,t,n)}doPing(e,t,n){this.sendFrame(Sender.frame(e,{fin:!0,rsv1:!1,opcode:9,mask:t,readOnly:n}))}pong(e,t){var n=!0;u.isBuffer(e)||(e instanceof ArrayBuffer?e=u.from(e):ArrayBuffer.isView(e)?e=viewToBuffer(e):(e=u.from(e),n=!1)),this._deflating?this.enqueue([this.doPong,e,t,n]):this.doPong(e,t,n)}doPong(e,t,n){this.sendFrame(Sender.frame(e,{fin:!0,rsv1:!1,opcode:10,mask:t,readOnly:n}))}send(e,t,n){var r=t.binary?2:1,o=t.compress,s=!0;u.isBuffer(e)||(e instanceof ArrayBuffer?e=u.from(e):ArrayBuffer.isView(e)?e=viewToBuffer(e):(e=u.from(e),s=!1));const a=this._extensions[i.extensionName];if(this._firstFragment?(this._firstFragment=!1,o&&a&&(o=e.length>=a._threshold),this._compress=o):(o=!1,r=0),t.fin&&(this._firstFragment=!0),a){const i={fin:t.fin,rsv1:o,opcode:r,mask:t.mask,readOnly:s};this._deflating?this.enqueue([this.dispatch,e,this._compress,i,n]):this.dispatch(e,this._compress,i,n)}else this.sendFrame(Sender.frame(e,{fin:t.fin,rsv1:!1,opcode:r,mask:t.mask,readOnly:s}),n)}dispatch(e,t,n,r){if(!t)return void this.sendFrame(Sender.frame(e,n),r);const o=this._extensions[i.extensionName];this._deflating=!0,o.compress(e,n.fin,(e,t)=>{n.readOnly=!1,this.sendFrame(Sender.frame(t,n),r),this._deflating=!1,this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[1].length,e[0].apply(this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[1].length,this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.write(e[0]),this._socket.write(e[1],t)):this._socket.write(e[0],t)}}function viewToBuffer(e){const t=u.from(e.buffer);return e.byteLength!==e.buffer.byteLength?t.slice(e.byteOffset,e.byteOffset+e.byteLength):t}e.exports=Sender},function(e,t,n){function createDebug(e){var n;function debug(){if(debug.enabled){var e=debug,r=+new Date,o=r-(n||r);e.diff=o,e.prev=n,e.curr=r,n=r;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var a=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;a++;var o=t.formatters[r];if("function"==typeof o){var s=i[a];n=o.call(e,s),i.splice(a,1),a--}return n})),t.formatArgs.call(e,i);var c=debug.log||t.log||console.log.bind(console);c.apply(e,i)}}return debug.namespace=e,debug.enabled=t.enabled(e),debug.useColors=t.useColors(),debug.color=function selectColor(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),debug.destroy=destroy,"function"==typeof t.init&&t.init(debug),t.instances.push(debug),debug}function destroy(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=createDebug.debug=createDebug.default=createDebug).coerce=function coerce(e){return e instanceof Error?e.stack||e.message:e},t.disable=function disable(){t.enable("")},t.enable=function enable(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function enabled(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(587),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){e.exports=function isBuf(e){return n&&global.Buffer.isBuffer(e)||r&&(e instanceof global.ArrayBuffer||o(e))};var n="function"==typeof global.Buffer&&"function"==typeof global.Buffer.isBuffer,r="function"==typeof global.ArrayBuffer,o=r&&"function"==typeof global.ArrayBuffer.isView?global.ArrayBuffer.isView:function(e){return e.buffer instanceof global.ArrayBuffer}},function(e,t,n){function createDebug(e){var n;function debug(){if(debug.enabled){var e=debug,r=+new Date,o=r-(n||r);e.diff=o,e.prev=n,e.curr=r,n=r;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var a=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;a++;var o=t.formatters[r];if("function"==typeof o){var s=i[a];n=o.call(e,s),i.splice(a,1),a--}return n})),t.formatArgs.call(e,i);var c=debug.log||t.log||console.log.bind(console);c.apply(e,i)}}return debug.namespace=e,debug.enabled=t.enabled(e),debug.useColors=t.useColors(),debug.color=function selectColor(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),debug.destroy=destroy,"function"==typeof t.init&&t.init(debug),t.instances.push(debug),debug}function destroy(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=createDebug.debug=createDebug.default=createDebug).coerce=function coerce(e){return e instanceof Error?e.stack||e.message:e},t.disable=function disable(){t.enable("")},t.enable=function enable(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function enabled(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(592),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,n){var r=n(594),o=n(29).EventEmitter,i=n(128),s=n(178),a=n(129)("socket.io:namespace");e.exports=t=Namespace,t.events=["connect","connection","newListener"],t.flags=["json","volatile","local"];var c=o.prototype.emit;function Namespace(e,t){this.name=t,this.server=e,this.sockets={},this.connected={},this.fns=[],this.ids=0,this.rooms=[],this.flags={},this.initAdapter()}Namespace.prototype.__proto__=o.prototype,t.flags.forEach((function(e){Object.defineProperty(Namespace.prototype,e,{get:function(){return this.flags[e]=!0,this}})})),Namespace.prototype.initAdapter=function(){this.adapter=new(this.server.adapter())(this)},Namespace.prototype.use=function(e){return this.server.eio&&"/"===this.name&&(a("removing initial packet"),delete this.server.eio.initialPacket),this.fns.push(e),this},Namespace.prototype.run=function(e,t){var n=this.fns.slice(0);if(!n.length)return t(null);!function run(r){n[r](e,(function(e){return e?t(e):n[r+1]?void run(r+1):t(null)}))}(0)},Namespace.prototype.to=Namespace.prototype.in=function(e){return~this.rooms.indexOf(e)||this.rooms.push(e),this},Namespace.prototype.add=function(e,t,n){a("adding socket to nsp %s",this.name);var o=new r(this,e,t),i=this;return this.run(o,(function(t){process.nextTick((function(){if("open"==e.conn.readyState){if(t)return o.error(t.data||t.message);i.sockets[o.id]=o,o.onconnect(),n&&n(),i.emit("connect",o),i.emit("connection",o)}else a("next called after client was closed - ignoring socket")}))})),o},Namespace.prototype.remove=function(e){this.sockets.hasOwnProperty(e.id)?delete this.sockets[e.id]:a("ignoring remove for %s",e.id)},Namespace.prototype.emit=function(e){if(~t.events.indexOf(e))return c.apply(this,arguments),this;var n=Array.prototype.slice.call(arguments),r={type:(void 0!==this.flags.binary?this.flags.binary:s(n))?i.BINARY_EVENT:i.EVENT,data:n};if("function"==typeof n[n.length-1])throw new Error("Callbacks are not supported when broadcasting");var o=this.rooms.slice(0),a=Object.assign({},this.flags);return this.rooms=[],this.flags={},this.adapter.broadcast(r,{rooms:o,flags:a}),this},Namespace.prototype.send=Namespace.prototype.write=function(){var e=Array.prototype.slice.call(arguments);return e.unshift("message"),this.emit.apply(this,e),this},Namespace.prototype.clients=function(e){return this.adapter.clients(this.rooms,e),this.rooms=[],this},Namespace.prototype.compress=function(e){return this.flags.compress=e,this},Namespace.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t,n){"use strict";const r=n(29),o=n(57),i=n(37),s=n(273),a=n(599),{randomBytes:c,createHash:u}=n(16),{URL:l}=n(51),d=n(130),p=n(274),h=n(276),{BINARY_TYPES:m,EMPTY_BUFFER:y,GUID:g,kStatusCode:_,kWebSocket:v,NOOP:E}=n(74),{addEventListener:I,removeEventListener:b}=n(600),{format:S,parse:C}=n(277),{toBuffer:w}=n(131),A=["CONNECTING","OPEN","CLOSING","CLOSED"],O=[8,13];class WebSocket extends r{constructor(e,t,n){super(),this.readyState=WebSocket.CONNECTING,this.protocol="",this._binaryType=m[0],this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage="",this._closeTimer=null,this._closeCode=1006,this._extensions={},this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,Array.isArray(t)?t=t.join(", "):"object"==typeof t&&null!==t&&(n=t,t=void 0),function initAsClient(e,t,n,r){const s={protocolVersion:O[1],maxPayload:104857600,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...r,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,auth:void 0,host:void 0,path:void 0,port:void 0};if(!O.includes(s.protocolVersion))throw new RangeError(`Unsupported protocol version: ${s.protocolVersion} (supported versions: ${O.join(", ")})`);let a;t instanceof l?(a=t,e.url=t.href):(a=new l(t),e.url=t);const p="ws+unix:"===a.protocol;if(!(a.host||p&&a.pathname))throw new Error("Invalid URL: "+e.url);const h="wss:"===a.protocol||"https:"===a.protocol,m=h?443:80,y=c(16).toString("base64"),_=h?o.get:i.get;let v;s.createConnection=h?tlsConnect:netConnect,s.defaultPort=s.defaultPort||m,s.port=a.port||m,s.host=a.hostname.startsWith("[")?a.hostname.slice(1,-1):a.hostname,s.headers={"Sec-WebSocket-Version":s.protocolVersion,"Sec-WebSocket-Key":y,Connection:"Upgrade",Upgrade:"websocket",...s.headers},s.path=a.pathname+a.search,s.timeout=s.handshakeTimeout,s.perMessageDeflate&&(v=new d(!0!==s.perMessageDeflate?s.perMessageDeflate:{},!1,s.maxPayload),s.headers["Sec-WebSocket-Extensions"]=S({[d.extensionName]:v.offer()}));n&&(s.headers["Sec-WebSocket-Protocol"]=n);s.origin&&(s.protocolVersion<13?s.headers["Sec-WebSocket-Origin"]=s.origin:s.headers.Origin=s.origin);(a.username||a.password)&&(s.auth=`${a.username}:${a.password}`);if(p){const e=s.path.split(":");s.socketPath=e[0],s.path=e[1]}let E=e._req=_(s);s.timeout&&E.on("timeout",()=>{abortHandshake(e,E,"Opening handshake has timed out")});E.on("error",t=>{e._req.aborted||(E=e._req=null,e.readyState=WebSocket.CLOSING,e.emit("error",t),e.emitClose())}),E.on("response",o=>{const i=o.headers.location,a=o.statusCode;if(i&&s.followRedirects&&a>=300&&a<400){if(++e._redirects>s.maxRedirects)return void abortHandshake(e,E,"Maximum redirects exceeded");E.abort();const o=new l(i,t);initAsClient(e,o,n,r)}else e.emit("unexpected-response",E,o)||abortHandshake(e,E,"Unexpected server response: "+o.statusCode)}),E.on("upgrade",(t,r,o)=>{if(e.emit("upgrade",t),e.readyState!==WebSocket.CONNECTING)return;E=e._req=null;const i=u("sha1").update(y+g).digest("base64");if(t.headers["sec-websocket-accept"]!==i)return void abortHandshake(e,r,"Invalid Sec-WebSocket-Accept header");const a=t.headers["sec-websocket-protocol"],c=(n||"").split(/, */);let l;if(!n&&a?l="Server sent a subprotocol but none was requested":n&&!a?l="Server sent no subprotocol":a&&!c.includes(a)&&(l="Server sent an invalid subprotocol"),l)abortHandshake(e,r,l);else{if(a&&(e.protocol=a),v)try{const n=C(t.headers["sec-websocket-extensions"]);n[d.extensionName]&&(v.accept(n[d.extensionName]),e._extensions[d.extensionName]=v)}catch(t){return void abortHandshake(e,r,"Invalid Sec-WebSocket-Extensions header")}e.setSocket(r,o,s.maxPayload)}})}(this,e,t,n)):this._isServer=!0}get CONNECTING(){return WebSocket.CONNECTING}get CLOSING(){return WebSocket.CLOSING}get CLOSED(){return WebSocket.CLOSED}get OPEN(){return WebSocket.OPEN}get binaryType(){return this._binaryType}set binaryType(e){m.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?(this._socket.bufferSize||0)+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}setSocket(e,t,n){const r=new p(this._binaryType,this._extensions,n);this._sender=new h(e,this._extensions),this._receiver=r,this._socket=e,r[v]=this,e[v]=this,r.on("conclude",receiverOnConclude),r.on("drain",receiverOnDrain),r.on("error",receiverOnError),r.on("message",receiverOnMessage),r.on("ping",receiverOnPing),r.on("pong",receiverOnPong),e.setTimeout(0),e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",socketOnClose),e.on("data",socketOnData),e.on("end",socketOnEnd),e.on("error",socketOnError),this.readyState=WebSocket.OPEN,this.emit("open")}emitClose(){this.readyState=WebSocket.CLOSED,this._socket?(this._extensions[d.extensionName]&&this._extensions[d.extensionName].cleanup(),this._receiver.removeAllListeners(),this.emit("close",this._closeCode,this._closeMessage)):this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==WebSocket.CLOSED){if(this.readyState===WebSocket.CONNECTING){const e="WebSocket was closed before the connection was established";return abortHandshake(this,this._req,e)}this.readyState!==WebSocket.CLOSING?(this.readyState=WebSocket.CLOSING,this._sender.close(e,t,!this._isServer,e=>{e||(this._closeFrameSent=!0,this._closeFrameReceived&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)):this._closeFrameSent&&this._closeFrameReceived&&this._socket.end()}}ping(e,t,n){if(this.readyState===WebSocket.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===WebSocket.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||y,t,n)):sendAfterClose(this,e,n)}pong(e,t,n){if(this.readyState===WebSocket.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===WebSocket.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||y,t,n)):sendAfterClose(this,e,n)}send(e,t,n){if(this.readyState===WebSocket.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(n=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==WebSocket.OPEN)return void sendAfterClose(this,e,n);const r={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[d.extensionName]||(r.compress=!1),this._sender.send(e||y,r,n)}terminate(){if(this.readyState!==WebSocket.CLOSED){if(this.readyState===WebSocket.CONNECTING){const e="WebSocket was closed before the connection was established";return abortHandshake(this,this._req,e)}this._socket&&(this.readyState=WebSocket.CLOSING,this._socket.destroy())}}}function netConnect(e){return e.path=e.socketPath,s.connect(e)}function tlsConnect(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=e.host),a.connect(e)}function abortHandshake(e,t,n){e.readyState=WebSocket.CLOSING;const r=new Error(n);Error.captureStackTrace(r,abortHandshake),t.setHeader?(t.abort(),t.once("abort",e.emitClose.bind(e)),e.emit("error",r)):(t.destroy(r),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function sendAfterClose(e,t,n){if(t){const n=w(t).length;e._socket?e._sender._bufferedBytes+=n:e._bufferedAmount+=n}if(n){n(new Error(`WebSocket is not open: readyState ${e.readyState} (${A[e.readyState]})`))}}function receiverOnConclude(e,t){const n=this[v];n._socket.removeListener("data",socketOnData),n._socket.resume(),n._closeFrameReceived=!0,n._closeMessage=t,n._closeCode=e,1005===e?n.close():n.close(e,t)}function receiverOnDrain(){this[v]._socket.resume()}function receiverOnError(e){const t=this[v];t._socket.removeListener("data",socketOnData),t.readyState=WebSocket.CLOSING,t._closeCode=e[_],t.emit("error",e),t._socket.destroy()}function receiverOnFinish(){this[v].emitClose()}function receiverOnMessage(e){this[v].emit("message",e)}function receiverOnPing(e){const t=this[v];t.pong(e,!t._isServer,E),t.emit("ping",e)}function receiverOnPong(e){this[v].emit("pong",e)}function socketOnClose(){const e=this[v];this.removeListener("close",socketOnClose),this.removeListener("end",socketOnEnd),e.readyState=WebSocket.CLOSING,e._socket.read(),e._receiver.end(),this.removeListener("data",socketOnData),this[v]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",receiverOnFinish),e._receiver.on("finish",receiverOnFinish))}function socketOnData(e){this[v]._receiver.write(e)||this.pause()}function socketOnEnd(){const e=this[v];e.readyState=WebSocket.CLOSING,e._receiver.end(),this.end()}function socketOnError(){const e=this[v];this.removeListener("error",socketOnError),this.on("error",E),e&&(e.readyState=WebSocket.CLOSING,this.destroy())}A.forEach((e,t)=>{WebSocket[e]=t}),["open","error","close","message"].forEach(e=>{Object.defineProperty(WebSocket.prototype,"on"+e,{get(){const t=this.listeners(e);for(let e=0;e<t.length;e++)if(t[e]._listener)return t[e]._listener},set(t){const n=this.listeners(e);for(let t=0;t<n.length;t++)n[t]._listener&&this.removeListener(e,n[t]);this.addEventListener(e,t)}})}),WebSocket.prototype.addEventListener=I,WebSocket.prototype.removeEventListener=b,e.exports=WebSocket},function(e,t){e.exports=require("net")},function(e,t,n){"use strict";const{Writable:r}=n(180),o=n(130),{BINARY_TYPES:i,EMPTY_BUFFER:s,kStatusCode:a,kWebSocket:c}=n(74),{concat:u,toArrayBuffer:l,unmask:d}=n(131),{isValidStatusCode:p,isValidUTF8:h}=n(275);function error(e,t,n,r){const o=new e(n?"Invalid WebSocket frame: "+t:t);return Error.captureStackTrace(o,error),o[a]=r,o}e.exports=class Receiver extends r{constructor(e,t,n){super(),this._binaryType=e||i[0],this[c]=void 0,this._extensions=t||{},this._maxPayload=0|n,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=0,this._loop=!1}_write(e,t,n){if(8===this._opcode&&0==this._state)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=t.slice(e),t.slice(0,e)}const t=Buffer.allocUnsafe(e);do{const n=this._buffers[0],r=t.length-e;e>=n.length?t.set(this._buffers.shift(),r):(t.set(new Uint8Array(n.buffer,n.byteOffset,e),r),this._buffers[0]=n.slice(e)),e-=n.length}while(e>0);return t}startLoop(e){let t;this._loop=!0;do{switch(this._state){case 0:t=this.getInfo();break;case 1:t=this.getPayloadLength16();break;case 2:t=this.getPayloadLength64();break;case 3:this.getMask();break;case 4:t=this.getData(e);break;default:return void(this._loop=!1)}}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2)return void(this._loop=!1);const e=this.consume(2);if(0!=(48&e[0]))return this._loop=!1,error(RangeError,"RSV2 and RSV3 must be clear",!0,1002);const t=64==(64&e[0]);if(t&&!this._extensions[o.extensionName])return this._loop=!1,error(RangeError,"RSV1 must be clear",!0,1002);if(this._fin=128==(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return this._loop=!1,error(RangeError,"RSV1 must be clear",!0,1002);if(!this._fragmented)return this._loop=!1,error(RangeError,"invalid opcode 0",!0,1002);this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,error(RangeError,"invalid opcode "+this._opcode,!0,1002);this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return this._loop=!1,error(RangeError,"invalid opcode "+this._opcode,!0,1002);if(!this._fin)return this._loop=!1,error(RangeError,"FIN must be set",!0,1002);if(t)return this._loop=!1,error(RangeError,"RSV1 must be clear",!0,1002);if(this._payloadLength>125)return this._loop=!1,error(RangeError,"invalid payload length "+this._payloadLength,!0,1002)}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&e[1]),126===this._payloadLength)this._state=1;else{if(127!==this._payloadLength)return this.haveLength();this._state=2}}getPayloadLength16(){if(!(this._bufferedBytes<2))return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength();this._loop=!1}getPayloadLength64(){if(this._bufferedBytes<8)return void(this._loop=!1);const e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,21)-1?(this._loop=!1,error(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009)):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,error(RangeError,"Max payload size exceeded",!1,1009);this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=s;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&d(t,this._mask)}return this._opcode>7?this.controlMessage(t):this._compressed?(this._state=5,void this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage())}decompress(e,t){this._extensions[o.extensionName].decompress(e,this._fin,(e,n)=>{if(e)return t(e);if(n.length){if(this._messageLength+=n.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(error(RangeError,"Max payload size exceeded",!1,1009));this._fragments.push(n)}const r=this.dataMessage();if(r)return t(r);this.startLoop(t)})}dataMessage(){if(this._fin){const e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let n;n="nodebuffer"===this._binaryType?u(t,e):"arraybuffer"===this._binaryType?l(u(t,e)):t,this.emit("message",n)}else{const n=u(t,e);if(!h(n))return this._loop=!1,error(Error,"invalid UTF-8 sequence",!0,1007);this.emit("message",n.toString())}}this._state=0}controlMessage(e){if(8===this._opcode)if(this._loop=!1,0===e.length)this.emit("conclude",1005,""),this.end();else{if(1===e.length)return error(RangeError,"invalid payload length 1",!0,1002);{const t=e.readUInt16BE(0);if(!p(t))return error(RangeError,"invalid status code "+t,!0,1002);const n=e.slice(2);if(!h(n))return error(Error,"invalid UTF-8 sequence",!0,1007);this.emit("conclude",t,n.toString()),this.end()}}else 9===this._opcode?this.emit("ping",e):this.emit("pong",e);this._state=0}}},function(e,t,n){"use strict";try{const e=n(!function webpackMissingModule(){var e=new Error("Cannot find module 'utf-8-validate'");throw e.code="MODULE_NOT_FOUND",e}());t.isValidUTF8="object"==typeof e?e.Validation.isValidUTF8:e}catch(e){t.isValidUTF8=()=>!0}t.isValidStatusCode=e=>e>=1e3&&e<=1013&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},function(e,t,n){"use strict";const{randomFillSync:r}=n(16),o=n(130),{EMPTY_BUFFER:i}=n(74),{isValidStatusCode:s}=n(275),{mask:a,toBuffer:c}=n(131),u=Buffer.alloc(4);class Sender{constructor(e,t){this._extensions=t||{},this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){const n=t.mask&&t.readOnly;let o=t.mask?6:2,i=e.length;e.length>=65536?(o+=8,i=127):e.length>125&&(o+=2,i=126);const s=Buffer.allocUnsafe(n?e.length+o:o);return s[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(s[0]|=64),s[1]=i,126===i?s.writeUInt16BE(e.length,2):127===i&&(s.writeUInt32BE(0,2),s.writeUInt32BE(e.length,6)),t.mask?(r(u,0,4),s[1]|=128,s[o-4]=u[0],s[o-3]=u[1],s[o-2]=u[2],s[o-1]=u[3],n?(a(e,u,s,o,e.length),[s]):(a(e,u,e,0,e.length),[s,e])):[s,e]}close(e,t,n,r){let o;if(void 0===e)o=i;else{if("number"!=typeof e||!s(e))throw new TypeError("First argument must be a valid error code number");void 0===t||""===t?(o=Buffer.allocUnsafe(2),o.writeUInt16BE(e,0)):(o=Buffer.allocUnsafe(2+Buffer.byteLength(t)),o.writeUInt16BE(e,0),o.write(t,2))}this._deflating?this.enqueue([this.doClose,o,n,r]):this.doClose(o,n,r)}doClose(e,t,n){this.sendFrame(Sender.frame(e,{fin:!0,rsv1:!1,opcode:8,mask:t,readOnly:!1}),n)}ping(e,t,n){const r=c(e);this._deflating?this.enqueue([this.doPing,r,t,c.readOnly,n]):this.doPing(r,t,c.readOnly,n)}doPing(e,t,n,r){this.sendFrame(Sender.frame(e,{fin:!0,rsv1:!1,opcode:9,mask:t,readOnly:n}),r)}pong(e,t,n){const r=c(e);this._deflating?this.enqueue([this.doPong,r,t,c.readOnly,n]):this.doPong(r,t,c.readOnly,n)}doPong(e,t,n,r){this.sendFrame(Sender.frame(e,{fin:!0,rsv1:!1,opcode:10,mask:t,readOnly:n}),r)}send(e,t,n){const r=c(e),i=this._extensions[o.extensionName];let s=t.binary?2:1,a=t.compress;if(this._firstFragment?(this._firstFragment=!1,a&&i&&(a=r.length>=i._threshold),this._compress=a):(a=!1,s=0),t.fin&&(this._firstFragment=!0),i){const e={fin:t.fin,rsv1:a,opcode:s,mask:t.mask,readOnly:c.readOnly};this._deflating?this.enqueue([this.dispatch,r,this._compress,e,n]):this.dispatch(r,this._compress,e,n)}else this.sendFrame(Sender.frame(r,{fin:t.fin,rsv1:!1,opcode:s,mask:t.mask,readOnly:c.readOnly}),n)}dispatch(e,t,n,r){if(!t)return void this.sendFrame(Sender.frame(e,n),r);const i=this._extensions[o.extensionName];this._deflating=!0,i.compress(e,n.fin,(e,t)=>{this._deflating=!1,n.readOnly=!1,this.sendFrame(Sender.frame(t,n),r),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[1].length,Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[1].length,this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}e.exports=Sender},function(e,t,n){"use strict";const r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function push(e,t,n){void 0===e[t]?e[t]=[n]:e[t].push(n)}e.exports={format:function format(e){return Object.keys(e).map(t=>{let n=e[t];return Array.isArray(n)||(n=[n]),n.map(e=>[t].concat(Object.keys(e).map(t=>{let n=e[t];return Array.isArray(n)||(n=[n]),n.map(e=>!0===e?t:`${t}=${e}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function parse(e){const t=Object.create(null);if(void 0===e||""===e)return t;let n,o,i=Object.create(null),s=!1,a=!1,c=!1,u=-1,l=-1,d=0;for(;d<e.length;d++){const p=e.charCodeAt(d);if(void 0===n)if(-1===l&&1===r[p])-1===u&&(u=d);else if(32===p||9===p)-1===l&&-1!==u&&(l=d);else{if(59!==p&&44!==p)throw new SyntaxError("Unexpected character at index "+d);{if(-1===u)throw new SyntaxError("Unexpected character at index "+d);-1===l&&(l=d);const r=e.slice(u,l);44===p?(push(t,r,i),i=Object.create(null)):n=r,u=l=-1}}else if(void 0===o)if(-1===l&&1===r[p])-1===u&&(u=d);else if(32===p||9===p)-1===l&&-1!==u&&(l=d);else if(59===p||44===p){if(-1===u)throw new SyntaxError("Unexpected character at index "+d);-1===l&&(l=d),push(i,e.slice(u,l),!0),44===p&&(push(t,n,i),i=Object.create(null),n=void 0),u=l=-1}else{if(61!==p||-1===u||-1!==l)throw new SyntaxError("Unexpected character at index "+d);o=e.slice(u,d),u=l=-1}else if(a){if(1!==r[p])throw new SyntaxError("Unexpected character at index "+d);-1===u?u=d:s||(s=!0),a=!1}else if(c)if(1===r[p])-1===u&&(u=d);else if(34===p&&-1!==u)c=!1,l=d;else{if(92!==p)throw new SyntaxError("Unexpected character at index "+d);a=!0}else if(34===p&&61===e.charCodeAt(d-1))c=!0;else if(-1===l&&1===r[p])-1===u&&(u=d);else if(-1===u||32!==p&&9!==p){if(59!==p&&44!==p)throw new SyntaxError("Unexpected character at index "+d);{if(-1===u)throw new SyntaxError("Unexpected character at index "+d);-1===l&&(l=d);let r=e.slice(u,l);s&&(r=r.replace(/\\/g,""),s=!1),push(i,o,r),44===p&&(push(t,n,i),i=Object.create(null),n=void 0),o=void 0,u=l=-1}}else-1===l&&(l=d)}if(-1===u||c)throw new SyntaxError("Unexpected end of input");-1===l&&(l=d);const p=e.slice(u,l);return void 0===n?push(t,p,i):(void 0===o?push(i,p,!0):push(i,o,s?p.replace(/\\/g,""):p),push(t,n,i)),t}}},function(e,t,n){"use strict";const r=n(12).inspect,o=n(279),{applyMiddleware:i,commandMiddlewareFactory:s}=n(280),a=n(11),c=n(281),u=/(^\*)|(^\$0)/;e.exports=function command(e,t,l,d){const p={};let h,m={},y={};function shouldUpdateUsage(e){return!e.getUsageInstance().getUsageDisabled()&&0===e.getUsageInstance().getUsage().length}function usageFromParentCommandsCommandHandler(e,t){const n=u.test(t.original)?t.original.replace(u,"").trim():t.original,r=e.filter(e=>!u.test(e));return r.push(n),"$0 "+r.join(" ")}function populatePositional(e,t,n,r){const o=e.cmd[0];e.variadic?n[o]=t._.splice(0).map(String):t._.length&&(n[o]=[String(t._.shift())])}function postProcessPositionals(t,n,r){const o=Object.assign({},e.getOptions());o.default=Object.assign(r.default,o.default),o.alias=Object.assign(r.alias,o.alias),o.array=o.array.concat(r.array),delete o.config;const i=[];if(Object.keys(n).forEach(e=>{n[e].map(t=>{o.configuration["unknown-options-as-args"]&&(o.key[e]=!0),i.push("--"+e),i.push(t)})}),!i.length)return;const s=Object.assign({},o.configuration,{"populate--":!0}),a=c.detailed(i,Object.assign({},o,{configuration:s}));if(a.error)e.getUsageInstance().fail(a.error.message,a.error);else{const e=Object.keys(n);Object.keys(n).forEach(t=>{[].push.apply(e,a.aliases[t])}),Object.keys(a.argv).forEach(r=>{-1!==e.indexOf(r)&&(n[r]||(n[r]=a.argv[r]),t[r]=a.argv[r])})}}d=d||[],p.addHandler=function addHandler(e,o,i,c,l){let d=[];const g=s(l);if(c=c||(()=>{}),Array.isArray(e))d=e.slice(1),e=e[0];else if("object"==typeof e){let t=Array.isArray(e.command)||"string"==typeof e.command?e.command:function moduleName(e){const t=n(609)(e);if(!t)throw new Error("No command name given for module: "+r(e));return function commandFromFilename(e){return a.basename(e,a.extname(e))}(t.filename)}(e);return e.aliases&&(t=[].concat(t).concat(e.aliases)),void p.addHandler(t,function extractDesc(e){for(let t,n=["describe","description","desc"],r=0,o=n.length;r<o;r++)if(t=e[n[r]],"string"==typeof t||"boolean"==typeof t)return t;return!1}(e),e.builder,e.handler,e.middlewares)}if("object"==typeof i&&i.builder&&"function"==typeof i.handler)return void p.addHandler([e].concat(d),o,i.builder,i.handler,i.middlewares);const _=p.parseCommand(e);d=d.map(e=>p.parseCommand(e).cmd);let v=!1;const E=[_.cmd].concat(d).filter(e=>!u.test(e)||(v=!0,!1));0===E.length&&v&&E.push("$0"),v&&(_.cmd=E[0],d=E.slice(1),e=e.replace(u,_.cmd)),d.forEach(e=>{y[e]=_.cmd}),!1!==o&&t.command(e,o,v,d),m[_.cmd]={original:e,description:o,handler:c,builder:i||{},middlewares:g,demanded:_.demanded,optional:_.optional},v&&(h=m[_.cmd])},p.addDirectory=function addDirectory(e,t,r,o,i){"boolean"!=typeof(i=i||{}).recurse&&(i.recurse=!1),Array.isArray(i.extensions)||(i.extensions=["js"]);const s="function"==typeof i.visit?i.visit:e=>e;i.visit=function visit(e,n,r){const o=s(e,n,r);if(o){if(~t.files.indexOf(n))return o;t.files.push(n),p.addHandler(o)}return o},n(608)({require:r,filename:o},e,i)},p.parseCommand=function parseCommand(e){const t=e.replace(/\s{2,}/g," ").split(/\s+(?![^[]*]|[^<]*>)/),n=/\.*[\][<>]/g,r={cmd:t.shift().replace(n,""),demanded:[],optional:[]};return t.forEach((e,o)=>{let i=!1;e=e.replace(/\s/g,""),/\.+[\]>]/.test(e)&&o===t.length-1&&(i=!0),/^\[/.test(e)?r.optional.push({cmd:e.replace(n,"").split("|"),variadic:i}):r.demanded.push({cmd:e.replace(n,"").split("|"),variadic:i})}),r},p.getCommands=()=>Object.keys(m).concat(Object.keys(y)),p.getCommandHandlers=()=>m,p.hasDefaultCommand=()=>!!h,p.runCommand=function runCommand(e,t,n,r){let s=n.aliases;const a=m[e]||m[y[e]]||h,c=t.getContext();let u=c.files.length;const g=c.commands.slice();let _=n.argv,v=null,E={};e&&(c.commands.push(e),c.fullCommands.push(a.original)),"function"==typeof a.builder?(v=a.builder(t.reset(n.aliases)),v&&"function"==typeof v._parseArgs||(v=t),shouldUpdateUsage(v)&&v.getUsageInstance().usage(usageFromParentCommandsCommandHandler(g,a),a.description),_=v._parseArgs(null,null,!0,r),s=v.parsed.aliases):"object"==typeof a.builder&&(v=t.reset(n.aliases),shouldUpdateUsage(v)&&v.getUsageInstance().usage(usageFromParentCommandsCommandHandler(g,a),a.description),Object.keys(a.builder).forEach(e=>{v.option(e,a.builder[e])}),_=v._parseArgs(null,null,!0,r),s=v.parsed.aliases),t._hasOutput()||(E=function populatePositionals(e,t,n,r){t._=t._.slice(n.commands.length);const o=e.demanded.slice(0),i=e.optional.slice(0),s={};l.positionalCount(o.length,t._.length);for(;o.length;){populatePositional(o.shift(),t,s)}for(;i.length;){populatePositional(i.shift(),t,s)}return t._=n.commands.concat(t._),postProcessPositionals(t,s,p.cmdToParseOptions(e.original)),s}(a,_,c));const I=d.slice(0).concat(a.middlewares);if(i(_,t,I,!0),t._hasOutput()||t._runValidation(_,s,E,t.parsed.error),a.handler&&!t._hasOutput()){t._setHasOutput();let e;!!t.getOptions().configuration["populate--"]||t._copyDoubleDash(_),_=i(_,t,I,!1),e=o(_)?_.then(e=>a.handler(e)):a.handler(_);const n=t.getHandlerFinishCommand();o(e)?(t.getUsageInstance().cacheHelpMessage(),e.then(e=>{n&&n(e)}).catch(e=>{try{t.getUsageInstance().fail(null,e)}catch(e){}}).then(()=>{t.getUsageInstance().clearCachedHelpMessage()})):n&&n(e)}return e&&(c.commands.pop(),c.fullCommands.pop()),u=c.files.length-u,u>0&&c.files.splice(-1*u,u),_},p.runDefaultBuilderOn=function(e){if(shouldUpdateUsage(e)){const t=u.test(h.original)?h.original:h.original.replace(/^[^[\]<>]*/,"$0 ");e.getUsageInstance().usage(t,h.description)}const t=h.builder;"function"==typeof t?t(e):Object.keys(t).forEach(n=>{e.option(n,t[n])})},p.cmdToParseOptions=function(e){const t={array:[],default:{},alias:{},demand:{}},n=p.parseCommand(e);return n.demanded.forEach(e=>{const n=e.cmd.slice(0),r=n.shift();e.variadic&&(t.array.push(r),t.default[r]=[]),n.forEach(e=>{t.alias[r]=e}),t.demand[r]=!0}),n.optional.forEach(e=>{const n=e.cmd.slice(0),r=n.shift();e.variadic&&(t.array.push(r),t.default[r]=[]),n.forEach(e=>{t.alias[r]=e})}),t},p.reset=()=>(m={},y={},h=void 0,p);const g=[];return p.freeze=()=>{const e={};g.push(e),e.handlers=m,e.aliasMap=y,e.defaultCommand=h},p.unfreeze=()=>{const e=g.pop();m=e.handlers,y=e.aliasMap,h=e.defaultCommand},p}},function(e,t){e.exports=function isPromise(e){return!!e&&!!e.then&&"function"==typeof e.then}},function(e,t,n){"use strict";e.exports={applyMiddleware:function applyMiddleware(e,t,n,o){const i=new Error("middleware cannot return a promise when applyBeforeValidation is true");return n.reduce((n,s)=>{if(s.applyBeforeValidation!==o)return n;if(r(n))return n.then(e=>Promise.all([e,s(e,t)])).then(([e,t])=>Object.assign(e,t));{const a=s(e,t);if(o&&r(a))throw i;return r(a)?a.then(e=>Object.assign(n,e)):Object.assign(n,a)}},e)},commandMiddlewareFactory:function commandMiddlewareFactory(e){return e?e.map(e=>(e.applyBeforeValidation=!1,e)):[]},globalMiddlewareFactory:function globalMiddlewareFactory(e,t){return function(n,r=!1){if(o("<array|function> [boolean]",[n,r],arguments.length),Array.isArray(n)){for(let e=0;e<n.length;e++){if("function"!=typeof n[e])throw Error("middleware must be a function");n[e].applyBeforeValidation=r}Array.prototype.push.apply(e,n)}else"function"==typeof n&&(n.applyBeforeValidation=r,e.push(n));return t}}};const r=n(279),o=n(181)},function(e,t,n){const r=n(605),o=n(282),i=n(11),s=n(606),a=n(12);function parse(e,t){t=Object.assign(Object.create(null),t),e=s(e);const c=function combineAliases(e){const t=[],n=Object.create(null);let r=!0;Object.keys(e).forEach((function(n){t.push([].concat(e[n],n))}));for(;r;){r=!1;for(let e=0;e<t.length;e++)for(let n=e+1;n<t.length;n++){if(t[e].filter((function(e){return-1!==t[n].indexOf(e)})).length){t[e]=t[e].concat(t[n]),t.splice(n,1),r=!0;break}}}return t.forEach((function(e){e=e.filter((function(e,t,n){return n.indexOf(e)===t})),n[e.pop()]=e})),n}(Object.assign(Object.create(null),t.alias)),u=Object.assign({"boolean-negation":!0,"camel-case-expansion":!0,"combine-arrays":!1,"dot-notation":!0,"duplicate-arguments-array":!0,"flatten-duplicate-arrays":!0,"greedy-arrays":!0,"halt-at-non-option":!1,"nargs-eats-options":!1,"negation-prefix":"no-","parse-numbers":!0,"populate--":!1,"set-placeholder-key":!1,"short-option-groups":!0,"strip-aliased":!1,"strip-dashed":!1,"unknown-options-as-args":!1},t.configuration),l=Object.assign(Object.create(null),t.default),d=t.configObjects||[],p=t.envPrefix,h=u["populate--"],m=h?"--":"_",y=Object.create(null),g=Object.create(null),_=t.__||a.format,v={aliases:Object.create(null),arrays:Object.create(null),bools:Object.create(null),strings:Object.create(null),numbers:Object.create(null),counts:Object.create(null),normalize:Object.create(null),configs:Object.create(null),nargs:Object.create(null),coercions:Object.create(null),keys:[]},E=/^-([0-9]+(\.[0-9]+)?|\.[0-9]+)$/,I=new RegExp("^--"+u["negation-prefix"]+"(.+)");[].concat(t.array).filter(Boolean).forEach((function(e){const t=e.key||e,n=Object.keys(e).map((function(e){return{boolean:"bools",string:"strings",number:"numbers"}[e]})).filter(Boolean).pop();n&&(v[n][t]=!0),v.arrays[t]=!0,v.keys.push(t)})),[].concat(t.boolean).filter(Boolean).forEach((function(e){v.bools[e]=!0,v.keys.push(e)})),[].concat(t.string).filter(Boolean).forEach((function(e){v.strings[e]=!0,v.keys.push(e)})),[].concat(t.number).filter(Boolean).forEach((function(e){v.numbers[e]=!0,v.keys.push(e)})),[].concat(t.count).filter(Boolean).forEach((function(e){v.counts[e]=!0,v.keys.push(e)})),[].concat(t.normalize).filter(Boolean).forEach((function(e){v.normalize[e]=!0,v.keys.push(e)})),Object.keys(t.narg||{}).forEach((function(e){v.nargs[e]=t.narg[e],v.keys.push(e)})),Object.keys(t.coerce||{}).forEach((function(e){v.coercions[e]=t.coerce[e],v.keys.push(e)})),Array.isArray(t.config)||"string"==typeof t.config?[].concat(t.config).filter(Boolean).forEach((function(e){v.configs[e]=!0})):Object.keys(t.config||{}).forEach((function(e){v.configs[e]=t.config[e]})),function extendAliases(...e){e.forEach((function(e){Object.keys(e||{}).forEach((function(e){v.aliases[e]||(v.aliases[e]=[].concat(c[e]||[]),v.aliases[e].concat(e).forEach((function(t){if(/-/.test(t)&&u["camel-case-expansion"]){const n=r(t);n!==e&&-1===v.aliases[e].indexOf(n)&&(v.aliases[e].push(n),y[n]=!0)}})),v.aliases[e].concat(e).forEach((function(t){if(t.length>1&&/[A-Z]/.test(t)&&u["camel-case-expansion"]){const n=o(t,"-");n!==e&&-1===v.aliases[e].indexOf(n)&&(v.aliases[e].push(n),y[n]=!0)}})),v.aliases[e].forEach((function(t){v.aliases[t]=[e].concat(v.aliases[e].filter((function(e){return t!==e})))})))}))}))}(t.key,c,t.default,v.arrays),Object.keys(l).forEach((function(e){(v.aliases[e]||[]).forEach((function(t){l[t]=l[e]}))}));let b=null;!function checkConfiguration(){Object.keys(v.counts).find(e=>checkAllAliases(e,v.arrays)?(b=Error(_("Invalid configuration: %s, opts.count excludes opts.array.",e)),!0):checkAllAliases(e,v.nargs)?(b=Error(_("Invalid configuration: %s, opts.count excludes opts.narg.",e)),!0):void 0)}();let S=[];const C=Object.assign(Object.create(null),{_:[]}),w={};for(let t=0;t<e.length;t++){const n=e[t];let r,o,i,s,a,c;if("--"!==n&&isUnknownOptionAsArg(n))C._.push(n);else if(n.match(/^--.+=/)||!u["short-option-groups"]&&n.match(/^-.+=/))s=n.match(/^--?([^=]+)=([\s\S]*)$/),checkAllAliases(s[1],v.arrays)?t=eatArray(t,s[1],e,s[2]):!1!==checkAllAliases(s[1],v.nargs)?t=eatNargs(t,s[1],e,s[2]):setArg(s[1],s[2]);else if(n.match(I)&&u["boolean-negation"])o=n.match(I)[1],setArg(o,!!checkAllAliases(o,v.arrays)&&[!1]);else if(n.match(/^--.+/)||!u["short-option-groups"]&&n.match(/^-[^-]+/))o=n.match(/^--?(.+)/)[1],checkAllAliases(o,v.arrays)?t=eatArray(t,o,e):!1!==checkAllAliases(o,v.nargs)?t=eatNargs(t,o,e):(a=e[t+1],void 0===a||a.match(/^-/)&&!a.match(E)||checkAllAliases(o,v.bools)||checkAllAliases(o,v.counts)?/^(true|false)$/.test(a)?(setArg(o,a),t++):setArg(o,defaultValue(o)):(setArg(o,a),t++));else if(n.match(/^-.\..+=/))s=n.match(/^-([^=]+)=([\s\S]*)$/),setArg(s[1],s[2]);else if(n.match(/^-.\..+/)&&!n.match(E))a=e[t+1],o=n.match(/^-(.\..+)/)[1],void 0===a||a.match(/^-/)||checkAllAliases(o,v.bools)||checkAllAliases(o,v.counts)?setArg(o,defaultValue(o)):(setArg(o,a),t++);else if(n.match(/^-[^-]+/)&&!n.match(E)){i=n.slice(1,-1).split(""),r=!1;for(let s=0;s<i.length;s++){if(a=n.slice(s+2),i[s+1]&&"="===i[s+1]){c=n.slice(s+3),o=i[s],checkAllAliases(o,v.arrays)?t=eatArray(t,o,e,c):!1!==checkAllAliases(o,v.nargs)?t=eatNargs(t,o,e,c):setArg(o,c),r=!0;break}if("-"!==a){if(/[A-Za-z]/.test(i[s])&&/^-?\d+(\.\d*)?(e-?\d+)?$/.test(a)){setArg(i[s],a),r=!0;break}if(i[s+1]&&i[s+1].match(/\W/)){setArg(i[s],a),r=!0;break}setArg(i[s],defaultValue(i[s]))}else setArg(i[s],a)}o=n.slice(-1)[0],r||"-"===o||(checkAllAliases(o,v.arrays)?t=eatArray(t,o,e):!1!==checkAllAliases(o,v.nargs)?t=eatNargs(t,o,e):(a=e[t+1],void 0===a||/^(-|--)[^-]/.test(a)&&!a.match(E)||checkAllAliases(o,v.bools)||checkAllAliases(o,v.counts)?/^(true|false)$/.test(a)?(setArg(o,a),t++):setArg(o,defaultValue(o)):(setArg(o,a),t++)))}else if(n.match(/^-[0-9]$/)&&n.match(E)&&checkAllAliases(n.slice(1),v.bools))o=n.slice(1),setArg(o,defaultValue(o));else{if("--"===n){S=e.slice(t+1);break}if(u["halt-at-non-option"]){S=e.slice(t);break}C._.push(maybeCoerceNumber("_",n))}}function eatNargs(e,t,n,r){let o,i=checkAllAliases(t,v.nargs);if(i=isNaN(i)?1:i,0===i)return isUndefined(r)||(b=Error(_("Argument unexpected for: %s",t))),setArg(t,defaultValue(t)),e;let s=isUndefined(r)?0:1;if(u["nargs-eats-options"])n.length-(e+1)+s<i&&(b=Error(_("Not enough arguments following: %s",t))),s=i;else{for(o=e+1;o<n.length&&(!n[o].match(/^-[^0-9]/)||n[o].match(E)||isUnknownOptionAsArg(n[o]));o++)s++;s<i&&(b=Error(_("Not enough arguments following: %s",t)))}let a=Math.min(s,i);for(!isUndefined(r)&&a>0&&(setArg(t,r),a--),o=e+1;o<a+e+1;o++)setArg(t,n[o]);return e+a}function eatArray(e,t,n,r){let o=[],i=r||n[e+1];const s=checkAllAliases(t,v.nargs);if(checkAllAliases(t,v.bools)&&!/^(true|false)$/.test(i))o.push(!0);else if(isUndefined(i)||isUndefined(r)&&/^-/.test(i)&&!E.test(i)&&!isUnknownOptionAsArg(i)){if(void 0!==l[t]){const e=l[t];o=Array.isArray(e)?e:[e]}}else{isUndefined(r)||o.push(processValue(t,r));for(let r=e+1;r<n.length&&!(!u["greedy-arrays"]&&o.length>0||s&&o.length>=s)&&(i=n[r],!/^-/.test(i)||E.test(i)||isUnknownOptionAsArg(i));r++)e=r,o.push(processValue(t,i))}return(s&&o.length<s||isNaN(s)&&0===o.length)&&(b=Error(_("Not enough arguments following: %s",t))),setArg(t,o),e}function setArg(e,t){if(/-/.test(e)&&u["camel-case-expansion"]){const t=e.split(".").map((function(e){return r(e)})).join(".");!function addNewAlias(e,t){v.aliases[e]&&v.aliases[e].length||(v.aliases[e]=[t],y[t]=!0);v.aliases[t]&&v.aliases[t].length||addNewAlias(t,e)}(e,t)}const n=processValue(e,t),o=e.split(".");if(setKey(C,o,n),v.aliases[e]&&v.aliases[e].forEach((function(e){e=e.split("."),setKey(C,e,n)})),o.length>1&&u["dot-notation"]&&(v.aliases[o[0]]||[]).forEach((function(t){t=t.split(".");const r=[].concat(o);r.shift(),t=t.concat(r),(v.aliases[e]||[]).includes(t.join("."))||setKey(C,t,n)})),checkAllAliases(e,v.normalize)&&!checkAllAliases(e,v.arrays)){[e].concat(v.aliases[e]||[]).forEach((function(e){Object.defineProperty(w,e,{enumerable:!0,get:()=>t,set(e){t="string"==typeof e?i.normalize(e):e}})}))}}function processValue(e,t){"string"!=typeof t||"'"!==t[0]&&'"'!==t[0]||t[t.length-1]!==t[0]||(t=t.substring(1,t.length-1)),(checkAllAliases(e,v.bools)||checkAllAliases(e,v.counts))&&"string"==typeof t&&(t="true"===t);let n=Array.isArray(t)?t.map((function(t){return maybeCoerceNumber(e,t)})):maybeCoerceNumber(e,t);return checkAllAliases(e,v.counts)&&(isUndefined(n)||"boolean"==typeof n)&&(n=increment),checkAllAliases(e,v.normalize)&&checkAllAliases(e,v.arrays)&&(n=Array.isArray(t)?t.map(i.normalize):i.normalize(t)),n}function maybeCoerceNumber(e,t){if(!checkAllAliases(e,v.strings)&&!checkAllAliases(e,v.bools)&&!Array.isArray(t)){(function isNumber(e){return null!=e&&("number"==typeof e||(!!/^0x[0-9a-f]+$/i.test(e)||!(e.length>1&&"0"===e[0])&&/^[-]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(e)))}(t)&&u["parse-numbers"]&&Number.isSafeInteger(Math.floor(t))||!isUndefined(t)&&checkAllAliases(e,v.numbers))&&(t=Number(t))}return t}function setConfigObject(e,t){Object.keys(e).forEach((function(n){const r=e[n],o=t?t+"."+n:n;"object"==typeof r&&null!==r&&!Array.isArray(r)&&u["dot-notation"]?setConfigObject(r,o):(!hasKey(C,o.split("."))||checkAllAliases(o,v.arrays)&&u["combine-arrays"])&&setArg(o,r)}))}function applyEnvVars(e,t){if(void 0===p)return;const n="string"==typeof p?p:"";Object.keys(process.env).forEach((function(o){if(""===n||0===o.lastIndexOf(n,0)){const i=o.split("__").map((function(e,t){return 0===t&&(e=e.substring(n.length)),r(e)}));(t&&v.configs[i.join(".")]||!t)&&!hasKey(e,i)&&setArg(i.join("."),process.env[o])}}))}function applyDefaultsAndAliases(e,t,n,r=!1){Object.keys(n).forEach((function(o){hasKey(e,o.split("."))||(setKey(e,o.split("."),n[o]),r&&(g[o]=!0),(t[o]||[]).forEach((function(t){hasKey(e,t.split("."))||setKey(e,t.split("."),n[o])})))}))}function hasKey(e,t){let n=e;u["dot-notation"]||(t=[t.join(".")]),t.slice(0,-1).forEach((function(e){n=n[e]||{}}));const r=t[t.length-1];return"object"==typeof n&&r in n}function setKey(e,t,n){let r=e;u["dot-notation"]||(t=[t.join(".")]),t.slice(0,-1).forEach((function(e,t){e=sanitizeKey(e),"object"==typeof r&&void 0===r[e]&&(r[e]={}),"object"!=typeof r[e]||Array.isArray(r[e])?(Array.isArray(r[e])?r[e].push({}):r[e]=[r[e],{}],r=r[e][r[e].length-1]):r=r[e]}));const o=sanitizeKey(t[t.length-1]),i=checkAllAliases(t.join("."),v.arrays),s=Array.isArray(n);let a=u["duplicate-arguments-array"];!a&&checkAllAliases(o,v.nargs)&&(a=!0,(!isUndefined(r[o])&&1===v.nargs[o]||Array.isArray(r[o])&&r[o].length===v.nargs[o])&&(r[o]=void 0)),n===increment?r[o]=increment(r[o]):Array.isArray(r[o])?a&&i&&s?r[o]=u["flatten-duplicate-arrays"]?r[o].concat(n):(Array.isArray(r[o][0])?r[o]:[r[o]]).concat([n]):a||Boolean(i)!==Boolean(s)?r[o]=r[o].concat([n]):r[o]=n:void 0===r[o]&&i?r[o]=s?n:[n]:!a||void 0===r[o]||checkAllAliases(o,v.counts)||checkAllAliases(o,v.bools)?r[o]=n:r[o]=[r[o],n]}function checkAllAliases(e,t){const n=[].concat(v.aliases[e]||[],e),r=Object.keys(t),o=n.find(e=>r.includes(e));return!!o&&t[o]}function hasAnyFlag(e){return[].concat(Object.keys(v).map(e=>v[e])).some((function(t){return Array.isArray(t)?t.includes(e):t[e]}))}function isUnknownOptionAsArg(e){return u["unknown-options-as-args"]&&function isUnknownOption(e){if(e.match(E))return!1;if(function hasAllShortFlags(e){if(e.match(E)||!e.match(/^-[^-]+/))return!1;let t,n=!0;const r=e.slice(1).split("");for(let o=0;o<r.length;o++){if(t=e.slice(o+2),!hasAnyFlag(r[o])){n=!1;break}if(r[o+1]&&"="===r[o+1]||"-"===t||/[A-Za-z]/.test(r[o])&&/^-?\d+(\.\d*)?(e-?\d+)?$/.test(t)||r[o+1]&&r[o+1].match(/\W/))break}return n}(e))return!1;return!function hasFlagsMatching(e,...t){return[].concat(...t).some((function(t){const n=e.match(t);return n&&hasAnyFlag(n[1])}))}(e,/^-+([^=]+?)=[\s\S]*$/,I,/^-+([^=]+?)$/,/^-+([^=]+?)-$/,/^-+([^=]+?\d+)$/,/^-+([^=]+?)\W+.*$/)}(e)}function defaultValue(e){return checkAllAliases(e,v.bools)||checkAllAliases(e,v.counts)||!(""+e in l)?function defaultForType(e){return{boolean:!0,string:"",number:void 0,array:[]}[e]}(function guessType(e){let t="boolean";checkAllAliases(e,v.strings)?t="string":checkAllAliases(e,v.numbers)?t="number":checkAllAliases(e,v.bools)?t="boolean":checkAllAliases(e,v.arrays)&&(t="array");return t}(e)):l[e]}function isUndefined(e){return void 0===e}return applyEnvVars(C,!0),applyEnvVars(C,!1),function setConfig(e){const t=Object.create(null);applyDefaultsAndAliases(t,v.aliases,l),Object.keys(v.configs).forEach((function(r){const o=e[r]||t[r];if(o)try{let e=null;const t=i.resolve(process.cwd(),o);if("function"==typeof v.configs[r]){try{e=v.configs[r](t)}catch(t){e=t}if(e instanceof Error)return void(b=e)}else e=n(607)(t);setConfigObject(e)}catch(t){e[r]&&(b=Error(_("Invalid JSON config file: %s",o)))}}))}(C),function setConfigObjects(){if(void 0===d)return;d.forEach((function(e){setConfigObject(e)}))}(),applyDefaultsAndAliases(C,v.aliases,l,!0),function applyCoercions(e){let t;const n=new Set;Object.keys(e).forEach((function(r){if(!n.has(r)&&(t=checkAllAliases(r,v.coercions),"function"==typeof t))try{const o=maybeCoerceNumber(r,t(e[r]));[].concat(v.aliases[r]||[],r).forEach(t=>{n.add(t),e[t]=o})}catch(e){b=e}}))}(C),u["set-placeholder-key"]&&function setPlaceholderKeys(e){return v.keys.forEach(t=>{~t.indexOf(".")||void 0===e[t]&&(e[t]=void 0)}),e}(C),Object.keys(v.counts).forEach((function(e){hasKey(C,e.split("."))||setArg(e,0)})),h&&S.length&&(C[m]=[]),S.forEach((function(e){C[m].push(e)})),u["camel-case-expansion"]&&u["strip-dashed"]&&Object.keys(C).filter(e=>"--"!==e&&e.includes("-")).forEach(e=>{delete C[e]}),u["strip-aliased"]&&[].concat(...Object.keys(c).map(e=>c[e])).forEach(e=>{u["camel-case-expansion"]&&delete C[e.split(".").map(e=>r(e)).join(".")],delete C[e]}),{argv:Object.assign(w,C),error:b,aliases:Object.assign({},v.aliases),newAliases:Object.assign({},y),defaulted:Object.assign({},g),configuration:u}}function increment(e){return void 0!==e?e+1:1}function Parser(e,t){return parse(e.slice(),t).argv}function sanitizeKey(e){return"__proto__"===e?"___proto___":e}Parser.detailed=function(e,t){return parse(e.slice(),t)},e.exports=Parser},function(e,t,n){"use strict";e.exports=function(e,t){if("string"!=typeof e)throw new TypeError("Expected a string");return t=void 0===t?"_":t,e.replace(/([a-z\d])([A-Z])/g,"$1"+t+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+t+"$2").toLowerCase()}},function(e,t){e.exports=function(e){[process.stdout,process.stderr].forEach((function(t){t._handle&&t.isTTY&&"function"==typeof t._handle.setBlocking&&t._handle.setBlocking(e)}))}},function(e,t,n){const r=n(620),o={};for(const e of Object.keys(r))o[r[e]]=e;const i={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};e.exports=i;for(const e of Object.keys(i)){if(!("channels"in i[e]))throw new Error("missing channels property: "+e);if(!("labels"in i[e]))throw new Error("missing channel labels property: "+e);if(i[e].labels.length!==i[e].channels)throw new Error("channel and label counts mismatch: "+e);const{channels:t,labels:n}=i[e];delete i[e].channels,delete i[e].labels,Object.defineProperty(i[e],"channels",{value:t}),Object.defineProperty(i[e],"labels",{value:n})}i.rgb.hsl=function(e){const t=e[0]/255,n=e[1]/255,r=e[2]/255,o=Math.min(t,n,r),i=Math.max(t,n,r),s=i-o;let a,c;i===o?a=0:t===i?a=(n-r)/s:n===i?a=2+(r-t)/s:r===i&&(a=4+(t-n)/s),a=Math.min(60*a,360),a<0&&(a+=360);const u=(o+i)/2;return c=i===o?0:u<=.5?s/(i+o):s/(2-i-o),[a,100*c,100*u]},i.rgb.hsv=function(e){let t,n,r,o,i;const s=e[0]/255,a=e[1]/255,c=e[2]/255,u=Math.max(s,a,c),l=u-Math.min(s,a,c),diffc=function(e){return(u-e)/6/l+.5};return 0===l?(o=0,i=0):(i=l/u,t=diffc(s),n=diffc(a),r=diffc(c),s===u?o=r-n:a===u?o=1/3+t-r:c===u&&(o=2/3+n-t),o<0?o+=1:o>1&&(o-=1)),[360*o,100*i,100*u]},i.rgb.hwb=function(e){const t=e[0],n=e[1];let r=e[2];const o=i.rgb.hsl(e)[0],s=1/255*Math.min(t,Math.min(n,r));return r=1-1/255*Math.max(t,Math.max(n,r)),[o,100*s,100*r]},i.rgb.cmyk=function(e){const t=e[0]/255,n=e[1]/255,r=e[2]/255,o=Math.min(1-t,1-n,1-r);return[100*((1-t-o)/(1-o)||0),100*((1-n-o)/(1-o)||0),100*((1-r-o)/(1-o)||0),100*o]},i.rgb.keyword=function(e){const t=o[e];if(t)return t;let n,i=1/0;for(const t of Object.keys(r)){const o=r[t],c=(a=o,((s=e)[0]-a[0])**2+(s[1]-a[1])**2+(s[2]-a[2])**2);c<i&&(i=c,n=t)}var s,a;return n},i.keyword.rgb=function(e){return r[e]},i.rgb.xyz=function(e){let t=e[0]/255,n=e[1]/255,r=e[2]/255;t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,n=n>.04045?((n+.055)/1.055)**2.4:n/12.92,r=r>.04045?((r+.055)/1.055)**2.4:r/12.92;return[100*(.4124*t+.3576*n+.1805*r),100*(.2126*t+.7152*n+.0722*r),100*(.0193*t+.1192*n+.9505*r)]},i.rgb.lab=function(e){const t=i.rgb.xyz(e);let n=t[0],r=t[1],o=t[2];n/=95.047,r/=100,o/=108.883,n=n>.008856?n**(1/3):7.787*n+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,o=o>.008856?o**(1/3):7.787*o+16/116;return[116*r-16,500*(n-r),200*(r-o)]},i.hsl.rgb=function(e){const t=e[0]/360,n=e[1]/100,r=e[2]/100;let o,i,s;if(0===n)return s=255*r,[s,s,s];o=r<.5?r*(1+n):r+n-r*n;const a=2*r-o,c=[0,0,0];for(let e=0;e<3;e++)i=t+1/3*-(e-1),i<0&&i++,i>1&&i--,s=6*i<1?a+6*(o-a)*i:2*i<1?o:3*i<2?a+(o-a)*(2/3-i)*6:a,c[e]=255*s;return c},i.hsl.hsv=function(e){const t=e[0];let n=e[1]/100,r=e[2]/100,o=n;const i=Math.max(r,.01);r*=2,n*=r<=1?r:2-r,o*=i<=1?i:2-i;return[t,100*(0===r?2*o/(i+o):2*n/(r+n)),100*((r+n)/2)]},i.hsv.rgb=function(e){const t=e[0]/60,n=e[1]/100;let r=e[2]/100;const o=Math.floor(t)%6,i=t-Math.floor(t),s=255*r*(1-n),a=255*r*(1-n*i),c=255*r*(1-n*(1-i));switch(r*=255,o){case 0:return[r,c,s];case 1:return[a,r,s];case 2:return[s,r,c];case 3:return[s,a,r];case 4:return[c,s,r];case 5:return[r,s,a]}},i.hsv.hsl=function(e){const t=e[0],n=e[1]/100,r=e[2]/100,o=Math.max(r,.01);let i,s;s=(2-n)*r;const a=(2-n)*o;return i=n*o,i/=a<=1?a:2-a,i=i||0,s/=2,[t,100*i,100*s]},i.hwb.rgb=function(e){const t=e[0]/360;let n=e[1]/100,r=e[2]/100;const o=n+r;let i;o>1&&(n/=o,r/=o);const s=Math.floor(6*t),a=1-r;i=6*t-s,0!=(1&s)&&(i=1-i);const c=n+i*(a-n);let u,l,d;switch(s){default:case 6:case 0:u=a,l=c,d=n;break;case 1:u=c,l=a,d=n;break;case 2:u=n,l=a,d=c;break;case 3:u=n,l=c,d=a;break;case 4:u=c,l=n,d=a;break;case 5:u=a,l=n,d=c}return[255*u,255*l,255*d]},i.cmyk.rgb=function(e){const t=e[0]/100,n=e[1]/100,r=e[2]/100,o=e[3]/100;return[255*(1-Math.min(1,t*(1-o)+o)),255*(1-Math.min(1,n*(1-o)+o)),255*(1-Math.min(1,r*(1-o)+o))]},i.xyz.rgb=function(e){const t=e[0]/100,n=e[1]/100,r=e[2]/100;let o,i,s;return o=3.2406*t+-1.5372*n+-.4986*r,i=-.9689*t+1.8758*n+.0415*r,s=.0557*t+-.204*n+1.057*r,o=o>.0031308?1.055*o**(1/2.4)-.055:12.92*o,i=i>.0031308?1.055*i**(1/2.4)-.055:12.92*i,s=s>.0031308?1.055*s**(1/2.4)-.055:12.92*s,o=Math.min(Math.max(0,o),1),i=Math.min(Math.max(0,i),1),s=Math.min(Math.max(0,s),1),[255*o,255*i,255*s]},i.xyz.lab=function(e){let t=e[0],n=e[1],r=e[2];t/=95.047,n/=100,r/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,r=r>.008856?r**(1/3):7.787*r+16/116;return[116*n-16,500*(t-n),200*(n-r)]},i.lab.xyz=function(e){let t,n,r;n=(e[0]+16)/116,t=e[1]/500+n,r=n-e[2]/200;const o=n**3,i=t**3,s=r**3;return n=o>.008856?o:(n-16/116)/7.787,t=i>.008856?i:(t-16/116)/7.787,r=s>.008856?s:(r-16/116)/7.787,t*=95.047,n*=100,r*=108.883,[t,n,r]},i.lab.lch=function(e){const t=e[0],n=e[1],r=e[2];let o;o=360*Math.atan2(r,n)/2/Math.PI,o<0&&(o+=360);return[t,Math.sqrt(n*n+r*r),o]},i.lch.lab=function(e){const t=e[0],n=e[1],r=e[2]/360*2*Math.PI;return[t,n*Math.cos(r),n*Math.sin(r)]},i.rgb.ansi16=function(e,t=null){const[n,r,o]=e;let s=null===t?i.rgb.hsv(e)[2]:t;if(s=Math.round(s/50),0===s)return 30;let a=30+(Math.round(o/255)<<2|Math.round(r/255)<<1|Math.round(n/255));return 2===s&&(a+=60),a},i.hsv.ansi16=function(e){return i.rgb.ansi16(i.hsv.rgb(e),e[2])},i.rgb.ansi256=function(e){const t=e[0],n=e[1],r=e[2];if(t===n&&n===r)return t<8?16:t>248?231:Math.round((t-8)/247*24)+232;return 16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(r/255*5)},i.ansi16.rgb=function(e){let t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];const n=.5*(1+~~(e>50));return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},i.ansi256.rgb=function(e){if(e>=232){const t=10*(e-232)+8;return[t,t,t]}let t;e-=16;return[Math.floor(e/36)/5*255,Math.floor((t=e%36)/6)/5*255,t%6/5*255]},i.rgb.hex=function(e){const t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},i.hex.rgb=function(e){const t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let n=t[0];3===t[0].length&&(n=n.split("").map(e=>e+e).join(""));const r=parseInt(n,16);return[r>>16&255,r>>8&255,255&r]},i.rgb.hcg=function(e){const t=e[0]/255,n=e[1]/255,r=e[2]/255,o=Math.max(Math.max(t,n),r),i=Math.min(Math.min(t,n),r),s=o-i;let a,c;return a=s<1?i/(1-s):0,c=s<=0?0:o===t?(n-r)/s%6:o===n?2+(r-t)/s:4+(t-n)/s,c/=6,c%=1,[360*c,100*s,100*a]},i.hsl.hcg=function(e){const t=e[1]/100,n=e[2]/100,r=n<.5?2*t*n:2*t*(1-n);let o=0;return r<1&&(o=(n-.5*r)/(1-r)),[e[0],100*r,100*o]},i.hsv.hcg=function(e){const t=e[1]/100,n=e[2]/100,r=t*n;let o=0;return r<1&&(o=(n-r)/(1-r)),[e[0],100*r,100*o]},i.hcg.rgb=function(e){const t=e[0]/360,n=e[1]/100,r=e[2]/100;if(0===n)return[255*r,255*r,255*r];const o=[0,0,0],i=t%1*6,s=i%1,a=1-s;let c=0;switch(Math.floor(i)){case 0:o[0]=1,o[1]=s,o[2]=0;break;case 1:o[0]=a,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=s;break;case 3:o[0]=0,o[1]=a,o[2]=1;break;case 4:o[0]=s,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=a}return c=(1-n)*r,[255*(n*o[0]+c),255*(n*o[1]+c),255*(n*o[2]+c)]},i.hcg.hsv=function(e){const t=e[1]/100,n=t+e[2]/100*(1-t);let r=0;return n>0&&(r=t/n),[e[0],100*r,100*n]},i.hcg.hsl=function(e){const t=e[1]/100,n=e[2]/100*(1-t)+.5*t;let r=0;return n>0&&n<.5?r=t/(2*n):n>=.5&&n<1&&(r=t/(2*(1-n))),[e[0],100*r,100*n]},i.hcg.hwb=function(e){const t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},i.hwb.hcg=function(e){const t=e[1]/100,n=1-e[2]/100,r=n-t;let o=0;return r<1&&(o=(n-r)/(1-r)),[e[0],100*r,100*o]},i.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},i.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},i.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},i.gray.hsl=function(e){return[0,0,e[0]]},i.gray.hsv=i.gray.hsl,i.gray.hwb=function(e){return[0,100,e[0]]},i.gray.cmyk=function(e){return[0,0,0,e[0]]},i.gray.lab=function(e){return[e[0],0,0]},i.gray.hex=function(e){const t=255&Math.round(e[0]/100*255),n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n},i.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},function(e,t){function webpackEmptyContext(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,e.exports=webpackEmptyContext,webpackEmptyContext.id=285},function(e,t){function getProcessArgvBinIndex(){return function isBundledElectronApp(){return function isElectronApp(){return!!process.versions.electron}()&&!process.defaultApp}()?0:1}e.exports={getProcessArgvBin:function getProcessArgvBin(){return process.argv[getProcessArgvBinIndex()]},getProcessArgvWithoutBin:function getProcessArgvWithoutBin(){return process.argv.slice(getProcessArgvBinIndex()+1)}}},function(e,t,n){"use strict";var r=n(639),o=n(288),i=Object.prototype.hasOwnProperty;function isRetryError(e){return e&&"EPROMISERETRY"===e.code&&i.call(e,"retried")}e.exports=function promiseRetry(e,t){var n,i;return"object"==typeof e&&"function"==typeof t&&(n=t,t=e,e=n),i=o.operation(t),new Promise((function(t,n){i.attempt((function(o){Promise.resolve().then((function(){return e((function(e){throw isRetryError(e)&&(e=e.retried),r(new Error("Retrying"),"EPROMISERETRY",{retried:e})}),o)})).then(t,(function(e){isRetryError(e)&&(e=e.retried,i.retry(e||new Error))||n(e)}))}))}))}},function(e,t,n){e.exports=n(640)},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(59)),i=n(15),s=r(n(75)),a=r(n(76)),c=r(n(60)),u=n(94);class PropertyTemplate{constructor(e){this.getVersion=function(){if(this.isVersioned()){return u.TypeIdHelper.extractVersion(this.typeid).version}};const t=e?o.default(e):{};this.id=t.id,this.typeid=t.typeid,"array"===t.context&&(void 0!==t.length?this.length=t.length:this.length=0),this.context=t.context,this.properties=t.properties,this.annotation=t.annotation,this.constants=t.constants,this.inherits=a.default(t.inherits)?[t.inherits]:t.inherits,this.inherits&&this.inherits.includes("Enum")&&(this.enumDictionary=this._parseEnums(this.properties)),this.digestNestedInlineEnumProperties(this),this.serializedParams=e}static isTemplate(e){return!(!e.typeid||-1===e.typeid.indexOf(":"))}static extractDependencies(e){const t={};if(e.inherits){const n="string"==typeof e.inherits?[e.inherits]:e.inherits;for(let e=0;e<n.length;e++){if(u.TypeIdHelper.isCreationType(n[e]))continue;t[u.TypeIdHelper.extractTypeId(n[e])]=!0}}if(e.properties){const n=e.properties;for(let e=0;e<n.length;e++){const r=n[e];if(PropertyTemplate.isTemplate(r)){if(t[u.TypeIdHelper.extractTypeId(r.typeid)]=!0,r.typedValue)for(let e=0;e<r.typedValue.length;e++){t[r.typedValue[e].typeid]=!0}}else if(r.properties){const e=PropertyTemplate.extractDependencies(r);for(let n=0;n<e.length;n++){t[u.TypeIdHelper.extractTypeId(e[n])]=!0}}}}if(e.constants){const n=e.constants;for(let e=0;e<n.length;e++){const r=n[e];if(PropertyTemplate.isTemplate(r)){t[u.TypeIdHelper.extractTypeId(r.typeid)]=!0}else if("map"===r.context&&"typeid"===r.contextKeyType&&r.value){const e=Object.keys(r.value);for(let n=0;n<e.length;n++){t[u.TypeIdHelper.extractTypeId(e[n])]=!0}}if(r.typedValue)if(s.default(r.typedValue))for(let e=0;e<r.typedValue.length;e++){t[r.typedValue[e].typeid]=!0}else if(r.typedValue.typeid)t[r.typedValue.typeid]=!0;else{const e=Object.keys(r.typedValue);for(let n=0;n<e.length;n++){const o=r.typedValue[e[n]].typeid;o&&(t[o]=!0)}}}}return Object.keys(t)}getDependencies(){return PropertyTemplate.extractDependencies(this)}hasNestedProperties(){return this.properties&&this.properties.length>0}hasNestedConstants(){return this.constants&&this.constants.length>0}clone(){return new PropertyTemplate(this)}serialize(){return o.default(this.serializedParams)}getTypeidWithoutVersion(){if(this.isVersioned()){return u.TypeIdHelper.extractVersion(this.typeid).typeidWithoutVersion}return this.typeid}digestNestedInlineEnumProperties(e){if(e.properties)for(let t=0;t<e.properties.length;t++)if("Enum"===e.properties[t].typeid){const n=this._parseEnums(e.properties[t].properties);e.properties[t].enumDictionary=n}else e.properties[t].properties&&this.digestNestedInlineEnumProperties(e.properties[t])}_parseEnums(e){const t={enumEntriesById:{},enumEntriesByValue:{},defaultValue:void 0};let n;0!==e.length&&(n=e[0].value);for(let r=0;r<e.length;r++){const o=e[r],s=o.value;if(!o.id)throw new Error(i.MSG.ENUM_TYPEID_MISSING);if(!c.default(o.value))throw new Error(i.MSG.ENUM_VALUE_NOT_NUMBER+s);t.enumEntriesById[o.id]={value:s,annotation:o.annotation},t.enumEntriesByValue[s]={id:o.id,annotation:o.annotation},n=s<n?s:n}return t.enumEntriesByValue.hasOwnProperty(0)?t.defaultValue=0:t.defaultValue=n,t}isVersioned(){const e=u.TypeIdHelper.extractVersion(this.typeid);if(!e.version)return!1;const t=e.version;return/^(?:0|[1-9]\d*)\.(?:0|[1-9]\d*)\.(?:0|[1-9]\d*)$/.test(t)}}t.PropertyTemplate=PropertyTemplate},function(e,t,n){const r=n(77);e.exports={re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:n(134).SEMVER_SPEC_VERSION,SemVer:n(25),compareIdentifiers:n(187).compareIdentifiers,rcompareIdentifiers:n(187).rcompareIdentifiers,parse:n(78),valid:n(649),clean:n(650),inc:n(651),diff:n(652),major:n(653),minor:n(654),patch:n(655),prerelease:n(656),compare:n(38),rcompare:n(657),compareLoose:n(658),compareBuild:n(189),sort:n(659),rsort:n(660),gt:n(137),lt:n(190),eq:n(188),neq:n(291),gte:n(191),lte:n(192),cmp:n(292),coerce:n(661),Comparator:n(138),Range:n(39),satisfies:n(139),toComparators:n(665),maxSatisfying:n(666),minSatisfying:n(667),minVersion:n(668),validRange:n(669),outside:n(193),gtr:n(670),ltr:n(671),intersects:n(672),simplifyRange:n(673),subset:n(674)}},function(e,t,n){const r=n(38);e.exports=(e,t,n)=>0!==r(e,t,n)},function(e,t,n){const r=n(188),o=n(291),i=n(137),s=n(191),a=n(190),c=n(192);e.exports=(e,t,n,u)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return r(e,n,u);case"!=":return o(e,n,u);case">":return i(e,n,u);case">=":return s(e,n,u);case"<":return a(e,n,u);case"<=":return c(e,n,u);default:throw new TypeError("Invalid operator: "+t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(15);var o,i;!function(e){e[e.UNCOVERED=0]="UNCOVERED",e[e.PARTLY_COVERED=1]="PARTLY_COVERED",e[e.FULLY_COVERED=2]="FULLY_COVERED"}(o=t.CoverageExtent||(t.CoverageExtent={})),function(e){e[e.PATH_SEGMENT_TOKEN=0]="PATH_SEGMENT_TOKEN",e[e.ARRAY_TOKEN=1]="ARRAY_TOKEN",e[e.PATH_ROOT_TOKEN=2]="PATH_ROOT_TOKEN",e[e.DEREFERENCE_TOKEN=3]="DEREFERENCE_TOKEN",e[e.RAISE_LEVEL_TOKEN=4]="RAISE_LEVEL_TOKEN"}(i=t.TOKEN_TYPES||(t.TOKEN_TYPES={}));class PathHelper{static tokenizePathString(e,t){var n=[],o="";t&&t.splice(0,t.length);var s=0;if("/"===e[0])n.push("/"),t&&t.push(i.PATH_ROOT_TOKEN),s=1;else if("../"===e.substr(0,3)){var extractLevel=function(e){"../"===e.substr(0,3)&&(t&&t.push(i.RAISE_LEVEL_TOKEN),n.push("../"),extractLevel(e.substr(3)),s+=3)};extractLevel(e)}var a=e.substr(s);if(-1===e.indexOf("\\")&&-1===e.indexOf('"')&&-1===e.indexOf("*")){var c,u,l,d=[];for(c=(a=a.replace(this.RE_ALL_OPEN_SQUARE_BRACKETS,".[")).split("."),l=0;l<c.length&&0!==(u=c[l]).length;++l)if("["===u[0]){if(!(u.length>2&&"]"===u[u.length-1]))break;d.push(i.ARRAY_TOKEN),c[l]=u.substr(1,u.length-2)}else{if(-1!==u.indexOf("]"))break;d.push(i.PATH_SEGMENT_TOKEN)}if(l===c.length){if(t)for(l=0;l<d.length;l++)t.push(d[l]);return n.concat(c)}}var p=!1,h=!1,m=!1,y=!1,g=!0,storeNextToken=function(i){if(!h){if(y)return;throw new Error(r.MSG.EMPTY_TOKEN+e)}n.push(o),o="",h=!1,y=!1,m=!1,g=!1,t&&t.push(i)};for(let a=s;a<e.length;a++){var _=e[a];if('"'===_){if(h)throw new Error(r.MSG.QUOTES_WITHIN_TOKEN+e);var v=!1;for(a++;a<e.length;a++){if('"'===e[a]){v=!0;break}if("\\"===e[a]){if(!(e.length>a+1))throw new Error(r.MSG.INVALID_ESCAPE_SEQUENCE+e);if("\\"===e[a+1])o+="\\",a++;else{if('"'!==e[a+1])throw new Error(r.MSG.INVALID_ESCAPE_SEQUENCE+e);o+='"',a++}}else o+=e[a]}if(!v)throw new Error(r.MSG.UNCLOSED_QUOTATION_MARKS+e);m=!0,h=!0}else if(p)if("]"===_)if(storeNextToken(i.ARRAY_TOKEN),e.length>a+1)if(e[a+1]===r.PROPERTY_PATH_DELIMITER)p=!1,g=!0,a++;else if("["===e[a+1])a++;else{if("*"!==e[a+1])throw new Error(r.MSG.INVALID_END_OF_SQUARE_BRACKETS+e);p=!1}else p=!1,h=!1;else{if(_===r.PROPERTY_PATH_DELIMITER)throw new Error(r.MSG.DOTS_IN_SQUARE_BRACKETS+e);if(o+=_,h=!0,m)throw new Error(r.MSG.QUOTES_WITHIN_TOKEN+e)}else if(_===r.PROPERTY_PATH_DELIMITER)storeNextToken(i.PATH_SEGMENT_TOKEN),g=!0;else if("["===_)h&&storeNextToken(i.PATH_SEGMENT_TOKEN),p=!0;else{if("]"===_)throw new Error(r.MSG.CLOSING_BRACKET_WITHOUT_OPENING+e);if("*"===_)h&&storeNextToken(i.PATH_SEGMENT_TOKEN),n.push("*"),t&&t.push(i.DEREFERENCE_TOKEN),h=!1,y=!0,g=!1;else{if(!h&&!g&&!p)throw new Error(r.MSG.MISSING_DOT_AT_SEGMENT_START+e);if(o+=_,h=!0,m)throw new Error(r.MSG.QUOTES_WITHIN_TOKEN+e)}}}if(p)throw new Error(r.MSG.UNCLOSED_BRACKETS+e);if(e[e.length-1]===r.PROPERTY_PATH_DELIMITER)throw new Error(r.MSG.DOT_AT_END+e);return h&&storeNextToken(i.PATH_SEGMENT_TOKEN),n}static quotePathSegment(e){return'"'+(e=(e=e.replace(/\\/g,"\\\\")).replace(/"/g,'\\"'))+'"'}static quotePathSegmentIfNeeded(e){return-1!==e.indexOf(r.PROPERTY_PATH_DELIMITER)||-1!==e.indexOf('"')||-1!==e.indexOf("\\")||-1!==e.indexOf("/")||-1!==e.indexOf("*")||-1!==e.indexOf("[")||-1!==e.indexOf("]")||0===e.length?PathHelper.quotePathSegment(e):e}static checkValidRepositoryAbsolutePath(e){if(""!==e&&"/"!==e[0])throw new Error(r.MSG.INVALID_PATH_IN_REFERENCE)}static convertAbsolutePathToCanonical(e){const t=[],n=PathHelper.tokenizePathString(e,t);let o="";for(let s=0;s<t.length;s++){switch(t[s]){case i.PATH_ROOT_TOKEN:break;case i.RAISE_LEVEL_TOKEN:throw new Error('No level up ("../") is expected in an absolute path: '+e);case i.DEREFERENCE_TOKEN:throw new Error('Dereference ("*") is not supported in canonical paths: '+e);case i.ARRAY_TOKEN:case i.PATH_SEGMENT_TOKEN:o+=r.PROPERTY_PATH_DELIMITER+PathHelper.quotePathSegmentIfNeeded(n[s])}}return o&&(o=o.substring(1)),o}static getChildAbsolutePathCanonical(e,t){const n=PathHelper.quotePathSegmentIfNeeded(t);return e?e+r.PROPERTY_PATH_DELIMITER+n:n}static getPathCoverage(e,t){for(const n of t)if(e.startsWith(n))return{coverageExtent:o.FULLY_COVERED,pathList:[n]};const n=[];for(const r of t)r.startsWith(e)&&n.push(r);return n.length?{coverageExtent:o.PARTLY_COVERED,pathList:n}:{coverageExtent:o.UNCOVERED,pathList:n}}}t.default=PathHelper,PathHelper.RE_ALL_OPEN_SQUARE_BRACKETS=new RegExp("[[]","g")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(40),o=Array;t.UniversalDataArray=class UniversalDataArray{constructor(e,t=(e=>e)){this.buffer=new o(e),this.bufferConstructor=o,this.castFunctor=t,this.size=e}get length(){return this.size}getBufferCtor(){return this.bufferConstructor}getBuffer(){return this.buffer}insertRange(e,t){const n=this.buffer,r=new Array(t.length);for(let e=0;e<t.length;e++)r[e]=this.castFunctor(t[e]);n.splice.apply(this.buffer,[e,0].concat(r)),this.size=this.size+r.length}removeRange(e,t){if(!(e+t<this.buffer.length+1))throw new Error("DataArray removeRange offset + deleteCount is out of bounds.");this.buffer.splice(e,t),this.size-=t}set(e=0,t){if(t instanceof o)this.arraySet(this.buffer,t,e);else{if(!(t instanceof r.BaseDataArray))throw new Error("DataArray set() must be called with Array or DataArray");this.arraySet(this.buffer,t.serialize(),e)}}getValueRange(e,t){if(e>=this.size||t>this.size||e<0||t<0)throw new Error("Trying to access out of bounds!");return this.buffer.slice(e,t)}serialize(){return this.copy()}deserialize(e){const t=e,n=e.length;n!==this.size&&(this.resize(n),this.size=n);for(let e=0;e<n;e++)this.buffer[e]=this.castFunctor(t[e])}setValue(e,t){if(!(e<this.buffer.length))throw new Error("DataArray setValue idx is out of bounds.");this.buffer[e]=this.castFunctor(t)}getValue(e){if((e=void 0===e?0:e)>=this.size||e<0)throw new Error("Trying to access out of bounds!");return this.buffer[e]}push(e){const t=this.buffer.length;this.size>t-1&&this._alloc(2*this.size||1),this.setValue(this.size,e),this.size++}iterate(e){const t=this.size;for(let n=0;n<t;n++)e(this.buffer[n])}copy(){return this.buffer.slice(0)}resize(e){return this._alloc(e),this.size=e,this}_alloc(e){return this.buffer=this.resizeBufferArray(this.buffer,e),this}arraySet(e,t,n=0){let r=0;t.forEach(t=>{e[r+n]=this.castFunctor(t),r++})}resizeBufferArray(e,t){const n=new o(t),r=e,i=e.length>t;return this.arraySet(n,i?r.slice(0,t):r),n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(15),o=n(140),i=n(94),s=n(142),a=n(13),c=n(196);class ArrayBaseProperty extends o.ContainerProperty{constructor(e){super(e);const t=e.length||0;this.staticChildren={},this._isPrimitive=!1,this._dataArrayRef=new s.UniversalDataArray(t),this._dataArrayCreate(t),this.clean()}get length(){return this.getLength()}getDefaultContext(){return"array"}insert(e,t,n=!0,r=!1){this.insertRange(e,[t],n,r)}enqueue(e){return Array.isArray(e)?this.insertRange(this._dataArrayGetLength(),e):this.insertRange(this._dataArrayGetLength(),[e]),this._dataArrayGetLength()}unshift(e){return Array.isArray(e)?this.insertRange(0,e):this.insertRange(0,[e]),this._dataArrayGetLength()}remove(e){const t=this.get(e);return this.removeRange(e,1),t}pop(){if(this._dataArrayGetLength()>0){const e=this.get(this._dataArrayGetLength()-1);return this.remove(this._dataArrayGetLength()-1),e}}dequeue(){if(this._dataArrayGetLength()>0){const e=this.get(0);return this.remove(0),e}}set(e,t){if(Array.isArray(t))throw new Error(r.MSG.ARRAY_SET_ONE_ELEMENT+t);this.setRange(e,[t])}setValues(e){this._setValues(e,!1,!1)}clear(e=!0){this.getLength()&&this.removeRange(0,this.getLength(),e)}removeRange(e,t,n=!0){if(!isFinite(e))throw new Error(r.MSG.NOT_NUMBER+"offset, method: ArrayProperty.removeRange or .remove");if(!isFinite(t))throw new Error(r.MSG.NOT_NUMBER+"deleteCount, method: ArrayProperty.removeRange or .remove");if(e+t>this.getLength()||e<0||t<0)throw new Error(r.MSG.NOT_NUMBER+"offset, method: ArrayProperty.removeRange or .remove");const o=[];for(let n=e;n<e+t;n++){const e=this.get(n);o.push(e)}return this._checkIsNotReadOnly(!0),this._clearRange(e,t,n),o}setRange(e,t){if(e=Math.floor(e),!Array.isArray(t))throw new Error(r.MSG.IN_ARRAY_NOT_ARRAY+"ArrayProperty.setRange");if(!isFinite(e))throw new Error(r.MSG.NOT_NUMBER+"offset, method: ArrayProperty.setRange or .set");if(e<0||e+t.length>this.getLength())throw new Error(r.MSG.SET_OUT_OF_BOUNDS+"Cannot set "+t.length+" items starting at index "+e+". Array length: "+this.getLength());this._checkIsNotReadOnly(!0),this._modifyRange(e,t)}getIds(){return Object.keys(this._dataArrayGetBuffer())}has(e){return void 0!==this._dataArrayGetBuffer()[e]}get(e){const t=Math.floor(e);if(!isFinite(t))throw new Error(r.MSG.IN_POSITION_MUST_BE_NUMBER);return this._dataArrayGetValue(t)}getLength(){return this._dataArrayGetLength()}getPathSegmentForChildNode(e){const t=this._dataArrayGetBuffer().indexOf(e);if(-1===t)throw new Error(r.MSG.GET_PATH_SEGMENT_CALLED_FOR_NON_ENTRY);return"["+t+"]"}getFullTypeid(e=!1){return e?this._typeid:i.TypeIdHelper.createSerializationTypeId(this._typeid,"array")}_prettyPrintChildren(e,t){e+="  ";const n=this.getIds();for(let r=0;r<n.length;r++)this.get(Math.floor(n[r]))._prettyPrint(e,n[r]+": ",t)}updateDirtyChangeSetAtRemove(e,t){this.isDirty=!!this.isDirty&&this.isDirty;const n=e+t-1;-1===this.findAndHandleOverlappingRange(this.dirtyChangeSet.insert,e,n,!1,{overlappingRangeCallback:(e,t,r,o)=>(this.handleDeletingEntries(e,r,t,n,o),-1),nonOverlappingRangeCallback:()=>{this.addToRemoveObject(e,t,n)},deleteCount:t})&&this.decreaseIndexesInSet(this.dirtyChangeSet.insert,e),this.findAndHandleOverlappingRange(this.dirtyChangeSet.modify,e,n,!0,{overlappingRangeCallback:(e,t,r,o)=>(this.handleDeletingEntries(e,r,t,n,o),r),deleteCount:t}),this.dirtyChangeSet.modify=this.dirtyChangeSet.modify.filter(e=>void 0!==e[0]),this.dirtyChangeSet.insert=this.dirtyChangeSet.insert.filter(e=>void 0!==e[0])}addToRemoveObject(e,t,n){const r={overlappingRangeCallback:(t,n)=>(n+t[1]===this.getLength()?t[1]=-1:t[1]++,e),nonOverlappingRangeCallback:()=>{e+t-1===this.getLength()-1&&(t=-1),this.dirtyChangeSet.remove.push([e,t])},deleteCount:t};this.findAndHandleOverlappingRange(this.dirtyChangeSet.remove,e,n,!0,r)}handleDeletingEntries(e,t,n,r,o){if(0!==o){const n=e[0],i=t-n,s=Math.abs(i);if(i>0){const t=e[1].splice(s,o);t.length,o-=t.length}else{const t=r-n+1,i=e[1].splice(0,t);e[0]+=i.length,i.length,o-=i.length}a(e[1])&&(e[0]=void 0)}}increaseIndexesInSet(e,t,n){void 0!==e&&e.forEach(e=>{e[0]>t&&(e[0]=n?e[0]+n:e[0]+1)})}decreaseIndexesInSet(e,t,n=1){e.forEach(e=>{e[0]>t&&(e[0]=e[0]-n)})}findAndHandleOverlappingRange(e,t,n,r,o){let i=!1,s=t;for(const a of e){const e=a[0],c=r?o.deleteCount:a[1].length,u=a[0]+c-1;(e>=t&&e<=n||u>=t&&u<=n||e<=t&&u>=n)&&(void 0!==o.overlappingRangeCallback&&(s=o.overlappingRangeCallback(a,e,t,o.deleteCount),-1!==s&&(t=s)),i=!0)}return i||void 0===o.nonOverlappingRangeCallback||o.nonOverlappingRangeCallback(),s}clean(){this.dirtyChangeSet={insert:[],modify:[],remove:[]},this._isDirty=!1}_serialize(){return this.groomDirtyChangeSet(),this.dirtyChangeSet}groomDirtyChangeSet(){this.dirtyChangeSet=c(this.dirtyChangeSet,a)}_dataArrayGetLength(){return this._dataArrayRef.length}_dataArrayGetBuffer(){return this._dataArrayRef.getBuffer()}_dataArrayGetValue(e){return this._dataArrayRef.getValue(e)}_dataArraySetValue(e,t){this._dataArrayRef.setValue(e,t)}_dataArrayDeserialize(e){this._dataArrayRef.deserialize(e)}_dataArrayInsertRange(e,t){this._dataArrayRef.insertRange(e,t)}_dataArrayRemoveRange(e,t){this._dataArrayRef.removeRange(e,t)}_dataArraySetRange(e,t){this._dataArrayRef.set(e,t)}_clearRange(e,t,n){n&&this.updateDirtyChangeSetAtRemove(e,t),this._dataArrayRemoveRange(e,t)}}t.ArrayBaseProperty=ArrayBaseProperty},function(e,t,n){"use strict";var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(75)),s=o(n(96)),a=o(n(689)),c=n(97),u=n(15),l=n(99);class IndexedCollectionBaseProperty extends c.ContainerProperty{constructor(e={}){super(e),this._containsPrimitiveTypes=!1,this.dynamicChildren={},this.dirtyOperations={},this.forceRemoves={}}get(e){return this.dynamicChildren[e]}_insert(e,t){if(this._checkIsNotReadOnly(!1),this.dynamicChildren[e])throw new Error(u.MSG.PROPERTY_ALREADY_EXISTS+e);!this._containsPrimitiveTypes&&t instanceof c.BaseProperty&&(t._validateInsertIn(this,e),t._setId(e),t._setParent(this)),this.dirtyOperations[e]===l.ChangeSetOperations.REMOVE?this.forceRemoves[e]=!0:this._setDirty(),this.dirtyOperations[e]=l.ChangeSetOperations.INSERT,this.dynamicChildren[e]=t}_removeByKey(e){if(this._checkIsNotReadOnly(!1),this.staticChildren[e])throw new Error(u.MSG.CANT_REMOVE_STATIC_CHILDREN);if(void 0===this.dynamicChildren[e])throw new Error(u.MSG.REMOVED_NON_EXISTING_ENTRY+e);this.dynamicChildren[e]instanceof c.BaseProperty&&this.dynamicChildren[e]._setParent(void 0),delete this.dynamicChildren[e],this.dirtyOperations[e]===l.ChangeSetOperations.INSERT?this.childWasCleaned(e.toString()):(this.dirtyOperations[e]=l.ChangeSetOperations.REMOVE,delete this.forceRemoves[e],this._setDirty())}_serialize(){const e=super._serialize();return this._isDirty&&(Object.entries(this.forceRemoves).forEach(t=>{e[l.ChangeSetOperations.REMOVE]||(e[l.ChangeSetOperations.REMOVE]=[]),e[l.ChangeSetOperations.REMOVE].push(t[0])}),Object.entries(this.dirtyOperations).forEach(t=>{const n=t[0],r=t[1];if(r===l.ChangeSetOperations.REMOVE)e[r]||(e[r]=[]),e[r].push(t[0]);else{const t=this.get(n),r=t.getExtendedTypeid(),o=this.dirtyOperations[n];s.default(e,[o,r,n],t._serialize())}})),e}_deserialize(e,t){const{insert:n,modify:o,remove:i}=e,s=r(e,["insert","modify","remove"]);if(super._deserialize(s,t),i||o)throw new Error(u.MSG.NO_NORMALIZED_CHANGESET);const c=n?Object.entries(n).reduce((e,t)=>[...e,...Object.keys(t[1])],[]):[];a.default(Object.keys(this.dynamicChildren),c).forEach(e=>{this._removeByKey(e)}),n&&Object.entries(n).forEach(([e,n])=>{Object.entries(n).forEach(([n,r])=>{let o=this.get(n);o&&o.getTypeid()!==e&&(this._removeByKey(n),o=void 0),void 0===o&&(o=this.propertyFactory.create(e),this._insert(n,o)),o._deserialize(r,t)})})}_setDirty(e){void 0!==e&&this.dynamicChildren[e]&&this.dirtyOperations[e]!==l.ChangeSetOperations.INSERT&&(this.dirtyOperations[e]=l.ChangeSetOperations.MODIFY),super._setDirty(e)}_applyChangeSet(e){if(super._applyChangeSet(e),!l.ChangeSet.isEmpty(e)){if(e.remove){if(!i.default(e.remove))throw new Error(u.MSG.REVERSIBLE_CHANGESET_NOT_SUPPORTED);e.remove.forEach(e=>{this._removeByKey(e)})}e.insert&&Object.entries(e.insert).forEach(([e,t])=>{Object.entries(t).forEach(([t,n])=>{if(this.has(t))throw new Error(u.MSG.INSERTED_EXISTING_ENTRY+t);const r=this.propertyFactory.create(e);r._applyChangeSet(n),this._insert(t,r)})}),e.modify&&Object.entries(e.modify).forEach(([e,t])=>{Object.entries(t).forEach(([e,t])=>{if(!this.has(e))throw new Error(u.MSG.MODIFY_NON_EXISTING_ENTRY+e);const n=this.get(e);if(!(n instanceof c.BaseProperty))throw new Error(u.MSG.DELTA_ON_PRIMITIVE_NOT_SUPPORTED);n._applyChangeSet(t)})})}}getChildrenIds(){return[...Object.keys(this.dynamicChildren),...Object.keys(this.staticChildren)]}isClean(){if(!super.isClean())return!1;return 0===Object.keys(this.dirtyOperations).length}childWasCleaned(e){delete this.dirtyOperations[e],super.childWasCleaned(e)}cleanSelf(){this.dirtyOperations={},this.forceRemoves={},super.cleanSelf()}}t.IndexedCollectionBaseProperty=IndexedCollectionBaseProperty},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(296),o=n(94);class IndexedMapCollectionBaseProperty extends r.IndexedCollectionBaseProperty{constructor(e){super(e),this._context=this.getDefaultContext()}getDefaultContext(){return"map"}getFullTypeid(e=!1){return e?this._typeid:o.TypeIdHelper.createSerializationTypeId(this._typeid,"map")}getEntriesReadOnly(){return this.dynamicChildren}has(e){return void 0!==this.dynamicChildren[e]}remove(e){var t=this.get(e);return this._removeByKey(e),t}clear(){var e=this;this.getIds().forEach((function(t){e.remove(t)}))}getIds(){return Object.keys(this.dynamicChildren)}}t.IndexedMapCollectionBaseProperty=IndexedMapCollectionBaseProperty},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(195)),i=n(98),s=n(99),a=n(15);class ValueProperty extends i.BaseProperty{constructor(e){super(e),this._data=void 0,this._typeid=this.getDefaultTypeid()}get value(){return this.getValue()}set value(e){this.setValue(e)}getValue(){return this._data}setValue(e){this._checkIsNotReadOnly(!this.isEqual(e)),this._setValue(e)}_serialize(){if(this._isDirty)return this._data}_deserialize(e){if(s.ChangeSet.isEmpty(e))throw new Error(a.MSG.DESERIALIZE_EMPTY_CHANGESET);const t=o.default(e,"value")?e.value:e;this.setValue(t)}_applyChangeSet(e){if(!s.ChangeSet.isEmpty(e)){const t="object"==typeof e?e.value:e;this._setValue(t)}}_prettyPrint(e,t,n){n(`${e}${t}${this.getId()} (${this.getTypeid()}): ${this.value}`)}isEqual(e){return this.value===e}_setValue(e){const t=this._data,n=this._castFunctor(e),r=n!==t;return r&&(this._data=n,this._setDirty()),r}_toJson(){return{id:this.getId(),context:this._context,typeid:this.getTypeid(),isConstant:this._isConstant,value:this.getValue()}}}t.ValueProperty=ValueProperty},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(54),o=n(300),i=n(79);class Int8Property extends r.ValueProperty{constructor(e){super(e),this._data=0}getDefaultTypeid(){return"Int8"}_castFunctor(e){return r._castFunctors.Int8(e)}}t.Int8Property=Int8Property;class Int16Property extends r.ValueProperty{constructor(e){super(e),this._data=0}getDefaultTypeid(){return"Int16"}_castFunctor(e){return r._castFunctors.Int16(e)}}t.Int16Property=Int16Property;class Int32Property extends r.ValueProperty{constructor(e){super(e),this._data=0}getDefaultTypeid(){return"Int32"}_castFunctor(e){return r._castFunctors.Int32(e)}}t.Int32Property=Int32Property;class Int64Property extends o.Integer64Property{getDefaultTypeid(){return"Int64"}_castFunctor(e,t){return r._castFunctors.Int64(e,t)}createInteger(e,t){return new i.Int64(e,t)}}t.Int64Property=Int64Property},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(54),o=n(79),i=n(195),s=n(99),a=n(15);class Integer64Property extends r.ValueProperty{constructor(e){super(e),this._data=this.createInteger(0,0)}getValueHigh(){return this._data.getValueHigh()}getValueLow(){return this._data.getValueLow()}setValueHigh(e){const t=this._data.getValueHigh()!==e;if(t){const t=this.createInteger(this.getValueLow(),e);this._data=t}return t}setValueLow(e){const t=this._data.getValueLow()!==e;if(t){const t=this.createInteger(e,this.getValueHigh());this._data=t}return t}toString(e=10){return this._data.toString(e)}fromString(e,t){const n=this._castFunctor(e,t);this.setValueHigh(n.getValueHigh()),this.setValueLow(n.getValueLow())}isEqual(e){return e instanceof o.Integer64&&(this.getValueHigh()===e.getValueHigh()&&this.getValueLow()===e.getValueLow())}_setValue(e){const t=this._data.getValueLow(),n=this._data.getValueHigh(),r=(e=this._castFunctor(e)).getValueHigh(),o=e.getValueLow(),i=n!==r||t!==o;return i&&(this._data=e.clone()),i}_serialize(){if(this._isDirty)return[this.getValueLow(),this.getValueHigh()]}_deserialize(e){if(s.ChangeSet.isEmpty(e))throw new Error(a.MSG.DESERIALIZE_EMPTY_CHANGESET);const t=i(e,"value")?e.value:e;this.setValueLow(t[0]),this.setValueHigh(t[1])}}t.Integer64Property=Integer64Property},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(15),o=n(94),i={BaseProperty:!0,ContainerProperty:!0,NodeProperty:!0,Enum:!0};t.PropertyTemplateWrapper=class PropertyTemplateWrapper{constructor(e){this.constructSubProperties=(e,t,n)=>{const r=Object.keys(t);void 0===e[n]&&0!==r.length&&(e[n]=[]);const o=e[n]||[];for(const e of o){const n=e.id;t[n]&&(this.mergeProperty(e,t[n]),delete t[n])}for(const e of r){const n=t[e];n&&o.push(n)}o.length>0&&(e[n]=o)},this.propertyTemplate=e,this.compiledPropertyTemplate=void 0,this.objectCreationType=void 0}getPropertyTemplate(){return this.propertyTemplate}getCompiledTemplate(e){return void 0===this.compiledPropertyTemplate&&(this.compiledPropertyTemplate=this.constructCompiledTemplate(e)),this.compiledPropertyTemplate}hasCompiledTemplate(){return!!this.compiledPropertyTemplate}getCreationType(){return this.objectCreationType}constructCompiledTemplate(e){const t=this.getPropertyTemplate();this.setCreationType(t.typeid);let n=t.inherits;"string"==typeof n&&(n=[n]);const o=t.clone();let s=n?n.slice():[];const a={},c={};if(void 0!==n)for(const t of n)if(this.setCreationType(t),!i[t]){const n=e.getSchemaWrapper(t);if(n){const t=n.getCompiledTemplate(e),o=n.getCreationType();if("ContainerProperty"!==o&&this.setCreationType(o),t.inherits&&(s=[...s,...t.inherits]),t.hasNestedProperties()){const e=t.properties;for(const t of e){if(a[t.id]||c[t.id])throw new Error(r.MSG.OVERWRITING_ID+t.id);a[t.id]=t}}if(t.hasNestedConstants()){const e=t.constants;for(const t of e){if(c[t.id]||a[t.id])throw new Error(r.MSG.OVERWRITING_ID+t.id);c[t.id]=t}}}}return void 0===this.objectCreationType&&this.setCreationType("ContainerProperty"),this.constructSubProperties(o,a,"properties"),this.constructSubProperties(o,c,"constants"),s.length>0&&(o.inherits=s),o}setCreationType(e){if(o.TypeIdHelper.isCreationType(e)){const t=this.objectCreationType;if(void 0===t)this.objectCreationType=e;else if(t!==e)throw new Error(r.MSG.ONLY_ONE_CREATION_TYPE+t+", "+e)}}mergeProperty(e,t){this.mergeField(e,t,"context","single"),this.mergeField(e,t,"contextKeyType","string"),this.mergeField(e,t,"length",0),this.mergeField(e,t,"optional",!1),this.mergeField(e,t,"typeid",void 0),void 0!==t.typedValue&&void 0===e.typedValue&&(e.typedValue=t.typedValue),void 0!==t.value&&void 0===e.value&&(e.value=t.value),this.mergeSubProperties(e,t,"properties"),this.mergeSubProperties(e,t,"constants")}mergeField(e,t,n,o){if(void 0===e[n])void 0!==t[n]&&(e[n]=t[n]);else if(e[n]!==t[n]&&(e[n]!==o||void 0!==t[n]))throw new Error(r.MSG.OVERRIDEN_PROP_MUST_HAVE_SAME_FIELD_VALUES_AS_BASE_TYPE+n+" as the base type: "+e.id+": "+e[n]+" != "+t[n])}mergeSubProperties(e,t,n){const r={},o=t[n],i=e[n]||[];if(o){for(const e of o)r[e.id]=e;for(const e of i){const t=e.id;r[t]&&(this.mergeProperty(e,r[t]),delete r[t])}const e=Object.keys(r);for(const t of e){const e=r[t];e&&i.push(e)}}i.length>0&&(e[n]=i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(30);class SimpleLogger{constructor(e,t){this.logHandler=e,this.logLevel=t||r.LogLevel.ERROR}info(e){this.log(e,r.LogLevel.INFO)}debug(e){this.log(e,r.LogLevel.DEBUG)}warn(e){this.log(e,r.LogLevel.WARN)}error(e){this.log(e,r.LogLevel.ERROR)}levelEnabled(e){return e>=this.logLevel}log(e,t){this.levelEnabled(t)&&this.logHandler(SimpleLogger.buildMessage(e,t))}static buildMessage(e,t){return`[${(new Date).toISOString()}] [${r.LogLevel[t]}] ${e}`}}t.SimpleLogger=SimpleLogger},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(145);class InternalError extends r.SDKError{constructor(e,t,n){super("You should not be receiving this error. Please report this to Forge developers: "+e,t,Object.assign({code:r.SDKErrorCode.INTERNAL_ERROR},n),InternalError.name)}}t.InternalError=InternalError},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0});const o=n(19),i=n(197),s="[This error is unexpectedly missing a stack trace]",fixJournalErrorStack=e=>{const{stack:t}=e;if(!t)return s;if(!("Error:"!==t.substr(0,6))){let n=t;return n=n.replace("Error:",e.constructor.name+":"),n}return t},fixJournalObjectError=e=>"Object"===e?"Error":e;class NestedError extends Error{constructor(e,t,n){super(e),this.name=n||Error.name,this.innerError=t,this.originalStack=this.stack;let r="";this.innerError&&(r=this.innerError instanceof o.JournalError?(e=>{let t=e,n="";for(;t;)t.stack?n+="\nCaused by "+fixJournalErrorStack(t):n+=`\nCaused by ${fixJournalObjectError(t.constructor.name)}: ${t.message}\n${s}`,t=t instanceof o.JournalError?t.innerError:void 0;return n})(this.innerError):this.innerError.stack?"\nCaused by "+this.innerError.stack:`\nCaused by ${fixJournalObjectError(this.innerError.constructor.name)}: ${this.innerError.message}\n${s}`),this.stack?this.stack=`${this.stack.toString()}${r}`:this.stack=`${this.message}\n${s}\n${r}`}}r([i.NonEnumerable],NestedError.prototype,"innerError",void 0),r([i.NonEnumerable],NestedError.prototype,"originalStack",void 0),r([i.NonEnumerable],NestedError.prototype,"name",void 0),t.NestedError=NestedError},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toSortingString=function toSortingString(e){return e.map(e=>{if(e.startsWith("-"))return e.substring(1)+" desc";if(e.startsWith("+"))return e.substring(1)+" asc";return["asc","desc","ASC","DESC"].some(t=>e.endsWith(t))?e:e+" asc"}).join(",")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AUTH_PROVIDER="acm",t.attributesMultiple=["has.attribute.type","has.component.type"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileHelper=class FileHelper{static getChunksQuantity(e,t){return 0===e?1:Math.ceil(e/t)}static generateChunksQueue(e){return new Array(e).fill(null).map((e,t)=>t).reverse()}static getChunkRange(e,t,n,r){const o=e*t;return`bytes ${o}-${o+n-1}/${r}`}static sizeToBytes(e,t){const n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"].indexOf(t);return e*Math.pow(1024,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(30),o=n(2);class EntityIdentifier{constructor(e,t=null){this.id=e,this.revisionId=t||r.TIP_REVISION}getKey(){return this.revisionId!==r.TIP_REVISION?`${this.id}/${this.revisionId}`:""+this.id}isEqual(e){return this.id===e.id&&this.revisionId===e.revisionId}static from(e){const t=e.split("/");if(!t[0]||0===t[0].length)throw new o.SDKError("Cannot create EntityIdentifier from provided key "+e);return new EntityIdentifier(t[0],t[1]&&t[1].length>0?t[1]:r.TIP_REVISION)}}t.EntityIdentifier=EntityIdentifier},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(766)),s=n(14),a=n(6),c=n(310),u=n(2),l=n(767);class Batch{constructor(e,t=[]){this.entities=new Set(t),this.sdkCore=e}addEntity(e){this.entities.add(e)}removeEntity(e){return this.entities.delete(e)}listEntities(){return[...this.entities.values()]}hasEntity(e){return this.entities.has(e)}execute(){return r(this,void 0,void 0,(function*(){const e=new a.BatchResultBuilder;if(0===this.entities.size)return e.build();const t=Array.from(this.entities).filter(e=>!(e instanceof s.SpaceCollection&&e.isNewResource()));yield Batch.batchSaveSpaceCollections(this.entities,e),this.entities.clear();const n=Batch.splitBatchByCollection(t),r=Object.entries(n).map(([t,n])=>Batch.saveEntities(t,n,this.sdkCore.getDataConnector(),e));for(const e of r)yield e;return e.build()}))}static batchSaveSpaceCollections(e,t){return r(this,void 0,void 0,(function*(){const n=[];for(const t of e)t.isNewResource()&&t instanceof s.SpaceCollection&&n.push(t);const o=n.map(e=>r(this,void 0,void 0,(function*(){const n=yield e.save();for(const r of n.errors)t.withError(e,r);for(const r of n.successes)t.withSuccess(e,r)})));yield Promise.all(o)}))}static splitBatchByCollection(e){const t={};for(const n of e){const e=n instanceof s.SpaceCollection?n.getId():n.getSpaceCollectionID();let r=t[e];r||(r=[],t[e]=r),r.push(n)}return t}static saveEntities(e,t,n,o){return r(this,void 0,void 0,(function*(){const r=new Map,s=new l.CommandDependencyBatcher;for(const e of t){const t=c.befriend(e).getSaveCommands();for(const e of t)s.addCommand(e)}const a=[];for(const e of s.commands){const t=e.serialize(s);r.set(t,e),t.dependsOn&&(t.dependsOn=i.default(t.dependsOn)),e.canDependOnPreviousBatches(t.dependsOn)&&(t.dependsOn=void 0),a.push(t)}const d=yield n.executeCommands(a,e);for(const[e,t]of d.entries()){const n=r.get(e);if(!n)throw new u.InternalError("Unknown command executed");for(const e of n.getAffectedEntities())t instanceof Error?o.withError(e,t):(e.upgrade({successes:[t],errors:[],pendingCommands:[]},!0),o.withSuccess(e,t))}}))}}t.Batch=Batch},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.befriend=function befriend(e){return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6);class IdentifiableMap{constructor(){this.unsaved=new Map,this.saved=new Map}*keys(){for(const e of this.unsaved.keys())yield e;for(const e of this.saved.keys())yield e}clear(){this.saved.clear(),this.unsaved.clear()}set(e,t){const n=r.extractIdOrReference(e);return"string"==typeof n?this.saved.set(n,t):this.unsaved.set(n,t),this}has(e){const t=r.extractIdOrReference(e);return"string"==typeof t?this.saved.has(t):this.unsaved.has(t)}get(e){const t=r.extractIdOrReference(e);return"string"==typeof t?this.saved.get(t):this.unsaved.get(t)}delete(e){const t=r.extractIdOrReference(e);return"string"==typeof t?this.saved.delete(t):this.unsaved.delete(t)}get size(){return this.saved.size+this.unsaved.size}*[Symbol.iterator](){for(const e of this.saved)yield e;for(const e of this.unsaved)yield e}}t.IdentifiableMap=IdentifiableMap},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(62)),s=o(n(790)),a=n(19),c=n(41),u=n(827),l=n(30),d=n(147),p=n(6),h=n(339),m=o(n(857)),y=n(2);t.DataConnector=class DataConnector{constructor(e,t,n,r){this.tracing=r&&r.tracing,this.connectionOptions=e,this.client=r&&r.client||i.default.create({baseURL:this.connectionOptions.host}),this.runner=r&&r.runner||new y.RequestRunner(n),this.logger=n,this.settings=s.default(r&&r.settings,m.default),this.binaryClient=new h.OSSClient(this.client,this.connectionOptions,this.settings.binaryOptions),this.journals=t}getSettings(){return this.settings}isJournalRemote(e){return r(this,void 0,void 0,(function*(){return(yield this.journals.get(e)).getType()===l.JournalType.REMOTE}))}executeCommandsOnJournal(e,t){return r(this,void 0,void 0,(function*(){const n=yield this.journals.get(t),r=e.map(e=>e.commandName).join(",");return this.logger.debug(`[executeCommands] Commands ${r} sent to journal ${n.getId()} [${n.getType()}]`),n.executeCommands(e)}))}executeCommands(e,t){var n;return r(this,void 0,void 0,(function*(){if(!p.isSerializableCommands(e))throw new y.InternalError("Attempting to execute commands that are not serializable.");this.tracing&&this.addTracingToCommands(e);const r=new Map;let o;try{o=yield this.executeCommandsOnJournal(e,t)}catch(e){throw new y.SDKError("Unexpected Journal Error while executing a command: "+e.message,e)}for(let t=0;t<o.length;t++){const i=o[t],s=e[t];if(void 0===i){const e=new y.InternalError("Missing result for command "+s.commandName);this.logger.error(JSON.stringify(e)),r.set(s,e)}else if(null===(n=i.result)||void 0===n?void 0:n.error){const e=new y.CommandError(i.result.error.message,i.result.error.trackingId,i.result.error);this.logger.error(JSON.stringify(e)),r.set(s,e)}else{if(!i.result)throw new y.InternalError(`Unexpected error while executing ${s.commandName}: ${i.toString()}`);r.set(s,i.result)}}return r}))}createCollection(e){return r(this,void 0,void 0,(function*(){try{return p.withSpan(this.tracing,"create","collection",()=>r(this,void 0,void 0,(function*(){this.addTracingToCommands([e]);const{commandResult:t}=yield this.journals.createCollection(e.commandName,e.parameters);return{successes:[t],errors:[],pendingCommands:[]}})))}catch(e){return{successes:[],errors:[e],pendingCommands:[]}}}))}handleSingleEntityCommands(e,t){return r(this,void 0,void 0,(function*(){const n={successes:[],errors:[],pendingCommands:[]};let r;return 0!==e.length&&(r=yield this.executeCommands(e,t)),r?r.forEach(e=>{e instanceof Error?n.errors.push(e):n.successes.push(e)}):n.pendingCommands=e,n}))}executeQueryUrl(e,t){return r(this,void 0,void 0,(function*(){return this.runner.executeRequest(()=>r(this,void 0,void 0,(function*(){const n=yield this.connectionOptions.getToken();let r=e;const o={headers:Object.assign(Object.assign({},d.headers),{Authorization:"Bearer "+n})};if(this.injectTracingHeaders(o.headers),t){const n=p.RequestTools.extractParamsFromUrl(e);r=n.url,o.params=Object.assign(Object.assign({},n.params),{limit:t})}return(yield this.client.get(r,o)).data})))}))}uploadBinaryData(e){return r(this,void 0,void 0,(function*(){return this.logger.debug(`[uploadBinaryData] url: ${e.signedUrl}, size:${e.size}`),this.runner.executeRequest(()=>r(this,void 0,void 0,(function*(){const t=(new p.RequestBuilder).url(e.signedUrl).defaultHeaders().headersFrom(this.getJournalHeaders()).headersFrom(this.getTracingHeaders()).header("Content-Type","application/octet-stream").authToken(this.connectionOptions.getToken);p.isNode()&&t.header("Content-Length",""+e.size),e.contentRange&&e.sessionId&&(t.header("Content-Range",e.contentRange),t.header("Session-Id",e.sessionId),this.logger.debug("[uploadBinaryData] Content-Range: "+e.contentRange+", Session-Id:"+e.sessionId));const n=yield t.build();yield this.client.put(n.url,e.data,n.config)})))}))}uploadBinaryComplete(e){return r(this,void 0,void 0,(function*(){if(!e.status)throw new y.InternalError("[uploadBinaryComplete] status is a required parameter");const t={commandName:"CompleteUpload",parameters:{spaceCollectionId:e.spaceCollectionId,resourceId:e.resourceId,status:e.status},dependsOn:[]};return this.handleSingleEntityCommands([t],e.spaceCollectionId)}))}getUploadBinarySignedURL(e){return r(this,void 0,void 0,(function*(){if(null==e.resumable)throw new y.InternalError("[getUploadBinarySignedUrl] resumable is a required parameter");const t={commandName:"UploadBinaryAsset",parameters:e,dependsOn:[]},n=yield this.handleSingleEntityCommands([t],e.spaceCollectionId);if(p.throwServerErrorIfNecessary(n),!n)throw new y.InternalError(`Command ${t.commandName}: No response received`);if(!n.successes||n.successes.length<=0)throw new y.InternalError(`Command ${t.commandName}: Response is empty`);return n.successes[0]}))}downloadBinary(e){return r(this,void 0,void 0,(function*(){return p.withSpan(this.tracing,"downloadBinary","OSS",()=>this.runner.executeRequest(()=>r(this,void 0,void 0,(function*(){const t=yield(new p.RequestBuilder).url(d.urls.binaryDownload,e).build(),n=this.getTracingHeaders();return this.binaryClient.getSignedResource(t.url,e.source,e.revisionId,n)}))))}))}query(e,t,n,o="get"){return r(this,void 0,void 0,(function*(){return this.runner.executeRequest(()=>r(this,void 0,void 0,(function*(){const r=yield(new p.RequestBuilder).url(e,t).queryParams(t,n).defaultHeaders().headersFrom(this.getJournalHeaders()).headersFrom(this.getTracingHeaders()).authToken(this.connectionOptions.getToken).build();switch(this.logger.debug("[DataConnector][query] request: "+r.url),o){case"post":return(yield this.client.post(r.url,r.body,r.config)).data;case"get":default:return(yield this.client.get(r.url,r.config)).data}})))}))}journalQuery(e,t){return r(this,void 0,void 0,(function*(){return this.runner.executeQuery(()=>r(this,void 0,void 0,(function*(){const n=p.extractId(t.spaceCollectionId);if(!n)throw new y.InternalError("Cannot determine which journal to use. Missing spaceCollectionId in query parameters.");let r;try{r=yield this.journals.get(n)}catch(e){throw new y.SDKError("With status: 403 Details: Journal not found for collection "+n,e)}const o=p.RequestTools.prepareParams(t),i=Object.assign(Object.assign({},t),o);return this.internalJournalQuery(r,e,i)})))}))}internalJournalQuery(e,t,n){return r(this,void 0,void 0,(function*(){this.logger.debug(`[DataConnector][journalQuery] Query ${t} sent to journal ${e.getId()} [${e.getType()}]`);const r=e.getType()===l.JournalType.REMOTE?a.FetchMode.ONLY_SERVER:a.FetchMode.LOCAL_OR_SERVER,o=this.getTracingHeaders();return this.logger.debug("Doing executeQuery in span "+o),e.executeQuery(t,n,{fetchMode:r})}))}getJournalHeaders(){const{config:e}=this.journals.getImplementation();return e&&e.clientConfig&&e.clientConfig.headers?e.clientConfig.headers:{}}injectTracingHeaders(e){if(void 0!==this.tracing){(new u.HttpTraceContext).inject(c.context.active(),e,(e,t,n)=>{e[t]=n})}}getTracingHeaders(){const e={};return this.injectTracingHeaders(e),e}addTracingToCommands(e){const t=this.getTracingHeaders();e.forEach(e=>{e.parameters=e.parameters||{},e.parameters.metadata=e.parameters.metadata||{},e.parameters.metadata.trace?this.logger.warn(`Command ${e.commandName} already has tracing metadata`):e.parameters.metadata.trace={traceparent:t.traceparent,tracestate:t.tracestate}})}}},function(e,t,n){"use strict";e.exports=function bind(e,t){return function wrap(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){"use strict";e.exports=function isCancel(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";var r=n(28),o=n(773),i={"Content-Type":"application/x-www-form-urlencoded"};function setContentTypeIfUnset(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s={adapter:function getDefaultAdapter(){var e;return"undefined"!=typeof XMLHttpRequest?e=n(774):"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process)&&(e=n(780)),e}(),transformRequest:[function transformRequest(e,t){return o(t,"Accept"),o(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(setContentTypeIfUnset(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(setContentTypeIfUnset(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function transformResponse(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function validateStatus(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function forEachMethodNoData(e){s.headers[e]={}})),r.forEach(["post","put","patch"],(function forEachMethodWithData(e){s.headers[e]=r.merge(i)})),e.exports=s},function(e,t,n){"use strict";var r=n(200);e.exports=function settle(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";e.exports=function enhanceError(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,n){"use strict";var r=n(776),o=n(777);e.exports=function buildFullPath(e,t){return e&&!r(t)?o(e,t):t}},function(e,t,n){var r=n(51),o=r.URL,i=n(37),s=n(57),a=n(180).Writable,c=n(46),u=n(781),l=Object.create(null);["abort","aborted","connect","error","socket","timeout"].forEach((function(e){l[e]=function(t,n,r){this._redirectable.emit(e,t,n,r)}}));var d=createErrorType("ERR_FR_REDIRECTION_FAILURE",""),p=createErrorType("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded"),h=createErrorType("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),m=createErrorType("ERR_STREAM_WRITE_AFTER_END","write after end");function RedirectableRequest(e,t){a.call(this),this._sanitizeOptions(e),this._options=e,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],t&&this.on("response",t);var n=this;this._onNativeResponse=function(e){n._processResponse(e)},this._performRequest()}function wrap(e){var t={maxRedirects:21,maxBodyLength:10485760},n={};return Object.keys(e).forEach((function(i){var s=i+":",a=n[s]=e[i],l=t[i]=Object.create(a);Object.defineProperties(l,{request:{value:function request(e,i,a){if("string"==typeof e){var l=e;try{e=urlToOptions(new o(l))}catch(t){e=r.parse(l)}}else o&&e instanceof o?e=urlToOptions(e):(a=i,i=e,e={protocol:s});return"function"==typeof i&&(a=i,i=null),(i=Object.assign({maxRedirects:t.maxRedirects,maxBodyLength:t.maxBodyLength},e,i)).nativeProtocols=n,c.equal(i.protocol,s,"protocol mismatch"),u("options",i),new RedirectableRequest(i,a)},configurable:!0,enumerable:!0,writable:!0},get:{value:function get(e,t,n){var r=l.request(e,t,n);return r.end(),r},configurable:!0,enumerable:!0,writable:!0}})})),t}function noop(){}function urlToOptions(e){var t={protocol:e.protocol,hostname:e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:e.pathname+e.search,href:e.href};return""!==e.port&&(t.port=Number(e.port)),t}function removeMatchingHeaders(e,t){var n;for(var r in t)e.test(r)&&(n=t[r],delete t[r]);return n}function createErrorType(e,t){function CustomError(e){Error.captureStackTrace(this,this.constructor),this.message=e||t}return CustomError.prototype=new Error,CustomError.prototype.constructor=CustomError,CustomError.prototype.name="Error ["+e+"]",CustomError.prototype.code=e,CustomError}RedirectableRequest.prototype=Object.create(a.prototype),RedirectableRequest.prototype.abort=function(){this._currentRequest.removeAllListeners(),this._currentRequest.on("error",noop),this._currentRequest.abort(),this.emit("abort"),this.removeAllListeners()},RedirectableRequest.prototype.write=function(e,t,n){if(this._ending)throw new m;if(!("string"==typeof e||"object"==typeof e&&"length"in e))throw new TypeError("data should be a string, Buffer or Uint8Array");"function"==typeof t&&(n=t,t=null),0!==e.length?this._requestBodyLength+e.length<=this._options.maxBodyLength?(this._requestBodyLength+=e.length,this._requestBodyBuffers.push({data:e,encoding:t}),this._currentRequest.write(e,t,n)):(this.emit("error",new h),this.abort()):n&&n()},RedirectableRequest.prototype.end=function(e,t,n){if("function"==typeof e?(n=e,e=t=null):"function"==typeof t&&(n=t,t=null),e){var r=this,o=this._currentRequest;this.write(e,t,(function(){r._ended=!0,o.end(null,null,n)})),this._ending=!0}else this._ended=this._ending=!0,this._currentRequest.end(null,null,n)},RedirectableRequest.prototype.setHeader=function(e,t){this._options.headers[e]=t,this._currentRequest.setHeader(e,t)},RedirectableRequest.prototype.removeHeader=function(e){delete this._options.headers[e],this._currentRequest.removeHeader(e)},RedirectableRequest.prototype.setTimeout=function(e,t){var n=this;function startTimer(){n._timeout&&clearTimeout(n._timeout),n._timeout=setTimeout((function(){n.emit("timeout"),clearTimer()}),e)}function clearTimer(){clearTimeout(this._timeout),t&&n.removeListener("timeout",t),this.socket||n._currentRequest.removeListener("socket",startTimer)}return t&&this.on("timeout",t),this.socket?startTimer():this._currentRequest.once("socket",startTimer),this.once("response",clearTimer),this.once("error",clearTimer),this},["flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach((function(e){RedirectableRequest.prototype[e]=function(t,n){return this._currentRequest[e](t,n)}})),["aborted","connection","socket"].forEach((function(e){Object.defineProperty(RedirectableRequest.prototype,e,{get:function(){return this._currentRequest[e]}})})),RedirectableRequest.prototype._sanitizeOptions=function(e){if(e.headers||(e.headers={}),e.host&&(e.hostname||(e.hostname=e.host),delete e.host),!e.pathname&&e.path){var t=e.path.indexOf("?");t<0?e.pathname=e.path:(e.pathname=e.path.substring(0,t),e.search=e.path.substring(t))}},RedirectableRequest.prototype._performRequest=function(){var e=this._options.protocol,t=this._options.nativeProtocols[e];if(t){if(this._options.agents){var n=e.substr(0,e.length-1);this._options.agent=this._options.agents[n]}var o=this._currentRequest=t.request(this._options,this._onNativeResponse);for(var i in this._currentUrl=r.format(this._options),o._redirectable=this,l)i&&o.on(i,l[i]);if(this._isRedirect){var s=0,a=this,c=this._requestBodyBuffers;!function writeNext(e){if(o===a._currentRequest)if(e)a.emit("error",e);else if(s<c.length){var t=c[s++];o.finished||o.write(t.data,t.encoding,writeNext)}else a._ended&&o.end()}()}}else this.emit("error",new TypeError("Unsupported protocol "+e))},RedirectableRequest.prototype._processResponse=function(e){var t=e.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:e.headers,statusCode:t});var n=e.headers.location;if(n&&!1!==this._options.followRedirects&&t>=300&&t<400){if(this._currentRequest.removeAllListeners(),this._currentRequest.on("error",noop),this._currentRequest.abort(),e.destroy(),++this._redirectCount>this._options.maxRedirects)return void this.emit("error",new p);((301===t||302===t)&&"POST"===this._options.method||303===t&&!/^(?:GET|HEAD)$/.test(this._options.method))&&(this._options.method="GET",this._requestBodyBuffers=[],removeMatchingHeaders(/^content-/i,this._options.headers));var o=removeMatchingHeaders(/^host$/i,this._options.headers)||r.parse(this._currentUrl).hostname,i=r.resolve(this._currentUrl,n);u("redirecting to",i),this._isRedirect=!0;var s=r.parse(i);if(Object.assign(this._options,s),s.hostname!==o&&removeMatchingHeaders(/^authorization$/i,this._options.headers),"function"==typeof this._options.beforeRedirect){var a={headers:e.headers};try{this._options.beforeRedirect.call(null,this._options,a)}catch(e){return void this.emit("error",e)}this._sanitizeOptions(this._options)}try{this._performRequest()}catch(e){var c=new d("Redirected request failed: "+e.message);c.cause=e,this.emit("error",c)}}else e.responseUrl=this._currentUrl,e.redirects=this._redirects,this.emit("response",e),this._requestBodyBuffers=[]},e.exports=wrap({http:i,https:s}),e.exports.wrap=wrap},function(e,t,n){"use strict";e.exports=function setup(e){function selectColor(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return createDebug.colors[Math.abs(t)%createDebug.colors.length]}function createDebug(e){var t;function debug(){if(debug.enabled){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=debug,i=Number(new Date),s=i-(t||i);o.diff=s,o.prev=t,o.curr=i,t=i,n[0]=createDebug.coerce(n[0]),"string"!=typeof n[0]&&n.unshift("%O");var a=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,t){if("%%"===e)return e;a++;var r=createDebug.formatters[t];if("function"==typeof r){var i=n[a];e=r.call(o,i),n.splice(a,1),a--}return e})),createDebug.formatArgs.call(o,n);var c=o.log||createDebug.log;c.apply(o,n)}}return debug.namespace=e,debug.enabled=createDebug.enabled(e),debug.useColors=createDebug.useColors(),debug.color=selectColor(e),debug.destroy=destroy,debug.extend=extend,"function"==typeof createDebug.init&&createDebug.init(debug),createDebug.instances.push(debug),debug}function destroy(){var e=createDebug.instances.indexOf(this);return-1!==e&&(createDebug.instances.splice(e,1),!0)}function extend(e,t){return createDebug(this.namespace+(void 0===t?":":t)+e)}return createDebug.debug=createDebug,createDebug.default=createDebug,createDebug.coerce=function coerce(e){if(e instanceof Error)return e.stack||e.message;return e},createDebug.disable=function disable(){createDebug.enable("")},createDebug.enable=function enable(e){var t;createDebug.save(e),createDebug.names=[],createDebug.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?createDebug.skips.push(new RegExp("^"+e.substr(1)+"$")):createDebug.names.push(new RegExp("^"+e+"$")));for(t=0;t<createDebug.instances.length;t++){var o=createDebug.instances[t];o.enabled=createDebug.enabled(o.namespace)}},createDebug.enabled=function enabled(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=createDebug.skips.length;t<n;t++)if(createDebug.skips[t].test(e))return!1;for(t=0,n=createDebug.names.length;t<n;t++)if(createDebug.names[t].test(e))return!0;return!1},createDebug.humanize=n(784),Object.keys(e).forEach((function(t){createDebug[t]=e[t]})),createDebug.instances=[],createDebug.names=[],createDebug.skips=[],createDebug.formatters={},createDebug.selectColor=selectColor,createDebug.enable(createDebug.load()),createDebug}},function(e,t,n){"use strict";var r=n(28);e.exports=function mergeConfig(e,t){t=t||{};var n={},o=["url","method","data"],i=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function getMergedValue(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function mergeDeepProperties(o){r.isUndefined(t[o])?r.isUndefined(e[o])||(n[o]=getMergedValue(void 0,e[o])):n[o]=getMergedValue(e[o],t[o])}r.forEach(o,(function valueFromConfig2(e){r.isUndefined(t[e])||(n[e]=getMergedValue(void 0,t[e]))})),r.forEach(i,mergeDeepProperties),r.forEach(s,(function defaultToConfig2(o){r.isUndefined(t[o])?r.isUndefined(e[o])||(n[o]=getMergedValue(void 0,e[o])):n[o]=getMergedValue(void 0,t[o])})),r.forEach(a,(function merge(r){r in t?n[r]=getMergedValue(e[r],t[r]):r in e&&(n[r]=getMergedValue(void 0,e[r]))}));var c=o.concat(i).concat(s).concat(a),u=Object.keys(e).concat(Object.keys(t)).filter((function filterAxiosKeys(e){return-1===c.indexOf(e)}));return r.forEach(u,mergeDeepProperties),n}},function(e,t,n){"use strict";function Cancel(e){this.message=e}Cancel.prototype.toString=function toString(){return"Cancel"+(this.message?": "+this.message:"")},Cancel.prototype.__CANCEL__=!0,e.exports=Cancel},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultGetter=void 0,t.defaultGetter=function defaultGetter(e,t){return e[t]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_HTTP_TEXT_PROPAGATOR=t.NoopHttpTextPropagator=void 0;var r=function(){function NoopHttpTextPropagator(){}return NoopHttpTextPropagator.prototype.inject=function(e,t,n){},NoopHttpTextPropagator.prototype.extract=function(e,t,n){return e},NoopHttpTextPropagator}();t.NoopHttpTextPropagator=r,t.NOOP_HTTP_TEXT_PROPAGATOR=new r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSetter=void 0,t.defaultSetter=function defaultSetter(e,t,n){e[t]=n}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function __(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_BATCH_OBSERVER_METRIC=t.NOOP_SUM_OBSERVER_METRIC=t.NOOP_UP_DOWN_SUM_OBSERVER_METRIC=t.NOOP_VALUE_OBSERVER_METRIC=t.NOOP_BOUND_BASE_OBSERVER=t.NOOP_VALUE_RECORDER_METRIC=t.NOOP_BOUND_VALUE_RECORDER=t.NOOP_COUNTER_METRIC=t.NOOP_BOUND_COUNTER=t.NOOP_METER=t.NoopBoundBaseObserver=t.NoopBoundValueRecorder=t.NoopBoundCounter=t.NoopBatchObserverMetric=t.NoopBaseObserverMetric=t.NoopValueRecorderMetric=t.NoopCounterMetric=t.NoopMetric=t.NoopMeter=void 0;var i=function(){function NoopMeter(){}return NoopMeter.prototype.createValueRecorder=function(e,n){return t.NOOP_VALUE_RECORDER_METRIC},NoopMeter.prototype.createCounter=function(e,n){return t.NOOP_COUNTER_METRIC},NoopMeter.prototype.createUpDownCounter=function(e,n){return t.NOOP_COUNTER_METRIC},NoopMeter.prototype.createValueObserver=function(e,n,r){return t.NOOP_VALUE_OBSERVER_METRIC},NoopMeter.prototype.createBatchObserver=function(e,n){return t.NOOP_BATCH_OBSERVER_METRIC},NoopMeter}();t.NoopMeter=i;var s=function(){function NoopMetric(e){this._instrument=e}return NoopMetric.prototype.bind=function(e){return this._instrument},NoopMetric.prototype.unbind=function(e){},NoopMetric.prototype.clear=function(){},NoopMetric}();t.NoopMetric=s;var a=function(e){function NoopCounterMetric(){return null!==e&&e.apply(this,arguments)||this}return o(NoopCounterMetric,e),NoopCounterMetric.prototype.add=function(e,t){this.bind(t).add(e)},NoopCounterMetric}(s);t.NoopCounterMetric=a;var c=function(e){function NoopValueRecorderMetric(){return null!==e&&e.apply(this,arguments)||this}return o(NoopValueRecorderMetric,e),NoopValueRecorderMetric.prototype.record=function(e,t,n,r){void 0===n?this.bind(t).record(e):void 0===r?this.bind(t).record(e,n):this.bind(t).record(e,n,r)},NoopValueRecorderMetric}(s);t.NoopValueRecorderMetric=c;var u=function(e){function NoopBaseObserverMetric(){return null!==e&&e.apply(this,arguments)||this}return o(NoopBaseObserverMetric,e),NoopBaseObserverMetric.prototype.observation=function(){return{observer:this,value:0}},NoopBaseObserverMetric}(s);t.NoopBaseObserverMetric=u;var l=function(e){function NoopBatchObserverMetric(){return null!==e&&e.apply(this,arguments)||this}return o(NoopBatchObserverMetric,e),NoopBatchObserverMetric}(s);t.NoopBatchObserverMetric=l;var d=function(){function NoopBoundCounter(){}return NoopBoundCounter.prototype.add=function(e){},NoopBoundCounter}();t.NoopBoundCounter=d;var p=function(){function NoopBoundValueRecorder(){}return NoopBoundValueRecorder.prototype.record=function(e,t,n){},NoopBoundValueRecorder}();t.NoopBoundValueRecorder=p;var h=function(){function NoopBoundBaseObserver(){}return NoopBoundBaseObserver.prototype.update=function(e){},NoopBoundBaseObserver}();t.NoopBoundBaseObserver=h,t.NOOP_METER=new i,t.NOOP_BOUND_COUNTER=new d,t.NOOP_COUNTER_METRIC=new a(t.NOOP_BOUND_COUNTER),t.NOOP_BOUND_VALUE_RECORDER=new p,t.NOOP_VALUE_RECORDER_METRIC=new c(t.NOOP_BOUND_VALUE_RECORDER),t.NOOP_BOUND_BASE_OBSERVER=new h,t.NOOP_VALUE_OBSERVER_METRIC=new u(t.NOOP_BOUND_BASE_OBSERVER),t.NOOP_UP_DOWN_SUM_OBSERVER_METRIC=new u(t.NOOP_BOUND_BASE_OBSERVER),t.NOOP_SUM_OBSERVER_METRIC=new u(t.NOOP_BOUND_BASE_OBSERVER),t.NOOP_BATCH_OBSERVER_METRIC=new l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_METER_PROVIDER=t.NoopMeterProvider=void 0;var r=n(326),o=function(){function NoopMeterProvider(){}return NoopMeterProvider.prototype.getMeter=function(e,t){return r.NOOP_METER},NoopMeterProvider}();t.NoopMeterProvider=o,t.NOOP_METER_PROVIDER=new o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_SPAN=t.NoopSpan=t.INVALID_SPAN_ID=t.INVALID_TRACE_ID=void 0;var r=n(329);t.INVALID_TRACE_ID="0",t.INVALID_SPAN_ID="0";var o={traceId:t.INVALID_TRACE_ID,spanId:t.INVALID_SPAN_ID,traceFlags:r.TraceFlags.NONE},i=function(){function NoopSpan(e){void 0===e&&(e=o),this._spanContext=e}return NoopSpan.prototype.context=function(){return this._spanContext},NoopSpan.prototype.setAttribute=function(e,t){return this},NoopSpan.prototype.setAttributes=function(e){return this},NoopSpan.prototype.addEvent=function(e,t){return this},NoopSpan.prototype.setStatus=function(e){return this},NoopSpan.prototype.updateName=function(e){return this},NoopSpan.prototype.end=function(e){},NoopSpan.prototype.isRecording=function(){return!1},NoopSpan}();t.NoopSpan=i,t.NOOP_SPAN=new i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TraceFlags=void 0,function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(t.TraceFlags||(t.TraceFlags={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_TRACER=t.NoopTracer=void 0;var r=n(328),o=function(){function NoopTracer(){}return NoopTracer.prototype.getCurrentSpan=function(){return r.NOOP_SPAN},NoopTracer.prototype.startSpan=function(e,t){return r.NOOP_SPAN},NoopTracer.prototype.withSpan=function(e,t){return t()},NoopTracer.prototype.bind=function(e,t){return e},NoopTracer}();t.NoopTracer=o,t.NOOP_TRACER=new o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_TRACER_PROVIDER=t.NoopTracerProvider=void 0;var r=n(330),o=function(){function NoopTracerProvider(){}return NoopTracerProvider.prototype.getTracer=function(e,t){return r.NOOP_TRACER},NoopTracerProvider}();t.NoopTracerProvider=o,t.NOOP_TRACER_PROVIDER=new o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;var r=function(){function Context(e){this._currentContext=e?new Map(e):new Map}return Context.createKey=function(e){return Symbol(e)},Context.prototype.getValue=function(e){return this._currentContext.get(e)},Context.prototype.setValue=function(e,t){var n=new Context(this._currentContext);return n._currentContext.set(e,t),n},Context.prototype.deleteValue=function(e){var t=new Context(this._currentContext);return t._currentContext.delete(e),t},Context.ROOT_CONTEXT=new Context,Context.TODO=Context.ROOT_CONTEXT,Context}();t.Context=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextAPI=void 0;var r=n(149),o=n(150),i=new r.NoopContextManager,s=function(){function ContextAPI(){}return ContextAPI.getInstance=function(){return this._instance||(this._instance=new ContextAPI),this._instance},ContextAPI.prototype.setGlobalContextManager=function(e){return o._global[o.GLOBAL_CONTEXT_MANAGER_API_KEY]?this._getContextManager():(o._global[o.GLOBAL_CONTEXT_MANAGER_API_KEY]=o.makeGetter(o.API_BACKWARDS_COMPATIBILITY_VERSION,e,i),e)},ContextAPI.prototype.active=function(){return this._getContextManager().active()},ContextAPI.prototype.with=function(e,t){return this._getContextManager().with(e,t)},ContextAPI.prototype.bind=function(e,t){return void 0===t&&(t=this.active()),this._getContextManager().bind(e,t)},ContextAPI.prototype._getContextManager=function(){var e,t;return null!==(t=null===(e=o._global[o.GLOBAL_CONTEXT_MANAGER_API_KEY])||void 0===e?void 0:e.call(o._global,o.API_BACKWARDS_COMPATIBILITY_VERSION))&&void 0!==t?t:i},ContextAPI.prototype.disable=function(){this._getContextManager().disable(),delete o._global[o.GLOBAL_CONTEXT_MANAGER_API_KEY]},ContextAPI}();t.ContextAPI=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=void 0,t.VERSION="0.10.2"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoopLogger=void 0;t.NoopLogger=class NoopLogger{debug(e,...t){}error(e,...t){}warn(e,...t){}info(e,...t){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TraceState=void 0;const r=n(846);t.TraceState=class TraceState{constructor(e){this._internalState=new Map,e&&this._parse(e)}set(e,t){this._internalState.has(e)&&this._internalState.delete(e),this._internalState.set(e,t)}unset(e){this._internalState.delete(e)}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce((e,t)=>(e.push(t+"="+this.get(t)),e),[]).join(",")}_parse(e){e.length>512||(this._internalState=e.split(",").reverse().reduce((e,t)=>{const n=t.indexOf("=");if(-1!==n){const o=t.slice(0,n),i=t.slice(n+1,t.length);r.validateKey(o)&&r.validateValue(i)&&e.set(o,i)}return e},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCorrelationContext=t.getCorrelationContext=void 0;const r=n(149).Context.createKey("OpenTelemetry Distributed Contexts Key");t.getCorrelationContext=function getCorrelationContext(e){return e.getValue(r)||void 0},t.setCorrelationContext=function setCorrelationContext(e,t){return e.setValue(r,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValid=t.INVALID_SPAN_CONTEXT=t.INVALID_TRACEID=t.INVALID_SPANID=void 0;const r=n(41);t.INVALID_SPANID="0",t.INVALID_TRACEID="0",t.INVALID_SPAN_CONTEXT={traceId:t.INVALID_TRACEID,spanId:t.INVALID_SPANID,traceFlags:r.TraceFlags.NONE},t.isValid=function isValid(e){return e.traceId!==t.INVALID_TRACEID&&e.spanId!==t.INVALID_SPANID}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(340)),s=n(147);t.OSSClient=class OSSClient{constructor(e,t,n){this.client=e,this.connectionOptions=t,this.settings=n}getSignedResource(e,t,n,o){return r(this,void 0,void 0,(function*(){const a={headers:Object.assign(Object.assign(Object.assign({},o),s.headers),{Authorization:"Bearer "+(yield this.connectionOptions.getToken())}),responseType:t.getResponseType()};n&&(a.params={revisionId:n});const{maximumTimeout:c,minimumTimeout:u,retry:l,retryableErrors:d}=this.settings.retryOptions,p=yield i.default(()=>r(this,void 0,void 0,(function*(){return this.client.get(e,a)})),{retries:l,maxTimeout:c,minTimeout:u,onFailedAttempt:e=>{const t=e.response&&e.response.status;if(t){const n=t.toString()[0]+"XX";if(!d.includes(t)&&!d.includes(n))throw e}}});return t.setData(p.data)}))}}},function(e,t,n){"use strict";const r=n(288),o=["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Network request failed"];class AbortError extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,({message:e}=e)):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const pRetry=(e,t)=>new Promise((n,i)=>{t={onFailedAttempt:()=>{},retries:10,...t};const s=r.operation(t);s.attempt(async r=>{try{n(await e(r))}catch(e){if(!(e instanceof Error))return void i(new TypeError(`Non-error was thrown: "${e}". You should only throw errors.`));if(e instanceof AbortError)s.stop(),i(e.originalError);else if(e instanceof TypeError&&(a=e.message,!o.includes(a)))s.stop(),i(e);else{((e,t,n)=>{const r=n.retries-(t-1);e.attemptNumber=t,e.retriesLeft=r})(e,r,t);try{await t.onFailedAttempt(e)}catch(e){return void i(e)}s.retry(e)||i(s.mainError())}}var a})});e.exports=pRetry,e.exports.default=pRetry,e.exports.AbortError=AbortError},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.AllowedJournalFilterFields=t.AllowedEntityFilterFields=t.PaginationConstants=void 0,o(n(864),t),o(n(865),t),t.PaginationConstants={OFFSET:0,LIMIT:15},t.AllowedEntityFilterFields=["entityId","entityPermanentId","parentEntityId","revisionId","revisionPermanentId","type","removed","staticData","data"],t.AllowedJournalFilterFields=["journalId","parentJournalId","properties"]},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryJournalStore=void 0;const o=r(n(46)),i=n(153),s=r(n(343)),a=n(121),c=n(103),u=n(107),l=n(161);function moveToBack(e,t){const n=e.lastIndexOf(t);o.default(-1!==n),e.splice(n,1),e.push(t)}t.InMemoryJournalStore=class InMemoryJournalStore{constructor(){this.journals=new Map,this.journalSets=new Map,this.commands=new Map,this.commandOrder=0}async createJournal(e){if(e.journalId&&this.journals.has(e.journalId))throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_JOURNAL_ALREADY_EXIST,`A journal with ID ${e.journalId} already exists in the journal store.`);const t=e.journalId||a.nanoid();if(e.parentJournalId&&!this.journals.has(e.parentJournalId))throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_PARENT_JOURNAL_NOT_EXIST,`A parent journal with ID ${e.parentJournalId} does not exist in the journal store.`);const n={journalData:Object.assign(Object.assign({},e),{journalId:t}),orderedCommands:[]};return e.collectionId&&(o.default(!this.hasJournalForThisRoleInSet(n.journalData)),await this.addJournalToSet(n.journalData)),this.journals.set(t,n),s.default(n.journalData)}async getJournal(e){const t=this.journals.get(e);if(!t)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`A journal with ID ${e} does not exist in the journal store.`);return s.default(t&&t.journalData)}async getJournalSet(e,t){var n;const r=s.default(this.journalSets.get(e));if(t){let{isolationJournals:e}=r;e=l.filterHelper(null!=e?e:[],null!==(n=null==t?void 0:t.filters)&&void 0!==n?n:{}),(null==t?void 0:t.sort)&&(e=l.sortHelper(e,t.sort)),e=l.paginationHelper(e,null==t?void 0:t.offset,null==t?void 0:t.limit).items,r.isolationJournals=e}return r}async updateJournal(e,t){const n=this.journals.get(e);if(!n)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`A journal with ID ${e} does not exist in the journal store.`);const r=t.collectionId&&t.collectionId!==n.journalData.collectionId||t.role&&t.role!==n.journalData.role;r&&(o.default(!(t.collectionId&&this.hasJournalForThisRoleInSet(n.journalData))),n.journalData.collectionId&&await this.removeJournalFromSet(n.journalData));const{collectionId:i,parentJournalId:a,role:l,properties:d}=Object.assign(Object.assign({},n.journalData),t);return n.journalData.collectionId=i,n.journalData.role=l,n.journalData.parentJournalId=a,n.journalData.properties=d,this.journals.set(e,n),r&&await this.addJournalToSet(n.journalData),s.default(n.journalData)}async getJournalsByParent(e){return Array.from(this.journals.values()).filter(t=>t.journalData.parentJournalId===e).map(e=>s.default(e&&e.journalData))}hasJournalForThisRoleInSet(e){const t=this.journalSets.get(e.collectionId);if(!t)return!1;switch(e.role){case"main":if(t.mainJournal)return!0;break;case"remote":if(t.remoteJournal)return!0;break;default:return!1}return!1}async addJournalToSet(e){let t=this.journalSets.get(e.collectionId);switch(t||(t={mainJournal:void 0,remoteJournal:void 0,isolationJournals:void 0}),e.role){case"main":t.mainJournal=e;break;case"remote":t.remoteJournal=e;break;case"isolation":t.isolationJournals?t.isolationJournals.push(e):t.isolationJournals=[e];break;case"staging":t.stagingJournals?t.stagingJournals.push(e):t.stagingJournals=[e]}this.journalSets.set(e.collectionId,t)}async removeJournalFromSet(e){var t,n;const r=this.journalSets.get(e.collectionId);if(!r)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_COLLECTION_NOT_EXIST,`Collection with ID ${e.collectionId} does not exist in the journal store.`);switch(e.role){case"main":r.mainJournal=void 0;break;case"remote":r.remoteJournal=void 0;break;case"isolation":r.isolationJournals=null===(t=r.isolationJournals)||void 0===t?void 0:t.filter(t=>t.journalId!==e.journalId);break;case"staging":r.stagingJournals=null===(n=r.stagingJournals)||void 0===n?void 0:n.filter(t=>t.journalId!==e.journalId)}r.mainJournal||r.remoteJournal||r.isolationJournals&&0!==r.isolationJournals.length||this.journalSets.delete(e.collectionId)}async updateJournalSet(e,t){var n;const r=this.journalSets.get(e);if(!r)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_COLLECTION_NOT_EXIST,`Collection with ID ${e} does not exist in the journal store.`);return r.serverSyncToken=null!==(n=t.serverSyncToken)&&void 0!==n?n:void 0,s.default(r)}async deleteJournal(e){const t=this.journals.get(e);if(!t)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`A journal with ID ${e} does not exist in the journal store.`);"staging"!==t.journalData.role&&await this.removeJournalFromSet(t.journalData),this.journals.delete(e)}async addCommandToJournal(e,t){const n=this.journals.get(e);if(!n)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`Journal with ID ${e} does not exist in the journal store.`);if(t.commandId&&this.commands.has(t.commandId))throw new u.StoreError(c.ErrorCode.L5_GEN_DUPLICATE_ID,`Command with ID ${t.commandId} already exists.`);const r=t.commandId||a.nanoid(),o=Object.assign(Object.assign({},t),{commandId:r,journalId:e,modifiedDate:new Date,inputEntities:[],modifiedEntities:[]}),i=Object.assign(Object.assign({},s.default(o)),{commandOrder:this.commandOrder++});return this.commands.set(r,i),n.orderedCommands.push(i),o}async clearJournalCommands(e){const t=this.journals.get(e);if(!t)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`Journal with ID ${e} does not exist in the journal store.`);t.orderedCommands.forEach(e=>{this.commands.delete(e.commandId)}),t.orderedCommands=[]}async getJournalCommands(e,t){const n=this.journals.get(e);if(!n)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`Journal with ID ${e} does not exist in the journal store.`);let r,o;if(null==t?void 0:t.filters){const{filters:e}=t;r=n.orderedCommands.filter(t=>{if(e.commandId&&t.commandId!==e.commandId)return!1;if(e.commandName&&t.commandName!==e.commandName)return!1;if(e.status&&t.status!==e.status)return!1;if(e.modifiedDate&&t.modifiedDate.toISOString()!==e.modifiedDate.toISOString())return!1;if(e.dependsOn){const n=new Set(t.dependsOn);if(!e.dependsOn.every(e=>n.has(e)))return!1}if(e.inputEntities){const n=new Set(t.inputEntities);if(!e.inputEntities.every(e=>n.has(e)))return!1}if(e.modifiedEntities){const n=new Set(t.modifiedEntities);if(!e.modifiedEntities.every(e=>n.has(e)))return!1}return!0})}else r=n.orderedCommands;o=t&&t.fields?t.fields:["journalId","commandId","commandName","status","modifiedDate","parameters","dependsOn"];const a=r.map(e=>i.pick(e,o));return s.default(a)}async getCommand(e){const t=this.commands.get(e);if(!t)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,`Command with ID '${e}' does not exist.`);return s.default(i.omit(t,["commandOrder","localIdStore"]))}async updateCommand(e,t){const n=this.commands.get(e);if(!n)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,`Command with ID '${e}' does not exist.`);n.status=t.status,n.modifiedDate=new Date;return moveToBack(this.journals.get(n.journalId).orderedCommands,n),s.default(n)}async addCommandInputEntities(e,t){const n=this.commands.get(e);if(!n)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,"No command found with the commandId.");n.inputEntities.push(...t),n.modifiedDate=new Date;return moveToBack(this.journals.get(n.journalId).orderedCommands,n),[...n.inputEntities]}async addCommandModifiedEntities(e,t){const n=this.commands.get(e);if(!n)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,"No command found with the commandId.");for(const e in t)t[e]&&n.modifiedEntities.push(e);n.modifiedDate=new Date;return moveToBack(this.journals.get(n.journalId).orderedCommands,n),t}async getCommandInputEntities(e){const t=this.commands.get(e);if(!t)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,`Command with ID '${e}' does not exist.`);return t.inputEntities}async getCommandModifiedEntities(e){const t=this.commands.get(e);if(!t)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,"No command found with the commandId.");return t.modifiedEntities}async getCommandLocalIdStore(e){const t=this.commands.get(e);if(!t)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,"No command found with the commandId.");return s.default(t.localIdStore)}async setCommandLocalIdStore(e,t){const n=this.commands.get(e);if(!n)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,"No command found with the commandId.");n.localIdStore=s.default(t)}async clearLocalStore(){this.journals=new Map,this.journalSets=new Map,this.commands=new Map}async transferCommands(e,t,n){var r;if(e===t)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_TRANSFER_CONFLICT,"Source journal cannot be the same as the target journal.");const o=this.journals.get(e),i=this.journals.get(t);if(!o||!i)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`sourceJournalId, journal with ID ${e}\n        and/or targetJournalId ID ${t} do not exist in the journal store.`);for(const e of o.orderedCommands)n&&!(null===(r=e.dependsOn)||void 0===r?void 0:r.length)&&(e.dependsOn=[n]),e.journalId=t;i.orderedCommands.push(...o.orderedCommands),o.orderedCommands=[]}async canBeFastForwarded(e,t){const n=this.journals.get(e),r=this.journals.get(t);if(!n||!r)throw new u.StoreError(c.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`sourceJournalId, journal with ID ${e}\n        and/or targetJournalId ID ${t} do not exist in the journal store.`);let o=-1/0,i=1/0,s=r;for(;s;){s.orderedCommands.forEach(e=>{o=Math.max(e.commandOrder,o)});const e=s.journalData.parentJournalId;s=e?this.journals.get(e):void 0}return n.orderedCommands.forEach(e=>{i=Math.min(e.commandOrder,i)}),Promise.resolve(i>o)}}},function(e,t,n){var r=n(867);e.exports=function cloneDeep(e){return r(e,5)}},function(e,t,n){var r=n(104),o=n(64);e.exports=function isFunction(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t){var n="object"==typeof global&&global&&global.Object===Object&&global;e.exports=n},function(e,t){var n=Function.prototype.toString;e.exports=function toSource(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t,n){var r=n(348),o=n(205),i=Object.prototype.hasOwnProperty;e.exports=function assignValue(e,t,n){var s=e[t];i.call(e,t)&&o(s,n)&&(void 0!==n||t in e)||r(e,t,n)}},function(e,t,n){var r=n(897);e.exports=function baseAssignValue(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},function(e,t,n){var r=n(899),o=n(350),i=n(42),s=n(208),a=n(351),c=n(352),u=Object.prototype.hasOwnProperty;e.exports=function arrayLikeKeys(e,t){var n=i(e),l=!n&&o(e),d=!n&&!l&&s(e),p=!n&&!l&&!d&&c(e),h=n||l||d||p,m=h?r(e.length,String):[],y=m.length;for(var g in e)!t&&!u.call(e,g)||h&&("length"==g||d&&("offset"==g||"parent"==g)||p&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||a(g,y))||m.push(g);return m}},function(e,t,n){var r=n(900),o=n(65),i=Object.prototype,s=i.hasOwnProperty,a=i.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(e){return o(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function isIndex(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,n){var r=n(902),o=n(159),i=n(210),s=i&&i.isTypedArray,a=s?o(s):r;e.exports=a},function(e,t){e.exports=function overArg(e,t){return function(n){return e(t(n))}}},function(e,t){e.exports=function stubArray(){return[]}},function(e,t,n){var r=n(356),o=n(357),i=n(213),s=n(354),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,i(e)),e=o(e);return t}:s;e.exports=a},function(e,t){e.exports=function arrayPush(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},function(e,t,n){var r=n(353)(Object.getPrototypeOf,Object);e.exports=r},function(e,t,n){var r=n(359),o=n(213),i=n(82);e.exports=function getAllKeys(e){return r(e,i,o)}},function(e,t,n){var r=n(356),o=n(42);e.exports=function baseGetAllKeys(e,t,n){var i=t(e);return o(e)?i:r(i,n(e))}},function(e,t,n){var r=n(48).Uint8Array;e.exports=r},function(e,t){e.exports=function arrayMap(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},function(e,t,n){var r=n(42),o=n(216),i=n(932),s=n(935);e.exports=function castPath(e,t){return r(e)?e:o(e,t)?[e]:i(s(e))}},function(e,t,n){var r=n(939),o=n(65);e.exports=function baseIsEqual(e,t,n,i,s){return e===t||(null==e||null==t||!o(e)&&!o(t)?e!=e&&t!=t:r(e,t,n,i,baseIsEqual,s))}},function(e,t,n){var r=n(940),o=n(943),i=n(944);e.exports=function equalArrays(e,t,n,s,a,c){var u=1&n,l=e.length,d=t.length;if(l!=d&&!(u&&d>l))return!1;var p=c.get(e),h=c.get(t);if(p&&h)return p==t&&h==e;var m=-1,y=!0,g=2&n?new r:void 0;for(c.set(e,t),c.set(t,e);++m<l;){var _=e[m],v=t[m];if(s)var E=u?s(v,_,m,t,e,c):s(_,v,m,e,t,c);if(void 0!==E){if(E)continue;y=!1;break}if(g){if(!o(t,(function(e,t){if(!i(g,t)&&(_===e||a(_,e,n,s,c)))return g.push(t)}))){y=!1;break}}else if(_!==v&&!a(_,v,n,s,c)){y=!1;break}}return c.delete(e),c.delete(t),y}},function(e,t,n){var r=n(64);e.exports=function isStrictComparable(e){return e==e&&!r(e)}},function(e,t){e.exports=function matchesStrictComparable(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},function(e,t,n){var r=n(215);e.exports=function get(e,t,n){var o=null==e?void 0:r(e,t);return void 0===o?n:o}},function(e,t){e.exports=function identity(e){return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Store=void 0;t.Store=class Store{constructor(e,t){this.entityStore=e,this.journalStore=t}getEntityStore(){return this.entityStore}getJournalStore(){return this.journalStore}async clearLocalStore(){await this.entityStore.clearLocalStore(),await this.journalStore.clearLocalStore()}startTransaction(){return Promise.resolve()}endTransaction(e){return Promise.resolve()}dispose(){return Promise.resolve()}}},function(e,t,n){"use strict";var r,o=this&&this.__classPrivateFieldSet||function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},i=this&&this.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryEntityStore=void 0;const a=s(n(343)),c=s(n(967)),u=n(121),l=n(341),d=n(152),p=n(103),h=n(107),m=n(371),y=n(161);class InMemoryEntityStore extends l.EntityStore{constructor(e,t){super(),this.combineChanges=t,r.set(this,void 0),this.entities=new Map,this.journalStore=e,o(this,r,new Map),this.lineageHelper=new m.LineageHelper(this.journalStore,this)}async getEntity({entityId:e,revisionId:t},{journalId:n}){const r=this._getStoredEntity(e);if(!r)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the current entity store.`);return this._getEntityFromStoredEntity(r,n,t)}async _getEntityFromStoredEntity(e,t,n){var r;const o=e.revisionJournals[t];if(!o)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL,`No revision found for journal of ID ${t}, or ${t} does not exist.`);let i,s;if(n&&(i=this._getStoredEntityRevision(o,n),!i))throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_EXIST,`No revision with ID ${n} found for entity with ID ${e.entityId}.`);const u=this._getLastMaterializedView(o,n);let l,d;if(i&&u&&u.revisionId===i.revisionId)s=u.data,l=u.removed,d=u.parentEntityId;else{const n=await this.getRevisionRange(e.entityId,t,{afterRevisionId:null==u?void 0:u.revisionId,toRevisionId:null==i?void 0:i.revisionId});if(n.length)i=n[n.length-1],l=i.removed;else{if(!u)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL,"no revision in journal for entity.");i=o.revisions[u.revisionId],l=u.removed}const a=null===(r=c.default(n,e=>void 0!==e.parentEntityId))||void 0===r?void 0:r.parentEntityId;d=void 0===a?null==u?void 0:u.parentEntityId:null!=a?a:void 0;const m=n.map(({dataChanges:e})=>e).filter(e=>void 0!==e);u&&u.revisionId===i.revisionId?s=u.data:(s=this.combineChanges(null==u?void 0:u.data,m),await this.createMaterializedView(e.entityId,t,i.revisionId,{data:s,removed:l,parentEntityId:d}))}return a.default({entityId:e.entityId,entityPermanentId:e.entityPermanentId,parentEntityId:d,revisionId:i.revisionId,revisionPermanentId:i.revisionPermanentId,type:e.type,removed:l,staticData:e.revisionJournals[t].staticData,data:s})}async getRevisionRange(e,t,{afterRevisionId:n,toRevisionId:r}){if(!e)throw new h.StoreError(p.ErrorCode.L5_GEN_INVALID_VALUE,"entityId");if(!t)throw new h.StoreError(p.ErrorCode.L5_GEN_INVALID_VALUE,"journalId");const o=this._getStoredEntity(e);if(!o)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the current entity store.`);const i=o.revisionJournals[t];if(!i)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL,`No revision found for journal of ID ${t}, or ${t} does not exist.`);const{orderedRevisions:s}=i;let a=-1;if(n){const e=this._getStoredEntityRevision(i,n);if(!e)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_EXIST,"afterRevisionId does not exist.");if(a=s.lastIndexOf(e.revisionId),-1===a)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL,"afterRevision not in journal.")}let c=s.length-1;if(r){const e=this._getStoredEntityRevision(i,r);if(!e)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_EXIST,"toRevisionId does not exist.");if(c=s.lastIndexOf(e.revisionId),-1===c)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL,"toRevision not in journal.")}if(a>c)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL,"Specified range is reversed.");return s.slice(a+1,c+1).map(e=>i.revisions[e])}_getLastMaterializedView(e,t){const{orderedRevisions:n}=e;let r,o,i=n.length-1;if(n.length&&t){const r=this._getStoredEntityRevision(e,t);r&&(i=n.lastIndexOf(r.revisionId))}if(-1===i)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL,`Revision ${t} does not exist for the specified journal or the journal does not exist.`);do{r=n[i--],o=e.materializedViews[r]}while(!o&&i>-1);return o}async _getRevisionJournalUsingLineage(e,t){let n=t,r=e.revisionJournals[n];for(;!r;)try{if(n=(await this.journalStore.getJournal(n)).parentJournalId,!n)break;r=e.revisionJournals[n]}catch(e){break}if(r)return{journalId:n,staticData:r.staticData}}async getJournalEntities(e){const t=[...this.entities.values()].filter(t=>t.revisionJournals[e]).map(t=>this._getEntityFromStoredEntity(t,e));return(await Promise.all(t)).map(e=>e)}async getEntities(e,{journalId:t}){var n;if(!t)throw new h.StoreError(p.ErrorCode.L5_GEN_INVALID_VALUE,"journalId");if(!e||!e.length)throw new h.StoreError(p.ErrorCode.L5_GEN_INVALID_VALUE,"entityIds");const r=e.map(e=>"string"==typeof e?{entityId:e}:e),o=r.map(e=>{if(!e)throw new h.StoreError(p.ErrorCode.L5_GEN_INVALID_VALUE,"entityIds");return this.getEntity(e,{journalId:t})}),i=await Promise.all(o.map(e=>e.catch(()=>{}))),s=[];for(let e=0;e<r.length;e++)s.push((null===(n=i[e])||void 0===n?void 0:n.removed)?void 0:i[e]);return s}async queryEntities(e,t){const n=await this.lineageHelper.getJournalLineage(e),r=await this.getJournalEntities(e);for(const e of n){(await this.getJournalEntities(e)).forEach(e=>{0===r.filter(t=>t.entityId===e.entityId).length&&r.push(e)})}let o;return o=y.filterHelper(r,t.filters||{}),JSON.stringify(Object.entries(t.filters||{})).includes("removed")||(o=o.filter(e=>!1===e.removed)),t.sort&&(o=y.sortHelper(o,t.sort)),y.paginationHelper(o,t.offset,t.limit)}async getEntityRevisions(e,t,n){let r=[];const o=this._getStoredEntity(e);if(!o)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the current entity store.`);let i;return[t,...await this.lineageHelper.getJournalLineage(t)].forEach(e=>{const t=o.revisionJournals[e];if(t){const e=t.orderedRevisions[0];t.orderedRevisions.forEach(e=>{const n=t.revisions[e];i?n.revisionDate<i&&r.push(n):r.push(n)}),i=t.revisions[e].revisionDate}}),r=y.sortHelper(r,n.sort||["-revisionDate"]),r=y.filterHelper(r,n.filters||{}),y.paginationHelper(r,n.offset,n.limit)}async createEntity(e,t){const{storedEntity:n,entityRevision:r}=await this.createStoredEntity(e,t),o=await this._getEntityFromStoredEntity(n,r.journalId,r.revisionId);return a.default(o)}async updateEntity(e,t,n){const{storedEntity:r,entityRevision:o}=await this.updateStoredEntity(e,t,n),i=await this.getEntity({entityId:r.entityId,revisionId:o.revisionId},{journalId:o.journalId});return a.default(i)}async createRelationship(e,t,n){var r;const{storedEntity:o,entityRevision:i}=await this.createStoredEntity(e,n,t);return a.default({entityId:o.entityId,entityPermanentId:o.entityPermanentId,parentEntityId:null!==(r=i.parentEntityId)&&void 0!==r?r:void 0,revisionId:i.revisionId,revisionPermanentId:i.revisionPermanentId,type:o.type,removed:!1,staticData:o.revisionJournals[n.journalId].staticData,data:void 0!==i.dataChanges?[i.dataChanges]:[],from:{entityId:o.relationship.fromEntityId,revisionId:o.relationship.fromRevisionId},to:{entityId:o.relationship.toEntityId,revisionId:o.relationship.toRevisionId}})}async updateRelationship(e,t,n,r){const{storedEntity:o,entityRevision:i}=await this.updateStoredEntity(e,t,r,n),s=await this.getEntity({entityId:o.entityId,revisionId:i.revisionId},{journalId:i.journalId});if(!s)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_IS_REMOVED,`Entity with ID ${e} was removed.`);return a.default({entityId:s.entityId,entityPermanentId:s.entityPermanentId,parentEntityId:s.parentEntityId,revisionId:i.revisionId,revisionPermanentId:i.revisionPermanentId,type:s.type,removed:s.removed,staticData:s.staticData,data:void 0!==i.dataChanges?[i.dataChanges]:[],from:{entityId:o.relationship.fromEntityId,revisionId:o.relationship.fromRevisionId},to:{entityId:o.relationship.toEntityId,revisionId:o.relationship.toRevisionId}})}async updateRelationshipStaticObject(e,t){const n=this._getStoredEntity(e);if(!n)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the current entity store.`);if(t){if(!n.relationship)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_IS_REMOVED,`Entity with ID ${e} was already removed.`);t.from&&(n.relationship.fromEntityId=t.from.entityId,n.relationship.fromRevisionId=t.from.revisionId),t.to&&(n.relationship.toEntityId=t.to.entityId,n.relationship.toRevisionId=t.to.revisionId)}}async getRelationship(e,{journalId:t}){let n,r;if(!e)throw new h.StoreError(p.ErrorCode.L5_GEN_INVALID_VALUE,"entityId");if(!t)throw new h.StoreError(p.ErrorCode.L5_GEN_INVALID_VALUE,"journalId");"string"==typeof e?(n=e,r=void 0):(n=e.entityId,r=e.revisionId);const o=this._getStoredEntity(n);if(!o)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the current entity store.`);const i=await this._getEntityFromStoredEntity(o,t,r);if(!i)throw new h.StoreError(p.ErrorCode.L5_GEN_INVALID_VALUE,"entityId");return i.removed?void 0:Object.assign(Object.assign({},i),{from:{entityId:o.relationship.fromEntityId,revisionId:o.relationship.fromRevisionId},to:{entityId:o.relationship.toEntityId,revisionId:o.relationship.toRevisionId}})}async getRelationships(e,{journalId:t},n,r){let o,i,s=[];"string"==typeof e?(o=e,i=void 0):(o=e.entityId,i=e.revisionId);const{entityLocalId:a,entityPermanentId:c}=await this.getEntityIds(o);let u=[...this.entities.values()].filter(e=>e.type===d.EntityType.RELATIONSHIP&&e.relationship&&("in"===n.direction?[a,c].includes(e.relationship.toEntityId):[a,c].includes(e.relationship.fromEntityId)));if(i&&(u=u.filter(e=>"in"===n.direction?e.relationship.toRevisionId===i:e.relationship.fromRevisionId===i)),u.length){const e=[t,...await this.lineageHelper.getJournalLineage(t)],o=[];for(const t of u){const r=await this.lineageHelper.getEntityInLineage(t.entityId,e);r&&!r.removed&&o.push(this.toModelRelationship(t,r,e,n))}s=await Promise.all(o),s=y.filterHelper(s,r||{})}return s}async toModelRelationship(e,t,n,r){let o={entityId:e.relationship.fromEntityId,revisionId:e.relationship.fromRevisionId},i={entityId:e.relationship.toEntityId,revisionId:e.relationship.toRevisionId};if(r.fetchEntityData)if("in"===r.direction){i=await this.lineageHelper.getEntityInLineage(i.entityId,n,i.revisionId)||i}else{o=await this.lineageHelper.getEntityInLineage(o.entityId,n,o.revisionId)||o}let{data:s}=t;if(r.fetchTipRelationshipData){const t=await this._getLastMaterializedViewInLineage(e,n[0]);s=null==t?void 0:t.data}return{entityId:e.entityId,entityPermanentId:e.entityPermanentId,parentEntityId:t.parentEntityId,revisionId:t.revisionId,revisionPermanentId:t.revisionPermanentId,type:e.type,staticData:t.staticData,data:s,removed:t.removed,from:o,to:i}}async createStoredEntity(e,t,n){const{type:r,staticDataChanges:o,dataChanges:i,parentEntityId:s}=e;let{entityId:c}=e;const{revisionId:l,journalId:d,commandId:m,revisionDate:y,revisionPermanentId:g}=t;if(!d)throw new h.StoreError(p.ErrorCode.L5_GEN_INVALID_VALUE,"journalId");if(c){const e=await this.lineageHelper.getJournalLineage(d),t=await this.lineageHelper.getEntityInLineage(c,e);if(t&&t.revisionId)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_ALREADY_EXIST,`Entity with ID ${c} already exists in the entity store.`)}let _;if(c&&this._getStoredEntity(c))_=this._getStoredEntity(c);else{c=c||u.nanoid();_={entityId:c,type:r,relationship:n?{fromEntityId:n.from.entityId,fromRevisionId:n.from.revisionId,toEntityId:n.to.entityId,toRevisionId:n.to.revisionId}:void 0,revisionJournals:{}}}const{revision:v}=await this._createRevision(_,d,{revisionId:l,revisionPermanentId:g,commandId:m,revisionDate:y,created:!0,removed:!1,parentEntityId:s,staticDataChanges:o,dataChanges:i});let E;return _.revisionJournals[d].staticData=a.default(null!=o?o:{}),this.entities.set(c,_),void 0!==v.dataChanges&&(E=this.combineChanges(void 0,[v.dataChanges])),await this.createMaterializedView(_.entityId,v.journalId,v.revisionId,{data:E,removed:v.removed,parentEntityId:s}),{storedEntity:_,entityRevision:v}}async updateStoredEntity(e,t,n,r){const{staticDataChanges:o,dataChanges:i,parentEntityId:s}=t,{revisionId:c,journalId:u,commandId:l,revisionDate:d,revisionPermanentId:m}=n;if(!e)throw new h.StoreError(p.ErrorCode.L5_GEN_INVALID_VALUE,"entityId");if(!u)throw new h.StoreError(p.ErrorCode.L5_GEN_INVALID_VALUE,"journalId");if(t.type)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_CANNOT_UPDATE_ENTITY_TYPE,"Not allowed to update Entity type.");const y=this._getStoredEntity(e);if(!y)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the current entity store.`);const g=y.revisionJournals[u];if(g&&g.orderedRevisions.length){if(g.revisions[g.orderedRevisions[g.orderedRevisions.length-1]].removed)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_IS_REMOVED,`The entity with ID ${e} was already removed.`)}else{const t=await this.lineageHelper.getJournalLineage(u),n=await this.lineageHelper.getEntityInLineage(e,t);if(!n)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL,`No revision found for journal of ID ${u}, or ${u} does not exist.`);if(n.removed)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_IS_REMOVED,`The entity with ID ${n.entityId} was already removed.`);y.revisionJournals[u]={revisions:{},materializedViews:{},revisionLocalIdsLookup:{},orderedRevisions:[],staticData:n.staticData}}y.revisionJournals[u].staticData=this.combineChanges(y.revisionJournals[u].staticData,[null!=o?o:{}]);const{revision:_}=await this._createRevision(y,u,{revisionId:c,revisionPermanentId:m,commandId:l,revisionDate:d,staticDataChanges:a.default(o||{}),dataChanges:i||{},created:!1,removed:!1,parentEntityId:s});if(r){if(!y.relationship)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_IS_REMOVED,`The entity with ID ${y.entityId} was already removed.`);r.from&&(y.relationship.fromEntityId=r.from.entityId,y.relationship.fromRevisionId=r.from.revisionId),r.to&&(y.relationship.toEntityId=r.to.entityId,y.relationship.toRevisionId=r.to.revisionId)}const v=await this._getLastMaterializedViewInLineage(y,u);let E=null==v?void 0:v.data;return void 0!==_.dataChanges&&(E=this.combineChanges(E,[_.dataChanges])),await this.createMaterializedView(y.entityId,u,_.revisionId,{data:E,removed:_.removed,parentEntityId:s||(null==v?void 0:v.parentEntityId)}),{storedEntity:y,entityRevision:_}}async _getLastMaterializedViewInLineage(e,t){let n,r=e.revisionJournals[t];if(r&&(n=this._getLastMaterializedView(r,t)),!n){const o=await this.lineageHelper.getJournalLineage(t);for(;!n&&o.length>0;){const t=o.shift();r=e.revisionJournals[t],r&&(n=this._getLastMaterializedView(r,t))}}return n}async removeEntity(e,t){var n;const{journalId:r,commandId:o,revisionDate:i,revisionPermanentId:s}=t;let{revisionId:c}=t;if(!r)throw new h.StoreError(p.ErrorCode.L5_GEN_INVALID_VALUE,"journalId");if(!e)throw new h.StoreError(p.ErrorCode.L5_GEN_INVALID_VALUE,"entityId");const l=this._getStoredEntity(e);if(!l)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the current entity store.`);if(await this.lineageHelper.isEntityRemovedInLineage(r,e))throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_IS_REMOVED,`Entity with ID ${e} was already removed.`);const d=l.revisionJournals[r];if(c&&(null==d?void 0:d.revisions[c]))throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_REVISION_ALREADY_EXIST,`Revision with Id ${c} already exists for the journal ${r}.`);c=c||u.nanoid();const{revision:m}=await this._createRevision(l,r,{revisionId:c,revisionPermanentId:s,commandId:o,revisionDate:i,removed:!0}),{data:y}=null!==(n=await this._getLastMaterializedViewInLineage(l,r))&&void 0!==n?n:{};await this.createMaterializedView(l.entityId,m.journalId,m.revisionId,{data:y,removed:m.removed});const g=await this.getEntity({entityId:e,revisionId:c},{journalId:r});return a.default(g)}async deleteEntity(e,t=!0){const n=this._getStoredEntity(e);if(!1===t&&!0===await this.isEntityModifiedLocally(e))throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_CANNOT_DELETE_ENTITY,`Cannot delete entity with ID ${e} because it has been modified locally.`);(null==n?void 0:n.entityPermanentId)&&i(this,r).delete(null==n?void 0:n.entityPermanentId),this.entities.delete(e)}async setEntityPermanentId(e,t){const n=this._getStoredEntity(e);if(!n)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the entity store.`);n.entityPermanentId!==t&&(void 0!==n.entityPermanentId&&i(this,r).delete(n.entityPermanentId),n.entityPermanentId=t,i(this,r).set(t,e))}async getEntityIds(e,t){const n=this._getStoredEntity(e);if(!n)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the entity store.`);let r;if(t){const{journalId:e,revisionId:o}=t,i=n.revisionJournals[e];if(!i)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL,`No revision found for journal of ID ${e}, or ${e} does not exist.`);if(r=this._getStoredEntityRevision(i,o),!r)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_EXIST,`No revision with ID ${o} found for entity with ID ${n.entityId}.`)}return Object.assign({entityLocalId:n.entityId,entityPermanentId:n.entityPermanentId},r&&{revisionLocalId:r.revisionId,revisionPermanentId:r.revisionPermanentId})}_getStoredEntity(e){let t=this.entities.get(e);if(void 0===t){const n=i(this,r).get(e);t=n?this.entities.get(n):void 0}return t}_getStoredEntityRevision(e,t){const n=e.revisions[t];if(void 0===n){const n=e.revisionLocalIdsLookup[t];return n?e.revisions[n]:void 0}return n}async createMaterializedView(e,t,n,r){const o=this._getStoredEntity(e);if(!o)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the entity store.`);let i=o.revisionJournals[t];if(i){if(i.materializedViews[n])throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_MV_ALREADY_EXIST,`Materialized view for revision with ID ${n} already exists.`)}else i={revisions:{},materializedViews:{},revisionLocalIdsLookup:{},orderedRevisions:[],staticData:{}},o.revisionJournals[t]=i;const s=a.default(Object.assign({revisionId:n},r));return i.materializedViews[n]=s,Object.assign({entityId:e,journalId:t},s)}async createEntityStaticObject(e,t){const{localId:n,permanentId:o,type:s}=e,a=n||u.nanoid(),c={entityId:a,entityPermanentId:o,type:s,relationship:t?{fromEntityId:t.from.entityId,fromRevisionId:t.from.revisionId,toEntityId:t.to.entityId,toRevisionId:t.from.revisionId}:void 0,revisionJournals:{}};return this.entities.set(a,c),i(this,r).set(o,a),{localId:a,permanentId:c.entityPermanentId,type:s}}async _createRevision(e,t,n){var r,o;const{commandId:i,revisionDate:s,revisionPermanentId:a,staticDataChanges:c,dataChanges:l,created:d,removed:m,parentEntityId:y}=n;let{revisionId:g}=n,_=e.revisionJournals[t];if(g){if(_&&this._getStoredEntityRevision(_,g))throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_REVISION_ALREADY_EXIST,`Revision with ID ${g} already exists for the journal ${t}.`)}else g=u.nanoid();const v=await this._getRevisionJournalUsingLineage(e,t);let E={};(null==v?void 0:v.journalId)===t?(E=this.combineChanges(null!==(r=null==v?void 0:v.staticData)&&void 0!==r?r:void 0,[null!=c?c:{}]),e.revisionJournals[t].staticData=E):(E=this.combineChanges(m&&null!==(o=null==v?void 0:v.staticData)&&void 0!==o?o:void 0,[null!=c?c:{}]),_={staticData:E,revisions:{},materializedViews:{},revisionLocalIdsLookup:{},orderedRevisions:[]},e.revisionJournals[t]=_);const I={revisionId:g,revisionPermanentId:a,journalId:t,commandId:i,revisionDate:s,created:!!d,removed:m,parentEntityId:y,staticDataChanges:c,dataChanges:l};return _.revisions[g]=I,void 0!==a&&(_.revisionLocalIdsLookup[a]=g),_.orderedRevisions.push(I.revisionId),{revisionJournal:_,revision:I}}async createRevision(e,t,n,r){const o=this._getStoredEntity(e);if(!o||!e)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the entity store.`);const{revision:i}=await this._createRevision(o,t,n);if(r)await this.createMaterializedView(e,t,i.revisionId,r);else{const{revisionId:n,removed:r,parentEntityId:s,dataChanges:a}=i,c=await this._getLastMaterializedViewInLineage(o,t);await this.createMaterializedView(e,t,n,{removed:r,parentEntityId:void 0===s?null==c?void 0:c.parentEntityId:null!=s?s:void 0,data:this.combineChanges(null==c?void 0:c.data,void 0!==a?[a]:[])})}this.entities.set(o.entityId,o)}async deleteRevision(e,t,n){const r=this._getStoredEntity(e);if(!r)throw new h.StoreError(p.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the entity store.`);const o=r.revisionJournals[t];if(o){const e=this._getStoredEntityRevision(o,n);e&&(delete o.materializedViews[e.revisionId],delete o.revisions[e.revisionId],o.orderedRevisions=o.orderedRevisions.filter(e=>e!==n),o.staticData={},e.revisionPermanentId&&delete o.revisionLocalIdsLookup[e.revisionPermanentId],0===o.orderedRevisions.length&&delete r.revisionJournals[t])}}async clearLocalStore(){this.entities=new Map,this.lineageHelper=new m.LineageHelper(this.journalStore,this)}async transferRevisions(e,t){if(e===t)throw new h.StoreError(p.ErrorCode.L5_JOURNAL_STORE_TRANSFER_CONFLICT,"Source journal cannot be the same as the target journal.");await Promise.all([this.journalStore.getJournal(e),this.journalStore.getJournal(t)]);[...this.entities.values()].filter(t=>t.revisionJournals[e]).forEach(n=>{var r;const o=n.revisionJournals[e],i=null!==(r=n.revisionJournals[t])&&void 0!==r?r:{revisions:{},revisionLocalIdsLookup:{},materializedViews:{},orderedRevisions:[],staticData:{}};Object.assign(i.revisions,o.revisions),Object.assign(i.materializedViews,o.materializedViews),Object.assign(i.revisionLocalIdsLookup,o.revisionLocalIdsLookup),i.orderedRevisions.push(...o.orderedRevisions),i.staticData=o.staticData,n.revisionJournals[t]=i,delete n.revisionJournals[e]})}async isEntityModifiedLocally(e){const t=this._getStoredEntity(e);for(const e in null==t?void 0:t.revisionJournals){const t=await this.journalStore.getJournal(e);return["main","isolation","staging"].includes(t.role)}return!1}}t.InMemoryEntityStore=InMemoryEntityStore,r=new WeakMap},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LineageHelper=void 0;const r=n(107),o=n(103);t.LineageHelper=class LineageHelper{constructor(e,t){this.journalStore=e,this.entityStore=t}async getJournalLineage(e){const t=[];let n=await this.journalStore.getJournal(e);for(;n.parentJournalId;)t.push(n.parentJournalId),n=await this.journalStore.getJournal(n.parentJournalId);return t}async getEntityInLineage(e,t,n){for(const r of t){const[t]=await this.entityStore.getEntities([{entityId:e,revisionId:n}],{journalId:r});if(t)return t}}async getRelationshipInLineage(e,t,n){for(const r of t){const t=await this.entityStore.getRelationship({entityId:e,revisionId:n},{journalId:r});if(t)return t}}async isEntityRemovedInLineage(e,t){const n=(await this.entityStore.getJournalEntities(e)).find(e=>e.entityId===t);if(n)return n.removed;const{parentJournalId:i}=await this.journalStore.getJournal(e);if(!i)throw new r.StoreError(o.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity ${t} does not exist in journal ${e} lineage.`);return this.isEntityRemovedInLineage(i,t)}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),i=n(163);t.processBatchResults=function processBatchResults(e,t){return r(this,void 0,void 0,(function*(){const{result:e}=t;if(e.error)throw e.error;const n=i.validateNotProcessedResponse(t);if(n)throw new o.ServerError(n.message,n.code,n.innerError);return{resourceIds:e.resourceIds,resourceUrns:e.resourceUrns,revisionId:e.revisionId}}))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(47),i=n(6),s=n(109),a=n(2),c=n(36),u=n(24),l=n(110);class RelationshipCommandsRegistry{static createPayload(e){const t={type:e.typeid,components:e.components,attributes:i.AttributeConverter.convertChangeSetToAttributesV2(e.attributes),to:{asset:{id:e.toId},collection:{id:e.spaceCollectionId}},from:{asset:{id:e.fromId},collection:{id:e.spaceCollectionId}}};return e.toSnapshotId&&(t.to.snapshot={id:e.toSnapshotId}),e.fromSnapshotId&&(t.from.snapshot={id:e.fromSnapshotId}),t.createdBy=e.createdBy,t.lastModifiedBy=e.lastModifiedBy,t}static createLocally(e,t,n){return r(this,void 0,void 0,(function*(){c.validateUserState(n);const r=s.OfflineEntityWrapper.initialize();r.setEntityType("Relationship"),r.setTypeId(t.typeid);const o=e.getStoredId("id");r.setId(o),r.setParentId(t.spaceCollectionId),r.setAttributes(t.attributes),r.setComponents(t.components),r.setFromId(t.fromId),r.setToId(t.toId),r.setFromSnapshotId(t.fromSnapshotId),r.setToSnapshotId(t.toSnapshotId);const i=r.getFullEntity(),u=yield e.createRelationship(i,{from:{entityId:t.fromId,revisionId:""},to:{entityId:t.toId,revisionId:""}});if(!u)throw new a.SDKError("Error with creating a relationship locally");return{resourceId:u.entityId,resourceUrn:"/relationship/"+u.entityId,revisionId:u.revisionId,createdDate:new Date}}))}static updatePayload(e){return{id:e.resourceId,components:e.components,attributes:i.AttributeConverter.convertChangeSetToAttributesV2(e.attributes),createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy}}static updateLocally(e,t,n){return r(this,void 0,void 0,(function*(){c.validateUserState(n);const r=yield e.getEntity(t.resourceId),o=s.OfflineEntityWrapper.initialize(r);if(!r)throw new Error("404");o.setAttributes(t.attributes),o.setComponents(t.components);const i=o.getFullEntity(),a=yield e.updateEntity(t.resourceId,i);return{resourceId:a.entityId,resourceUrn:"/relationship/"+a.entityId,revisionId:a.revisionId,createdDate:new Date}}))}static deletePayload(e){return{id:e.resourceId}}static purgePayload(e){return{id:e.resourceId}}static restorePayload(e){return{id:e.resourceId}}static createRewriteIds(e,t,n){return r(this,void 0,void 0,(function*(){const n=[RelationshipCommandsRegistry.rewrite(e,"fromId",e.fromId,t),RelationshipCommandsRegistry.rewrite(e,"toId",e.toId,t),RelationshipCommandsRegistry.rewrite(e,"fromSnapshotId",e.fromSnapshotId,t),RelationshipCommandsRegistry.rewrite(e,"toSnapshotId",e.toSnapshotId,t)];return yield Promise.all(n),e}))}static rewrite(e,t,n,i){return r(this,void 0,void 0,(function*(){try{const r=(yield i(n)).entityId;Object.assign(e,{[t]:r})}catch(e){if(e.code!==o.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST)throw new a.SDKError(e.message,e)}}))}static processResults(e,t,n){return r(this,void 0,void 0,(function*(){if(void 0===t&&e.commandId)return e;const n=l.validateServerCommandResponse(t);return n?{error:n}:(yield u.storePermanentId(e,t),t.result)}))}static parseFetchPayload(e){let t,n;void 0!==e.from.snapshot&&(t=e.from.snapshot.id),void 0!==e.to.snapshot&&(n=e.to.snapshot.id);return{spaceCollectionId:i.extractCollectionIdFromUrl(e.attributes.url),id:e.id,attributes:i.AttributeConverter.convertAttributesToChangeset(e.attributes.data).serializedChangeSet,components:e.components.data,typeid:e.type,revisionId:e.revisionId,fromId:e.from.asset.id,fromSnapshotId:t,toId:e.to.asset.id,toSnapshotId:n,createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy}}static parseQueryPayload(e){const t=Object.assign({},e);return t.results=t.results.map(e=>RelationshipCommandsRegistry.parseFetchPayload(e)),t}}t.RelationshipCommandsRegistry=RelationshipCommandsRegistry},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(61)),defaultValueResolver=(e,t)=>o.default(e,t),i=["$or","$and"],resolveBooleanOperation=(e,t)=>{if(i.includes(t.name)){const{nestedFilters:n,booleanOperation:r}=t;return r(e,n)}const{fn:n}=t;return n(e)};t.comparisonOperators={$eq:(e,t,n,r)=>r(e,t)===n,$gt:(e,t,n,r)=>r(e,t)>n,$gte:(e,t,n,r)=>r(e,t)>=n,$lt:(e,t,n,r)=>r(e,t)<n,$lte:(e,t,n,r)=>r(e,t)<=n,$ne:(e,t,n,r)=>{const o=r(e,t);return void 0!==o&&o!==n},$in:(e,t,n,r)=>n.includes(r(e,t)),$nin:(e,t,n,r)=>!n.includes(r(e,t)),$exists:(e,t,n,r)=>r(e,t).includes(n),$nexists:(e,t,n,r)=>r(e,t).some(e=>e!==n),$or:(e,t)=>t.map(t=>resolveBooleanOperation(e,t)).some(e=>!0===e),$and:(e,t)=>!1===t.map(t=>resolveBooleanOperation(e,t)).some(e=>!1===e)};const flat=e=>e.reduce((e,t)=>e.concat(t),[]),getFiltersFields=(e,n,r,o,s=defaultValueResolver,a)=>e?flat(Object.entries(e).map(([e,t])=>{const n=o?o(e):e;return void 0!==n?[n,t]:[e,t]}).map(([e,c])=>{if(i.includes(e))return flat([{name:e||"$and",booleanOperation:t.comparisonOperators[e],nestedFilters:flat(c.map(t=>flat(getFiltersFields(t,e,"$or"===e,o,s))))}]);{"object"!=typeof c&&(c={$eq:c});const o=Object.entries(c);if(o.length>0){const i=[];return o.forEach(n=>{i.push({name:n[0],fn:r=>{let o=n[0];if(Array.isArray(e))return e.some(e=>t.comparisonOperators[n[0]](r,e,n[1],s(r,e)));e.startsWith("has.")&&(o="$ne"===n[0]?"$nexists":"$exists");return(a&&a(e,o)||t.comparisonOperators[o])(r,e,n[1],s(r,e))}})}),r?i:{name:n||"$and",booleanOperation:t.comparisonOperators.$and,nestedFilters:i}}}return[]})):[];t.filterHelper=(e,t,n,r,o)=>{const i=getFiltersFields(t,void 0,void 0,n,r,o);return e.filter(e=>{return t=e,!1===i.map(e=>{const{booleanOperation:n,nestedFilters:r}=e;return n(t,r)}).some(e=>!1===e);var t})}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(376)),i=r(n(198)),s=n(6);class LocalFilterHelper{constructor(e,t,n){this.nativeKeys=t,this.customKeyMapper=n,this.filterObj=new s.FiltersBuilder(e).toObject()}getFilter(){return this.filterObj}getNativeFilter(){return this.nativeFilter||(this.nativeFilter=this.mapNativeFilter(o.default(this.filterObj,this.nativeKeys))),this.nativeFilter}getNonNativeFilter(){return this.nonNativeFilter||(this.nonNativeFilter=i.default(this.filterObj,this.nativeKeys)),this.nonNativeFilter}mapNativeFilter(e){let t={};return Object.entries(e).forEach(([e,n])=>{const r=this.customKeyMapper(e);if(Array.isArray(r)){const[e,o]=LocalFilterHelper.mapMultiFieldFilter(r,n);Object.keys(e).length>0&&(t=Object.assign(Object.assign({},t),e)),o.length>0&&(t.$and||(t.$and=[]),t.$and.push({$or:o}))}else t[r]=n}),t}static mapMultiFieldFilter(e,t){const n=i.default(t,["$ne","$nin"]),r=Object.keys(n).length>0,s=o.default(t,["$ne","$nin"]),a=Object.keys(s).length>0,c={},u=[];return e.forEach(e=>{r&&u.push({[e]:n}),a&&(c[e]=s)}),[c,u]}}t.LocalFilterHelper=LocalFilterHelper},function(e,t){var n="object"==typeof global&&global&&global.Object===Object&&global,r="object"==typeof self&&self&&self.Object===Object&&self,o=n||r||Function("return this")();function apply(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function arrayPush(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}var i=Object.prototype,s=i.hasOwnProperty,a=i.toString,c=o.Symbol,u=i.propertyIsEnumerable,l=c?c.isConcatSpreadable:void 0,d=Math.max;function isFlattenable(e){return p(e)||function isArguments(e){return function isArrayLikeObject(e){return isObjectLike(e)&&function isArrayLike(e){return null!=e&&function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!function isFunction(e){var t=function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?a.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)}(e)}(e)&&s.call(e,"callee")&&(!u.call(e,"callee")||"[object Arguments]"==a.call(e))}(e)||!!(l&&e&&e[l])}function toKey(e){if("string"==typeof e||function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&"[object Symbol]"==a.call(e)}(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}var p=Array.isArray;function isObjectLike(e){return!!e&&"object"==typeof e}var h=function baseRest(e,t){return t=d(void 0===t?e.length-1:t,0),function(){for(var n=arguments,r=-1,o=d(n.length-t,0),i=Array(o);++r<o;)i[r]=n[t+r];r=-1;for(var s=Array(t+1);++r<t;)s[r]=n[r];return s[t]=i,apply(e,this,s)}}((function(e,t){return null==e?{}:function basePick(e,t){return function basePickBy(e,t,n){var r=-1,o=t.length,i={};for(;++r<o;){var s=t[r],a=e[s];n(a,s)&&(i[s]=a)}return i}(e=Object(e),t,(function(t,n){return n in e}))}(e,function arrayMap(e,t){for(var n=-1,r=e?e.length:0,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}(function baseFlatten(e,t,n,r,o){var i=-1,s=e.length;for(n||(n=isFlattenable),o||(o=[]);++i<s;){var a=e[i];t>0&&n(a)?t>1?baseFlatten(a,t-1,n,r,o):arrayPush(o,a):r||(o[o.length]=a)}return o}(t,1),toKey))}));e.exports=h},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),i=n(109),s=n(36),a=n(164),c=n(84),u=n(994),l=n(222),d=n(995),p=n(6);class RelationshipQueriesRegistry{static getLocally(e,t,n){return r(this,void 0,void 0,(function*(){return c.EntityQueriesRegistry.getLocally(e,t,RelationshipQueriesRegistry.packageRelationship,n)}))}static queryLocally(e,t,n){return r(this,void 0,void 0,(function*(){return c.EntityQueriesRegistry.queryLocally(e,t,{customKeyMapper:RelationshipQueriesRegistry.customKeyMapper,packageEntity:RelationshipQueriesRegistry.packageRelationship,entityType:"Relationship",nativeKeys:RelationshipQueriesRegistry.nativeKeys},n)}))}static queryRelationships(e,t,n){return r(this,void 0,void 0,(function*(){if(s.validateUserState(n),!t.fromAsset&&!t.toAsset)return RelationshipQueriesRegistry.queryAllRelationships(e,t,n);let r;if(t.fromAsset){const o=[{direction:"OUT",type:t.type?d.splitType(t.type):void 0}];r=yield RelationshipQueriesRegistry.getAssetRelationships(e,{assetId:t.fromAsset,filters:o,spaceCollectionId:t.fromCollection},n),t.toAsset&&(r=r.filter(e=>e.toId===t.toAsset))}else{const o=[{direction:"IN",type:t.type?d.splitType(t.type):void 0}];r=yield RelationshipQueriesRegistry.getAssetRelationships(e,{assetId:t.toAsset,filters:o,spaceCollectionId:t.fromCollection},n)}if(void 0!==t.offset&&t.offset>=0&&(r=r.slice(t.offset)),void 0!==t.limit&&t.limit<r.length)return{pagination:{limit:t.limit,offset:(t.offset||0)+t.limit},results:r.slice(0,t.limit)};return{pagination:{limit:r.length,offset:-1,nextUrl:""},results:r}}))}static queryAllRelationships(e,t,n){var i,c,u,d,h;return r(this,void 0,void 0,(function*(){let r;s.validateUserState(n);const m=t.limit||l.DEFAULT_QUERY_USER_LIMIT,y={filters:{"staticData.metadata.entityType":"Relationship"},limit:l.QUERY_BUFFER_SIZE};t.type&&(y.filters["staticData.metadata.type"]=t.type),t.filter&&"SqliteEntityStore"===e.entityStore.constructor.name&&(r=p.FiltersBuilder.parseToObject(t.filter),r&&((null===(i=null==r?void 0:r.type)||void 0===i?void 0:i.$eq)?y.filters["staticData.metadata.type"]=r.type:((null===(c=r["type.name"])||void 0===c?void 0:c.$eq)?y.filters["staticData.metadata.type"]={$like:r["type.name"].$eq+"-%"}:(null===(u=r["type.name"])||void 0===u?void 0:u.$in)&&(y.filters["staticData.metadata.type"]={$or:r["type.name"].$in.map(e=>({$like:e+"-%"}))}),(null===(d=r["type.version"])||void 0===d?void 0:d.$eq)?y.filters["staticData.metadata.type"]={$like:"%-"+r["type.version"].$eq}:(null===(h=r["type.version"])||void 0===h?void 0:h.$in)&&(y.filters["staticData.metadata.type"]={$or:r["type.version"].$in.map(e=>({$like:"%-"+e}))}))));let g=t.offset||0,_=[],v=[];do{try{y.offset=g,_=(yield e.queryEntities(y)).items}catch(e){throw new o.SDKError("Unable to query entities",e)}if(0===_.length){if(0===v.length)return;break}v=t.filter?v.concat(a.applyFilter(_,t.filter,RelationshipQueriesRegistry.customKeyMapper)):v.concat(_),g+=y.limit}while(v.length<m&&_.length>=y.limit);let E=y.offset;v.length<=m?E+=y.limit:(v=v.slice(0,m),E+=_.indexOf(v[v.length-1])+1);const I=v.map(e=>{if(e)return RelationshipQueriesRegistry.packageRelationship(e,t.fromCollection)});return{results:I,pagination:{limit:m,offset:I.length<m?-1:E}}}))}static getAssetRelationships(e,t,n){return r(this,void 0,void 0,(function*(){s.validateUserState(n);const r={IN:!1,OUT:!1};let o;if(t.filters?t.filters.forEach(e=>{r[e.direction]=!0}):(r.IN=!0,r.OUT=!0),o=r.IN?yield e.getRelationships(t.assetId,void 0,{direction:"in",fetchEntityData:!1,fetchTipRelationshipData:!0}):[],r.OUT&&(o=o.concat(yield e.getRelationships(t.assetId,void 0,{direction:"out",fetchEntityData:!1,fetchTipRelationshipData:!0}))),t.filters){const e=u.relationshipFiltersToRsql(t.assetId,t.filters);o=a.applyFilter(o,e,RelationshipQueriesRegistry.customKeyMapper)}const i=[];return o.forEach(e=>{i.push(RelationshipQueriesRegistry.packageRelationship(e,t.spaceCollectionId))}),i}))}}t.RelationshipQueriesRegistry=RelationshipQueriesRegistry,RelationshipQueriesRegistry.nativeKeys=[...c.EntityQueriesRegistry.nativeKeys,"relationshipId"],RelationshipQueriesRegistry.mappers={relationshipId:["entityId","entityPermanentId"],fromAsset:"staticData.metadata.from.assetId",toAsset:"staticData.metadata.to.assetId",fromSnapshot:"staticData.metadata.from.snapshotId",toSnapshot:"staticData.metadata.to.snapshotId"},RelationshipQueriesRegistry.customKeyMapper=e=>RelationshipQueriesRegistry.mappers[e]||c.EntityQueriesRegistry.customKeyMapper(e),RelationshipQueriesRegistry.packageRelationship=(e,t)=>{const n=i.OfflineEntityWrapper.initialize(e,"Relationship");return{id:e.entityPermanentId||e.permanentId||e.entityId,spaceCollectionId:t,typeid:n.getTypeId(),components:n.getFullComponentView(),attributes:n.getAttributes(),revisionId:e.revisionId,fromId:n.getFromId(),toId:n.getToId(),fromSnapshotId:n.getFromSnapshotId(),toSnapshotId:n.getToSnapshotId(),createdBy:n.getCreatedBy(),lastModifiedBy:n.getLastModifiedBy()}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(224)),s=n(84),a=n(36);class AssetQueriesRegistry{static getLocally(e,t,n){return r(this,void 0,void 0,(function*(){return s.EntityQueriesRegistry.getLocally(e,t,AssetQueriesRegistry.packageAsset,n)}))}static queryLocally(e,t,n){return r(this,void 0,void 0,(function*(){return s.EntityQueriesRegistry.queryLocally(e,t,{customKeyMapper:AssetQueriesRegistry.customKeyMapper,packageEntity:AssetQueriesRegistry.packageAsset,entityType:"Asset",nativeKeys:AssetQueriesRegistry.nativeKeys},n)}))}static queryAssetsLocally(e,t,n){return r(this,void 0,void 0,(function*(){a.validateUserState(n);const r=[],o=i.default(t.assetIds,400);for(const n of o){(yield e.getEntities(n)).forEach(e=>{e?r.push(AssetQueriesRegistry.packageAsset(e,t.collectionId)):r.push(void 0)})}return r}))}}t.AssetQueriesRegistry=AssetQueriesRegistry,AssetQueriesRegistry.nativeKeys=[...s.EntityQueriesRegistry.nativeKeys,"assetId"],AssetQueriesRegistry.customKeyMapper=e=>"spaceId"===e?"parentEntityId":"assetId"===e?["entityId","entityPermanentId"]:s.EntityQueriesRegistry.customKeyMapper(e),AssetQueriesRegistry.packageAsset=(e,t)=>{const n=s.EntityQueriesRegistry.packageEntity(e,t);return Object.assign(Object.assign({},n),{assetId:n.id,spaceId:n.parentId})}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(998);Object.defineProperty(t,"CommandBatchJournalError",{enumerable:!0,get:function(){return i.CommandBatchJournalError}}),o(n(225),t);var s=n(1e3);Object.defineProperty(t,"JournalingSDK",{enumerable:!0,get:function(){return s.JournalingSDK}}),o(n(1013),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryContext=void 0;const r=n(47),o=n(371);t.QueryContext=class QueryContext{constructor(e,t,n,r){this.journal=e,this.journalStore=t,this.entityStore=n,this.queryExecutor=r,this.lineageHelper=new o.LineageHelper(t,n)}async saveEntity(e,t,n){const{entityId:o,entityPermanentId:i,revisionId:s,revisionPermanentId:a,type:c,staticData:u,data:l,removed:d}=e;let p=!0,h="";try{const e=await this.entityStore.getEntityIds(o);h=e.entityLocalId,!i||e.entityPermanentId&&e.entityPermanentId===i||await this.entityStore.setEntityPermanentId(o,i)}catch(e){if(e.code.id!==r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST.id)throw e;p=!1}if(!p){h=(await this.entityStore.createEntityStaticObject({permanentId:i,type:c},t)).localId}await this.entityStore.createRevision(h,this.journal.id,{revisionId:s,revisionPermanentId:a,revisionDate:new Date,staticDataChanges:u,dataChanges:n,created:!p,removed:d},{data:l,removed:d})}async getEntity(e,t){var n;try{const[n]=await this.entityStore.getEntities([{entityId:e,revisionId:t}],{journalId:this.journal.id});if(!n){const n=await this.lineageHelper.getJournalLineage(this.journal.id);return this.lineageHelper.getEntityInLineage(e,n,t)}return n}catch(o){if((null===(n=o.code)||void 0===n?void 0:n.id)!==r.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL.id)throw o;const i=await this.lineageHelper.getJournalLineage(this.journal.id);return this.lineageHelper.getEntityInLineage(e,i,t)}}async getEntities(e){return this.entityStore.getEntities(e,{journalId:this.journal.id})}async queryEntities(e){return this.entityStore.queryEntities(this.journal.id,e)}async getEntityRevisions(e,t){return this.entityStore.getEntityRevisions(e,this.journal.id,t)}async getEntityPermanentId(e){return(await this.entityStore.getEntityIds(e)).entityPermanentId}async getRelationship(e,t){var n;try{const n=await this.entityStore.getRelationship({entityId:e,revisionId:t},{journalId:this.journal.id});if(!n){const n=await this.lineageHelper.getJournalLineage(this.journal.id);return this.lineageHelper.getRelationshipInLineage(e,n,t)}return n}catch(o){if((null===(n=o.code)||void 0===n?void 0:n.id)!==r.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL.id)throw o;const i=await this.lineageHelper.getJournalLineage(this.journal.id);return this.lineageHelper.getRelationshipInLineage(e,i,t)}}async getRelationships(e,t,n,r){return this.entityStore.getRelationships({entityId:e,revisionId:t},{journalId:this.journal.id},n,r)}async executeQuery(e,t,n,r){return this.queryExecutor.executeNested(e,t,n,this,this.journal,r)}async getEntitiesByParent(e){return(await this.entityStore.queryEntities(this.journal.id,{filters:{parentEntityId:e}})).items}async createRelationship(e,t){return this.entityStore.createRelationship(e,t,{journalId:this.journal.id,revisionDate:new Date,revisionId:e.revisionId})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(382);Object.defineProperty(t,"Journal",{enumerable:!0,get:function(){return r.Journal}});var o=n(226);Object.defineProperty(t,"Command",{enumerable:!0,get:function(){return o.Command}});var i=n(1001);Object.defineProperty(t,"JournalManager",{enumerable:!0,get:function(){return i.JournalManager}});var s=n(1004);Object.defineProperty(t,"JournalEventEmitter",{enumerable:!0,get:function(){return s.JournalEventEmitter}});var a=n(165);Object.defineProperty(t,"CommandQueryRegistry",{enumerable:!0,get:function(){return a.CommandQueryRegistry}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Journal=void 0;const r=n(226);class Journal{constructor(e,t){this.id=e,this.store=t}async lock(){throw new Error("not implemented")}async unlock(){throw new Error("not implemented")}async addCommand(e){const t=await this.store.getJournalStore().addCommandToJournal(this.id,e);return new r.Command(t.commandId,this.store.getJournalStore())}async updateCommand(e,t){const n=await this.store.getJournalStore().updateCommand(e,t);return new r.Command(n.commandId,this.store.getJournalStore())}async getCommands(){return this.store.getJournalStore().getJournalCommands(this.id)}async getParentJournal(){const e=await this.store.getJournalStore().getJournal(this.id);if(e&&e.parentJournalId)return new Journal(e.parentJournalId,this.store)}async getCollectionId(){return(await this.store.getJournalStore().getJournal(this.id)).collectionId}async reset(e){const t=this.store.getJournalStore(),n=this.store.getEntityStore();e&&await t.updateJournal(this.id,{parentJournalId:e.id});const o=await t.getJournalCommands(this.id),i=[];for(const e of o){const o=new r.Command(e.commandId,t),s=await o.getModifiedEntities();for(const t of s){(await n.getEntityRevisions(t,this.id,{filters:{commandId:{$eq:e.commandId}}})).items.forEach(e=>{i.push(n.deleteRevision(t,this.id,e.revisionId))})}}await Promise.all(i),await t.clearJournalCommands(this.id)}async getData(){return this.store.getJournalStore().getJournal(this.id)}async getLineage(){const e=await this.getParentJournal();return e?[e.id,...await e.getLineage()]:[]}async hasChildren(){return(await this.store.getJournalStore().getJournalsByParent(this.id)).length>0}}t.Journal=Journal},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitBy=t.removeCommands=t.bridgeOrNoop=t.bridge=void 0;const r=n(19),o=n(165);function bridge(e,t){t.dependentNodes.forEach(n=>{const r=e.get(n);r.dependsOn=new Set([...r.dependsOn,...t.dependsOn]),r.dependsOn.delete(t.commandId),t.dependsOn.forEach(r=>{var o,i;null===(o=e.get(r))||void 0===o||o.dependentNodes.add(n),null===(i=e.get(r))||void 0===i||i.dependentNodes.delete(t.commandId)})})}t.bridge=bridge,t.bridgeOrNoop=function bridgeOrNoop(e,t){const n=t.dependsOn.size*t.dependentNodes.size;t.dependsOn.size+t.dependsOn.size+2<n?e.set(t.commandId,Object.assign(Object.assign({},t),{commandName:o.COMMAND_NOOP})):bridge(e,t)},t.removeCommands=function removeCommands(e){return(t,n)=>{if(0===n.length)return t;const i=new Map(t.map(({commandId:e,dependsOn:t,commandName:n})=>[e,{commandId:e,commandName:n,dependsOn:new Set(t),dependentNodes:new Set}]));t.forEach(e=>{e.dependsOn.forEach(t=>{var n;null===(n=i.get(t))||void 0===n||n.dependentNodes.add(e.commandId)})}),n.forEach(t=>{const n=i.get(t);if(!n)throw new r.JournalError(r.JournalErrorCode.L7_COMMAND_NOT_FOUND_IN_THE_BATCH,`The command ${t} was not found in the batch`);e(i,n)});const s=new Set(n);return t.map(e=>{const{commandName:t}=i.get(e.commandId);e.commandName!==o.COMMAND_NOOP&&t===o.COMMAND_NOOP&&s.delete(e.commandId);const n=Object.assign(Object.assign({},e),{dependsOn:[...i.get(e.commandId).dependsOn],commandName:t});return n.dependentNodes&&(n.dependentNodes=[...i.get(e.commandId).dependentNodes]),n}).filter(({commandId:e})=>!1===s.has(e))}},t.splitBy=function splitBy(e,t){const n=new Map(e.map(({commandId:e,commandName:t,dependsOn:n})=>[e,{commandId:e,commandName:t,dependsOn:new Set(n),dependentNodes:new Set}]));e.forEach(e=>{e.dependsOn.forEach(t=>{var r;null===(r=n.get(t))||void 0===r||r.dependentNodes.add(e.commandId)})});const r=new Set;return e.forEach((e,o)=>{t(e)&&(n.get(e.commandId).dependentNodes.forEach(t=>{n.get(t).dependsOn.delete(e.commandId)}),n.get(e.commandId).dependsOn.forEach(t=>{n.get(t).dependentNodes.delete(e.commandId)}),r.add(o))}),e.reduce((t,o,i)=>{if(r.has(i))i!==e.length-1&&t.push([]);else{const e=Object.assign(Object.assign({},o),{dependsOn:[...n.get(o.commandId).dependsOn]});e.dependentNodes&&(e.dependentNodes=[...n.get(o.commandId).dependentNodes]),t[t.length-1].push(e)}return t},[[]])}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getClient=t.getSingleInstance=void 0;const s=i(n(62)),a=i(n(37)),c=i(n(57)),u=i(n(1010));let l=null;const d={keepAlive:!0,timeout:3e4};t.getSingleInstance=async(e,t)=>(l||(l=new u.default(s.default,e),t&&"function"==typeof t.initializer&&await t.initializer(l)),l),t.getClient=e=>{const t=Object.assign(Object.assign(Object.assign({},d),e&&"boolean"==typeof e.keepAlive&&{keepAlive:e.keepAlive}),(null==e?void 0:e.socketTimeout)&&{timeout:e.socketTimeout}),n=new a.default.Agent(t),r=new c.default.Agent(t),o=s.default.create({httpAgent:n,httpsAgent:r});return o.defaults.validateStatus=()=>!0,new u.default(o,e,n,r)},o(n(1011),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BinaryAssetCommandsRegistry=class BinaryAssetCommandsRegistry{static uploadBinaryPayload(e){return{resumable:e.resumable,autoSnapshot:!0,assetEid:e.resourceId}}static completeUploadPayload(e){return{status:e.status}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(14);t.isSerializableCommands=e=>{for(const t of e)for(const e of Object.values(t.parameters))if(e instanceof r.Entity)return!1;return!0}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(133)),s=n(30),a=n(228),c=n(66),u=n(143),l=n(6),d=n(14),p=n(86),h=n(2),m=n(26),y=n(111);class Asset extends u.AccessControlEntity{get spaceId(){return this._spaceId}getCreateCommands(){const e=l.CommandParametersAdapter.toCreateAsset(this.serialize());return this.attachAdditionalDataToParameters(e),[new y.CreateEntityBlueprint(this,m.CreateAssetCommandName,e)]}getUpdateCommands(){const e=l.CommandParametersAdapter.toUpdateEntity(this.serialize());return this.attachAdditionalDataToParameters(e),[new y.UpdateEntityBlueprint(this,m.UpdateAssetCommandName,e)]}serialize(){const e=super.serialize();return this.newResource&&(e.spaceId=this.spaceId),e}createRelationship(e,t=c.relationshipTypeId){return this.sdkCore.buildModel(c.relationshipTypeId,t,"",this.spaceCollectionId,{initialData:{toId:e,fromId:this,spaceCollectionId:this.spaceCollectionId},fetched:!1})}createPinnedRelationship(e,t){const n={fromId:this,toId:e,spaceCollectionId:this.spaceCollectionId};if(!t.fromSnapshotId&&!t.toSnapshotId)throw new h.SDKError("Cannot call createPinnedRelationShip while missing both to and from Snapshot");return t.fromSnapshotId&&(n.fromSnapshotId=t.fromSnapshotId),t.toSnapshotId&&(n.toSnapshotId=t.toSnapshotId),this.sdkCore.buildModel(c.relationshipTypeId,t.typeId||c.relationshipTypeId,"",this.spaceCollectionId,{initialData:n,fetched:!1})}getSpace(e){return r(this,void 0,void 0,(function*(){if(void 0===this.spaceId)throw new h.SDKError("Cannot call getSpace with an undefined space ID");const t=i.default(e||{},{fetch:!0,assumeTypeId:c.spaceTypeId});return this.sdkCore.get(this.spaceId,this.spaceCollectionId,a.Space.fetchPayload,t)}))}move(e){return r(this,void 0,void 0,(function*(){const t=l.extractId(e),n=l.extractId(this.spaceCollectionId),r={spaceCollectionId:n,resourceId:n,toSpaceId:t,entitiesToMove:[this.getId()]},o={commandName:m.MoveAssetBatchCommandName,parameters:r,dependsOn:void 0},i=yield this.sdkCore.getDataConnector().handleSingleEntityCommands([o],r.spaceCollectionId);if(!i)throw new h.InternalError("Move was called within a subbatch. This should not happen.");return l.throwServerErrorIfNecessary(i),this._spaceId=t,this.upgrade(i),i}))}copy(e){return r(this,void 0,void 0,(function*(){const t=l.extractId(this.spaceCollectionId),n={spaceCollectionId:t,resourceId:t,toSpaceId:l.extractId(e||this.spaceId),entitiesToCopy:[this.getId()]},r={commandName:m.CopyAssetCommandName,parameters:n,dependsOn:void 0},o=yield this.sdkCore.getDataConnector().handleSingleEntityCommands([r],n.spaceCollectionId);if(!o)throw new h.InternalError("Copy was called within a subbatch. This should not happen.");l.throwServerErrorIfNecessary(o);const i=o.successes[0];return this.sdkCore.buildModel(c.assetTypeId,this.typeid,i.resourceIds[0],t,{initialData:{spaceCollectionId:t},fetched:!1,revisionId:i.revisionId})}))}getDeleteCommand(){const e={spaceCollectionId:l.extractId(this.spaceCollectionId),resourceId:this.getId()};return{commandName:m.DeleteAssetCommandName,parameters:e,dependsOn:void 0}}getPurgeCommand(){const e={spaceCollectionId:l.extractId(this.spaceCollectionId),resourceId:this.getId()};return{commandName:m.PurgeAssetCommandName,parameters:e,dependsOn:void 0}}restoreInternal(){const e={spaceCollectionId:l.extractId(this.spaceCollectionId),resourceId:this.getId()};return{commandName:m.RestoreAssetCommandName,parameters:e,dependsOn:void 0}}getLatestAsset(e){return r(this,void 0,void 0,(function*(){const t=i.default(e||{},{fetch:!0,assumeTypeId:c.assetTypeId});return this.sdkCore.get(this,this.spaceCollectionId,Asset.fetchPayload,t)}))}initWithData(e,t){this._spaceId=e.spaceId,e.typeid&&(this.typeid=e.typeid),super.initWithData(e,t)}getRevisions(e={}){const t=(new l.QueryRequestParamsBuilder).filter(e.filter).sort(e.sort).limit(e.limit).param("spaceCollectionId",l.extractId(this.spaceCollectionId)).param("id",this.id).param("include",e.includeSnapshot?"snapshots":void 0).build();return new p.AssetRevisionsQueryResult(this.sdkCore,t)}getRelationships(e){const t=(new l.QueryRequestParamsBuilder).filter(e.filter).sort(e.sort).limit(e.limit).param("fromAsset",e.direction===s.RelationshipDirection.outgoing?this.id:void 0).param("toAsset",e.direction===s.RelationshipDirection.incoming?this.id:void 0).build();return d.SpaceCollection.queryRelationships(l.extractId(this.spaceCollectionId),this.sdkCore,t)}clearData(){super.clearData(),this._spaceId=void 0}fetchPayload(e){return r(this,void 0,void 0,(function*(){const t={spaceCollectionId:l.extractId(this.spaceCollectionId),id:this.id,revisionId:e||!this.revisionId?void 0:this.revisionId};return Asset.fetchPayload(this.sdkCore,t)}))}static fetchPayload(e,t){return r(this,void 0,void 0,(function*(){return t.revisionId?e.getDataConnector().journalQuery(m.GetAssetAtRevisionQueryName,t):e.getDataConnector().journalQuery(m.GetAssetQueryName,t)}))}}t.Asset=Asset},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(229);t.AssetQueryPage=r.AssetQueryPage;var o=n(87);t.QueryPage=o.QueryPage;var i=n(1024);t.RelationshipQueryPage=i.RelationshipQueryPage;var s=n(389);t.RevisionsQueryPage=s.RevisionsQueryPage;var a=n(390);t.SnapshotQueryPage=a.SnapshotQueryPage;var c=n(391);t.SpaceQueryPage=c.SpaceQueryPage},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(87);class RevisionsQueryPage extends r.QueryPage{constructor(e,t){super(e),this.revisions=t}getRevisions(){return this.revisions}}t.RevisionsQueryPage=RevisionsQueryPage},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(87);class SnapshotQueryPage extends r.QueryPage{constructor(e,t,n,r,o){super(e,n,r,o),this.snapshots=t}getSnapshots(){return this.snapshots}}t.SnapshotQueryPage=SnapshotQueryPage},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(87);class SpaceQueryPage extends r.QueryPage{constructor(e,t,n,r,o){super(e,n,r,o),this.spaces=t}getSpaces(){return this.spaces}}t.SpaceQueryPage=SpaceQueryPage},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(67),i=n(229),s=n(14),a=n(26),c=n(151),u=n(6);class SnapshotAssetsQueryResult extends o.QueryResult{queryPage(){return r(this,void 0,void 0,(function*(){return c.withSpan(this.sdkCore.getTracingOptions(),"query","snapshot assets",()=>this.sdkCore.getDataConnector().journalQuery(a.GetAssetsInSnapshotQueryName,this.queryParameters))}))}createPage(e,t=-1,n=0){var r;const o=[],{results:c}=e;for(const e of c){const t=e.revision?e.revision.id:void 0,n=e.components?e.components:void 0,i=void 0!==(null===(r=e.attributes)||void 0===r?void 0:r.data)?u.AttributeConverter.convertAttributesToChangeset(e.attributes.data).serializedChangeSet:void 0,a=this.sdkCore.buildModel(s.assetTypeId,s.assetTypeId,e.asset.id,this.collectionId,{initialData:{revisionId:t,attributes:i,components:n},fetched:!1});o.push(a)}return new i.AssetQueryPage(e,o,a.GetAssetsInSnapshotQueryName,t,n)}}t.SnapshotAssetsQueryResult=SnapshotAssetsQueryResult},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(14),o=n(232),i=n(1046),s=n(31);class EntityBlueprint extends o.CommandBlueprint{constructor(e,t,n){super(),this.entity=e,this.commandName=t,this.parameters=n}getAffectedEntities(){return[this.entity]}getRevisedEntities(){return[this.entity]}serialize(e){const t=i.buildParameterDependencies(this.parameters,e);return{commandName:this.commandName,parameters:t.parameters,dependsOn:t.dependencies}}canDependOnPreviousBatches(e){const t=this.entity instanceof r.Asset||this.entity instanceof r.Relationship||this.entity instanceof r.Snapshot||this.entity instanceof r.Space;return this.commandName!==s.UpdateCollectionCommandName&&(void 0!==e&&0===e.length&&(t||!this.entity.isNewResource()))}}t.EntityBlueprint=EntityBlueprint},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(13)),s=o(n(224)),a=n(6),c=n(392),u=n(14),l=n(2),d=n(26),p=n(311),h=n(1055),m=n(1056),y=n(111),g=n(1057);class Snapshot extends u.Entity{constructor(e,t,n,r){super(e,t,n,r),this.assetsPendingAdds=new p.IdentifiableMap,this.assetsPendingRemoves=new Set}static batchPendingAdds(e){const t=[];let n;for(const[r,o]of e)n&&50!==n.size||(n=new p.IdentifiableMap,t.push(n)),n.set(r,o);return t}static batchPendingRemoves(e){const t=Array.from(e);return s.default(t,50)}getCreateCommands(){const e=a.CommandParametersAdapter.toCreateSnapshot(this.serialize());this.attachAdditionalDataToParameters(e);const t=Snapshot.batchPendingAdds(this.assetsPendingAdds),n=t.shift(),r=[];r.push(new h.CreateSnapshotBlueprint(this,e,n));const o=this.attachAdditionalDataToParameters({});for(const e of t)r.push(new m.AddAssetsToSnapshotBlueprint(this,e,o));return r}getUpdateCommands(){const e=a.CommandParametersAdapter.toUpdateSnapshot(this.serialize());this.attachAdditionalDataToParameters(e);const t=[];i.default(e.components)&&i.default(e.attributes)||t.push(new y.UpdateEntityBlueprint(this,d.UpdateSnapshotCommandName,e));const n=this.attachAdditionalDataToParameters({}),r=Snapshot.batchPendingRemoves(this.assetsPendingRemoves);for(const e of r)t.push(new g.RemoveAssetsFromSnapshotBlueprint(this,e,n));const o=Snapshot.batchPendingAdds(this.assetsPendingAdds);for(const e of o)t.push(new m.AddAssetsToSnapshotBlueprint(this,e,n));return t}serialize(){return super.serialize()}getDeleteCommand(){const e={spaceCollectionId:a.extractId(this.spaceCollectionId),resourceId:this.getId()};return{commandName:d.DeleteSnapshotCommandName,parameters:e,dependsOn:void 0}}getPurgeCommand(){const e={spaceCollectionId:a.extractId(this.spaceCollectionId),resourceId:this.getId()};return{commandName:d.PurgeSnapshotCommandName,parameters:e,dependsOn:void 0}}restoreInternal(){const e={spaceCollectionId:a.extractId(this.spaceCollectionId),resourceId:this.getId()};return{commandName:d.RestoreSnapshotCommandName,parameters:e,dependsOn:void 0}}addAssetInternal(e,t){if(this.assetsPendingAdds.has(e))throw new l.SDKError("Snapshot already has a pending addition for given asset "+a.extractIdOrReference(e));this.assetsPendingAdds.set(e,t),this.sdkCore.touch(this)}addVersionedAsset(e,t){this.addAssetInternal(e,{action:"ADDREVISION",revisionId:t||""})}addVersionedAssetWithEventualRevision(e){if(!this.sdkCore.isBatching())throw new l.SDKError("addVersionedAssetWithEventualRevision can only be used while batching");this.addAssetInternal(e,{action:"ADDEVENTUALREVISION",revisionId:e.getLastRevisionId()||void 0})}addAssetAtTip(e){this.addAssetInternal(e,{action:"ADDREVISION",revisionId:""})}removeAsset(e){if(this.assetsPendingAdds.has(e))this.assetsPendingAdds.delete(e),this.isDirty()||this.sdkCore.unTouch(this);else{const t=a.extractIdOrReference(e);if(t instanceof u.Asset||this.assetsPendingRemoves.has(t))throw new l.SDKError(`An asset with id: ${t} does not exist on this snapshot.`);this.assetsPendingRemoves.add(t),this.sdkCore.touch(this)}}listAssets(){return this.sdkCore.logger.warn("Snapshot.listAssets() is deprecated, use snapshot.listPendingAssets()"),this.listPendingAssets()}listPendingAssets(){const e=[];for(const[t,n]of this.assetsPendingAdds)e.push({id:a.extractId(t),revisionId:n.revisionId});return e}getAssets(e={}){const t=(new a.QueryRequestParamsBuilder).filter(e.filter).sort(e.sort).limit(e.limit).param("spaceCollectionId",a.extractId(this.spaceCollectionId)).param("id",this.id).param("include",e.include?e.include.join(","):void 0).build();return new c.SnapshotAssetsQueryResult(this.sdkCore,t)}getAsset(e){return r(this,void 0,void 0,(function*(){let t;const n=a.extractId(e),r=this.getAssets();for(;!t&&(yield r.nextPage());){const e=r.getPage();e&&(t=e.getAssets().find(e=>e.getId()===n))}return t}))}fetchPayload(e){return r(this,void 0,void 0,(function*(){return Snapshot.fetchPayload(this.sdkCore,{spaceCollectionId:a.extractId(this.spaceCollectionId),id:this.id,revisionId:e||!this.revisionId?void 0:this.revisionId})}))}static fetchPayload(e,t){return r(this,void 0,void 0,(function*(){return e.getDataConnector().journalQuery(d.GetSnapshotQueryName,t)}))}cleanDirtyness(){super.cleanDirtyness(),this.assetsPendingAdds.clear(),this.assetsPendingRemoves.clear()}isDirty(){return this.assetsPendingAdds.size>0||this.assetsPendingRemoves.size>0||super.isDirty()}}t.Snapshot=Snapshot},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);t.makeAddAssetsChangeSet=(e,t,n)=>{const o=[],i={};for(const[e,s]of t){const t=n.resolveResourceId(e);switch(t.command&&o.push(t.command.getCommandId()),s.action){case"ADDREVISION":i[t.path]=s.revisionId||"";break;case"ADDEVENTUALREVISION":{const r=n.resolveRevisionId(e,s.revisionId);r.command&&o.push(r.command.getCommandId()),i[t.path]=r.path}break;default:throw new r.InternalError("Changes provided to makeAddAssetsChangeSet includes a removal")}}return{changeSet:{insert:{String:i}},dependencies:o}}},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});var r=n(1061);t.combineChanges=r.combineChanges;var o=n(1062);t.JournalsFactory=o.JournalsFactory,__export(n(397)),__export(n(401))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(398);t.L7JournalInstance=r.L7JournalInstance;var o=n(1063);t.L7Journals=o.L7Journals},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),i=n(101),s=n(30),a=n(6),c=n(14),u=n(80),l=n(399);class L7JournalInstance{constructor(e,t,n,r){this.journalSDK=e,this.id=t,this.type=n,this.collection=r}getId(){return this.id}getType(){return this.type}getParent(){return r(this,void 0,void 0,(function*(){const e=yield this.getParentInfo();if(e&&e.data)return new L7JournalInstance(this.journalSDK,e.data.journalId,e.type,this.collection)}))}setParent(e,t){return r(this,void 0,void 0,(function*(){return this.journalSDK.setParentJournal(this.id,e,Object.assign(Object.assign({},{mode:"tree",rebase:!0,recursiveRebase:!1}),t||{}))}))}executeCommands(e){return r(this,void 0,void 0,(function*(){if(!e.length)return Promise.resolve([]);if(!a.isSerializableCommands(e))throw new o.InternalError("Attempting to execute commands that are not serializable.");return this.journalSDK.executeCommandBatch(this.id,e)}))}executeQuery(e,t,n){return r(this,void 0,void 0,(function*(){return this.journalSDK.executeQuery(this.id,{queryName:e,parameters:t},n)}))}isolate(e,t){return r(this,void 0,void 0,(function*(){const n={journalId:e};t&&(n.properties=t);const r=yield this.journalSDK.createIsolationJournal(this.getId(),n);return new L7JournalInstance(this.journalSDK,r,i.JournalType.ISOLATED,this.collection)}))}sync(e){return r(this,void 0,void 0,(function*(){if(this.type!==i.JournalType.REMOTE&&this.type!==i.JournalType.MAIN)throw new o.SDKError("The sync method can only be called on a remote or main journal");yield this.journalSDK.fetch(a.extractId(this.collection),l.toSyncRequest(e))}))}rebase(e){return r(this,void 0,void 0,(function*(){if(this.type===i.JournalType.REMOTE)throw new o.SDKError("The rebase method cannot be called on a remote journal.");return this.type===i.JournalType.MAIN?this.journalSDK.pull(this.getId(),l.toSyncRequest(e)):this.journalSDK.rebase(this.getId())}))}rebaseOnly(){return r(this,void 0,void 0,(function*(){return this.rebase({selector:u.noopSelector,priority:s.SyncPriority.HIGHEST})}))}publish(e){return r(this,void 0,void 0,(function*(){if(this.type===i.JournalType.REMOTE)throw new o.SDKError("The publish method cannot be called on a remote journal");this.type!==i.JournalType.MAIN?yield this.getParent().then(e=>{if(void 0===e)throw new o.SDKError("Cannot publish to parent journal. Parent journal does not exist.");const t=e.getId();return this.journalSDK.synchronizeJournals(this.getId(),t)}):yield this.journalSDK.synchronizeWithServer(this.getId(),l.toSyncRequest(e))}))}publishOnly(){return r(this,void 0,void 0,(function*(){return this.publish({selector:u.noopSelector,priority:s.SyncPriority.HIGHEST})}))}delete(){return r(this,void 0,void 0,(function*(){if(this.type===i.JournalType.REMOTE||this.type===i.JournalType.MAIN)throw new o.SDKError(`A journal of type ${this.type} cannot be deleted.`);return this.journalSDK.deleteIsolationJournal(this.getId())}))}setAutoSynchronizationMode(e){if(this.getType()!==i.JournalType.MAIN)throw new o.SDKError("Automatic sync is only available on the MAIN journal. Current is "+this.getType());this.journalSDK.setAutoSynchronizationMode(a.extractId(this.collection),e)}setProperties(e){return r(this,void 0,void 0,(function*(){return this.journalSDK.updateJournalProperties(this.id,e)}))}getProperties(){return r(this,void 0,void 0,(function*(){const e=yield this.journalSDK.getJournals(a.extractId(this.collection));if(!e)return{};if("main"===this.type)return e.mainJournal.properties;if("remote"===this.type)return e.remoteJournal.properties;const t=e.isolationJournals.find(e=>e.journalId===this.id);return t?t.properties:{}}))}purgeCommandsForEntity(e){return r(this,void 0,void 0,(function*(){if(!(e instanceof c.Relationship))throw new o.SDKError(`Cannot purge commands for entity. ${e.getId()}.Purging of commands is only supported for Relationships.`);const t=(yield this.journalSDK.getJournalCommands(this.getId(),{modifiedEntities:[e.getId()]})).map(e=>e.commandId);return this.journalSDK.rebase(this.getId(),{removeCommands:t})}))}dispose(){return r(this,void 0,void 0,(function*(){return this.journalSDK.dispose()}))}getParentInfo(){return r(this,void 0,void 0,(function*(){if(this.getType()===i.JournalType.REMOTE)return;const e=yield this.journalSDK.getJournals(a.extractId(this.collection));if(this.type===i.JournalType.MAIN){const t=null==e?void 0:e.remoteJournal;return{type:i.JournalType.REMOTE,data:t}}const{parentJournalId:t}=null==e?void 0:e.isolationJournals.find(e=>e.journalId===this.id);if(t===(null==e?void 0:e.mainJournal.journalId))return{type:i.JournalType.MAIN,data:null==e?void 0:e.mainJournal};const n=null==e?void 0:e.isolationJournals.find(e=>e.journalId===t);return{type:i.JournalType.ISOLATED,data:n}}))}}t.L7JournalInstance=L7JournalInstance},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(80);t.toSyncRequest=function toSyncRequest(e){return Object.assign(Object.assign({},(null==e?void 0:e.selector)||o.collectionLegacySelector),{priority:(null==e?void 0:e.priority)||r.SyncPriority.NORMAL})}},function(e,t,n){(function(e){var n="[object Arguments]",r="[object Map]",o="[object Object]",i="[object Set]",s=/^\[object .+?Constructor\]$/,a=/^(?:0|[1-9]\d*)$/,c={};c["[object Float32Array]"]=c["[object Float64Array]"]=c["[object Int8Array]"]=c["[object Int16Array]"]=c["[object Int32Array]"]=c["[object Uint8Array]"]=c["[object Uint8ClampedArray]"]=c["[object Uint16Array]"]=c["[object Uint32Array]"]=!0,c[n]=c["[object Array]"]=c["[object ArrayBuffer]"]=c["[object Boolean]"]=c["[object DataView]"]=c["[object Date]"]=c["[object Error]"]=c["[object Function]"]=c[r]=c["[object Number]"]=c[o]=c["[object RegExp]"]=c[i]=c["[object String]"]=c["[object WeakMap]"]=!1;var u="object"==typeof global&&global&&global.Object===Object&&global,l="object"==typeof self&&self&&self.Object===Object&&self,d=u||l||Function("return this")(),p=t&&!t.nodeType&&t,h=p&&"object"==typeof e&&e&&!e.nodeType&&e,m=h&&h.exports===p,y=m&&u.process,g=function(){try{return y&&y.binding&&y.binding("util")}catch(e){}}(),_=g&&g.isTypedArray;function arraySome(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function mapToArray(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function setToArray(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var v,E=Array.prototype,I=Function.prototype,b=Object.prototype,S=d["__core-js_shared__"],C=I.toString,w=b.hasOwnProperty,A=(v=/[^.]+$/.exec(S&&S.keys&&S.keys.IE_PROTO||""))?"Symbol(src)_1."+v:"",O=b.toString,P=RegExp("^"+C.call(w).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),D=m?d.Buffer:void 0,x=d.Symbol,R=d.Uint8Array,N=b.propertyIsEnumerable,M=E.splice,L=x?x.toStringTag:void 0,j=Object.getOwnPropertySymbols,k=D?D.isBuffer:void 0,F=function overArg(e,t){return function(n){return e(t(n))}}(Object.keys,Object),U=getNative(d,"DataView"),V=getNative(d,"Map"),B=getNative(d,"Promise"),J=getNative(d,"Set"),$=getNative(d,"WeakMap"),G=getNative(Object,"create"),q=toSource(U),H=toSource(V),Y=toSource(B),K=toSource(J),z=toSource($),W=x?x.prototype:void 0,Q=W?W.valueOf:void 0;function Hash(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ListCache(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function MapCache(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function SetCache(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new MapCache;++t<n;)this.add(e[t])}function Stack(e){var t=this.__data__=new ListCache(e);this.size=t.size}function arrayLikeKeys(e,t){var n=te(e),r=!n&&ee(e),o=!n&&!r&&ne(e),i=!n&&!r&&!o&&re(e),s=n||r||o||i,a=s?function baseTimes(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],c=a.length;for(var u in e)!t&&!w.call(e,u)||s&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||isIndex(u,c))||a.push(u);return a}function assocIndexOf(e,t){for(var n=e.length;n--;)if(eq(e[n][0],t))return n;return-1}function baseGetTag(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":L&&L in Object(e)?function getRawTag(e){var t=w.call(e,L),n=e[L];try{e[L]=void 0;var r=!0}catch(e){}var o=O.call(e);r&&(t?e[L]=n:delete e[L]);return o}(e):function objectToString(e){return O.call(e)}(e)}function baseIsArguments(e){return isObjectLike(e)&&baseGetTag(e)==n}function baseIsEqual(e,t,s,a,c){return e===t||(null==e||null==t||!isObjectLike(e)&&!isObjectLike(t)?e!=e&&t!=t:function baseIsEqualDeep(e,t,s,a,c,u){var l=te(e),d=te(t),p=l?"[object Array]":Z(e),h=d?"[object Array]":Z(t),m=(p=p==n?o:p)==o,y=(h=h==n?o:h)==o,g=p==h;if(g&&ne(e)){if(!ne(t))return!1;l=!0,m=!1}if(g&&!m)return u||(u=new Stack),l||re(e)?equalArrays(e,t,s,a,c,u):function equalByTag(e,t,n,o,s,a,c){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new R(e),new R(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return eq(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case r:var u=mapToArray;case i:var l=1&o;if(u||(u=setToArray),e.size!=t.size&&!l)return!1;var d=c.get(e);if(d)return d==t;o|=2,c.set(e,t);var p=equalArrays(u(e),u(t),o,s,a,c);return c.delete(e),p;case"[object Symbol]":if(Q)return Q.call(e)==Q.call(t)}return!1}(e,t,p,s,a,c,u);if(!(1&s)){var _=m&&w.call(e,"__wrapped__"),v=y&&w.call(t,"__wrapped__");if(_||v){var E=_?e.value():e,I=v?t.value():t;return u||(u=new Stack),c(E,I,s,a,u)}}if(!g)return!1;return u||(u=new Stack),function equalObjects(e,t,n,r,o,i){var s=1&n,a=getAllKeys(e),c=a.length,u=getAllKeys(t).length;if(c!=u&&!s)return!1;var l=c;for(;l--;){var d=a[l];if(!(s?d in t:w.call(t,d)))return!1}var p=i.get(e);if(p&&i.get(t))return p==t;var h=!0;i.set(e,t),i.set(t,e);var m=s;for(;++l<c;){d=a[l];var y=e[d],g=t[d];if(r)var _=s?r(g,y,d,t,e,i):r(y,g,d,e,t,i);if(!(void 0===_?y===g||o(y,g,n,r,i):_)){h=!1;break}m||(m="constructor"==d)}if(h&&!m){var v=e.constructor,E=t.constructor;v==E||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof E&&E instanceof E||(h=!1)}return i.delete(e),i.delete(t),h}(e,t,s,a,c,u)}(e,t,s,a,baseIsEqual,c))}function baseIsNative(e){return!(!isObject(e)||function isMasked(e){return!!A&&A in e}(e))&&(isFunction(e)?P:s).test(toSource(e))}function baseKeys(e){if(!function isPrototype(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||b;return e===n}(e))return F(e);var t=[];for(var n in Object(e))w.call(e,n)&&"constructor"!=n&&t.push(n);return t}function equalArrays(e,t,n,r,o,i){var s=1&n,a=e.length,c=t.length;if(a!=c&&!(s&&c>a))return!1;var u=i.get(e);if(u&&i.get(t))return u==t;var l=-1,d=!0,p=2&n?new SetCache:void 0;for(i.set(e,t),i.set(t,e);++l<a;){var h=e[l],m=t[l];if(r)var y=s?r(m,h,l,t,e,i):r(h,m,l,e,t,i);if(void 0!==y){if(y)continue;d=!1;break}if(p){if(!arraySome(t,(function(e,t){if(s=t,!p.has(s)&&(h===e||o(h,e,n,r,i)))return p.push(t);var s}))){d=!1;break}}else if(h!==m&&!o(h,m,n,r,i)){d=!1;break}}return i.delete(e),i.delete(t),d}function getAllKeys(e){return function baseGetAllKeys(e,t,n){var r=t(e);return te(e)?r:function arrayPush(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}(r,n(e))}(e,keys,X)}function getMapData(e,t){var n=e.__data__;return function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function getNative(e,t){var n=function getValue(e,t){return null==e?void 0:e[t]}(e,t);return baseIsNative(n)?n:void 0}Hash.prototype.clear=function hashClear(){this.__data__=G?G(null):{},this.size=0},Hash.prototype.delete=function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Hash.prototype.get=function hashGet(e){var t=this.__data__;if(G){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return w.call(t,e)?t[e]:void 0},Hash.prototype.has=function hashHas(e){var t=this.__data__;return G?void 0!==t[e]:w.call(t,e)},Hash.prototype.set=function hashSet(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=G&&void 0===t?"__lodash_hash_undefined__":t,this},ListCache.prototype.clear=function listCacheClear(){this.__data__=[],this.size=0},ListCache.prototype.delete=function listCacheDelete(e){var t=this.__data__,n=assocIndexOf(t,e);return!(n<0)&&(n==t.length-1?t.pop():M.call(t,n,1),--this.size,!0)},ListCache.prototype.get=function listCacheGet(e){var t=this.__data__,n=assocIndexOf(t,e);return n<0?void 0:t[n][1]},ListCache.prototype.has=function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1},ListCache.prototype.set=function listCacheSet(e,t){var n=this.__data__,r=assocIndexOf(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},MapCache.prototype.clear=function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(V||ListCache),string:new Hash}},MapCache.prototype.delete=function mapCacheDelete(e){var t=getMapData(this,e).delete(e);return this.size-=t?1:0,t},MapCache.prototype.get=function mapCacheGet(e){return getMapData(this,e).get(e)},MapCache.prototype.has=function mapCacheHas(e){return getMapData(this,e).has(e)},MapCache.prototype.set=function mapCacheSet(e,t){var n=getMapData(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},SetCache.prototype.add=SetCache.prototype.push=function setCacheAdd(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},SetCache.prototype.has=function setCacheHas(e){return this.__data__.has(e)},Stack.prototype.clear=function stackClear(){this.__data__=new ListCache,this.size=0},Stack.prototype.delete=function stackDelete(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Stack.prototype.get=function stackGet(e){return this.__data__.get(e)},Stack.prototype.has=function stackHas(e){return this.__data__.has(e)},Stack.prototype.set=function stackSet(e,t){var n=this.__data__;if(n instanceof ListCache){var r=n.__data__;if(!V||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new MapCache(r)}return n.set(e,t),this.size=n.size,this};var X=j?function(e){return null==e?[]:(e=Object(e),function arrayFilter(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var s=e[n];t(s,n,e)&&(i[o++]=s)}return i}(j(e),(function(t){return N.call(e,t)})))}:function stubArray(){return[]},Z=baseGetTag;function isIndex(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||a.test(e))&&e>-1&&e%1==0&&e<t}function toSource(e){if(null!=e){try{return C.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function eq(e,t){return e===t||e!=e&&t!=t}(U&&"[object DataView]"!=Z(new U(new ArrayBuffer(1)))||V&&Z(new V)!=r||B&&"[object Promise]"!=Z(B.resolve())||J&&Z(new J)!=i||$&&"[object WeakMap]"!=Z(new $))&&(Z=function(e){var t=baseGetTag(e),n=t==o?e.constructor:void 0,s=n?toSource(n):"";if(s)switch(s){case q:return"[object DataView]";case H:return r;case Y:return"[object Promise]";case K:return i;case z:return"[object WeakMap]"}return t});var ee=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike(e)&&w.call(e,"callee")&&!N.call(e,"callee")},te=Array.isArray;var ne=k||function stubFalse(){return!1};function isFunction(e){if(!isObject(e))return!1;var t=baseGetTag(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function isObjectLike(e){return null!=e&&"object"==typeof e}var re=_?function baseUnary(e){return function(t){return e(t)}}(_):function baseIsTypedArray(e){return isObjectLike(e)&&isLength(e.length)&&!!c[baseGetTag(e)]};function keys(e){return function isArrayLike(e){return null!=e&&isLength(e.length)&&!isFunction(e)}(e)?arrayLikeKeys(e):baseKeys(e)}e.exports=function isEqual(e,t){return baseIsEqual(e,t)}}).call(this,n(34)(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1064);t.L7LiteJournals=r.L7LiteJournals;var o=n(402);t.L7LiteJournalInstance=o.L7LiteJournalInstance},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(386),i=n(30),s=n(2);t.L7LiteJournalInstance=class L7LiteJournalInstance{constructor(e,t){this.errorMessage="Local journals are disabled in lite mode.",this.journalSDK=e,this.id=t,this.type=i.JournalType.REMOTE}getId(){return this.id}getType(){return this.type}executeCommands(e){return r(this,void 0,void 0,(function*(){if(!e.length)return Promise.resolve([]);if(!o.isSerializableCommands(e))throw new s.InternalError("Attempting to execute commands that are not serializable.");return this.journalSDK.executeCommandBatch(this.id,e)}))}executeQuery(e,t,n){return r(this,void 0,void 0,(function*(){return this.journalSDK.executeQuery(this.id,{queryName:e,parameters:t},n)}))}getParent(){return r(this,void 0,void 0,(function*(){throw new s.InternalError(this.errorMessage)}))}setParent(e,t){return r(this,void 0,void 0,(function*(){throw new s.InternalError(this.errorMessage)}))}isolate(e){return r(this,void 0,void 0,(function*(){throw new s.InternalError(this.errorMessage)}))}sync(){return r(this,void 0,void 0,(function*(){throw new s.InternalError(this.errorMessage)}))}publish(){return r(this,void 0,void 0,(function*(){throw new s.InternalError(this.errorMessage)}))}publishOnly(){return r(this,void 0,void 0,(function*(){return this.publish()}))}rebase(){return r(this,void 0,void 0,(function*(){throw new s.InternalError(this.errorMessage)}))}rebaseOnly(){return r(this,void 0,void 0,(function*(){return this.rebase()}))}delete(){return r(this,void 0,void 0,(function*(){throw new s.InternalError(this.errorMessage)}))}setAutoSynchronizationMode(e){throw new s.InternalError(this.errorMessage)}setProperties(e){throw new s.InternalError(this.errorMessage)}getProperties(){return r(this,void 0,void 0,(function*(){throw new s.InternalError(this.errorMessage)}))}purgeCommandsForEntity(e){return r(this,void 0,void 0,(function*(){throw new s.InternalError(this.errorMessage)}))}dispose(){return r(this,void 0,void 0,(function*(){return this.journalSDK.dispose()}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(22);t.listSnapshotAssets=async function listSnapshotAssets(e){const t=await r.getAllPages(e.getAssets(),"getAssets");return t.length?t.map(e=>({id:e.getId(),revisionId:e.getRevisionId()})):[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class SchemaTypeBase{constructor(){this.typeid=""}}t.SchemaTypeBase=SchemaTypeBase;class Product_ComponentsProduct_V1_0_0 extends SchemaTypeBase{}t.Product_ComponentsProduct_V1_0_0=Product_ComponentsProduct_V1_0_0;class Product_ComponentsProduct_V1_0_1 extends SchemaTypeBase{}t.Product_ComponentsProduct_V1_0_1=Product_ComponentsProduct_V1_0_1;class Data_Asset_V1_0_0 extends SchemaTypeBase{}t.Data_Asset_V1_0_0=Data_Asset_V1_0_0,Data_Asset_V1_0_0.typeid="autodesk.data:asset-1.0.0";class Data_Component_V1_0_0 extends SchemaTypeBase{}t.Data_Component_V1_0_0=Data_Component_V1_0_0,Data_Component_V1_0_0.typeid="autodesk.data:component-1.0.0";class Data_Relationship_V1_0_0 extends SchemaTypeBase{}t.Data_Relationship_V1_0_0=Data_Relationship_V1_0_0,Data_Relationship_V1_0_0.typeid="autodesk.data:relationship-1.0.0";class Data_Snapshot_V1_0_0 extends SchemaTypeBase{}t.Data_Snapshot_V1_0_0=Data_Snapshot_V1_0_0,Data_Snapshot_V1_0_0.typeid="autodesk.data:snapshot-1.0.0";class Data_Space_V1_0_0 extends SchemaTypeBase{}t.Data_Space_V1_0_0=Data_Space_V1_0_0,Data_Space_V1_0_0.typeid="autodesk.data:space-1.0.0";class Product_ComponentsWIPReference_V0_0_1 extends SchemaTypeBase{constructor(){super(...arguments),this.default=!1,this.lineageURN="",this.targetComponent=""}}t.Product_ComponentsWIPReference_V0_0_1=Product_ComponentsWIPReference_V0_0_1,Product_ComponentsWIPReference_V0_0_1.typeid="autodesk.product:components.WIPReference-0.0.1";class Product_ComponentsCam_V1_0_0 extends SchemaTypeBase{}t.Product_ComponentsCam_V1_0_0=Product_ComponentsCam_V1_0_0,Product_ComponentsCam_V1_0_0.typeid="autodesk.product:components.cam-1.0.0";class Product_ComponentsDeleteStatus_V0_0_0 extends SchemaTypeBase{constructor(){super(...arguments),this.file=!1,this.modelComponent=!1}}t.Product_ComponentsDeleteStatus_V0_0_0=Product_ComponentsDeleteStatus_V0_0_0,Product_ComponentsDeleteStatus_V0_0_0.typeid="autodesk.product:components.deleteStatus-0.0.0";class Product_ComponentsDrawing_V1_0_0 extends SchemaTypeBase{}t.Product_ComponentsDrawing_V1_0_0=Product_ComponentsDrawing_V1_0_0,Product_ComponentsDrawing_V1_0_0.typeid="autodesk.product:components.drawing-1.0.0";class Product_ComponentsInternalComponent_V1_0_0 extends SchemaTypeBase{constructor(){super(...arguments),this.targetComponent=""}}t.Product_ComponentsInternalComponent_V1_0_0=Product_ComponentsInternalComponent_V1_0_0,Product_ComponentsInternalComponent_V1_0_0.typeid="autodesk.product:components.internalComponent-1.0.0";class Product_ComponentsItemNumber_V0_0_0 extends SchemaTypeBase{constructor(){super(...arguments),this.itemNumber=""}}t.Product_ComponentsItemNumber_V0_0_0=Product_ComponentsItemNumber_V0_0_0,Product_ComponentsItemNumber_V0_0_0.typeid="autodesk.product:components.itemNumber-0.0.0";class Product_ComponentsLifecycle_V0_0_0 extends SchemaTypeBase{constructor(){super(...arguments),this.URN="",this.descriptor="",this.revision="",this.lifecycle=""}}t.Product_ComponentsLifecycle_V0_0_0=Product_ComponentsLifecycle_V0_0_0,Product_ComponentsLifecycle_V0_0_0.typeid="autodesk.product:components.lifecycle-0.0.0";class Product_ComponentsPartNumber_V1_0_0 extends SchemaTypeBase{constructor(){super(...arguments),this.partNumber="",this.partName=""}}t.Product_ComponentsPartNumber_V1_0_0=Product_ComponentsPartNumber_V1_0_0,Product_ComponentsPartNumber_V1_0_0.typeid="autodesk.product:components.partNumber-1.0.0";class Product_ComponentsPhysicalProperties_V2_0_0 extends SchemaTypeBase{constructor(){super(...arguments),this.mass={value:0},this.material="",this.area={value:0},this.density={value:0},this.volume={value:0}}}t.Product_ComponentsPhysicalProperties_V2_0_0=Product_ComponentsPhysicalProperties_V2_0_0,Product_ComponentsPhysicalProperties_V2_0_0.typeid="autodesk.product:components.physicalProperties-2.0.0";class Product_ComponentsPhysicalProperties_V3_0_0 extends SchemaTypeBase{constructor(){super(...arguments),this.mass={value:0},this.material="",this.area={value:0},this.density={value:0},this.volume={value:0}}}t.Product_ComponentsPhysicalProperties_V3_0_0=Product_ComponentsPhysicalProperties_V3_0_0,Product_ComponentsPhysicalProperties_V3_0_0.typeid="autodesk.product:components.physicalProperties-3.0.0";class Math_Matrix44f_V1_0_0 extends SchemaTypeBase{constructor(){super(...arguments),this.elements=[]}}t.Math_Matrix44f_V1_0_0=Math_Matrix44f_V1_0_0,Math_Matrix44f_V1_0_0.typeid="autodesk.math:matrix44f-1.0.0";class Product_Snapshot_V0_0_1 extends SchemaTypeBase{constructor(){super(...arguments),this.value=""}}t.Product_Snapshot_V0_0_1=Product_Snapshot_V0_0_1,Product_Snapshot_V0_0_1.typeid="autodesk.product:snapshot-0.0.1";class Unit_Dimension_V1_0_0 extends SchemaTypeBase{}t.Unit_Dimension_V1_0_0=Unit_Dimension_V1_0_0,Unit_Dimension_V1_0_0.typeid="autodesk.unit:dimension-1.0.0";class Unit_Factor_V1_0_0 extends SchemaTypeBase{constructor(){super(...arguments),this.factor=1}}t.Unit_Factor_V1_0_0=Unit_Factor_V1_0_0,Unit_Factor_V1_0_0.typeid="autodesk.unit:factor-1.0.0";class Range_Range_V1_0_0 extends SchemaTypeBase{}t.Range_Range_V1_0_0=Range_Range_V1_0_0,Range_Range_V1_0_0.typeid="autodesk.range:range-1.0.0";class Spec_Spec_V1_0_0 extends SchemaTypeBase{constructor(){super(...arguments),this.name=""}}t.Spec_Spec_V1_0_0=Spec_Spec_V1_0_0,Spec_Spec_V1_0_0.typeid="autodesk.spec:spec-1.0.0",function(e){e[e.Metric=0]="Metric",e[e.Imperial=1]="Imperial"}(t.Unit_System_V1_0_0||(t.Unit_System_V1_0_0={}));class Data_BinaryAsset_V1_0_0 extends Data_Asset_V1_0_0{}t.Data_BinaryAsset_V1_0_0=Data_BinaryAsset_V1_0_0,Data_BinaryAsset_V1_0_0.typeid="autodesk.data:binary.asset-1.0.0";class Product_AssetsDesign_V6_0_0 extends Data_Asset_V1_0_0{}t.Product_AssetsDesign_V6_0_0=Product_AssetsDesign_V6_0_0,Product_AssetsDesign_V6_0_0.typeid="autodesk.product:assets.design-6.0.0";class Product_AssetsDrawing_V3_0_0 extends Data_Asset_V1_0_0{}t.Product_AssetsDrawing_V3_0_0=Product_AssetsDrawing_V3_0_0,Product_AssetsDrawing_V3_0_0.typeid="autodesk.product:assets.drawing-3.0.0";class Product_AssetsItem_V1_0_0 extends Data_Asset_V1_0_0{}t.Product_AssetsItem_V1_0_0=Product_AssetsItem_V1_0_0,Product_AssetsItem_V1_0_0.typeid="autodesk.product:assets.item-1.0.0";class Product_AssetsLifecycle_V2_0_0 extends Data_Asset_V1_0_0{}t.Product_AssetsLifecycle_V2_0_0=Product_AssetsLifecycle_V2_0_0,Product_AssetsLifecycle_V2_0_0.typeid="autodesk.product:assets.lifecycle-2.0.0";class Product_AssetsMilestone_V2_0_0 extends Data_Asset_V1_0_0{}t.Product_AssetsMilestone_V2_0_0=Product_AssetsMilestone_V2_0_0,Product_AssetsMilestone_V2_0_0.typeid="autodesk.product:assets.milestone-2.0.0";class Product_AssetsModel_V2_0_0 extends Data_Asset_V1_0_0{}t.Product_AssetsModel_V2_0_0=Product_AssetsModel_V2_0_0,Product_AssetsModel_V2_0_0.typeid="autodesk.product:assets.model-2.0.0";class Product_AssetsRelease_V2_0_0 extends Data_Asset_V1_0_0{}t.Product_AssetsRelease_V2_0_0=Product_AssetsRelease_V2_0_0,Product_AssetsRelease_V2_0_0.typeid="autodesk.product:assets.release-2.0.0";class Product_AssetsSheets_V1_0_0 extends Data_Asset_V1_0_0{}t.Product_AssetsSheets_V1_0_0=Product_AssetsSheets_V1_0_0,Product_AssetsSheets_V1_0_0.typeid="autodesk.product:assets.sheets-1.0.0";class Product_ComponentsWIPReference_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.default=!1,this.lineageURN="",this.targetComponent=""}}t.Product_ComponentsWIPReference_V1_0_0=Product_ComponentsWIPReference_V1_0_0,Product_ComponentsWIPReference_V1_0_0.typeid="autodesk.product:components.WIPReference-1.0.0";class Product_ComponentsWIPReference_V2_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.default=!1,this.targetComponent=""}}t.Product_ComponentsWIPReference_V2_0_0=Product_ComponentsWIPReference_V2_0_0,Product_ComponentsWIPReference_V2_0_0.typeid="autodesk.product:components.WIPReference-2.0.0";class Data_ComponentsAceManageExtensionWorkspace_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.sectionId="",this.workspace="",this.workspaceId="",this.ecoWorkspace="",this.ecoWorkspaceId="",this.assetUrnFieldId="",this.itemNumberFieldId="",this.productUrnFieldId="",this.spaceCollectionId="",this.quickReleaseEndPoint="",this.rootFolderUrnFieldId=""}}t.Data_ComponentsAceManageExtensionWorkspace_V1_0_0=Data_ComponentsAceManageExtensionWorkspace_V1_0_0,Data_ComponentsAceManageExtensionWorkspace_V1_0_0.typeid="autodesk.data:components.aceManageExtensionWorkspace-1.0.0";class Data_ComponentsAceManageExtensionWorkspace_V2_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.sectionId="",this.workspace="",this.workspaceId="",this.ecoWorkspace="",this.ecoWorkspaceId="",this.assetUrnFieldId="",this.itemNumberFieldId="",this.productUrnFieldId="",this.spaceCollectionId="",this.quickReleaseEndPoint="",this.lineageUrnFieldId=""}}t.Data_ComponentsAceManageExtensionWorkspace_V2_0_0=Data_ComponentsAceManageExtensionWorkspace_V2_0_0,Data_ComponentsAceManageExtensionWorkspace_V2_0_0.typeid="autodesk.data:components.aceManageExtensionWorkspace-2.0.0";class Product_ComponentsCam_V2_0_0 extends Data_Component_V1_0_0{}t.Product_ComponentsCam_V2_0_0=Product_ComponentsCam_V2_0_0,Product_ComponentsCam_V2_0_0.typeid="autodesk.product:components.cam-2.0.0";class Product_ComponentsComponentInstance_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.index=0,this.name=""}}t.Product_ComponentsComponentInstance_V1_0_0=Product_ComponentsComponentInstance_V1_0_0,Product_ComponentsComponentInstance_V1_0_0.typeid="autodesk.product:components.componentInstance-1.0.0";class Product_ComponentsComponentInstance_V1_1_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.index=0,this.name="",this.entityId=""}}t.Product_ComponentsComponentInstance_V1_1_0=Product_ComponentsComponentInstance_V1_1_0,Product_ComponentsComponentInstance_V1_1_0.typeid="autodesk.product:components.componentInstance-1.1.0";class Product_ComponentsDeleteStatus_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.file=!1,this.modelComponent=!1}}t.Product_ComponentsDeleteStatus_V1_0_0=Product_ComponentsDeleteStatus_V1_0_0,Product_ComponentsDeleteStatus_V1_0_0.typeid="autodesk.product:components.deleteStatus-1.0.0";class Product_ComponentsDeleteStatus_V1_1_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.file=!1,this.modelComponent=!1,this.unsupported=!1}}t.Product_ComponentsDeleteStatus_V1_1_0=Product_ComponentsDeleteStatus_V1_1_0,Product_ComponentsDeleteStatus_V1_1_0.typeid="autodesk.product:components.deleteStatus-1.1.0";class Product_ComponentsDrawing_V2_0_0 extends Data_Component_V1_0_0{}t.Product_ComponentsDrawing_V2_0_0=Product_ComponentsDrawing_V2_0_0,Product_ComponentsDrawing_V2_0_0.typeid="autodesk.product:components.drawing-2.0.0";class Product_ComponentsEco_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.URN="",this.affectedBy=""}}t.Product_ComponentsEco_V1_0_0=Product_ComponentsEco_V1_0_0,Product_ComponentsEco_V1_0_0.typeid="autodesk.product:components.eco-1.0.0";class Product_ComponentsError_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.description="",this.error=!0}}t.Product_ComponentsError_V1_0_0=Product_ComponentsError_V1_0_0,Product_ComponentsError_V1_0_0.typeid="autodesk.product:components.error-1.0.0";class Product_ComponentsErrorStatus_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.source="",this.code="",this.message=""}}t.Product_ComponentsErrorStatus_V1_0_0=Product_ComponentsErrorStatus_V1_0_0,Product_ComponentsErrorStatus_V1_0_0.typeid="autodesk.product:components.errorStatus-1.0.0";class Product_ComponentsInternalComponent_V2_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.targetComponent=""}}t.Product_ComponentsInternalComponent_V2_0_0=Product_ComponentsInternalComponent_V2_0_0,Product_ComponentsInternalComponent_V2_0_0.typeid="autodesk.product:components.internalComponent-2.0.0";class Product_ComponentsInternalFlag_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.internalFlag=!0}}t.Product_ComponentsInternalFlag_V1_0_0=Product_ComponentsInternalFlag_V1_0_0,Product_ComponentsInternalFlag_V1_0_0.typeid="autodesk.product:components.internalFlag-1.0.0";class Product_ComponentsItemNumber_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.itemNumber=""}}t.Product_ComponentsItemNumber_V1_0_0=Product_ComponentsItemNumber_V1_0_0,Product_ComponentsItemNumber_V1_0_0.typeid="autodesk.product:components.itemNumber-1.0.0";class Product_ComponentsLifecycle_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.URN="",this.descriptor="",this.revision="",this.lifecycle=""}}t.Product_ComponentsLifecycle_V1_0_0=Product_ComponentsLifecycle_V1_0_0,Product_ComponentsLifecycle_V1_0_0.typeid="autodesk.product:components.lifecycle-1.0.0";class Product_ComponentsLifecycle_V1_1_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.URN="",this.descriptor="",this.revision="",this.lifecycle="",this.isLocked=!1,this.isWorking=!1}}t.Product_ComponentsLifecycle_V1_1_0=Product_ComponentsLifecycle_V1_1_0,Product_ComponentsLifecycle_V1_1_0.typeid="autodesk.product:components.lifecycle-1.1.0";class Product_ComponentsMaterial_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.name=""}}t.Product_ComponentsMaterial_V1_0_0=Product_ComponentsMaterial_V1_0_0,Product_ComponentsMaterial_V1_0_0.typeid="autodesk.product:components.material-1.0.0";class Product_ComponentsMilestone_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.wipVersionUrn="",this.name="",this.description="",this.category="",this.lastModifiedTime="",this.createTime="",this.lastModifiedUserId="",this.createUserId=""}}t.Product_ComponentsMilestone_V1_0_0=Product_ComponentsMilestone_V1_0_0,Product_ComponentsMilestone_V1_0_0.typeid="autodesk.product:components.milestone-1.0.0";class Product_ComponentsMilestone_V2_0_0 extends Data_Component_V1_0_0{}t.Product_ComponentsMilestone_V2_0_0=Product_ComponentsMilestone_V2_0_0,Product_ComponentsMilestone_V2_0_0.typeid="autodesk.product:components.milestone-2.0.0";class Product_ComponentsName_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.value=""}}t.Product_ComponentsName_V1_0_0=Product_ComponentsName_V1_0_0,Product_ComponentsName_V1_0_0.typeid="autodesk.product:components.name-1.0.0";class Product_ComponentsPartNumber_V2_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.partNumber="",this.partName=""}}t.Product_ComponentsPartNumber_V2_0_0=Product_ComponentsPartNumber_V2_0_0,Product_ComponentsPartNumber_V2_0_0.typeid="autodesk.product:components.partNumber-2.0.0";class Product_ComponentsPartNumber_V2_1_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.partNumber="",this.partName="",this.description=""}}t.Product_ComponentsPartNumber_V2_1_0=Product_ComponentsPartNumber_V2_1_0,Product_ComponentsPartNumber_V2_1_0.typeid="autodesk.product:components.partNumber-2.1.0";class Product_ComponentsPhysicalProperties_V4_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.mass={value:0},this.material="",this.area={value:0},this.density={value:0},this.volume={value:0}}}t.Product_ComponentsPhysicalProperties_V4_0_0=Product_ComponentsPhysicalProperties_V4_0_0,Product_ComponentsPhysicalProperties_V4_0_0.typeid="autodesk.product:components.physicalProperties-4.0.0";class Product_ComponentsPhysicalProperties_V5_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.mass={value:0},this.material="",this.area={value:0},this.density={value:0},this.volume={value:0}}}t.Product_ComponentsPhysicalProperties_V5_0_0=Product_ComponentsPhysicalProperties_V5_0_0,Product_ComponentsPhysicalProperties_V5_0_0.typeid="autodesk.product:components.physicalProperties-5.0.0";class Product_ComponentsProduct_V3_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.description="",this.title="",this.approvedBy="",this.approvedDate="",this.revision="",this.project="",this.stockNumber="",this.designer="",this.status="",this.mechanicalEngineer="",this.manufacturingEngineer="",this.manufacturer=""}}t.Product_ComponentsProduct_V3_0_0=Product_ComponentsProduct_V3_0_0,Product_ComponentsProduct_V3_0_0.typeid="autodesk.product:components.product-3.0.0";class Product_ComponentsRelease_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.isLocked=!1,this.releaseDate="",this.approvedBy="",this.approvers="",this.owner=""}}t.Product_ComponentsRelease_V1_0_0=Product_ComponentsRelease_V1_0_0,Product_ComponentsRelease_V1_0_0.typeid="autodesk.product:components.release-1.0.0";class Product_ComponentsRelease_V2_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.releaseDate="",this.approvedBy="",this.approvers="",this.owner=""}}t.Product_ComponentsRelease_V2_0_0=Product_ComponentsRelease_V2_0_0,Product_ComponentsRelease_V2_0_0.typeid="autodesk.product:components.release-2.0.0";class Product_ComponentsRevision_V1_0_0 extends Data_Component_V1_0_0{}t.Product_ComponentsRevision_V1_0_0=Product_ComponentsRevision_V1_0_0,Product_ComponentsRevision_V1_0_0.typeid="autodesk.product:components.revision-1.0.0";class Product_ComponentsSnapshot_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.name="",this.description="",this.lastModifiedTime="",this.createTime="",this.lastModifiedUserId="",this.createUserId=""}}t.Product_ComponentsSnapshot_V1_0_0=Product_ComponentsSnapshot_V1_0_0,Product_ComponentsSnapshot_V1_0_0.typeid="autodesk.product:components.snapshot-1.0.0";class Product_ComponentsVersion_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.version=!0}}t.Product_ComponentsVersion_V1_0_0=Product_ComponentsVersion_V1_0_0,Product_ComponentsVersion_V1_0_0.typeid="autodesk.product:components.version-1.0.0";class Product_RelationshipContains_V2_0_0 extends Data_Relationship_V1_0_0{}t.Product_RelationshipContains_V2_0_0=Product_RelationshipContains_V2_0_0,Product_RelationshipContains_V2_0_0.typeid="autodesk.product:relationship.contains-2.0.0";class Product_RelationshipUse_V1_0_0 extends Data_Relationship_V1_0_0{}t.Product_RelationshipUse_V1_0_0=Product_RelationshipUse_V1_0_0,Product_RelationshipUse_V1_0_0.typeid="autodesk.product:relationship.use-1.0.0";class Product_RelationshipXRef_V2_0_0 extends Data_Relationship_V1_0_0{}t.Product_RelationshipXRef_V2_0_0=Product_RelationshipXRef_V2_0_0,Product_RelationshipXRef_V2_0_0.typeid="autodesk.product:relationship.xRef-2.0.0";class Product_Snapshot_V1_0_0 extends Data_Snapshot_V1_0_0{}t.Product_Snapshot_V1_0_0=Product_Snapshot_V1_0_0,Product_Snapshot_V1_0_0.typeid="autodesk.product:snapshot-1.0.0";class Data_Assetgraph_V1_0_0 extends Data_Space_V1_0_0{}t.Data_Assetgraph_V1_0_0=Data_Assetgraph_V1_0_0,Data_Assetgraph_V1_0_0.typeid="autodesk.data:assetgraph-1.0.0";class Product_AssetsModel_V0_0_2 extends Data_Asset_V1_0_0{constructor(){super(...arguments),this.wipReference=new Product_ComponentsWIPReference_V0_0_1}}t.Product_AssetsModel_V0_0_2=Product_AssetsModel_V0_0_2,Product_AssetsModel_V0_0_2.typeid="autodesk.product:assets.model-0.0.2";class Product_AssetsDrawing_V1_0_0 extends Data_Asset_V1_0_0{constructor(){super(...arguments),this.drawing=new Product_ComponentsDrawing_V1_0_0}}t.Product_AssetsDrawing_V1_0_0=Product_AssetsDrawing_V1_0_0,Product_AssetsDrawing_V1_0_0.typeid="autodesk.product:assets.drawing-1.0.0";class Product_AssetsLifecycle_V0_0_2 extends Data_Asset_V1_0_0{constructor(){super(...arguments),this.lifecycle=new Product_ComponentsLifecycle_V0_0_0}}t.Product_AssetsLifecycle_V0_0_2=Product_AssetsLifecycle_V0_0_2,Product_AssetsLifecycle_V0_0_2.typeid="autodesk.product:assets.lifecycle-0.0.2";class Product_AssetsDesign_V2_0_1 extends Data_Asset_V1_0_0{constructor(){super(...arguments),this.physicalProperties=new Product_ComponentsPhysicalProperties_V2_0_0}}t.Product_AssetsDesign_V2_0_1=Product_AssetsDesign_V2_0_1,Product_AssetsDesign_V2_0_1.typeid="autodesk.product:assets.design-2.0.1";class Product_AssetsDesign_V3_0_0 extends Data_Asset_V1_0_0{constructor(){super(...arguments),this.physicalProperties=new Product_ComponentsPhysicalProperties_V3_0_0}}t.Product_AssetsDesign_V3_0_0=Product_AssetsDesign_V3_0_0,Product_AssetsDesign_V3_0_0.typeid="autodesk.product:assets.design-3.0.0";class Product_ComponentsTransformation_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.transformation=new Math_Matrix44f_V1_0_0}}t.Product_ComponentsTransformation_V1_0_0=Product_ComponentsTransformation_V1_0_0,Product_ComponentsTransformation_V1_0_0.typeid="autodesk.product:components.transformation-1.0.0";class UnitDimension_Mass_V1_0_0 extends Unit_Dimension_V1_0_0{}t.UnitDimension_Mass_V1_0_0=UnitDimension_Mass_V1_0_0,UnitDimension_Mass_V1_0_0.typeid="autodesk.unit.dimension:mass-1.0.0";class UnitDimension_Length_V1_0_0 extends Unit_Dimension_V1_0_0{}t.UnitDimension_Length_V1_0_0=UnitDimension_Length_V1_0_0,UnitDimension_Length_V1_0_0.typeid="autodesk.unit.dimension:length-1.0.0";class Unit_FactorDerived_V1_0_1 extends Unit_Factor_V1_0_0{constructor(){super(...arguments),this.parentFactors=new Map}}t.Unit_FactorDerived_V1_0_1=Unit_FactorDerived_V1_0_1,Unit_FactorDerived_V1_0_1.typeid="autodesk.unit:factor.derived-1.0.1";class UnitFactor_Ten_V1_0_0 extends Unit_Factor_V1_0_0{constructor(){super(...arguments),this.factor=10}}t.UnitFactor_Ten_V1_0_0=UnitFactor_Ten_V1_0_0,UnitFactor_Ten_V1_0_0.typeid="autodesk.unit.factor:ten-1.0.0";class Range_RangeFloat64_V1_0_0 extends Range_Range_V1_0_0{}t.Range_RangeFloat64_V1_0_0=Range_RangeFloat64_V1_0_0,Range_RangeFloat64_V1_0_0.typeid="autodesk.range:range.float64-1.0.0";class Unit_Unit_V1_0_0 extends SchemaTypeBase{constructor(){super(...arguments),this.name=""}}t.Unit_Unit_V1_0_0=Unit_Unit_V1_0_0,Unit_Unit_V1_0_0.typeid="autodesk.unit:unit-1.0.0";class Product_AssetsProduct_V1_0_1 extends Data_Asset_V1_0_0{constructor(){super(...arguments),this.product=new Product_ComponentsProduct_V1_0_0}}t.Product_AssetsProduct_V1_0_1=Product_AssetsProduct_V1_0_1,Product_AssetsProduct_V1_0_1.typeid="autodesk.product:assets.product-1.0.1";class Product_AssetsFile_V1_0_0 extends Data_BinaryAsset_V1_0_0{}t.Product_AssetsFile_V1_0_0=Product_AssetsFile_V1_0_0,Product_AssetsFile_V1_0_0.typeid="autodesk.product:assets.file-1.0.0";class Product_AssetsCam_V1_0_0 extends Product_AssetsItem_V1_0_0{constructor(){super(...arguments),this.cam=new Product_ComponentsCam_V1_0_0}}t.Product_AssetsCam_V1_0_0=Product_AssetsCam_V1_0_0,Product_AssetsCam_V1_0_0.typeid="autodesk.product:assets.cam-1.0.0";class Product_AssetsCam_V3_0_0 extends Product_AssetsItem_V1_0_0{}t.Product_AssetsCam_V3_0_0=Product_AssetsCam_V3_0_0,Product_AssetsCam_V3_0_0.typeid="autodesk.product:assets.cam-3.0.0";class Product_AssetsDocumentation_V1_0_0 extends Product_AssetsItem_V1_0_0{}t.Product_AssetsDocumentation_V1_0_0=Product_AssetsDocumentation_V1_0_0,Product_AssetsDocumentation_V1_0_0.typeid="autodesk.product:assets.documentation-1.0.0";class Product_AssetsProduct_V2_0_0 extends Product_AssetsItem_V1_0_0{constructor(){super(...arguments),this.product=new Product_ComponentsProduct_V1_0_1,this.partNumber=new Product_ComponentsPartNumber_V1_0_0}}t.Product_AssetsProduct_V2_0_0=Product_AssetsProduct_V2_0_0,Product_AssetsProduct_V2_0_0.typeid="autodesk.product:assets.product-2.0.0";class Product_AssetsProduct_V4_0_0 extends Product_AssetsItem_V1_0_0{}t.Product_AssetsProduct_V4_0_0=Product_AssetsProduct_V4_0_0,Product_AssetsProduct_V4_0_0.typeid="autodesk.product:assets.product-4.0.0";class Product_AssetsModel_V1_0_0 extends Data_Asset_V1_0_0{constructor(){super(...arguments),this.wipReference=new Product_ComponentsWIPReference_V1_0_0}}t.Product_AssetsModel_V1_0_0=Product_AssetsModel_V1_0_0,Product_AssetsModel_V1_0_0.typeid="autodesk.product:assets.model-1.0.0";class Data_ComponentsAceManageExtension_V1_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.appName="",this.appType="",this.appId="",this.designs=new Data_ComponentsAceManageExtensionWorkspace_V1_0_0,this.drawings=new Data_ComponentsAceManageExtensionWorkspace_V1_0_0}}t.Data_ComponentsAceManageExtension_V1_0_0=Data_ComponentsAceManageExtension_V1_0_0,Data_ComponentsAceManageExtension_V1_0_0.typeid="autodesk.data:components.aceManageExtension-1.0.0";class Data_ComponentsAceManageExtension_V2_0_0 extends Data_Component_V1_0_0{constructor(){super(...arguments),this.appName="",this.appType="",this.appId="",this.designs=new Data_ComponentsAceManageExtensionWorkspace_V2_0_0,this.drawings=new Data_ComponentsAceManageExtensionWorkspace_V2_0_0}}t.Data_ComponentsAceManageExtension_V2_0_0=Data_ComponentsAceManageExtension_V2_0_0,Data_ComponentsAceManageExtension_V2_0_0.typeid="autodesk.data:components.aceManageExtension-2.0.0";class Product_AssetsCam_V2_0_0 extends Product_AssetsItem_V1_0_0{constructor(){super(...arguments),this.cam=new Product_ComponentsCam_V2_0_0}}t.Product_AssetsCam_V2_0_0=Product_AssetsCam_V2_0_0,Product_AssetsCam_V2_0_0.typeid="autodesk.product:assets.cam-2.0.0";class Product_AssetsDrawing_V2_0_0 extends Data_Asset_V1_0_0{constructor(){super(...arguments),this.drawing=new Product_ComponentsDrawing_V2_0_0}}t.Product_AssetsDrawing_V2_0_0=Product_AssetsDrawing_V2_0_0,Product_AssetsDrawing_V2_0_0.typeid="autodesk.product:assets.drawing-2.0.0";class Product_AssetsLifecycle_V1_0_0 extends Data_Asset_V1_0_0{constructor(){super(...arguments),this.lifecycle=new Product_ComponentsLifecycle_V1_0_0}}t.Product_AssetsLifecycle_V1_0_0=Product_AssetsLifecycle_V1_0_0,Product_AssetsLifecycle_V1_0_0.typeid="autodesk.product:assets.lifecycle-1.0.0";class Product_AssetsLifecycle_V1_1_0 extends Data_Asset_V1_0_0{constructor(){super(...arguments),this.lifecycle=new Product_ComponentsLifecycle_V1_1_0}}t.Product_AssetsLifecycle_V1_1_0=Product_AssetsLifecycle_V1_1_0,Product_AssetsLifecycle_V1_1_0.typeid="autodesk.product:assets.lifecycle-1.1.0";class Product_AssetsMilestone_V1_0_0 extends Data_Asset_V1_0_0{constructor(){super(...arguments),this.milestone=new Product_ComponentsMilestone_V1_0_0}}t.Product_AssetsMilestone_V1_0_0=Product_AssetsMilestone_V1_0_0,Product_AssetsMilestone_V1_0_0.typeid="autodesk.product:assets.milestone-1.0.0";class Product_AssetsDesign_V4_0_0 extends Data_Asset_V1_0_0{constructor(){super(...arguments),this.physicalProperties=new Product_ComponentsPhysicalProperties_V4_0_0}}t.Product_AssetsDesign_V4_0_0=Product_AssetsDesign_V4_0_0,Product_AssetsDesign_V4_0_0.typeid="autodesk.product:assets.design-4.0.0";class Product_AssetsDesign_V5_0_0 extends Data_Asset_V1_0_0{constructor(){super(...arguments),this.physicalProperties=new Product_ComponentsPhysicalProperties_V5_0_0}}t.Product_AssetsDesign_V5_0_0=Product_AssetsDesign_V5_0_0,Product_AssetsDesign_V5_0_0.typeid="autodesk.product:assets.design-5.0.0";class Product_AssetsProduct_V3_0_0 extends Product_AssetsItem_V1_0_0{constructor(){super(...arguments),this.product=new Product_ComponentsProduct_V3_0_0,this.partNumber=new Product_ComponentsPartNumber_V2_0_0}}t.Product_AssetsProduct_V3_0_0=Product_AssetsProduct_V3_0_0,Product_AssetsProduct_V3_0_0.typeid="autodesk.product:assets.product-3.0.0";class Product_AssetsRelease_V1_0_0 extends Data_Asset_V1_0_0{constructor(){super(...arguments),this.lifecycle=new Product_ComponentsLifecycle_V1_0_0,this.release=new Product_ComponentsRelease_V1_0_0}}t.Product_AssetsRelease_V1_0_0=Product_AssetsRelease_V1_0_0,Product_AssetsRelease_V1_0_0.typeid="autodesk.product:assets.release-1.0.0";class Product_RelationshipAssemblyRef_V1_0_0 extends Product_RelationshipXRef_V2_0_0{constructor(){super(...arguments),this.componentInstance=new Product_ComponentsComponentInstance_V1_0_0}}t.Product_RelationshipAssemblyRef_V1_0_0=Product_RelationshipAssemblyRef_V1_0_0,Product_RelationshipAssemblyRef_V1_0_0.typeid="autodesk.product:relationship.assemblyRef-1.0.0";class Product_RelationshipContained_V2_0_0 extends Product_RelationshipXRef_V2_0_0{}t.Product_RelationshipContained_V2_0_0=Product_RelationshipContained_V2_0_0,Product_RelationshipContained_V2_0_0.typeid="autodesk.product:relationship.contained-2.0.0";class Product_RelationshipDerived_V1_0_0 extends Product_RelationshipXRef_V2_0_0{}t.Product_RelationshipDerived_V1_0_0=Product_RelationshipDerived_V1_0_0,Product_RelationshipDerived_V1_0_0.typeid="autodesk.product:relationship.derived-1.0.0";class Product_RelationshipDescribes_V1_0_0 extends Product_RelationshipXRef_V2_0_0{}t.Product_RelationshipDescribes_V1_0_0=Product_RelationshipDescribes_V1_0_0,Product_RelationshipDescribes_V1_0_0.typeid="autodesk.product:relationship.describes-1.0.0";class Product_AssetgraphProcess_V1_0_0 extends Data_Assetgraph_V1_0_0{}t.Product_AssetgraphProcess_V1_0_0=Product_AssetgraphProcess_V1_0_0,Product_AssetgraphProcess_V1_0_0.typeid="autodesk.product:assetgraph.process-1.0.0";class UnitFactorPrefix_Centi_V1_0_0 extends Unit_FactorDerived_V1_0_1{constructor(){super(...arguments),this.parentFactors={UnitFactor_Ten_V1_0_0:-2}}}t.UnitFactorPrefix_Centi_V1_0_0=UnitFactorPrefix_Centi_V1_0_0,UnitFactorPrefix_Centi_V1_0_0.typeid="autodesk.unit.factor.prefix:centi-1.0.0";class Spec_SpecMeasurable_V1_0_0 extends Spec_Spec_V1_0_0{constructor(){super(...arguments),this.applicableUnits=[],this.storageUnit=new Unit_Unit_V1_0_0,this.range=new Range_RangeFloat64_V1_0_0}}t.Spec_SpecMeasurable_V1_0_0=Spec_SpecMeasurable_V1_0_0,Spec_SpecMeasurable_V1_0_0.typeid="autodesk.spec:spec.measurable-1.0.0";class Unit_UnitRelative_V1_0_0 extends Unit_Unit_V1_0_0{}t.Unit_UnitRelative_V1_0_0=Unit_UnitRelative_V1_0_0,Unit_UnitRelative_V1_0_0.typeid="autodesk.unit:unit.relative-1.0.0";class Unit_UnitDerived_V1_0_1 extends SchemaTypeBase{constructor(){super(...arguments),this.parentFactors={},this.parentUnits=new Map}}t.Unit_UnitDerived_V1_0_1=Unit_UnitDerived_V1_0_1,Unit_UnitDerived_V1_0_1.typeid="autodesk.unit:unit.derived-1.0.1";class Unit_UnitPrimitive_V1_0_0 extends Unit_UnitRelative_V1_0_0{}t.Unit_UnitPrimitive_V1_0_0=Unit_UnitPrimitive_V1_0_0,Unit_UnitPrimitive_V1_0_0.typeid="autodesk.unit:unit.primitive-1.0.0";class UnitUnit_Centimeters_V1_0_1 extends Unit_UnitDerived_V1_0_1{constructor(){super(...arguments),this.name="Centimeters",this.unitSystem="Metric",this.parentFactors={UnitFactorPrefix_Centi_V1_0_1:1},this.parentUnits={UnitUnit_Meters_V1_0_0:1}}}t.UnitUnit_Centimeters_V1_0_1=UnitUnit_Centimeters_V1_0_1,UnitUnit_Centimeters_V1_0_1.typeid="autodesk.unit.unit:centimeters-1.0.1";class UnitUnit_CubicCentimeters_V1_0_1 extends Unit_UnitDerived_V1_0_1{constructor(){super(...arguments),this.name="Cubic centimeters",this.unitSystem="Metric",this.parentUnits={UnitUnit_Centimeters_V1_0_1:3}}}t.UnitUnit_CubicCentimeters_V1_0_1=UnitUnit_CubicCentimeters_V1_0_1,UnitUnit_CubicCentimeters_V1_0_1.typeid="autodesk.unit.unit:cubicCentimeters-1.0.1";class UnitUnit_SquareCentimeters_V1_0_1 extends Unit_UnitDerived_V1_0_1{constructor(){super(...arguments),this.name="Square centimeters",this.unitSystem="Metric",this.parentUnits={UnitUnit_Centimeters_V1_0_1:2}}}t.UnitUnit_SquareCentimeters_V1_0_1=UnitUnit_SquareCentimeters_V1_0_1,UnitUnit_SquareCentimeters_V1_0_1.typeid="autodesk.unit.unit:squareCentimeters-1.0.1";class UnitUnit_KilogramsPerCubicCentimeter_V1_0_0 extends Unit_UnitDerived_V1_0_1{constructor(){super(...arguments),this.name="Kilograms per cubic centimeter",this.unitSystem="Metric",this.parentUnits={UnitUnit_Kilograms_V1_0_0:1,UnitUnit_CubicCentimeters_V1_0_1:-1}}}t.UnitUnit_KilogramsPerCubicCentimeter_V1_0_0=UnitUnit_KilogramsPerCubicCentimeter_V1_0_0,UnitUnit_KilogramsPerCubicCentimeter_V1_0_0.typeid="autodesk.unit.unit:kilogramsPerCubicCentimeter-1.0.0";class Unit_UnitPrimitiveDimensional_V1_0_0 extends Unit_UnitPrimitive_V1_0_0{constructor(){super(...arguments),this.dimension=new Unit_Dimension_V1_0_0}}t.Unit_UnitPrimitiveDimensional_V1_0_0=Unit_UnitPrimitiveDimensional_V1_0_0,Unit_UnitPrimitiveDimensional_V1_0_0.typeid="autodesk.unit:unit.primitive.dimensional-1.0.0";class SpecProduct_Volume_V1_0_0 extends Spec_SpecMeasurable_V1_0_0{constructor(){super(...arguments),this.name="Volume",this.applicableUnits=[],this.storageUnit=new UnitUnit_CubicCentimeters_V1_0_1}}t.SpecProduct_Volume_V1_0_0=SpecProduct_Volume_V1_0_0,SpecProduct_Volume_V1_0_0.typeid="autodesk.spec.product:volume-1.0.0";class SpecProduct_Area_V1_0_0 extends Spec_SpecMeasurable_V1_0_0{constructor(){super(...arguments),this.name="Area",this.applicableUnits=[],this.storageUnit=new UnitUnit_SquareCentimeters_V1_0_1}}t.SpecProduct_Area_V1_0_0=SpecProduct_Area_V1_0_0,SpecProduct_Area_V1_0_0.typeid="autodesk.spec.product:area-1.0.0";class SpecProduct_Density_V1_0_0 extends Spec_SpecMeasurable_V1_0_0{constructor(){super(...arguments),this.name="Density",this.applicableUnits=[],this.storageUnit=new UnitUnit_KilogramsPerCubicCentimeter_V1_0_0}}t.SpecProduct_Density_V1_0_0=SpecProduct_Density_V1_0_0,SpecProduct_Density_V1_0_0.typeid="autodesk.spec.product:density-1.0.0";class UnitUnit_Kilograms_V1_0_0 extends Unit_UnitPrimitiveDimensional_V1_0_0{constructor(){super(...arguments),this.name="Kilograms",this.unitSystem="Metric",this.dimension=new UnitDimension_Mass_V1_0_0}}t.UnitUnit_Kilograms_V1_0_0=UnitUnit_Kilograms_V1_0_0,UnitUnit_Kilograms_V1_0_0.typeid="autodesk.unit.unit:kilograms-1.0.0";class UnitUnit_Meters_V1_0_0 extends Unit_UnitPrimitiveDimensional_V1_0_0{constructor(){super(...arguments),this.name="Meters",this.unitSystem="Metric",this.dimension=new UnitDimension_Length_V1_0_0}}t.UnitUnit_Meters_V1_0_0=UnitUnit_Meters_V1_0_0,UnitUnit_Meters_V1_0_0.typeid="autodesk.unit.unit:meters-1.0.0";class SpecProduct_Mass_V1_0_0 extends Spec_SpecMeasurable_V1_0_0{constructor(){super(...arguments),this.name="Mass",this.applicableUnits=[],this.storageUnit=new UnitUnit_Kilograms_V1_0_0}}t.SpecProduct_Mass_V1_0_0=SpecProduct_Mass_V1_0_0,SpecProduct_Mass_V1_0_0.typeid="autodesk.spec.product:mass-1.0.0";t.Data_Asset_latest=class Data_Asset_latest extends Data_Asset_V1_0_0{};t.Data_Assetgraph_latest=class Data_Assetgraph_latest extends Data_Assetgraph_V1_0_0{};t.Data_BinaryAsset_latest=class Data_BinaryAsset_latest extends Data_BinaryAsset_V1_0_0{};t.Data_Component_latest=class Data_Component_latest extends Data_Component_V1_0_0{};t.Data_Relationship_latest=class Data_Relationship_latest extends Data_Relationship_V1_0_0{};t.Data_Snapshot_latest=class Data_Snapshot_latest extends Data_Snapshot_V1_0_0{};t.Data_Space_latest=class Data_Space_latest extends Data_Space_V1_0_0{};t.Product_AssetgraphProcess_latest=class Product_AssetgraphProcess_latest extends Product_AssetgraphProcess_V1_0_0{};t.Product_AssetsCam_latest=class Product_AssetsCam_latest extends Product_AssetsCam_V3_0_0{};t.Product_AssetsDesign_latest=class Product_AssetsDesign_latest extends Product_AssetsDesign_V6_0_0{};t.Product_AssetsDocumentation_latest=class Product_AssetsDocumentation_latest extends Product_AssetsDocumentation_V1_0_0{};t.Product_AssetsDrawing_latest=class Product_AssetsDrawing_latest extends Product_AssetsDrawing_V3_0_0{};t.Product_AssetsFile_latest=class Product_AssetsFile_latest extends Product_AssetsFile_V1_0_0{};t.Product_AssetsItem_latest=class Product_AssetsItem_latest extends Product_AssetsItem_V1_0_0{};t.Product_AssetsLifecycle_latest=class Product_AssetsLifecycle_latest extends Product_AssetsLifecycle_V2_0_0{};t.Product_AssetsMilestone_latest=class Product_AssetsMilestone_latest extends Product_AssetsMilestone_V2_0_0{};t.Product_AssetsModel_latest=class Product_AssetsModel_latest extends Product_AssetsModel_V2_0_0{};t.Product_AssetsProduct_latest=class Product_AssetsProduct_latest extends Product_AssetsProduct_V4_0_0{};t.Product_AssetsRelease_latest=class Product_AssetsRelease_latest extends Product_AssetsRelease_V2_0_0{};t.Product_AssetsSheets_latest=class Product_AssetsSheets_latest extends Product_AssetsSheets_V1_0_0{};t.Product_ComponentsWIPReference_latest=class Product_ComponentsWIPReference_latest extends Product_ComponentsWIPReference_V2_0_0{};t.Data_ComponentsAceManageExtension_latest=class Data_ComponentsAceManageExtension_latest extends Data_ComponentsAceManageExtension_V2_0_0{};t.Data_ComponentsAceManageExtensionWorkspace_latest=class Data_ComponentsAceManageExtensionWorkspace_latest extends Data_ComponentsAceManageExtensionWorkspace_V2_0_0{};t.Product_ComponentsCam_latest=class Product_ComponentsCam_latest extends Product_ComponentsCam_V2_0_0{};t.Product_ComponentsComponentInstance_latest=class Product_ComponentsComponentInstance_latest extends Product_ComponentsComponentInstance_V1_1_0{};t.Product_ComponentsDeleteStatus_latest=class Product_ComponentsDeleteStatus_latest extends Product_ComponentsDeleteStatus_V1_1_0{};t.Product_ComponentsDrawing_latest=class Product_ComponentsDrawing_latest extends Product_ComponentsDrawing_V2_0_0{};t.Product_ComponentsEco_latest=class Product_ComponentsEco_latest extends Product_ComponentsEco_V1_0_0{};t.Product_ComponentsError_latest=class Product_ComponentsError_latest extends Product_ComponentsError_V1_0_0{};t.Product_ComponentsErrorStatus_latest=class Product_ComponentsErrorStatus_latest extends Product_ComponentsErrorStatus_V1_0_0{};t.Product_ComponentsInternalComponent_latest=class Product_ComponentsInternalComponent_latest extends Product_ComponentsInternalComponent_V2_0_0{};t.Product_ComponentsInternalFlag_latest=class Product_ComponentsInternalFlag_latest extends Product_ComponentsInternalFlag_V1_0_0{};t.Product_ComponentsItemNumber_latest=class Product_ComponentsItemNumber_latest extends Product_ComponentsItemNumber_V1_0_0{};t.Product_ComponentsLifecycle_latest=class Product_ComponentsLifecycle_latest extends Product_ComponentsLifecycle_V1_1_0{};t.Product_ComponentsMaterial_latest=class Product_ComponentsMaterial_latest extends Product_ComponentsMaterial_V1_0_0{};t.Product_ComponentsMilestone_latest=class Product_ComponentsMilestone_latest extends Product_ComponentsMilestone_V2_0_0{};t.Product_ComponentsName_latest=class Product_ComponentsName_latest extends Product_ComponentsName_V1_0_0{};t.Product_ComponentsPartNumber_latest=class Product_ComponentsPartNumber_latest extends Product_ComponentsPartNumber_V2_1_0{};t.Product_ComponentsPhysicalProperties_latest=class Product_ComponentsPhysicalProperties_latest extends Product_ComponentsPhysicalProperties_V5_0_0{};t.Product_ComponentsProduct_latest=class Product_ComponentsProduct_latest extends Product_ComponentsProduct_V3_0_0{};t.Product_ComponentsRelease_latest=class Product_ComponentsRelease_latest extends Product_ComponentsRelease_V2_0_0{};t.Product_ComponentsRevision_latest=class Product_ComponentsRevision_latest extends Product_ComponentsRevision_V1_0_0{};t.Product_ComponentsSnapshot_latest=class Product_ComponentsSnapshot_latest extends Product_ComponentsSnapshot_V1_0_0{};t.Product_ComponentsTransformation_latest=class Product_ComponentsTransformation_latest extends Product_ComponentsTransformation_V1_0_0{};t.Product_ComponentsVersion_latest=class Product_ComponentsVersion_latest extends Product_ComponentsVersion_V1_0_0{};t.Math_Matrix44f_latest=class Math_Matrix44f_latest extends Math_Matrix44f_V1_0_0{};t.Product_RelationshipAssemblyRef_latest=class Product_RelationshipAssemblyRef_latest extends Product_RelationshipAssemblyRef_V1_0_0{};t.Product_RelationshipContained_latest=class Product_RelationshipContained_latest extends Product_RelationshipContained_V2_0_0{};t.Product_RelationshipContains_latest=class Product_RelationshipContains_latest extends Product_RelationshipContains_V2_0_0{};t.Product_RelationshipDerived_latest=class Product_RelationshipDerived_latest extends Product_RelationshipDerived_V1_0_0{};t.Product_RelationshipDescribes_latest=class Product_RelationshipDescribes_latest extends Product_RelationshipDescribes_V1_0_0{};t.Product_RelationshipUse_latest=class Product_RelationshipUse_latest extends Product_RelationshipUse_V1_0_0{};t.Product_RelationshipXRef_latest=class Product_RelationshipXRef_latest extends Product_RelationshipXRef_V2_0_0{};t.Product_Snapshot_latest=class Product_Snapshot_latest extends Product_Snapshot_V1_0_0{};t.UnitFactorPrefix_Centi_latest=class UnitFactorPrefix_Centi_latest extends UnitFactorPrefix_Centi_V1_0_0{};t.UnitUnit_Centimeters_latest=class UnitUnit_Centimeters_latest extends UnitUnit_Centimeters_V1_0_1{};t.UnitUnit_CubicCentimeters_latest=class UnitUnit_CubicCentimeters_latest extends UnitUnit_CubicCentimeters_V1_0_1{};t.Unit_Dimension_latest=class Unit_Dimension_latest extends Unit_Dimension_V1_0_0{};t.Unit_Factor_latest=class Unit_Factor_latest extends Unit_Factor_V1_0_0{};t.Unit_FactorDerived_latest=class Unit_FactorDerived_latest extends Unit_FactorDerived_V1_0_1{};t.UnitUnit_Kilograms_latest=class UnitUnit_Kilograms_latest extends UnitUnit_Kilograms_V1_0_0{};t.UnitDimension_Mass_latest=class UnitDimension_Mass_latest extends UnitDimension_Mass_V1_0_0{};t.UnitUnit_Meters_latest=class UnitUnit_Meters_latest extends UnitUnit_Meters_V1_0_0{};t.Range_Range_latest=class Range_Range_latest extends Range_Range_V1_0_0{};t.Range_RangeFloat64_latest=class Range_RangeFloat64_latest extends Range_RangeFloat64_V1_0_0{};t.SpecProduct_Area_latest=class SpecProduct_Area_latest extends SpecProduct_Area_V1_0_0{};t.SpecProduct_Density_latest=class SpecProduct_Density_latest extends SpecProduct_Density_V1_0_0{};t.UnitDimension_Length_latest=class UnitDimension_Length_latest extends UnitDimension_Length_V1_0_0{};t.SpecProduct_Mass_latest=class SpecProduct_Mass_latest extends SpecProduct_Mass_V1_0_0{};t.Spec_Spec_latest=class Spec_Spec_latest extends Spec_Spec_V1_0_0{};t.Spec_SpecMeasurable_latest=class Spec_SpecMeasurable_latest extends Spec_SpecMeasurable_V1_0_0{};t.SpecProduct_Volume_latest=class SpecProduct_Volume_latest extends SpecProduct_Volume_V1_0_0{};t.UnitUnit_SquareCentimeters_latest=class UnitUnit_SquareCentimeters_latest extends UnitUnit_SquareCentimeters_V1_0_1{};t.UnitFactor_Ten_latest=class UnitFactor_Ten_latest extends UnitFactor_Ten_V1_0_0{};t.Unit_Unit_latest=class Unit_Unit_latest extends Unit_Unit_V1_0_0{};t.Unit_UnitDerived_latest=class Unit_UnitDerived_latest extends Unit_UnitDerived_V1_0_1{};t.Unit_UnitPrimitive_latest=class Unit_UnitPrimitive_latest extends Unit_UnitPrimitive_V1_0_0{};t.Unit_UnitPrimitiveDimensional_latest=class Unit_UnitPrimitiveDimensional_latest extends Unit_UnitPrimitiveDimensional_V1_0_0{};t.Unit_UnitRelative_latest=class Unit_UnitRelative_latest extends Unit_UnitRelative_V1_0_0{};t.UnitUnit_KilogramsPerCubicCentimeter_latest=class UnitUnit_KilogramsPerCubicCentimeter_latest extends UnitUnit_KilogramsPerCubicCentimeter_V1_0_0{}},function(e){e.exports=JSON.parse('{"annotation":{"description":"A measurement unit quantifying a differential measurement."},"typeid":"autodesk.unit:unit.relative-1.0.0","inherits":["autodesk.unit:unit-1.0.0"]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"An independently defined magnitude quantifying a dimension of measurement."},"typeid":"autodesk.unit:unit.primitive.dimensional-1.0.0","inherits":["autodesk.unit:unit.primitive-1.0.0"],"constants":[{"id":"dimension","typeid":"autodesk.unit:dimension-1.0.0"}]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"An independently defined magnitude used as a standard of measurement."},"typeid":"autodesk.unit:unit.primitive-1.0.0","inherits":["autodesk.unit:unit.relative-1.0.0"]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"A measurement unit defined as a scaled product of powers of other units."},"typeid":"autodesk.unit:unit.derived-1.0.1","inherits":["autodesk.unit:unit.relative-1.0.0","autodesk.unit:factor.derived-1.0.1"],"constants":[{"id":"parentFactors","value":{}},{"id":"parentUnits","typeid":"Int32","context":"map","contextKeyType":"typeid","annotation":{"description":"Map associating typeid keys with integer exponents, representing a product of powers. Keys should be the typeids of templates inheriting from autodesk.unit:unit.relative-1.0.0."}}]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"A definite magnitude used as a standard of measurement.","doc":"http://docs.adskunits.apiary.io/#introduction/definitions/measurement-units"},"typeid":"autodesk.unit:unit-1.0.0","constants":[{"id":"name","typeid":"String"},{"id":"unitSystem","typeid":"autodesk.unit:system-1.0.0"}]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"Systems of measurement units."},"typeid":"autodesk.unit:system-1.0.0","inherits":["Enum"],"properties":[{"id":"Metric","value":0,"annotation":{"description":"Metric system of measurement units."}},{"id":"Imperial","value":1,"annotation":{"description":"US Imperial system of measurement units."}}]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"A scaling factor defined as a scaled product of powers of other factors."},"typeid":"autodesk.unit:factor.derived-1.0.1","inherits":["autodesk.unit:factor-1.0.0"],"constants":[{"id":"parentFactors","typeid":"Int32","context":"map","contextKeyType":"typeid","annotation":{"description":"Map associating typeid keys with integer exponents, representing a product of powers. Keys should be the typeids of templates inheriting from autodesk.unit:factor-1.0.0."}}]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"A dimensionless and unitless constant scaling factor used to define one magnitude in relation to another."},"typeid":"autodesk.unit:factor-1.0.0","constants":[{"id":"factor","typeid":"Float64","value":1}]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"An independent dimension of measurement which may be quantified by a base unit."},"typeid":"autodesk.unit:dimension-1.0.0"}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"Square centimeters."},"typeid":"autodesk.unit.unit:squareCentimeters-1.0.1","inherits":["autodesk.unit:unit.derived-1.0.1"],"constants":[{"id":"name","value":"Square centimeters"},{"id":"unitSystem","value":"Metric"},{"id":"parentUnits","value":{"autodesk.unit.unit:centimeters-1.0.1":2}}]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"Meters are the SI base unit of length."},"typeid":"autodesk.unit.unit:meters-1.0.0","inherits":["autodesk.unit:unit.primitive.dimensional-1.0.0"],"constants":[{"id":"name","value":"Meters"},{"id":"unitSystem","value":"Metric"},{"id":"dimension","typedValue":{"typeid":"autodesk.unit.dimension:length-1.0.0"}}]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"Kilograms per cubic centimeter."},"typeid":"autodesk.unit.unit:kilogramsPerCubicCentimeter-1.0.0","inherits":["autodesk.unit:unit.derived-1.0.1"],"constants":[{"id":"name","value":"Kilograms per cubic centimeter"},{"id":"unitSystem","value":"Metric"},{"id":"parentUnits","value":{"autodesk.unit.unit:kilograms-1.0.0":1,"autodesk.unit.unit:cubicCentimeters-1.0.1":-1}}]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"Kilograms are the SI base unit of mass."},"typeid":"autodesk.unit.unit:kilograms-1.0.0","inherits":["autodesk.unit:unit.primitive.dimensional-1.0.0"],"constants":[{"id":"name","value":"Kilograms"},{"id":"unitSystem","value":"Metric"},{"id":"dimension","typedValue":{"typeid":"autodesk.unit.dimension:mass-1.0.0"}}]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"Cubic centimeters."},"typeid":"autodesk.unit.unit:cubicCentimeters-1.0.1","inherits":["autodesk.unit:unit.derived-1.0.1"],"constants":[{"id":"name","value":"Cubic centimeters"},{"id":"unitSystem","value":"Metric"},{"id":"parentUnits","value":{"autodesk.unit.unit:centimeters-1.0.1":3}}]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"Centimeters."},"typeid":"autodesk.unit.unit:centimeters-1.0.1","inherits":["autodesk.unit:unit.derived-1.0.1"],"constants":[{"id":"name","value":"Centimeters"},{"id":"unitSystem","value":"Metric"},{"id":"parentFactors","value":{"autodesk.unit.factor.prefix:centi-1.0.1":1}},{"id":"parentUnits","value":{"autodesk.unit.unit:meters-1.0.0":1}}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.unit.factor:ten-1.0.0","inherits":["autodesk.unit:factor-1.0.0"],"constants":[{"id":"factor","value":10}]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"SI prefix centi-."},"typeid":"autodesk.unit.factor.prefix:centi-1.0.0","inherits":["autodesk.unit:factor.derived-1.0.1"],"constants":[{"id":"parentFactors","value":{"autodesk.unit.factor:ten-1.0.0":-2}}]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"The SI base quantity measurable in kilograms."},"typeid":"autodesk.unit.dimension:mass-1.0.0","inherits":["autodesk.unit:dimension-1.0.0"]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"The SI base quantity measurable in meters."},"typeid":"autodesk.unit.dimension:length-1.0.0","inherits":["autodesk.unit:dimension-1.0.0"]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"A base schema for defining data types that can be quantified by units of measurement."},"typeid":"autodesk.spec:spec.measurable-1.0.0","inherits":["autodesk.spec:spec-1.0.0"],"constants":[{"id":"applicableUnits","typeid":"autodesk.unit:unit-1.0.0","context":"array","typedValue":[],"annotation":{"description":"A set of units that are suitable for use with this data. E.g., for length measurements in a building model, feet and meters may be suitable but not light-years or Planck lengths."}},{"id":"storageUnit","typeid":"autodesk.unit:unit-1.0.0"},{"id":"range","typeid":"autodesk.range:range.float64-1.0.0","value":{}}]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"A base schema for defining data types with metadata for user-facing presentation."},"typeid":"autodesk.spec:spec-1.0.0","constants":[{"id":"name","typeid":"String"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.spec.product:volume-1.0.0","inherits":["autodesk.spec:spec.measurable-1.0.0"],"constants":[{"id":"name","value":"Volume"},{"id":"applicableUnits","typedValue":[{"typeid":"autodesk.unit.unit:cubicCentimeters-1.0.1"}]},{"id":"storageUnit","typedValue":{"typeid":"autodesk.unit.unit:cubicCentimeters-1.0.1"}}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.spec.product:mass-1.0.0","inherits":["autodesk.spec:spec.measurable-1.0.0"],"constants":[{"id":"name","value":"Mass"},{"id":"applicableUnits","typedValue":[{"typeid":"autodesk.unit.unit:kilograms-1.0.0"}]},{"id":"storageUnit","typedValue":{"typeid":"autodesk.unit.unit:kilograms-1.0.0"}}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.spec.product:density-1.0.0","inherits":["autodesk.spec:spec.measurable-1.0.0"],"constants":[{"id":"name","value":"Density"},{"id":"applicableUnits","typedValue":[{"typeid":"autodesk.unit.unit:kilogramsPerCubicCentimeter-1.0.0"}]},{"id":"storageUnit","typedValue":{"typeid":"autodesk.unit.unit:kilogramsPerCubicCentimeter-1.0.0"}}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.spec.product:area-1.0.0","inherits":["autodesk.spec:spec.measurable-1.0.0"],"constants":[{"id":"name","value":"Area"},{"id":"applicableUnits","typedValue":[{"typeid":"autodesk.unit.unit:squareCentimeters-1.0.1"}]},{"id":"storageUnit","typedValue":{"typeid":"autodesk.unit.unit:squareCentimeters-1.0.1"}}]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"A base schema for defining a range of Float64 values. If this schema is used directly, the range includes all Float64 values."},"typeid":"autodesk.range:range.float64-1.0.0","inherits":["autodesk.range:range-1.0.0"]}')},function(e){e.exports=JSON.parse('{"annotation":{"description":"A base schema for defining a range of values. If this schema is used directly, the range includes all values."},"typeid":"autodesk.range:range-1.0.0"}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:snapshot-1.0.0","annotation":{"description":"Base PIM snapshot type"},"inherits":["autodesk.data:snapshot-1.0.0"]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:relationship.xRef-2.0.0","inherits":["autodesk.data:relationship-1.0.0"]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:relationship.use-1.0.0","inherits":["autodesk.data:relationship-1.0.0"]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:relationship.describes-1.0.0","inherits":["autodesk.product:relationship.xRef-2.0.0"]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:relationship.derived-1.0.0","inherits":["autodesk.product:relationship.xRef-2.0.0"]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:relationship.contains-2.0.0","inherits":["autodesk.data:relationship-1.0.0"]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:relationship.contained-2.0.0","inherits":["autodesk.product:relationship.xRef-2.0.0"]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:relationship.assemblyRef-1.0.0","inherits":["autodesk.product:relationship.xRef-2.0.0"],"properties":[{"id":"componentInstance","typeid":"autodesk.product:components.componentInstance-1.0.0"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.WIPReference-2.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"default","typeid":"Bool","annotation":{"description":"Indicates if this the best default targetComponent to represent the Lineage as a whole"}},{"id":"targetComponent","typeid":"String","annotation":{"description":"a unique identifier for the target model-component"}}],"annotation":{"description":"Specialized component for data references of an asset."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.version-1.0.0","inherits":["autodesk.data:component-1.0.0"],"constants":[{"id":"version","typeid":"Bool","annotation":{"description":"This is a constant (always true) usually set on snapshots. The presence of this component indicates that the snapshot refers to a version snapshot, i.e. a snapshot generated when Fremont did a save operation."},"value":true}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.transformation-1.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"transformation","typeid":"autodesk.math:matrix44f-1.0.0","annotation":{"description":"The transformation of the subcomponent, represented by a 4x4 matrix including translation and rotation."}}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.snapshot-1.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"name","typeid":"String","annotation":{"description":"Name of the PIM milestone"}},{"id":"description","typeid":"String","annotation":{"description":"Description of the PIM milestone"}},{"id":"lastModifiedTime","typeid":"String","annotation":{"description":"Last modified time of the milestone in ISO 8601 format."}},{"id":"createTime","typeid":"String","annotation":{"description":"Creation time of the milestone in ISO 8601 format."}},{"id":"lastModifiedUserId","typeid":"String","annotation":{"description":"User id of the last modification of the milestone."}},{"id":"createUserId","typeid":"String","annotation":{"description":"User id of the creation of the milestone."}}],"annotation":{"description":"Specialized component storing the snapshot information."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.revision-1.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[],"annotation":{"description":"Specialized component storing the revision information for a corresponding WIP version."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.release-2.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"releaseDate","typeid":"String","annotation":{"description":"The date the asset was released"}},{"id":"approvedBy","typeid":"String","annotation":{"description":"The users that approved the asset\'s release"}},{"id":"approvers","typeid":"String","annotation":{"description":"The users that can approve the asset\'s release"}},{"id":"owner","typeid":"String","annotation":{"description":"The user that initiated the release of the asset"}}],"annotation":{"description":"Specialized component storing the release information for the engineering change order."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.product-3.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"description","typeid":"String"},{"id":"title","typeid":"String"},{"id":"approvedBy","typeid":"String"},{"id":"approvedDate","typeid":"String"},{"id":"revision","typeid":"String"},{"id":"project","typeid":"String"},{"id":"stockNumber","typeid":"String"},{"id":"designer","typeid":"String"},{"id":"status","typeid":"String"},{"id":"mechanicalEngineer","typeid":"String"},{"id":"manufacturingEngineer","typeid":"String"},{"id":"manufacturer","typeid":"String"}],"annotation":{"description":"Specialized component containing information to describe a product."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.physicalProperties-5.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"mass","properties":[{"id":"value","typeid":"Float64"}]},{"id":"material","typeid":"String"},{"id":"area","properties":[{"id":"value","typeid":"Float64"}]},{"id":"density","properties":[{"id":"value","typeid":"Float64"}]},{"id":"volume","properties":[{"id":"value","typeid":"Float64"}]}],"annotation":{"description":"Specialized component storing physical properties computed from a model."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.partNumber-2.1.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"partNumber","typeid":"String"},{"id":"partName","typeid":"String"},{"id":"description","typeid":"String"}],"annotation":{"description":"Specialized component containing information to describe a product\'s Part Number."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.name-1.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"value","typeid":"String","annotation":{"description":"This is a generic component, that can be used to add a user-defined name on any entity."}}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.milestone-2.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[],"annotation":{"description":"Specialized component storing the standard milestone information for a corresponding WIP version."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.material-1.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"name","typeid":"String"}],"annotation":{"description":"Material component contains information about the material physical property."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.lifecycle-1.1.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"URN","typeid":"String","annotation":{"description":"The urn for the FLC item"}},{"id":"descriptor","typeid":"String","annotation":{"description":"Descriptor for the FLC item"}},{"id":"revision","typeid":"String","annotation":{"description":"Revision for the FLC item"}},{"id":"lifecycle","typeid":"String","annotation":{"description":"Lifecycle for the FLC item"}},{"id":"isLocked","typeid":"Bool","annotation":{"description":"Whether the asset is now in a locked state, and is not editable"}},{"id":"isWorking","typeid":"Bool","annotation":{"description":"Whether the lifecycle asset is now in a working state"}}],"annotation":{"description":"Specialized component storing data for an FLC asset."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.itemNumber-1.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"itemNumber","typeid":"String","annotation":{"description":"The generated item number for the managed asset."}}],"annotation":{"description":"Specialized component storing the item number for the managed asset."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.internalFlag-1.0.0","inherits":["autodesk.data:component-1.0.0"],"constants":[{"id":"internalFlag","typeid":"Bool","annotation":{"description":"This is a constant (always true). The presence of this component indicates if the object referred to is in the same document as the parent."},"value":true}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.internalComponent-2.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"targetComponent","typeid":"String","annotation":{"description":"a unique identifier for the target model-component"}}],"annotation":{"description":"Specialized component storing a reference to the  model-component."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.errorStatus-1.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"source","typeid":"String","annotation":{"description":"Source of error"}},{"id":"code","typeid":"String","annotation":{"description":"Error code"}},{"id":"message","typeid":"String","annotation":{"description":"Error message information"}}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.error-1.0.0","inherits":["autodesk.data:component-1.0.0"],"constants":[{"id":"error","typeid":"Bool","annotation":{"description":"This is a constant (always true) usually set on snapshots. The presence of this component indicates that the snapshot refers to an error snapshot, i.e. a snapshot generated when Fremont did a save operation, but errors had previously occurred."},"value":true}],"properties":[{"id":"description","typeid":"String","annotation":{"description":"A simple description of the error that is associated to the snapshot"}}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.eco-1.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"URN","typeid":"String","annotation":{"description":"The urn for the FLC ECO item"}},{"id":"affectedBy","typeid":"String","annotation":{"description":"The generated number for the FLC ECO item"}}],"annotation":{"description":"Specialized component storing the engineering change order."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.drawing-2.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.deleteStatus-1.1.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"file","typeid":"Bool","annotation":{"description":"Indicates if the file associated with the asset is deleted"}},{"id":"modelComponent","typeid":"Bool","annotation":{"description":"Indicates if the model-component associated with the asset is deleted"}},{"id":"unsupported","typeid":"Bool","annotation":{"description":"Indicates if the model asset is unsupported"}}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.componentInstance-1.1.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"index","typeid":"Int32","annotation":{"description":"Identifies the component instance that the assembly reference refers to. This differentiates otherwise identical assembly references, and is unique per subcomponent."}},{"id":"name","typeid":"String","annotation":{"description":"The name of the subcomponent as used in the assembly."}},{"id":"entityId","typeid":"String","annotation":{"description":"The Fusion 360 API entity identifier"}}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.cam-2.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[]}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[],"typeid":"autodesk.product:assets.sheets-1.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[],"typeid":"autodesk.product:assets.release-2.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.product:assets.item-1.0.0"],"properties":[],"typeid":"autodesk.product:assets.product-4.0.0","annotation":{"description":"The product asset might have some optional components such as product and partNumber (currently autodesk.product:components.product-3.0.0 & autodesk.product:components.partNumber-2.0.0)."}}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[],"typeid":"autodesk.product:assets.model-2.0.0","annotation":{"description":"The model asset might have some optional components such as wipReference (currently autodesk.product:components.WIPReference-2.0.0)."}}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[],"typeid":"autodesk.product:assets.milestone-2.0.0","annotation":{"description":"The milestone asset might have some optional components such as milestone (currently autodesk.product:components.milestone-1.0.0)."}}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[],"typeid":"autodesk.product:assets.lifecycle-2.0.0","annotation":{"description":"The lifecycle asset might have some optional components such as lifecycle (currently autodesk.product:components.lifecycle-1.1.0)."}}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"typeid":"autodesk.product:assets.item-1.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:binary.asset-1.0.0"],"properties":[],"typeid":"autodesk.product:assets.file-1.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[],"typeid":"autodesk.product:assets.drawing-3.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.product:assets.item-1.0.0"],"properties":[],"typeid":"autodesk.product:assets.documentation-1.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[],"typeid":"autodesk.product:assets.design-6.0.0","annotation":{"description":"The design asset might have some optional components such as material (currently autodesk.product:components.material-1.0.0)."}}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.product:assets.item-1.0.0"],"properties":[],"typeid":"autodesk.product:assets.cam-3.0.0","annotation":{"description":"The item asset might have some optional components such as cam (currently autodesk.product:components.cam-2.0.0)."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:assetgraph.process-1.0.0","inherits":["autodesk.data:assetgraph-1.0.0"],"annotation":{"description":"The space for process information."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.math:matrix44f-1.0.0","properties":[{"id":"elements","typeid":"Float32","context":"array","length":16,"annotation":{"description":"The matrix elements in row-major order"}}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:space-1.0.0","annotation":{"description":"Forge Data\'s Base space, a top-level container for structured data."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:snapshot-1.0.0","annotation":{"description":"Forge Data\'s Snapshot, a container of assets."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:relationship-1.0.0","annotation":{"description":"Forge Data\'s Relationship, a link between two assets."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:components.aceManageExtensionWorkspace-2.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"sectionId","typeid":"String"},{"id":"workspace","typeid":"String"},{"id":"workspaceId","typeid":"String"},{"id":"ecoWorkspace","typeid":"String"},{"id":"ecoWorkspaceId","typeid":"String"},{"id":"assetUrnFieldId","typeid":"String"},{"id":"itemNumberFieldId","typeid":"String"},{"id":"productUrnFieldId","typeid":"String"},{"id":"spaceCollectionId","typeid":"String"},{"id":"quickReleaseEndPoint","typeid":"String"},{"id":"lineageUrnFieldId","typeid":"String"}],"annotation":{"description":"FLC workspace ACE data model."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:components.aceManageExtension-2.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"appName","typeid":"String"},{"id":"appType","typeid":"String"},{"id":"appId","typeid":"String"},{"id":"designs","typeid":"autodesk.data:components.aceManageExtensionWorkspace-2.0.0"},{"id":"drawings","typeid":"autodesk.data:components.aceManageExtensionWorkspace-2.0.0"}],"annotation":{"description":"FLC ACE data model."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:component-1.0.0","annotation":{"description":"Forge Data\'s base component"}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:binary.asset-1.0.0","inherits":["autodesk.data:asset-1.0.0"],"annotation":{"description":"Forge Data\'s Binary asset"}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:assetgraph-1.0.0","inherits":["autodesk.data:space-1.0.0"],"annotation":{"description":"Forge Data\'s Asset Graph, a graph-based space."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:asset-1.0.0","annotation":{"description":"Forge Data\'s Asset"}}')},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(69),o=n(89);function iterateSchemaInheritanceTree(e,t){const n=Array.isArray(e)?[...e]:[e],r=[];for(;n.length>0;){const e=n.shift();if(!r.includes(e)){if(t(e))return!0;const i=o.schemaManager.getSchema(e);i&&i.inherits&&n.push(...i.inherits),r.push(e)}}return!1}t.iterateSchemaInheritanceTree=iterateSchemaInheritanceTree,t.schemaInheritsFrom=function schemaInheritsFrom(e,t){return iterateSchemaInheritanceTree(e,e=>r.typeMatch(e,t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeKeys={WIP_VERSION_URN:"wipVersionUrn",DM_VERSION_ID:"dmVersionId",WIP_LINEAGE_URN:"wipLineageUrn",WIP_LINEAGE_URN_TMP:"wipLineageUrnTmp",INIT_STATUS:"initStatus",DM_LINEAGE_ID:"dmLineageId",SCHEMAS_VERSION:"schemasVersion",ADDITIONAL_CREATE_TIME:"additionalCreateTime",F3D_COMPONENT_ID:"f3dComponentId",NAME:"name",LOCAL_SNAPSHOT:"localSnapshot",ORIGIN:"origin",DRAWING_NAME:"drawingName",INCOMPLETE:"incomplete",ERROR_CODE:"errorCode",CREATE_STATUS:"createStatus"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(10),i=n(18),s=n(234),a=n(1),c=n(167),u=n(43),l=n(17),d=n(22),p=n(115),h=n(70),m=n(23),y=n(33),g=n(9),_=n(3),v=n(7),E=n(492);function _isFamilyType(e,t){const n=p.getFamilyFromTypeid(e);return!!n&&n.family===t}function isProduct(e){return _isFamilyType(e.getTypeId(),a.PIM_FAMILY.PRODUCT)}function isDesign(e){return _isFamilyType(e.getTypeId(),a.PIM_FAMILY.DESIGN)}function isContains(e){return _isFamilyType(e.getTypeId(),a.PIM_FAMILY.CONTAINS)}function isAssemblyRef(e){return _isFamilyType(e.getTypeId(),a.PIM_FAMILY.ASSEMBLY_REF)}function isModel(e){return _isFamilyType(e.getTypeId(),a.PIM_FAMILY.MODEL)}function productFromAsset(e){let t=e;for(;!isProduct(t.asset);){const e=t.incoming.filter(e=>isContains(e.relationship));t=e[0].fromAsset}return t}function designFromAsset(e){let t=e;for(;!isDesign(t.asset);){const e=t.incoming.filter(e=>isContains(e.relationship));t=e[0].fromAsset}return t}function getAssemblyRefsFromTopology(e,t){const n=[],r=[],o=t.root.snapshot?t.root.snapshot.id:"";return Object.values(t.visitedRelationships).forEach(t=>{if(!isAssemblyRef(t.relationship))return;const i=t.fromAssetSnapshot?t.fromAssetSnapshot.id:"";if(o!==i)return;E.isInternalAssemblyRef(e,t.relationship,[o])?n.push(t):r.push(t)}),{internalAssemblyRefs:n,externalAssemblyRefs:r}}function parentAsset(e){const t=e.incoming.filter(e=>y.getFamily(e.relationship)===a.PIM_FAMILY.CONTAINS);return 1===t.length?t[0].fromAsset:void 0}t.makeEmptyF3DStructure=()=>({component:{numberOfComponents:0,components:[],wipVersionUrn:"",instances:[],numberOfInstances:0},wip:{numberOfRelatedLineages:0,wipServerUrl:"",relatedLineages:[],numberOfVersions:0,relationships:{milestone:[],xref:[]},versions:[],numberOfRelationships:0,lineage:{},numberOfMilestones:0}}),t.getAssemblyRefsFromTopology=getAssemblyRefsFromTopology,t.buildF3DStructureFromTopology=function buildF3DStructureFromTopology(e,n){const r=[];let l;if(Object.values(n.visitedAssets).forEach(t=>{if(isModel(t.asset)&&!u.isSoftDeleted(t.asset))try{const i=productFromAsset(t),c=designFromAsset(t);if(e.pimGetSchemasVersion()===a.PIM_SCHEMAS_VERSIONS.VERSION_0_1_0){const u=e.pimGetComponentProxy(t.asset,o.ComponentKeys.WIP_REFERENCE,s.SchemasVersions[a.PIM_SCHEMAS_VERSIONS.VERSION_0_1_0][a.PIM_COMPONENT_FAMILY.WIP_REFERENCE]),d=e.pimGetComponentProxy(c.asset,o.ComponentKeys.PHYSICAL_PROPERTIES,s.SchemasVersions[a.PIM_SCHEMAS_VERSIONS.VERSION_0_1_0][a.PIM_COMPONENT_FAMILY.PHYSICAL_PROPERTIES]),p=e.pimGetComponentProxy(i.asset,o.ComponentKeys.PART_NUMBER,s.SchemasVersions[a.PIM_SCHEMAS_VERSIONS.VERSION_0_1_0][a.PIM_COMPONENT_FAMILY.PART_NUMBER]),h=i.asset.getId()===n.root.asset.getId();h&&(l=u.targetComponent),r.push({isRoot:h,componentId:u.targetComponent,product:i,design:c,model:t,description:i.asset.getAttribute(o.AttributeKeys.NAME)||"",partName:p.partName,partNumber:p.partNumber,material:d.material})}else{const u=e.pimGetComponentProxy(t.asset,o.ComponentKeys.WIP_REFERENCE,s.SchemasVersions[a.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0][a.PIM_COMPONENT_FAMILY.WIP_REFERENCE]),d=e.pimGetComponentProxy(c.asset,o.ComponentKeys.MATERIAL,s.SchemasVersions[a.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0][a.PIM_COMPONENT_FAMILY.MATERIAL]),p=e.pimGetComponentProxy(i.asset,o.ComponentKeys.PART_NUMBER,s.SchemasVersions[a.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0][a.PIM_COMPONENT_FAMILY.PART_NUMBER]),h=i.asset.getId()===n.root.asset.getId();h&&(l=u.targetComponent),r.push({isRoot:h,componentId:u.targetComponent,product:i,design:c,model:t,description:p.description,partName:p.partName,partNumber:p.partNumber,material:d.name})}}catch(e){throw console.warn("Error while getting wipReference:",e),e}}),void 0===l)throw new Error("rootComponentId could not be found");const{internalAssemblyRefs:d,externalAssemblyRefs:p}=getAssemblyRefsFromTopology(e,n),h=t.makeEmptyF3DStructure();h.component.components=[],r.forEach(e=>{_.get(e.product,["snapshot","id"],void 0)===_.get(n.root,["snapshot","id"],void 0)&&h.component.components.push({properties:[{propertyKey:"Part Name",value:e.partName},{propertyKey:"Part Number",value:e.partNumber},{propertyKey:"Description",value:e.description}],name:e.partName,massProperties:[{propertyKey:"material",value:e.material}],persistentId:e.componentId,isRootComponent:e.isRoot})});const findComponent=e=>r.find(t=>t.model.asset.getId()===e),m=new Set,y=i.getSchemaManager(e.pimGetSchemasVersion()),pushInstance=t=>n=>{const r=findComponent(n.fromAsset.asset.getId()),i=findComponent(n.toAsset.asset.getId());if(void 0!==r&&void 0!==i){let s=-1;try{s=e.pimGetComponentProxy(n.relationship,o.ComponentKeys.COMPONENT_INSTANCE,y.getFamilyType(a.PIM_COMPONENT_FAMILY.COMPONENT_INSTANCE)).index}catch(e){}h.component.instances.push({ToKind:t,SourceId:r.componentId,TargetId:i.componentId,LinkName:i.componentId,TargetName:i.partName,InstanceIndex:s,ToLocalFileVersion:-1}),t===c.ComponentInstanceType.EXTERNAL&&m.add(i.componentId)}};d.forEach(pushInstance(c.ComponentInstanceType.INTERNAL)),p.forEach(pushInstance(c.ComponentInstanceType.EXTERNAL)),h.component.numberOfInstances=h.component.instances.length,h.component.components=h.component.components.filter(e=>!m.has(e.persistentId)),h.component.numberOfComponents=h.component.components.length;const g=n.root.snapshot&&n.root.snapshot.snapshot;if(g){const e=g.getComponent(o.ComponentKeys.ERROR_STATUS);e&&(h.component.errorCode={id:e.get("code").value,description:e.get("message").value})}return h},t.getComponentAssets=function getComponentAssets(e,t,n){const r=i.getSchemaManager(e.pimGetSchemasVersion()),s=Object.values(t.visitedAssets).filter(t=>{const i=e.pimGetComponentProxy(t.asset,o.ComponentKeys.WIP_REFERENCE,r.getFamilyType(a.PIM_COMPONENT_FAMILY.WIP_REFERENCE));return!!i&&i.targetComponent===n});if(1!==s.length)throw new Error("Model asset not found (or found twice) for component "+n);const c=s[0],u=parentAsset(c);if(!u)throw new Error("Model asset has no parent");const l=parentAsset(u);if(!l)throw new Error("Design asset has no parent");return{product:l,design:u,model:c}};const getComponentId=(e,t,n)=>{if(e.pimGetSchemasVersion()===a.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0){const{targetComponent:r}=e.pimGetComponentProxy(t,"wipReference",n||a.schemaTypes.Product_ComponentsWIPReference_V2_0_0);return r}{const{targetComponent:r}=e.pimGetComponentProxy(t,"wipReference",n||a.schemaTypes.Product_ComponentsWIPReference_V1_0_0);return r}};async function diffAssetForSnapshots(e,t,n,r){const o=r.component.components.map(e=>e.persistentId),i=new Map,s=n.map(async t=>{if(await t.fetch(),isModel(t)){const n=getComponentId(e,t);i.set(n,[t])}});await Promise.all(s);const a=o.filter(e=>!Array.from(i.keys()).includes(e)),c=Array.from(i.keys()).filter(e=>!o.includes(e)),u=[],l=[];for(const n of Object.values(t)){const t=getComponentId(e,n.model);a.includes(t)&&l.push(n.product,n.design,n.model)}for(const t of n)if(isModel(t)){const n=getComponentId(e,t);c.includes(n)&&u.push(...i.get(n))}return{missingComponents:l,extraComponents:u}}async function restoreAndDeleteAsset(e,t,n,r){const o=Object.values(n).map(e=>e.product.isNewResource()?null:e.product.getId()),i=Object.values(r.visitedAssets).filter(e=>p.getFamilyFromTypeid(e.asset.getTypeId()).family===a.PIM_FAMILY.PRODUCT).map(e=>e.id);for(const n of i)o.includes(n)||await e.pimSoftDelete(t,r.visitedAssets[n].asset,{skipValidation:!0,skipCommit:!0});for(const n of o)n&&await e.pimRestore(t,r.visitedAssets[n].asset,{skipValidation:!0,skipCommit:!0})}async function createExternalAssemblyRef(e,t,n,r,i,s,a){let c;if(t=await g.toSpaceCollection(e,t),!a)throw new l.PimError(l.GEN_INVALID_INPUT,"toRootProductAndSnapshot is not defined: Cannot create an assemblyRef");if(c=await a(t,n),!c)throw new l.PimError(l.GEN_INVALID_INPUT,`Cannot create an external assemblyRef when no PIM data can be found for referenced design (componentIds ${n.SourceId} and ${n.TargetId})`);const u=c.rootProduct,d=c.snapshot;if(!u||!d)throw new l.PimError(l.GEN_INVALID_INPUT,`Cannot create an external assemblyRef that has missing PIM data (componentIds ${n.SourceId} and ${n.TargetId}, wipVersionUrn ${n.ToWipVersionUrn})`);const p=await e.pimGetModelFromProduct(t,u);if(!p)throw new l.PimError(l.GEN_INVALID_INPUT,`Could not find model assets to build assemblyRefs (componentIds ${n.SourceId} and ${n.TargetId})`);const m=e.pimGetComponentProxy(p,o.ComponentKeys.WIP_REFERENCE);if(m.targetComponent!==n.TargetId)throw new l.PimError(l.GEN_INVALID_INPUT,`Referenced target model does not match the TargetId (TargetId ${n.TargetId}, value on referenced model ${m.targetComponent})`);return e.pimCreateAssemblyRef(t,r,p,{fromModelSnapshot:i,toModelSnapshot:d,assemblyRef:h.getPimSchemaFactory(e.pimGetSchemasVersion()).getAssemblyRefPayload(n)},s)}t.diffAssetForSnapshots=diffAssetForSnapshots,t.restoreAndDeleteAsset=restoreAndDeleteAsset,t.updatePIMDataFromF3DStructure=async function updatePIMDataFromF3DStructure(e,t,n,o,i){const s=n.component.components.filter(e=>e.isRootComponent)[0];if(!s)throw new Error("No root component");if(void 0===o.lineageUrn&&void 0===o.projectUrn)throw new Error("At least either the lineage OR the project urn must be passed");const u=_.createTimeLogger("Save F3D data in journal");let p;if(u("Phase 1: Get existing data (product/snapshots"),o.rootProductId&&(p=await e.getAsset(o.rootProductId,t,{fetch:!0})),o.lineageUrn&&!p&&(p=await e.pimFindRootProduct(t,o.lineageUrn),!p))throw new Error("Can't find the root product for the lineage "+o.lineageUrn);const y=await g.toSpaceCollection(e,t,{fetch:!1});let E;if(o.localSnapshot&&(E=await e.getSnapshot(o.localSnapshot,t,{fetch:!0})),E&&!p&&(p=await e.pimGetRootProductFromSnapshot(t,E),!p))throw new Error("Can't find the root product in the local snapshot");p||console.info("Root product is not found in local data, creating a new one"),u("Phase 2: Capture existing document structure (closure query)");let I=void 0;p&&(I=await e.pimGetTopology(t,p,void 0,{fetch:!0,strategy:a.TopologyStrategies.CLOSUREV2})),u("Phase 3a: Create/Update assets");const b=[],S={},C=[],w=[];e.beginBatch();for(const i of n.component.components){const n=I?Object.values(I.visitedAssets).find(t=>!(!isModel(t.asset)||getComponentId(e,t.asset)!==i.persistentId)):void 0;let s;if(n){const t=designFromAsset(n);if(!t)throw new l.PimError(l.GEN_INVALID_INPUT,"Could not find design from model");const r=productFromAsset(t);if(!r)throw new l.PimError(l.GEN_INVALID_INPUT,"Could not find product from design");const a=h.getProductStructurePayload(e.pimGetSchemasVersion(),i,o.lineageUrn);m.populateEntity(r.asset,a.product),m.populateEntity(t.asset,a.design),m.populateEntity(n.asset,a.model),s={product:r.asset,design:t.asset,model:n.asset},C.push(s),S[i.persistentId]=s}else{const n=h.getProductStructurePayload(e.pimGetSchemasVersion(),i,o.lineageUrn),a=await e.pimCreateProductStructure(t,n,[{name:r.PermissionContextName.PIM_CONTEXT,type:r.PermissionContextType.WIP_URN,value:o.lineageUrn||o.projectUrn}],{skipCommit:!0,skipValidation:!0});s={product:a.product,design:a.design,model:a.model,created:!0},w.push(a.productSpace),C.push(s),S[i.persistentId]=s,i.isRootComponent&&(p=a.product)}}const A=S[s.persistentId].product;u("Phase 3b: Create parent/child CONTAINS relationships");for(const r of n.component.components){const n=S[r.persistentId];r!==s&&n.created&&await e.pimCreateChildProductRelationship(t,A,n.product,void 0,{skipCommit:!0,skipValidation:!0})}if(p&&!p.isNewResource()&&!A.isNewResource()&&A.getId()!==p.getId())throw new l.PimError(l.GEN_INVALID_INPUT,"New product root does not match the existing one for the design");I&&(u("Phase 4b: Restore/Soft Delete assets"),await restoreAndDeleteAsset(e,t,S,I));const O=h.getPimSchemaFactory(e.pimGetSchemasVersion()).getVersionSnapshotPayload({wipVersionUrn:o.localSnapshot,incompleteState:"local-journal",description:o.description});if(E){u("Phase 6: Update snapshot"),console.log("Snapshots found with attribute: ",`localSnapshot: { typeid: 'String', value: ${o.localSnapshot} }`);const t=E;m.populateEntity(t,O);const r=await d.getAllPages(t.getAssets(),"getAssets"),{extraComponents:i,missingComponents:s}=await diffAssetForSnapshots(e,S,r,n);s.length&&s.forEach(n=>{isModel(n)&&console.log(`Adding asset with Id: ${n.isNewResource()?"new asset":n.getId()} and componentId ${getComponentId(e,n)} to the snapshot`),t.addVersionedAssetWithEventualRevision(n)}),i.length&&i.forEach(n=>{isModel(n)&&console.log(`Removing asset with Id: ${n.getId()} and componentId ${getComponentId(e,n)} of the snapshot`),t.removeAsset(n)});const a=[...s,...i],c=Object.values(S).reduce((e,t)=>[...e,t.design,t.model,t.product],[]);for(const e of c)a.includes(e)||(t.removeAsset(e),t.addVersionedAssetWithEventualRevision(e))}else{u("Phase 6: Create snapshot");E=(await e.pimCreateSnapshot(t,b,O,void 0,!0)).snapshot;for(const e of C)E.addVersionedAssetWithEventualRevision(e.design),E.addVersionedAssetWithEventualRevision(e.product),E.addVersionedAssetWithEventualRevision(e.model)}u("Phase 7: Enumerate relationships from the snapshot");let P=[];E.isNewResource()||(P=await d.getAllPages(y.getRelationships({filter:{fromSnapshot:E.getId()}}),"getRelationships")),u("Phase 8: Delete / Create assemblyRef relationships");const D=P.filter(isAssemblyRef);if(await Promise.all(D.map(e=>e.delete())),Array.isArray(n.component.instances))for(const r of n.component.instances){if(!r.TargetId)throw new l.PimError(l.GEN_INVALID_INPUT,"No TargetID defined for instance "+r.LinkName);if(!S[r.SourceId])throw new l.PimError(l.GEN_INVALID_INPUT,`Could not find 'FROM' model asset for building assemblyRefs (componentId ${r.SourceId})`);const n=S[r.SourceId].model;if(!n)throw new l.PimError(l.GEN_INVALID_INPUT,`Could not find 'FROM' model asset for building assemblyRefs (componentId ${r.SourceId})`);if(r.ToKind===c.ComponentInstanceType.EXTERNAL){if(void 0!==r.AnycadKey)continue;await createExternalAssemblyRef(e,t,r,n,E,{skipCommit:!0,skipValidation:!0},i)}else{const o=S[r.TargetId].model;if(!o)throw new l.PimError(l.GEN_INVALID_INPUT,`Could not find model assets to build assemblyRefs (componentIds ${r.SourceId} and ${r.TargetId})`);await e.pimCreateAssemblyRef(t,n,o,{fromModelSnapshot:E,toModelSnapshot:E,assemblyRef:h.getPimSchemaFactory(e.pimGetSchemasVersion()).getAssemblyRefPayload(r)},{skipCommit:!0,skipValidation:!0})}}const x=await e.endBatch();v.validateBatchResult(x);const R=w.map(e=>e.getId());return u(),{snapshot:E,rootProductId:p.getId(),newSpaceIds:R}},t.createF3DMap=function createF3DMap(e){const propReducer=(e,t)=>Object.assign({[t.propertyKey]:t.value},e);return e.reduce((e,t)=>Object.assign({[`${t.persistentId}|${t.name}`]:{properties:t.properties.reduce(propReducer,{}),massProperties:t.massProperties.reduce(propReducer,{}),persistentId:t.persistentId,isRootComponent:t.isRootComponent,name:t.name}},e),{})},t.compareComponents=function compareComponents(e,t){const n={extraneous:{remote:[],local:[]},properties:{}};for(const r in e){const o=r.replace(/( v\d)$/,""),i=`${e[r].name} (${e[r].persistentId})`;if(console.info(`Comparing component: "${i}"...`),console.info("Checking if component exists in remote..."),Object.prototype.hasOwnProperty.call(t,o)){console.info("Checking if properties match...");for(const s of Object.values(c.Properties))e[r].properties[s]!==t[o].properties[s]&&(i in n.properties||(n.properties[i]={}),n.properties[i][s]={local:e[r].properties[s],remote:t[o].properties[s]});console.info("Checking if mass properties match...");for(const s of Object.values(c.MassProperties))e[r].massProperties[s]!==t[o].massProperties[s]&&(i in n.properties||(n.properties[i]={}),n.properties[i][s]={local:e[r].massProperties[s],remote:t[o].massProperties[s]});delete t[o]}else n.extraneous.local.push(e[r])}console.info("Checking for extraneous elements on remote side...");for(const e in t)n.extraneous.remote.push(t[e]);return n},t.compareInstances=function compareInstances(e,t){const n={remote:[],local:[]},r={},o={},i={},buildMap=e=>t=>{if(!t.SourceId||!t.TargetId||-1===t.InstanceIndex)throw new Error("Problem with instance data");const n=`${t.SourceId}|${t.TargetId}|${t.InstanceIndex}`;Object.prototype.hasOwnProperty.call(e,n)?++e[n]:e[n]=1,i[n]=t};e.forEach(buildMap(r)),t.forEach(buildMap(o)),console.info("Comparing instances...");for(const e in r){if(!(e in o))for(;r[e]>0;)n.local.push(i[e]),--r[e];for(;r[e]-o[e]>0;)n.local.push(i[e]),--r[e]}for(const e in o){if(!(e in r))for(;o[e]>0;)n.remote.push(i[e]),--o[e];for(;o[e]-r[e]>0;)n.remote.push(i[e]),--o[e]}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1),o=n(490),i=n(491);let s;function registerPimSchemaFactory(e,t){s[e]=t}t.getPimSchemaFactory=function getPimSchemaFactory(e){s||(s={},registerPimSchemaFactory(r.PIM_SCHEMAS_VERSIONS.VERSION_0_1_0,new o.PimSchemaFactory_0_1_0),registerPimSchemaFactory(r.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0,new i.PimSchemaFactory_1_0_0));const t=s[e];return t||s[r.PIM_DEFAULT_SCHEMAS_VERSION]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(43),o=n(10),i=n(18),s=n(1);t.PimSchemaFactory_0_1_0=class PimSchemaFactory_0_1_0{constructor(){this.schemaManager=i.getSchemaManager(s.PIM_SCHEMAS_VERSIONS.VERSION_0_1_0)}getProductPayload(e){const t=e.properties?e.properties.find(e=>"Part Number"===e.propertyKey):void 0,n=e.properties?e.properties.find(e=>"Part Name"===e.propertyKey):void 0,r=e.properties?e.properties.find(e=>"Description"===e.propertyKey):void 0;return{typeid:this.schemaManager.getFamilyTypeId(s.PIM_FAMILY.PRODUCT),components:{[o.ComponentKeys.PART_NUMBER]:{typeid:this.schemaManager.getFamilyTypeId(s.PIM_COMPONENT_FAMILY.PART_NUMBER),value:{partName:n?n.value:"",partNumber:t?t.value:""}},[o.ComponentKeys.PRODUCT]:{typeid:this.schemaManager.getFamilyTypeId(s.PIM_COMPONENT_FAMILY.PRODUCT),value:{description:r?r.value:""}}},attributes:{[o.AttributeKeys.NAME]:{typeid:"String",value:e.name}}}}getDesignPayload(e){const t=e.massProperties?e.massProperties.find(e=>"material"===e.propertyKey):void 0;return{typeid:this.schemaManager.getFamilyTypeId(s.PIM_FAMILY.DESIGN),components:{[o.ComponentKeys.PHYSICAL_PROPERTIES]:{typeid:this.schemaManager.getFamilyTypeId(s.PIM_COMPONENT_FAMILY.PHYSICAL_PROPERTIES),value:{mass:{value:0},material:t?t.value:"",area:{value:0},density:{value:0},volume:{value:0}}}}}}getModelPayload(e,t){const n=e.persistentId;return{typeid:this.schemaManager.getFamilyTypeId(s.PIM_FAMILY.MODEL),components:{[o.ComponentKeys.WIP_REFERENCE]:{typeid:this.schemaManager.getFamilyTypeId(s.PIM_COMPONENT_FAMILY.WIP_REFERENCE),value:{targetComponent:n,default:e.isRootComponent,lineageURN:t}}},attributes:{[o.AttributeKeys.WIP_LINEAGE_URN]:{typeid:"String",value:t}}}}getErrorModelPayload(e,t){return this.getModelPayload(e,t)}getAssemblyRefPayload(e){const t={typeid:this.schemaManager.getFamilyTypeId(s.PIM_FAMILY.ASSEMBLY_REF),components:{[o.ComponentKeys.COMPONENT_INSTANCE]:{typeid:this.schemaManager.getFamilyTypeId(s.PIM_COMPONENT_FAMILY.COMPONENT_INSTANCE),value:{index:e.InstanceIndex,name:e.TargetName}}}};return e.ToKind===s.ComponentInstanceType.INTERNAL&&t.components&&(t.components[o.ComponentKeys.INTERNAL_FLAG]={typeid:this.schemaManager.getFamilyTypeId(s.PIM_COMPONENT_FAMILY.INTERNAL_FLAG),value:{internalFlag:!0}}),t}getDocumentationPayload(){return{typeid:this.schemaManager.getFamilyTypeId(s.PIM_FAMILY.DOCUMENTATION)}}getDrawingPayload(e){const t=e.drawingName||"";return{typeid:this.schemaManager.getFamilyTypeId(s.PIM_FAMILY.DRAWING),attributes:{[o.AttributeKeys.DRAWING_NAME]:{typeid:"String",value:t}}}}getSheetsPayload(e){return e&&e.wip&&e.wip.lineageUrn?{typeid:this.schemaManager.getFamilyTypeId(s.PIM_FAMILY.SHEETS),attributes:{[o.AttributeKeys.WIP_LINEAGE_URN]:{typeid:"String",value:e.wip.lineageUrn},[o.AttributeKeys.DM_LINEAGE_ID]:{typeid:"String",value:e.wip.lineageUrn}}}:{typeid:this.schemaManager.getFamilyTypeId(s.PIM_FAMILY.SHEETS)}}getVersionSnapshotPayload(e){const t=(e=e||{}).versionSnapshot||{components:{},attributes:{}};let n;switch(t.attributes=t.attributes||{},t.components=t.components||{},t.attributes[o.AttributeKeys.NAME]={typeid:"String",value:"versionSnapshot"},e.wipVersionUrn&&(t.attributes[o.AttributeKeys.WIP_VERSION_URN]={typeid:"String",value:e.wipVersionUrn}),e.initStatus){case o.PIMEntityInitStatus.Pending:n=o.PIMEntityInitStatus.Pending;break;case o.PIMEntityInitStatus.Ready:case void 0:n=o.PIMEntityInitStatus.Ready;break;default:n=o.PIMEntityInitStatus.Unknown}return n&&(t.attributes[o.PIM_ENTITY_INIT_STATUS_KEY]={typeid:"String",value:n}),e.incompleteState?t.attributes[o.AttributeKeys.INCOMPLETE]={typeid:"String",value:e.incompleteState}:t.components.version={typeid:this.schemaManager.getFamilyTypeId(s.PIM_COMPONENT_FAMILY.VERSION),value:{}},e.snapshotComponentTypeid=this.schemaManager.getFamilyTypeId(s.PIM_COMPONENT_FAMILY.SNAPSHOT),t.components[o.ComponentKeys.SNAPSHOT]=r.snapshotComponent(e),t}getVersionSnapshotComponentMap(){return{version:{typeid:this.schemaManager.getFamilyTypeId(s.PIM_COMPONENT_FAMILY.VERSION),value:{}}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(10),o=n(18),i=n(1),s=n(43);t.PimSchemaFactory_1_0_0=class PimSchemaFactory_1_0_0{constructor(){this.schemaManager=o.getSchemaManager(i.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0)}getProductPayload(e){const t=e.properties?e.properties.find(e=>"Part Number"===e.propertyKey):void 0,n=e.properties?e.properties.find(e=>"Part Name"===e.propertyKey):void 0,o=e.properties?e.properties.find(e=>"Description"===e.propertyKey):void 0;return{typeid:this.schemaManager.getFamilyTypeId(i.PIM_FAMILY.PRODUCT),components:{[r.ComponentKeys.PART_NUMBER]:{typeid:this.schemaManager.getFamilyTypeId(i.PIM_COMPONENT_FAMILY.PART_NUMBER),value:{partName:n?n.value:"",partNumber:t?t.value:"",description:o?o.value:""}}}}}getDesignPayload(e){const t=e.massProperties?e.massProperties.find(e=>"material"===e.propertyKey):void 0;return{typeid:this.schemaManager.getFamilyTypeId(i.PIM_FAMILY.DESIGN),components:{[r.ComponentKeys.MATERIAL]:{typeid:this.schemaManager.getFamilyTypeId(i.PIM_COMPONENT_FAMILY.MATERIAL),value:{name:t?t.value:""}}}}}getModelPayload(e,t){const n=e.persistentId;return{typeid:this.schemaManager.getFamilyTypeId(i.PIM_FAMILY.MODEL),components:{[r.ComponentKeys.WIP_REFERENCE]:{typeid:this.schemaManager.getFamilyTypeId(i.PIM_COMPONENT_FAMILY.WIP_REFERENCE),value:{targetComponent:n,default:e.isRootComponent}}},attributes:{[r.AttributeKeys.WIP_LINEAGE_URN]:{typeid:"String",value:t},[r.AttributeKeys.DM_LINEAGE_ID]:{typeid:"String",value:t},[r.AttributeKeys.F3D_COMPONENT_ID]:{typeid:"String",value:e.persistentId}}}}getErrorModelPayload(e,t){const n=e.persistentId;return{typeid:this.schemaManager.getFamilyTypeId(i.PIM_FAMILY.MODEL),components:{[r.ComponentKeys.WIP_REFERENCE]:{typeid:this.schemaManager.getFamilyTypeId(i.PIM_COMPONENT_FAMILY.WIP_REFERENCE),value:{targetComponent:n,default:e.isRootComponent}},[r.ComponentKeys.DELETE_STATUS]:{typeid:this.schemaManager.getFamilyTypeId(i.PIM_COMPONENT_FAMILY.DELETE_STATUS),value:{unsupported:!0}}},attributes:{[r.AttributeKeys.WIP_LINEAGE_URN]:{typeid:"String",value:t},[r.AttributeKeys.DM_LINEAGE_ID]:{typeid:"String",value:t},[r.AttributeKeys.F3D_COMPONENT_ID]:{typeid:"String",value:e.persistentId}}}}getAssemblyRefPayload(e){const t={typeid:this.schemaManager.getFamilyTypeId(i.PIM_FAMILY.ASSEMBLY_REF),components:{[r.ComponentKeys.COMPONENT_INSTANCE]:{typeid:this.schemaManager.getFamilyTypeId(i.PIM_COMPONENT_FAMILY.COMPONENT_INSTANCE),value:{index:e.InstanceIndex,name:e.TargetName}}}};return e.ToKind===i.ComponentInstanceType.INTERNAL&&t.components&&(t.components[r.ComponentKeys.INTERNAL_FLAG]={typeid:this.schemaManager.getFamilyTypeId(i.PIM_COMPONENT_FAMILY.INTERNAL_FLAG),value:{internalFlag:!0}}),t}getDocumentationPayload(){return{typeid:this.schemaManager.getFamilyTypeId(i.PIM_FAMILY.DOCUMENTATION)}}getDrawingPayload(e){const t=e.drawingName||"";return{typeid:this.schemaManager.getFamilyTypeId(i.PIM_FAMILY.DRAWING),attributes:{[r.AttributeKeys.DRAWING_NAME]:{typeid:"String",value:t}}}}getSheetsPayload(e){return e&&e.wip&&e.wip.lineageUrn?{typeid:this.schemaManager.getFamilyTypeId(i.PIM_FAMILY.SHEETS),attributes:{[r.AttributeKeys.WIP_LINEAGE_URN]:{typeid:"String",value:e.wip.lineageUrn},[r.AttributeKeys.DM_LINEAGE_ID]:{typeid:"String",value:e.wip.lineageUrn}}}:{typeid:this.schemaManager.getFamilyTypeId(i.PIM_FAMILY.SHEETS)}}getVersionSnapshotPayload(e){const t=(e=e||{}).versionSnapshot||{components:{},attributes:{}};return t.attributes=t.attributes||{},t.components=t.components||{},t.attributes[r.AttributeKeys.NAME]={typeid:"String",value:"versionSnapshot"},e.wipVersionUrn&&(t.attributes[r.AttributeKeys.WIP_VERSION_URN]={typeid:"String",value:e.wipVersionUrn},t.attributes[r.AttributeKeys.DM_VERSION_ID]={typeid:"String",value:e.wipVersionUrn}),e.localSnapshot&&(t.attributes[r.AttributeKeys.LOCAL_SNAPSHOT]={typeid:"String",value:e.localSnapshot}),e.incompleteState?t.attributes[r.AttributeKeys.INCOMPLETE]={typeid:"String",value:e.incompleteState}:t.components.version={typeid:this.schemaManager.getFamilyTypeId(i.PIM_COMPONENT_FAMILY.VERSION),value:{}},e.snapshotComponentTypeid=this.schemaManager.getFamilyTypeId(i.PIM_COMPONENT_FAMILY.SNAPSHOT),t.components[r.ComponentKeys.SNAPSHOT]=s.snapshotComponent(e),t}getVersionSnapshotComponentMap(){return{version:{typeid:this.schemaManager.getFamilyTypeId(i.PIM_COMPONENT_FAMILY.VERSION),value:{}}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(10),i=n(1),s=n(18),a=n(115);t.getInternalFlagValue=(e,t)=>{const n=s.getSchemaManager(e.pimGetSchemasVersion()),r=e.pimGetComponentProxy(t,o.ComponentKeys.INTERNAL_FLAG,n.getFamilyType(i.PIM_COMPONENT_FAMILY.INTERNAL_FLAG));return r&&r.internalFlag};const getSnapshotId=e=>({fromSnapshotId:e.fromSnapshotId instanceof r.Snapshot?e.fromSnapshotId.getId():e.fromSnapshotId,toSnapshotId:e.toSnapshotId instanceof r.Snapshot?e.toSnapshotId.getId():e.toSnapshotId});t.isInternalAssemblyRef=(e,n,r)=>{if(o=n,a.getFamilyFromTypeid(o.getTypeId()).family!==i.PIM_FAMILY.ASSEMBLY_REF)return!1;var o;try{return t.getInternalFlagValue(e,n)}catch(e){const{fromSnapshotId:t,toSnapshotId:o}=getSnapshotId(n);if(!t||!o)return!1;const i=(r||[]).find(e=>e===t);return!!i&&(i===t&&i===o)}},t.isExternalAssemblyRef=(e,n,r)=>{if(o=n,a.getFamilyFromTypeid(o.getTypeId()).family!==i.PIM_FAMILY.ASSEMBLY_REF)return!1;var o;try{return!t.getInternalFlagValue(e,n)}catch(e){const{fromSnapshotId:t,toSnapshotId:o}=getSnapshotId(n);if(!t||!o)return!1;const i=(r||[]).find(e=>e===t);return!!i&&(i===t&&i!==o)}}},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(52)),__export(n(1139)),__export(n(1140))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(10),o=n(4);t.getSnapshotRecordCreateTime=e=>{const t=e.getAttribute(r.AttributeKeys.ADDITIONAL_CREATE_TIME);return t?new Date(t):new Date(0)},t.sortSnapshotByRecordCreateTime=e=>!e||e.length<2?e:e.sort((e,n)=>{let r=t.getSnapshotRecordCreateTime(e).getTime(),o=t.getSnapshotRecordCreateTime(n).getTime();return Math.sign(o-r)}),t.decideVersionSnapshotToUse=async(e,n)=>{if(!e||0===e.length)return;await Promise.all(e.map(async e=>{e&&!e.isFetched()&&await e.fetch()}));const i=e.filter(e=>e.getComponent("version"));if(i.length>1)throw new o.PimError(o.MULTI_VALID_VERSION_SNAPSHOTS);if(1===i.length)return i[0];if(n){const n=e.filter(e=>e.getAttribute(r.AttributeKeys.INCOMPLETE)===r.IncompleteState.CONTENT_READY);if(n.length>1)throw new o.PimError(o.MULTI_VALID_VERSION_SNAPSHOTS);if(1===n.length)return n[0];return t.sortSnapshotByRecordCreateTime(e)[0]}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(496)),i=r(n(1142));t.uuid=function(){return o.default()};const s={v4:/^(?:[a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12})|(?:0{8}-0{4}-0{4}-0{4}-0{12})$/u,v5:/^(?:[a-f0-9]{8}-[a-f0-9]{4}-5[a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12})|(?:0{8}-0{4}-0{4}-0{4}-0{12})$/u};t.regex=s;t.isUuid=function(e){return s.v4.test(e)||s.v5.test(e)};t.empty=function(){return"00000000-0000-0000-0000-000000000000"};t.fromString=function(e){return i.default(e,"bb5d0ffa-9a4c-4d7c-8fc2-0a7d2220ba45")}},function(e,t,n){var r=n(497),o=n(240);e.exports=function v4(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[i+a]=s[a];return t||o(s)}},function(e,t,n){var r=n(16);e.exports=function nodeRNG(){return r.randomBytes(16)}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.SINGLE="single",e.SNAPSHOT="snapshot"}(r=t.XrefBoundaries||(t.XrefBoundaries={})),t.defaultXrefOptions={boundaries:r.SINGLE}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1155),o=n(1156),i=n(1158),empty=()=>{},s=new o.TimeoutError;t.default=class PQueue extends r{constructor(e){var t,n,r,o;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=empty,this._resolveIdle=empty,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:i.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(n=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==n?n:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(o=null===(r=e.interval)||void 0===r?void 0:r.toString())&&void 0!==o?o:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=empty,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=empty,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((n,r)=>{this._queue.enqueue(async()=>{this._pendingCount++,this._intervalCount++;try{const i=void 0===this._timeout&&void 0===t.timeout?e():o.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&r(s)});n(await i)}catch(e){r(e)}this._next()},t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async e=>this.add(e,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise(e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise(e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(22);t.getTopoAssetId=function getTopoAssetId(e,t){return r.extractId(e)+(t?":"+r.extractId(t):"")},t.getTopoRelationshipId=function getTopoRelationshipId(e,t){return r.extractId(e)+(t?":"+r.extractId(t):"")},t.getTopoSnapshotId=function getTopoSnapshotId(e,t){return r.extractId(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1),i=n(22),s=n(69),a=n(9),c=n(7),u=n(239),l=n(502);async function findRootAsset(e,t,n,c=[o.PIM_FAMILY.PRODUCT,o.PIM_FAMILY.DOCUMENTATION],u=[o.PIM_SHEETS_ASSETS_TYPENAME,o.PIM_MODEL_ASSETS_TYPENAME]){let l;const d=await a.toSpaceCollection(e,t),p=await i.getAllPages(d.getAssets({filter:{"attribute.wipLineageUrn":n,"type.name":{$in:u}}}),"getAssets",1);if(!p||0===p.length)return void e._pimData.logger("Could not find the asset with wipLineageUrn: "+n);const h=p[0];if(h){h.isFetched()||await h.fetch();const t={startAssets:[{asset:h}],maxDepth:0,relationshipFilters:[{direction:"IN",type:{name:o.PIM_CONTAINS_RELATIONSHIP_TYPENAME}}]},n=(await e.getSpace("boby",d,{fetch:!1,assumeTypeId:r.assetGraphTypeId})).getClosureV2Traverser(t),assetVisitor=e=>{const t=s.getFamilyFromTypeid(e.asset.getTypeId()).family;if(c.includes(t)&&(l=e.asset,!l.spaceCollectionId))throw console.error("No space collection on asset"),new Error("NO SPACE COLLECTION");return Promise.resolve(r.TraversalAction.Continue)};await n.traverse(t.startAssets,assetVisitor,void 0,{direction:"IN"})}return l}async function findRootAssetAndVersionSnapshot(e,t,n,r=[o.PIM_FAMILY.PRODUCT,o.PIM_FAMILY.DOCUMENTATION],i=[o.PIM_SHEETS_ASSETS_TYPENAME,o.PIM_MODEL_ASSETS_TYPENAME]){t=await a.toSpaceCollection(e,t,{fetch:!1});const s=await u.getVersionSnapshot(e,t,n);if(!s)return;const c=s.fetch(),d=await l.findRootAssetBySnapshot(e,t,s,r,i);if(d)return await c,{rootAsset:d,snapshot:s};e._pimData&&e._pimData.logger("[findRootAssetAndVersionSnapshot]: Cannot find root asset")}c.failIfExistsOnSDK("pimFindRootItemAndVersionSnapshot"),c.failIfExistsOnSDK("pimFindRootItem"),t.findRootAsset=findRootAsset,t.findRootAssetAndVersionSnapshot=findRootAssetAndVersionSnapshot,r.FDModelingSDK.prototype.pimFindRootItem=async function(e,t){return await findRootAsset(this,e,t)},r.FDModelingSDK.prototype.pimGetVersionSnapshot=async function(e,t,n){return await u.getVersionSnapshot(this,e,t,n)},r.FDModelingSDK.prototype.pimFindRootItemAndVersionSnapshot=async function(e,t){const n=await findRootAssetAndVersionSnapshot(this,e,t);return n?{rootItem:n.rootAsset,snapshot:n.snapshot}:void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1),i=n(4);t.findRootAssetBySnapshot=async function findRootAssetBySnapshot(e,t,n,s=[o.PIM_FAMILY.PRODUCT,o.PIM_FAMILY.DOCUMENTATION],a=[o.PIM_SHEETS_ASSETS_TYPENAME,o.PIM_MODEL_ASSETS_TYPENAME]){if(t=await i.toSpaceCollection(e,t,{fetch:!1}),!(n=await i.toSnapshot(e,t,n,{fetch:!0})))return;let c=void 0;const u=await i.getAllPages(n.getAssets({filter:{"type.name":{$in:a}}}),"getAssets",1);if(0===u.length)throw new i.PimError(i.NOT_FOUND_ASSET);const l=await u[0].fetch();if(l){const a={startAssets:[{asset:l.getId(),snapshotContext:n.getId()}],maxDepth:0,relationshipFilters:[{direction:"IN",type:{name:o.PIM_CONTAINS_RELATIONSHIP_TYPENAME}}]},u=(await e.getSpace("bob",t,{fetch:!1,assumeTypeId:r.assetGraphTypeId})).getClosureV2Traverser(a),d=new Map,assetVisitor=e=>{const t=i.getFamilyFromTypeid(e.asset.getTypeId()).family,n=d.get(e.asset);return s.includes(t)&&!n&&(c=e.asset),Promise.resolve(r.TraversalAction.Continue)},relationshipVisitor=(e,t,n)=>(d.set(n.asset,t.asset),Promise.resolve(r.TraversalAction.Continue));await u.traverse(a.startAssets,void 0,relationshipVisitor,{direction:"IN"}),await u.traverse(a.startAssets,assetVisitor,void 0,{direction:"IN"})}return c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(4),o=n(10),i=n(32),s=n(22),a=n(238);t.completeModelAssets=async function completeModelAssets(e,t,n){const i=t.map(e=>({model:e.model,modelPayload:e.modelPayload}));e.beginBatch(),i.forEach(e=>{r.addAdditionalInfo([e.model],n),r.populateEntity(e.model,e.modelPayload),e.model.removeAttribute(o.AttributeKeys.WIP_LINEAGE_URN_TMP)});const s=await e.endBatch();r.validateBatchResult(s)},t.f3dComponentToPIM=async function f3dComponentToPIM(e,t,n,r,c,u,l,d){if(n.isRootComponent&&c)throw new Error("Incorrect input to convert f3d component to PIM!");if(!n.isRootComponent&&!c)throw new Error("Incorrect input to convert f3d component to PIM!");const{product:p,design:h,model:m}=a.getProductStructurePayload(e.pimGetSchemasVersion(),n,r),y=Object.assign({},m);d&&(delete m.components,delete m.attributes,m.attributes={[o.AttributeKeys.WIP_LINEAGE_URN_TMP]:{typeid:"String",value:r}});let g=[Object.assign(Object.assign({},i.DefaultPermissionContext),{value:r})];if(r.startsWith("urn:adsk.wipqa:")&&(g=void 0),n.isRootComponent){l&&(p.attributes=Object.assign(p.attributes||{},{createStatus:{typeid:"String",value:l}}));const n=await e.pimCreateProductStructure(t.getId(),{product:p,design:h,model:m},g,u);return{productSpace:n.productSpace,product:n.product,design:n.design,model:n.model,modelPayload:y}}const _=s.extractId(c),v=_||c,E=await e.pimCreateChildProductStructure(t.getId(),v,{product:p,design:h,model:m},g,u);return{productSpace:E.productSpace,product:E.product,design:E.design,model:E.model,modelPayload:y}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(3),o=n(167),i=n(503),s=n(505),a=n(3),c=n(4),u=n(32),l=n(10);async function createComponentsToPIMInBatch(e,t,n,r,o,s,a){const u={};let l=e.getNewInstanceExperimental();try{l.beginBatch();for(const e of n){const n=await i.f3dComponentToPIM(l,t,e,o,s.product,{skipValidation:!0,skipCommit:!0,additionalInfo:a},void 0,!0);if(!n)throw new Error("Unable to create child product "+e.persistentId);u[e.persistentId]=n}const e=await l.endBatch();c.validateBatchResult(e),await i.completeModelAssets(l,Object.values(u),a),Object.keys(u).forEach(e=>{r[e]=u[e]})}catch(e){const n=Object.keys(u);throw await c.purgeEntitiesOfF3DComponents(l,t,n),e}}async function createAllComponentsInOneBatch(e,t,n,r,a,u,d){const p=!u,{rootComponent:h,childComponents:m}=s.getF3dComponents(n,p),y={};try{let n;if(e.beginBatch(),!u){if(n=await i.f3dComponentToPIM(e,t,h,a,void 0,{skipValidation:!0,skipCommit:!0,additionalInfo:d},o.F3DComponentCreateStatus.UNDER_CONSTRUCTION,!0),!n)throw new Error("Unable to create root product");y[h.persistentId]=n}const s=u||n;for(const n of m){const r=await i.f3dComponentToPIM(e,t,n,a,s.product,{skipValidation:!0,skipCommit:!0,additionalInfo:d},void 0,!0);if(!r)throw new Error("Unable to create child product "+n.persistentId);y[n.persistentId]=r}const p=await e.endBatch();return c.validateBatchResult(p),await i.completeModelAssets(e,Object.values(y),d),d&&d.corruptDataTest?{}:(n&&(c.removeEntityAttribute(n.product,l.AttributeKeys.CREATE_STATUS),c.addAdditionalInfo([n.product],d),await n.product.save()),Object.keys(y).forEach(e=>{r[e]=y[e]}),s)}catch(n){const r=Object.keys(y);throw await c.purgeEntitiesOfF3DComponents(e,t,r),n}}t.createAllComponentsInOneBatch=createAllComponentsInOneBatch,t.f3dNewComponentsToPIM=async function f3dNewComponentsToPIM(e,t,n,d,p,h,m){const y=r.getLogger(e),g=!h,{rootComponent:_,childComponents:v}=s.getF3dComponents(n,g),E={};try{const s=n.length;let g,I=Math.floor(u.BATCH_LIMIT/u.MAX_COMMANDS_IN_ONE_COMPONENT);if(I<=0&&(I=1),s<=I)return await r.retry(async()=>await createAllComponentsInOneBatch(e,t,n,d,p,h,m),y);if(!h){if(g=await r.retry(async()=>await i.f3dComponentToPIM(e,t,_,p,void 0,{skipValidation:!0,skipCommit:!1,additionalInfo:m},o.F3DComponentCreateStatus.UNDER_CONSTRUCTION,!0),y),!g)throw new Error("Unable to create root product");E[_.persistentId]=g,await i.completeModelAssets(e,[g],m)}const b=h||g,S=e._pimData.connectOptions.maxCommandsInParallel?e._pimData.connectOptions.maxCommandsInParallel:u.DEFAULT_MAX_COMMANDS_IN_PARALLEL;let C=Math.floor(S/u.MAX_COMMANDS_IN_ONE_COMPONENT);C<=0&&(C=1);const w=a.chunk(v,C);for(const n of w){const o=a.chunk(n,I);await Promise.all(o.map(async n=>{await r.retry(()=>createComponentsToPIMInBatch(e,t,n,E,p,b,m),y)}))}return m&&m.corruptDataTest?{}:(g&&(c.removeEntityAttribute(g.product,l.AttributeKeys.CREATE_STATUS),c.addAdditionalInfo([b.product],m),await g.product.save()),Object.keys(E).forEach(e=>{d[e]=E[e]}),b)}catch(r){const o=Object.keys(E);await c.purgeEntitiesOfF3DComponents(e,t,o);const i=`Failed in f3dNewComponentsToPIM, componentNum: ${n.length}.`;throw new c.PimError(c.GEN_ERROR_COMMAND,i,r)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getF3dComponents=function getF3dComponents(e,t){if(!e)throw new Error("Could not find any component");const n=e.find(e=>e.isRootComponent);if(!n&&t)throw new Error("Could not find a root component");return{rootComponent:n,childComponents:e.filter(e=>!e.isRootComponent)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(4),o=n(70);t.f3dStructureToPIM=async function f3dStructureToPIM(e,t,n,i,s,a){try{if(!n.instances||!n.instances.length)return[];const r=[];for(const t of n.instances){if(t.LinkName)continue;if(!t.TargetId)continue;const n=i[t.SourceId].model,c=i[t.TargetId].model,u=o.getPimSchemaFactory(e.pimGetSchemasVersion()).getAssemblyRefPayload(t),l={fromModelId:n.getId(),toModelId:c.getId(),fromModelSnapshotId:s,toModelSnapshotId:s,assemblyRef:u,additionalInfo:a};r.push(l)}const{assemblyRefs:c}=await e.pimBatchCreateAssemblyRefs(t,r);return c}catch(e){const t="FAILED: Creating PIM data for f3d structure.";throw new r.PimError(r.GEN_ERROR_COMMAND,t,e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(508),o=n(505),i=n(4),s=n(27),a=n(18),c=n(1),u=n(10),l=n(3);t.f3dNewErrorComponentsToPIM=async function f3dNewErrorComponentsToPIM(e,t,n,d,p,h,m){const y=[];try{if(h){const{rootComponent:e}=o.getF3dComponents(n,!0),t=a.getSchemaManager(c.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0);if(t.getSchemasVersion()!==c.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0)throw new Error("error components is only supported in schenma version 1.0.0");const r=h.model,i=r.getComponent(u.ComponentKeys.DELETE_STATUS);if(i)i.setValues({unsupported:!0});else{r.createComponent(u.ComponentKeys.DELETE_STATUS,t.getFamilyTypeId(c.PIM_COMPONENT_FAMILY.DELETE_STATUS)).setValues({unsupported:!0})}return s.addAdditionalInfo([r],m),await r.save(),d[e.persistentId]=h,h}{const{rootComponent:i}=o.getF3dComponents(n,!0),s=await r.f3dErrorComponentToPIM(e,t,i,p,{skipValidation:!0,additionalInfo:m});if(!s)throw new Error("Unable to create root product");return y.push(s),d[i.persistentId]=s,s}}catch(t){await i.purgeEntities(y.map(e=>e.productSpace),l.getLogger(e));const n="Failed in f3dNewErrorComponentsToPIM.";throw new i.PimError(i.GEN_ERROR_COMMAND,n,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(32),o=n(238);t.f3dErrorComponentToPIM=async function f3dErrorComponentToPIM(e,t,n,i,s){if(!n.isRootComponent)throw new Error("Incorrect input to convert f3d component to PIM!");const{product:a,design:c,model:u}=o.getErrorProductStructurePayload(e.pimGetSchemasVersion(),n,i);let l=[Object.assign(Object.assign({},r.DefaultPermissionContext),{value:i})];i.startsWith("urn:adsk.wipqa:")&&(l=void 0);const d=await e.pimCreateProductStructure(t.getId(),{product:a,design:c,model:u},l,s);return{productSpace:d.productSpace,product:d.product,design:d.design,model:d.model}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(4),i=n(88),s=n(89),a=n(113),c=n(233),u=n(10),l=n(236),d=n(33);function isProduct(e){return s.schemaManager.getFamilyTypeIds(a.PIM_FAMILY.PRODUCT).includes(e.getTypeId())}function isDesign(e){return s.schemaManager.getFamilyTypeIds(a.PIM_FAMILY.DESIGN).includes(e.getTypeId())}function isContains(e){return s.schemaManager.getFamilyTypeIds(a.PIM_FAMILY.CONTAINS).includes(e.getTypeId())}function isModel(e){return s.schemaManager.getFamilyTypeIds(a.PIM_FAMILY.MODEL).includes(e.getTypeId())}async function getPimDataFromRootProduct(e,t,n){s.getSchemaManager(e.pimGetSchemasVersion()).registerSchemas();const o=await t.getSpace({fetch:!1,assumeTypeId:r.assetGraphTypeId}),i=[{asset:t}],a={startAssets:i,maxDepth:0,relationshipFilters:[{type:{name:c.PIM_CONTAINS_RELATIONSHIP_TYPENAME},direction:"OUT"}],include:{assetAttributes:!0,assetComponents:!0,relationshipAttributes:!0,relationshipComponents:!0}},l=o.getClosureV2Traverser(a),d={};await l.traverse(i,e=>{const t=e.asset,n=t.spaceId;return d[n]?d[n].push(t):d[n]=[t],Promise.resolve(r.TraversalAction.Continue)});const p={};let h=void 0;for(const n of Object.values(d)){let r=void 0,o=void 0,i=void 0;for(const e of n)isProduct(e)?r=e:isDesign(e)?o=e:isModel(e)&&(i=e);if(!r&&!o&&!i)continue;if(!r||!o||!i)throw new Error("Could not find product, design and model assets");const s={product:r,design:o,model:i};p[e.pimGetComponentProxy(i,u.ComponentKeys.WIP_REFERENCE).targetComponent]=s,r.getId()===t.getId()&&(h=s)}if(!h)throw new Error("Fail to get root product.");return{compAndProducts:p,rootProductStructure:h,latestVersionSnapshot:n}}t.getPimDataFromRootProduct=getPimDataFromRootProduct,t.getPimDataFromTopology=async function getPimDataFromTopology(e,t,n,r){const o=await e.pimGetTopology(t,n,void 0,{fetch:!0,strategy:i.TopologyStrategies.CLOSUREV2,type:i.TopologyTypes.AS_LATEST}),s={};let a=void 0;if(Object.values(o.visitedAssets).forEach(t=>{if(isModel(t.asset))try{const n=function productFromAsset(e){let t=e;for(;!isProduct(t.asset);){const e=t.incoming.filter(e=>isContains(e.relationship));t=e[0].fromAsset}return t}(t),r=function designFromAsset(e){let t=e;for(;!isDesign(t.asset);){const e=t.incoming.filter(e=>isContains(e.relationship));t=e[0].fromAsset}return t}(t),i={product:n.asset,design:r.asset,model:t.asset},c=e.pimGetComponentProxy(t.asset,u.ComponentKeys.WIP_REFERENCE).targetComponent;s[c]=i,n.asset.getId()===o.root.asset.getId()&&(a=i)}catch(e){console.warn("Error while getting wipReference:",e)}}),!a)throw new Error("Fail to get root product.");return{compAndProducts:s,rootProductStructure:a,latestVersionSnapshot:r}},t.getPimDataFromLineage=async function getPimDataFromLineage(e,t,n,r){try{const o=await e.pimGetLatestVersionSnapshot(t,n,r);if(!o)return;const i=await e.pimGetRootProductFromSnapshot(t,o);if(!i)throw new Error("Fail to find root product from snapshot: "+o.getId());return await getPimDataFromRootProduct(e,i,o)}catch(e){const t=`FAILED: Get PIM data from lineage, ${n}, ${e.message}`;throw new o.PimError(o.GEN_ERROR_COMMAND,t,e)}},t.getPimDataFromDrawingLineage=async function getPimDataFromDrawingLineage(e,t,n,i){try{const o=await e.pimGetLatestVersionSnapshot(t,n,i);if(!o)return;const s=await l.getSheetsFromLineage(e,t,n);if(!s||!s.length)return;const u=await s[0].getSpace({fetch:!1,assumeTypeId:r.assetGraphTypeId}),p=(await u.getClosureV2({startAssets:[{asset:s[0]}],maxDepth:2,relationshipFilters:[{direction:"IN",type:{name:c.PIM_CONTAINS_RELATIONSHIP_TYPENAME}}],include:{assetAttributes:!0,assetComponents:!0,relationshipAttributes:!1,relationshipComponents:!1}})).getAssets(),h=p.filter(e=>d.getFamily(e)===a.PIM_FAMILY.DRAWING),m=p.filter(e=>d.getFamily(e)===a.PIM_FAMILY.DOCUMENTATION),y=await s[0].getSpace();return{documentationStructure:{documentationSpace:y,documentation:m[0],drawing:h[0],sheets:s[0]},latestVersionSnapshot:o}}catch(e){const t=`FAILED: Get PIM data from lineage, ${n}, ${e.message}`;throw new o.PimError(o.GEN_ERROR_COMMAND,t,e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1184),o=n(4);t.needResolveConflicts=async function needResolveConflicts(e,t,n,i,s){const a=await o.toSpaceCollection(t,n,{fetch:!1}),c=await r.getLatestVersionSnapshot(t,a,s);let u=!1;const l=(await i.getProperties()).baseSnapshotId;return!c||l&&c.getId()===l||(u=!0),{needResolve:u,mainSnapshot:c}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(241),o=n(512),i=n(513);t.resolveConflicts=async function resolveConflicts(e,t,n,s){const a=await r.getConflictModelData(e,n,{advanceToLatest:!0});await o.resolveConflictsForProperties(e,s.properties,a.properties,a.spaceAndAssets);const c=await i.resolveNoCADComponents(e,s.modelsWithCad,a.modelsWithCad);return await(async(e,t)=>{t.deletedAssets.forEach(t=>{e.removeAsset(t)}),t.restoredAssets.forEach(t=>{e.removeAsset(t),e.addVersionedAsset(t,t.getRevisionId())}),await e.save()})(t,c),!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(4),o=n(1),i=n(242),s=n(3),a=n(27);function diffModelDataProperties(e,t){const n={};for(const r of Object.keys(e)){const o=t[r];if(!o)break;const i=e[r],s={};for(const e of Object.keys(i)){const t=o[e],n=i[e];n!==t&&(s[e]=n)}Object.keys(s).length>0&&(n[r]=s)}return n}function updatePropsToProductAsset(e,t,n){return e===o.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0?function updatePropsToProductAsset_V1_0_0(e,t){const n=t[i.PIMModelDataPropKey.partName],o=t[i.PIMModelDataPropKey.partNumber],s=t[i.PIMModelDataPropKey.description];if(void 0!==n||void 0!==o||null!=s){const t=r.getComponent(e,"partNumber");return null!=n&&(t.value.partName=n),null!=o&&(t.value.partNumber=o),null!=s&&(t.value.description=s),r.setComponent(e,"partNumber",t),!0}return!1}(t,n):function updatePropsToProductAsset_V0_1_0(e,t){const n=t[i.PIMModelDataPropKey.partName],o=t[i.PIMModelDataPropKey.partNumber],s=t[i.PIMModelDataPropKey.description];let a=!1;if(void 0!==n||void 0!==o){const t=r.getComponent(e,"partNumber");null!=n&&(t.value.partName=n),null!=o&&(t.value.partNumber=o),r.setComponent(e,"partNumber",t),a=!0}if(null!=s){const t=r.getComponent(e,"product");t.value.description=s,r.setComponent(e,"product",t),a=!0}return a}(t,n)}function updatePropsToDesignAsset(e,t,n){return e===o.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0?function updatePropsToDesignAsset_V1_0_0(e,t){const n=t[i.PIMModelDataPropKey.material];if(null!=n){const t=r.getComponent(e,"material");return t.value.name=n,r.setComponent(e,"material",t),!0}return!1}(t,n):function updatePropsToDesignAsset_V0_1_0(e,t){const n=t[i.PIMModelDataPropKey.material];if(null!=n){const t=r.getComponent(e,"physicalProperties");return t.value.material=n,r.setComponent(e,"physicalProperties",t),!0}return!1}(t,n)}function getProductStructureAssets(e){let t,n,i=void 0;for(const s of e){const e=r.getFamilyFromTypeid(s.getTypeId()).family;e===o.PIM_FAMILY.PRODUCT?t=s:e===o.PIM_FAMILY.DESIGN?n=s:e===o.PIM_FAMILY.MODEL&&(i=s)}return{product:t,design:n,model:i}}t.diffModelDataProperties=diffModelDataProperties,t.resolveConflictsForProperties=async function resolveConflictsForProperties(e,t,n,o,i){const c=diffModelDataProperties(t,n);return 0==Object.keys(c).length||await async function applyModelDataProperties(e,t,n,o){const i=s.chunk(Object.keys(t),r.BATCH_LIMIT/2),c=e.pimGetSchemasVersion(),u=[];for(const s of i){e.beginBatch();for(const e of s){const r=n[e],{product:i,design:s}=getProductStructureAssets(r),l=t[e];if(i&&updatePropsToProductAsset(c,i,l))try{a.addAdditionalInfo([i],o),i.addToCurrentBatch()}catch(e){u.push(i)}if(s&&updatePropsToDesignAsset(c,s,l))try{a.addAdditionalInfo([s],o),s.addToCurrentBatch()}catch(e){u.push(s)}}const i=await e.endBatch();r.validateBatchResult(i)}await Promise.all(u.map(async e=>e.save()))}(e,c,o,i),!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(4),o=n(7),i=n(3),s=n(18),a=n(113),c=n(27);t.resolveNoCADComponents=async function resolveNoCADComponents(e,t,n,u){const l={restoredAssets:new Map,deletedAssets:new Map},d=[];for(const[e,r]of n)t.has(e)||(l.deletedAssets.set(e,r),d.push({asset:r,deleteOrRestore:!0}));for(const[e,o]of t){const t=n.get(e);if(!t||r.isSoftDeleted(t)){const t=await o.getLatestAsset();l.restoredAssets.set(e,t),d.push({asset:t,deleteOrRestore:!1})}}const p=i.chunk(d,r.BATCH_LIMIT);for(const t of p){e.beginBatch();const n=s.getSchemaManager(e.pimGetSchemasVersion()).getFamilyTypeId(a.PIM_COMPONENT_FAMILY.DELETE_STATUS);for(const{asset:e,deleteOrRestore:o}of t)o?r.softDeleteEntity(e,n):r.restoreEntity(e,n),c.addAdditionalInfo([e],u);const i=await e.endBatch();o.validateBatchResult(i)}return l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(1189))},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(1192)),__export(n(1193)),__export(n(1194)),__export(n(498))},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(1195)),__export(n(243))},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1199);Object.defineProperty(t,"NoJournalingSDK",{enumerable:!0,get:function(){return i.NoJournalingSDK}}),o(n(1205),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommandQueryRegistry=t.COMMAND_REMOTE_SYNC=t.COMMAND_EXECUTION_NOOP=t.COMMAND_NOOP=void 0;const r=n(19);t.COMMAND_NOOP="__noop__",t.COMMAND_EXECUTION_NOOP="__execution_noop__",t.COMMAND_REMOTE_SYNC="__remote_sync_command__";const o=[t.COMMAND_NOOP,t.COMMAND_REMOTE_SYNC,t.COMMAND_EXECUTION_NOOP];t.CommandQueryRegistry=class CommandQueryRegistry{constructor(){this.commandRegistry=new Map,this.queryRegistry=new Map}funcAreEquals(e,t){return!e&&!t||e&&t&&e.toString()===t.toString()}commandsAreEqual(e,t){return e.serverCommandName===t.serverCommandName&&this.funcAreEquals(e.createPayload,t.createPayload)&&this.funcAreEquals(e.processResults,t.processResults)&&this.funcAreEquals(e.executeLocally,t.executeLocally)&&this.funcAreEquals(e.rewriteIds,t.rewriteIds)}queriesAreEqual(e,t){return e.serverQueryEndpoint===t.serverQueryEndpoint&&this.funcAreEquals(e.createPayload,t.createPayload)&&this.funcAreEquals(e.processResults,t.processResults)&&this.funcAreEquals(e.executeLocally,t.executeLocally)&&this.funcAreEquals(e.rewriteIds,e.rewriteIds)}registerCommandsAndQueries(e){if(!e)throw new r.JournalError(r.JournalErrorCode.L7_GEN_NULL_VALUE,"CommandQueryDefinitions");const t=e.commands||{};Object.keys(t).forEach(e=>{this.registerCommand(e,t[e])});const n=e.queries||{};Object.keys(n).forEach(e=>{this.registerQuery(e,n[e])})}getRegisteredCommand(e){if(!e)throw new r.JournalError(r.JournalErrorCode.L7_GEN_NULL_VALUE,"commandName");return this.commandRegistry.get(e)}registerCommand(e,t){if(!e)throw new r.JournalError(r.JournalErrorCode.L7_GEN_NULL_VALUE,"commandName");if(!t)throw new r.JournalError(r.JournalErrorCode.L7_GEN_NULL_VALUE,"commandDef");if(!t.createPayload||!t.processResults||!t.serverCommandName)throw new r.JournalError(r.JournalErrorCode.L7_COMMAND_NOT_REGISTERED,`Command '${e}' has missing fields that are required.`);if(o.includes(e))throw new r.JournalError(r.JournalErrorCode.L7_COMMAND_NAME_NOT_ALLOWED,`Command with name '${e}' is not allowed.`);if(this.commandRegistry.has(e)){const n=this.commandRegistry.get(e);if(n&&!this.commandsAreEqual(n,t))throw new r.JournalError(r.JournalErrorCode.L7_COMMAND_ALREADY_REGISTERED,`Command with name '${e}' is already registered.`)}this.commandRegistry.set(e,t)}getRegisteredCommands(){return this.commandRegistry}registerQuery(e,t){if(!e)throw new r.JournalError(r.JournalErrorCode.L7_GEN_NULL_VALUE,"queryName");if(this.queryRegistry.has(e)){const n=this.queryRegistry.get(e);if(n&&!this.queriesAreEqual(n,t))throw new r.JournalError(r.JournalErrorCode.L7_QUERY_ALREADY_REGISTERED,e+" is already registered.")}if(!t)throw new r.JournalError(r.JournalErrorCode.L7_GEN_NULL_VALUE,"queryDef");if(!t.createPayload||!t.processResults||!t.serverQueryEndpoint)throw new r.JournalError(r.JournalErrorCode.L7_QUERY_NOT_REGISTERED,t+" has missing fields that are required.");this.queryRegistry.set(e,t)}getRegisteredQuery(e){if(!e)throw new r.JournalError(r.JournalErrorCode.L7_GEN_NULL_VALUE,"queryName");return this.queryRegistry.get(e)}getRegisteredQueries(){return this.queryRegistry}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),o=n(173);t.isModel=function isModel(e){const t=r.getFamilyFromTypeid(e.getTypeId());return!!t&&t.family===r.PIM_FAMILY.MODEL},t.isSheets=function isSheets(e){const t=r.getFamilyFromTypeid(e.getTypeId());return!!t&&t.family===r.PIM_FAMILY.SHEETS},t.isChainJournalPredicate=e=>{if(!e||!e.properties)return!1;return e.properties[o.JournalTagNames.LAYOUT]===o.JOURNAL_TAG_LAYOUT.CHAIN},t.createTimeLogger=function createTimeLogger(e){const t=e;let n;return e=>{n&&console.timeEnd(n),e&&(n=`${t} : ${e}`,console.time(n))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8);function validateResult(e){if(e.error&&"Legacy Milestone already exists for this version"!=e.error.message)throw e.error}async function createMilestone(e,t,n,o,i,s){if(!n.name)return console.error("No milestone name for version "+o),{legacyMilestone:!1,name:"",description:"",versionUrn:o,error:"No milestone name"};let a,c,u;if((i=i||r.MILESTONE_SCOPES.ALL)==r.MILESTONE_SCOPES.ALL||i==r.MILESTONE_SCOPES.PIM)try{console.info(`Creating pim milestone for version ${o} and snapshot ${s}`);const i={wipVersionUrn:o,name:n.name,description:n.description?n.description:"",snapshotUrn:s||"",milestoneScope:r.MILESTONE_SCOPES.PIM},a=await e.getSpaceCollection(t);validateResult((await e.pimCreateMilestoneCommand(a,[i]))[0])}catch(e){a=e.message}if(i==r.MILESTONE_SCOPES.ALL||i==r.MILESTONE_SCOPES.LEGACY)try{console.info(`Creating legacy milestone for version ${o} and snapshot ${s}`);const i={wipVersionUrn:o,name:n.name,description:n.description?n.description:"",snapshotUrn:s||"",milestoneScope:r.MILESTONE_SCOPES.LEGACY},a=await e.getSpaceCollection(t);validateResult((await e.pimCreateMilestoneCommand(a,[i]))[0])}catch(e){c=e.message}let l=!0;return a&&c?(u=`Both milestones failed. PIM Milestone Error: ${a}. Legacy Milestone Error: ${c}.`,l=!1):c?(u=`PIM milestone created successfully but legacy milestone failed. Legacy Milestone Error: ${c}.`,l=!1):a&&(u=`legacy milestone created successfully but PIM milestone failed. PIM Milestone Error: ${a}.`),{legacyMilestone:l,name:n.name,versionUrn:o,description:n.description,error:u}}t.createMilestone=createMilestone,t.createMilestoneAndSendResponse=async function createMilestoneAndSendResponse(e,t,n,r,o,i,s){const a=await createMilestone(e,n,r,o,i,s);t.sendMilestoneResponse(a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(71);t.findLocalRootProductAndSnapshot=async function findLocalRootProductAndSnapshot(e,t,n,i,s){var a,c;const u=await o.getSdkForSpaceCollectionId(t,e.options,i,n,s),l=u.journal;if(void 0!==l&&l.getType()===r.JournalType.ISOLATED){const e=await o.getLocalSnapshotTag(l);if(void 0!==e){const n=await(null===(a=u.sdk)||void 0===a?void 0:a.getSnapshot(e,t));if(void 0!==n){const e=await(null===(c=u.sdk)||void 0===c?void 0:c.pimGetRootProductFromSnapshot(t,n));if(void 0!==e)return{rootProduct:e,snapshot:n}}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});try{t.ADSK_PACKAGE_INFO=n(1214)}catch(e){t.ADSK_PACKAGE_INFO={name:"<unknown-name>",version:"<unknown-version>",buildNumber:"<unknown-build-number>",revision:"unknown-revision",dependencies:{}}}},function(e,t,n){e.exports=glob;var r=n(21),o=n(524),i=n(246),s=(i.Minimatch,n(1220)),a=n(29).EventEmitter,c=n(11),u=n(46),l=n(247),d=n(1222),p=n(525),h=(p.alphasort,p.alphasorti,p.setopts),m=p.ownProp,y=n(1223),g=(n(12),p.childrenIgnored),_=p.isIgnored,v=n(527);function glob(e,t,n){if("function"==typeof t&&(n=t,t={}),t||(t={}),t.sync){if(n)throw new TypeError("callback provided to sync glob");return d(e,t)}return new Glob(e,t,n)}glob.sync=d;var E=glob.GlobSync=d.GlobSync;function Glob(e,t,n){if("function"==typeof t&&(n=t,t=null),t&&t.sync){if(n)throw new TypeError("callback provided to sync glob");return new E(e,t)}if(!(this instanceof Glob))return new Glob(e,t,n);h(this,e,t),this._didRealPath=!1;var r=this.minimatch.set.length;this.matches=new Array(r),"function"==typeof n&&(n=v(n),this.on("error",n),this.on("end",(function(e){n(null,e)})));var o=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===r)return done();for(var i=0;i<r;i++)this._process(this.minimatch.set[i],i,!1,done);function done(){--o._processing,o._processing<=0&&o._finish()}}glob.glob=glob,glob.hasMagic=function(e,t){var n=function extend(e,t){if(null===t||"object"!=typeof t)return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}({},t);n.noprocess=!0;var r=new Glob(e,n).minimatch.set;if(!e)return!1;if(r.length>1)return!0;for(var o=0;o<r[0].length;o++)if("string"!=typeof r[0][o])return!0;return!1},glob.Glob=Glob,s(Glob,a),Glob.prototype._finish=function(){if(u(this instanceof Glob),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();p.finish(this),this.emit("end",this.found)}},Glob.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var e=this.matches.length;if(0===e)return this._finish();for(var t=this,n=0;n<this.matches.length;n++)this._realpathSet(n,next)}function next(){0==--e&&t._finish()}},Glob.prototype._realpathSet=function(e,t){var n=this.matches[e];if(!n)return t();var r=Object.keys(n),i=this,s=r.length;if(0===s)return t();var a=this.matches[e]=Object.create(null);r.forEach((function(n,r){n=i._makeAbs(n),o.realpath(n,i.realpathCache,(function(r,o){r?"stat"===r.syscall?a[n]=!0:i.emit("error",r):a[o]=!0,0==--s&&(i.matches[e]=a,t())}))}))},Glob.prototype._mark=function(e){return p.mark(this,e)},Glob.prototype._makeAbs=function(e){return p.makeAbs(this,e)},Glob.prototype.abort=function(){this.aborted=!0,this.emit("abort")},Glob.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},Glob.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var n=e[t];this._emitMatch(n[0],n[1])}}if(this._processQueue.length){var r=this._processQueue.slice(0);this._processQueue.length=0;for(t=0;t<r.length;t++){var o=r[t];this._processing--,this._process(o[0],o[1],o[2],o[3])}}}},Glob.prototype._process=function(e,t,n,r){if(u(this instanceof Glob),u("function"==typeof r),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([e,t,n,r]);else{for(var o,s=0;"string"==typeof e[s];)s++;switch(s){case e.length:return void this._processSimple(e.join("/"),t,r);case 0:o=null;break;default:o=e.slice(0,s).join("/")}var a,c=e.slice(s);null===o?a=".":l(o)||l(e.join("/"))?(o&&l(o)||(o="/"+o),a=o):a=o;var d=this._makeAbs(a);if(g(this,a))return r();c[0]===i.GLOBSTAR?this._processGlobStar(o,a,d,c,t,n,r):this._processReaddir(o,a,d,c,t,n,r)}},Glob.prototype._processReaddir=function(e,t,n,r,o,i,s){var a=this;this._readdir(n,i,(function(c,u){return a._processReaddir2(e,t,n,r,o,i,u,s)}))},Glob.prototype._processReaddir2=function(e,t,n,r,o,i,s,a){if(!s)return a();for(var u=r[0],l=!!this.minimatch.negate,d=u._glob,p=this.dot||"."===d.charAt(0),h=[],m=0;m<s.length;m++){if("."!==(g=s[m]).charAt(0)||p)(l&&!e?!g.match(u):g.match(u))&&h.push(g)}var y=h.length;if(0===y)return a();if(1===r.length&&!this.mark&&!this.stat){this.matches[o]||(this.matches[o]=Object.create(null));for(m=0;m<y;m++){var g=h[m];e&&(g="/"!==e?e+"/"+g:e+g),"/"!==g.charAt(0)||this.nomount||(g=c.join(this.root,g)),this._emitMatch(o,g)}return a()}r.shift();for(m=0;m<y;m++){g=h[m];e&&(g="/"!==e?e+"/"+g:e+g),this._process([g].concat(r),o,i,a)}a()},Glob.prototype._emitMatch=function(e,t){if(!this.aborted&&!_(this,t))if(this.paused)this._emitQueue.push([e,t]);else{var n=l(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=n),!this.matches[e][t]){if(this.nodir){var r=this.cache[n];if("DIR"===r||Array.isArray(r))return}this.matches[e][t]=!0;var o=this.statCache[n];o&&this.emit("stat",t,o),this.emit("match",t)}}},Glob.prototype._readdirInGlobStar=function(e,t){if(!this.aborted){if(this.follow)return this._readdir(e,!1,t);var n=this,o=y("lstat\0"+e,(function lstatcb_(r,o){if(r&&"ENOENT"===r.code)return t();var i=o&&o.isSymbolicLink();n.symlinks[e]=i,i||!o||o.isDirectory()?n._readdir(e,!1,t):(n.cache[e]="FILE",t())}));o&&r.lstat(e,o)}},Glob.prototype._readdir=function(e,t,n){if(!this.aborted&&(n=y("readdir\0"+e+"\0"+t,n))){if(t&&!m(this.symlinks,e))return this._readdirInGlobStar(e,n);if(m(this.cache,e)){var o=this.cache[e];if(!o||"FILE"===o)return n();if(Array.isArray(o))return n(null,o)}r.readdir(e,function readdirCb(e,t,n){return function(r,o){r?e._readdirError(t,r,n):e._readdirEntries(t,o,n)}}(this,e,n))}},Glob.prototype._readdirEntries=function(e,t,n){if(!this.aborted){if(!this.mark&&!this.stat)for(var r=0;r<t.length;r++){var o=t[r];o="/"===e?e+o:e+"/"+o,this.cache[o]=!0}return this.cache[e]=t,n(null,t)}},Glob.prototype._readdirError=function(e,t,n){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(e);if(this.cache[r]="FILE",r===this.cwdAbs){var o=new Error(t.code+" invalid cwd "+this.cwd);o.path=this.cwd,o.code=t.code,this.emit("error",o),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t)}return n()}},Glob.prototype._processGlobStar=function(e,t,n,r,o,i,s){var a=this;this._readdir(n,i,(function(c,u){a._processGlobStar2(e,t,n,r,o,i,u,s)}))},Glob.prototype._processGlobStar2=function(e,t,n,r,o,i,s,a){if(!s)return a();var c=r.slice(1),u=e?[e]:[],l=u.concat(c);this._process(l,o,!1,a);var d=this.symlinks[n],p=s.length;if(d&&i)return a();for(var h=0;h<p;h++){if("."!==s[h].charAt(0)||this.dot){var m=u.concat(s[h],c);this._process(m,o,!0,a);var y=u.concat(s[h],r);this._process(y,o,!0,a)}}a()},Glob.prototype._processSimple=function(e,t,n){var r=this;this._stat(e,(function(o,i){r._processSimple2(e,t,o,i,n)}))},Glob.prototype._processSimple2=function(e,t,n,r,o){if(this.matches[t]||(this.matches[t]=Object.create(null)),!r)return o();if(e&&l(e)&&!this.nomount){var i=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=c.join(this.root,e):(e=c.resolve(this.root,e),i&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e),o()},Glob.prototype._stat=function(e,t){var n=this._makeAbs(e),o="/"===e.slice(-1);if(e.length>this.maxLength)return t();if(!this.stat&&m(this.cache,n)){var i=this.cache[n];if(Array.isArray(i)&&(i="DIR"),!o||"DIR"===i)return t(null,i);if(o&&"FILE"===i)return t()}var s=this.statCache[n];if(void 0!==s){if(!1===s)return t(null,s);var a=s.isDirectory()?"DIR":"FILE";return o&&"FILE"===a?t():t(null,a,s)}var c=this,u=y("stat\0"+n,(function lstatcb_(o,i){if(i&&i.isSymbolicLink())return r.stat(n,(function(r,o){r?c._stat2(e,n,null,i,t):c._stat2(e,n,r,o,t)}));c._stat2(e,n,o,i,t)}));u&&r.lstat(n,u)},Glob.prototype._stat2=function(e,t,n,r,o){if(n&&("ENOENT"===n.code||"ENOTDIR"===n.code))return this.statCache[t]=!1,o();var i="/"===e.slice(-1);if(this.statCache[t]=r,"/"===t.slice(-1)&&r&&!r.isDirectory())return o(null,!1,r);var s=!0;return r&&(s=r.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||s,i&&"FILE"===s?o():o(null,s,r)}},function(e,t,n){e.exports=realpath,realpath.realpath=realpath,realpath.sync=realpathSync,realpath.realpathSync=realpathSync,realpath.monkeypatch=function monkeypatch(){r.realpath=realpath,r.realpathSync=realpathSync},realpath.unmonkeypatch=function unmonkeypatch(){r.realpath=o,r.realpathSync=i};var r=n(21),o=r.realpath,i=r.realpathSync,s=process.version,a=/^v[0-5]\./.test(s),c=n(1216);function newError(e){return e&&"realpath"===e.syscall&&("ELOOP"===e.code||"ENOMEM"===e.code||"ENAMETOOLONG"===e.code)}function realpath(e,t,n){if(a)return o(e,t,n);"function"==typeof t&&(n=t,t=null),o(e,t,(function(r,o){newError(r)?c.realpath(e,t,n):n(r,o)}))}function realpathSync(e,t){if(a)return i(e,t);try{return i(e,t)}catch(n){if(newError(n))return c.realpathSync(e,t);throw n}}},function(e,t,n){function ownProp(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.alphasort=alphasort,t.alphasorti=alphasorti,t.setopts=function setopts(e,t,n){n||(n={});if(n.matchBase&&-1===t.indexOf("/")){if(n.noglobstar)throw new Error("base matching requires globstar");t="**/"+t}e.silent=!!n.silent,e.pattern=t,e.strict=!1!==n.strict,e.realpath=!!n.realpath,e.realpathCache=n.realpathCache||Object.create(null),e.follow=!!n.follow,e.dot=!!n.dot,e.mark=!!n.mark,e.nodir=!!n.nodir,e.nodir&&(e.mark=!0);e.sync=!!n.sync,e.nounique=!!n.nounique,e.nonull=!!n.nonull,e.nosort=!!n.nosort,e.nocase=!!n.nocase,e.stat=!!n.stat,e.noprocess=!!n.noprocess,e.absolute=!!n.absolute,e.maxLength=n.maxLength||1/0,e.cache=n.cache||Object.create(null),e.statCache=n.statCache||Object.create(null),e.symlinks=n.symlinks||Object.create(null),function setupIgnores(e,t){e.ignore=t.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]);e.ignore.length&&(e.ignore=e.ignore.map(ignoreMap))}(e,n),e.changedCwd=!1;var o=process.cwd();ownProp(n,"cwd")?(e.cwd=r.resolve(n.cwd),e.changedCwd=e.cwd!==o):e.cwd=o;e.root=n.root||r.resolve(e.cwd,"/"),e.root=r.resolve(e.root),"win32"===process.platform&&(e.root=e.root.replace(/\\/g,"/"));e.cwdAbs=i(e.cwd)?e.cwd:makeAbs(e,e.cwd),"win32"===process.platform&&(e.cwdAbs=e.cwdAbs.replace(/\\/g,"/"));e.nomount=!!n.nomount,n.nonegate=!0,n.nocomment=!0,e.minimatch=new s(t,n),e.options=e.minimatch.options},t.ownProp=ownProp,t.makeAbs=makeAbs,t.finish=function finish(e){for(var t=e.nounique,n=t?[]:Object.create(null),r=0,o=e.matches.length;r<o;r++){var i=e.matches[r];if(i&&0!==Object.keys(i).length){var s=Object.keys(i);t?n.push.apply(n,s):s.forEach((function(e){n[e]=!0}))}else if(e.nonull){var a=e.minimatch.globSet[r];t?n.push(a):n[a]=!0}}t||(n=Object.keys(n));e.nosort||(n=n.sort(e.nocase?alphasorti:alphasort));if(e.mark){for(r=0;r<n.length;r++)n[r]=e._mark(n[r]);e.nodir&&(n=n.filter((function(t){var n=!/\/$/.test(t),r=e.cache[t]||e.cache[makeAbs(e,t)];return n&&r&&(n="DIR"!==r&&!Array.isArray(r)),n})))}e.ignore.length&&(n=n.filter((function(t){return!isIgnored(e,t)})));e.found=n},t.mark=function mark(e,t){var n=makeAbs(e,t),r=e.cache[n],o=t;if(r){var i="DIR"===r||Array.isArray(r),s="/"===t.slice(-1);if(i&&!s?o+="/":!i&&s&&(o=o.slice(0,-1)),o!==t){var a=makeAbs(e,o);e.statCache[a]=e.statCache[n],e.cache[a]=e.cache[n]}}return o},t.isIgnored=isIgnored,t.childrenIgnored=function childrenIgnored(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return!(!e.gmatcher||!e.gmatcher.match(t))}))};var r=n(11),o=n(246),i=n(247),s=o.Minimatch;function alphasorti(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}function alphasort(e,t){return e.localeCompare(t)}function ignoreMap(e){var t=null;if("/**"===e.slice(-3)){var n=e.replace(/(\/\*\*)+$/,"");t=new s(n,{dot:!0})}return{matcher:new s(e,{dot:!0}),gmatcher:t}}function makeAbs(e,t){var n=t;return n="/"===t.charAt(0)?r.join(e.root,t):i(t)||""===t?t:e.changedCwd?r.resolve(e.cwd,t):r.resolve(t),"win32"===process.platform&&(n=n.replace(/\\/g,"/")),n}function isIgnored(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return e.matcher.match(t)||!(!e.gmatcher||!e.gmatcher.match(t))}))}},function(e,t){e.exports=function wrappy(e,t){if(e&&t)return wrappy(e)(t);if("function"!=typeof e)throw new TypeError("need wrapper function");return Object.keys(e).forEach((function(t){wrapper[t]=e[t]})),wrapper;function wrapper(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];var r=e.apply(this,t),o=t[t.length-1];return"function"==typeof r&&r!==o&&Object.keys(o).forEach((function(e){r[e]=o[e]})),r}}},function(e,t,n){var r=n(526);function once(e){var f=function(){return f.called?f.value:(f.called=!0,f.value=e.apply(this,arguments))};return f.called=!1,f}function onceStrict(e){var f=function(){if(f.called)throw new Error(f.onceError);return f.called=!0,f.value=e.apply(this,arguments)},t=e.name||"Function wrapped with `once`";return f.onceError=t+" shouldn't be called more than once",f.called=!1,f}e.exports=r(once),e.exports.strict=r(onceStrict),once.proto=once((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return once(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return onceStrict(this)},configurable:!0})}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1224);t.SpaceCollectionStateModel=class SpaceCollectionStateModel{constructor(e){this.id=e,this.ok={value:!0},this.ffProperties=this.ffWrite={value:!1}}setFeatureFlags(e){e&&(this.setEnabled("ffProperties",!!e[r.FEATUREFLAG_PROPERTIES]),this.setEnabled("ffWrite",!!e[r.FEATUREFLAG_WRITE]))}setEnabled(e,t,n){this[e]={value:t,reason:n}}enabled(){return this.ok.value&&this.ffProperties.value&&this.ffWrite.value}writesEnabled(){return this.ffWrite.value}propertiesEnabled(){return this.ffProperties.value}state(){const ffToString=e=>e?"ON":"OFF";return[this.ok.value?"Hub State Ok":this.ok.reason,"PIM Properties: "+ffToString(this.ffProperties.value),"PIM JS Write Flag: "+ffToString(this.ffWrite.value)].join("\n")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1225),o=n(0),i=n(1255),s=n(85),a=n(384),c=n(8),u=n(21),l=n(11),d=n(91),p={commandPollingAttempts:600,commandPollingInterval:100};t.JournalService=class JournalService{getErrorMarkerFilename(e,t){return l.join(t.userFolder,e.spaceCollectionId+"_v2.sql.err")}async initSDK(e,t){let n=void 0;const getBearerToken=async function(){return await d.validateToken(t.bearerToken,t.expiryTimeEpochSec)};try{u.accessSync(t.userFolder,u.constants.W_OK)}catch(e){u.mkdirSync(t.userFolder,{recursive:!0})}const h=this.getErrorMarkerFilename(e,t);u.existsSync(h)&&this.removeCorruptedDatabaseFiles(e,t);const m=l.join(t.userFolder,e.spaceCollectionId+"_v2.sql");console.log("Initializing JournalSDK ...: DB location is "+m),n=await i.createSqLiteStore(m,o.combineChanges);const y=new r.AGSyncHandler(new r.AGL2Client(a.getClient(Object.assign(Object.assign({getBearerToken:getBearerToken,baseURL:t.serverUrl},c.DEFAULT_JOURNALING_CONFIGURATION),{retriesInterval:300,maximumRetriesInterval:2e3,exponentialBackOff:!0}))),n),g=new s.JournalingSDK(n,y,Object.assign(Object.assign({server:t.serverUrl,getBearerToken:getBearerToken},c.DEFAULT_JOURNALING_CONFIGURATION),p));return this.setSdk(g),{journalSDK:g,store:n}}handleJournalSyncError(e,t){console.log(`An error occurred while syncing ${e.spaceCollectionId}. Will mark its database files for removal on next startup`);try{u.existsSync(this.getErrorMarkerFilename(e,t))||u.closeSync(u.openSync(this.getErrorMarkerFilename(e,t),"w"))}catch(t){throw console.log(`Error while marking db files for removal: ${e.spaceCollectionId}: ${t}`),t}}removeDatabaseFiles(e,t){const n=[l.join(t.userFolder,e.spaceCollectionId+"_v2.sql"),l.join(t.userFolder,e.spaceCollectionId+"_v2.sql-shm"),l.join(t.userFolder,e.spaceCollectionId+"_v2.sql-wal"),this.getErrorMarkerFilename(e,t)];for(const e of n)u.existsSync(e)&&u.unlinkSync(e);console.log("Finished removing db files for "+e.spaceCollectionId)}removeCorruptedDatabaseFiles(e,t){console.log(`Detected corrupt db files for ${e.spaceCollectionId}. Will attempt to remove them`);try{this.removeDatabaseFiles(e,t)}catch(t){console.log(`Error while removing db files for ${e.spaceCollectionId}: ${t}`)}}getSdk(){if(!this.sdk)throw new Error("JournalService has not been initialized");return this.sdk}setSdk(e){this.sdk=e}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1227);Object.defineProperty(t,"Traces",{enumerable:!0,get:function(){return i.Traces}});var s=n(1228);Object.defineProperty(t,"chunk",{enumerable:!0,get:function(){return s.chunk}}),o(n(1229),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncServerError=void 0;class SyncServerError extends Error{constructor(e,t,n,r,o=""){super(`[SyncServerError] Status ${n} for ${t} ${e} with trackingId ${o}. Details: ${r}`),this._entityId=e,this._trackingId=o,this._status=n}get entityId(){return this._entityId}get trackingId(){return this._trackingId}get status(){return this._status}}t.SyncServerError=SyncServerError},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isArrayChangeSet=void 0;const r=n(249);t.isArrayChangeSet=function isArrayChangeSet(e){return r.isChangeset(e)&&(Array.isArray(e.insert)||Array.isArray(e.modify))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SqliteEntityStore=void 0;const r=n(85),o=n(161),i=n(153),s=n(552),a=n(250),c="WITH lineage AS (\n                        SELECT *, 1 as journalOrder FROM journal WHERE journalId = ?\n                        UNION ALL\n                          SELECT j.*, journalOrder + 1\n                          FROM journal j\n                          JOIN lineage p ON j.journalId = p.parentJournalId\n                      )";class SqliteEntityStore extends r.EntityStore{constructor(e,t,n){super(),this.db=e,this.combineChanges=n,this.journalStore=t}async createEntity(e,t){var n,o;if(!await a.SqliteUtils.doesJournalExist(this.db.Db(),t.journalId))throw new r.StoreError(r.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`Journal with ID ${t.journalId} does not exist in the journal store.`);const i=e.entityId&&await this._doesEntityExist(e.entityId);if(i){const{parentJournalId:n}=await this.journalStore.getJournal(t.journalId);if(n){const t=await this._getEntity(e.entityId,{journalId:n});if(t&&t.revisionId)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_ALREADY_EXIST,`The entity with ID ${e.entityId} and\n              revision ID ${t.revisionId} already exists in the entity store.`)}}if(t.commandId&&!await a.SqliteUtils.doesCommandExist(this.db.Db(),t.commandId))throw new r.StoreError(r.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,`Command with ID ${t.commandId} does not exist in the journal store.`);const c=i?(await a.SqliteUtils.getEntityFromEntityId(this.db.Db(),e.entityId)).entityIdx:await this._createDbEntity({localId:e.entityId||s.nanoid(),type:e.type}),{staticData:u}=null!==(n=await this._getDbEntityRevisionJournal(c,t.journalId))&&void 0!==n?n:{},l=u?this._updateDbEntityRevisionJournal:this._createDbEntityRevisionJournal;await l.call(this,c,t.journalId,null!==(o=e.staticDataChanges)&&void 0!==o?o:{});const d=await this._createDbEntityRevision(c,t,{created:!0,removed:!1,parentEntityId:e.parentEntityId,staticDataChanges:e.staticDataChanges,dataChanges:e.dataChanges});return await this._createDbMaterializedView({entityIdx:c,journalId:t.journalId,revisionId:d.revisionId,removed:!1,parentEntityId:e.parentEntityId,data:this.combineChanges(void 0,void 0!==e.dataChanges?[e.dataChanges]:[])}),this._getEntityByIdxJournalAndRevision(c,t.journalId,d.revisionId)}async _getEntityByIdxJournalAndRevision(e,t,n){var o;const i=await this._getDbEntityByIdxAtRevision(t,e,n);if(!i)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,"Entity with the given ID does not exist in the entity store.");return SqliteEntityStore.toModelEntity(Object.assign(Object.assign({},i),{staticData:JSON.parse(i.staticData)}),{parentEntityId:i.parentEntityId,revisionId:i.revisionId,revisionPermanentId:null!==(o=i.revisionPermanentId)&&void 0!==o?o:null,removed:i.removed},i.data?JSON.parse(i.data):void 0)}async _getEntity(e,{journalId:t}){var n;if(!e)throw new r.StoreError(r.ErrorCode.L5_GEN_INVALID_VALUE,"entityId");const[o]=await this._getDbEntities(t,[e]);return o?SqliteEntityStore.toModelEntity(Object.assign(Object.assign({},o),{staticData:JSON.parse(o.staticData)}),{parentEntityId:o.parentEntityId,revisionId:o.revisionId,revisionPermanentId:null!==(n=o.revisionPermanentId)&&void 0!==n?n:null,removed:o.removed},o.data?JSON.parse(o.data):void 0):void 0}async getJournalEntities(e){return(await this._getDbJournalEntities(e)).map(e=>{var t;return SqliteEntityStore.toModelEntity(Object.assign(Object.assign({},e),{staticData:JSON.parse(e.staticData)}),{parentEntityId:e.parentEntityId,revisionId:e.revisionId,revisionPermanentId:null!==(t=e.revisionPermanentId)&&void 0!==t?t:null,removed:e.removed},e.data?JSON.parse(e.data):void 0)})}async getEntities(e,{journalId:t}){var n;if(!t)throw new r.StoreError(r.ErrorCode.L5_GEN_INVALID_VALUE,"journalId");if(!e||!e.length)throw new r.StoreError(r.ErrorCode.L5_GEN_INVALID_VALUE,"entityIds");const o=await this._getDbEntities(t,e),i=new Map;for(const e of o){const t=null!==(n=i.get(e.localId))&&void 0!==n?n:new Map;t.set(e.revisionId,e),e.revisionPermanentId&&t.set(e.revisionPermanentId,e),1===e.revisionRank&&t.set("tip",e),i.set(e.localId,t),e.permanentId&&i.set(e.permanentId,t)}return e.map(e=>{var t,n,o;const{entityId:s,revisionId:a}="string"==typeof e?{entityId:e}:e,c=i.get(s);if(!c)return;const u=a?c.get(a):c.get("tip");return u?u.removed?void 0:{entityId:u.localId,entityPermanentId:null!==(t=u.permanentId)&&void 0!==t?t:void 0,parentEntityId:null!==(n=u.parentEntityId)&&void 0!==n?n:void 0,revisionId:u.revisionId,revisionPermanentId:null!==(o=u.revisionPermanentId)&&void 0!==o?o:void 0,type:r.EntityType.ENTITY,removed:!!u.removed,staticData:u.staticData?JSON.parse(u.staticData.toString()):{},data:u.data?JSON.parse(u.data.toString()):{}}:void 0})}async queryEntities(e,t){var n,o;return{items:(await this._queryDBEntities(e,t)).map(e=>{var t,n,o;return{entityId:e.localId,entityPermanentId:null!==(t=e.permanentId)&&void 0!==t?t:void 0,parentEntityId:null!==(n=e.parentEntityId)&&void 0!==n?n:void 0,revisionId:e.revisionId,revisionPermanentId:null!==(o=e.revisionPermanentId)&&void 0!==o?o:void 0,type:r.EntityType[e.type.toUpperCase()],data:e.data?JSON.parse(e.data):void 0,staticData:e.staticData?JSON.parse(e.staticData):void 0,removed:!!e.removed}}),offset:null!==(n=t.offset)&&void 0!==n?n:r.PaginationConstants.OFFSET,limit:null!==(o=t.limit)&&void 0!==o?o:r.PaginationConstants.LIMIT}}async getEntityRevisions(e,t,n){let i=[];const s=await a.SqliteUtils.getEntityFromEntityId(this.db.Db(),e);if(!s)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the current entity store.`);const c=await this._getJournalLineage(t);let u;for(const e of c){const t=await this._getDbRevisionChangeRange(s.entityIdx,e,{});if(t.length>0){const e=t[0];for(const e of t)u?e.revisionDate<u&&i.push(SqliteEntityStore.toModelRevision(e)):i.push(SqliteEntityStore.toModelRevision(e));u=e.revisionDate}}return i=o.sortHelper(i,n.sort||["-revisionDate"]),i=o.filterHelper(i,n.filters||{}),o.paginationHelper(i,n.offset,n.limit)}async updateEntity(e,t,n){var o;const{staticDataChanges:i,parentEntityId:c,dataChanges:u}=t,{journalId:l}=n;let{revisionId:d}=n;if(!l)throw new r.StoreError(r.ErrorCode.L5_GEN_INVALID_VALUE,"journalId");if(!e)throw new r.StoreError(r.ErrorCode.L5_GEN_INVALID_VALUE,"entityId");if(t.type)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_CANNOT_UPDATE_ENTITY_TYPE,"Not allowed to update Entity type.");const p=await a.SqliteUtils.getEntityFromEntityId(this.db.Db(),e);if(!p)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the current entity store.`);if(d=d||s.nanoid(),!0===await this._isDbEntityRemoved(p.entityIdx,l))throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_IS_REMOVED,`Entity with ID ${e} was already removed.`);if(await this._doesEntityRevisionExist(p.entityIdx,l,d))throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_REVISION_ALREADY_EXIST,`Revision with ID ${d} already exists for the journal ${l}.`);const h=await this._getDbEntityRevisionJournal(p.entityIdx,l,!0);if(!h)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL,`No revision found in journal ${l} or journal ${l} does not exist`);const m=this.combineChanges(h.staticData?JSON.parse(h.staticData):void 0,[null!=i?i:{}]),y=h.journalId===l?this._updateDbEntityRevisionJournal:this._createDbEntityRevisionJournal;await y.call(this,p.entityIdx,l,m);const g=await this._createDbEntityRevision(p.entityIdx,Object.assign(Object.assign({},n),{revisionId:d}),{removed:!1,parentEntityId:c,staticDataChanges:i,dataChanges:u}),_=await this._getLastMaterializedView(p.entityIdx,l),v=_&&_.data?JSON.parse(_.data):void 0;return await this.createMaterializedView(e,l,d,{data:this.combineChanges(v,null===g.dataChanges?[]:[JSON.parse(g.dataChanges)]),removed:!1,parentEntityId:c?c||void 0:null!==(o=null==_?void 0:_.parentEntityId)&&void 0!==o?o:void 0}),this._getEntityByIdxJournalAndRevision(p.entityIdx,l,d)}async removeEntity(e,t){var n,o;const{journalId:i,revisionId:s}=t;if(!i)throw new r.StoreError(r.ErrorCode.L5_GEN_INVALID_VALUE,"journalId");if(!e)throw new r.StoreError(r.ErrorCode.L5_GEN_INVALID_VALUE,"entityId");if(!await a.SqliteUtils.doesJournalExist(this.db.Db(),i))throw new r.StoreError(r.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`Journal with ID ${t.journalId} does not exist in the journal store.`);const c=await this._getEntity(e,{journalId:i});if(!c)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the current entity store.`);if(c.removed)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_IS_REMOVED,`Entity with ID ${e} was already removed.`);const u=await a.SqliteUtils.getEntityIdxFromEntityId(this.db.Db(),e);if(s&&await this._doesEntityRevisionExist(u,i,s))throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_REVISION_ALREADY_EXIST,`Revision with ID ${s} already exists for the journal ${i}.`);const l=null!==(n=await this._getDbEntityRevisionJournal(u,i,!0))&&void 0!==n?n:{};l.journalId!==i&&await this._createDbEntityRevisionJournal(u,i,JSON.parse(l.staticData));const{data:d}=null!==(o=await this._getLastMaterializedView(u,i))&&void 0!==o?o:{},p=await this._createDbEntityRevision(u,t,{removed:!0});return await this.createMaterializedView(e,i,p.revisionId,{data:d?JSON.parse(d):void 0,removed:!0}),this._getEntityByIdxJournalAndRevision(u,i,p.revisionId)}async setEntityPermanentId(e,t){if(!await a.SqliteUtils.getEntityFromEntityId(this.db.Db(),e))throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the current entity store.`);await this._updatePermanentId(e,t)}async createRelationship(e,t,n){var o,i;if(!await a.SqliteUtils.doesJournalExist(this.db.Db(),n.journalId))throw new r.StoreError(r.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`Journal with ID ${n.journalId} does not exist in the journal store.`);const c=e.entityId&&await this._doesEntityExist(e.entityId);if(c){const{parentJournalId:t}=await this.journalStore.getJournal(n.journalId);if(t){const n=await this._getEntity(e.entityId,{journalId:t});if(null==n?void 0:n.revisionId)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_ALREADY_EXIST,`The entity with ID ${e.entityId} and\n              revision ID ${n.revisionId} already exists in the entity store.`)}}if(n.commandId&&!await a.SqliteUtils.doesCommandExist(this.db.Db(),n.commandId))throw new r.StoreError(r.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,`The command with ID ${n.commandId} does not exist in the current entity store.`);let u;if(c)u=await a.SqliteUtils.getEntityIdxFromEntityId(this.db.Db(),e.entityId),await this._updateDbRelationship(u,{fromEntityId:t.from.entityId,fromRevisionId:t.from.revisionId,toEntityId:t.to.entityId,toRevisionId:t.to.revisionId});else{const n=await this._createDbEntity({localId:e.entityId||s.nanoid(),type:e.type});u=await this._createDbRelationship({entityIdx:n,fromEntityId:t.from.entityId,fromRevisionId:t.from.revisionId,toEntityId:t.to.entityId,toRevisionId:t.to.revisionId})}const{staticData:l}=null!==(o=await this._getDbEntityRevisionJournal(u,n.journalId))&&void 0!==o?o:{},d=l?this._updateDbEntityRevisionJournal:this._createDbEntityRevisionJournal;await d.call(this,u,n.journalId,null!==(i=e.staticDataChanges)&&void 0!==i?i:{});const p=await this._createDbEntityRevision(u,n,{created:!0,removed:!1,parentEntityId:e.parentEntityId,staticDataChanges:e.staticDataChanges,dataChanges:e.dataChanges});return await this._createDbMaterializedView({entityIdx:u,journalId:n.journalId,revisionId:p.revisionId,removed:!1,parentEntityId:e.parentEntityId,data:this.combineChanges(void 0,void 0!==e.dataChanges?[e.dataChanges]:[])}),this._getRelationshipByIdxJournalAndRevision(u,n.journalId,p.revisionId)}async updateRelationship(e,t,n,o){let i;if(i=t?await this.updateEntity(e,t,o):await this._getEntity({entityId:e,revisionId:o.revisionId},{journalId:o.journalId}),!i)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the entity store.`);const s=await a.SqliteUtils.getEntityIdxFromEntityId(this.db.Db(),e),c=await this._getRelationshipByIdx(s);if(n){const e={toEntityId:n.to?n.to.entityId:c.toEntityId,toRevisionId:n.to?n.to.revisionId:c.toRevisionId,fromEntityId:n.from?n.from.entityId:c.fromEntityId,fromRevisionId:n.from?n.from.revisionId:c.fromRevisionId};await this._updateDbRelationship(s,e)}return this._getRelationshipByIdxJournalAndRevision(s,o.journalId,i.revisionId)}async getRelationship(e,{journalId:t}){const n=await this._getEntity(e,{journalId:t});if(!n)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the entity store.`);if(n.removed)return;const o=await a.SqliteUtils.getEntityIdxFromEntityId(this.db.Db(),"string"==typeof e?e:e.entityId);if(!o)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the entity store.`);const i=await this._getDbRelationshipByIdx(o);if(!i)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Relationship with ID ${e} does not exist in the entity store.`);const s=await a.SqliteUtils.getEntityFromEntityId(this.db.Db(),i.fromEntityId);if(!s)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Relationship from entity, ID ${i.fromEntityId}, does not exist.`);const c=await a.SqliteUtils.getEntityFromEntityId(this.db.Db(),i.toEntityId);if(!c)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Relationship to entity, ID ${i.toEntityId}, does not exist.`);return SqliteEntityStore.toModelRelationshipFromEntity(i,n,c,s)}async getRelationships(e,{journalId:t},n,r){let i,s,c=[];"string"==typeof e?(i=e,s=void 0):(i=e.entityId,s=e.revisionId);const{entityLocalId:u,entityPermanentId:l}=await this.getEntityIds(i),d=["staticData"];n.fetchTipRelationshipData&&d.push("data");const{includeNames:p,others:h}=a.SqliteUtils.splitFilters(null!=r?r:{},d),m=await this._getDbRelationships({entityLocalId:u,entityPermanentId:l},s,t,n,p);if(m.length){const e=[];for(const r of m)r.removed||e.push(this._toModelRelationship(r,t,n));c=await Promise.all(e),c=o.filterHelper(c,h)}return c}async createMaterializedView(e,t,n,o){var i;const s=await a.SqliteUtils.getEntityFromEntityId(this.db.Db(),e);if(!s)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the entity store.`);if(await this._getMaterializedView(s.entityIdx,t,n))throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_MV_ALREADY_EXIST,`Materialized view for revision with ID ${n} already exists.`);return await this._createDbMaterializedView(Object.assign({entityIdx:s.entityIdx,journalId:t,revisionId:n},o)),{entityId:e,journalId:t,revisionId:n,removed:o.removed,parentEntityId:null!==(i=o.parentEntityId)&&void 0!==i?i:void 0}}async createEntityStaticObject(e,t){const{localId:n=s.nanoid(),permanentId:r,type:o}=e,i=await this._createDbEntity({localId:n,permanentId:r,type:o});return t&&await this._createDbRelationship({entityIdx:i,fromEntityId:t.from.entityId,fromRevisionId:t.from.revisionId,toEntityId:t.to.entityId,toRevisionId:t.to.revisionId}),{localId:n,permanentId:r,type:o}}async updateRelationshipStaticObject(e,t){const{from:n,to:r}=t;if(r||n){const o=await a.SqliteUtils.getEntityIdxFromEntityId(this.db.Db(),e),i=await this._getRelationshipByIdx(o),s=!n||i.fromEntityId===n.entityId&&i.fromRevisionId===n.revisionId,c=!r||i.toEntityId===r.entityId&&i.toRevisionId===r.revisionId;if(s&&c)return;const u={toEntityId:t.to?t.to.entityId:i.toEntityId,toRevisionId:t.to?t.to.revisionId:i.toRevisionId,fromEntityId:t.from?t.from.entityId:i.fromEntityId,fromRevisionId:t.from?t.from.revisionId:i.fromRevisionId};await this._updateDbRelationship(o,u)}}async createRevision(e,t,n,o){var i,s;const c=await a.SqliteUtils.getEntityIdxFromEntityId(this.db.Db(),e);if(!c)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the entity store.`);const{revisionId:u,revisionPermanentId:l,commandId:d,revisionDate:p,created:h,removed:m,parentEntityId:y,staticDataChanges:g={},dataChanges:_}=n;if(u&&await this._doesEntityRevisionExist(c,t,u))throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_REVISION_ALREADY_EXIST,`Revision with ID ${u} already exists.`);const v=null!==(i=await this._getDbEntityRevisionJournal(c,t,!0))&&void 0!==i?i:{},E=v.journalId===t;let I={};I=E?this.combineChanges(v.staticData?JSON.parse(v.staticData):void 0,[null!=g?g:{}]):this.combineChanges(void 0,[null!=g?g:{}]);const b=E?this._updateDbEntityRevisionJournal:this._createDbEntityRevisionJournal;await b.call(this,c,t,I);const S=await this._createDbEntityRevision(c,{revisionId:u,revisionPermanentId:l,revisionDate:p,journalId:t,commandId:d},{created:h,removed:m,parentEntityId:y,staticDataChanges:g,dataChanges:_});if(o)await this.createMaterializedView(e,t,S.revisionId,o);else{const n=await this._getLastMaterializedView(c,t),r=(null==n?void 0:n.data)?JSON.parse(n.data):void 0,o=S.dataChanges?[JSON.parse(S.dataChanges)]:[];await this.createMaterializedView(e,t,S.revisionId,{data:this.combineChanges(r,o),parentEntityId:null===S.parentEntityId?null!==(s=null==n?void 0:n.parentEntityId)&&void 0!==s?s:void 0:S.parentEntityId||void 0,removed:S.removed})}}async deleteEntity(e,t=!0){const n=await a.SqliteUtils.getEntityFromEntityId(this.db.Db(),e);if(n){if(!1===t&&await this._isEntityModifiedLocally(n.entityIdx))throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_CANNOT_DELETE_ENTITY,`Cannot delete entity with ID ${e} because it has been modified locally.`);await this._deleteDbEntityRevisions(n.entityIdx),await this._deleteDbEntity(n.entityIdx)}}async deleteRevision(e,t,n){const o=await a.SqliteUtils.getEntityFromEntityId(this.db.Db(),e);if(!o)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the entity store.`);await this._doesEntityRevisionExist(o.entityIdx,t,n)&&(await Promise.all([this._deleteDbEntityRevision(o.entityIdx,t,n),this._deleteDbMaterializedView(o.entityIdx,t,n)]),0===(await this._getDbRevisionChangeRange(o.entityIdx,t,{})).length&&await this._deleteDBEntityRevisionJournal(o.entityIdx,t))}static toModelEntity(e,t,n){var o,i,s;return{entityId:e.localId,entityPermanentId:null!==(o=e.permanentId)&&void 0!==o?o:void 0,parentEntityId:null!==(i=t.parentEntityId)&&void 0!==i?i:void 0,revisionId:t.revisionId,revisionPermanentId:null!==(s=t.revisionPermanentId)&&void 0!==s?s:void 0,type:r.EntityType[e.type.toUpperCase()],data:n,staticData:e.staticData,removed:!!t.removed}}static toModelRevision(e){var t,n,r,o,i,s;return{revisionId:null!==(n=null!==(t=e.revisionId)&&void 0!==t?t:e.revisionPermanentId)&&void 0!==n?n:"",revisionPermanentId:null!==(r=e.revisionPermanentId)&&void 0!==r?r:"",journalId:e.journalId,commandId:e.commandId?e.commandId:void 0,revisionDate:new Date(e.revisionDate),staticDataChanges:JSON.parse(null!==(o=e.staticDataChanges)&&void 0!==o?o:"{}"),dataChanges:JSON.parse(null!==(i=e.dataChanges)&&void 0!==i?i:"{}"),created:null!==(s=e.created)&&void 0!==s?s:void 0,removed:!!e.removed}}static toModelRelationship(e,t,n,r,o){return Object.assign(Object.assign({},this.toModelEntity(e,t,n)),{from:o,to:r})}async _toModelRelationship(e,t,n){let r={entityId:e.fromEntityId,revisionId:e.fromRevisionId},o={entityId:e.toEntityId,revisionId:e.toRevisionId};if(n.fetchEntityData)if("in"===n.direction){o=await this._getEntity(o.entityId,{journalId:t})||o}else{r=await this._getEntity(r.entityId,{journalId:t})||r}return{entityId:e.entityId,entityPermanentId:e.entityPermanentId,parentEntityId:e.parentEntityId,revisionId:e.revisionId,revisionPermanentId:e.revisionPermanentId,type:e.type,staticData:JSON.parse(e.staticData.toString()),data:e.data?JSON.parse(e.data.toString()):e.data,removed:e.removed,from:r,to:o}}static toModelRelationshipFromEntity(e,t,n,r){return Object.assign(Object.assign({},t),{from:{entityId:r.permanentId||r.localId||"",revisionId:e.fromRevisionId?e.fromRevisionId:void 0},to:{entityId:n.permanentId||n.localId||"",revisionId:e.toRevisionId?e.toRevisionId:void 0}})}async _isDbEntityRemoved(e,t){return new Promise((n,r)=>{this.db.Db().get("SELECT removed FROM entityRevision where entityIdx = ? AND journalId = ?\n        ORDER BY revisionDate DESC LIMIT 1",[e,t],(e,t)=>{e?r(e):n(t?!!t.removed:t)})})}async _doesEntityRevisionExist(e,t,n){return new Promise((r,o)=>{this.db.Db().get("SELECT 1 FROM entityRevision\n        WHERE entityIdx = ?\n          AND journalId = ?\n          AND (revisionId = ? OR revisionPermanentId = ?)",[e,t,n,n],(e,t)=>{e?o(e):r(!!t)})})}async _doesEntityExist(e){return new Promise((t,n)=>{this.db.Db().get("SELECT 1 FROM entity where localId = ? OR permanentId = ?",[e,e],(e,r)=>{e?n(e):t(!!r)})})}async _createDbEntityRevision(e,t,n){const r=t.revisionId||s.nanoid(),o=new Date(t.revisionDate).toISOString(),i=void 0!==n.staticDataChanges?JSON.stringify(n.staticDataChanges):null,a=void 0!==n.dataChanges?JSON.stringify(n.dataChanges):null;return new Promise((s,c)=>{const u=[e,t.journalId,r,t.revisionPermanentId,t.commandId,o,n.created,n.removed,null===n.parentEntityId?"":n.parentEntityId,i,a];this.db.Db().run("INSERT INTO entityRevision(\n        entityIdx, journalId, revisionId, revisionPermanentId, commandId, revisionDate, created, removed,\n        parentEntityId, staticDataChanges, dataChanges\n      ) VALUES (?,?,?,?,?,?,?,?,?,?,?);",u,u=>{var l,d,p;u?c(u):s({entityIdx:e,revisionId:r,revisionPermanentId:null!==(l=t.revisionPermanentId)&&void 0!==l?l:null,commandId:t.commandId,revisionDate:o,journalId:t.journalId,parentEntityId:null!==(d=n.parentEntityId)&&void 0!==d?d:null,created:null!==(p=n.created)&&void 0!==p?p:null,removed:n.removed,staticDataChanges:i,dataChanges:a})})})}_deleteDbEntity(e){return new Promise((t,n)=>{const r=[e];this.db.Db().run("DELETE FROM entity WHERE entityIdx = ?;",r,e=>{e?n(e):t()})})}async _deleteDbEntityRevisions(e){return new Promise((t,n)=>{const r=[e];this.db.Db().run("DELETE FROM entityRevision WHERE entityIdx = ?;",r,e=>{e?n(e):t()})})}async _deleteDbEntityRevision(e,t,n){return new Promise((r,o)=>{const i=[e,t,n,n];this.db.Db().run("DELETE FROM entityRevision\n        WHERE entityIdx = ?\n        AND journalId = ?\n        AND (revisionId = ? OR revisionPermanentId = ?);",i,e=>{e?o(e):r()})})}async _deleteDbMaterializedView(e,t,n){return new Promise((r,o)=>{const i=[e,t,n];this.db.Db().run("DELETE FROM materializedView WHERE entityIdx = ? AND journalId = ? AND revisionId = ?;",i,e=>{e?o(e):r()})})}async _createDbEntity(e){return new Promise((t,n)=>{this.db.Db().run("INSERT INTO entity(localId, permanentId, type) VALUES(?, ?, ?)",[e.localId,e.permanentId,e.type],(async function createDbEntity(e){e?n(e):t(this.lastID)}))})}async _createDbEntityRevisionJournal(e,t,n){return new Promise((r,o)=>{this.db.Db().run("INSERT INTO entityRevisionJournal(entityIdx, journalID, staticData) VALUES(?, ?, ?)",[e,t,JSON.stringify(n)],e=>e?o(e):r())})}async _updateDbEntityRevisionJournal(e,t,n){return new Promise((r,o)=>{this.db.Db().run("UPDATE entityRevisionJournal SET staticData = ? WHERE entityIdx = ? AND journalId = ?",[JSON.stringify(n),e,t],e=>e?o(e):r())})}async _deleteDBEntityRevisionJournal(e,t){return new Promise((n,r)=>{this.db.Db().run("DELETE FROM entityRevisionJournal WHERE entityIdx = ? AND journalId = ?",[e,t],e=>e?r(e):n())})}async _getDbEntityRevisionJournal(e,t,n=!1){let r;return r=n?`\n      ${c}\n      SELECT * FROM (\n        SELECT * FROM entityRevisionJournal as erj\n        INNER JOIN (SELECT * FROM lineage) as j ON (j.journalId = erj.journalId)\n        INNER JOIN entityRevision as er ON (erj.journalId = er.journalId AND er.entityIdx = erj.entityIdx)\n        WHERE erj.entityIdx = ?\n        ORDER BY j.journalOrder ASC\n      )\n      GROUP BY entityIdx\n      `:"SELECT * FROM entityRevisionJournal WHERE journalId = ? AND entityIdx = ?",new Promise((n,o)=>{this.db.Db().get(r,[t,e],(e,t)=>{e?o(e):n(t)})})}async _createDbRelationship(e){return new Promise((t,n)=>{this.db.Db().run("INSERT INTO relationship(entityIdx, toEntityId, toRevisionId, fromEntityId, fromRevisionId)\n        VALUES(?, ?, ?, ?, ?)",[e.entityIdx,e.toEntityId,e.toRevisionId,e.fromEntityId,e.fromRevisionId],r=>{r?n(r):t(e.entityIdx)})})}async _updateDbRelationship(e,t){return new Promise((n,r)=>{this.db.Db().run("UPDATE relationship SET toEntityId = ?, toRevisionId = ?,\n          fromEntityId = ?, fromRevisionId = ? where entityIdx = ?",[t.toEntityId,t.toRevisionId,t.fromEntityId,t.fromRevisionId,e],o=>{o?r(o):n({entityIdx:e,toEntityId:t.toEntityId,toRevisionId:t.toRevisionId,fromEntityId:t.fromEntityId,fromRevisionId:t.fromRevisionId})})})}async _getDbRelationships(e,t,n,r,o){return new Promise((i,s)=>{let u="";const l=a.SqliteUtils.filtersToSQL(o,{mappingFields:{staticData:"entityRevisionJournal.staticData",data:"materializedView.data"}});l&&(u=` AND ( ${l} )`);const d=[n,e.entityLocalId,e.entityPermanentId];t&&d.push(t);let p="";"in"===r.direction?(p+="relationship.toEntityID IN (?, ?) ",p+=t?" AND relationship.toRevisionId = ? ":""):(p+="relationship.fromEntityID IN (?, ?) ",p+=t?" AND relationship.fromRevisionId = ? ":"");let h="",m="";r.fetchTipRelationshipData&&(h="INNER JOIN materializedView ON (\n                    entityRevision.revisionId = materializedView.revisionId AND\n                    entityRevision.journalId = materializedView.journalId AND\n                    entityRevision.entityIdx = materializedView.entityIdx)",m=",materializedView.data,\n                                      materializedView.parentEntityId");const y=`\n        ${c}\n        SELECT  entity.entityIdx,\n                entity.localId AS entityId,\n                entity.permanentId AS entityPermanentId,\n                MAX(entityRevision.revisionDate) AS revisionDate,\n                entityRevision.revisionId,\n                entityRevision.revisionPermanentId,\n                entity.type,\n                entityRevision.removed,\n                relationship.fromEntityId,\n                relationship.fromRevisionId,\n                relationship.toEntityId,\n                relationship.toRevisionId,\n                entityRevisionJournal.staticData\n                ${m}\n        FROM    entity INNER JOIN relationship ON (entity.entityIdx = relationship.entityIdx)\n                  INNER JOIN entityRevision ON (entity.entityIdx =  entityRevision.entityIdx)\n                  INNER JOIN (SELECT * FROM lineage) AS journal ON (entityRevision.journalId = journal.journalId)\n                  INNER JOIN entityRevisionJournal ON (\n                      entityRevisionJournal.entityIdx = entityRevision.entityIdx AND\n                      entityRevisionJournal.journalId = entityRevision.journalId)\n                  ${h}\n        WHERE   ${p} ${u}\n        GROUP BY entity.entityIdx\n        ORDER BY journal.journalOrder ASC, entityRevision.revisionDate DESC\n      `;this.db.Db().all(y,d,(e,t)=>{e?s(e):i(t)})})}_queryDBEntities(e,t){return new Promise((n,o)=>{var i,s;const u={entityId:"localId",entityPermanentId:"permanentId"},l=a.SqliteUtils.filtersToSQL(t.filters,Object.assign(Object.assign({},{nullableFields:["entityPermanentId","revisionPermanentId","parentEntityId"]}),{mappingFields:u,allowedFields:r.AllowedEntityFilterFields})),d=a.SqliteUtils.sortToSQL(t.sort,{mappingFields:u,allowedFields:r.AllowedEntityFilterFields});let p=l?[l]:[];!a.SqliteUtils.getFiltersFields(t.filters).includes("removed")&&(p=["removed = 0",...p]);const h=`\n        ${c}\n        SELECT\n          e.type, e.localId, e.permanentId, e.entityIdx,\n          mv.data, mv.removed, mv.revisionId, mv.parentEntityId,\n          erj.staticData,\n          er.revisionPermanentId\n        FROM (\n          SELECT * FROM (\n            SELECT rv.entityIdx, rv.revisionPermanentId, rv.revisionId as revId, rv.journalId\n            FROM entityRevision rv, lineage AS j\n            WHERE rv.journalId = j.journalId\n            ORDER BY j.journalOrder ASC, rv.revisionDate DESC\n          ) GROUP BY entityIdx\n        ) AS er\n        INNER JOIN entity e ON (e.entityIdx = er.entityIdx)\n        INNER JOIN materializedView mv ON (\n          mv.entityIdx = e.entityIdx AND mv.journalId = er.journalId AND mv.revisionId = er.revId\n        )\n        INNER JOIN entityRevisionJournal erj ON (erj.entityIdx = e.entityIdx AND erj.journalId = mv.journalId)\n        WHERE ${p.join(" AND ")}\n        ${d?"ORDER BY "+d:""}\n        LIMIT ?, ?\n      `,m=[e,null!==(i=t.offset)&&void 0!==i?i:r.PaginationConstants.OFFSET,null!==(s=t.limit)&&void 0!==s?s:r.PaginationConstants.LIMIT];this.db.Db().all(h,m,(e,t)=>{e?o(e):n(t)})})}async _getDbEntities(e,t){const n=i.chunk(t,200),r=[];for(const t of n){const n=await this._getDbEntitiesChunk(e,t);r.push(...n)}return Promise.resolve(r)}async _getDbEntitiesChunk(e,t){if(!t.length)return[];const n=[],o=[],i=[],s=[];for(const e of t){if(!e)throw new r.StoreError(r.ErrorCode.L5_GEN_INVALID_VALUE,"entityIds");const{entityId:t,revisionId:a}="string"==typeof e?{entityId:e}:e;a?(n.push("((localId = ? OR permanentId = ?) AND (revisionId = ? OR revisionPermanentId = ?))"),i.push("((localId = ? OR permanentId = ?) AND (revisionId = ? OR revisionPermanentId = ?))"),o.push(t,t,a,a),s.push(t,t,a,a)):(n.push("(localId = ? OR permanentId = ?)"),o.push(t,t),i.push("((localId = ? OR permanentId = ?) AND revisionRank = 1)"),s.push(t,t))}const a=`${c}\nSELECT entityIdx, type, localId, permanentId,\n       journalId, staticData,\n       revisionId, revisionPermanentId,\n       data, mv.removed, mv.parentEntityId,\n       revisionRank\nFROM (\n  SELECT *, \n         row_number() OVER(PARTITION BY entityIdx ORDER BY journalOrder ASC, rv.revisionDate DESC, rv.rowid DESC) \n    as revisionRank\n  FROM entity\n    INNER JOIN entityRevisionJournal USING (entityIdx)\n    INNER JOIN lineage USING (journalId)\n    INNER JOIN entityRevision rv USING (entityIdx, journalId)\n  WHERE ${n.join(" OR ")}\n) INNER JOIN materializedView mv using (entityIdx, journalId, revisionId)\nWHERE ${i.join(" OR ")}`;return new Promise((t,n)=>this.db.Db().all(a,[e,...o,...s],(e,r)=>{e?n(e):t(r)}))}async _getDbJournalEntities(e){return new Promise((t,n)=>this.db.Db().all("\n        SELECT *\n        FROM\n        (\n          SELECT e.entityIdx, e.type, e.localId, e.permanentId,\n                mv.data, mv.removed, mv.revisionId, mv.parentEntityId,\n                erj.staticData, rv.revisionPermanentId,\n                row_number() OVER(PARTITION BY e.entityIdx ORDER BY rv.revisionDate DESC) as revOrder\n          FROM entity e\n            INNER JOIN entityRevision rv ON e.entityIdx = rv.entityIdx\n            INNER JOIN materializedView mv ON rv.revisionId = mv.revisionId AND mv.entityIdx = rv.entityIdx\n            INNER JOIN entityRevisionJournal erj ON e.entityIdx = erj.entityIdx AND mv.journalId = mv.journalId\n          WHERE rv.journalId = ?\n        )\n        WHERE revOrder = 1\n    ",[e],(e,r)=>e?n(e):t(r)))}async _getDbEntityByIdxAtRevision(e,t,n){return new Promise((r,o)=>this.db.Db().get("\n        SELECT\n          e.entityIdx, e.type, e.localId, e.permanentId,\n          mv.data, mv.removed, mv.revisionId, mv.parentEntityId,\n          erj.staticData, rv.revisionPermanentId\n        FROM entity e\n          INNER JOIN entityRevision rv ON e.entityIdx = rv.entityIdx\n          INNER JOIN materializedView mv ON rv.revisionId = mv.revisionId AND mv.entityIdx = rv.entityIdx\n          INNER JOIN entityRevisionJournal erj ON e.entityIdx = erj.entityIdx AND mv.journalId = mv.journalId\n        WHERE rv.journalId = ? AND e.entityIdx = ? AND rv.revisionId = ?\n    ",[e,t,n],(e,t)=>e?o(e):r(t)))}async _getDbRelationshipByIdxAtRevision(e,t,n){return new Promise((r,o)=>this.db.Db().get("\n        SELECT\n          e.entityIdx, e.type, e.localId, e.permanentId,\n          r.toEntityId, r.toRevisionId, r.fromEntityId, r.fromRevisionId,\n          mv.data, mv.removed, mv.revisionId, mv.parentEntityId,\n          erj.staticData, rv.revisionPermanentId\n        FROM entity e\n          INNER JOIN relationship r ON e.entityIdx = r.entityIdx\n          INNER JOIN entityRevision rv ON e.entityIdx = rv.entityIdx\n          INNER JOIN materializedView mv ON rv.revisionId = mv.revisionId AND mv.entityIdx = rv.entityIdx\n          INNER JOIN entityRevisionJournal erj ON e.entityIdx = erj.entityIdx AND mv.journalId = mv.journalId\n        WHERE rv.journalId = ? AND e.entityIdx = ? AND rv.revisionId = ?\n    ",[e,t,n],(e,t)=>e?o(e):r(t)))}async _getDbRelationshipByIdx(e){return new Promise((t,n)=>{this.db.Db().get("SELECT * from relationship where entityIdx = ?",[e],async(e,r)=>{e?n(e):t(r)})})}async _getRelationshipByIdxJournalAndRevision(e,t,n){var o;const i=await this._getDbRelationshipByIdxAtRevision(t,e,n);if(!i)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,"Relationship with the given ID does not exist in the entity store.");return SqliteEntityStore.toModelRelationship(Object.assign(Object.assign({},i),{staticData:JSON.parse(i.staticData)}),{parentEntityId:i.parentEntityId,revisionId:i.revisionId,revisionPermanentId:null!==(o=i.revisionPermanentId)&&void 0!==o?o:null,removed:i.removed},i.data?JSON.parse(i.data):void 0,{entityId:i.toEntityId,revisionId:i.toRevisionId},{entityId:i.fromEntityId,revisionId:i.fromRevisionId})}async _getRelationshipByIdx(e){return new Promise((t,n)=>{this.db.Db().get("SELECT * from relationship where entityIdx = ?",[e],(e,r)=>{e?n(e):t(r)})})}_updatePermanentId(e,t){return new Promise((n,r)=>{this.db.Db().run("UPDATE entity\n        SET permanentId = ?\n        WHERE localId = ?",[t,e],e=>{e?r(e):n()})}).then(()=>a.SqliteUtils.getEntityFromEntityId(this.db.Db(),t)).then(e=>e)}async _createDbMaterializedView(e){return new Promise((t,n)=>{const r=[e.entityIdx,e.journalId,e.revisionId,e.removed,e.parentEntityId,JSON.stringify(e.data)];this.db.Db().run("INSERT INTO materializedView(entityIdx, journalId, revisionId, removed, parentEntityId, data)\n                  VALUES (?, ?, ?, ?, ?, ?);",r,e=>{e?n(e):t()})})}async _getLastMaterializedView(e,t){const n=`\n      ${c}\n      SELECT * FROM (\n        SELECT mv.* FROM materializedView mv\n          INNER JOIN (SELECT * FROM lineage) as j ON (j.journalId = mv.journalId)\n          INNER JOIN entityRevision mvEr ON mv.entityIdx = mvEr.entityIdx\n            AND mv.revisionId = mvEr.revisionId\n          WHERE mvEr.entityIdx = ?\n          ORDER BY j.journalOrder ASC, mvEr.revisionDate DESC LIMIT 1)`;return new Promise((r,o)=>{this.db.Db().get(n,[t,e],(e,t)=>{e?o(e):r(t)})})}async _getMaterializedView(e,t,n){return new Promise((r,o)=>{const i=[e,t,n,n];this.db.Db().get("SELECT mv.* FROM materializedView mv\n        INNER JOIN entityRevision er\n          ON mv.entityIdx = er.entityIdx\n            AND mv.journalId = er.journalId\n            AND mv.revisionId = er.revisionId\n        WHERE er.entityIdx = ?\n          AND er.journalId = ?\n          AND (er.revisionId = ? OR er.revisionPermanentId = ?)",i,(e,t)=>{e?o(e):r(t)})})}async getEntityIds(e,t){const n=await a.SqliteUtils.getEntityFromEntityId(this.db.Db(),e);if(!n)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST,`Entity with ID ${e} does not exist in the entity store.`);let o;if(t){const{journalId:e,revisionId:i}=t;if(o=await this._getDbEntityRevision(n.entityIdx,e,i),!o)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_EXIST,`No revision with ID ${i} found for entity with ID ${n.localId}.`)}return Object.assign({entityLocalId:n.localId,entityPermanentId:n.permanentId?n.permanentId:void 0},o&&{revisionLocalId:o.revisionId,revisionPermanentId:o.revisionPermanentId?o.revisionPermanentId:void 0})}async _getDbEntityRevision(e,t,n){return new Promise((r,o)=>{let i="SELECT * FROM entityRevision\n        WHERE entityIdx = ?\n          AND journalId = ?";const s=[e,t];n&&(s.push(n),s.push(n),i+="AND (revisionId = ? or revisionPermanentId = ?)"),this.db.Db().get(i,s,(e,t)=>{e?o(e):r(t)})})}async _getDbRevisionChangeRange(e,t,{afterRevisionId:n,toRevisionId:o}){if(!e)throw new r.StoreError(r.ErrorCode.L5_GEN_INVALID_VALUE,"entityIdx");if(!t)throw new r.StoreError(r.ErrorCode.L5_GEN_INVALID_VALUE,"journalId");let i,s;if(n&&(i=await this._getDbEntityRevision(e,t,n),void 0===i||i.journalId!==t))throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL,"afterRevision not in journal.");if(o&&(s=await this._getDbEntityRevision(e,t,o),void 0===s||s.journalId!==t))throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL,"toRevision not in journal.");if(i&&s&&i.revisionDate>s.revisionDate)throw new r.StoreError(r.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_IN_JOURNAL,"Specified range is reversed.");const a=[];let c="SELECT er.* FROM entityRevision er\n               WHERE er.entityIdx = ? AND er.journalId = ? ";return a.push(e),a.push(t),i&&(c+=" AND ? < er.revisionDate ",a.push(i.revisionDate)),s&&(c+=" AND ? >= er.revisionDate ",a.push(s.revisionDate)),c+=" ORDER BY er.revisionDate ASC",new Promise((e,t)=>{this.db.Db().all(c,a,(n,r)=>{n?t(n):e(r)})})}async clearLocalStore(){await this.db.deleteEntityTables()}async transferRevisions(e,t){if(e===t)throw new r.StoreError(r.ErrorCode.L5_JOURNAL_STORE_TRANSFER_CONFLICT,"Source journal cannot be the same as the target journal.");if(!await a.SqliteUtils.doesJournalsExist(this.db.Db(),e,t))throw new r.StoreError(r.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`sourceJournalId, journal with ID ${e}\n        and/or targetJournalId ID ${t} do not exist in the journal store.`);return new Promise((n,r)=>this.db.Db().run("UPDATE OR REPLACE entityRevisionJournal SET journalId = ? WHERE journalId = ?",[t,e],e=>e?r():n()))}async _isEntityModifiedLocally(e){return new Promise((t,n)=>{this.db.Db().get("SELECT 1 FROM entityRevision er\n                        INNER JOIN journal j ON er.journalId = j.journalId\n                        WHERE entityIdx = ? AND j.role IN ('isolation','main','staging')",[e],(e,r)=>{e?n(e):t(!!r)})})}async _getJournalLineage(e){const t=`\n      ${c}\n      SELECT lineage.journalId\n      FROM lineage\n      ORDER BY lineage.journalOrder ASC`;return new Promise((n,r)=>{this.db.Db().all(t,[e],(e,t)=>{if(e)r(e);else{const e=t.map(e=>e.journalId);n(e)}})})}}t.SqliteEntityStore=SqliteEntityStore},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SqliteJournalStore=void 0;const o=n(19),i=r(n(46)),s=n(552),a=n(85),c=n(153),u=n(250);class SqliteJournalStore{constructor(e){this.db=e}async createJournal(e){if(e.journalId){if(await u.SqliteUtils.doesJournalExist(this.db.Db(),e.journalId))throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_JOURNAL_ALREADY_EXIST,`A journal with ID ${e.journalId} already exists in the journal store.`)}if(e.parentJournalId){if(!await u.SqliteUtils.doesJournalExist(this.db.Db(),e.parentJournalId))throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_PARENT_JOURNAL_NOT_EXIST,`A parent journal with ID ${e.parentJournalId} does not exist in the journal store.`)}if(e.collectionId&&!["isolation","staging"].includes(e.role)){const t=await this.hasDbJournalForThisRoleInSet(e.collectionId,e.role);i.default(!t)}const t=await this.createDbJournal(e);if(!t)throw new a.StoreError(a.ErrorCode.UNKNOWN,"Unknown error occurs when trying to create the journal.");return this.toJournalData(t)}async getJournal(e){const t=await this.getDbJournal(e);if(!t)throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`A journal with ID ${e} does not exist in the journal store.`);return this.toJournalData(t)}async getJournalSet(e,t){const n=[];let r,o=await this.getDbRemoteAndMainJournalsByCollection(e);if(o.forEach(e=>{var t;const o=this.toJournalData(e);"remote"===o.role&&(r=null!==(t=e.syncToken)&&void 0!==t?t:void 0),n.push(o)}),o=await this.getDbIsolationJournalsByCollectionAndFilters(e,t),o.forEach(e=>{const t=this.toJournalData(e);n.push(t)}),0!==n.length)return{serverSyncToken:r,mainJournal:n.find(e=>"main"===e.role),remoteJournal:n.find(e=>"remote"===e.role),isolationJournals:n.filter(e=>"isolation"===e.role)}}async updateJournalSet(e,t){var n;const r=await this.getJournalSet(e);if(!r||!r.remoteJournal)throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_COLLECTION_NOT_EXIST,`The remote journal with ID ${e} does not exist in the journal store.`);const o=await this.updateSyncToken(r.remoteJournal.journalId,t.serverSyncToken);return r.serverSyncToken=null!==(n=o.syncToken)&&void 0!==n?n:void 0,r}async updateJournal(e,t={properties:{}}){if(!await u.SqliteUtils.doesJournalExist(this.db.Db(),e))throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`A journal with ID ${e} does not exist in the journal store.`);if(t.parentJournalId){if(!await u.SqliteUtils.doesJournalExist(this.db.Db(),t.parentJournalId))throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_PARENT_JOURNAL_NOT_EXIST,`A parent journal with ID ${t.parentJournalId} does not exist in the journal store.`)}const n=await this.updateDbJournal(e,Object.assign({},t));if(!n)throw new a.StoreError(a.ErrorCode.UNKNOWN,"Unknown error ocurrs when trying to update the journal.");return this.toJournalData(n)}async deleteJournal(e){if(!await u.SqliteUtils.doesJournalExist(this.db.Db(),e))throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`A journal with ID ${e} does not exist in the journal store.`);return this.deleteDbJournal(e)}async getJournalsByParent(e){return(await this.getDbJournalsByParent(e)).map(e=>this.toJournalData(e))}async addCommandToJournal(e,t){if(!await u.SqliteUtils.doesJournalExist(this.db.Db(),e))throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`A journal with ID ${e} does not exist in the journal store.`);if(t.commandId&&await u.SqliteUtils.doesCommandExist(this.db.Db(),t.commandId))throw new a.StoreError(a.ErrorCode.L5_GEN_DUPLICATE_ID,`Command with ID ${t.commandId} already exists.`);const n=await this.createDbCommand(e,t);if(!n)throw new a.StoreError(a.ErrorCode.UNKNOWN,"Unknown error ocurrs when trying to create the command.");const r=t.dependsOn.map(async e=>this.createDbCommandDependency(n.commandId,e));return await Promise.all(r),n.dependsOn=t.dependsOn,SqliteJournalStore.toCommandData(n)}async getJournalCommands(e,t){if(!await u.SqliteUtils.doesJournalExist(this.db.Db(),e))throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`A journal with ID ${e} does not exist in the journal store.`);let n,r=!0;t&&t.fields?(n=c.cloneDeep(t.fields),n.includes("commandId")||(r=!1,n.push("commandId"))):n=["journalId","commandId","commandName","status","modifiedDate","parameters","dependsOn"];const i=await this._getDbCommandsAndDependenciesData(e,n,t&&t.filters?t.filters:{});r||(n=n.filter(e=>"commandId"!==e));const s=new Map;return i.forEach(e=>{if(!s.has(e.commandId)){const t=c.pick(e,n.filter(e=>"modifiedDate"!==e));let r;r=n.includes("modifiedDate")?Object.assign(Object.assign({},t),{modifiedDate:new Date(e.modifiedDate)}):t,n.includes("parameters")&&(r.parameters=JSON.parse(e.parameters||"{}")),n.includes("status")&&(r.status=o.CommandStatus[e.status.toUpperCase()]),s.set(e.commandId,r)}}),Array.from(s.values())}async clearJournalCommands(e){if(!await u.SqliteUtils.doesJournalExist(this.db.Db(),e))throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`A journal with ID ${e} does not exist in the journal store.`);await this.clearDbJournal(e)}async getCommand(e){const t=await this.getDbCommandById(e);if(!t)throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,`Command with ID '${e}' does not exist.`);return SqliteJournalStore.toCommandData(t)}async updateCommand(e,t){const n=await this.updateDbCommand(e,t);if(!n)throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,`Command with ID '${e}' does not exist.`);return SqliteJournalStore.toCommandData(n)}async addCommandInputEntities(e,t){if(!await u.SqliteUtils.doesCommandExist(this.db.Db(),e))throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,`Command with ID '${e}' does not exist.`);return await this.addDbInputEntityIds(e,t),(await this.getDbCommandInputEntityIds(e)).map(String)}async getCommandInputEntities(e){if(!await u.SqliteUtils.doesCommandExist(this.db.Db(),e))throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,`Command with ID '${e}' does not exist.`);return(await this.getDbCommandInputEntityIds(e)).map(String)}async getCommandModifiedEntities(e){if(!await u.SqliteUtils.doesCommandExist(this.db.Db(),e))throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,`Command with ID '${e}' does not exist.`);return this.getDbCommandModifiedEntities(e)}getCommandLocalIdStore(e){return this.getDbCommandLocalIdStore(e)}async setCommandLocalIdStore(e,t){if(!await u.SqliteUtils.doesCommandExist(this.db.Db(),e))throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,`Command with ID '${e}' does not exist.`);return this.setDbCommandLocalIdStore(e,t)}toJournalData(e){const t={journalId:e.journalId,role:e.role,collectionId:e.collectionId?e.collectionId:"",parentJournalId:null,properties:JSON.parse(e.properties)};return e.parentJournalId&&(t.parentJournalId=e.parentJournalId),t}static toCommandData(e){var t,n,r;const i=JSON.parse(e.parameters||"{}");return{commandId:e.commandId,journalId:e.journalId,commandName:e.commandName,parameters:i,status:o.CommandStatus[e.status.toUpperCase()],dependsOn:(null===(t=e.dependsOn)||void 0===t?void 0:t.map(String))||[],inputEntities:(null===(n=e.inputEntities)||void 0===n?void 0:n.map(String))||[],modifiedEntities:(null===(r=e.modifiedEntities)||void 0===r?void 0:r.map(String))||[],modifiedDate:new Date(e.modifiedDate)}}createDbJournal(e){const t=e.journalId||s.nanoid(),{role:n}=e,r=e.parentJournalId?e.parentJournalId:null,o=e.collectionId?e.collectionId:null,i=e.properties?JSON.stringify(e.properties):{};return new Promise((e,s)=>{const a=[t,r,n,o,i];this.db.Db().run("INSERT INTO journal(journalId, parentJournalId, role, collectionId, properties)\n                  VALUES (?,?,?,?,?);",a,n=>{n?s(n):e(this.getDbJournal(t))})})}getDbJournal(e){return new Promise((t,n)=>{this.db.Db().get("SELECT * from journal where journalId = ?",[e],(e,r)=>{e?n(e):t(r)})})}getDbRemoteAndMainJournalsByCollection(e){return new Promise((t,n)=>{this.db.Db().all('SELECT * from journal WHERE collectionId = ? AND ( role = "main" OR role = "remote" )',[e],(e,r)=>{e?n(e):t(r)})})}getDbIsolationJournalsByCollectionAndFilters(e,t){let n="SELECT * from journal\n    WHERE collectionId = ? AND role = 'isolation' ";return new Promise((r,o)=>{var i,s;if(t){const c=u.SqliteUtils.filtersToSQL(t.filters,{allowedFields:a.AllowedJournalFilterFields}),l=u.SqliteUtils.sortToSQL(t.sort,{allowedFields:a.AllowedJournalFilterFields});n+=c?" AND ":" ",n+=""+(c?[c]:[]).join(" AND "),n+=` ${l?"ORDER BY "+l:""}\n        LIMIT ?, ? `;const d=[e,null!==(i=t.offset)&&void 0!==i?i:a.PaginationConstants.OFFSET,null!==(s=t.limit)&&void 0!==s?s:a.PaginationConstants.LIMIT];this.db.Db().all(n,d,(e,t)=>{e?o(e):r(t)})}else this.db.Db().all(n,[e],(e,t)=>{e?o(e):r(t)})})}getDbJournalsByParent(e){return new Promise((t,n)=>{this.db.Db().all("SELECT * from journal where parentJournalId = ?",[e],(e,r)=>{e?n(e):t(r)})})}updateDbJournal(e,t){const{parentJournalId:n,collectionId:r=null,role:o=null}=t;return new Promise((i,s)=>{this.db.Db().run("UPDATE journal SET\n      parentJournalId = COALESCE(?,parentJournalId),\n      collectionId = COALESCE(?,collectionId),\n      role = COALESCE(?,role),\n      properties = COALESCE(?,properties)\n      WHERE journalId = ?",[n,r,o,JSON.stringify(t.properties),e],t=>{t?s(t):i(this.getDbJournal(e))})})}updateSyncToken(e,t){return new Promise((n,r)=>{this.db.Db().run("UPDATE journal SET\n      syncToken = ?\n        WHERE journalId = ?",[t,e],t=>{t?r(t):n(this.getDbJournal(e))})})}createDbCommand(e,t){const n=t.commandId||s.nanoid(),r=t.status||o.CommandStatus.NOT_PROCESSED;return new Promise((o,i)=>{const s=[n,t.commandName,(new Date).toISOString(),(new Date).toISOString(),e,r,JSON.stringify(t.parameters)];this.db.Db().run("INSERT INTO command(commandId, commandName, createDate, modifiedDate, journalId, status, parameters )\n            VALUES (?,?,?,?,?,?,?);",s,e=>{e?i(e):o(this.getDbCommandById(n))})})}async updateDbCommand(e,t){return new Promise((n,r)=>{this.db.Db().run("UPDATE command SET\n      status = COALESCE(?,status),\n      modifiedDate = ?\n        WHERE commandId = ?",[t.status,(new Date).toISOString(),e],t=>{t?r(t):n(this.getDbCommandById(e))})})}async getDbCommandById(e){var t;const n=await this.getDbCommandWithoutDependencyById(e);if(!n)throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,`Command with ID '${e}' does not exist.`);const r=await this.getDbCommandDependencies(e);return n.dependsOn=null!==(t=null==r?void 0:r.map(e=>e.dependencyId))&&void 0!==t?t:[],n}getDbCommandWithoutDependencyById(e){return new Promise((t,n)=>{this.db.Db().get("SELECT * FROM command WHERE commandId = ? ",[e],(e,r)=>{e?n(e):t(r)})})}async createDbCommandDependency(e,t){return new Promise((n,r)=>{const o=[e,t];this.db.Db().run("INSERT INTO commandDependencies(commandId, dependencyId)\n            VALUES (?,?);",o,e=>{e?r(e):n()})})}getDbCommandDependencies(e){return new Promise((t,n)=>{this.db.Db().all("SELECT dependencyId FROM commandDependencies WHERE commandId = ?",[e],(e,r)=>{e?n(e):t(r)})})}async _getDbCommandsAndDependenciesData(e,t,n){const r=u.SqliteUtils.getSQLQueryFromJournalCommandFields(e,t,n);return new Promise((e,t)=>{this.db.Db().all(r.sql,r.queryParams,(n,r)=>{n?t(n):e(r.reduce((e,t)=>{var n;return(null===(n=e[e.length-1])||void 0===n?void 0:n.commandId)===t.commandId?(e[e.length-1]&&e[e.length-1].dependsOn&&t.dependsOn&&!e[e.length-1].dependsOn.some(e=>t.dependsOn.includes(e))&&e[e.length-1].dependsOn.push(t.dependsOn),e[e.length-1]&&e[e.length-1].inputEntities&&t.inputEntities&&!e[e.length-1].inputEntities.some(e=>t.inputEntities.includes(e))&&e[e.length-1].inputEntities.push(t.inputEntities),e[e.length-1]&&e[e.length-1].modifiedEntities&&t.modifiedEntities&&!e[e.length-1].modifiedEntities.some(e=>t.modifiedEntities.includes(e))&&e[e.length-1].modifiedEntities.push(t.modifiedEntities)):e.push(Object.assign(Object.assign({},t),{dependsOn:t.dependsOn?[t.dependsOn]:[],inputEntities:t.inputEntities?[t.inputEntities]:[],modifiedEntities:t.modifiedEntities?[t.modifiedEntities]:[]})),e},[]))})})}addDbInputEntityIds(e,t){return new Promise((n,r)=>{const o=((e,t)=>e.replace(/\?#/g,t.map(()=>"?").join(', "_"),(')))('INSERT OR IGNORE INTO commandInputEntity(entityId, commandId)\n                    Values (?#, "_")',t).replace(/_/g,e);this.db.Db().run(o,t,e=>{e?r(e):n()})})}getDbCommandInputEntityIds(e){return new Promise((t,n)=>{this.db.Db().all("SELECT entityId FROM commandInputEntity WHERE commandId = ?",[e],(e,r)=>{if(e)n(e);else{const e=r.map(e=>e.entityId);t(e)}})})}getDbCommandModifiedEntities(e){return new Promise((t,n)=>{this.db.Db().all("SELECT COALESCE(e.permanentId, e.localId) as entityId from entityRevision ec\n        INNER JOIN entity e ON ec.entityIdx = e.entityIdx where ec.commandId = ?",[e],(e,r)=>{if(e)n(e);else{const e=r.map(e=>e.entityId);t(e)}})})}setDbCommandLocalIdStore(e,t){return new Promise((n,r)=>{this.db.Db().run("UPDATE command SET localIdStore = ? WHERE commandId = ?",[JSON.stringify(t),e],e=>{e?r(e):n()})})}getDbCommandLocalIdStore(e){return new Promise((t,n)=>{this.db.Db().get("SELECT localIdStore FROM command WHERE commandId = ?",[e],(r,o)=>{r?n(r):o?t(o.localIdStore?JSON.parse(o.localIdStore):void 0):n(new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_COMMAND_NOT_EXIST,`Command with ID '${e}' does not exist.`))})})}clearDbJournal(e){return new Promise((t,n)=>{this.db.Db().run("DELETE FROM command WHERE journalId = ?",e,e=>{e?n(e):t()})})}deleteDbJournal(e){return new Promise((t,n)=>{this.db.Db().run("DELETE FROM journal WHERE journalId = ?",e,e=>{e?n(e):t()})})}hasDbJournalForThisRoleInSet(e,t){return new Promise((n,r)=>{this.db.Db().get("SELECT 1 FROM journal where collectionId = ? AND role = ?",[e,t],(e,t)=>{e?r(e):n(!!t)})})}async clearLocalStore(){await this.db.deleteJournalCommandTables()}async makeAllIndependentCommandsDependent(e,t){return new Promise((n,r)=>{this.db.Db().get("\n            INSERT INTO commandDependencies(commandId, dependencyId)\n            SELECT commandId, ?\n              FROM command\n              WHERE journalId = ? AND commandId NOT IN (SELECT commandId FROM commandDependencies)",[t,e],e=>{e?r(e):n()})})}async transferCommands(e,t,n){if(e===t)throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_TRANSFER_CONFLICT,"Source journal cannot be the same as the target journal.");if(!await u.SqliteUtils.doesJournalsExist(this.db.Db(),e,t))throw new a.StoreError(a.ErrorCode.L5_JOURNAL_STORE_JOURNAL_NOT_EXIST,`sourceJournalId, journal with ID ${e}\n        and/or targetJournalId ID ${t} do not exist in the journal store.`);n&&await this.makeAllIndependentCommandsDependent(e,n);const r=[t,e];return new Promise((e,t)=>this.db.Db().run("UPDATE command SET journalId = ? WHERE journalId = ?",r,n=>n?t(n):e()))}async _dbJournalLowestCommandOrderJournal(e){return new Promise((t,n)=>{this.db.Db().get("SELECT MIN(commandOrder) FROM command WHERE journalId = ?",[e],(e,r)=>{e?n(e):t(r["MIN(commandOrder)"])})})}async _dbJournalHighestCommandOrderLineage(e){return new Promise((t,n)=>{this.db.Db().get("WITH lineage AS (\n  SELECT *, 1 as journalOrder FROM journal WHERE journalId = ?\n  UNION ALL\n    SELECT j.*, journalOrder + 1\n    FROM journal j\n    JOIN lineage p ON j.journalId = p.parentJournalId\n)\n          SELECT MAX(commandOrder) FROM command INNER JOIN lineage USING (journalId)",[e],(e,r)=>{e?n(e):t(r["MAX(commandOrder)"])})})}async canBeFastForwarded(e,t){const n=await this._dbJournalHighestCommandOrderLineage(t);if(null===n)return Promise.resolve(!0);const r=await this._dbJournalLowestCommandOrderJournal(e);return null===r?Promise.resolve(!0):Promise.resolve(r>n)}}t.SqliteJournalStore=SqliteJournalStore},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(118),o=n(528),i=n(49),s=n(117);class PimStateService{constructor(){this.documents=new Map,this.enabled=!0,this.enabledReason="",this.spaceCollections={},this.journalReorderingEnabled=!0,PimStateService.instance=this}getSpaceCollection(e){return this.spaceCollections[e]||(this.spaceCollections[e]=new o.SpaceCollectionStateModel(e)),this.spaceCollections[e]}isSpaceCollectionEnabled(e){return this.getSpaceCollection(e).enabled()}isGloballyEnabled(){return this.enabled}setGlobalEnabled(e,t){this.enabled=e,this.enabledReason=t}getDocument(e){return this.documents.get(e)}isJournalReorderingEnabled(){return this.journalReorderingEnabled}setJournalReorderingEnabled(e){this.journalReorderingEnabled=e}isDocumentEnabled(e,t){if(!this.isGloballyEnabled())return!1;if(t&&!this.isSpaceCollectionEnabled(t))return!1;if(void 0===e)return!0;const n=this.getDocument(e);let r=!1;return n&&(r=n.enabled),r}addDocument(e){this.documents.set(e.id,e)}removeDocument(e){const t=this.getDocument(e);if(t)return this.documents.delete(e),t;console.info(`[PimStateService] removeDocument - Cannot find document id(${e}). Nothing to delete.`)}async disableDocument(e,t,n,r,o){if(this.setDocumentStatus(e,!1,o&&o.message),o&&(this.getDocument(e).errorMessage=o.message+"\n"+o.stack),n&&r){const o=await n.getJournals().list(t,{invariantId:e}),deleteJournalsPredicate=()=>!0;await s.cleanJournalChain(r,o,deleteJournalsPredicate)}}setDocumentStatus(e,t,n){let o=this.getDocument(e);o?!!o.enabled!=!!t&&(console.info(`[PimStateService] Setting document ${e} to status ${t} : ${n||"No reason specified"}`),o.enabled=t):o=new r.DocumentStateModel(e,t),this.addDocument(o)}getDocumentFailOperation(e){const t=this.getDocument(e);if(t)return t.failOperation;console.error(`[PimStateService] getDocumentFailOperation - Cannot find document id(${e}).`)}setDocumentFailOperation(e,t){const n=this.getDocument(e);n?(n.failOperation=t,this.addDocument(n)):console.error(`[PimStateService] setDocumentFailOperation - Cannot find document id(${e}).`)}getDocumentLastOperation(e){const t=this.getDocument(e);if(t)return t.lastOperation;console.error(`[PimStateService] getDocumentLastOperation - Cannot find document id(${e}).`)}setDocumentLastOperation(e,t){console.info(`Setting document ${e} to last operation =  ${t}`);const n=this.getDocument(e);n?(n.lastOperation=t,this.addDocument(n)):console.error(`[PimStateService] setDocumentLastOperation - Cannot find document id(${e}).`)}setMilestone(e,t){console.info(`Setting milestone for document ${e}: ${t}`);const n=this.getDocument(e);n?(n.milestone=t,this.addDocument(n)):console.log(`[PimStateService] setMilestone - Cannot find document id(${e}).`)}getMilestone(e){const t=this.getDocument(e);return t?t.milestone:(console.log(`[PimStateService] getMilestone - Cannot find document id(${e}).`),{create:!1})}state(){const e=["Global state: "+(this.enabledReason||"Enabled"),"Journal reordering "+(this.journalReorderingEnabled?"Enabled":"Disabled")];for(const t of Object.values(this.spaceCollections))e.push(`Hub id ${t.id}: ${t.state()}`);return this.documents.forEach(t=>e.push(`Document ${t.id}: ${t.enabled?"Enabled "+t.lastOperation:"Disabled "+t.failOperation} ${t.errorMessage?" - "+t.errorMessage:""}`)),e.join("\n")}}t.PimStateService=PimStateService,t.installExceptionHandlers=function installExceptionHandlers(){process.on("unhandledRejection",(function(e){console.error((new Date).toUTCString()+" unhandled Promise rejection:",e);const t={componentName:"",componentAttributes:{misc:"",extInfo:i.ReportType.UnhandledPromiseRejection},logLocation:i.LogLocation.Telemetry,logLevel:i.LogLevel.Info};e?e instanceof Error?(t.componentName=e.name,t.componentAttributes.misc=e.message,t.componentAttributes.stack=e.stack):(t.componentName=typeof e,t.componentAttributes.misc="Reason: "+e.toString()):t.componentName="Undefined reason",i.reportTelemetry(t),PimStateService.instance.setGlobalEnabled(!1,"Unhandled Promise Rejection "+e)})),process.on("uncaughtException",(function(e){console.error((new Date).toUTCString()+" uncaughtException:",e),console.error(e.stack),i.reportTelemetry({componentName:e.name,componentAttributes:{extInfo:i.ReportType.UncaughtException,misc:e.message,stack:e.stack},logLocation:i.LogLocation.Telemetry,logLevel:i.LogLevel.Warning}),PimStateService.instance.setGlobalEnabled(!1,"Uncaught Exception: "+(e.message||e))})),console.info("Global exception handler installed")}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(62)),i=n(495),s=n(251),a=n(49);var c;!function(e){e.HUB="HUB",e.LINEAGE="LINEAGE"}(t.MigrationType||(t.MigrationType={})),function(e){e.SUCCESS="SUCCESS",e.PENDING="PENDING",e.STARTED="STARTED",e.ERROR="ERROR",e.COMPLETE="COMPLETE"}(c=t.JobStatus||(t.JobStatus={})),t.X_ADS_WIP_URN_HEADER="x-ads-wip-urn",t.X_REQUEST_ID="x-request-id",t.X_ADS_UL_CTX_WORKFLOW_ID="x-ads-ul-ctx-workflow-id";async function getMigrationJobStatus(e){try{return(await o.default({method:"GET",url:`${e.baseServerUrl}/v1/jobs/${e.jobId}`,headers:{Authorization:"Bearer "+e.bearerToken},params:{lineageurn:e.wipLineageUrn}})).data}catch(t){console.log(`[triggerLineageMigration] An error occurred getting the status of migration ${e.jobId} for ${e.wipLineageUrn}`)}return{}}async function monitorMigration(e,t){let n=c.PENDING;const r=Date.now()+3e5,o=Date.now();for(;Date.now()<r&&![c.ERROR,c.SUCCESS,c.COMPLETE].includes(n);){await s.sleep(5e3);const r=await getMigrationJobStatus(Object.assign(Object.assign({},t),{jobId:e}));r.status&&(n=r.status)}if(![c.SUCCESS,c.COMPLETE].includes(n))throw a.reportTelemetry({componentName:"triggerLineageMigration",componentAttributes:{extInfo:a.ReportType.MigrationError,misc:`Migration error (Was triggered because ${t.reason})`,jobId:e,duration:Date.now()-o,lineageUrn:t.wipLineageUrn,status:""+n},logLocation:a.LogLocation.All,logLevel:a.LogLevel.Warning}),new Error(`[triggerLineageMigration]: Job ${e} / Lineage ${t.wipLineageUrn} failed: ${n}.`);a.reportTelemetry({componentName:"triggerLineageMigration",componentAttributes:{extInfo:a.ReportType.MigrationComplete,misc:`Migration complete (Was triggered because ${t.reason})`,duration:Date.now()-o},logLocation:a.LogLocation.All,logLevel:a.LogLevel.Info})}function _getXRequestIdForMigration(e){const t=e.migrationContext?e.migrationContext:"defaultContext",n=i.uuid();let r;return r=e.requestId?e.requestId:`f360_fremontJs-${t}_${n}`,r}t.getMigrationJobStatus=getMigrationJobStatus,t.monitorMigration=monitorMigration,t.triggerMigrationJob=async function triggerMigrationJob(e,n,r,i){let c="";try{await s.retry(async()=>{const s=_getXRequestIdForMigration(i);console.log(`[triggerMigration] Triggering ${i.migrationType} migration of ${i.WIPUrn} with x-request-id set to `+s);const u=await o.default({method:"POST",url:e+"/v1/jobs",headers:{Authorization:"Bearer "+n,[t.X_ADS_WIP_URN_HEADER]:i.WIPUrn,[t.X_REQUEST_ID]:s},data:Object.assign({spaceCollectionId:r},i)});if(!u.data||!u.data.jobId)throw console.info(`[triggerMigration] Migration request error xRequestId = ${s}: ${u}`),a.reportTelemetry({componentName:"triggerMigration",componentAttributes:{extInfo:a.ReportType.MigrationError,misc:"Migration request failed",response:""+u},logLocation:a.LogLocation.All,logLevel:a.LogLevel.Warning}),new Error(`Migration request failed for xRequestId = ${s}: ${u}`);a.reportTelemetry({componentName:"triggerMigration",componentAttributes:{extInfo:a.ReportType.MigrationTriggered,misc:"Triggered Migration request",response:""+u},logLocation:a.LogLocation.Console,logLevel:a.LogLevel.Info}),console.log(`[triggerMigration] Triggered ${i.migrationType} migration ${u.data.jobId} for ${i.WIPUrn} with x-request-id set to ${s}`),c=u.data.jobId},{retries:3})}catch(e){console.info(e.message)}return c},t.triggerLineageMigration=async function triggerLineageMigration(e){if(e.testing)return console.log(`Will not trigger lineage migration for ${e.wipLineageUrn} because we are testing`),"";let n="";try{await s.retry(async()=>{const r=_getXRequestIdForMigration(e);console.log(`[triggerLineageMigration] Triggering migration of lineage ${e.wipLineageUrn}, xRequestId = ${r}: ${e.reason}`),await s.sleep(3e3);const i=await o.default({method:"POST",url:e.baseServerUrl+"/v1/lineage",headers:{Authorization:"Bearer "+e.bearerToken,[t.X_ADS_WIP_URN_HEADER]:e.wipLineageUrn,[t.X_REQUEST_ID]:r},data:{spaceCollectionId:e.spaceCollection,lineageUrn:e.wipLineageUrn}});if(!i.data||!i.data.jobId)throw console.info(`[triggerMigration] Migration request error xRequestId = ${r}: ${i}`),a.reportTelemetry({componentName:"triggerLineageMigration",componentAttributes:{extInfo:a.ReportType.MigrationError,misc:`Migration request failed  (because ${e.reason})`,response:""+i},logLocation:a.LogLocation.Telemetry,logLevel:a.LogLevel.Warning}),new Error(`Migration request failed xRequestId = ${r}: ${i}`);if(a.reportTelemetry({componentName:"triggerLineageMigration",componentAttributes:{extInfo:a.ReportType.MigrationTriggered,misc:`Triggered Migration request (because ${e.reason})`,response:""+i},logLocation:a.LogLocation.Telemetry,logLevel:a.LogLevel.Warning}),console.log(`[triggerLineageMigration] Triggered lineage migration (jobId = ${i.data.jobId} ;  xRequestId = ${r})for ${e.wipLineageUrn} (${e.reason})`),n=i.data.jobId,e.shouldMonitor){const t=monitorMigration(n,e).catch(e=>{console.info(e.message)});e.waitCompletion&&await t}},{retries:3})}catch(e){console.info(e.message)}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(1266))},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(1267)),__export(n(540)),__export(n(541)),__export(n(542)),__export(n(1282)),__export(n(1283)),__export(n(1284)),__export(n(1285)),__export(n(1286)),__export(n(1287)),__export(n(1288)),__export(n(1289)),__export(n(1290)),__export(n(1291)),__export(n(1292)),__export(n(252)),__export(n(1293)),__export(n(1294)),__export(n(1295)),__export(n(253))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.get=(e,t,n)=>{if(!t)return;return(Array.isArray(t)?t:t.split(/[,[\].]/g).filter(Boolean)).reduce((e,t)=>e&&e[t],e)||n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(44),o=n(119),i=n(5),s=n(53),a=n(92),c=n(72),u=n(49),l=n(0);async function validateCanUsePimForDocumentSave(e){const t=await i.getOrCreateSdkInstance(e.context,e.options);if(!t)throw new Error("[documentSaved]: No SDKInstance found. Cannot validate if PIM is available.");const n=await e.options.documentIdentityService.generateInvariantId(e.context,e.options,e.data.docId,e.data.lineageUrn);if(!n)return console.log("[documentSaved]: Cannot find invariantId for saved design, so cannot check if PIM is usable"),!1;if(!e.data.previousWipVersionUrn||!e.data.lineageUrn)return!0;if(e.data.queuedMultiVersion)return console.log(`[documentSaved]: There are multiple versions queued for ${n}. Will not perform save.`),!1;const r=await i.selectJournal(t,l.JournalType.MAIN);let o=await r.pimFindRootItemAndVersionSnapshot(e.context.spaceCollectionId,e.data.previousWipVersionUrn);if(o)return e.options.pimStateService.setDocumentStatus(n,!0,"Previous WIP version URN found in PIM"),!0;{const r=await i.selectJournal(t,l.JournalType.REMOTE);if(o=await r.pimFindRootItemAndVersionSnapshot(e.context.spaceCollectionId,e.data.previousWipVersionUrn),!o)return console.log(`[documentSaved]: There is no remote snapshot for the previous ${e.data.previousWipVersionUrn} of ${n}. Will not perform save.`),!1;e.options.pimStateService.setDocumentStatus(n,!0,"Previous WIP version URN found in PIM"),console.log(`[documentSaved]: Found snapshot for ${e.data.previousWipVersionUrn} of ${n}. Will attempt document sync before save.`);try{return await i.documentRootSync(t.pimsdk,e.context.spaceCollectionId,o.rootItem),!0}catch(e){throw u.reportTelemetry({componentName:"documentSaved",componentAttributes:{extInfo:u.ReportType.SyncFailure,misc:"Failed to sync on save"},logLocation:u.LogLocation.All,logLevel:u.LogLevel.Warning}),new Error("[documentSaved] Failed syncing when PIM should have been available on save")}}}async function documentDisabledPostSaveExecutor(e){let t={};if(!await validateCanUsePimForDocumentSave(e))throw new Error("[documentSaved]: Cannot use PIM for the document");const n=await i.getOrCreateSdkInstance(e.context,e.options);if(!n)throw new Error("[documentSaved]: No SDKInstance found. Cannot handle event.");return t=await o.onPostSave(e.context,n,e.data),console.log(`[documentSaved] has finished for ${t.invariantId} version ${t.localFileVersion}`),t}async function designPostSaveExecutor(e){let t={};if(console.log("[documentSaved]: Received event"),!e.options||!await i.getJournalService(e.context,e.options))throw console.error("[documentSaved]: Journaling service is not defined. Cannot handle event."),new Error("[documentSaved]: Journaling service is not defined. Cannot handle event.");if(!await validateCanUsePimForDocumentSave(e))throw new Error("[documentSaved]: Cannot use PIM for the document");const n=await i.getOrCreateSdkInstance(e.context,e.options);if(!n)throw new Error("[documentSaved]: No SDKInstance found. Cannot handle event.");return t=await o.onPostSave(e.context,n,e.data),console.log(`[documentSaved] has finished for ${t.invariantId} version ${t.localFileVersion}`),t}t.validateCanUsePimForDocumentSave=validateCanUsePimForDocumentSave,t.documentDisabledPostSaveExecutor=documentDisabledPostSaveExecutor,t.documentSavedHandler=async function documentSavedHandler(e,t,n){const o=e.spaceCollectionId,i=await t.documentIdentityService.generateInvariantId(e,t,n.docId,n.lineageUrn);c.updateDocumentLastOperation("documentSaved",i,t.pimStateService,s.DocumentOperationState.SAVING);const u=r.queueFremontCommand(e,t,designPostSaveExecutor,{scId:o,data:n,context:e,options:t,lineageUrn:n.lineageUrn,docId:n.docId},{documentDisabledExecutor:documentDisabledPostSaveExecutor});return a.invokeStateHandler("documentSaved",s.DocumentOperationState.SAVED,e,t,u,i).catch(e=>{console.log(`[documentSaved]: Failed while trying to update state for\n       document id: ${i}. Error - `,e)}),u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),o=n(252);t.designUploadedHandler=async function designUploadedHandler(e,t,n){return await o.queueDocumentUploaded(e,t,n,r.DOCUMENT_TYPE.Design)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),o=n(253);t.preDesignUploadHandler=async function preDesignUploadHandler(e,t,n){return await o.queuePreDocumentUpload(e,t,n,r.DOCUMENT_TYPE.Design)}},function(e,t,n){"use strict";const r=n(20),o=n(45),i=n(120),s=n(254),a=n(1324),c=n(50),u=n(544),l={alternatives:n(547),array:n(1325),boolean:n(1326),binary:n(1327),date:n(548),func:n(1328),number:n(1330),object:n(549),string:n(1331),symbol:n(1336),callWithDefaults:function(e,t){return r.assert(this,"Must be invoked on a Joi instance."),this._defaults&&(e=this._defaults(e)),e._currentJoi=this,e._init(...t)},root:function(){const e=new o,t=e.clone();return o.prototype._currentJoi=t,t._currentJoi=t,t._binds=new Set(["any","alternatives","alt","array","boolean","binary","date","func","number","object","string","symbol","validate","describe","compile","assert","attempt","lazy","defaults","extend","allow","valid","only","equal","invalid","disallow","not","required","exist","optional","forbidden","strip","when","empty","default"]),t.any=function(...t){return r.assert(0===t.length,"Joi.any() does not allow arguments."),l.callWithDefaults.call(this,e,t)},t.alternatives=t.alt=function(...e){return l.callWithDefaults.call(this,l.alternatives,e)},t.array=function(...e){return r.assert(0===e.length,"Joi.array() does not allow arguments."),l.callWithDefaults.call(this,l.array,e)},t.boolean=t.bool=function(...e){return r.assert(0===e.length,"Joi.boolean() does not allow arguments."),l.callWithDefaults.call(this,l.boolean,e)},t.binary=function(...e){return r.assert(0===e.length,"Joi.binary() does not allow arguments."),l.callWithDefaults.call(this,l.binary,e)},t.date=function(...e){return r.assert(0===e.length,"Joi.date() does not allow arguments."),l.callWithDefaults.call(this,l.date,e)},t.func=function(...e){return r.assert(0===e.length,"Joi.func() does not allow arguments."),l.callWithDefaults.call(this,l.func,e)},t.number=function(...e){return r.assert(0===e.length,"Joi.number() does not allow arguments."),l.callWithDefaults.call(this,l.number,e)},t.object=function(...e){return l.callWithDefaults.call(this,l.object,e)},t.string=function(...e){return r.assert(0===e.length,"Joi.string() does not allow arguments."),l.callWithDefaults.call(this,l.string,e)},t.symbol=function(...e){return r.assert(0===e.length,"Joi.symbol() does not allow arguments."),l.callWithDefaults.call(this,l.symbol,e)},t.ref=function(...e){return c.create(...e)},t.isRef=function(e){return c.isRef(e)},t.validate=function(t,...n){const r=n[n.length-1],o="function"==typeof r?r:null,i=n.length-(o?1:0);if(0===i)return e.validate(t,o);const s=2===i?n[1]:void 0;return this.compile(n[0])._validateWithOptions(t,s,o)},t.describe=function(...t){return(t.length?this.compile(t[0]):e).describe()},t.compile=function(e){try{return i.schema(this,e)}catch(e){throw e.hasOwnProperty("path")&&(e.message=e.message+"("+e.path+")"),e}},t.assert=function(e,t,n){this.attempt(e,t,n)},t.attempt=function(e,t,n){const r=this.validate(e,t),o=r.error;if(o){if(!n)throw"function"==typeof o.annotate&&(o.message=o.annotate()),o;if(!(n instanceof Error))throw"function"==typeof o.annotate&&(o.message=`${n} ${o.annotate()}`),o;throw n}return r.value},t.reach=function(e,t){r.assert(e&&e instanceof o,"you must provide a joi schema"),r.assert(Array.isArray(t)||"string"==typeof t,"path must be a string or an array of strings");const reach=(e,t)=>{if(!t.length)return e;const n=e._inner.children;if(!n)return;const r=t.shift();for(let e=0;e<n.length;++e){const o=n[e];if(o.key===r)return reach(o.schema,t)}},n="string"==typeof t?t?t.split("."):[]:t.slice();return reach(e,n)},t.lazy=function(...e){return l.callWithDefaults.call(this,a,e)},t.defaults=function(e){r.assert("function"==typeof e,"Defaults must be a function");let t=Object.create(this.any());return t=e(t),r.assert(t&&t instanceof this.constructor,"defaults() must return a schema"),Object.assign(t,this,t.clone()),t._defaults=t=>(this._defaults&&(t=this._defaults(t),r.assert(t instanceof this.constructor,"defaults() must return a schema")),t=e(t),r.assert(t instanceof this.constructor,"defaults() must return a schema"),t),t},t.bind=function(){const e=Object.create(this);return e._binds.forEach(t=>{e[t]=e[t].bind(e)}),e},t.extend=function(...e){const n=r.flatten(e);r.assert(n.length>0,"You need to provide at least one extension"),this.assert(n,t.extensionsSchema);const a=Object.create(this.any());Object.assign(a,this),a._currentJoi=a,a._binds=new Set(a._binds);for(let e=0;e<n.length;++e){let d=n[e];"function"==typeof d&&(d=d(a)),this.assert(d,t.extensionSchema);const p=(d.base||this.any()).clone(),h=p.constructor,m=class extends h{constructor(){super(),d.base&&Object.assign(this,p),this._type=d.name,d.language&&(this._settings=u.concat(this._settings,{language:{[d.name]:d.language}}))}};if(d.coerce&&(m.prototype._coerce=function(e,t,n){if(h.prototype._coerce){const r=h.prototype._coerce.call(this,e,t,n);if(r.errors)return r;e=r.value}const r=d.coerce.call(this,e,t,n);return r instanceof s.Err?{value:e,errors:r}:{value:r}}),d.pre&&(m.prototype._base=function(e,t,n){if(h.prototype._base){const r=h.prototype._base.call(this,e,t,n);if(r.errors)return r;e=r.value}const r=d.pre.call(this,e,t,n);return r instanceof s.Err?{value:e,errors:r}:{value:r}}),d.rules)for(let e=0;e<d.rules.length;++e){const t=d.rules[e],n=t.params?t.params instanceof o?t.params._inner.children.map(e=>e.key):Object.keys(t.params):[],s=t.params?i.schema(this,t.params):null;m.prototype[t.name]=function(...e){if(e.length>n.length)throw new Error("Unexpected number of arguments");let i,u=!1,l={};for(let t=0;t<n.length;++t)l[n[t]]=e[t],!u&&c.isRef(e[t])&&(u=!0);if(s&&(l=a.attempt(l,s)),t.validate){const validate=function(e,n,r){return t.validate.call(this,l,e,n,r)};i=this._test(t.name,l,validate,{description:t.description,hasRef:u})}else i=this.clone();if(t.setup){const e=t.setup.call(i,l);void 0!==e&&(r.assert(e instanceof o,`Setup of extension Joi.${this._type}().${t.name}() must return undefined or a Joi object`),i=e)}return i}}d.describe&&(m.prototype.describe=function(){const e=h.prototype.describe.call(this);return d.describe.call(this,e)});const y=new m;a[d.name]=function(...e){return l.callWithDefaults.call(this,y,e)},a._binds.add(d.name)}return a},t.extensionSchema=l.object.keys({base:l.object.type(o,"Joi object"),name:l.string.required(),coerce:l.func.arity(3),pre:l.func.arity(3),language:l.object,describe:l.func.arity(1),rules:l.array.items(l.object.keys({name:l.string.required(),setup:l.func.arity(1),validate:l.func.arity(4),params:[l.object.pattern(/.*/,l.object.type(o,"Joi object")),l.object.type(l.object.constructor,"Joi object")],description:[l.string,l.func.arity(1)]}).or("setup","validate"))}).strict(),t.extensionsSchema=l.array.items([l.object,l.func.arity(1)]).strict(),t.version=n(1337).version,t}};e.exports=l.root()},function(e,t,n){"use strict";const r=n(20),o=n(545);t.concat=function(e,t){if(!t)return e;const n=Object.assign({},e),i=t.language;return Object.assign(n,t),i&&e&&e.language&&(n.language=r.applyToDefaults(e.language,i)),n[o.settingsCache]&&delete n[o.settingsCache],n}},function(e,t,n){"use strict";e.exports={settingsCache:Symbol("settingsCache")}},function(e,t,n){"use strict";const r=n(50),o={extendedCheckForValue:function(e,t){const n=typeof e;if("object"===n){if(e instanceof Date)return t=>t instanceof Date&&e.getTime()===t.getTime();if(Buffer.isBuffer(e))return t=>Buffer.isBuffer(t)&&e.length===t.length&&e.toString("binary")===t.toString("binary")}else if(t&&"string"===n){const t=e.toLowerCase();return e=>"string"==typeof e&&t===e.toLowerCase()}return null}};e.exports=class InternalSet{constructor(e){this._set=new Set(e),this._hasRef=!1}add(e,t){const n=r.isRef(e);return!n&&this.has(e,null,null,!1)||(void 0!==t&&r.push(t,e),this._set.add(e),this._hasRef|=n),this}merge(e,t){for(const t of e._set)this.add(t);for(const e of t._set)this.remove(e);return this}remove(e){return this._set.delete(e),this}has(e,t,n,r){return!!this.get(e,t,n,r)}get(e,t,n,i){if(!this._set.size)return!1;if(this._set.has(e))return{value:e};const s=o.extendedCheckForValue(e,i);if(!s){if(t&&this._hasRef)for(let o of this._set)if(r.isRef(o)){o=[].concat(o(t.reference||t.parent,n));const r=o.indexOf(e);if(r>=0)return{value:o[r]}}return!1}return this._has(e,t,n,s)}_has(e,t,n,o){const i=!(!t||!this._hasRef),isReallyEqual=function(t){return e===t||o(t)};for(let e of this._set)if(i&&r.isRef(e)&&(e=e(t.reference||t.parent,n),Array.isArray(e))){const t=e.findIndex(isReallyEqual);if(t>=0)return{value:e[t]}}else if(isReallyEqual(e))return{value:e};return!1}values(e){if(e&&e.stripUndefined){const e=[];for(const t of this._set)void 0!==t&&e.push(t);return e}return Array.from(this._set)}slice(){const e=new InternalSet(this._set);return e._hasRef=this._hasRef,e}concat(e){const t=new InternalSet([...this._set,...e._set]);return t._hasRef=!!(this._hasRef|e._hasRef),t}}},function(e,t,n){"use strict";const r=n(20),o=n(45),i=n(120),s=n(50),a={};a.Alternatives=class extends o{constructor(){super(),this._type="alternatives",this._invalids.remove(null),this._inner.matches=[]}_init(...e){return e.length?this.try(...e):this}_base(e,t,n){const r=[],o=this._inner.matches.length,i=this._baseType;for(let s=0;s<o;++s){const a=this._inner.matches[s];if(!a.schema){const r=a.peek||a.is,c=a.is?a.ref(t.reference||t.parent,n):e;if(r._validate(c,null,n,t.parent).errors){if(a.otherwise)return a.otherwise._validate(e,t,n)}else if(a.then)return a.then._validate(e,t,n);if(s===o-1&&i)return i._validate(e,t,n);continue}const c=a.schema._validate(e,t,n);if(!c.errors)return c;r.push(...c.errors)}return r.length?{errors:this.createError("alternatives.child",{reason:r},t,n)}:{errors:this.createError("alternatives.base",null,t,n)}}try(...e){e=r.flatten(e),r.assert(e.length,"Cannot add other alternatives without at least one schema");const t=this.clone();for(let n=0;n<e.length;++n){const r=i.schema(this._currentJoi,e[n]);r._refs.length&&t._refs.push(...r._refs),t._inner.matches.push({schema:r})}return t}when(e,t){let n=!1;r.assert(s.isRef(e)||"string"==typeof e||(n=e instanceof o),"Invalid condition:",e),r.assert(t,"Missing options"),r.assert("object"==typeof t,"Invalid options"),n?r.assert(!t.hasOwnProperty("is"),'"is" can not be used with a schema condition'):r.assert(t.hasOwnProperty("is"),'Missing "is" directive'),r.assert(void 0!==t.then||void 0!==t.otherwise,'options must have at least one of "then" or "otherwise"');const a=this.clone();let c;n||(c=i.schema(this._currentJoi,t.is),null!==t.is&&(s.isRef(t.is)||t.is instanceof o)||(c=c.required()));const u={ref:n?null:i.ref(e),peek:n?e:null,is:c,then:void 0!==t.then?i.schema(this._currentJoi,t.then):void 0,otherwise:void 0!==t.otherwise?i.schema(this._currentJoi,t.otherwise):void 0};return a._baseType&&(u.then=u.then&&a._baseType.concat(u.then),u.otherwise=u.otherwise&&a._baseType.concat(u.otherwise)),n||(s.push(a._refs,u.ref),a._refs.push(...u.is._refs)),u.then&&u.then._refs.length&&a._refs.push(...u.then._refs),u.otherwise&&u.otherwise._refs.length&&a._refs.push(...u.otherwise._refs),a._inner.matches.push(u),a}label(e){const t=super.label(e);return t._inner.matches=t._inner.matches.map(t=>t.schema?{schema:t.schema.label(e)}:((t=Object.assign({},t)).then&&(t.then=t.then.label(e)),t.otherwise&&(t.otherwise=t.otherwise.label(e)),t)),t}describe(){const e=super.describe(),t=[];for(let e=0;e<this._inner.matches.length;++e){const n=this._inner.matches[e];if(n.schema)t.push(n.schema.describe());else{const e=n.is?{ref:n.ref.toString(),is:n.is.describe()}:{peek:n.peek.describe()};n.then&&(e.then=n.then.describe()),n.otherwise&&(e.otherwise=n.otherwise.describe()),t.push(e)}}return e.alternatives=t,e}},e.exports=new a.Alternatives},function(e,t,n){"use strict";const r=n(45),o=n(50),i=n(20),s={isoDate:/^(?:[-+]\d{2})?(?:\d{4}(?!\d{2}\b))(?:(-?)(?:(?:0[1-9]|1[0-2])(?:\1(?:[12]\d|0[1-9]|3[01]))?|W(?:[0-4]\d|5[0-2])(?:-?[1-7])?|(?:00[1-9]|0[1-9]\d|[12]\d{2}|3(?:[0-5]\d|6[1-6])))(?![T]$|[T][\d]+Z$)(?:[T\s](?:(?:(?:[01]\d|2[0-3])(?:(:?)[0-5]\d)?|24\:?00)(?:[.,]\d+(?!:))?)(?:\2[0-5]\d(?:[.,]\d+)?)?(?:[Z]|(?:[+-])(?:[01]\d|2[0-3])(?::?[0-5]\d)?)?)?)?$/};s.invalidDate=new Date(""),s.isIsoDate=(()=>{const e=s.isoDate.toString();return t=>t&&t.toString()===e})(),s.Date=class extends r{constructor(){super(),this._type="date"}_base(e,t,n){const r={value:n.convert&&s.Date.toDate(e,this._flags.format,this._flags.timestamp,this._flags.multiplier)||e};if(r.value instanceof Date&&!isNaN(r.value.getTime()))r.errors=null;else if(n.convert){let o;o=s.isIsoDate(this._flags.format)?"isoDate":this._flags.timestamp?"timestamp."+this._flags.timestamp:"base",r.errors=this.createError("date."+o,{value:e},t,n)}else r.errors=this.createError("date.strict",{value:e},t,n);return r}static toDate(e,t,n,r){if(e instanceof Date)return e;if("string"==typeof e||"number"==typeof e&&!isNaN(e)&&isFinite(e)){const o=t&&s.isIsoDate(t);let i;if(!o&&"string"==typeof e&&/^[+-]?\d+(\.\d+)?$/.test(e)&&(e=parseFloat(e)),i=o?t.test(e)?new Date(e.toString()):s.invalidDate:n?/^\s*$/.test(e)?s.invalidDate:new Date(e*r):new Date(e),!isNaN(i.getTime()))return i}return null}iso(){if(this._flags.format===s.isoDate)return this;const e=this.clone();return e._flags.format=s.isoDate,e}timestamp(e="javascript"){const t=["javascript","unix"];if(i.assert(t.includes(e),'"type" must be one of "'+t.join('", "')+'"'),this._flags.timestamp===e)return this;const n=this.clone();return n._flags.timestamp=e,n._flags.multiplier="unix"===e?1e3:1,n}_isIsoDate(e){return s.isoDate.test(e)}},s.compare=function(e,t){return function(n){const r="now"===n,a=o.isRef(n);return r||a||(n=s.Date.toDate(n)),i.assert(n,"Invalid date format"),this._test(e,n,(function(o,i,c){let u;if(r)u=Date.now();else if(a){const e=n(i.reference||i.parent,c);if(u=s.Date.toDate(e),!u)return this.createError("date.ref",{ref:n,value:e},i,c);u=u.getTime()}else u=n.getTime();return t(o.getTime(),u)?o:this.createError("date."+e,{limit:new Date(u),value:o},i,c)}))}},s.Date.prototype.min=s.compare("min",(e,t)=>e>=t),s.Date.prototype.max=s.compare("max",(e,t)=>e<=t),s.Date.prototype.greater=s.compare("greater",(e,t)=>e>t),s.Date.prototype.less=s.compare("less",(e,t)=>e<t),e.exports=new s.Date},function(e,t,n){"use strict";const r=n(20),o=n(1329),i=n(45),s=n(254),a=n(120),c=n(255),u={};u.Object=class extends i{constructor(){super(),this._type="object",this._inner.children=null,this._inner.renames=[],this._inner.dependencies=[],this._inner.patterns=[]}_init(...e){return e.length?this.keys(...e):this}_base(e,t,n){let o=e;const i=[],finish=()=>({value:o,errors:i.length?i:null});"string"==typeof e&&n.convert&&(e=u.safeParse(e));const a=this._flags.func?"function":"object";if(!e||typeof e!==a||Array.isArray(e))return i.push(this.createError(a+".base",{value:e},t,n)),finish();if(!(this._inner.renames.length||this._inner.dependencies.length||this._inner.children||this._inner.patterns.length))return o=e,finish();if(o===e){"object"===a?o=Object.create(Object.getPrototypeOf(e)):(o=function(...t){return e.apply(this,t)},o.prototype=r.clone(e.prototype));const t=Object.keys(e);for(let n=0;n<t.length;++n)o[t[n]]=e[t[n]]}else o=e;const l={};for(let e=0;e<this._inner.renames.length;++e){const r=this._inner.renames[e];if(r.isRegExp){const e=Object.keys(o),s=[];for(let t=0;t<e.length;++t)r.from.test(e[t])&&s.push(e[t]);const a=s.every(e=>void 0===o[e]);if(r.options.ignoreUndefined&&a)continue;if(!r.options.multiple&&l[r.to]&&(i.push(this.createError("object.rename.regex.multiple",{from:s,to:r.to},t,n)),n.abortEarly))return finish();if(Object.prototype.hasOwnProperty.call(o,r.to)&&!r.options.override&&!l[r.to]&&(i.push(this.createError("object.rename.regex.override",{from:s,to:r.to},t,n)),n.abortEarly))return finish();if(a?delete o[r.to]:o[r.to]=o[s[s.length-1]],l[r.to]=!0,!r.options.alias)for(let e=0;e<s.length;++e)delete o[s[e]]}else{if(r.options.ignoreUndefined&&void 0===o[r.from])continue;if(!r.options.multiple&&l[r.to]&&(i.push(this.createError("object.rename.multiple",{from:r.from,to:r.to},t,n)),n.abortEarly))return finish();if(Object.prototype.hasOwnProperty.call(o,r.to)&&!r.options.override&&!l[r.to]&&(i.push(this.createError("object.rename.override",{from:r.from,to:r.to},t,n)),n.abortEarly))return finish();void 0===o[r.from]?delete o[r.to]:o[r.to]=o[r.from],l[r.to]=!0,r.options.alias||delete o[r.from]}}if(!this._inner.children&&!this._inner.patterns.length&&!this._inner.dependencies.length)return finish();const d=new Set(Object.keys(o));if(this._inner.children){const e=[];for(let r=0;r<this._inner.children.length;++r){const s=this._inner.children[r],a=s.key,u=o[a];d.delete(a);const l=new c(a,[...t.path,a],o,t.reference),p=s.schema._validate(u,l,n);if(p.errors){if(i.push(this.createError("object.child",{key:a,child:s.schema._getLabel(a),reason:p.errors},l,n)),n.abortEarly)return finish()}else s.schema._flags.strip||void 0===p.value&&p.value!==u?(e.push(a),o[a]=p.finalValue):void 0!==p.value&&(o[a]=p.value)}for(let t=0;t<e.length;++t)delete o[e[t]]}if(d.size&&this._inner.patterns.length)for(const e of d){const r=new c(e,[...t.path,e],o,t.reference),s=o[e];for(let t=0;t<this._inner.patterns.length;++t){const a=this._inner.patterns[t];if(a.regex?a.regex.test(e):!a.schema.validate(e).error){d.delete(e);const t=a.rule._validate(s,r,n);if(t.errors&&(i.push(this.createError("object.child",{key:e,child:a.rule._getLabel(e),reason:t.errors},r,n)),n.abortEarly))return finish();o[e]=t.value}}}if(d.size&&(this._inner.children||this._inner.patterns.length)){if(n.stripUnknown&&!0!==this._flags.allowUnknown||n.skipFunctions){const e=!!n.stripUnknown&&(!0===n.stripUnknown||!!n.stripUnknown.objects);for(const t of d)e?(delete o[t],d.delete(t)):"function"==typeof o[t]&&d.delete(t)}if(void 0!==this._flags.allowUnknown?!this._flags.allowUnknown:!n.allowUnknown)for(const e of d)i.push(this.createError("object.allowUnknown",{child:e,value:o[e]},{key:e,path:[...t.path,e]},n,{}))}for(let e=0;e<this._inner.dependencies.length;++e){const a=this._inner.dependencies[e],l=null!==a.key,d=l&&a.key.split("."),p=l?new c(d[d.length-1],[...t.path,...d]):new c(null,t.path),h=u[a.type].call(this,a.key,l&&r.reach(o,a.key,{functions:!0}),a.peers,o,p,n);if(h instanceof s.Err&&(i.push(h),n.abortEarly))return finish()}return finish()}keys(e){r.assert(null==e||"object"==typeof e,"Object schema must be a valid object"),r.assert(!(e&&e instanceof i),"Object schema cannot be a joi schema");const t=this.clone();if(!e)return t._inner.children=null,t;const n=Object.keys(e);if(!n.length)return t._inner.children=[],t;const s=new o;if(t._inner.children)for(let e=0;e<t._inner.children.length;++e){const r=t._inner.children[e];n.includes(r.key)||s.add(r,{after:r._refs,group:r.key})}for(let t=0;t<n.length;++t){const r=n[t],o=e[r];try{const e=a.schema(this._currentJoi,o);s.add({key:r,schema:e},{after:e._refs,group:r})}catch(e){throw e.hasOwnProperty("path")?e.path=r+"."+e.path:e.path=r,e}}return t._inner.children=s.nodes,t}append(e){return null==e||0===Object.keys(e).length?this:this.keys(e)}unknown(e){const t=!1!==e;if(this._flags.allowUnknown===t)return this;const n=this.clone();return n._flags.allowUnknown=t,n}length(e){return r.assert(Number.isSafeInteger(e)&&e>=0,"limit must be a positive integer"),this._test("length",e,(function(t,n,r){return Object.keys(t).length===e?t:this.createError("object.length",{limit:e,value:t},n,r)}))}min(e){return r.assert(Number.isSafeInteger(e)&&e>=0,"limit must be a positive integer"),this._test("min",e,(function(t,n,r){return Object.keys(t).length>=e?t:this.createError("object.min",{limit:e,value:t},n,r)}))}max(e){return r.assert(Number.isSafeInteger(e)&&e>=0,"limit must be a positive integer"),this._test("max",e,(function(t,n,r){return Object.keys(t).length<=e?t:this.createError("object.max",{limit:e,value:t},n,r)}))}pattern(e,t){const n=e instanceof RegExp;r.assert(n||e instanceof i,"pattern must be a regex or schema"),r.assert(void 0!==t,"Invalid rule"),n&&r.assert(!e.flags.includes("g")&&!e.flags.includes("y"),"pattern should not use global or sticky mode");try{t=a.schema(this._currentJoi,t)}catch(e){throw e.hasOwnProperty("path")&&(e.message=`${e.message}(${e.path})`),e}const o=this.clone();return n?o._inner.patterns.push({regex:e,rule:t}):o._inner.patterns.push({schema:e,rule:t}),o}schema(){return this._test("schema",null,(function(e,t,n){return e instanceof i?e:this.createError("object.schema",null,t,n)}))}with(e,t){return r.assert(2===arguments.length,"Invalid number of arguments, expected 2."),this._dependency("with",e,t)}without(e,t){return r.assert(2===arguments.length,"Invalid number of arguments, expected 2."),this._dependency("without",e,t)}xor(...e){return e=r.flatten(e),this._dependency("xor",null,e)}oxor(...e){return this._dependency("oxor",null,e)}or(...e){return e=r.flatten(e),this._dependency("or",null,e)}and(...e){return e=r.flatten(e),this._dependency("and",null,e)}nand(...e){return e=r.flatten(e),this._dependency("nand",null,e)}requiredKeys(...e){return e=r.flatten(e),this.applyFunctionToChildren(e,"required")}optionalKeys(...e){return e=r.flatten(e),this.applyFunctionToChildren(e,"optional")}forbiddenKeys(...e){return e=r.flatten(e),this.applyFunctionToChildren(e,"forbidden")}rename(e,t,n){r.assert("string"==typeof e||e instanceof RegExp,"Rename missing the from argument"),r.assert("string"==typeof t,"Rename missing the to argument"),r.assert(t!==e,"Cannot rename key to same name:",e);for(let t=0;t<this._inner.renames.length;++t)r.assert(this._inner.renames[t].from!==e,"Cannot rename the same key multiple times");const o=this.clone();return o._inner.renames.push({from:e,to:t,options:r.applyToDefaults(u.renameDefaults,n||{}),isRegExp:e instanceof RegExp}),o}applyFunctionToChildren(e,t,n=[],o){e=[].concat(e),r.assert(e.length>0,"expected at least one children");const i=u.groupChildren(e);let s;if(""in i?(s=this[t](...n),delete i[""]):s=this.clone(),s._inner.children){o=o?o+".":"";for(let e=0;e<s._inner.children.length;++e){const r=s._inner.children[e],a=i[r.key];a&&(s._inner.children[e]={key:r.key,_refs:r._refs,schema:r.schema.applyFunctionToChildren(a,t,n,o+r.key)},delete i[r.key])}}const a=Object.keys(i);return r.assert(0===a.length,"unknown key(s)",a.join(", ")),s}_dependency(e,t,n){n=[].concat(n);for(let t=0;t<n.length;++t)r.assert("string"==typeof n[t],e,"peers must be a string or array of strings");const o=this.clone();return o._inner.dependencies.push({type:e,key:t,peers:n}),o}describe(e){const t=super.describe();if(t.rules)for(let e=0;e<t.rules.length;++e){const n=t.rules[e];n.arg&&"object"==typeof n.arg&&n.arg.schema&&n.arg.ref&&(n.arg={schema:n.arg.schema.describe(),ref:n.arg.ref.toString()})}if(this._inner.children&&!e){t.children={};for(let e=0;e<this._inner.children.length;++e){const n=this._inner.children[e];t.children[n.key]=n.schema.describe()}}if(this._inner.dependencies.length&&(t.dependencies=r.clone(this._inner.dependencies)),this._inner.patterns.length){t.patterns=[];for(let e=0;e<this._inner.patterns.length;++e){const n=this._inner.patterns[e];n.regex?t.patterns.push({regex:n.regex.toString(),rule:n.rule.describe()}):t.patterns.push({schema:n.schema.describe(),rule:n.rule.describe()})}}return this._inner.renames.length>0&&(t.renames=r.clone(this._inner.renames)),t}assert(e,t,n){e=a.ref(e),r.assert(e.isContext||e.depth>1,"Cannot use assertions for root level references - use direct key rules instead"),n=n||"pass the assertion test",r.assert("string"==typeof n,"Message must be a string");try{t=a.schema(this._currentJoi,t)}catch(e){throw e.hasOwnProperty("path")&&(e.message=`${e.message}(${e.path})`),e}const o=e.path[e.path.length-1],i=e.path.join(".");return this._test("assert",{schema:t,ref:e},(function(r,s,a){if(!t._validate(e(r),null,a,r).errors)return r;const u=new c(o,e.path,s.parent,s.reference);return this.createError("object.assert",{ref:i,message:n},u,a)}))}type(e,t=e.name){r.assert("function"==typeof e,"type must be a constructor function");const n={name:t,ctor:e};return this._test("type",n,(function(t,r,o){return t instanceof e?t:this.createError("object.type",{type:n.name,value:t},r,o)}))}},u.safeParse=function(e){try{return JSON.parse(e)}catch(e){}return e},u.renameDefaults={alias:!1,multiple:!1,override:!1},u.groupChildren=function(e){e.sort();const t={};for(let n=0;n<e.length;++n){const o=e[n];r.assert("string"==typeof o,"children must be strings");const i=o.split(".")[0];(t[i]=t[i]||[]).push(o.substring(i.length+1))}return t},u.keysToLabels=function(e,t){if(!e._inner.children)return t;const findLabel=function(t){const n=e._currentJoi.reach(e,t);return n?n._getLabel(t):t};return Array.isArray(t)?t.map(findLabel):findLabel(t)},u.with=function(e,t,n,o,i,s){if(void 0!==t)for(let t=0;t<n.length;++t){const a=n[t];if(void 0===r.reach(o,a,{functions:!0}))return this.createError("object.with",{main:e,mainWithLabel:u.keysToLabels(this,e),peer:a,peerWithLabel:u.keysToLabels(this,a)},i,s)}},u.without=function(e,t,n,o,i,s){if(void 0!==t)for(let t=0;t<n.length;++t){const a=n[t];if(void 0!==r.reach(o,a,{functions:!0}))return this.createError("object.without",{main:e,mainWithLabel:u.keysToLabels(this,e),peer:a,peerWithLabel:u.keysToLabels(this,a)},i,s)}},u.xor=function(e,t,n,o,i,s){const a=[];for(let e=0;e<n.length;++e){const t=n[e];void 0!==r.reach(o,t,{functions:!0})&&a.push(t)}if(1===a.length)return;const c={peers:n,peersWithLabels:u.keysToLabels(this,n)};return 0===a.length?this.createError("object.missing",c,i,s):(c.present=a,c.presentWithLabels=u.keysToLabels(this,a),this.createError("object.xor",c,i,s))},u.oxor=function(e,t,n,o,i,s){const a=[];for(let e=0;e<n.length;++e){const t=n[e];void 0!==r.reach(o,t,{functions:!0})&&a.push(t)}if(!a.length||1===a.length)return;const c={peers:n,peersWithLabels:u.keysToLabels(this,n)};return c.present=a,c.presentWithLabels=u.keysToLabels(this,a),this.createError("object.oxor",c,i,s)},u.or=function(e,t,n,o,i,s){for(let e=0;e<n.length;++e){const t=n[e];if(void 0!==r.reach(o,t,{functions:!0}))return}return this.createError("object.missing",{peers:n,peersWithLabels:u.keysToLabels(this,n)},i,s)},u.and=function(e,t,n,o,i,s){const a=[],c=[],l=n.length;for(let e=0;e<l;++e){const t=n[e];void 0===r.reach(o,t,{functions:!0})?a.push(t):c.push(t)}if(!(a.length===l||c.length===l))return this.createError("object.and",{present:c,presentWithLabels:u.keysToLabels(this,c),missing:a,missingWithLabels:u.keysToLabels(this,a)},i,s)},u.nand=function(e,t,n,o,i,s){const a=[];for(let e=0;e<n.length;++e){const t=n[e];void 0!==r.reach(o,t,{functions:!0})&&a.push(t)}const c=n[0],l=n.slice(1);return a.length===n.length?this.createError("object.nand",{main:c,mainWithLabel:u.keysToLabels(this,c),peers:l,peersWithLabels:u.keysToLabels(this,l)},i,s):null},e.exports=new u.Object},function(e,t,n){"use strict";const r={rfc3986:{},generate:function(){const e="|";r.rfc3986.ipv4Cidr="[0-9]|[1-2][0-9]|3[0-2]",r.rfc3986.ipv6Cidr="(?:0?0?[0-9]|0?[1-9][0-9]|1[01][0-9]|12[0-8])";const t="a-zA-Z0-9-\\._~",n="!\\$&'\\(\\)\\*\\+,;=",o=t+"%0-9A-Fa-f"+n+":@",i="["+o+"]",s="(?:0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])";r.rfc3986.IPv4address="(?:"+s+"\\.){3}"+s;const a="[0-9A-Fa-f]{1,4}",c="(?:"+a+":"+a+"|"+r.rfc3986.IPv4address+")",u="(?:"+a+":){6}"+c,l="::(?:"+a+":){5}"+c,d="(?:"+a+")?::(?:"+a+":){4}"+c,p="(?:(?:"+a+":){0,1}"+a+")?::(?:"+a+":){3}"+c,h="(?:(?:"+a+":){0,2}"+a+")?::(?:"+a+":){2}"+c,m="(?:(?:"+a+":){0,3}"+a+")?::"+a+":"+c,y="(?:(?:"+a+":){0,4}"+a+")?::"+c;r.rfc3986.IPv6address="(?:"+u+e+l+e+d+e+p+e+h+e+m+e+y+"|(?:(?:[0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}"+"|(?:(?:[0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})?::)",r.rfc3986.IPvFuture="v[0-9A-Fa-f]+\\.["+t+n+":]+",r.rfc3986.scheme="[a-zA-Z][a-zA-Z0-9+-\\.]*";const g="(?:[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=:]*@)?"+("(?:"+("\\[(?:"+r.rfc3986.IPv6address+e+r.rfc3986.IPvFuture+")\\]")+e+r.rfc3986.IPv4address+"|[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=]{0,255})")+"(?::[0-9]*)?",_=i+"+",v="(?:\\/[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=:@]*)*",E="\\/(?:"+_+v+")?";r.rfc3986.hierPart="(?:(?:\\/\\/"+g+v+")"+e+E+"|[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=:@]+(?:\\/[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=:@]*)*)",r.rfc3986.relativeRef="(?:(?:\\/\\/"+g+v+")"+e+E+"|[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=@]+(?:\\/[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=:@]*)*"+"|)",r.rfc3986.query="["+o+"\\/\\?]*(?=#|$)",r.rfc3986.queryWithSquareBrackets="["+o+"\\[\\]\\/\\?]*(?=#|$)",r.rfc3986.fragment="["+o+"\\/\\?]*"}};r.generate(),e.exports=r.rfc3986},function(e,t,n){"use strict";n.r(t),n.d(t,"getValueByPointer",(function(){return getValueByPointer})),n.d(t,"applyOperation",(function(){return applyOperation})),n.d(t,"applyPatch",(function(){return applyPatch})),n.d(t,"applyReducer",(function(){return applyReducer})),n.d(t,"validator",(function(){return validator})),n.d(t,"validate",(function(){return validate})),n.d(t,"_areEquals",(function(){return _areEquals})),n.d(t,"unobserve",(function(){return unobserve})),n.d(t,"observe",(function(){return observe})),n.d(t,"generate",(function(){return generate})),n.d(t,"compare",(function(){return compare})),n.d(t,"JsonPatchError",(function(){return c})),n.d(t,"deepClone",(function(){return _deepClone})),n.d(t,"escapePathComponent",(function(){return escapePathComponent})),n.d(t,"unescapePathComponent",(function(){return unescapePathComponent}));var r={};n.r(r),n.d(r,"JsonPatchError",(function(){return u})),n.d(r,"deepClone",(function(){return l})),n.d(r,"getValueByPointer",(function(){return getValueByPointer})),n.d(r,"applyOperation",(function(){return applyOperation})),n.d(r,"applyPatch",(function(){return applyPatch})),n.d(r,"applyReducer",(function(){return applyReducer})),n.d(r,"validator",(function(){return validator})),n.d(r,"validate",(function(){return validate})),n.d(r,"_areEquals",(function(){return _areEquals}));var o={};n.r(o),n.d(o,"unobserve",(function(){return unobserve})),n.d(o,"observe",(function(){return observe})),n.d(o,"generate",(function(){return generate})),n.d(o,"compare",(function(){return compare}));var i,s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function __(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),a=Object.prototype.hasOwnProperty;function helpers_hasOwnProperty(e,t){return a.call(e,t)}function _objectKeys(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);t=[];for(var r in e)helpers_hasOwnProperty(e,r)&&t.push(r);return t}function _deepClone(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function isInteger(e){for(var t,n=0,r=e.length;n<r;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0}function escapePathComponent(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function unescapePathComponent(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function patchErrorMessageFormatter(e,t){var n=[e];for(var r in t){var o="object"==typeof t[r]?JSON.stringify(t[r],null,2):t[r];void 0!==o&&n.push(r+": "+o)}return n.join("\n")}var c=function(e){function PatchError(t,n,r,o,i){var s=this.constructor,a=e.call(this,patchErrorMessageFormatter(t,{name:n,index:r,operation:o,tree:i}))||this;return a.name=n,a.index=r,a.operation=o,a.tree=i,Object.setPrototypeOf(a,s.prototype),a.message=patchErrorMessageFormatter(t,{name:n,index:r,operation:o,tree:i}),a}return s(PatchError,e),PatchError}(Error),u=c,l=_deepClone,d={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=getValueByPointer(n,this.path);r&&(r=_deepClone(r));var o=applyOperation(n,{op:"remove",path:this.from}).removed;return applyOperation(n,{op:"add",path:this.path,value:o}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=getValueByPointer(n,this.from);return applyOperation(n,{op:"add",path:this.path,value:_deepClone(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:_areEquals(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},p={add:function(e,t,n){return isInteger(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:d.move,copy:d.copy,test:d.test,_get:d._get};function getValueByPointer(e,t){if(""==t)return e;var n={op:"_get",path:t};return applyOperation(e,n),n.value}function applyOperation(e,t,n,r,o,i){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===o&&(o=!0),void 0===i&&(i=0),n&&("function"==typeof n?n(t,0,e,t.path):validator(t,0)),""===t.path){var s={newDocument:e};if("add"===t.op)return s.newDocument=t.value,s;if("replace"===t.op)return s.newDocument=t.value,s.removed=e,s;if("move"===t.op||"copy"===t.op)return s.newDocument=getValueByPointer(e,t.from),"move"===t.op&&(s.removed=e),s;if("test"===t.op){if(s.test=_areEquals(e,t.value),!1===s.test)throw new u("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return s.newDocument=e,s}if("remove"===t.op)return s.removed=e,s.newDocument=null,s;if("_get"===t.op)return t.value=e,s;if(n)throw new u("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,t,e);return s}r||(e=_deepClone(e));var a=(t.path||"").split("/"),c=e,l=1,h=a.length,m=void 0,y=void 0,g=void 0;for(g="function"==typeof n?n:validator;;){if(y=a[l],o&&"__proto__"==y)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===m&&(void 0===c[y]?m=a.slice(0,l).join("/"):l==h-1&&(m=t.path),void 0!==m&&g(t,0,e,m)),l++,Array.isArray(c)){if("-"===y)y=c.length;else{if(n&&!isInteger(y))throw new u("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,t,e);isInteger(y)&&(y=~~y)}if(l>=h){if(n&&"add"===t.op&&y>c.length)throw new u("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,t,e);if(!1===(s=p[t.op].call(t,c,y,e)).test)throw new u("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return s}}else if(y&&-1!=y.indexOf("~")&&(y=unescapePathComponent(y)),l>=h){if(!1===(s=d[t.op].call(t,c,y,e)).test)throw new u("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return s}c=c[y]}}function applyPatch(e,t,n,r,o){if(void 0===r&&(r=!0),void 0===o&&(o=!0),n&&!Array.isArray(t))throw new u("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=_deepClone(e));for(var i=new Array(t.length),s=0,a=t.length;s<a;s++)i[s]=applyOperation(e,t[s],n,!0,o,s),e=i[s].newDocument;return i.newDocument=e,i}function applyReducer(e,t,n){var r=applyOperation(e,t);if(!1===r.test)throw new u("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function validator(e,t,n,r){if("object"!=typeof e||null===e||Array.isArray(e))throw new u("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!d[e.op])throw new u("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new u("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new u('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new u("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new u("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&function hasUndefined(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(hasUndefined(e[t]))return!0}else if("object"==typeof e){var r=_objectKeys(e),o=r.length;for(t=0;t<o;t++)if(hasUndefined(e[r[t]]))return!0}return!1}(e.value))throw new u("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var o=e.path.split("/").length,i=r.split("/").length;if(o!==i+1&&o!==i)throw new u("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==r)throw new u("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var s=validate([{op:"_get",path:e.from,value:void 0}],n);if(s&&"OPERATION_PATH_UNRESOLVABLE"===s.name)throw new u("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function validate(e,t,n){try{if(!Array.isArray(e))throw new u("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)applyPatch(_deepClone(t),_deepClone(e),n||!0);else{n=n||validator;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(e){if(e instanceof u)return e;throw e}}function _areEquals(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,r,o,i=Array.isArray(e),s=Array.isArray(t);if(i&&s){if((r=e.length)!=t.length)return!1;for(n=r;0!=n--;)if(!_areEquals(e[n],t[n]))return!1;return!0}if(i!=s)return!1;var a=Object.keys(e);if((r=a.length)!==Object.keys(t).length)return!1;for(n=r;0!=n--;)if(!t.hasOwnProperty(a[n]))return!1;for(n=r;0!=n--;)if(!_areEquals(e[o=a[n]],t[o]))return!1;return!0}return e!=e&&t!=t}var h=new WeakMap,m=function m(e){this.observers=new Map,this.obj=e},y=function y(e,t){this.callback=e,this.observer=t};function unobserve(e,t){t.unobserve()}function observe(e,t){var n,r=function getMirror(e){return h.get(e)}(e);if(r){var o=function getObserverFromMirror(e,t){return e.observers.get(t)}(r,t);n=o&&o.observer}else r=new m(e),h.set(e,r);if(n)return n;if(n={},r.value=_deepClone(e),t){n.callback=t,n.next=null;var dirtyCheck=function(){generate(n)},fastCheck=function(){clearTimeout(n.next),n.next=setTimeout(dirtyCheck)};"undefined"!=typeof window&&(window.addEventListener("mouseup",fastCheck),window.addEventListener("keyup",fastCheck),window.addEventListener("mousedown",fastCheck),window.addEventListener("keydown",fastCheck),window.addEventListener("change",fastCheck))}return n.patches=[],n.object=e,n.unobserve=function(){generate(n),clearTimeout(n.next),function removeObserverFromMirror(e,t){e.observers.delete(t.callback)}(r,n),"undefined"!=typeof window&&(window.removeEventListener("mouseup",fastCheck),window.removeEventListener("keyup",fastCheck),window.removeEventListener("mousedown",fastCheck),window.removeEventListener("keydown",fastCheck),window.removeEventListener("change",fastCheck))},r.observers.set(t,new y(t,n)),n}function generate(e,t){void 0===t&&(t=!1);var n=h.get(e.object);_generate(n.value,e.object,e.patches,"",t),e.patches.length&&applyPatch(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function _generate(e,t,n,r,o){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var i=_objectKeys(t),s=_objectKeys(e),a=!1,c=s.length-1;c>=0;c--){var u=e[d=s[c]];if(!helpers_hasOwnProperty(t,d)||void 0===t[d]&&void 0!==u&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(o&&n.push({op:"test",path:r+"/"+escapePathComponent(d),value:_deepClone(u)}),n.push({op:"remove",path:r+"/"+escapePathComponent(d)}),a=!0):(o&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}),!0);else{var l=t[d];"object"==typeof u&&null!=u&&"object"==typeof l&&null!=l?_generate(u,l,n,r+"/"+escapePathComponent(d),o):u!==l&&(!0,o&&n.push({op:"test",path:r+"/"+escapePathComponent(d),value:_deepClone(u)}),n.push({op:"replace",path:r+"/"+escapePathComponent(d),value:_deepClone(l)}))}}if(a||i.length!=s.length)for(c=0;c<i.length;c++){var d;helpers_hasOwnProperty(e,d=i[c])||void 0===t[d]||n.push({op:"add",path:r+"/"+escapePathComponent(d),value:_deepClone(t[d])})}}}function compare(e,t,n){void 0===n&&(n=!1);var r=[];return _generate(e,t,r,"",n),r}t.default=Object.assign({},r,o,{JsonPatchError:c,deepClone:_deepClone,escapePathComponent:escapePathComponent,unescapePathComponent:unescapePathComponent})},function(e,t,n){"use strict";n.r(t),n.d(t,"nanoid",(function(){return nanoid})),n.d(t,"customAlphabet",(function(){return customAlphabet})),n.d(t,"customRandom",(function(){return customRandom})),n.d(t,"urlAlphabet",(function(){return i})),n.d(t,"random",(function(){return random}));var r=n(16),o=n.n(r);let i="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW";let s,a,random=e=>{!s||s.length<e?(s=Buffer.allocUnsafe(32*e),o.a.randomFillSync(s),a=0):a+e>s.length&&(o.a.randomFillSync(s),a=0);let t=s.subarray(a,a+e);return a+=e,t},customRandom=(e,t,n)=>{let r=(2<<31-Math.clz32(e.length-1|1))-1,o=Math.ceil(1.6*r*t/e.length);return()=>{let i="";for(;;){let s=n(o),a=o;for(;a--;)if(i+=e[s[a]&r]||"",i.length===t)return i}}},customAlphabet=(e,t)=>customRandom(e,t,random),nanoid=(e=21)=>{let t=random(e),n="";for(;e--;)n+=i[63&t[e]];return n}},function(e,t,n){"use strict";(function(e){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=n(37),s=r(n(554)),a=n(12),c=r(n(598)),u=o(n(603)),l=n(635),d=n(44),p=n(5),h=n(53),m=n(49),y=n(1342),g=n(1343);let _;var v;function isProcessRunning(e){try{process.kill(e,0)}catch(e){return!1}return!0}let E,I;async function serverShutdown(e){if(I)console.info(`Shutdown [reason = ${e}] already in progress (was ${I}), ignoring extra request`);else{I=e,console.info(`Shutting down FremontJS [${e}]...`);try{E&&(await E(),console.info("...Server disconnected"));const e=p.getSdkList();for(const t in e){const n=e[t];await d.awaitAllCommands({spaceCollectionId:n.spaceCollectionId,testing:!1},n.options),console.info(`...Commands of SDKInstance ${t} completed`),await p.disposeSDKInstance(n),console.info(`...SDKInstance ${t} disposed`)}console.info("Exiting process")}catch(e){console.warn("An error occured while shutting down FremontJS "+e),process.exit(-1)}process.exit(0)}}function socketInit(e,t,n=!1,r=6e4){const o=function serverInit(e,t){if(e===v.SOCKETIO){const e=i.createServer();e.listen(t,"127.0.0.1",()=>{console.info("Listening to socket.io on port",t)});const n=s.default(e,{pingInterval:5e3,pingTimeout:12e5,serveClient:!1});return E=async()=>{e.close()},n}if(e===v.WEBSOCKET){const e=new c.default.Server({port:t,host:"127.0.0.1"});return E=a.promisify(e.close.bind(e)),e}throw Error("Unrecognized socket implementation: "+e)}(e,t);let u=null;o.on("connection",t=>{const o=function socketAdaptorInit(e,t){if(e===v.SOCKETIO)return new y.SioAdaptor(t);if(e===v.WEBSOCKET)return new g.WsAdaptor(t);throw Error("Unrecognized socket implementation: "+e)}(e,t);u&&clearTimeout(u),o.use((e,t)=>{t()});const i=new m.TelemetryTracker(o);m.initTelemetryReporting(i.report),l.init(o,e=>{_=e}),o.onDisconnect(e=>{if(console.debug("[socket]: Client has disconnected...",e?e.reason:"no specific reason"),n)console.debug("[socket]: Will ignore disconnect...");else{if(_&&isProcessRunning(_))return console.debug("[socket]: Client is still running. Will wait for reconnect before terminating."),void(u=setTimeout(()=>{console.info("[socket]: Exiting process due to reconnect timeout"),serverShutdown("Timeout waiting for client reconnection")},r));console.debug("[socket]: Client is no longer running. Will terminate."),serverShutdown("Client socket disconnected")}})})}function start(e=t.DEFAULT_PORT,n=!1,r=6e4,o=v.WEBSOCKET,i=!0){console.debug(`Using ${o} on port ${e}`),socketInit(o,e,n,r),i&&(console.info("Installing exception handlers"),h.installExceptionHandlers()),console.info("Installing signal handlers");for(const e of["SIGHUP","SIGTERM","SIGINT","SIGBREAK"])console.info("Installed",e),process.on(e,()=>serverShutdown(e))}function date(){return(new Date).toTimeString().split(" ")[0]}if(t.DEFAULT_PORT=3e3,function(e){e.SOCKETIO="sio",e.WEBSOCKET="ws"}(v||(v={})),t.isProcessRunning=isProcessRunning,t.socketInit=socketInit,t.start=start,function decorateConsole(){for(const e of["info","warn","error","debug","log"]){const t=console[e].bind(console);console[e]=function(e,...n){"string"==typeof e?t(`${date()} ${e}`,...n):t(date(),e,...n)}}}(),n.c[n.s]===e){const e=u.options({p:{type:"number",default:t.DEFAULT_PORT},i:{type:"boolean",default:!1},t:{type:"number",default:6e4},s:{choices:[v.SOCKETIO,v.WEBSOCKET],default:v.WEBSOCKET},u:{type:"boolean",default:!1}}).usage("Usage: $0 [-p port] [-i true/false] [-t connection_timeout_ms] -s [sio/ws]").alias("p","port").describe("p","Port for socket io").alias("i","ignoreDisconnects").describe("i","Toggles if disconnects should be ignored").alias("t","timeout").describe("t","Timeout before the service terminates if the client is not connected").alias("s","socket").describe("s","Set the socket to use").alias("u","uncaught").describe("u","Catches uncaught exceptions").help("h").argv,n=e.t,r=e.i;console.log("Will ignore disconnects: "+r);const o=e.p;if(!o)throw new Error("Missing server port as an argument");start(o,r,n,e.s,e.u)}}).call(this,n(34)(e))},function(e,t,n){"use strict";(function(t){var r=n(37),o=n(21).readFileSync,i=n(11),s=n(21).existsSync,a=n(555),c=n(583).version,u=n(584),l=n(29).EventEmitter,d=n(271),p=n(595),h=n(596),m=n(128),y=n(129)("socket.io:server"),g=n(51);e.exports=Server;var _=void 0,v=void 0;function Server(e,t){if(!(this instanceof Server))return new Server(e,t);"object"==typeof e&&e instanceof Object&&!e.listen&&(t=e,e=null),t=t||{},this.nsps={},this.parentNsps=new Map,this.path(t.path||"/socket.io"),this.serveClient(!1!==t.serveClient),this.parser=t.parser||m,this.encoder=new this.parser.Encoder,this.adapter(t.adapter||h),this.origins(t.origins||"*:*"),this.sockets=this.of("/"),e&&this.attach(e,t)}Server.prototype.checkRequest=function(e,t){var n=e.headers.origin||e.headers.referer;if("null"!=n&&null!=n||(n="*"),n&&"function"==typeof this._origins)return this._origins(n,t);if(-1!==this._origins.indexOf("*:*"))return t(null,!0);if(n)try{var r=g.parse(n),o="https:"==r.protocol?443:80;r.port=null!=r.port?r.port:o;var i=~this._origins.indexOf(r.protocol+"//"+r.hostname+":"+r.port)||~this._origins.indexOf(r.hostname+":"+r.port)||~this._origins.indexOf(r.hostname+":*")||~this._origins.indexOf("*:"+r.port);return y("origin %s is %svalid",n,i?"":"not "),t(null,!!i)}catch(e){}t(null,!1)},Server.prototype.serveClient=function(e){if(!arguments.length)return this._serveClient;this._serveClient=e;var resolvePath=function(e){var r=i.resolve(t,"./../../",e);return s(r)?r:n(597).resolve(e)};if(e&&!_){_=o(resolvePath("socket.io-client/dist/socket.io.js"),"utf-8");try{v=o(resolvePath("socket.io-client/dist/socket.io.js.map"),"utf-8")}catch(e){y("could not load sourcemap file")}}return this};var E={transports:"transports","heartbeat timeout":"pingTimeout","heartbeat interval":"pingInterval","destroy buffer size":"maxHttpBufferSize"};Server.prototype.set=function(e,t){return"authorization"==e&&t?this.use((function(e,n){t(e.request,(function(e,t){return e?n(new Error(e)):t?void n():n(new Error("Not authorized"))}))})):"origins"==e&&t?this.origins(t):"resource"==e?this.path(t):E[e]&&this.eio[E[e]]?this.eio[E[e]]=t:console.error("Option %s is not valid. Please refer to the README.",e),this},Server.prototype.checkNamespace=function(e,t,n){if(0===this.parentNsps.size)return n(!1);const r=this.parentNsps.keys(),run=()=>{let o=r.next();if(o.done)return n(!1);o.value(e,t,(t,r)=>{t||!r?run():n(this.parentNsps.get(o.value).createChild(e))})};run()},Server.prototype.path=function(e){return arguments.length?(this._path=e.replace(/\/$/,""),this):this._path},Server.prototype.adapter=function(e){if(!arguments.length)return this._adapter;for(var t in this._adapter=e,this.nsps)this.nsps.hasOwnProperty(t)&&this.nsps[t].initAdapter();return this},Server.prototype.origins=function(e){return arguments.length?(this._origins=e,this):this._origins},Server.prototype.listen=Server.prototype.attach=function(e,t){if("function"==typeof e){throw new Error("You are trying to attach socket.io to an express request handler function. Please pass a http.Server instance.")}if(Number(e)==e&&(e=Number(e)),"number"==typeof e){y("creating http server and binding to %d",e);var n=e;(e=r.Server((function(e,t){t.writeHead(404),t.end()}))).listen(n)}if((t=t||{}).path=t.path||this.path(),t.allowRequest=t.allowRequest||this.checkRequest.bind(this),this.sockets.fns.length>0)return this.initEngine(e,t),this;var o=this,i={type:m.CONNECT,nsp:"/"};return this.encoder.encode(i,(function(n){t.initialPacket=n,o.initEngine(e,t)})),this},Server.prototype.initEngine=function(e,t){y("creating engine.io instance with opts %j",t),this.eio=a.attach(e,t),this._serveClient&&this.attachServe(e),this.httpServer=e,this.bind(this.eio)},Server.prototype.attachServe=function(e){y("attaching client serving req handler");var t=this._path+"/socket.io.js",n=this._path+"/socket.io.js.map",r=e.listeners("request").slice(0),o=this;e.removeAllListeners("request"),e.on("request",(function(i,s){if(0===i.url.indexOf(n))o.serveMap(i,s);else if(0===i.url.indexOf(t))o.serve(i,s);else for(var a=0;a<r.length;a++)r[a].call(e,i,s)}))},Server.prototype.serve=function(e,t){var n='"'+c+'"',r=e.headers["if-none-match"];if(r&&n==r)return y("serve client 304"),t.writeHead(304),void t.end();y("serve client source"),t.setHeader("Content-Type","application/javascript"),t.setHeader("ETag",n),t.writeHead(200),t.end(_)},Server.prototype.serveMap=function(e,t){var n='"'+c+'"',r=e.headers["if-none-match"];if(r&&n==r)return y("serve client 304"),t.writeHead(304),void t.end();y("serve client sourcemap"),t.setHeader("Content-Type","application/json"),t.setHeader("ETag",n),t.writeHead(200),t.end(v)},Server.prototype.bind=function(e){return this.engine=e,this.engine.on("connection",this.onconnection.bind(this)),this},Server.prototype.onconnection=function(e){return y("incoming connection with id %s",e.id),new u(this,e).connect("/"),this},Server.prototype.of=function(e,t){if("function"==typeof e||e instanceof RegExp){const n=new p(this);return y("initializing parent namespace %s",n.name),"function"==typeof e?this.parentNsps.set(e,n):this.parentNsps.set((t,n,r)=>r(null,e.test(t)),n),t&&n.on("connect",t),n}"/"!==String(e)[0]&&(e="/"+e);var n=this.nsps[e];return n||(y("initializing namespace %s",e),n=new d(this,e),this.nsps[e]=n),t&&n.on("connect",t),n},Server.prototype.close=function(e){for(var t in this.nsps["/"].sockets)this.nsps["/"].sockets.hasOwnProperty(t)&&this.nsps["/"].sockets[t].onclose();this.engine.close(),this.httpServer?this.httpServer.close(e):e&&e()},Object.keys(l.prototype).filter((function(e){return"function"==typeof l.prototype[e]})).concat(["to","in","use","send","write","clients","compress","binary"]).forEach((function(e){Server.prototype[e]=function(){return this.sockets[e].apply(this.sockets,arguments)}})),d.flags.forEach((function(e){Object.defineProperty(Server.prototype,e,{get:function(){return this.sockets.flags=this.sockets.flags||{},this.sockets.flags[e]=!0,this}})})),Server.listen=Server}).call(this,"/")},function(e,t,n){var r=n(37);function attach(e,n){var r=new t.Server(n);return r.attach(e,n),r}(t=e.exports=function(){return arguments.length&&arguments[0]instanceof r.Server?attach.apply(this,arguments):t.Server.apply(null,arguments)}).protocol=1,t.Server=n(556),t.Socket=n(259),t.Transport=n(177),t.transports=n(256),t.parser=n(122),t.listen=function listen(e,n,o){"function"==typeof n&&(o=n,n={});var i=r.createServer((function(e,t){t.writeHead(501),t.end("Not Implemented")})),s=t.attach(i,n);return s.httpServer=i,i.listen(e,o),s},t.attach=attach},function(e,t,n){var r=n(176),o=n(51).parse,i=n(557),s=n(256),a=n(29).EventEmitter,c=n(259),u=n(12),l=n(93)("engine"),d=n(577);function Server(e){if(!(this instanceof Server))return new Server(e);this.clients={},this.clientsCount=0,e=e||{},this.wsEngine=e.wsEngine||process.env.EIO_WS_ENGINE||"ws",this.pingTimeout=e.pingTimeout||5e3,this.pingInterval=e.pingInterval||25e3,this.upgradeTimeout=e.upgradeTimeout||1e4,this.maxHttpBufferSize=e.maxHttpBufferSize||1e8,this.transports=e.transports||Object.keys(s),this.allowUpgrades=!1!==e.allowUpgrades,this.allowRequest=e.allowRequest,this.cookie=!1!==e.cookie&&(e.cookie||"io"),this.cookiePath=!1!==e.cookiePath&&(e.cookiePath||"/"),this.cookieHttpOnly=!1!==e.cookieHttpOnly,this.perMessageDeflate=!1!==e.perMessageDeflate&&(e.perMessageDeflate||!0),this.httpCompression=!1!==e.httpCompression&&(e.httpCompression||{}),this.initialPacket=e.initialPacket;var t=this;["perMessageDeflate","httpCompression"].forEach((function(e){var n=t[e];!0===n&&(t[e]=n={}),n&&null==n.threshold&&(n.threshold=1024)})),this.init()}function sendErrorMessage(e,t,n){var r={"Content-Type":"application/json"};if(!Server.errorMessages.hasOwnProperty(n))return t.writeHead(403,r),void t.end(JSON.stringify({code:Server.errors.FORBIDDEN,message:n||Server.errorMessages[Server.errors.FORBIDDEN]}));e.headers.origin?(r["Access-Control-Allow-Credentials"]="true",r["Access-Control-Allow-Origin"]=e.headers.origin):r["Access-Control-Allow-Origin"]="*",void 0!==t&&(t.writeHead(400,r),t.end(JSON.stringify({code:n,message:Server.errorMessages[n]})))}e.exports=Server,Server.errors={UNKNOWN_TRANSPORT:0,UNKNOWN_SID:1,BAD_HANDSHAKE_METHOD:2,BAD_REQUEST:3,FORBIDDEN:4},Server.errorMessages={0:"Transport unknown",1:"Session ID unknown",2:"Bad handshake method",3:"Bad request",4:"Forbidden"},u.inherits(Server,a),Server.prototype.init=function(){if(~this.transports.indexOf("websocket")){var e;switch(this.ws&&this.ws.close(),this.wsEngine){case"uws":e=n(!function webpackMissingModule(){var e=new Error("Cannot find module 'uws'");throw e.code="MODULE_NOT_FOUND",e}());break;case"ws":e=n(578);break;default:throw new Error("unknown wsEngine")}this.ws=new e.Server({noServer:!0,clientTracking:!1,perMessageDeflate:this.perMessageDeflate,maxPayload:this.maxHttpBufferSize})}},Server.prototype.upgrades=function(e){return this.allowUpgrades&&s[e].upgradesTo||[]},Server.prototype.verify=function(e,t,n){var r=e._query.transport;if(!~this.transports.indexOf(r))return l('unknown transport "%s"',r),n(Server.errors.UNKNOWN_TRANSPORT,!1);if(function checkInvalidHeaderChar(e){if((e+="").length<1)return!1;if(!p[e.charCodeAt(0)])return!0;if(e.length<2)return!1;if(!p[e.charCodeAt(1)])return!0;if(e.length<3)return!1;if(!p[e.charCodeAt(2)])return!0;if(e.length<4)return!1;if(!p[e.charCodeAt(3)])return!0;for(var t=4;t<e.length;++t)if(!p[e.charCodeAt(t)])return!0;return!1}(e.headers.origin))return e.headers.origin=null,n(Server.errors.BAD_REQUEST,!1);var o=e._query.sid;return o?this.clients.hasOwnProperty(o)?t||this.clients[o].transport.name===r?void n(null,!0):(l("bad request: unexpected transport without upgrade"),n(Server.errors.BAD_REQUEST,!1)):n(Server.errors.UNKNOWN_SID,!1):"GET"!==e.method?n(Server.errors.BAD_HANDSHAKE_METHOD,!1):this.allowRequest?this.allowRequest(e,n):n(null,!0)},Server.prototype.prepare=function(e){e._query||(e._query=~e.url.indexOf("?")?r.parse(o(e.url).query):{})},Server.prototype.close=function(){for(var e in l("closing all open clients"),this.clients)this.clients.hasOwnProperty(e)&&this.clients[e].close(!0);return this.ws&&(l("closing webSocketServer"),this.ws.close()),this},Server.prototype.handleRequest=function(e,t){l('handling "%s" http request "%s"',e.method,e.url),this.prepare(e),e.res=t;var n=this;this.verify(e,!1,(function(r,o){o?e._query.sid?(l("setting new request for existing client"),n.clients[e._query.sid].transport.onRequest(e)):n.handshake(e._query.transport,e):sendErrorMessage(e,t,r)}))},Server.prototype.generateId=function(e){return i.generateId()},Server.prototype.handshake=function(e,t){var n=this.generateId(t);l('handshaking client "%s"',n);try{var r=new s[e](t);"polling"===e?(r.maxHttpBufferSize=this.maxHttpBufferSize,r.httpCompression=this.httpCompression):"websocket"===e&&(r.perMessageDeflate=this.perMessageDeflate),t._query&&t._query.b64?r.supportsBinary=!1:r.supportsBinary=!0}catch(e){return void sendErrorMessage(t,t.res,Server.errors.BAD_REQUEST)}var o=new c(n,this,r,t),i=this;!1!==this.cookie&&r.on("headers",(function(e){e["Set-Cookie"]=d.serialize(i.cookie,n,{path:i.cookiePath,httpOnly:!!i.cookiePath&&i.cookieHttpOnly})})),r.onRequest(t),this.clients[n]=o,this.clientsCount++,o.once("close",(function(){delete i.clients[n],i.clientsCount--})),this.emit("connection",o)},Server.prototype.handleUpgrade=function(e,t,n){this.prepare(e);var r=this;this.verify(e,!0,(function(o,i){if(i){var s=new Buffer(n.length);n.copy(s),n=null,r.ws.handleUpgrade(e,t,s,(function(t){r.onWebSocket(e,t)}))}else(function abortConnection(e,t){if(e.writable){var n=Server.errorMessages.hasOwnProperty(t)?Server.errorMessages[t]:String(t||""),r=Buffer.byteLength(n);e.write("HTTP/1.1 400 Bad Request\r\nConnection: close\r\nContent-type: text/html\r\nContent-Length: "+r+"\r\n\r\n"+n)}e.destroy()})(t,o)}))},Server.prototype.onWebSocket=function(e,t){if(t.on("error",onUpgradeError),void 0!==s[e._query.transport]&&!s[e._query.transport].prototype.handlesUpgrades)return l("transport doesnt handle upgraded requests"),void t.close();var n=e._query.sid;if(e.websocket=t,n){var r=this.clients[n];if(r)if(r.upgrading)l("transport has already been trying to upgrade"),t.close();else if(r.upgraded)l("transport had already been upgraded"),t.close();else{l("upgrading existing transport"),t.removeListener("error",onUpgradeError);var o=new s[e._query.transport](e);e._query&&e._query.b64?o.supportsBinary=!1:o.supportsBinary=!0,o.perMessageDeflate=this.perMessageDeflate,r.maybeUpgrade(o)}else l("upgrade attempt for closed client"),t.close()}else t.removeListener("error",onUpgradeError),this.handshake(e._query.transport,e);function onUpgradeError(){l("websocket error before upgrade")}},Server.prototype.attach=function(e,t){var n=this,r=((t=t||{}).path||"/engine.io").replace(/\/$/,""),o=t.destroyUpgradeTimeout||1e3;function check(e){return("OPTIONS"!==e.method||!1!==t.handlePreflightRequest)&&r===e.url.substr(0,r.length)}r+="/";var i=e.listeners("request").slice(0);e.removeAllListeners("request"),e.on("close",n.close.bind(n)),e.on("listening",n.init.bind(n)),e.on("request",(function(o,s){if(check(o))l('intercepting request for path "%s"',r),"OPTIONS"===o.method&&"function"==typeof t.handlePreflightRequest?t.handlePreflightRequest.call(e,o,s):n.handleRequest(o,s);else for(var a=0,c=i.length;a<c;a++)i[a].call(e,o,s)})),~n.transports.indexOf("websocket")&&e.on("upgrade",(function(e,r,i){check(e)?n.handleUpgrade(e,r,i):!1!==t.destroyUpgrade&&setTimeout((function(){if(r.writable&&r.bytesWritten<=0)return r.end()}),o)}))};var p=[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},function(e,t,n){var r=n(16),Base64Id=function(){};Base64Id.prototype.getRandomBytes=function(e){var t=this;if((e=e||12)>4096)return r.randomBytes(e);var n=parseInt(4096/e),o=parseInt(.85*n);if(!o)return r.randomBytes(e);if(null==this.bytesBufferIndex&&(this.bytesBufferIndex=-1),this.bytesBufferIndex==n&&(this.bytesBuffer=null,this.bytesBufferIndex=-1),(-1==this.bytesBufferIndex||this.bytesBufferIndex>o)&&(this.isGeneratingBytes||(this.isGeneratingBytes=!0,r.randomBytes(4096,(function(e,n){t.bytesBuffer=n,t.bytesBufferIndex=0,t.isGeneratingBytes=!1}))),-1==this.bytesBufferIndex))return r.randomBytes(e);var i=this.bytesBuffer.slice(e*this.bytesBufferIndex,e*(this.bytesBufferIndex+1));return this.bytesBufferIndex++,i},Base64Id.prototype.generateId=function(){var e=new Buffer(15);return e.writeInt32BE?(this.sequenceNumber=this.sequenceNumber+1|0,e.writeInt32BE(this.sequenceNumber,11),r.randomBytes?this.getRandomBytes(12).copy(e):[0,4,8].forEach((function(t){e.writeInt32BE(Math.random()*Math.pow(2,32)|0,t)})),e.toString("base64").replace(/\//g,"_").replace(/\+/g,"-")):Math.abs(Math.random()*Math.random()*Date.now()|0).toString()+Math.abs(Math.random()*Math.random()*Date.now()|0).toString()},e.exports=new Base64Id},function(e,t,n){var r=n(257),o=n(12);function XHR(e){r.call(this,e)}e.exports=XHR,o.inherits(XHR,r),XHR.prototype.onRequest=function(e){if("OPTIONS"===e.method){var t=e.res,n=this.headers(e);n["Access-Control-Allow-Headers"]="Content-Type",t.writeHead(200,n),t.end()}else r.prototype.onRequest.call(this,e)},XHR.prototype.headers=function(e,t){return t=t||{},e.headers.origin?(t["Access-Control-Allow-Credentials"]="true",t["Access-Control-Allow-Origin"]=e.headers.origin):t["Access-Control-Allow-Origin"]="*",r.prototype.headers.call(this,e,t)}},function(e,t){var n,r,o,i=String.fromCharCode;function ucs2decode(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function checkScalarValue(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function createByte(e,t){return i(e>>t&63|128)}function encodeCodePoint(e,t){if(0==(4294967168&e))return i(e);var n="";return 0==(4294965248&e)?n=i(e>>6&31|192):0==(4294901760&e)?(checkScalarValue(e,t)||(e=65533),n=i(e>>12&15|224),n+=createByte(e,6)):0==(4292870144&e)&&(n=i(e>>18&7|240),n+=createByte(e,12),n+=createByte(e,6)),n+=i(63&e|128)}function readContinuationByte(){if(o>=r)throw Error("Invalid byte index");var e=255&n[o];if(o++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function decodeSymbol(e){var t,i;if(o>r)throw Error("Invalid byte index");if(o==r)return!1;if(t=255&n[o],o++,0==(128&t))return t;if(192==(224&t)){if((i=(31&t)<<6|readContinuationByte())>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&t)){if((i=(15&t)<<12|readContinuationByte()<<6|readContinuationByte())>=2048)return checkScalarValue(i,e)?i:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(i=(7&t)<<18|readContinuationByte()<<12|readContinuationByte()<<6|readContinuationByte())>=65536&&i<=1114111)return i;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function utf8encode(e,t){for(var n=!1!==(t=t||{}).strict,r=ucs2decode(e),o=r.length,i=-1,s="";++i<o;)s+=encodeCodePoint(r[i],n);return s},decode:function utf8decode(e,t){var s=!1!==(t=t||{}).strict;n=ucs2decode(e),r=n.length,o=0;for(var a,c=[];!1!==(a=decodeSymbol(s));)c.push(a);return function ucs2encode(e){for(var t,n=e.length,r=-1,o="";++r<n;)(t=e[r])>65535&&(o+=i((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=i(t);return o}(c)}}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){function noop(){}e.exports=function after(e,t,n){var r=!1;return n=n||noop,proxy.count=e,0===e?t():proxy;function proxy(e,o){if(proxy.count<=0)throw new Error("after called too many times");--proxy.count,e?(r=!0,t(e),t=n):0!==proxy.count||r||t(null,o)}}},function(e,t){e.exports=Object.keys||function keys(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},function(e,t,n){function load(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=n(258)).log=function log(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function formatArgs(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,r)},t.save=function save(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=load,t.useColors=function useColors(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function localstorage(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(load())},function(e,t){var n=1e3,r=6e4,o=60*r,i=24*o;function plural(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var s=typeof e;if("string"===s&&e.length>0)return function parse(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*o;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===s&&!1===isNaN(e))return t.long?function fmtLong(e){return plural(e,i,"day")||plural(e,o,"hour")||plural(e,r,"minute")||plural(e,n,"second")||e+" ms"}(e):function fmtShort(e){if(e>=i)return Math.round(e/i)+"d";if(e>=o)return Math.round(e/o)+"h";if(e>=r)return Math.round(e/r)+"m";if(e>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){var r=n(123),o=n(12);(t=e.exports=n(258)).init=function init(e){e.inspectOpts={};for(var n=Object.keys(t.inspectOpts),r=0;r<n.length;r++)e.inspectOpts[n[r]]=t.inspectOpts[n[r]]},t.log=function log(){return process.stderr.write(o.format.apply(o,arguments)+"\n")},t.formatArgs=function formatArgs(e){var n=this.namespace;if(this.useColors){var r=this.color,o="[3"+(r<8?r:"8;5;"+r),i="  "+o+";1m"+n+" [0m";e[0]=i+e[0].split("\n").join("\n"+i),e.push(o+"m+"+t.humanize(this.diff)+"[0m")}else e[0]=function getDate(){return t.inspectOpts.hideDate?"":(new Date).toISOString()+" "}()+n+" "+e[0]},t.save=function save(e){null==e?delete process.env.DEBUG:process.env.DEBUG=e},t.load=load,t.useColors=function useColors(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):r.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{var i=n(124);i&&i.level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}function load(){return process.env.DEBUG}t.inspectOpts=Object.keys(process.env).filter((function(e){return/^debug_/i.test(e)})).reduce((function(e,t){var n=t.substring(6).toLowerCase().replace(/_([a-z])/g,(function(e,t){return t.toUpperCase()})),r=process.env[t];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),e[n]=r,e}),{}),t.formatters.o=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts).split("\n").map((function(e){return e.trim()})).join(" ")},t.formatters.O=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts)},t.enable(load())},function(e,t,n){"use strict";var r=n(567),o=n(572);function Accepts(e){if(!(this instanceof Accepts))return new Accepts(e);this.headers=e.headers,this.negotiator=new r(e)}function extToMime(e){return-1===e.indexOf("/")?o.lookup(e):e}function validMime(e){return"string"==typeof e}e.exports=Accepts,Accepts.prototype.type=Accepts.prototype.types=function(e){var t=e;if(t&&!Array.isArray(t)){t=new Array(arguments.length);for(var n=0;n<t.length;n++)t[n]=arguments[n]}if(!t||0===t.length)return this.negotiator.mediaTypes();if(!this.headers.accept)return t[0];var r=t.map(extToMime),o=this.negotiator.mediaTypes(r.filter(validMime)),i=o[0];return!!i&&t[r.indexOf(i)]},Accepts.prototype.encoding=Accepts.prototype.encodings=function(e){var t=e;if(t&&!Array.isArray(t)){t=new Array(arguments.length);for(var n=0;n<t.length;n++)t[n]=arguments[n]}return t&&0!==t.length?this.negotiator.encodings(t)[0]||!1:this.negotiator.encodings()},Accepts.prototype.charset=Accepts.prototype.charsets=function(e){var t=e;if(t&&!Array.isArray(t)){t=new Array(arguments.length);for(var n=0;n<t.length;n++)t[n]=arguments[n]}return t&&0!==t.length?this.negotiator.charsets(t)[0]||!1:this.negotiator.charsets()},Accepts.prototype.lang=Accepts.prototype.langs=Accepts.prototype.language=Accepts.prototype.languages=function(e){var t=e;if(t&&!Array.isArray(t)){t=new Array(arguments.length);for(var n=0;n<t.length;n++)t[n]=arguments[n]}return t&&0!==t.length?this.negotiator.languages(t)[0]||!1:this.negotiator.languages()}},function(e,t,n){"use strict";var r=Object.create(null);function Negotiator(e){if(!(this instanceof Negotiator))return new Negotiator(e);this.request=e}function loadModule(e){var t=r[e];if(void 0!==t)return t;switch(e){case"charset":t=n(568);break;case"encoding":t=n(569);break;case"language":t=n(570);break;case"mediaType":t=n(571);break;default:throw new Error("Cannot find module '"+e+"'")}return r[e]=t,t}e.exports=Negotiator,e.exports.Negotiator=Negotiator,Negotiator.prototype.charset=function charset(e){var t=this.charsets(e);return t&&t[0]},Negotiator.prototype.charsets=function charsets(e){return(0,loadModule("charset").preferredCharsets)(this.request.headers["accept-charset"],e)},Negotiator.prototype.encoding=function encoding(e){var t=this.encodings(e);return t&&t[0]},Negotiator.prototype.encodings=function encodings(e){return(0,loadModule("encoding").preferredEncodings)(this.request.headers["accept-encoding"],e)},Negotiator.prototype.language=function language(e){var t=this.languages(e);return t&&t[0]},Negotiator.prototype.languages=function languages(e){return(0,loadModule("language").preferredLanguages)(this.request.headers["accept-language"],e)},Negotiator.prototype.mediaType=function mediaType(e){var t=this.mediaTypes(e);return t&&t[0]},Negotiator.prototype.mediaTypes=function mediaTypes(e){return(0,loadModule("mediaType").preferredMediaTypes)(this.request.headers.accept,e)},Negotiator.prototype.preferredCharset=Negotiator.prototype.charset,Negotiator.prototype.preferredCharsets=Negotiator.prototype.charsets,Negotiator.prototype.preferredEncoding=Negotiator.prototype.encoding,Negotiator.prototype.preferredEncodings=Negotiator.prototype.encodings,Negotiator.prototype.preferredLanguage=Negotiator.prototype.language,Negotiator.prototype.preferredLanguages=Negotiator.prototype.languages,Negotiator.prototype.preferredMediaType=Negotiator.prototype.mediaType,Negotiator.prototype.preferredMediaTypes=Negotiator.prototype.mediaTypes},function(e,t,n){"use strict";e.exports=preferredCharsets,e.exports.preferredCharsets=preferredCharsets;var r=/^\s*([^\s;]+)\s*(?:;(.*))?$/;function parseCharset(e,t){var n=r.exec(e);if(!n)return null;var o=n[1],i=1;if(n[2])for(var s=n[2].split(";"),a=0;a<s.length;a++){var c=s[a].trim().split("=");if("q"===c[0]){i=parseFloat(c[1]);break}}return{charset:o,q:i,i:t}}function specify(e,t,n){var r=0;if(t.charset.toLowerCase()===e.toLowerCase())r|=1;else if("*"!==t.charset)return null;return{i:n,o:t.i,q:t.q,s:r}}function preferredCharsets(e,t){var n=function parseAcceptCharset(e){for(var t=e.split(","),n=0,r=0;n<t.length;n++){var o=parseCharset(t[n].trim(),n);o&&(t[r++]=o)}return t.length=r,t}(void 0===e?"*":e||"");if(!t)return n.filter(isQuality).sort(compareSpecs).map(getFullCharset);var r=t.map((function getPriority(e,t){return function getCharsetPriority(e,t,n){for(var r={o:-1,q:0,s:0},o=0;o<t.length;o++){var i=specify(e,t[o],n);i&&(r.s-i.s||r.q-i.q||r.o-i.o)<0&&(r=i)}return r}(e,n,t)}));return r.filter(isQuality).sort(compareSpecs).map((function getCharset(e){return t[r.indexOf(e)]}))}function compareSpecs(e,t){return t.q-e.q||t.s-e.s||e.o-t.o||e.i-t.i||0}function getFullCharset(e){return e.charset}function isQuality(e){return e.q>0}},function(e,t,n){"use strict";e.exports=preferredEncodings,e.exports.preferredEncodings=preferredEncodings;var r=/^\s*([^\s;]+)\s*(?:;(.*))?$/;function parseEncoding(e,t){var n=r.exec(e);if(!n)return null;var o=n[1],i=1;if(n[2])for(var s=n[2].split(";"),a=0;a<s.length;a++){var c=s[a].trim().split("=");if("q"===c[0]){i=parseFloat(c[1]);break}}return{encoding:o,q:i,i:t}}function specify(e,t,n){var r=0;if(t.encoding.toLowerCase()===e.toLowerCase())r|=1;else if("*"!==t.encoding)return null;return{i:n,o:t.i,q:t.q,s:r}}function preferredEncodings(e,t){var n=function parseAcceptEncoding(e){for(var t=e.split(","),n=!1,r=1,o=0,i=0;o<t.length;o++){var s=parseEncoding(t[o].trim(),o);s&&(t[i++]=s,n=n||specify("identity",s),r=Math.min(r,s.q||1))}return n||(t[i++]={encoding:"identity",q:r,i:o}),t.length=i,t}(e||"");if(!t)return n.filter(isQuality).sort(compareSpecs).map(getFullEncoding);var r=t.map((function getPriority(e,t){return function getEncodingPriority(e,t,n){for(var r={o:-1,q:0,s:0},o=0;o<t.length;o++){var i=specify(e,t[o],n);i&&(r.s-i.s||r.q-i.q||r.o-i.o)<0&&(r=i)}return r}(e,n,t)}));return r.filter(isQuality).sort(compareSpecs).map((function getEncoding(e){return t[r.indexOf(e)]}))}function compareSpecs(e,t){return t.q-e.q||t.s-e.s||e.o-t.o||e.i-t.i||0}function getFullEncoding(e){return e.encoding}function isQuality(e){return e.q>0}},function(e,t,n){"use strict";e.exports=preferredLanguages,e.exports.preferredLanguages=preferredLanguages;var r=/^\s*([^\s\-;]+)(?:-([^\s;]+))?\s*(?:;(.*))?$/;function parseLanguage(e,t){var n=r.exec(e);if(!n)return null;var o=n[1],i=n[2],s=o;i&&(s+="-"+i);var a=1;if(n[3])for(var c=n[3].split(";"),u=0;u<c.length;u++){var l=c[u].split("=");"q"===l[0]&&(a=parseFloat(l[1]))}return{prefix:o,suffix:i,q:a,i:t,full:s}}function specify(e,t,n){var r=parseLanguage(e);if(!r)return null;var o=0;if(t.full.toLowerCase()===r.full.toLowerCase())o|=4;else if(t.prefix.toLowerCase()===r.full.toLowerCase())o|=2;else if(t.full.toLowerCase()===r.prefix.toLowerCase())o|=1;else if("*"!==t.full)return null;return{i:n,o:t.i,q:t.q,s:o}}function preferredLanguages(e,t){var n=function parseAcceptLanguage(e){for(var t=e.split(","),n=0,r=0;n<t.length;n++){var o=parseLanguage(t[n].trim(),n);o&&(t[r++]=o)}return t.length=r,t}(void 0===e?"*":e||"");if(!t)return n.filter(isQuality).sort(compareSpecs).map(getFullLanguage);var r=t.map((function getPriority(e,t){return function getLanguagePriority(e,t,n){for(var r={o:-1,q:0,s:0},o=0;o<t.length;o++){var i=specify(e,t[o],n);i&&(r.s-i.s||r.q-i.q||r.o-i.o)<0&&(r=i)}return r}(e,n,t)}));return r.filter(isQuality).sort(compareSpecs).map((function getLanguage(e){return t[r.indexOf(e)]}))}function compareSpecs(e,t){return t.q-e.q||t.s-e.s||e.o-t.o||e.i-t.i||0}function getFullLanguage(e){return e.full}function isQuality(e){return e.q>0}},function(e,t,n){"use strict";e.exports=preferredMediaTypes,e.exports.preferredMediaTypes=preferredMediaTypes;var r=/^\s*([^\s\/;]+)\/([^;\s]+)\s*(?:;(.*))?$/;function parseAccept(e){for(var t=function splitMediaTypes(e){for(var t=e.split(","),n=1,r=0;n<t.length;n++)quoteCount(t[r])%2==0?t[++r]=t[n]:t[r]+=","+t[n];return t.length=r+1,t}(e),n=0,r=0;n<t.length;n++){var o=parseMediaType(t[n].trim(),n);o&&(t[r++]=o)}return t.length=r,t}function parseMediaType(e,t){var n=r.exec(e);if(!n)return null;var o=Object.create(null),i=1,s=n[2],a=n[1];if(n[3])for(var c=function splitParameters(e){for(var t=e.split(";"),n=1,r=0;n<t.length;n++)quoteCount(t[r])%2==0?t[++r]=t[n]:t[r]+=";"+t[n];t.length=r+1;for(n=0;n<t.length;n++)t[n]=t[n].trim();return t}(n[3]).map(splitKeyValuePair),u=0;u<c.length;u++){var l=c[u],d=l[0].toLowerCase(),p=l[1],h=p&&'"'===p[0]&&'"'===p[p.length-1]?p.substr(1,p.length-2):p;if("q"===d){i=parseFloat(h);break}o[d]=h}return{type:a,subtype:s,params:o,q:i,i:t}}function specify(e,t,n){var r=parseMediaType(e),o=0;if(!r)return null;if(t.type.toLowerCase()==r.type.toLowerCase())o|=4;else if("*"!=t.type)return null;if(t.subtype.toLowerCase()==r.subtype.toLowerCase())o|=2;else if("*"!=t.subtype)return null;var i=Object.keys(t.params);if(i.length>0){if(!i.every((function(e){return"*"==t.params[e]||(t.params[e]||"").toLowerCase()==(r.params[e]||"").toLowerCase()})))return null;o|=1}return{i:n,o:t.i,q:t.q,s:o}}function preferredMediaTypes(e,t){var n=parseAccept(void 0===e?"*/*":e||"");if(!t)return n.filter(isQuality).sort(compareSpecs).map(getFullType);var r=t.map((function getPriority(e,t){return function getMediaTypePriority(e,t,n){for(var r={o:-1,q:0,s:0},o=0;o<t.length;o++){var i=specify(e,t[o],n);i&&(r.s-i.s||r.q-i.q||r.o-i.o)<0&&(r=i)}return r}(e,n,t)}));return r.filter(isQuality).sort(compareSpecs).map((function getType(e){return t[r.indexOf(e)]}))}function compareSpecs(e,t){return t.q-e.q||t.s-e.s||e.o-t.o||e.i-t.i||0}function getFullType(e){return e.type+"/"+e.subtype}function isQuality(e){return e.q>0}function quoteCount(e){for(var t=0,n=0;-1!==(n=e.indexOf('"',n));)t++,n++;return t}function splitKeyValuePair(e){var t,n,r=e.indexOf("=");return-1===r?t=e:(t=e.substr(0,r),n=e.substr(r+1)),[t,n]}},function(e,t,n){"use strict";var r=n(573),o=n(11).extname,i=/^\s*([^;\s]*)(?:;|\s|$)/,s=/^text\//i;function charset(e){if(!e||"string"!=typeof e)return!1;var t=i.exec(e),n=t&&r[t[1].toLowerCase()];return n&&n.charset?n.charset:!(!t||!s.test(t[1]))&&"UTF-8"}t.charset=charset,t.charsets={lookup:charset},t.contentType=function contentType(e){if(!e||"string"!=typeof e)return!1;var n=-1===e.indexOf("/")?t.lookup(e):e;if(!n)return!1;if(-1===n.indexOf("charset")){var r=t.charset(n);r&&(n+="; charset="+r.toLowerCase())}return n},t.extension=function extension(e){if(!e||"string"!=typeof e)return!1;var n=i.exec(e),r=n&&t.extensions[n[1].toLowerCase()];if(!r||!r.length)return!1;return r[0]},t.extensions=Object.create(null),t.lookup=function lookup(e){if(!e||"string"!=typeof e)return!1;var n=o("x."+e).toLowerCase().substr(1);if(!n)return!1;return t.types[n]||!1},t.types=Object.create(null),function populateMaps(e,t){var n=["nginx","apache",void 0,"iana"];Object.keys(r).forEach((function forEachMimeType(o){var i=r[o],s=i.extensions;if(s&&s.length){e[o]=s;for(var a=0;a<s.length;a++){var c=s[a];if(t[c]){var u=n.indexOf(r[t[c]].source),l=n.indexOf(i.source);if("application/octet-stream"!==t[c]&&(u>l||u===l&&"application/"===t[c].substr(0,12)))continue}t[c]=o}}}))}(t.extensions,t.types)},function(e,t,n){e.exports=n(574)},function(e){e.exports=JSON.parse('{"application/1d-interleaved-parityfec":{"source":"iana"},"application/3gpdash-qoe-report+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/3gpp-ims+xml":{"source":"iana","compressible":true},"application/a2l":{"source":"iana"},"application/activemessage":{"source":"iana"},"application/activity+json":{"source":"iana","compressible":true},"application/alto-costmap+json":{"source":"iana","compressible":true},"application/alto-costmapfilter+json":{"source":"iana","compressible":true},"application/alto-directory+json":{"source":"iana","compressible":true},"application/alto-endpointcost+json":{"source":"iana","compressible":true},"application/alto-endpointcostparams+json":{"source":"iana","compressible":true},"application/alto-endpointprop+json":{"source":"iana","compressible":true},"application/alto-endpointpropparams+json":{"source":"iana","compressible":true},"application/alto-error+json":{"source":"iana","compressible":true},"application/alto-networkmap+json":{"source":"iana","compressible":true},"application/alto-networkmapfilter+json":{"source":"iana","compressible":true},"application/alto-updatestreamcontrol+json":{"source":"iana","compressible":true},"application/alto-updatestreamparams+json":{"source":"iana","compressible":true},"application/aml":{"source":"iana"},"application/andrew-inset":{"source":"iana","extensions":["ez"]},"application/applefile":{"source":"iana"},"application/applixware":{"source":"apache","extensions":["aw"]},"application/atf":{"source":"iana"},"application/atfx":{"source":"iana"},"application/atom+xml":{"source":"iana","compressible":true,"extensions":["atom"]},"application/atomcat+xml":{"source":"iana","compressible":true,"extensions":["atomcat"]},"application/atomdeleted+xml":{"source":"iana","compressible":true,"extensions":["atomdeleted"]},"application/atomicmail":{"source":"iana"},"application/atomsvc+xml":{"source":"iana","compressible":true,"extensions":["atomsvc"]},"application/atsc-dwd+xml":{"source":"iana","compressible":true,"extensions":["dwd"]},"application/atsc-dynamic-event-message":{"source":"iana"},"application/atsc-held+xml":{"source":"iana","compressible":true,"extensions":["held"]},"application/atsc-rdt+json":{"source":"iana","compressible":true},"application/atsc-rsat+xml":{"source":"iana","compressible":true,"extensions":["rsat"]},"application/atxml":{"source":"iana"},"application/auth-policy+xml":{"source":"iana","compressible":true},"application/bacnet-xdd+zip":{"source":"iana","compressible":false},"application/batch-smtp":{"source":"iana"},"application/bdoc":{"compressible":false,"extensions":["bdoc"]},"application/beep+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/calendar+json":{"source":"iana","compressible":true},"application/calendar+xml":{"source":"iana","compressible":true,"extensions":["xcs"]},"application/call-completion":{"source":"iana"},"application/cals-1840":{"source":"iana"},"application/captive+json":{"source":"iana","compressible":true},"application/cbor":{"source":"iana"},"application/cbor-seq":{"source":"iana"},"application/cccex":{"source":"iana"},"application/ccmp+xml":{"source":"iana","compressible":true},"application/ccxml+xml":{"source":"iana","compressible":true,"extensions":["ccxml"]},"application/cdfx+xml":{"source":"iana","compressible":true,"extensions":["cdfx"]},"application/cdmi-capability":{"source":"iana","extensions":["cdmia"]},"application/cdmi-container":{"source":"iana","extensions":["cdmic"]},"application/cdmi-domain":{"source":"iana","extensions":["cdmid"]},"application/cdmi-object":{"source":"iana","extensions":["cdmio"]},"application/cdmi-queue":{"source":"iana","extensions":["cdmiq"]},"application/cdni":{"source":"iana"},"application/cea":{"source":"iana"},"application/cea-2018+xml":{"source":"iana","compressible":true},"application/cellml+xml":{"source":"iana","compressible":true},"application/cfw":{"source":"iana"},"application/clr":{"source":"iana"},"application/clue+xml":{"source":"iana","compressible":true},"application/clue_info+xml":{"source":"iana","compressible":true},"application/cms":{"source":"iana"},"application/cnrp+xml":{"source":"iana","compressible":true},"application/coap-group+json":{"source":"iana","compressible":true},"application/coap-payload":{"source":"iana"},"application/commonground":{"source":"iana"},"application/conference-info+xml":{"source":"iana","compressible":true},"application/cose":{"source":"iana"},"application/cose-key":{"source":"iana"},"application/cose-key-set":{"source":"iana"},"application/cpl+xml":{"source":"iana","compressible":true},"application/csrattrs":{"source":"iana"},"application/csta+xml":{"source":"iana","compressible":true},"application/cstadata+xml":{"source":"iana","compressible":true},"application/csvm+json":{"source":"iana","compressible":true},"application/cu-seeme":{"source":"apache","extensions":["cu"]},"application/cwt":{"source":"iana"},"application/cybercash":{"source":"iana"},"application/dart":{"compressible":true},"application/dash+xml":{"source":"iana","compressible":true,"extensions":["mpd"]},"application/dashdelta":{"source":"iana"},"application/davmount+xml":{"source":"iana","compressible":true,"extensions":["davmount"]},"application/dca-rft":{"source":"iana"},"application/dcd":{"source":"iana"},"application/dec-dx":{"source":"iana"},"application/dialog-info+xml":{"source":"iana","compressible":true},"application/dicom":{"source":"iana"},"application/dicom+json":{"source":"iana","compressible":true},"application/dicom+xml":{"source":"iana","compressible":true},"application/dii":{"source":"iana"},"application/dit":{"source":"iana"},"application/dns":{"source":"iana"},"application/dns+json":{"source":"iana","compressible":true},"application/dns-message":{"source":"iana"},"application/docbook+xml":{"source":"apache","compressible":true,"extensions":["dbk"]},"application/dots+cbor":{"source":"iana"},"application/dskpp+xml":{"source":"iana","compressible":true},"application/dssc+der":{"source":"iana","extensions":["dssc"]},"application/dssc+xml":{"source":"iana","compressible":true,"extensions":["xdssc"]},"application/dvcs":{"source":"iana"},"application/ecmascript":{"source":"iana","compressible":true,"extensions":["ecma","es"]},"application/edi-consent":{"source":"iana"},"application/edi-x12":{"source":"iana","compressible":false},"application/edifact":{"source":"iana","compressible":false},"application/efi":{"source":"iana"},"application/elm+json":{"source":"iana","charset":"UTF-8","compressible":true},"application/elm+xml":{"source":"iana","compressible":true},"application/emergencycalldata.cap+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/emergencycalldata.comment+xml":{"source":"iana","compressible":true},"application/emergencycalldata.control+xml":{"source":"iana","compressible":true},"application/emergencycalldata.deviceinfo+xml":{"source":"iana","compressible":true},"application/emergencycalldata.ecall.msd":{"source":"iana"},"application/emergencycalldata.providerinfo+xml":{"source":"iana","compressible":true},"application/emergencycalldata.serviceinfo+xml":{"source":"iana","compressible":true},"application/emergencycalldata.subscriberinfo+xml":{"source":"iana","compressible":true},"application/emergencycalldata.veds+xml":{"source":"iana","compressible":true},"application/emma+xml":{"source":"iana","compressible":true,"extensions":["emma"]},"application/emotionml+xml":{"source":"iana","compressible":true,"extensions":["emotionml"]},"application/encaprtp":{"source":"iana"},"application/epp+xml":{"source":"iana","compressible":true},"application/epub+zip":{"source":"iana","compressible":false,"extensions":["epub"]},"application/eshop":{"source":"iana"},"application/exi":{"source":"iana","extensions":["exi"]},"application/expect-ct-report+json":{"source":"iana","compressible":true},"application/fastinfoset":{"source":"iana"},"application/fastsoap":{"source":"iana"},"application/fdt+xml":{"source":"iana","compressible":true,"extensions":["fdt"]},"application/fhir+json":{"source":"iana","charset":"UTF-8","compressible":true},"application/fhir+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/fido.trusted-apps+json":{"compressible":true},"application/fits":{"source":"iana"},"application/flexfec":{"source":"iana"},"application/font-sfnt":{"source":"iana"},"application/font-tdpfr":{"source":"iana","extensions":["pfr"]},"application/font-woff":{"source":"iana","compressible":false},"application/framework-attributes+xml":{"source":"iana","compressible":true},"application/geo+json":{"source":"iana","compressible":true,"extensions":["geojson"]},"application/geo+json-seq":{"source":"iana"},"application/geopackage+sqlite3":{"source":"iana"},"application/geoxacml+xml":{"source":"iana","compressible":true},"application/gltf-buffer":{"source":"iana"},"application/gml+xml":{"source":"iana","compressible":true,"extensions":["gml"]},"application/gpx+xml":{"source":"apache","compressible":true,"extensions":["gpx"]},"application/gxf":{"source":"apache","extensions":["gxf"]},"application/gzip":{"source":"iana","compressible":false,"extensions":["gz"]},"application/h224":{"source":"iana"},"application/held+xml":{"source":"iana","compressible":true},"application/hjson":{"extensions":["hjson"]},"application/http":{"source":"iana"},"application/hyperstudio":{"source":"iana","extensions":["stk"]},"application/ibe-key-request+xml":{"source":"iana","compressible":true},"application/ibe-pkg-reply+xml":{"source":"iana","compressible":true},"application/ibe-pp-data":{"source":"iana"},"application/iges":{"source":"iana"},"application/im-iscomposing+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/index":{"source":"iana"},"application/index.cmd":{"source":"iana"},"application/index.obj":{"source":"iana"},"application/index.response":{"source":"iana"},"application/index.vnd":{"source":"iana"},"application/inkml+xml":{"source":"iana","compressible":true,"extensions":["ink","inkml"]},"application/iotp":{"source":"iana"},"application/ipfix":{"source":"iana","extensions":["ipfix"]},"application/ipp":{"source":"iana"},"application/isup":{"source":"iana"},"application/its+xml":{"source":"iana","compressible":true,"extensions":["its"]},"application/java-archive":{"source":"apache","compressible":false,"extensions":["jar","war","ear"]},"application/java-serialized-object":{"source":"apache","compressible":false,"extensions":["ser"]},"application/java-vm":{"source":"apache","compressible":false,"extensions":["class"]},"application/javascript":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["js","mjs"]},"application/jf2feed+json":{"source":"iana","compressible":true},"application/jose":{"source":"iana"},"application/jose+json":{"source":"iana","compressible":true},"application/jrd+json":{"source":"iana","compressible":true},"application/jscalendar+json":{"source":"iana","compressible":true},"application/json":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["json","map"]},"application/json-patch+json":{"source":"iana","compressible":true},"application/json-seq":{"source":"iana"},"application/json5":{"extensions":["json5"]},"application/jsonml+json":{"source":"apache","compressible":true,"extensions":["jsonml"]},"application/jwk+json":{"source":"iana","compressible":true},"application/jwk-set+json":{"source":"iana","compressible":true},"application/jwt":{"source":"iana"},"application/kpml-request+xml":{"source":"iana","compressible":true},"application/kpml-response+xml":{"source":"iana","compressible":true},"application/ld+json":{"source":"iana","compressible":true,"extensions":["jsonld"]},"application/lgr+xml":{"source":"iana","compressible":true,"extensions":["lgr"]},"application/link-format":{"source":"iana"},"application/load-control+xml":{"source":"iana","compressible":true},"application/lost+xml":{"source":"iana","compressible":true,"extensions":["lostxml"]},"application/lostsync+xml":{"source":"iana","compressible":true},"application/lpf+zip":{"source":"iana","compressible":false},"application/lxf":{"source":"iana"},"application/mac-binhex40":{"source":"iana","extensions":["hqx"]},"application/mac-compactpro":{"source":"apache","extensions":["cpt"]},"application/macwriteii":{"source":"iana"},"application/mads+xml":{"source":"iana","compressible":true,"extensions":["mads"]},"application/manifest+json":{"charset":"UTF-8","compressible":true,"extensions":["webmanifest"]},"application/marc":{"source":"iana","extensions":["mrc"]},"application/marcxml+xml":{"source":"iana","compressible":true,"extensions":["mrcx"]},"application/mathematica":{"source":"iana","extensions":["ma","nb","mb"]},"application/mathml+xml":{"source":"iana","compressible":true,"extensions":["mathml"]},"application/mathml-content+xml":{"source":"iana","compressible":true},"application/mathml-presentation+xml":{"source":"iana","compressible":true},"application/mbms-associated-procedure-description+xml":{"source":"iana","compressible":true},"application/mbms-deregister+xml":{"source":"iana","compressible":true},"application/mbms-envelope+xml":{"source":"iana","compressible":true},"application/mbms-msk+xml":{"source":"iana","compressible":true},"application/mbms-msk-response+xml":{"source":"iana","compressible":true},"application/mbms-protection-description+xml":{"source":"iana","compressible":true},"application/mbms-reception-report+xml":{"source":"iana","compressible":true},"application/mbms-register+xml":{"source":"iana","compressible":true},"application/mbms-register-response+xml":{"source":"iana","compressible":true},"application/mbms-schedule+xml":{"source":"iana","compressible":true},"application/mbms-user-service-description+xml":{"source":"iana","compressible":true},"application/mbox":{"source":"iana","extensions":["mbox"]},"application/media-policy-dataset+xml":{"source":"iana","compressible":true},"application/media_control+xml":{"source":"iana","compressible":true},"application/mediaservercontrol+xml":{"source":"iana","compressible":true,"extensions":["mscml"]},"application/merge-patch+json":{"source":"iana","compressible":true},"application/metalink+xml":{"source":"apache","compressible":true,"extensions":["metalink"]},"application/metalink4+xml":{"source":"iana","compressible":true,"extensions":["meta4"]},"application/mets+xml":{"source":"iana","compressible":true,"extensions":["mets"]},"application/mf4":{"source":"iana"},"application/mikey":{"source":"iana"},"application/mipc":{"source":"iana"},"application/mmt-aei+xml":{"source":"iana","compressible":true,"extensions":["maei"]},"application/mmt-usd+xml":{"source":"iana","compressible":true,"extensions":["musd"]},"application/mods+xml":{"source":"iana","compressible":true,"extensions":["mods"]},"application/moss-keys":{"source":"iana"},"application/moss-signature":{"source":"iana"},"application/mosskey-data":{"source":"iana"},"application/mosskey-request":{"source":"iana"},"application/mp21":{"source":"iana","extensions":["m21","mp21"]},"application/mp4":{"source":"iana","extensions":["mp4s","m4p"]},"application/mpeg4-generic":{"source":"iana"},"application/mpeg4-iod":{"source":"iana"},"application/mpeg4-iod-xmt":{"source":"iana"},"application/mrb-consumer+xml":{"source":"iana","compressible":true,"extensions":["xdf"]},"application/mrb-publish+xml":{"source":"iana","compressible":true,"extensions":["xdf"]},"application/msc-ivr+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/msc-mixer+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/msword":{"source":"iana","compressible":false,"extensions":["doc","dot"]},"application/mud+json":{"source":"iana","compressible":true},"application/multipart-core":{"source":"iana"},"application/mxf":{"source":"iana","extensions":["mxf"]},"application/n-quads":{"source":"iana","extensions":["nq"]},"application/n-triples":{"source":"iana","extensions":["nt"]},"application/nasdata":{"source":"iana"},"application/news-checkgroups":{"source":"iana","charset":"US-ASCII"},"application/news-groupinfo":{"source":"iana","charset":"US-ASCII"},"application/news-transmission":{"source":"iana"},"application/nlsml+xml":{"source":"iana","compressible":true},"application/node":{"source":"iana","extensions":["cjs"]},"application/nss":{"source":"iana"},"application/ocsp-request":{"source":"iana"},"application/ocsp-response":{"source":"iana"},"application/octet-stream":{"source":"iana","compressible":false,"extensions":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"]},"application/oda":{"source":"iana","extensions":["oda"]},"application/odm+xml":{"source":"iana","compressible":true},"application/odx":{"source":"iana"},"application/oebps-package+xml":{"source":"iana","compressible":true,"extensions":["opf"]},"application/ogg":{"source":"iana","compressible":false,"extensions":["ogx"]},"application/omdoc+xml":{"source":"apache","compressible":true,"extensions":["omdoc"]},"application/onenote":{"source":"apache","extensions":["onetoc","onetoc2","onetmp","onepkg"]},"application/opc-nodeset+xml":{"source":"iana","compressible":true},"application/oscore":{"source":"iana"},"application/oxps":{"source":"iana","extensions":["oxps"]},"application/p2p-overlay+xml":{"source":"iana","compressible":true,"extensions":["relo"]},"application/parityfec":{"source":"iana"},"application/passport":{"source":"iana"},"application/patch-ops-error+xml":{"source":"iana","compressible":true,"extensions":["xer"]},"application/pdf":{"source":"iana","compressible":false,"extensions":["pdf"]},"application/pdx":{"source":"iana"},"application/pem-certificate-chain":{"source":"iana"},"application/pgp-encrypted":{"source":"iana","compressible":false,"extensions":["pgp"]},"application/pgp-keys":{"source":"iana"},"application/pgp-signature":{"source":"iana","extensions":["asc","sig"]},"application/pics-rules":{"source":"apache","extensions":["prf"]},"application/pidf+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/pidf-diff+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/pkcs10":{"source":"iana","extensions":["p10"]},"application/pkcs12":{"source":"iana"},"application/pkcs7-mime":{"source":"iana","extensions":["p7m","p7c"]},"application/pkcs7-signature":{"source":"iana","extensions":["p7s"]},"application/pkcs8":{"source":"iana","extensions":["p8"]},"application/pkcs8-encrypted":{"source":"iana"},"application/pkix-attr-cert":{"source":"iana","extensions":["ac"]},"application/pkix-cert":{"source":"iana","extensions":["cer"]},"application/pkix-crl":{"source":"iana","extensions":["crl"]},"application/pkix-pkipath":{"source":"iana","extensions":["pkipath"]},"application/pkixcmp":{"source":"iana","extensions":["pki"]},"application/pls+xml":{"source":"iana","compressible":true,"extensions":["pls"]},"application/poc-settings+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/postscript":{"source":"iana","compressible":true,"extensions":["ai","eps","ps"]},"application/ppsp-tracker+json":{"source":"iana","compressible":true},"application/problem+json":{"source":"iana","compressible":true},"application/problem+xml":{"source":"iana","compressible":true},"application/provenance+xml":{"source":"iana","compressible":true,"extensions":["provx"]},"application/prs.alvestrand.titrax-sheet":{"source":"iana"},"application/prs.cww":{"source":"iana","extensions":["cww"]},"application/prs.cyn":{"source":"iana","charset":"7-BIT"},"application/prs.hpub+zip":{"source":"iana","compressible":false},"application/prs.nprend":{"source":"iana"},"application/prs.plucker":{"source":"iana"},"application/prs.rdf-xml-crypt":{"source":"iana"},"application/prs.xsf+xml":{"source":"iana","compressible":true},"application/pskc+xml":{"source":"iana","compressible":true,"extensions":["pskcxml"]},"application/pvd+json":{"source":"iana","compressible":true},"application/qsig":{"source":"iana"},"application/raml+yaml":{"compressible":true,"extensions":["raml"]},"application/raptorfec":{"source":"iana"},"application/rdap+json":{"source":"iana","compressible":true},"application/rdf+xml":{"source":"iana","compressible":true,"extensions":["rdf","owl"]},"application/reginfo+xml":{"source":"iana","compressible":true,"extensions":["rif"]},"application/relax-ng-compact-syntax":{"source":"iana","extensions":["rnc"]},"application/remote-printing":{"source":"iana"},"application/reputon+json":{"source":"iana","compressible":true},"application/resource-lists+xml":{"source":"iana","compressible":true,"extensions":["rl"]},"application/resource-lists-diff+xml":{"source":"iana","compressible":true,"extensions":["rld"]},"application/rfc+xml":{"source":"iana","compressible":true},"application/riscos":{"source":"iana"},"application/rlmi+xml":{"source":"iana","compressible":true},"application/rls-services+xml":{"source":"iana","compressible":true,"extensions":["rs"]},"application/route-apd+xml":{"source":"iana","compressible":true,"extensions":["rapd"]},"application/route-s-tsid+xml":{"source":"iana","compressible":true,"extensions":["sls"]},"application/route-usd+xml":{"source":"iana","compressible":true,"extensions":["rusd"]},"application/rpki-ghostbusters":{"source":"iana","extensions":["gbr"]},"application/rpki-manifest":{"source":"iana","extensions":["mft"]},"application/rpki-publication":{"source":"iana"},"application/rpki-roa":{"source":"iana","extensions":["roa"]},"application/rpki-updown":{"source":"iana"},"application/rsd+xml":{"source":"apache","compressible":true,"extensions":["rsd"]},"application/rss+xml":{"source":"apache","compressible":true,"extensions":["rss"]},"application/rtf":{"source":"iana","compressible":true,"extensions":["rtf"]},"application/rtploopback":{"source":"iana"},"application/rtx":{"source":"iana"},"application/samlassertion+xml":{"source":"iana","compressible":true},"application/samlmetadata+xml":{"source":"iana","compressible":true},"application/sarif+json":{"source":"iana","compressible":true},"application/sbe":{"source":"iana"},"application/sbml+xml":{"source":"iana","compressible":true,"extensions":["sbml"]},"application/scaip+xml":{"source":"iana","compressible":true},"application/scim+json":{"source":"iana","compressible":true},"application/scvp-cv-request":{"source":"iana","extensions":["scq"]},"application/scvp-cv-response":{"source":"iana","extensions":["scs"]},"application/scvp-vp-request":{"source":"iana","extensions":["spq"]},"application/scvp-vp-response":{"source":"iana","extensions":["spp"]},"application/sdp":{"source":"iana","extensions":["sdp"]},"application/secevent+jwt":{"source":"iana"},"application/senml+cbor":{"source":"iana"},"application/senml+json":{"source":"iana","compressible":true},"application/senml+xml":{"source":"iana","compressible":true,"extensions":["senmlx"]},"application/senml-etch+cbor":{"source":"iana"},"application/senml-etch+json":{"source":"iana","compressible":true},"application/senml-exi":{"source":"iana"},"application/sensml+cbor":{"source":"iana"},"application/sensml+json":{"source":"iana","compressible":true},"application/sensml+xml":{"source":"iana","compressible":true,"extensions":["sensmlx"]},"application/sensml-exi":{"source":"iana"},"application/sep+xml":{"source":"iana","compressible":true},"application/sep-exi":{"source":"iana"},"application/session-info":{"source":"iana"},"application/set-payment":{"source":"iana"},"application/set-payment-initiation":{"source":"iana","extensions":["setpay"]},"application/set-registration":{"source":"iana"},"application/set-registration-initiation":{"source":"iana","extensions":["setreg"]},"application/sgml":{"source":"iana"},"application/sgml-open-catalog":{"source":"iana"},"application/shf+xml":{"source":"iana","compressible":true,"extensions":["shf"]},"application/sieve":{"source":"iana","extensions":["siv","sieve"]},"application/simple-filter+xml":{"source":"iana","compressible":true},"application/simple-message-summary":{"source":"iana"},"application/simplesymbolcontainer":{"source":"iana"},"application/sipc":{"source":"iana"},"application/slate":{"source":"iana"},"application/smil":{"source":"iana"},"application/smil+xml":{"source":"iana","compressible":true,"extensions":["smi","smil"]},"application/smpte336m":{"source":"iana"},"application/soap+fastinfoset":{"source":"iana"},"application/soap+xml":{"source":"iana","compressible":true},"application/sparql-query":{"source":"iana","extensions":["rq"]},"application/sparql-results+xml":{"source":"iana","compressible":true,"extensions":["srx"]},"application/spirits-event+xml":{"source":"iana","compressible":true},"application/sql":{"source":"iana"},"application/srgs":{"source":"iana","extensions":["gram"]},"application/srgs+xml":{"source":"iana","compressible":true,"extensions":["grxml"]},"application/sru+xml":{"source":"iana","compressible":true,"extensions":["sru"]},"application/ssdl+xml":{"source":"apache","compressible":true,"extensions":["ssdl"]},"application/ssml+xml":{"source":"iana","compressible":true,"extensions":["ssml"]},"application/stix+json":{"source":"iana","compressible":true},"application/swid+xml":{"source":"iana","compressible":true,"extensions":["swidtag"]},"application/tamp-apex-update":{"source":"iana"},"application/tamp-apex-update-confirm":{"source":"iana"},"application/tamp-community-update":{"source":"iana"},"application/tamp-community-update-confirm":{"source":"iana"},"application/tamp-error":{"source":"iana"},"application/tamp-sequence-adjust":{"source":"iana"},"application/tamp-sequence-adjust-confirm":{"source":"iana"},"application/tamp-status-query":{"source":"iana"},"application/tamp-status-response":{"source":"iana"},"application/tamp-update":{"source":"iana"},"application/tamp-update-confirm":{"source":"iana"},"application/tar":{"compressible":true},"application/taxii+json":{"source":"iana","compressible":true},"application/td+json":{"source":"iana","compressible":true},"application/tei+xml":{"source":"iana","compressible":true,"extensions":["tei","teicorpus"]},"application/tetra_isi":{"source":"iana"},"application/thraud+xml":{"source":"iana","compressible":true,"extensions":["tfi"]},"application/timestamp-query":{"source":"iana"},"application/timestamp-reply":{"source":"iana"},"application/timestamped-data":{"source":"iana","extensions":["tsd"]},"application/tlsrpt+gzip":{"source":"iana"},"application/tlsrpt+json":{"source":"iana","compressible":true},"application/tnauthlist":{"source":"iana"},"application/toml":{"compressible":true,"extensions":["toml"]},"application/trickle-ice-sdpfrag":{"source":"iana"},"application/trig":{"source":"iana"},"application/ttml+xml":{"source":"iana","compressible":true,"extensions":["ttml"]},"application/tve-trigger":{"source":"iana"},"application/tzif":{"source":"iana"},"application/tzif-leap":{"source":"iana"},"application/ubjson":{"compressible":false,"extensions":["ubj"]},"application/ulpfec":{"source":"iana"},"application/urc-grpsheet+xml":{"source":"iana","compressible":true},"application/urc-ressheet+xml":{"source":"iana","compressible":true,"extensions":["rsheet"]},"application/urc-targetdesc+xml":{"source":"iana","compressible":true,"extensions":["td"]},"application/urc-uisocketdesc+xml":{"source":"iana","compressible":true},"application/vcard+json":{"source":"iana","compressible":true},"application/vcard+xml":{"source":"iana","compressible":true},"application/vemmi":{"source":"iana"},"application/vividence.scriptfile":{"source":"apache"},"application/vnd.1000minds.decision-model+xml":{"source":"iana","compressible":true,"extensions":["1km"]},"application/vnd.3gpp-prose+xml":{"source":"iana","compressible":true},"application/vnd.3gpp-prose-pc3ch+xml":{"source":"iana","compressible":true},"application/vnd.3gpp-v2x-local-service-information":{"source":"iana"},"application/vnd.3gpp.access-transfer-events+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.bsf+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.gmop+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.interworking-data":{"source":"iana"},"application/vnd.3gpp.mc-signalling-ear":{"source":"iana"},"application/vnd.3gpp.mcdata-affiliation-command+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcdata-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcdata-payload":{"source":"iana"},"application/vnd.3gpp.mcdata-service-config+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcdata-signalling":{"source":"iana"},"application/vnd.3gpp.mcdata-ue-config+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcdata-user-profile+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-affiliation-command+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-floor-request+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-location-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-mbms-usage-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-service-config+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-signed+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-ue-config+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-ue-init-config+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcptt-user-profile+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-affiliation-command+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-affiliation-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-location-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-mbms-usage-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-service-config+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-transmission-request+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-ue-config+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mcvideo-user-profile+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.mid-call+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.pic-bw-large":{"source":"iana","extensions":["plb"]},"application/vnd.3gpp.pic-bw-small":{"source":"iana","extensions":["psb"]},"application/vnd.3gpp.pic-bw-var":{"source":"iana","extensions":["pvb"]},"application/vnd.3gpp.sms":{"source":"iana"},"application/vnd.3gpp.sms+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.srvcc-ext+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.srvcc-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.state-and-event-info+xml":{"source":"iana","compressible":true},"application/vnd.3gpp.ussd+xml":{"source":"iana","compressible":true},"application/vnd.3gpp2.bcmcsinfo+xml":{"source":"iana","compressible":true},"application/vnd.3gpp2.sms":{"source":"iana"},"application/vnd.3gpp2.tcap":{"source":"iana","extensions":["tcap"]},"application/vnd.3lightssoftware.imagescal":{"source":"iana"},"application/vnd.3m.post-it-notes":{"source":"iana","extensions":["pwn"]},"application/vnd.accpac.simply.aso":{"source":"iana","extensions":["aso"]},"application/vnd.accpac.simply.imp":{"source":"iana","extensions":["imp"]},"application/vnd.acucobol":{"source":"iana","extensions":["acu"]},"application/vnd.acucorp":{"source":"iana","extensions":["atc","acutc"]},"application/vnd.adobe.air-application-installer-package+zip":{"source":"apache","compressible":false,"extensions":["air"]},"application/vnd.adobe.flash.movie":{"source":"iana"},"application/vnd.adobe.formscentral.fcdt":{"source":"iana","extensions":["fcdt"]},"application/vnd.adobe.fxp":{"source":"iana","extensions":["fxp","fxpl"]},"application/vnd.adobe.partial-upload":{"source":"iana"},"application/vnd.adobe.xdp+xml":{"source":"iana","compressible":true,"extensions":["xdp"]},"application/vnd.adobe.xfdf":{"source":"iana","extensions":["xfdf"]},"application/vnd.aether.imp":{"source":"iana"},"application/vnd.afpc.afplinedata":{"source":"iana"},"application/vnd.afpc.afplinedata-pagedef":{"source":"iana"},"application/vnd.afpc.cmoca-cmresource":{"source":"iana"},"application/vnd.afpc.foca-charset":{"source":"iana"},"application/vnd.afpc.foca-codedfont":{"source":"iana"},"application/vnd.afpc.foca-codepage":{"source":"iana"},"application/vnd.afpc.modca":{"source":"iana"},"application/vnd.afpc.modca-cmtable":{"source":"iana"},"application/vnd.afpc.modca-formdef":{"source":"iana"},"application/vnd.afpc.modca-mediummap":{"source":"iana"},"application/vnd.afpc.modca-objectcontainer":{"source":"iana"},"application/vnd.afpc.modca-overlay":{"source":"iana"},"application/vnd.afpc.modca-pagesegment":{"source":"iana"},"application/vnd.ah-barcode":{"source":"iana"},"application/vnd.ahead.space":{"source":"iana","extensions":["ahead"]},"application/vnd.airzip.filesecure.azf":{"source":"iana","extensions":["azf"]},"application/vnd.airzip.filesecure.azs":{"source":"iana","extensions":["azs"]},"application/vnd.amadeus+json":{"source":"iana","compressible":true},"application/vnd.amazon.ebook":{"source":"apache","extensions":["azw"]},"application/vnd.amazon.mobi8-ebook":{"source":"iana"},"application/vnd.americandynamics.acc":{"source":"iana","extensions":["acc"]},"application/vnd.amiga.ami":{"source":"iana","extensions":["ami"]},"application/vnd.amundsen.maze+xml":{"source":"iana","compressible":true},"application/vnd.android.ota":{"source":"iana"},"application/vnd.android.package-archive":{"source":"apache","compressible":false,"extensions":["apk"]},"application/vnd.anki":{"source":"iana"},"application/vnd.anser-web-certificate-issue-initiation":{"source":"iana","extensions":["cii"]},"application/vnd.anser-web-funds-transfer-initiation":{"source":"apache","extensions":["fti"]},"application/vnd.antix.game-component":{"source":"iana","extensions":["atx"]},"application/vnd.apache.thrift.binary":{"source":"iana"},"application/vnd.apache.thrift.compact":{"source":"iana"},"application/vnd.apache.thrift.json":{"source":"iana"},"application/vnd.api+json":{"source":"iana","compressible":true},"application/vnd.aplextor.warrp+json":{"source":"iana","compressible":true},"application/vnd.apothekende.reservation+json":{"source":"iana","compressible":true},"application/vnd.apple.installer+xml":{"source":"iana","compressible":true,"extensions":["mpkg"]},"application/vnd.apple.keynote":{"source":"iana","extensions":["key"]},"application/vnd.apple.mpegurl":{"source":"iana","extensions":["m3u8"]},"application/vnd.apple.numbers":{"source":"iana","extensions":["numbers"]},"application/vnd.apple.pages":{"source":"iana","extensions":["pages"]},"application/vnd.apple.pkpass":{"compressible":false,"extensions":["pkpass"]},"application/vnd.arastra.swi":{"source":"iana"},"application/vnd.aristanetworks.swi":{"source":"iana","extensions":["swi"]},"application/vnd.artisan+json":{"source":"iana","compressible":true},"application/vnd.artsquare":{"source":"iana"},"application/vnd.astraea-software.iota":{"source":"iana","extensions":["iota"]},"application/vnd.audiograph":{"source":"iana","extensions":["aep"]},"application/vnd.autopackage":{"source":"iana"},"application/vnd.avalon+json":{"source":"iana","compressible":true},"application/vnd.avistar+xml":{"source":"iana","compressible":true},"application/vnd.balsamiq.bmml+xml":{"source":"iana","compressible":true,"extensions":["bmml"]},"application/vnd.balsamiq.bmpr":{"source":"iana"},"application/vnd.banana-accounting":{"source":"iana"},"application/vnd.bbf.usp.error":{"source":"iana"},"application/vnd.bbf.usp.msg":{"source":"iana"},"application/vnd.bbf.usp.msg+json":{"source":"iana","compressible":true},"application/vnd.bekitzur-stech+json":{"source":"iana","compressible":true},"application/vnd.bint.med-content":{"source":"iana"},"application/vnd.biopax.rdf+xml":{"source":"iana","compressible":true},"application/vnd.blink-idb-value-wrapper":{"source":"iana"},"application/vnd.blueice.multipass":{"source":"iana","extensions":["mpm"]},"application/vnd.bluetooth.ep.oob":{"source":"iana"},"application/vnd.bluetooth.le.oob":{"source":"iana"},"application/vnd.bmi":{"source":"iana","extensions":["bmi"]},"application/vnd.bpf":{"source":"iana"},"application/vnd.bpf3":{"source":"iana"},"application/vnd.businessobjects":{"source":"iana","extensions":["rep"]},"application/vnd.byu.uapi+json":{"source":"iana","compressible":true},"application/vnd.cab-jscript":{"source":"iana"},"application/vnd.canon-cpdl":{"source":"iana"},"application/vnd.canon-lips":{"source":"iana"},"application/vnd.capasystems-pg+json":{"source":"iana","compressible":true},"application/vnd.cendio.thinlinc.clientconf":{"source":"iana"},"application/vnd.century-systems.tcp_stream":{"source":"iana"},"application/vnd.chemdraw+xml":{"source":"iana","compressible":true,"extensions":["cdxml"]},"application/vnd.chess-pgn":{"source":"iana"},"application/vnd.chipnuts.karaoke-mmd":{"source":"iana","extensions":["mmd"]},"application/vnd.ciedi":{"source":"iana"},"application/vnd.cinderella":{"source":"iana","extensions":["cdy"]},"application/vnd.cirpack.isdn-ext":{"source":"iana"},"application/vnd.citationstyles.style+xml":{"source":"iana","compressible":true,"extensions":["csl"]},"application/vnd.claymore":{"source":"iana","extensions":["cla"]},"application/vnd.cloanto.rp9":{"source":"iana","extensions":["rp9"]},"application/vnd.clonk.c4group":{"source":"iana","extensions":["c4g","c4d","c4f","c4p","c4u"]},"application/vnd.cluetrust.cartomobile-config":{"source":"iana","extensions":["c11amc"]},"application/vnd.cluetrust.cartomobile-config-pkg":{"source":"iana","extensions":["c11amz"]},"application/vnd.coffeescript":{"source":"iana"},"application/vnd.collabio.xodocuments.document":{"source":"iana"},"application/vnd.collabio.xodocuments.document-template":{"source":"iana"},"application/vnd.collabio.xodocuments.presentation":{"source":"iana"},"application/vnd.collabio.xodocuments.presentation-template":{"source":"iana"},"application/vnd.collabio.xodocuments.spreadsheet":{"source":"iana"},"application/vnd.collabio.xodocuments.spreadsheet-template":{"source":"iana"},"application/vnd.collection+json":{"source":"iana","compressible":true},"application/vnd.collection.doc+json":{"source":"iana","compressible":true},"application/vnd.collection.next+json":{"source":"iana","compressible":true},"application/vnd.comicbook+zip":{"source":"iana","compressible":false},"application/vnd.comicbook-rar":{"source":"iana"},"application/vnd.commerce-battelle":{"source":"iana"},"application/vnd.commonspace":{"source":"iana","extensions":["csp"]},"application/vnd.contact.cmsg":{"source":"iana","extensions":["cdbcmsg"]},"application/vnd.coreos.ignition+json":{"source":"iana","compressible":true},"application/vnd.cosmocaller":{"source":"iana","extensions":["cmc"]},"application/vnd.crick.clicker":{"source":"iana","extensions":["clkx"]},"application/vnd.crick.clicker.keyboard":{"source":"iana","extensions":["clkk"]},"application/vnd.crick.clicker.palette":{"source":"iana","extensions":["clkp"]},"application/vnd.crick.clicker.template":{"source":"iana","extensions":["clkt"]},"application/vnd.crick.clicker.wordbank":{"source":"iana","extensions":["clkw"]},"application/vnd.criticaltools.wbs+xml":{"source":"iana","compressible":true,"extensions":["wbs"]},"application/vnd.cryptii.pipe+json":{"source":"iana","compressible":true},"application/vnd.crypto-shade-file":{"source":"iana"},"application/vnd.ctc-posml":{"source":"iana","extensions":["pml"]},"application/vnd.ctct.ws+xml":{"source":"iana","compressible":true},"application/vnd.cups-pdf":{"source":"iana"},"application/vnd.cups-postscript":{"source":"iana"},"application/vnd.cups-ppd":{"source":"iana","extensions":["ppd"]},"application/vnd.cups-raster":{"source":"iana"},"application/vnd.cups-raw":{"source":"iana"},"application/vnd.curl":{"source":"iana"},"application/vnd.curl.car":{"source":"apache","extensions":["car"]},"application/vnd.curl.pcurl":{"source":"apache","extensions":["pcurl"]},"application/vnd.cyan.dean.root+xml":{"source":"iana","compressible":true},"application/vnd.cybank":{"source":"iana"},"application/vnd.cyclonedx+json":{"source":"iana","compressible":true},"application/vnd.cyclonedx+xml":{"source":"iana","compressible":true},"application/vnd.d2l.coursepackage1p0+zip":{"source":"iana","compressible":false},"application/vnd.d3m-dataset":{"source":"iana"},"application/vnd.d3m-problem":{"source":"iana"},"application/vnd.dart":{"source":"iana","compressible":true,"extensions":["dart"]},"application/vnd.data-vision.rdz":{"source":"iana","extensions":["rdz"]},"application/vnd.datapackage+json":{"source":"iana","compressible":true},"application/vnd.dataresource+json":{"source":"iana","compressible":true},"application/vnd.dbf":{"source":"iana","extensions":["dbf"]},"application/vnd.debian.binary-package":{"source":"iana"},"application/vnd.dece.data":{"source":"iana","extensions":["uvf","uvvf","uvd","uvvd"]},"application/vnd.dece.ttml+xml":{"source":"iana","compressible":true,"extensions":["uvt","uvvt"]},"application/vnd.dece.unspecified":{"source":"iana","extensions":["uvx","uvvx"]},"application/vnd.dece.zip":{"source":"iana","extensions":["uvz","uvvz"]},"application/vnd.denovo.fcselayout-link":{"source":"iana","extensions":["fe_launch"]},"application/vnd.desmume.movie":{"source":"iana"},"application/vnd.dir-bi.plate-dl-nosuffix":{"source":"iana"},"application/vnd.dm.delegation+xml":{"source":"iana","compressible":true},"application/vnd.dna":{"source":"iana","extensions":["dna"]},"application/vnd.document+json":{"source":"iana","compressible":true},"application/vnd.dolby.mlp":{"source":"apache","extensions":["mlp"]},"application/vnd.dolby.mobile.1":{"source":"iana"},"application/vnd.dolby.mobile.2":{"source":"iana"},"application/vnd.doremir.scorecloud-binary-document":{"source":"iana"},"application/vnd.dpgraph":{"source":"iana","extensions":["dpg"]},"application/vnd.dreamfactory":{"source":"iana","extensions":["dfac"]},"application/vnd.drive+json":{"source":"iana","compressible":true},"application/vnd.ds-keypoint":{"source":"apache","extensions":["kpxx"]},"application/vnd.dtg.local":{"source":"iana"},"application/vnd.dtg.local.flash":{"source":"iana"},"application/vnd.dtg.local.html":{"source":"iana"},"application/vnd.dvb.ait":{"source":"iana","extensions":["ait"]},"application/vnd.dvb.dvbisl+xml":{"source":"iana","compressible":true},"application/vnd.dvb.dvbj":{"source":"iana"},"application/vnd.dvb.esgcontainer":{"source":"iana"},"application/vnd.dvb.ipdcdftnotifaccess":{"source":"iana"},"application/vnd.dvb.ipdcesgaccess":{"source":"iana"},"application/vnd.dvb.ipdcesgaccess2":{"source":"iana"},"application/vnd.dvb.ipdcesgpdd":{"source":"iana"},"application/vnd.dvb.ipdcroaming":{"source":"iana"},"application/vnd.dvb.iptv.alfec-base":{"source":"iana"},"application/vnd.dvb.iptv.alfec-enhancement":{"source":"iana"},"application/vnd.dvb.notif-aggregate-root+xml":{"source":"iana","compressible":true},"application/vnd.dvb.notif-container+xml":{"source":"iana","compressible":true},"application/vnd.dvb.notif-generic+xml":{"source":"iana","compressible":true},"application/vnd.dvb.notif-ia-msglist+xml":{"source":"iana","compressible":true},"application/vnd.dvb.notif-ia-registration-request+xml":{"source":"iana","compressible":true},"application/vnd.dvb.notif-ia-registration-response+xml":{"source":"iana","compressible":true},"application/vnd.dvb.notif-init+xml":{"source":"iana","compressible":true},"application/vnd.dvb.pfr":{"source":"iana"},"application/vnd.dvb.service":{"source":"iana","extensions":["svc"]},"application/vnd.dxr":{"source":"iana"},"application/vnd.dynageo":{"source":"iana","extensions":["geo"]},"application/vnd.dzr":{"source":"iana"},"application/vnd.easykaraoke.cdgdownload":{"source":"iana"},"application/vnd.ecdis-update":{"source":"iana"},"application/vnd.ecip.rlp":{"source":"iana"},"application/vnd.ecowin.chart":{"source":"iana","extensions":["mag"]},"application/vnd.ecowin.filerequest":{"source":"iana"},"application/vnd.ecowin.fileupdate":{"source":"iana"},"application/vnd.ecowin.series":{"source":"iana"},"application/vnd.ecowin.seriesrequest":{"source":"iana"},"application/vnd.ecowin.seriesupdate":{"source":"iana"},"application/vnd.efi.img":{"source":"iana"},"application/vnd.efi.iso":{"source":"iana"},"application/vnd.emclient.accessrequest+xml":{"source":"iana","compressible":true},"application/vnd.enliven":{"source":"iana","extensions":["nml"]},"application/vnd.enphase.envoy":{"source":"iana"},"application/vnd.eprints.data+xml":{"source":"iana","compressible":true},"application/vnd.epson.esf":{"source":"iana","extensions":["esf"]},"application/vnd.epson.msf":{"source":"iana","extensions":["msf"]},"application/vnd.epson.quickanime":{"source":"iana","extensions":["qam"]},"application/vnd.epson.salt":{"source":"iana","extensions":["slt"]},"application/vnd.epson.ssf":{"source":"iana","extensions":["ssf"]},"application/vnd.ericsson.quickcall":{"source":"iana"},"application/vnd.espass-espass+zip":{"source":"iana","compressible":false},"application/vnd.eszigno3+xml":{"source":"iana","compressible":true,"extensions":["es3","et3"]},"application/vnd.etsi.aoc+xml":{"source":"iana","compressible":true},"application/vnd.etsi.asic-e+zip":{"source":"iana","compressible":false},"application/vnd.etsi.asic-s+zip":{"source":"iana","compressible":false},"application/vnd.etsi.cug+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvcommand+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvdiscovery+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvprofile+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvsad-bc+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvsad-cod+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvsad-npvr+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvservice+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvsync+xml":{"source":"iana","compressible":true},"application/vnd.etsi.iptvueprofile+xml":{"source":"iana","compressible":true},"application/vnd.etsi.mcid+xml":{"source":"iana","compressible":true},"application/vnd.etsi.mheg5":{"source":"iana"},"application/vnd.etsi.overload-control-policy-dataset+xml":{"source":"iana","compressible":true},"application/vnd.etsi.pstn+xml":{"source":"iana","compressible":true},"application/vnd.etsi.sci+xml":{"source":"iana","compressible":true},"application/vnd.etsi.simservs+xml":{"source":"iana","compressible":true},"application/vnd.etsi.timestamp-token":{"source":"iana"},"application/vnd.etsi.tsl+xml":{"source":"iana","compressible":true},"application/vnd.etsi.tsl.der":{"source":"iana"},"application/vnd.eudora.data":{"source":"iana"},"application/vnd.evolv.ecig.profile":{"source":"iana"},"application/vnd.evolv.ecig.settings":{"source":"iana"},"application/vnd.evolv.ecig.theme":{"source":"iana"},"application/vnd.exstream-empower+zip":{"source":"iana","compressible":false},"application/vnd.exstream-package":{"source":"iana"},"application/vnd.ezpix-album":{"source":"iana","extensions":["ez2"]},"application/vnd.ezpix-package":{"source":"iana","extensions":["ez3"]},"application/vnd.f-secure.mobile":{"source":"iana"},"application/vnd.fastcopy-disk-image":{"source":"iana"},"application/vnd.fdf":{"source":"iana","extensions":["fdf"]},"application/vnd.fdsn.mseed":{"source":"iana","extensions":["mseed"]},"application/vnd.fdsn.seed":{"source":"iana","extensions":["seed","dataless"]},"application/vnd.ffsns":{"source":"iana"},"application/vnd.ficlab.flb+zip":{"source":"iana","compressible":false},"application/vnd.filmit.zfc":{"source":"iana"},"application/vnd.fints":{"source":"iana"},"application/vnd.firemonkeys.cloudcell":{"source":"iana"},"application/vnd.flographit":{"source":"iana","extensions":["gph"]},"application/vnd.fluxtime.clip":{"source":"iana","extensions":["ftc"]},"application/vnd.font-fontforge-sfd":{"source":"iana"},"application/vnd.framemaker":{"source":"iana","extensions":["fm","frame","maker","book"]},"application/vnd.frogans.fnc":{"source":"iana","extensions":["fnc"]},"application/vnd.frogans.ltf":{"source":"iana","extensions":["ltf"]},"application/vnd.fsc.weblaunch":{"source":"iana","extensions":["fsc"]},"application/vnd.fujitsu.oasys":{"source":"iana","extensions":["oas"]},"application/vnd.fujitsu.oasys2":{"source":"iana","extensions":["oa2"]},"application/vnd.fujitsu.oasys3":{"source":"iana","extensions":["oa3"]},"application/vnd.fujitsu.oasysgp":{"source":"iana","extensions":["fg5"]},"application/vnd.fujitsu.oasysprs":{"source":"iana","extensions":["bh2"]},"application/vnd.fujixerox.art-ex":{"source":"iana"},"application/vnd.fujixerox.art4":{"source":"iana"},"application/vnd.fujixerox.ddd":{"source":"iana","extensions":["ddd"]},"application/vnd.fujixerox.docuworks":{"source":"iana","extensions":["xdw"]},"application/vnd.fujixerox.docuworks.binder":{"source":"iana","extensions":["xbd"]},"application/vnd.fujixerox.docuworks.container":{"source":"iana"},"application/vnd.fujixerox.hbpl":{"source":"iana"},"application/vnd.fut-misnet":{"source":"iana"},"application/vnd.futoin+cbor":{"source":"iana"},"application/vnd.futoin+json":{"source":"iana","compressible":true},"application/vnd.fuzzysheet":{"source":"iana","extensions":["fzs"]},"application/vnd.genomatix.tuxedo":{"source":"iana","extensions":["txd"]},"application/vnd.gentics.grd+json":{"source":"iana","compressible":true},"application/vnd.geo+json":{"source":"iana","compressible":true},"application/vnd.geocube+xml":{"source":"iana","compressible":true},"application/vnd.geogebra.file":{"source":"iana","extensions":["ggb"]},"application/vnd.geogebra.slides":{"source":"iana"},"application/vnd.geogebra.tool":{"source":"iana","extensions":["ggt"]},"application/vnd.geometry-explorer":{"source":"iana","extensions":["gex","gre"]},"application/vnd.geonext":{"source":"iana","extensions":["gxt"]},"application/vnd.geoplan":{"source":"iana","extensions":["g2w"]},"application/vnd.geospace":{"source":"iana","extensions":["g3w"]},"application/vnd.gerber":{"source":"iana"},"application/vnd.globalplatform.card-content-mgt":{"source":"iana"},"application/vnd.globalplatform.card-content-mgt-response":{"source":"iana"},"application/vnd.gmx":{"source":"iana","extensions":["gmx"]},"application/vnd.google-apps.document":{"compressible":false,"extensions":["gdoc"]},"application/vnd.google-apps.presentation":{"compressible":false,"extensions":["gslides"]},"application/vnd.google-apps.spreadsheet":{"compressible":false,"extensions":["gsheet"]},"application/vnd.google-earth.kml+xml":{"source":"iana","compressible":true,"extensions":["kml"]},"application/vnd.google-earth.kmz":{"source":"iana","compressible":false,"extensions":["kmz"]},"application/vnd.gov.sk.e-form+xml":{"source":"iana","compressible":true},"application/vnd.gov.sk.e-form+zip":{"source":"iana","compressible":false},"application/vnd.gov.sk.xmldatacontainer+xml":{"source":"iana","compressible":true},"application/vnd.grafeq":{"source":"iana","extensions":["gqf","gqs"]},"application/vnd.gridmp":{"source":"iana"},"application/vnd.groove-account":{"source":"iana","extensions":["gac"]},"application/vnd.groove-help":{"source":"iana","extensions":["ghf"]},"application/vnd.groove-identity-message":{"source":"iana","extensions":["gim"]},"application/vnd.groove-injector":{"source":"iana","extensions":["grv"]},"application/vnd.groove-tool-message":{"source":"iana","extensions":["gtm"]},"application/vnd.groove-tool-template":{"source":"iana","extensions":["tpl"]},"application/vnd.groove-vcard":{"source":"iana","extensions":["vcg"]},"application/vnd.hal+json":{"source":"iana","compressible":true},"application/vnd.hal+xml":{"source":"iana","compressible":true,"extensions":["hal"]},"application/vnd.handheld-entertainment+xml":{"source":"iana","compressible":true,"extensions":["zmm"]},"application/vnd.hbci":{"source":"iana","extensions":["hbci"]},"application/vnd.hc+json":{"source":"iana","compressible":true},"application/vnd.hcl-bireports":{"source":"iana"},"application/vnd.hdt":{"source":"iana"},"application/vnd.heroku+json":{"source":"iana","compressible":true},"application/vnd.hhe.lesson-player":{"source":"iana","extensions":["les"]},"application/vnd.hp-hpgl":{"source":"iana","extensions":["hpgl"]},"application/vnd.hp-hpid":{"source":"iana","extensions":["hpid"]},"application/vnd.hp-hps":{"source":"iana","extensions":["hps"]},"application/vnd.hp-jlyt":{"source":"iana","extensions":["jlt"]},"application/vnd.hp-pcl":{"source":"iana","extensions":["pcl"]},"application/vnd.hp-pclxl":{"source":"iana","extensions":["pclxl"]},"application/vnd.httphone":{"source":"iana"},"application/vnd.hydrostatix.sof-data":{"source":"iana","extensions":["sfd-hdstx"]},"application/vnd.hyper+json":{"source":"iana","compressible":true},"application/vnd.hyper-item+json":{"source":"iana","compressible":true},"application/vnd.hyperdrive+json":{"source":"iana","compressible":true},"application/vnd.hzn-3d-crossword":{"source":"iana"},"application/vnd.ibm.afplinedata":{"source":"iana"},"application/vnd.ibm.electronic-media":{"source":"iana"},"application/vnd.ibm.minipay":{"source":"iana","extensions":["mpy"]},"application/vnd.ibm.modcap":{"source":"iana","extensions":["afp","listafp","list3820"]},"application/vnd.ibm.rights-management":{"source":"iana","extensions":["irm"]},"application/vnd.ibm.secure-container":{"source":"iana","extensions":["sc"]},"application/vnd.iccprofile":{"source":"iana","extensions":["icc","icm"]},"application/vnd.ieee.1905":{"source":"iana"},"application/vnd.igloader":{"source":"iana","extensions":["igl"]},"application/vnd.imagemeter.folder+zip":{"source":"iana","compressible":false},"application/vnd.imagemeter.image+zip":{"source":"iana","compressible":false},"application/vnd.immervision-ivp":{"source":"iana","extensions":["ivp"]},"application/vnd.immervision-ivu":{"source":"iana","extensions":["ivu"]},"application/vnd.ims.imsccv1p1":{"source":"iana"},"application/vnd.ims.imsccv1p2":{"source":"iana"},"application/vnd.ims.imsccv1p3":{"source":"iana"},"application/vnd.ims.lis.v2.result+json":{"source":"iana","compressible":true},"application/vnd.ims.lti.v2.toolconsumerprofile+json":{"source":"iana","compressible":true},"application/vnd.ims.lti.v2.toolproxy+json":{"source":"iana","compressible":true},"application/vnd.ims.lti.v2.toolproxy.id+json":{"source":"iana","compressible":true},"application/vnd.ims.lti.v2.toolsettings+json":{"source":"iana","compressible":true},"application/vnd.ims.lti.v2.toolsettings.simple+json":{"source":"iana","compressible":true},"application/vnd.informedcontrol.rms+xml":{"source":"iana","compressible":true},"application/vnd.informix-visionary":{"source":"iana"},"application/vnd.infotech.project":{"source":"iana"},"application/vnd.infotech.project+xml":{"source":"iana","compressible":true},"application/vnd.innopath.wamp.notification":{"source":"iana"},"application/vnd.insors.igm":{"source":"iana","extensions":["igm"]},"application/vnd.intercon.formnet":{"source":"iana","extensions":["xpw","xpx"]},"application/vnd.intergeo":{"source":"iana","extensions":["i2g"]},"application/vnd.intertrust.digibox":{"source":"iana"},"application/vnd.intertrust.nncp":{"source":"iana"},"application/vnd.intu.qbo":{"source":"iana","extensions":["qbo"]},"application/vnd.intu.qfx":{"source":"iana","extensions":["qfx"]},"application/vnd.iptc.g2.catalogitem+xml":{"source":"iana","compressible":true},"application/vnd.iptc.g2.conceptitem+xml":{"source":"iana","compressible":true},"application/vnd.iptc.g2.knowledgeitem+xml":{"source":"iana","compressible":true},"application/vnd.iptc.g2.newsitem+xml":{"source":"iana","compressible":true},"application/vnd.iptc.g2.newsmessage+xml":{"source":"iana","compressible":true},"application/vnd.iptc.g2.packageitem+xml":{"source":"iana","compressible":true},"application/vnd.iptc.g2.planningitem+xml":{"source":"iana","compressible":true},"application/vnd.ipunplugged.rcprofile":{"source":"iana","extensions":["rcprofile"]},"application/vnd.irepository.package+xml":{"source":"iana","compressible":true,"extensions":["irp"]},"application/vnd.is-xpr":{"source":"iana","extensions":["xpr"]},"application/vnd.isac.fcs":{"source":"iana","extensions":["fcs"]},"application/vnd.iso11783-10+zip":{"source":"iana","compressible":false},"application/vnd.jam":{"source":"iana","extensions":["jam"]},"application/vnd.japannet-directory-service":{"source":"iana"},"application/vnd.japannet-jpnstore-wakeup":{"source":"iana"},"application/vnd.japannet-payment-wakeup":{"source":"iana"},"application/vnd.japannet-registration":{"source":"iana"},"application/vnd.japannet-registration-wakeup":{"source":"iana"},"application/vnd.japannet-setstore-wakeup":{"source":"iana"},"application/vnd.japannet-verification":{"source":"iana"},"application/vnd.japannet-verification-wakeup":{"source":"iana"},"application/vnd.jcp.javame.midlet-rms":{"source":"iana","extensions":["rms"]},"application/vnd.jisp":{"source":"iana","extensions":["jisp"]},"application/vnd.joost.joda-archive":{"source":"iana","extensions":["joda"]},"application/vnd.jsk.isdn-ngn":{"source":"iana"},"application/vnd.kahootz":{"source":"iana","extensions":["ktz","ktr"]},"application/vnd.kde.karbon":{"source":"iana","extensions":["karbon"]},"application/vnd.kde.kchart":{"source":"iana","extensions":["chrt"]},"application/vnd.kde.kformula":{"source":"iana","extensions":["kfo"]},"application/vnd.kde.kivio":{"source":"iana","extensions":["flw"]},"application/vnd.kde.kontour":{"source":"iana","extensions":["kon"]},"application/vnd.kde.kpresenter":{"source":"iana","extensions":["kpr","kpt"]},"application/vnd.kde.kspread":{"source":"iana","extensions":["ksp"]},"application/vnd.kde.kword":{"source":"iana","extensions":["kwd","kwt"]},"application/vnd.kenameaapp":{"source":"iana","extensions":["htke"]},"application/vnd.kidspiration":{"source":"iana","extensions":["kia"]},"application/vnd.kinar":{"source":"iana","extensions":["kne","knp"]},"application/vnd.koan":{"source":"iana","extensions":["skp","skd","skt","skm"]},"application/vnd.kodak-descriptor":{"source":"iana","extensions":["sse"]},"application/vnd.las":{"source":"iana"},"application/vnd.las.las+json":{"source":"iana","compressible":true},"application/vnd.las.las+xml":{"source":"iana","compressible":true,"extensions":["lasxml"]},"application/vnd.laszip":{"source":"iana"},"application/vnd.leap+json":{"source":"iana","compressible":true},"application/vnd.liberty-request+xml":{"source":"iana","compressible":true},"application/vnd.llamagraphics.life-balance.desktop":{"source":"iana","extensions":["lbd"]},"application/vnd.llamagraphics.life-balance.exchange+xml":{"source":"iana","compressible":true,"extensions":["lbe"]},"application/vnd.logipipe.circuit+zip":{"source":"iana","compressible":false},"application/vnd.loom":{"source":"iana"},"application/vnd.lotus-1-2-3":{"source":"iana","extensions":["123"]},"application/vnd.lotus-approach":{"source":"iana","extensions":["apr"]},"application/vnd.lotus-freelance":{"source":"iana","extensions":["pre"]},"application/vnd.lotus-notes":{"source":"iana","extensions":["nsf"]},"application/vnd.lotus-organizer":{"source":"iana","extensions":["org"]},"application/vnd.lotus-screencam":{"source":"iana","extensions":["scm"]},"application/vnd.lotus-wordpro":{"source":"iana","extensions":["lwp"]},"application/vnd.macports.portpkg":{"source":"iana","extensions":["portpkg"]},"application/vnd.mapbox-vector-tile":{"source":"iana"},"application/vnd.marlin.drm.actiontoken+xml":{"source":"iana","compressible":true},"application/vnd.marlin.drm.conftoken+xml":{"source":"iana","compressible":true},"application/vnd.marlin.drm.license+xml":{"source":"iana","compressible":true},"application/vnd.marlin.drm.mdcf":{"source":"iana"},"application/vnd.mason+json":{"source":"iana","compressible":true},"application/vnd.maxmind.maxmind-db":{"source":"iana"},"application/vnd.mcd":{"source":"iana","extensions":["mcd"]},"application/vnd.medcalcdata":{"source":"iana","extensions":["mc1"]},"application/vnd.mediastation.cdkey":{"source":"iana","extensions":["cdkey"]},"application/vnd.meridian-slingshot":{"source":"iana"},"application/vnd.mfer":{"source":"iana","extensions":["mwf"]},"application/vnd.mfmp":{"source":"iana","extensions":["mfm"]},"application/vnd.micro+json":{"source":"iana","compressible":true},"application/vnd.micrografx.flo":{"source":"iana","extensions":["flo"]},"application/vnd.micrografx.igx":{"source":"iana","extensions":["igx"]},"application/vnd.microsoft.portable-executable":{"source":"iana"},"application/vnd.microsoft.windows.thumbnail-cache":{"source":"iana"},"application/vnd.miele+json":{"source":"iana","compressible":true},"application/vnd.mif":{"source":"iana","extensions":["mif"]},"application/vnd.minisoft-hp3000-save":{"source":"iana"},"application/vnd.mitsubishi.misty-guard.trustweb":{"source":"iana"},"application/vnd.mobius.daf":{"source":"iana","extensions":["daf"]},"application/vnd.mobius.dis":{"source":"iana","extensions":["dis"]},"application/vnd.mobius.mbk":{"source":"iana","extensions":["mbk"]},"application/vnd.mobius.mqy":{"source":"iana","extensions":["mqy"]},"application/vnd.mobius.msl":{"source":"iana","extensions":["msl"]},"application/vnd.mobius.plc":{"source":"iana","extensions":["plc"]},"application/vnd.mobius.txf":{"source":"iana","extensions":["txf"]},"application/vnd.mophun.application":{"source":"iana","extensions":["mpn"]},"application/vnd.mophun.certificate":{"source":"iana","extensions":["mpc"]},"application/vnd.motorola.flexsuite":{"source":"iana"},"application/vnd.motorola.flexsuite.adsi":{"source":"iana"},"application/vnd.motorola.flexsuite.fis":{"source":"iana"},"application/vnd.motorola.flexsuite.gotap":{"source":"iana"},"application/vnd.motorola.flexsuite.kmr":{"source":"iana"},"application/vnd.motorola.flexsuite.ttc":{"source":"iana"},"application/vnd.motorola.flexsuite.wem":{"source":"iana"},"application/vnd.motorola.iprm":{"source":"iana"},"application/vnd.mozilla.xul+xml":{"source":"iana","compressible":true,"extensions":["xul"]},"application/vnd.ms-3mfdocument":{"source":"iana"},"application/vnd.ms-artgalry":{"source":"iana","extensions":["cil"]},"application/vnd.ms-asf":{"source":"iana"},"application/vnd.ms-cab-compressed":{"source":"iana","extensions":["cab"]},"application/vnd.ms-color.iccprofile":{"source":"apache"},"application/vnd.ms-excel":{"source":"iana","compressible":false,"extensions":["xls","xlm","xla","xlc","xlt","xlw"]},"application/vnd.ms-excel.addin.macroenabled.12":{"source":"iana","extensions":["xlam"]},"application/vnd.ms-excel.sheet.binary.macroenabled.12":{"source":"iana","extensions":["xlsb"]},"application/vnd.ms-excel.sheet.macroenabled.12":{"source":"iana","extensions":["xlsm"]},"application/vnd.ms-excel.template.macroenabled.12":{"source":"iana","extensions":["xltm"]},"application/vnd.ms-fontobject":{"source":"iana","compressible":true,"extensions":["eot"]},"application/vnd.ms-htmlhelp":{"source":"iana","extensions":["chm"]},"application/vnd.ms-ims":{"source":"iana","extensions":["ims"]},"application/vnd.ms-lrm":{"source":"iana","extensions":["lrm"]},"application/vnd.ms-office.activex+xml":{"source":"iana","compressible":true},"application/vnd.ms-officetheme":{"source":"iana","extensions":["thmx"]},"application/vnd.ms-opentype":{"source":"apache","compressible":true},"application/vnd.ms-outlook":{"compressible":false,"extensions":["msg"]},"application/vnd.ms-package.obfuscated-opentype":{"source":"apache"},"application/vnd.ms-pki.seccat":{"source":"apache","extensions":["cat"]},"application/vnd.ms-pki.stl":{"source":"apache","extensions":["stl"]},"application/vnd.ms-playready.initiator+xml":{"source":"iana","compressible":true},"application/vnd.ms-powerpoint":{"source":"iana","compressible":false,"extensions":["ppt","pps","pot"]},"application/vnd.ms-powerpoint.addin.macroenabled.12":{"source":"iana","extensions":["ppam"]},"application/vnd.ms-powerpoint.presentation.macroenabled.12":{"source":"iana","extensions":["pptm"]},"application/vnd.ms-powerpoint.slide.macroenabled.12":{"source":"iana","extensions":["sldm"]},"application/vnd.ms-powerpoint.slideshow.macroenabled.12":{"source":"iana","extensions":["ppsm"]},"application/vnd.ms-powerpoint.template.macroenabled.12":{"source":"iana","extensions":["potm"]},"application/vnd.ms-printdevicecapabilities+xml":{"source":"iana","compressible":true},"application/vnd.ms-printing.printticket+xml":{"source":"apache","compressible":true},"application/vnd.ms-printschematicket+xml":{"source":"iana","compressible":true},"application/vnd.ms-project":{"source":"iana","extensions":["mpp","mpt"]},"application/vnd.ms-tnef":{"source":"iana"},"application/vnd.ms-windows.devicepairing":{"source":"iana"},"application/vnd.ms-windows.nwprinting.oob":{"source":"iana"},"application/vnd.ms-windows.printerpairing":{"source":"iana"},"application/vnd.ms-windows.wsd.oob":{"source":"iana"},"application/vnd.ms-wmdrm.lic-chlg-req":{"source":"iana"},"application/vnd.ms-wmdrm.lic-resp":{"source":"iana"},"application/vnd.ms-wmdrm.meter-chlg-req":{"source":"iana"},"application/vnd.ms-wmdrm.meter-resp":{"source":"iana"},"application/vnd.ms-word.document.macroenabled.12":{"source":"iana","extensions":["docm"]},"application/vnd.ms-word.template.macroenabled.12":{"source":"iana","extensions":["dotm"]},"application/vnd.ms-works":{"source":"iana","extensions":["wps","wks","wcm","wdb"]},"application/vnd.ms-wpl":{"source":"iana","extensions":["wpl"]},"application/vnd.ms-xpsdocument":{"source":"iana","compressible":false,"extensions":["xps"]},"application/vnd.msa-disk-image":{"source":"iana"},"application/vnd.mseq":{"source":"iana","extensions":["mseq"]},"application/vnd.msign":{"source":"iana"},"application/vnd.multiad.creator":{"source":"iana"},"application/vnd.multiad.creator.cif":{"source":"iana"},"application/vnd.music-niff":{"source":"iana"},"application/vnd.musician":{"source":"iana","extensions":["mus"]},"application/vnd.muvee.style":{"source":"iana","extensions":["msty"]},"application/vnd.mynfc":{"source":"iana","extensions":["taglet"]},"application/vnd.ncd.control":{"source":"iana"},"application/vnd.ncd.reference":{"source":"iana"},"application/vnd.nearst.inv+json":{"source":"iana","compressible":true},"application/vnd.nervana":{"source":"iana"},"application/vnd.netfpx":{"source":"iana"},"application/vnd.neurolanguage.nlu":{"source":"iana","extensions":["nlu"]},"application/vnd.nimn":{"source":"iana"},"application/vnd.nintendo.nitro.rom":{"source":"iana"},"application/vnd.nintendo.snes.rom":{"source":"iana"},"application/vnd.nitf":{"source":"iana","extensions":["ntf","nitf"]},"application/vnd.noblenet-directory":{"source":"iana","extensions":["nnd"]},"application/vnd.noblenet-sealer":{"source":"iana","extensions":["nns"]},"application/vnd.noblenet-web":{"source":"iana","extensions":["nnw"]},"application/vnd.nokia.catalogs":{"source":"iana"},"application/vnd.nokia.conml+wbxml":{"source":"iana"},"application/vnd.nokia.conml+xml":{"source":"iana","compressible":true},"application/vnd.nokia.iptv.config+xml":{"source":"iana","compressible":true},"application/vnd.nokia.isds-radio-presets":{"source":"iana"},"application/vnd.nokia.landmark+wbxml":{"source":"iana"},"application/vnd.nokia.landmark+xml":{"source":"iana","compressible":true},"application/vnd.nokia.landmarkcollection+xml":{"source":"iana","compressible":true},"application/vnd.nokia.n-gage.ac+xml":{"source":"iana","compressible":true,"extensions":["ac"]},"application/vnd.nokia.n-gage.data":{"source":"iana","extensions":["ngdat"]},"application/vnd.nokia.n-gage.symbian.install":{"source":"iana","extensions":["n-gage"]},"application/vnd.nokia.ncd":{"source":"iana"},"application/vnd.nokia.pcd+wbxml":{"source":"iana"},"application/vnd.nokia.pcd+xml":{"source":"iana","compressible":true},"application/vnd.nokia.radio-preset":{"source":"iana","extensions":["rpst"]},"application/vnd.nokia.radio-presets":{"source":"iana","extensions":["rpss"]},"application/vnd.novadigm.edm":{"source":"iana","extensions":["edm"]},"application/vnd.novadigm.edx":{"source":"iana","extensions":["edx"]},"application/vnd.novadigm.ext":{"source":"iana","extensions":["ext"]},"application/vnd.ntt-local.content-share":{"source":"iana"},"application/vnd.ntt-local.file-transfer":{"source":"iana"},"application/vnd.ntt-local.ogw_remote-access":{"source":"iana"},"application/vnd.ntt-local.sip-ta_remote":{"source":"iana"},"application/vnd.ntt-local.sip-ta_tcp_stream":{"source":"iana"},"application/vnd.oasis.opendocument.chart":{"source":"iana","extensions":["odc"]},"application/vnd.oasis.opendocument.chart-template":{"source":"iana","extensions":["otc"]},"application/vnd.oasis.opendocument.database":{"source":"iana","extensions":["odb"]},"application/vnd.oasis.opendocument.formula":{"source":"iana","extensions":["odf"]},"application/vnd.oasis.opendocument.formula-template":{"source":"iana","extensions":["odft"]},"application/vnd.oasis.opendocument.graphics":{"source":"iana","compressible":false,"extensions":["odg"]},"application/vnd.oasis.opendocument.graphics-template":{"source":"iana","extensions":["otg"]},"application/vnd.oasis.opendocument.image":{"source":"iana","extensions":["odi"]},"application/vnd.oasis.opendocument.image-template":{"source":"iana","extensions":["oti"]},"application/vnd.oasis.opendocument.presentation":{"source":"iana","compressible":false,"extensions":["odp"]},"application/vnd.oasis.opendocument.presentation-template":{"source":"iana","extensions":["otp"]},"application/vnd.oasis.opendocument.spreadsheet":{"source":"iana","compressible":false,"extensions":["ods"]},"application/vnd.oasis.opendocument.spreadsheet-template":{"source":"iana","extensions":["ots"]},"application/vnd.oasis.opendocument.text":{"source":"iana","compressible":false,"extensions":["odt"]},"application/vnd.oasis.opendocument.text-master":{"source":"iana","extensions":["odm"]},"application/vnd.oasis.opendocument.text-template":{"source":"iana","extensions":["ott"]},"application/vnd.oasis.opendocument.text-web":{"source":"iana","extensions":["oth"]},"application/vnd.obn":{"source":"iana"},"application/vnd.ocf+cbor":{"source":"iana"},"application/vnd.oci.image.manifest.v1+json":{"source":"iana","compressible":true},"application/vnd.oftn.l10n+json":{"source":"iana","compressible":true},"application/vnd.oipf.contentaccessdownload+xml":{"source":"iana","compressible":true},"application/vnd.oipf.contentaccessstreaming+xml":{"source":"iana","compressible":true},"application/vnd.oipf.cspg-hexbinary":{"source":"iana"},"application/vnd.oipf.dae.svg+xml":{"source":"iana","compressible":true},"application/vnd.oipf.dae.xhtml+xml":{"source":"iana","compressible":true},"application/vnd.oipf.mippvcontrolmessage+xml":{"source":"iana","compressible":true},"application/vnd.oipf.pae.gem":{"source":"iana"},"application/vnd.oipf.spdiscovery+xml":{"source":"iana","compressible":true},"application/vnd.oipf.spdlist+xml":{"source":"iana","compressible":true},"application/vnd.oipf.ueprofile+xml":{"source":"iana","compressible":true},"application/vnd.oipf.userprofile+xml":{"source":"iana","compressible":true},"application/vnd.olpc-sugar":{"source":"iana","extensions":["xo"]},"application/vnd.oma-scws-config":{"source":"iana"},"application/vnd.oma-scws-http-request":{"source":"iana"},"application/vnd.oma-scws-http-response":{"source":"iana"},"application/vnd.oma.bcast.associated-procedure-parameter+xml":{"source":"iana","compressible":true},"application/vnd.oma.bcast.drm-trigger+xml":{"source":"iana","compressible":true},"application/vnd.oma.bcast.imd+xml":{"source":"iana","compressible":true},"application/vnd.oma.bcast.ltkm":{"source":"iana"},"application/vnd.oma.bcast.notification+xml":{"source":"iana","compressible":true},"application/vnd.oma.bcast.provisioningtrigger":{"source":"iana"},"application/vnd.oma.bcast.sgboot":{"source":"iana"},"application/vnd.oma.bcast.sgdd+xml":{"source":"iana","compressible":true},"application/vnd.oma.bcast.sgdu":{"source":"iana"},"application/vnd.oma.bcast.simple-symbol-container":{"source":"iana"},"application/vnd.oma.bcast.smartcard-trigger+xml":{"source":"iana","compressible":true},"application/vnd.oma.bcast.sprov+xml":{"source":"iana","compressible":true},"application/vnd.oma.bcast.stkm":{"source":"iana"},"application/vnd.oma.cab-address-book+xml":{"source":"iana","compressible":true},"application/vnd.oma.cab-feature-handler+xml":{"source":"iana","compressible":true},"application/vnd.oma.cab-pcc+xml":{"source":"iana","compressible":true},"application/vnd.oma.cab-subs-invite+xml":{"source":"iana","compressible":true},"application/vnd.oma.cab-user-prefs+xml":{"source":"iana","compressible":true},"application/vnd.oma.dcd":{"source":"iana"},"application/vnd.oma.dcdc":{"source":"iana"},"application/vnd.oma.dd2+xml":{"source":"iana","compressible":true,"extensions":["dd2"]},"application/vnd.oma.drm.risd+xml":{"source":"iana","compressible":true},"application/vnd.oma.group-usage-list+xml":{"source":"iana","compressible":true},"application/vnd.oma.lwm2m+cbor":{"source":"iana"},"application/vnd.oma.lwm2m+json":{"source":"iana","compressible":true},"application/vnd.oma.lwm2m+tlv":{"source":"iana"},"application/vnd.oma.pal+xml":{"source":"iana","compressible":true},"application/vnd.oma.poc.detailed-progress-report+xml":{"source":"iana","compressible":true},"application/vnd.oma.poc.final-report+xml":{"source":"iana","compressible":true},"application/vnd.oma.poc.groups+xml":{"source":"iana","compressible":true},"application/vnd.oma.poc.invocation-descriptor+xml":{"source":"iana","compressible":true},"application/vnd.oma.poc.optimized-progress-report+xml":{"source":"iana","compressible":true},"application/vnd.oma.push":{"source":"iana"},"application/vnd.oma.scidm.messages+xml":{"source":"iana","compressible":true},"application/vnd.oma.xcap-directory+xml":{"source":"iana","compressible":true},"application/vnd.omads-email+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/vnd.omads-file+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/vnd.omads-folder+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/vnd.omaloc-supl-init":{"source":"iana"},"application/vnd.onepager":{"source":"iana"},"application/vnd.onepagertamp":{"source":"iana"},"application/vnd.onepagertamx":{"source":"iana"},"application/vnd.onepagertat":{"source":"iana"},"application/vnd.onepagertatp":{"source":"iana"},"application/vnd.onepagertatx":{"source":"iana"},"application/vnd.openblox.game+xml":{"source":"iana","compressible":true,"extensions":["obgx"]},"application/vnd.openblox.game-binary":{"source":"iana"},"application/vnd.openeye.oeb":{"source":"iana"},"application/vnd.openofficeorg.extension":{"source":"apache","extensions":["oxt"]},"application/vnd.openstreetmap.data+xml":{"source":"iana","compressible":true,"extensions":["osm"]},"application/vnd.openxmlformats-officedocument.custom-properties+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.customxmlproperties+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.drawing+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.drawingml.chart+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.drawingml.diagramcolors+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.drawingml.diagramdata+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.drawingml.diagramlayout+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.drawingml.diagramstyle+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.extended-properties+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.commentauthors+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.comments+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.handoutmaster+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.notesmaster+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.notesslide+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{"source":"iana","compressible":false,"extensions":["pptx"]},"application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.presprops+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.slide":{"source":"iana","extensions":["sldx"]},"application/vnd.openxmlformats-officedocument.presentationml.slide+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.slidelayout+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.slidemaster+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.slideshow":{"source":"iana","extensions":["ppsx"]},"application/vnd.openxmlformats-officedocument.presentationml.slideshow.main+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.slideupdateinfo+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.tablestyles+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.tags+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.template":{"source":"iana","extensions":["potx"]},"application/vnd.openxmlformats-officedocument.presentationml.template.main+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.presentationml.viewprops+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.calcchain+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.externallink+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotcachedefinition+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotcacherecords+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivottable+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.querytable+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionheaders+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionlog+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedstrings+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{"source":"iana","compressible":false,"extensions":["xlsx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetmetadata+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.tablesinglecells+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.template":{"source":"iana","extensions":["xltx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.usernames+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.volatiledependencies+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.theme+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.themeoverride+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.vmldrawing":{"source":"iana"},"application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{"source":"iana","compressible":false,"extensions":["docx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.document.glossary+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.fonttable+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.template":{"source":"iana","extensions":["dotx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-officedocument.wordprocessingml.websettings+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-package.core-properties+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-package.digital-signature-xmlsignature+xml":{"source":"iana","compressible":true},"application/vnd.openxmlformats-package.relationships+xml":{"source":"iana","compressible":true},"application/vnd.oracle.resource+json":{"source":"iana","compressible":true},"application/vnd.orange.indata":{"source":"iana"},"application/vnd.osa.netdeploy":{"source":"iana"},"application/vnd.osgeo.mapguide.package":{"source":"iana","extensions":["mgp"]},"application/vnd.osgi.bundle":{"source":"iana"},"application/vnd.osgi.dp":{"source":"iana","extensions":["dp"]},"application/vnd.osgi.subsystem":{"source":"iana","extensions":["esa"]},"application/vnd.otps.ct-kip+xml":{"source":"iana","compressible":true},"application/vnd.oxli.countgraph":{"source":"iana"},"application/vnd.pagerduty+json":{"source":"iana","compressible":true},"application/vnd.palm":{"source":"iana","extensions":["pdb","pqa","oprc"]},"application/vnd.panoply":{"source":"iana"},"application/vnd.paos.xml":{"source":"iana"},"application/vnd.patentdive":{"source":"iana"},"application/vnd.patientecommsdoc":{"source":"iana"},"application/vnd.pawaafile":{"source":"iana","extensions":["paw"]},"application/vnd.pcos":{"source":"iana"},"application/vnd.pg.format":{"source":"iana","extensions":["str"]},"application/vnd.pg.osasli":{"source":"iana","extensions":["ei6"]},"application/vnd.piaccess.application-licence":{"source":"iana"},"application/vnd.picsel":{"source":"iana","extensions":["efif"]},"application/vnd.pmi.widget":{"source":"iana","extensions":["wg"]},"application/vnd.poc.group-advertisement+xml":{"source":"iana","compressible":true},"application/vnd.pocketlearn":{"source":"iana","extensions":["plf"]},"application/vnd.powerbuilder6":{"source":"iana","extensions":["pbd"]},"application/vnd.powerbuilder6-s":{"source":"iana"},"application/vnd.powerbuilder7":{"source":"iana"},"application/vnd.powerbuilder7-s":{"source":"iana"},"application/vnd.powerbuilder75":{"source":"iana"},"application/vnd.powerbuilder75-s":{"source":"iana"},"application/vnd.preminet":{"source":"iana"},"application/vnd.previewsystems.box":{"source":"iana","extensions":["box"]},"application/vnd.proteus.magazine":{"source":"iana","extensions":["mgz"]},"application/vnd.psfs":{"source":"iana"},"application/vnd.publishare-delta-tree":{"source":"iana","extensions":["qps"]},"application/vnd.pvi.ptid1":{"source":"iana","extensions":["ptid"]},"application/vnd.pwg-multiplexed":{"source":"iana"},"application/vnd.pwg-xhtml-print+xml":{"source":"iana","compressible":true},"application/vnd.qualcomm.brew-app-res":{"source":"iana"},"application/vnd.quarantainenet":{"source":"iana"},"application/vnd.quark.quarkxpress":{"source":"iana","extensions":["qxd","qxt","qwd","qwt","qxl","qxb"]},"application/vnd.quobject-quoxdocument":{"source":"iana"},"application/vnd.radisys.moml+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-audit+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-audit-conf+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-audit-conn+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-audit-dialog+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-audit-stream+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-conf+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-dialog+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-dialog-base+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-dialog-fax-detect+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-dialog-fax-sendrecv+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-dialog-group+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-dialog-speech+xml":{"source":"iana","compressible":true},"application/vnd.radisys.msml-dialog-transform+xml":{"source":"iana","compressible":true},"application/vnd.rainstor.data":{"source":"iana"},"application/vnd.rapid":{"source":"iana"},"application/vnd.rar":{"source":"iana","extensions":["rar"]},"application/vnd.realvnc.bed":{"source":"iana","extensions":["bed"]},"application/vnd.recordare.musicxml":{"source":"iana","extensions":["mxl"]},"application/vnd.recordare.musicxml+xml":{"source":"iana","compressible":true,"extensions":["musicxml"]},"application/vnd.renlearn.rlprint":{"source":"iana"},"application/vnd.restful+json":{"source":"iana","compressible":true},"application/vnd.rig.cryptonote":{"source":"iana","extensions":["cryptonote"]},"application/vnd.rim.cod":{"source":"apache","extensions":["cod"]},"application/vnd.rn-realmedia":{"source":"apache","extensions":["rm"]},"application/vnd.rn-realmedia-vbr":{"source":"apache","extensions":["rmvb"]},"application/vnd.route66.link66+xml":{"source":"iana","compressible":true,"extensions":["link66"]},"application/vnd.rs-274x":{"source":"iana"},"application/vnd.ruckus.download":{"source":"iana"},"application/vnd.s3sms":{"source":"iana"},"application/vnd.sailingtracker.track":{"source":"iana","extensions":["st"]},"application/vnd.sar":{"source":"iana"},"application/vnd.sbm.cid":{"source":"iana"},"application/vnd.sbm.mid2":{"source":"iana"},"application/vnd.scribus":{"source":"iana"},"application/vnd.sealed.3df":{"source":"iana"},"application/vnd.sealed.csf":{"source":"iana"},"application/vnd.sealed.doc":{"source":"iana"},"application/vnd.sealed.eml":{"source":"iana"},"application/vnd.sealed.mht":{"source":"iana"},"application/vnd.sealed.net":{"source":"iana"},"application/vnd.sealed.ppt":{"source":"iana"},"application/vnd.sealed.tiff":{"source":"iana"},"application/vnd.sealed.xls":{"source":"iana"},"application/vnd.sealedmedia.softseal.html":{"source":"iana"},"application/vnd.sealedmedia.softseal.pdf":{"source":"iana"},"application/vnd.seemail":{"source":"iana","extensions":["see"]},"application/vnd.seis+json":{"source":"iana","compressible":true},"application/vnd.sema":{"source":"iana","extensions":["sema"]},"application/vnd.semd":{"source":"iana","extensions":["semd"]},"application/vnd.semf":{"source":"iana","extensions":["semf"]},"application/vnd.shade-save-file":{"source":"iana"},"application/vnd.shana.informed.formdata":{"source":"iana","extensions":["ifm"]},"application/vnd.shana.informed.formtemplate":{"source":"iana","extensions":["itp"]},"application/vnd.shana.informed.interchange":{"source":"iana","extensions":["iif"]},"application/vnd.shana.informed.package":{"source":"iana","extensions":["ipk"]},"application/vnd.shootproof+json":{"source":"iana","compressible":true},"application/vnd.shopkick+json":{"source":"iana","compressible":true},"application/vnd.shp":{"source":"iana"},"application/vnd.shx":{"source":"iana"},"application/vnd.sigrok.session":{"source":"iana"},"application/vnd.simtech-mindmapper":{"source":"iana","extensions":["twd","twds"]},"application/vnd.siren+json":{"source":"iana","compressible":true},"application/vnd.smaf":{"source":"iana","extensions":["mmf"]},"application/vnd.smart.notebook":{"source":"iana"},"application/vnd.smart.teacher":{"source":"iana","extensions":["teacher"]},"application/vnd.snesdev-page-table":{"source":"iana"},"application/vnd.software602.filler.form+xml":{"source":"iana","compressible":true,"extensions":["fo"]},"application/vnd.software602.filler.form-xml-zip":{"source":"iana"},"application/vnd.solent.sdkm+xml":{"source":"iana","compressible":true,"extensions":["sdkm","sdkd"]},"application/vnd.spotfire.dxp":{"source":"iana","extensions":["dxp"]},"application/vnd.spotfire.sfs":{"source":"iana","extensions":["sfs"]},"application/vnd.sqlite3":{"source":"iana"},"application/vnd.sss-cod":{"source":"iana"},"application/vnd.sss-dtf":{"source":"iana"},"application/vnd.sss-ntf":{"source":"iana"},"application/vnd.stardivision.calc":{"source":"apache","extensions":["sdc"]},"application/vnd.stardivision.draw":{"source":"apache","extensions":["sda"]},"application/vnd.stardivision.impress":{"source":"apache","extensions":["sdd"]},"application/vnd.stardivision.math":{"source":"apache","extensions":["smf"]},"application/vnd.stardivision.writer":{"source":"apache","extensions":["sdw","vor"]},"application/vnd.stardivision.writer-global":{"source":"apache","extensions":["sgl"]},"application/vnd.stepmania.package":{"source":"iana","extensions":["smzip"]},"application/vnd.stepmania.stepchart":{"source":"iana","extensions":["sm"]},"application/vnd.street-stream":{"source":"iana"},"application/vnd.sun.wadl+xml":{"source":"iana","compressible":true,"extensions":["wadl"]},"application/vnd.sun.xml.calc":{"source":"apache","extensions":["sxc"]},"application/vnd.sun.xml.calc.template":{"source":"apache","extensions":["stc"]},"application/vnd.sun.xml.draw":{"source":"apache","extensions":["sxd"]},"application/vnd.sun.xml.draw.template":{"source":"apache","extensions":["std"]},"application/vnd.sun.xml.impress":{"source":"apache","extensions":["sxi"]},"application/vnd.sun.xml.impress.template":{"source":"apache","extensions":["sti"]},"application/vnd.sun.xml.math":{"source":"apache","extensions":["sxm"]},"application/vnd.sun.xml.writer":{"source":"apache","extensions":["sxw"]},"application/vnd.sun.xml.writer.global":{"source":"apache","extensions":["sxg"]},"application/vnd.sun.xml.writer.template":{"source":"apache","extensions":["stw"]},"application/vnd.sus-calendar":{"source":"iana","extensions":["sus","susp"]},"application/vnd.svd":{"source":"iana","extensions":["svd"]},"application/vnd.swiftview-ics":{"source":"iana"},"application/vnd.sycle+xml":{"source":"iana","compressible":true},"application/vnd.symbian.install":{"source":"apache","extensions":["sis","sisx"]},"application/vnd.syncml+xml":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["xsm"]},"application/vnd.syncml.dm+wbxml":{"source":"iana","charset":"UTF-8","extensions":["bdm"]},"application/vnd.syncml.dm+xml":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["xdm"]},"application/vnd.syncml.dm.notification":{"source":"iana"},"application/vnd.syncml.dmddf+wbxml":{"source":"iana"},"application/vnd.syncml.dmddf+xml":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["ddf"]},"application/vnd.syncml.dmtnds+wbxml":{"source":"iana"},"application/vnd.syncml.dmtnds+xml":{"source":"iana","charset":"UTF-8","compressible":true},"application/vnd.syncml.ds.notification":{"source":"iana"},"application/vnd.tableschema+json":{"source":"iana","compressible":true},"application/vnd.tao.intent-module-archive":{"source":"iana","extensions":["tao"]},"application/vnd.tcpdump.pcap":{"source":"iana","extensions":["pcap","cap","dmp"]},"application/vnd.think-cell.ppttc+json":{"source":"iana","compressible":true},"application/vnd.tmd.mediaflex.api+xml":{"source":"iana","compressible":true},"application/vnd.tml":{"source":"iana"},"application/vnd.tmobile-livetv":{"source":"iana","extensions":["tmo"]},"application/vnd.tri.onesource":{"source":"iana"},"application/vnd.trid.tpt":{"source":"iana","extensions":["tpt"]},"application/vnd.triscape.mxs":{"source":"iana","extensions":["mxs"]},"application/vnd.trueapp":{"source":"iana","extensions":["tra"]},"application/vnd.truedoc":{"source":"iana"},"application/vnd.ubisoft.webplayer":{"source":"iana"},"application/vnd.ufdl":{"source":"iana","extensions":["ufd","ufdl"]},"application/vnd.uiq.theme":{"source":"iana","extensions":["utz"]},"application/vnd.umajin":{"source":"iana","extensions":["umj"]},"application/vnd.unity":{"source":"iana","extensions":["unityweb"]},"application/vnd.uoml+xml":{"source":"iana","compressible":true,"extensions":["uoml"]},"application/vnd.uplanet.alert":{"source":"iana"},"application/vnd.uplanet.alert-wbxml":{"source":"iana"},"application/vnd.uplanet.bearer-choice":{"source":"iana"},"application/vnd.uplanet.bearer-choice-wbxml":{"source":"iana"},"application/vnd.uplanet.cacheop":{"source":"iana"},"application/vnd.uplanet.cacheop-wbxml":{"source":"iana"},"application/vnd.uplanet.channel":{"source":"iana"},"application/vnd.uplanet.channel-wbxml":{"source":"iana"},"application/vnd.uplanet.list":{"source":"iana"},"application/vnd.uplanet.list-wbxml":{"source":"iana"},"application/vnd.uplanet.listcmd":{"source":"iana"},"application/vnd.uplanet.listcmd-wbxml":{"source":"iana"},"application/vnd.uplanet.signal":{"source":"iana"},"application/vnd.uri-map":{"source":"iana"},"application/vnd.valve.source.material":{"source":"iana"},"application/vnd.vcx":{"source":"iana","extensions":["vcx"]},"application/vnd.vd-study":{"source":"iana"},"application/vnd.vectorworks":{"source":"iana"},"application/vnd.vel+json":{"source":"iana","compressible":true},"application/vnd.verimatrix.vcas":{"source":"iana"},"application/vnd.veryant.thin":{"source":"iana"},"application/vnd.ves.encrypted":{"source":"iana"},"application/vnd.vidsoft.vidconference":{"source":"iana"},"application/vnd.visio":{"source":"iana","extensions":["vsd","vst","vss","vsw"]},"application/vnd.visionary":{"source":"iana","extensions":["vis"]},"application/vnd.vividence.scriptfile":{"source":"iana"},"application/vnd.vsf":{"source":"iana","extensions":["vsf"]},"application/vnd.wap.sic":{"source":"iana"},"application/vnd.wap.slc":{"source":"iana"},"application/vnd.wap.wbxml":{"source":"iana","charset":"UTF-8","extensions":["wbxml"]},"application/vnd.wap.wmlc":{"source":"iana","extensions":["wmlc"]},"application/vnd.wap.wmlscriptc":{"source":"iana","extensions":["wmlsc"]},"application/vnd.webturbo":{"source":"iana","extensions":["wtb"]},"application/vnd.wfa.dpp":{"source":"iana"},"application/vnd.wfa.p2p":{"source":"iana"},"application/vnd.wfa.wsc":{"source":"iana"},"application/vnd.windows.devicepairing":{"source":"iana"},"application/vnd.wmc":{"source":"iana"},"application/vnd.wmf.bootstrap":{"source":"iana"},"application/vnd.wolfram.mathematica":{"source":"iana"},"application/vnd.wolfram.mathematica.package":{"source":"iana"},"application/vnd.wolfram.player":{"source":"iana","extensions":["nbp"]},"application/vnd.wordperfect":{"source":"iana","extensions":["wpd"]},"application/vnd.wqd":{"source":"iana","extensions":["wqd"]},"application/vnd.wrq-hp3000-labelled":{"source":"iana"},"application/vnd.wt.stf":{"source":"iana","extensions":["stf"]},"application/vnd.wv.csp+wbxml":{"source":"iana"},"application/vnd.wv.csp+xml":{"source":"iana","compressible":true},"application/vnd.wv.ssp+xml":{"source":"iana","compressible":true},"application/vnd.xacml+json":{"source":"iana","compressible":true},"application/vnd.xara":{"source":"iana","extensions":["xar"]},"application/vnd.xfdl":{"source":"iana","extensions":["xfdl"]},"application/vnd.xfdl.webform":{"source":"iana"},"application/vnd.xmi+xml":{"source":"iana","compressible":true},"application/vnd.xmpie.cpkg":{"source":"iana"},"application/vnd.xmpie.dpkg":{"source":"iana"},"application/vnd.xmpie.plan":{"source":"iana"},"application/vnd.xmpie.ppkg":{"source":"iana"},"application/vnd.xmpie.xlim":{"source":"iana"},"application/vnd.yamaha.hv-dic":{"source":"iana","extensions":["hvd"]},"application/vnd.yamaha.hv-script":{"source":"iana","extensions":["hvs"]},"application/vnd.yamaha.hv-voice":{"source":"iana","extensions":["hvp"]},"application/vnd.yamaha.openscoreformat":{"source":"iana","extensions":["osf"]},"application/vnd.yamaha.openscoreformat.osfpvg+xml":{"source":"iana","compressible":true,"extensions":["osfpvg"]},"application/vnd.yamaha.remote-setup":{"source":"iana"},"application/vnd.yamaha.smaf-audio":{"source":"iana","extensions":["saf"]},"application/vnd.yamaha.smaf-phrase":{"source":"iana","extensions":["spf"]},"application/vnd.yamaha.through-ngn":{"source":"iana"},"application/vnd.yamaha.tunnel-udpencap":{"source":"iana"},"application/vnd.yaoweme":{"source":"iana"},"application/vnd.yellowriver-custom-menu":{"source":"iana","extensions":["cmp"]},"application/vnd.youtube.yt":{"source":"iana"},"application/vnd.zul":{"source":"iana","extensions":["zir","zirz"]},"application/vnd.zzazz.deck+xml":{"source":"iana","compressible":true,"extensions":["zaz"]},"application/voicexml+xml":{"source":"iana","compressible":true,"extensions":["vxml"]},"application/voucher-cms+json":{"source":"iana","compressible":true},"application/vq-rtcpxr":{"source":"iana"},"application/wasm":{"compressible":true,"extensions":["wasm"]},"application/watcherinfo+xml":{"source":"iana","compressible":true},"application/webpush-options+json":{"source":"iana","compressible":true},"application/whoispp-query":{"source":"iana"},"application/whoispp-response":{"source":"iana"},"application/widget":{"source":"iana","extensions":["wgt"]},"application/winhlp":{"source":"apache","extensions":["hlp"]},"application/wita":{"source":"iana"},"application/wordperfect5.1":{"source":"iana"},"application/wsdl+xml":{"source":"iana","compressible":true,"extensions":["wsdl"]},"application/wspolicy+xml":{"source":"iana","compressible":true,"extensions":["wspolicy"]},"application/x-7z-compressed":{"source":"apache","compressible":false,"extensions":["7z"]},"application/x-abiword":{"source":"apache","extensions":["abw"]},"application/x-ace-compressed":{"source":"apache","extensions":["ace"]},"application/x-amf":{"source":"apache"},"application/x-apple-diskimage":{"source":"apache","extensions":["dmg"]},"application/x-arj":{"compressible":false,"extensions":["arj"]},"application/x-authorware-bin":{"source":"apache","extensions":["aab","x32","u32","vox"]},"application/x-authorware-map":{"source":"apache","extensions":["aam"]},"application/x-authorware-seg":{"source":"apache","extensions":["aas"]},"application/x-bcpio":{"source":"apache","extensions":["bcpio"]},"application/x-bdoc":{"compressible":false,"extensions":["bdoc"]},"application/x-bittorrent":{"source":"apache","extensions":["torrent"]},"application/x-blorb":{"source":"apache","extensions":["blb","blorb"]},"application/x-bzip":{"source":"apache","compressible":false,"extensions":["bz"]},"application/x-bzip2":{"source":"apache","compressible":false,"extensions":["bz2","boz"]},"application/x-cbr":{"source":"apache","extensions":["cbr","cba","cbt","cbz","cb7"]},"application/x-cdlink":{"source":"apache","extensions":["vcd"]},"application/x-cfs-compressed":{"source":"apache","extensions":["cfs"]},"application/x-chat":{"source":"apache","extensions":["chat"]},"application/x-chess-pgn":{"source":"apache","extensions":["pgn"]},"application/x-chrome-extension":{"extensions":["crx"]},"application/x-cocoa":{"source":"nginx","extensions":["cco"]},"application/x-compress":{"source":"apache"},"application/x-conference":{"source":"apache","extensions":["nsc"]},"application/x-cpio":{"source":"apache","extensions":["cpio"]},"application/x-csh":{"source":"apache","extensions":["csh"]},"application/x-deb":{"compressible":false},"application/x-debian-package":{"source":"apache","extensions":["deb","udeb"]},"application/x-dgc-compressed":{"source":"apache","extensions":["dgc"]},"application/x-director":{"source":"apache","extensions":["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"]},"application/x-doom":{"source":"apache","extensions":["wad"]},"application/x-dtbncx+xml":{"source":"apache","compressible":true,"extensions":["ncx"]},"application/x-dtbook+xml":{"source":"apache","compressible":true,"extensions":["dtb"]},"application/x-dtbresource+xml":{"source":"apache","compressible":true,"extensions":["res"]},"application/x-dvi":{"source":"apache","compressible":false,"extensions":["dvi"]},"application/x-envoy":{"source":"apache","extensions":["evy"]},"application/x-eva":{"source":"apache","extensions":["eva"]},"application/x-font-bdf":{"source":"apache","extensions":["bdf"]},"application/x-font-dos":{"source":"apache"},"application/x-font-framemaker":{"source":"apache"},"application/x-font-ghostscript":{"source":"apache","extensions":["gsf"]},"application/x-font-libgrx":{"source":"apache"},"application/x-font-linux-psf":{"source":"apache","extensions":["psf"]},"application/x-font-pcf":{"source":"apache","extensions":["pcf"]},"application/x-font-snf":{"source":"apache","extensions":["snf"]},"application/x-font-speedo":{"source":"apache"},"application/x-font-sunos-news":{"source":"apache"},"application/x-font-type1":{"source":"apache","extensions":["pfa","pfb","pfm","afm"]},"application/x-font-vfont":{"source":"apache"},"application/x-freearc":{"source":"apache","extensions":["arc"]},"application/x-futuresplash":{"source":"apache","extensions":["spl"]},"application/x-gca-compressed":{"source":"apache","extensions":["gca"]},"application/x-glulx":{"source":"apache","extensions":["ulx"]},"application/x-gnumeric":{"source":"apache","extensions":["gnumeric"]},"application/x-gramps-xml":{"source":"apache","extensions":["gramps"]},"application/x-gtar":{"source":"apache","extensions":["gtar"]},"application/x-gzip":{"source":"apache"},"application/x-hdf":{"source":"apache","extensions":["hdf"]},"application/x-httpd-php":{"compressible":true,"extensions":["php"]},"application/x-install-instructions":{"source":"apache","extensions":["install"]},"application/x-iso9660-image":{"source":"apache","extensions":["iso"]},"application/x-java-archive-diff":{"source":"nginx","extensions":["jardiff"]},"application/x-java-jnlp-file":{"source":"apache","compressible":false,"extensions":["jnlp"]},"application/x-javascript":{"compressible":true},"application/x-keepass2":{"extensions":["kdbx"]},"application/x-latex":{"source":"apache","compressible":false,"extensions":["latex"]},"application/x-lua-bytecode":{"extensions":["luac"]},"application/x-lzh-compressed":{"source":"apache","extensions":["lzh","lha"]},"application/x-makeself":{"source":"nginx","extensions":["run"]},"application/x-mie":{"source":"apache","extensions":["mie"]},"application/x-mobipocket-ebook":{"source":"apache","extensions":["prc","mobi"]},"application/x-mpegurl":{"compressible":false},"application/x-ms-application":{"source":"apache","extensions":["application"]},"application/x-ms-shortcut":{"source":"apache","extensions":["lnk"]},"application/x-ms-wmd":{"source":"apache","extensions":["wmd"]},"application/x-ms-wmz":{"source":"apache","extensions":["wmz"]},"application/x-ms-xbap":{"source":"apache","extensions":["xbap"]},"application/x-msaccess":{"source":"apache","extensions":["mdb"]},"application/x-msbinder":{"source":"apache","extensions":["obd"]},"application/x-mscardfile":{"source":"apache","extensions":["crd"]},"application/x-msclip":{"source":"apache","extensions":["clp"]},"application/x-msdos-program":{"extensions":["exe"]},"application/x-msdownload":{"source":"apache","extensions":["exe","dll","com","bat","msi"]},"application/x-msmediaview":{"source":"apache","extensions":["mvb","m13","m14"]},"application/x-msmetafile":{"source":"apache","extensions":["wmf","wmz","emf","emz"]},"application/x-msmoney":{"source":"apache","extensions":["mny"]},"application/x-mspublisher":{"source":"apache","extensions":["pub"]},"application/x-msschedule":{"source":"apache","extensions":["scd"]},"application/x-msterminal":{"source":"apache","extensions":["trm"]},"application/x-mswrite":{"source":"apache","extensions":["wri"]},"application/x-netcdf":{"source":"apache","extensions":["nc","cdf"]},"application/x-ns-proxy-autoconfig":{"compressible":true,"extensions":["pac"]},"application/x-nzb":{"source":"apache","extensions":["nzb"]},"application/x-perl":{"source":"nginx","extensions":["pl","pm"]},"application/x-pilot":{"source":"nginx","extensions":["prc","pdb"]},"application/x-pkcs12":{"source":"apache","compressible":false,"extensions":["p12","pfx"]},"application/x-pkcs7-certificates":{"source":"apache","extensions":["p7b","spc"]},"application/x-pkcs7-certreqresp":{"source":"apache","extensions":["p7r"]},"application/x-pki-message":{"source":"iana"},"application/x-rar-compressed":{"source":"apache","compressible":false,"extensions":["rar"]},"application/x-redhat-package-manager":{"source":"nginx","extensions":["rpm"]},"application/x-research-info-systems":{"source":"apache","extensions":["ris"]},"application/x-sea":{"source":"nginx","extensions":["sea"]},"application/x-sh":{"source":"apache","compressible":true,"extensions":["sh"]},"application/x-shar":{"source":"apache","extensions":["shar"]},"application/x-shockwave-flash":{"source":"apache","compressible":false,"extensions":["swf"]},"application/x-silverlight-app":{"source":"apache","extensions":["xap"]},"application/x-sql":{"source":"apache","extensions":["sql"]},"application/x-stuffit":{"source":"apache","compressible":false,"extensions":["sit"]},"application/x-stuffitx":{"source":"apache","extensions":["sitx"]},"application/x-subrip":{"source":"apache","extensions":["srt"]},"application/x-sv4cpio":{"source":"apache","extensions":["sv4cpio"]},"application/x-sv4crc":{"source":"apache","extensions":["sv4crc"]},"application/x-t3vm-image":{"source":"apache","extensions":["t3"]},"application/x-tads":{"source":"apache","extensions":["gam"]},"application/x-tar":{"source":"apache","compressible":true,"extensions":["tar"]},"application/x-tcl":{"source":"apache","extensions":["tcl","tk"]},"application/x-tex":{"source":"apache","extensions":["tex"]},"application/x-tex-tfm":{"source":"apache","extensions":["tfm"]},"application/x-texinfo":{"source":"apache","extensions":["texinfo","texi"]},"application/x-tgif":{"source":"apache","extensions":["obj"]},"application/x-ustar":{"source":"apache","extensions":["ustar"]},"application/x-virtualbox-hdd":{"compressible":true,"extensions":["hdd"]},"application/x-virtualbox-ova":{"compressible":true,"extensions":["ova"]},"application/x-virtualbox-ovf":{"compressible":true,"extensions":["ovf"]},"application/x-virtualbox-vbox":{"compressible":true,"extensions":["vbox"]},"application/x-virtualbox-vbox-extpack":{"compressible":false,"extensions":["vbox-extpack"]},"application/x-virtualbox-vdi":{"compressible":true,"extensions":["vdi"]},"application/x-virtualbox-vhd":{"compressible":true,"extensions":["vhd"]},"application/x-virtualbox-vmdk":{"compressible":true,"extensions":["vmdk"]},"application/x-wais-source":{"source":"apache","extensions":["src"]},"application/x-web-app-manifest+json":{"compressible":true,"extensions":["webapp"]},"application/x-www-form-urlencoded":{"source":"iana","compressible":true},"application/x-x509-ca-cert":{"source":"iana","extensions":["der","crt","pem"]},"application/x-x509-ca-ra-cert":{"source":"iana"},"application/x-x509-next-ca-cert":{"source":"iana"},"application/x-xfig":{"source":"apache","extensions":["fig"]},"application/x-xliff+xml":{"source":"apache","compressible":true,"extensions":["xlf"]},"application/x-xpinstall":{"source":"apache","compressible":false,"extensions":["xpi"]},"application/x-xz":{"source":"apache","extensions":["xz"]},"application/x-zmachine":{"source":"apache","extensions":["z1","z2","z3","z4","z5","z6","z7","z8"]},"application/x400-bp":{"source":"iana"},"application/xacml+xml":{"source":"iana","compressible":true},"application/xaml+xml":{"source":"apache","compressible":true,"extensions":["xaml"]},"application/xcap-att+xml":{"source":"iana","compressible":true,"extensions":["xav"]},"application/xcap-caps+xml":{"source":"iana","compressible":true,"extensions":["xca"]},"application/xcap-diff+xml":{"source":"iana","compressible":true,"extensions":["xdf"]},"application/xcap-el+xml":{"source":"iana","compressible":true,"extensions":["xel"]},"application/xcap-error+xml":{"source":"iana","compressible":true,"extensions":["xer"]},"application/xcap-ns+xml":{"source":"iana","compressible":true,"extensions":["xns"]},"application/xcon-conference-info+xml":{"source":"iana","compressible":true},"application/xcon-conference-info-diff+xml":{"source":"iana","compressible":true},"application/xenc+xml":{"source":"iana","compressible":true,"extensions":["xenc"]},"application/xhtml+xml":{"source":"iana","compressible":true,"extensions":["xhtml","xht"]},"application/xhtml-voice+xml":{"source":"apache","compressible":true},"application/xliff+xml":{"source":"iana","compressible":true,"extensions":["xlf"]},"application/xml":{"source":"iana","compressible":true,"extensions":["xml","xsl","xsd","rng"]},"application/xml-dtd":{"source":"iana","compressible":true,"extensions":["dtd"]},"application/xml-external-parsed-entity":{"source":"iana"},"application/xml-patch+xml":{"source":"iana","compressible":true},"application/xmpp+xml":{"source":"iana","compressible":true},"application/xop+xml":{"source":"iana","compressible":true,"extensions":["xop"]},"application/xproc+xml":{"source":"apache","compressible":true,"extensions":["xpl"]},"application/xslt+xml":{"source":"iana","compressible":true,"extensions":["xsl","xslt"]},"application/xspf+xml":{"source":"apache","compressible":true,"extensions":["xspf"]},"application/xv+xml":{"source":"iana","compressible":true,"extensions":["mxml","xhvml","xvml","xvm"]},"application/yang":{"source":"iana","extensions":["yang"]},"application/yang-data+json":{"source":"iana","compressible":true},"application/yang-data+xml":{"source":"iana","compressible":true},"application/yang-patch+json":{"source":"iana","compressible":true},"application/yang-patch+xml":{"source":"iana","compressible":true},"application/yin+xml":{"source":"iana","compressible":true,"extensions":["yin"]},"application/zip":{"source":"iana","compressible":false,"extensions":["zip"]},"application/zlib":{"source":"iana"},"application/zstd":{"source":"iana"},"audio/1d-interleaved-parityfec":{"source":"iana"},"audio/32kadpcm":{"source":"iana"},"audio/3gpp":{"source":"iana","compressible":false,"extensions":["3gpp"]},"audio/3gpp2":{"source":"iana"},"audio/aac":{"source":"iana"},"audio/ac3":{"source":"iana"},"audio/adpcm":{"source":"apache","extensions":["adp"]},"audio/amr":{"source":"iana","extensions":["amr"]},"audio/amr-wb":{"source":"iana"},"audio/amr-wb+":{"source":"iana"},"audio/aptx":{"source":"iana"},"audio/asc":{"source":"iana"},"audio/atrac-advanced-lossless":{"source":"iana"},"audio/atrac-x":{"source":"iana"},"audio/atrac3":{"source":"iana"},"audio/basic":{"source":"iana","compressible":false,"extensions":["au","snd"]},"audio/bv16":{"source":"iana"},"audio/bv32":{"source":"iana"},"audio/clearmode":{"source":"iana"},"audio/cn":{"source":"iana"},"audio/dat12":{"source":"iana"},"audio/dls":{"source":"iana"},"audio/dsr-es201108":{"source":"iana"},"audio/dsr-es202050":{"source":"iana"},"audio/dsr-es202211":{"source":"iana"},"audio/dsr-es202212":{"source":"iana"},"audio/dv":{"source":"iana"},"audio/dvi4":{"source":"iana"},"audio/eac3":{"source":"iana"},"audio/encaprtp":{"source":"iana"},"audio/evrc":{"source":"iana"},"audio/evrc-qcp":{"source":"iana"},"audio/evrc0":{"source":"iana"},"audio/evrc1":{"source":"iana"},"audio/evrcb":{"source":"iana"},"audio/evrcb0":{"source":"iana"},"audio/evrcb1":{"source":"iana"},"audio/evrcnw":{"source":"iana"},"audio/evrcnw0":{"source":"iana"},"audio/evrcnw1":{"source":"iana"},"audio/evrcwb":{"source":"iana"},"audio/evrcwb0":{"source":"iana"},"audio/evrcwb1":{"source":"iana"},"audio/evs":{"source":"iana"},"audio/flexfec":{"source":"iana"},"audio/fwdred":{"source":"iana"},"audio/g711-0":{"source":"iana"},"audio/g719":{"source":"iana"},"audio/g722":{"source":"iana"},"audio/g7221":{"source":"iana"},"audio/g723":{"source":"iana"},"audio/g726-16":{"source":"iana"},"audio/g726-24":{"source":"iana"},"audio/g726-32":{"source":"iana"},"audio/g726-40":{"source":"iana"},"audio/g728":{"source":"iana"},"audio/g729":{"source":"iana"},"audio/g7291":{"source":"iana"},"audio/g729d":{"source":"iana"},"audio/g729e":{"source":"iana"},"audio/gsm":{"source":"iana"},"audio/gsm-efr":{"source":"iana"},"audio/gsm-hr-08":{"source":"iana"},"audio/ilbc":{"source":"iana"},"audio/ip-mr_v2.5":{"source":"iana"},"audio/isac":{"source":"apache"},"audio/l16":{"source":"iana"},"audio/l20":{"source":"iana"},"audio/l24":{"source":"iana","compressible":false},"audio/l8":{"source":"iana"},"audio/lpc":{"source":"iana"},"audio/melp":{"source":"iana"},"audio/melp1200":{"source":"iana"},"audio/melp2400":{"source":"iana"},"audio/melp600":{"source":"iana"},"audio/mhas":{"source":"iana"},"audio/midi":{"source":"apache","extensions":["mid","midi","kar","rmi"]},"audio/mobile-xmf":{"source":"iana","extensions":["mxmf"]},"audio/mp3":{"compressible":false,"extensions":["mp3"]},"audio/mp4":{"source":"iana","compressible":false,"extensions":["m4a","mp4a"]},"audio/mp4a-latm":{"source":"iana"},"audio/mpa":{"source":"iana"},"audio/mpa-robust":{"source":"iana"},"audio/mpeg":{"source":"iana","compressible":false,"extensions":["mpga","mp2","mp2a","mp3","m2a","m3a"]},"audio/mpeg4-generic":{"source":"iana"},"audio/musepack":{"source":"apache"},"audio/ogg":{"source":"iana","compressible":false,"extensions":["oga","ogg","spx","opus"]},"audio/opus":{"source":"iana"},"audio/parityfec":{"source":"iana"},"audio/pcma":{"source":"iana"},"audio/pcma-wb":{"source":"iana"},"audio/pcmu":{"source":"iana"},"audio/pcmu-wb":{"source":"iana"},"audio/prs.sid":{"source":"iana"},"audio/qcelp":{"source":"iana"},"audio/raptorfec":{"source":"iana"},"audio/red":{"source":"iana"},"audio/rtp-enc-aescm128":{"source":"iana"},"audio/rtp-midi":{"source":"iana"},"audio/rtploopback":{"source":"iana"},"audio/rtx":{"source":"iana"},"audio/s3m":{"source":"apache","extensions":["s3m"]},"audio/scip":{"source":"iana"},"audio/silk":{"source":"apache","extensions":["sil"]},"audio/smv":{"source":"iana"},"audio/smv-qcp":{"source":"iana"},"audio/smv0":{"source":"iana"},"audio/sofa":{"source":"iana"},"audio/sp-midi":{"source":"iana"},"audio/speex":{"source":"iana"},"audio/t140c":{"source":"iana"},"audio/t38":{"source":"iana"},"audio/telephone-event":{"source":"iana"},"audio/tetra_acelp":{"source":"iana"},"audio/tetra_acelp_bb":{"source":"iana"},"audio/tone":{"source":"iana"},"audio/tsvcis":{"source":"iana"},"audio/uemclip":{"source":"iana"},"audio/ulpfec":{"source":"iana"},"audio/usac":{"source":"iana"},"audio/vdvi":{"source":"iana"},"audio/vmr-wb":{"source":"iana"},"audio/vnd.3gpp.iufp":{"source":"iana"},"audio/vnd.4sb":{"source":"iana"},"audio/vnd.audiokoz":{"source":"iana"},"audio/vnd.celp":{"source":"iana"},"audio/vnd.cisco.nse":{"source":"iana"},"audio/vnd.cmles.radio-events":{"source":"iana"},"audio/vnd.cns.anp1":{"source":"iana"},"audio/vnd.cns.inf1":{"source":"iana"},"audio/vnd.dece.audio":{"source":"iana","extensions":["uva","uvva"]},"audio/vnd.digital-winds":{"source":"iana","extensions":["eol"]},"audio/vnd.dlna.adts":{"source":"iana"},"audio/vnd.dolby.heaac.1":{"source":"iana"},"audio/vnd.dolby.heaac.2":{"source":"iana"},"audio/vnd.dolby.mlp":{"source":"iana"},"audio/vnd.dolby.mps":{"source":"iana"},"audio/vnd.dolby.pl2":{"source":"iana"},"audio/vnd.dolby.pl2x":{"source":"iana"},"audio/vnd.dolby.pl2z":{"source":"iana"},"audio/vnd.dolby.pulse.1":{"source":"iana"},"audio/vnd.dra":{"source":"iana","extensions":["dra"]},"audio/vnd.dts":{"source":"iana","extensions":["dts"]},"audio/vnd.dts.hd":{"source":"iana","extensions":["dtshd"]},"audio/vnd.dts.uhd":{"source":"iana"},"audio/vnd.dvb.file":{"source":"iana"},"audio/vnd.everad.plj":{"source":"iana"},"audio/vnd.hns.audio":{"source":"iana"},"audio/vnd.lucent.voice":{"source":"iana","extensions":["lvp"]},"audio/vnd.ms-playready.media.pya":{"source":"iana","extensions":["pya"]},"audio/vnd.nokia.mobile-xmf":{"source":"iana"},"audio/vnd.nortel.vbk":{"source":"iana"},"audio/vnd.nuera.ecelp4800":{"source":"iana","extensions":["ecelp4800"]},"audio/vnd.nuera.ecelp7470":{"source":"iana","extensions":["ecelp7470"]},"audio/vnd.nuera.ecelp9600":{"source":"iana","extensions":["ecelp9600"]},"audio/vnd.octel.sbc":{"source":"iana"},"audio/vnd.presonus.multitrack":{"source":"iana"},"audio/vnd.qcelp":{"source":"iana"},"audio/vnd.rhetorex.32kadpcm":{"source":"iana"},"audio/vnd.rip":{"source":"iana","extensions":["rip"]},"audio/vnd.rn-realaudio":{"compressible":false},"audio/vnd.sealedmedia.softseal.mpeg":{"source":"iana"},"audio/vnd.vmx.cvsd":{"source":"iana"},"audio/vnd.wave":{"compressible":false},"audio/vorbis":{"source":"iana","compressible":false},"audio/vorbis-config":{"source":"iana"},"audio/wav":{"compressible":false,"extensions":["wav"]},"audio/wave":{"compressible":false,"extensions":["wav"]},"audio/webm":{"source":"apache","compressible":false,"extensions":["weba"]},"audio/x-aac":{"source":"apache","compressible":false,"extensions":["aac"]},"audio/x-aiff":{"source":"apache","extensions":["aif","aiff","aifc"]},"audio/x-caf":{"source":"apache","compressible":false,"extensions":["caf"]},"audio/x-flac":{"source":"apache","extensions":["flac"]},"audio/x-m4a":{"source":"nginx","extensions":["m4a"]},"audio/x-matroska":{"source":"apache","extensions":["mka"]},"audio/x-mpegurl":{"source":"apache","extensions":["m3u"]},"audio/x-ms-wax":{"source":"apache","extensions":["wax"]},"audio/x-ms-wma":{"source":"apache","extensions":["wma"]},"audio/x-pn-realaudio":{"source":"apache","extensions":["ram","ra"]},"audio/x-pn-realaudio-plugin":{"source":"apache","extensions":["rmp"]},"audio/x-realaudio":{"source":"nginx","extensions":["ra"]},"audio/x-tta":{"source":"apache"},"audio/x-wav":{"source":"apache","extensions":["wav"]},"audio/xm":{"source":"apache","extensions":["xm"]},"chemical/x-cdx":{"source":"apache","extensions":["cdx"]},"chemical/x-cif":{"source":"apache","extensions":["cif"]},"chemical/x-cmdf":{"source":"apache","extensions":["cmdf"]},"chemical/x-cml":{"source":"apache","extensions":["cml"]},"chemical/x-csml":{"source":"apache","extensions":["csml"]},"chemical/x-pdb":{"source":"apache"},"chemical/x-xyz":{"source":"apache","extensions":["xyz"]},"font/collection":{"source":"iana","extensions":["ttc"]},"font/otf":{"source":"iana","compressible":true,"extensions":["otf"]},"font/sfnt":{"source":"iana"},"font/ttf":{"source":"iana","compressible":true,"extensions":["ttf"]},"font/woff":{"source":"iana","extensions":["woff"]},"font/woff2":{"source":"iana","extensions":["woff2"]},"image/aces":{"source":"iana","extensions":["exr"]},"image/apng":{"compressible":false,"extensions":["apng"]},"image/avci":{"source":"iana"},"image/avcs":{"source":"iana"},"image/avif":{"source":"iana","compressible":false,"extensions":["avif"]},"image/bmp":{"source":"iana","compressible":true,"extensions":["bmp"]},"image/cgm":{"source":"iana","extensions":["cgm"]},"image/dicom-rle":{"source":"iana","extensions":["drle"]},"image/emf":{"source":"iana","extensions":["emf"]},"image/fits":{"source":"iana","extensions":["fits"]},"image/g3fax":{"source":"iana","extensions":["g3"]},"image/gif":{"source":"iana","compressible":false,"extensions":["gif"]},"image/heic":{"source":"iana","extensions":["heic"]},"image/heic-sequence":{"source":"iana","extensions":["heics"]},"image/heif":{"source":"iana","extensions":["heif"]},"image/heif-sequence":{"source":"iana","extensions":["heifs"]},"image/hej2k":{"source":"iana","extensions":["hej2"]},"image/hsj2":{"source":"iana","extensions":["hsj2"]},"image/ief":{"source":"iana","extensions":["ief"]},"image/jls":{"source":"iana","extensions":["jls"]},"image/jp2":{"source":"iana","compressible":false,"extensions":["jp2","jpg2"]},"image/jpeg":{"source":"iana","compressible":false,"extensions":["jpeg","jpg","jpe"]},"image/jph":{"source":"iana","extensions":["jph"]},"image/jphc":{"source":"iana","extensions":["jhc"]},"image/jpm":{"source":"iana","compressible":false,"extensions":["jpm"]},"image/jpx":{"source":"iana","compressible":false,"extensions":["jpx","jpf"]},"image/jxr":{"source":"iana","extensions":["jxr"]},"image/jxra":{"source":"iana","extensions":["jxra"]},"image/jxrs":{"source":"iana","extensions":["jxrs"]},"image/jxs":{"source":"iana","extensions":["jxs"]},"image/jxsc":{"source":"iana","extensions":["jxsc"]},"image/jxsi":{"source":"iana","extensions":["jxsi"]},"image/jxss":{"source":"iana","extensions":["jxss"]},"image/ktx":{"source":"iana","extensions":["ktx"]},"image/ktx2":{"source":"iana","extensions":["ktx2"]},"image/naplps":{"source":"iana"},"image/pjpeg":{"compressible":false},"image/png":{"source":"iana","compressible":false,"extensions":["png"]},"image/prs.btif":{"source":"iana","extensions":["btif"]},"image/prs.pti":{"source":"iana","extensions":["pti"]},"image/pwg-raster":{"source":"iana"},"image/sgi":{"source":"apache","extensions":["sgi"]},"image/svg+xml":{"source":"iana","compressible":true,"extensions":["svg","svgz"]},"image/t38":{"source":"iana","extensions":["t38"]},"image/tiff":{"source":"iana","compressible":false,"extensions":["tif","tiff"]},"image/tiff-fx":{"source":"iana","extensions":["tfx"]},"image/vnd.adobe.photoshop":{"source":"iana","compressible":true,"extensions":["psd"]},"image/vnd.airzip.accelerator.azv":{"source":"iana","extensions":["azv"]},"image/vnd.cns.inf2":{"source":"iana"},"image/vnd.dece.graphic":{"source":"iana","extensions":["uvi","uvvi","uvg","uvvg"]},"image/vnd.djvu":{"source":"iana","extensions":["djvu","djv"]},"image/vnd.dvb.subtitle":{"source":"iana","extensions":["sub"]},"image/vnd.dwg":{"source":"iana","extensions":["dwg"]},"image/vnd.dxf":{"source":"iana","extensions":["dxf"]},"image/vnd.fastbidsheet":{"source":"iana","extensions":["fbs"]},"image/vnd.fpx":{"source":"iana","extensions":["fpx"]},"image/vnd.fst":{"source":"iana","extensions":["fst"]},"image/vnd.fujixerox.edmics-mmr":{"source":"iana","extensions":["mmr"]},"image/vnd.fujixerox.edmics-rlc":{"source":"iana","extensions":["rlc"]},"image/vnd.globalgraphics.pgb":{"source":"iana"},"image/vnd.microsoft.icon":{"source":"iana","extensions":["ico"]},"image/vnd.mix":{"source":"iana"},"image/vnd.mozilla.apng":{"source":"iana"},"image/vnd.ms-dds":{"extensions":["dds"]},"image/vnd.ms-modi":{"source":"iana","extensions":["mdi"]},"image/vnd.ms-photo":{"source":"apache","extensions":["wdp"]},"image/vnd.net-fpx":{"source":"iana","extensions":["npx"]},"image/vnd.pco.b16":{"source":"iana","extensions":["b16"]},"image/vnd.radiance":{"source":"iana"},"image/vnd.sealed.png":{"source":"iana"},"image/vnd.sealedmedia.softseal.gif":{"source":"iana"},"image/vnd.sealedmedia.softseal.jpg":{"source":"iana"},"image/vnd.svf":{"source":"iana"},"image/vnd.tencent.tap":{"source":"iana","extensions":["tap"]},"image/vnd.valve.source.texture":{"source":"iana","extensions":["vtf"]},"image/vnd.wap.wbmp":{"source":"iana","extensions":["wbmp"]},"image/vnd.xiff":{"source":"iana","extensions":["xif"]},"image/vnd.zbrush.pcx":{"source":"iana","extensions":["pcx"]},"image/webp":{"source":"apache","extensions":["webp"]},"image/wmf":{"source":"iana","extensions":["wmf"]},"image/x-3ds":{"source":"apache","extensions":["3ds"]},"image/x-cmu-raster":{"source":"apache","extensions":["ras"]},"image/x-cmx":{"source":"apache","extensions":["cmx"]},"image/x-freehand":{"source":"apache","extensions":["fh","fhc","fh4","fh5","fh7"]},"image/x-icon":{"source":"apache","compressible":true,"extensions":["ico"]},"image/x-jng":{"source":"nginx","extensions":["jng"]},"image/x-mrsid-image":{"source":"apache","extensions":["sid"]},"image/x-ms-bmp":{"source":"nginx","compressible":true,"extensions":["bmp"]},"image/x-pcx":{"source":"apache","extensions":["pcx"]},"image/x-pict":{"source":"apache","extensions":["pic","pct"]},"image/x-portable-anymap":{"source":"apache","extensions":["pnm"]},"image/x-portable-bitmap":{"source":"apache","extensions":["pbm"]},"image/x-portable-graymap":{"source":"apache","extensions":["pgm"]},"image/x-portable-pixmap":{"source":"apache","extensions":["ppm"]},"image/x-rgb":{"source":"apache","extensions":["rgb"]},"image/x-tga":{"source":"apache","extensions":["tga"]},"image/x-xbitmap":{"source":"apache","extensions":["xbm"]},"image/x-xcf":{"compressible":false},"image/x-xpixmap":{"source":"apache","extensions":["xpm"]},"image/x-xwindowdump":{"source":"apache","extensions":["xwd"]},"message/cpim":{"source":"iana"},"message/delivery-status":{"source":"iana"},"message/disposition-notification":{"source":"iana","extensions":["disposition-notification"]},"message/external-body":{"source":"iana"},"message/feedback-report":{"source":"iana"},"message/global":{"source":"iana","extensions":["u8msg"]},"message/global-delivery-status":{"source":"iana","extensions":["u8dsn"]},"message/global-disposition-notification":{"source":"iana","extensions":["u8mdn"]},"message/global-headers":{"source":"iana","extensions":["u8hdr"]},"message/http":{"source":"iana","compressible":false},"message/imdn+xml":{"source":"iana","compressible":true},"message/news":{"source":"iana"},"message/partial":{"source":"iana","compressible":false},"message/rfc822":{"source":"iana","compressible":true,"extensions":["eml","mime"]},"message/s-http":{"source":"iana"},"message/sip":{"source":"iana"},"message/sipfrag":{"source":"iana"},"message/tracking-status":{"source":"iana"},"message/vnd.si.simp":{"source":"iana"},"message/vnd.wfa.wsc":{"source":"iana","extensions":["wsc"]},"model/3mf":{"source":"iana","extensions":["3mf"]},"model/e57":{"source":"iana"},"model/gltf+json":{"source":"iana","compressible":true,"extensions":["gltf"]},"model/gltf-binary":{"source":"iana","compressible":true,"extensions":["glb"]},"model/iges":{"source":"iana","compressible":false,"extensions":["igs","iges"]},"model/mesh":{"source":"iana","compressible":false,"extensions":["msh","mesh","silo"]},"model/mtl":{"source":"iana","extensions":["mtl"]},"model/obj":{"source":"iana","extensions":["obj"]},"model/stl":{"source":"iana","extensions":["stl"]},"model/vnd.collada+xml":{"source":"iana","compressible":true,"extensions":["dae"]},"model/vnd.dwf":{"source":"iana","extensions":["dwf"]},"model/vnd.flatland.3dml":{"source":"iana"},"model/vnd.gdl":{"source":"iana","extensions":["gdl"]},"model/vnd.gs-gdl":{"source":"apache"},"model/vnd.gs.gdl":{"source":"iana"},"model/vnd.gtw":{"source":"iana","extensions":["gtw"]},"model/vnd.moml+xml":{"source":"iana","compressible":true},"model/vnd.mts":{"source":"iana","extensions":["mts"]},"model/vnd.opengex":{"source":"iana","extensions":["ogex"]},"model/vnd.parasolid.transmit.binary":{"source":"iana","extensions":["x_b"]},"model/vnd.parasolid.transmit.text":{"source":"iana","extensions":["x_t"]},"model/vnd.rosette.annotated-data-model":{"source":"iana"},"model/vnd.usdz+zip":{"source":"iana","compressible":false,"extensions":["usdz"]},"model/vnd.valve.source.compiled-map":{"source":"iana","extensions":["bsp"]},"model/vnd.vtu":{"source":"iana","extensions":["vtu"]},"model/vrml":{"source":"iana","compressible":false,"extensions":["wrl","vrml"]},"model/x3d+binary":{"source":"apache","compressible":false,"extensions":["x3db","x3dbz"]},"model/x3d+fastinfoset":{"source":"iana","extensions":["x3db"]},"model/x3d+vrml":{"source":"apache","compressible":false,"extensions":["x3dv","x3dvz"]},"model/x3d+xml":{"source":"iana","compressible":true,"extensions":["x3d","x3dz"]},"model/x3d-vrml":{"source":"iana","extensions":["x3dv"]},"multipart/alternative":{"source":"iana","compressible":false},"multipart/appledouble":{"source":"iana"},"multipart/byteranges":{"source":"iana"},"multipart/digest":{"source":"iana"},"multipart/encrypted":{"source":"iana","compressible":false},"multipart/form-data":{"source":"iana","compressible":false},"multipart/header-set":{"source":"iana"},"multipart/mixed":{"source":"iana"},"multipart/multilingual":{"source":"iana"},"multipart/parallel":{"source":"iana"},"multipart/related":{"source":"iana","compressible":false},"multipart/report":{"source":"iana"},"multipart/signed":{"source":"iana","compressible":false},"multipart/vnd.bint.med-plus":{"source":"iana"},"multipart/voice-message":{"source":"iana"},"multipart/x-mixed-replace":{"source":"iana"},"text/1d-interleaved-parityfec":{"source":"iana"},"text/cache-manifest":{"source":"iana","compressible":true,"extensions":["appcache","manifest"]},"text/calendar":{"source":"iana","extensions":["ics","ifb"]},"text/calender":{"compressible":true},"text/cmd":{"compressible":true},"text/coffeescript":{"extensions":["coffee","litcoffee"]},"text/cql":{"source":"iana"},"text/cql-expression":{"source":"iana"},"text/cql-identifier":{"source":"iana"},"text/css":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["css"]},"text/csv":{"source":"iana","compressible":true,"extensions":["csv"]},"text/csv-schema":{"source":"iana"},"text/directory":{"source":"iana"},"text/dns":{"source":"iana"},"text/ecmascript":{"source":"iana"},"text/encaprtp":{"source":"iana"},"text/enriched":{"source":"iana"},"text/fhirpath":{"source":"iana"},"text/flexfec":{"source":"iana"},"text/fwdred":{"source":"iana"},"text/gff3":{"source":"iana"},"text/grammar-ref-list":{"source":"iana"},"text/html":{"source":"iana","compressible":true,"extensions":["html","htm","shtml"]},"text/jade":{"extensions":["jade"]},"text/javascript":{"source":"iana","compressible":true},"text/jcr-cnd":{"source":"iana"},"text/jsx":{"compressible":true,"extensions":["jsx"]},"text/less":{"compressible":true,"extensions":["less"]},"text/markdown":{"source":"iana","compressible":true,"extensions":["markdown","md"]},"text/mathml":{"source":"nginx","extensions":["mml"]},"text/mdx":{"compressible":true,"extensions":["mdx"]},"text/mizar":{"source":"iana"},"text/n3":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["n3"]},"text/parameters":{"source":"iana","charset":"UTF-8"},"text/parityfec":{"source":"iana"},"text/plain":{"source":"iana","compressible":true,"extensions":["txt","text","conf","def","list","log","in","ini"]},"text/provenance-notation":{"source":"iana","charset":"UTF-8"},"text/prs.fallenstein.rst":{"source":"iana"},"text/prs.lines.tag":{"source":"iana","extensions":["dsc"]},"text/prs.prop.logic":{"source":"iana"},"text/raptorfec":{"source":"iana"},"text/red":{"source":"iana"},"text/rfc822-headers":{"source":"iana"},"text/richtext":{"source":"iana","compressible":true,"extensions":["rtx"]},"text/rtf":{"source":"iana","compressible":true,"extensions":["rtf"]},"text/rtp-enc-aescm128":{"source":"iana"},"text/rtploopback":{"source":"iana"},"text/rtx":{"source":"iana"},"text/sgml":{"source":"iana","extensions":["sgml","sgm"]},"text/shaclc":{"source":"iana"},"text/shex":{"extensions":["shex"]},"text/slim":{"extensions":["slim","slm"]},"text/spdx":{"source":"iana","extensions":["spdx"]},"text/strings":{"source":"iana"},"text/stylus":{"extensions":["stylus","styl"]},"text/t140":{"source":"iana"},"text/tab-separated-values":{"source":"iana","compressible":true,"extensions":["tsv"]},"text/troff":{"source":"iana","extensions":["t","tr","roff","man","me","ms"]},"text/turtle":{"source":"iana","charset":"UTF-8","extensions":["ttl"]},"text/ulpfec":{"source":"iana"},"text/uri-list":{"source":"iana","compressible":true,"extensions":["uri","uris","urls"]},"text/vcard":{"source":"iana","compressible":true,"extensions":["vcard"]},"text/vnd.a":{"source":"iana"},"text/vnd.abc":{"source":"iana"},"text/vnd.ascii-art":{"source":"iana"},"text/vnd.curl":{"source":"iana","extensions":["curl"]},"text/vnd.curl.dcurl":{"source":"apache","extensions":["dcurl"]},"text/vnd.curl.mcurl":{"source":"apache","extensions":["mcurl"]},"text/vnd.curl.scurl":{"source":"apache","extensions":["scurl"]},"text/vnd.debian.copyright":{"source":"iana","charset":"UTF-8"},"text/vnd.dmclientscript":{"source":"iana"},"text/vnd.dvb.subtitle":{"source":"iana","extensions":["sub"]},"text/vnd.esmertec.theme-descriptor":{"source":"iana","charset":"UTF-8"},"text/vnd.ficlab.flt":{"source":"iana"},"text/vnd.fly":{"source":"iana","extensions":["fly"]},"text/vnd.fmi.flexstor":{"source":"iana","extensions":["flx"]},"text/vnd.gml":{"source":"iana"},"text/vnd.graphviz":{"source":"iana","extensions":["gv"]},"text/vnd.hans":{"source":"iana"},"text/vnd.hgl":{"source":"iana"},"text/vnd.in3d.3dml":{"source":"iana","extensions":["3dml"]},"text/vnd.in3d.spot":{"source":"iana","extensions":["spot"]},"text/vnd.iptc.newsml":{"source":"iana"},"text/vnd.iptc.nitf":{"source":"iana"},"text/vnd.latex-z":{"source":"iana"},"text/vnd.motorola.reflex":{"source":"iana"},"text/vnd.ms-mediapackage":{"source":"iana"},"text/vnd.net2phone.commcenter.command":{"source":"iana"},"text/vnd.radisys.msml-basic-layout":{"source":"iana"},"text/vnd.senx.warpscript":{"source":"iana"},"text/vnd.si.uricatalogue":{"source":"iana"},"text/vnd.sosi":{"source":"iana"},"text/vnd.sun.j2me.app-descriptor":{"source":"iana","charset":"UTF-8","extensions":["jad"]},"text/vnd.trolltech.linguist":{"source":"iana","charset":"UTF-8"},"text/vnd.wap.si":{"source":"iana"},"text/vnd.wap.sl":{"source":"iana"},"text/vnd.wap.wml":{"source":"iana","extensions":["wml"]},"text/vnd.wap.wmlscript":{"source":"iana","extensions":["wmls"]},"text/vtt":{"source":"iana","charset":"UTF-8","compressible":true,"extensions":["vtt"]},"text/x-asm":{"source":"apache","extensions":["s","asm"]},"text/x-c":{"source":"apache","extensions":["c","cc","cxx","cpp","h","hh","dic"]},"text/x-component":{"source":"nginx","extensions":["htc"]},"text/x-fortran":{"source":"apache","extensions":["f","for","f77","f90"]},"text/x-gwt-rpc":{"compressible":true},"text/x-handlebars-template":{"extensions":["hbs"]},"text/x-java-source":{"source":"apache","extensions":["java"]},"text/x-jquery-tmpl":{"compressible":true},"text/x-lua":{"extensions":["lua"]},"text/x-markdown":{"compressible":true,"extensions":["mkd"]},"text/x-nfo":{"source":"apache","extensions":["nfo"]},"text/x-opml":{"source":"apache","extensions":["opml"]},"text/x-org":{"compressible":true,"extensions":["org"]},"text/x-pascal":{"source":"apache","extensions":["p","pas"]},"text/x-processing":{"compressible":true,"extensions":["pde"]},"text/x-sass":{"extensions":["sass"]},"text/x-scss":{"extensions":["scss"]},"text/x-setext":{"source":"apache","extensions":["etx"]},"text/x-sfv":{"source":"apache","extensions":["sfv"]},"text/x-suse-ymp":{"compressible":true,"extensions":["ymp"]},"text/x-uuencode":{"source":"apache","extensions":["uu"]},"text/x-vcalendar":{"source":"apache","extensions":["vcs"]},"text/x-vcard":{"source":"apache","extensions":["vcf"]},"text/xml":{"source":"iana","compressible":true,"extensions":["xml"]},"text/xml-external-parsed-entity":{"source":"iana"},"text/yaml":{"extensions":["yaml","yml"]},"video/1d-interleaved-parityfec":{"source":"iana"},"video/3gpp":{"source":"iana","extensions":["3gp","3gpp"]},"video/3gpp-tt":{"source":"iana"},"video/3gpp2":{"source":"iana","extensions":["3g2"]},"video/av1":{"source":"iana"},"video/bmpeg":{"source":"iana"},"video/bt656":{"source":"iana"},"video/celb":{"source":"iana"},"video/dv":{"source":"iana"},"video/encaprtp":{"source":"iana"},"video/flexfec":{"source":"iana"},"video/h261":{"source":"iana","extensions":["h261"]},"video/h263":{"source":"iana","extensions":["h263"]},"video/h263-1998":{"source":"iana"},"video/h263-2000":{"source":"iana"},"video/h264":{"source":"iana","extensions":["h264"]},"video/h264-rcdo":{"source":"iana"},"video/h264-svc":{"source":"iana"},"video/h265":{"source":"iana"},"video/iso.segment":{"source":"iana","extensions":["m4s"]},"video/jpeg":{"source":"iana","extensions":["jpgv"]},"video/jpeg2000":{"source":"iana"},"video/jpm":{"source":"apache","extensions":["jpm","jpgm"]},"video/mj2":{"source":"iana","extensions":["mj2","mjp2"]},"video/mp1s":{"source":"iana"},"video/mp2p":{"source":"iana"},"video/mp2t":{"source":"iana","extensions":["ts"]},"video/mp4":{"source":"iana","compressible":false,"extensions":["mp4","mp4v","mpg4"]},"video/mp4v-es":{"source":"iana"},"video/mpeg":{"source":"iana","compressible":false,"extensions":["mpeg","mpg","mpe","m1v","m2v"]},"video/mpeg4-generic":{"source":"iana"},"video/mpv":{"source":"iana"},"video/nv":{"source":"iana"},"video/ogg":{"source":"iana","compressible":false,"extensions":["ogv"]},"video/parityfec":{"source":"iana"},"video/pointer":{"source":"iana"},"video/quicktime":{"source":"iana","compressible":false,"extensions":["qt","mov"]},"video/raptorfec":{"source":"iana"},"video/raw":{"source":"iana"},"video/rtp-enc-aescm128":{"source":"iana"},"video/rtploopback":{"source":"iana"},"video/rtx":{"source":"iana"},"video/scip":{"source":"iana"},"video/smpte291":{"source":"iana"},"video/smpte292m":{"source":"iana"},"video/ulpfec":{"source":"iana"},"video/vc1":{"source":"iana"},"video/vc2":{"source":"iana"},"video/vnd.cctv":{"source":"iana"},"video/vnd.dece.hd":{"source":"iana","extensions":["uvh","uvvh"]},"video/vnd.dece.mobile":{"source":"iana","extensions":["uvm","uvvm"]},"video/vnd.dece.mp4":{"source":"iana"},"video/vnd.dece.pd":{"source":"iana","extensions":["uvp","uvvp"]},"video/vnd.dece.sd":{"source":"iana","extensions":["uvs","uvvs"]},"video/vnd.dece.video":{"source":"iana","extensions":["uvv","uvvv"]},"video/vnd.directv.mpeg":{"source":"iana"},"video/vnd.directv.mpeg-tts":{"source":"iana"},"video/vnd.dlna.mpeg-tts":{"source":"iana"},"video/vnd.dvb.file":{"source":"iana","extensions":["dvb"]},"video/vnd.fvt":{"source":"iana","extensions":["fvt"]},"video/vnd.hns.video":{"source":"iana"},"video/vnd.iptvforum.1dparityfec-1010":{"source":"iana"},"video/vnd.iptvforum.1dparityfec-2005":{"source":"iana"},"video/vnd.iptvforum.2dparityfec-1010":{"source":"iana"},"video/vnd.iptvforum.2dparityfec-2005":{"source":"iana"},"video/vnd.iptvforum.ttsavc":{"source":"iana"},"video/vnd.iptvforum.ttsmpeg2":{"source":"iana"},"video/vnd.motorola.video":{"source":"iana"},"video/vnd.motorola.videop":{"source":"iana"},"video/vnd.mpegurl":{"source":"iana","extensions":["mxu","m4u"]},"video/vnd.ms-playready.media.pyv":{"source":"iana","extensions":["pyv"]},"video/vnd.nokia.interleaved-multimedia":{"source":"iana"},"video/vnd.nokia.mp4vr":{"source":"iana"},"video/vnd.nokia.videovoip":{"source":"iana"},"video/vnd.objectvideo":{"source":"iana"},"video/vnd.radgamettools.bink":{"source":"iana"},"video/vnd.radgamettools.smacker":{"source":"iana"},"video/vnd.sealed.mpeg1":{"source":"iana"},"video/vnd.sealed.mpeg4":{"source":"iana"},"video/vnd.sealed.swf":{"source":"iana"},"video/vnd.sealedmedia.softseal.mov":{"source":"iana"},"video/vnd.uvvu.mp4":{"source":"iana","extensions":["uvu","uvvu"]},"video/vnd.vivo":{"source":"iana","extensions":["viv"]},"video/vnd.youtube.yt":{"source":"iana"},"video/vp8":{"source":"iana"},"video/webm":{"source":"apache","compressible":false,"extensions":["webm"]},"video/x-f4v":{"source":"apache","extensions":["f4v"]},"video/x-fli":{"source":"apache","extensions":["fli"]},"video/x-flv":{"source":"apache","compressible":false,"extensions":["flv"]},"video/x-m4v":{"source":"apache","extensions":["m4v"]},"video/x-matroska":{"source":"apache","compressible":false,"extensions":["mkv","mk3d","mks"]},"video/x-mng":{"source":"apache","extensions":["mng"]},"video/x-ms-asf":{"source":"apache","extensions":["asf","asx"]},"video/x-ms-vob":{"source":"apache","extensions":["vob"]},"video/x-ms-wm":{"source":"apache","extensions":["wm"]},"video/x-ms-wmv":{"source":"apache","compressible":false,"extensions":["wmv"]},"video/x-ms-wmx":{"source":"apache","extensions":["wmx"]},"video/x-ms-wvx":{"source":"apache","extensions":["wvx"]},"video/x-msvideo":{"source":"apache","extensions":["avi"]},"video/x-sgi-movie":{"source":"apache","extensions":["movie"]},"video/x-smv":{"source":"apache","extensions":["smv"]},"x-conference/x-cooltalk":{"source":"apache","extensions":["ice"]},"x-shader/x-fragment":{"compressible":true},"x-shader/x-vertex":{"compressible":true}}')},function(e,t,n){var r=n(257),o=n(176),i=/\\\\n/g,s=/(\\)?\\n/g,a=n(12);function JSONP(e){r.call(this,e),this.head="___eio["+(e._query.j||"").replace(/[^0-9]/g,"")+"](",this.foot=");"}e.exports=JSONP,a.inherits(JSONP,r),JSONP.prototype.onData=function(e){"string"==typeof(e=o.parse(e).d)&&(e=e.replace(s,(function(e,t){return t?e:"\n"})),r.prototype.onData.call(this,e.replace(i,"\\n")))},JSONP.prototype.doWrite=function(e,t,n){var o=JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029");e=this.head+o+this.foot,r.prototype.doWrite.call(this,e,t,n)}},function(e,t,n){var r=n(177),o=n(122),i=n(12),s=n(93)("engine:ws");function WebSocket(e){r.call(this,e);var t=this;this.socket=e.websocket,this.socket.on("message",this.onData.bind(this)),this.socket.once("close",this.onClose.bind(this)),this.socket.on("error",this.onError.bind(this)),this.socket.on("headers",(function onHeaders(e){t.emit("headers",e)})),this.writable=!0,this.perMessageDeflate=null}e.exports=WebSocket,i.inherits(WebSocket,r),WebSocket.prototype.name="websocket",WebSocket.prototype.handlesUpgrades=!0,WebSocket.prototype.supportsFraming=!0,WebSocket.prototype.onData=function(e){s('received "%s"',e),r.prototype.onData.call(this,e)},WebSocket.prototype.send=function(e){for(var t=this,n=0;n<e.length;n++){var r=e[n];o.encodePacket(r,t.supportsBinary,send)}function send(e){s('writing "%s"',e);var n={};(r.options&&(n.compress=r.options.compress),t.perMessageDeflate)&&(("string"==typeof e?Buffer.byteLength(e):e.length)<t.perMessageDeflate.threshold&&(n.compress=!1));t.writable=!1,t.socket.send(e,n,onEnd)}function onEnd(e){if(e)return t.onError("write error",e.stack);t.writable=!0,t.emit("drain")}},WebSocket.prototype.doClose=function(e){s("closing"),this.socket.close(),e&&e()}},function(e,t,n){"use strict";t.parse=function parse(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");for(var n={},o=t||{},s=e.split(i),a=o.decode||r,c=0;c<s.length;c++){var u=s[c],l=u.indexOf("=");if(!(l<0)){var d=u.substr(0,l).trim(),p=u.substr(++l,u.length).trim();'"'==p[0]&&(p=p.slice(1,-1)),null==n[d]&&(n[d]=tryDecode(p,a))}}return n},t.serialize=function serialize(e,t,n){var r=n||{},i=r.encode||o;if("function"!=typeof i)throw new TypeError("option encode is invalid");if(!s.test(e))throw new TypeError("argument name is invalid");var a=i(t);if(a&&!s.test(a))throw new TypeError("argument val is invalid");var c=e+"="+a;if(null!=r.maxAge){var u=r.maxAge-0;if(isNaN(u))throw new Error("maxAge should be a Number");c+="; Max-Age="+Math.floor(u)}if(r.domain){if(!s.test(r.domain))throw new TypeError("option domain is invalid");c+="; Domain="+r.domain}if(r.path){if(!s.test(r.path))throw new TypeError("option path is invalid");c+="; Path="+r.path}if(r.expires){if("function"!=typeof r.expires.toUTCString)throw new TypeError("option expires is invalid");c+="; Expires="+r.expires.toUTCString()}r.httpOnly&&(c+="; HttpOnly");r.secure&&(c+="; Secure");if(r.sameSite){switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:c+="; SameSite=Strict";break;case"lax":c+="; SameSite=Lax";break;case"strict":c+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}}return c};var r=decodeURIComponent,o=encodeURIComponent,i=/; */,s=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function tryDecode(e,t){try{return t(e)}catch(t){return e}}},function(e,t,n){"use strict";const r=n(260);r.Server=n(582),r.Receiver=n(264),r.Sender=n(266),e.exports=r},function(e,t){e.exports=require("buffer")},function(e,t,n){"use strict";class Event{constructor(e,t){this.target=t,this.type=e}}class MessageEvent extends Event{constructor(e,t){super("message",t),this.data=e}}class CloseEvent extends Event{constructor(e,t,n){super("close",n),this.wasClean=n._closeFrameReceived&&n._closeFrameSent,this.reason=t,this.code=e}}class OpenEvent extends Event{constructor(e){super("open",e)}}const r={addEventListener(e,t){function onMessage(e){t.call(this,new MessageEvent(e,this))}function onClose(e,n){t.call(this,new CloseEvent(e,n,this))}function onError(e){e.type="error",e.target=this,t.call(this,e)}function onOpen(){t.call(this,new OpenEvent(this))}"function"==typeof t&&("message"===e?(onMessage._listener=t,this.on(e,onMessage)):"close"===e?(onClose._listener=t,this.on(e,onClose)):"error"===e?(onError._listener=t,this.on(e,onError)):"open"===e?(onOpen._listener=t,this.on(e,onOpen)):this.on(e,t))},removeEventListener(e,t){const n=this.listeners(e);for(var r=0;r<n.length;r++)n[r]!==t&&n[r]._listener!==t||this.removeListener(e,n[r])}};e.exports=r},function(e,t,n){"use strict";try{const t=n(!function webpackMissingModule(){var e=new Error("Cannot find module 'utf-8-validate'");throw e.code="MODULE_NOT_FOUND",e}());e.exports="object"==typeof t?t.Validation.isValidUTF8:t}catch(t){e.exports=()=>!0}},function(e,t,n){"use strict";const r=n(73),o=n(29),i=n(16),s=n(261),a=n(37),c=n(51),u=n(126),l=n(263),d=n(127),p=n(260),h=r.Buffer;function socketError(){this.destroy()}function abortConnection(e,t,n){e.writable&&(n=n||a.STATUS_CODES[t],e.write(`HTTP/1.1 ${t} ${a.STATUS_CODES[t]}\r\nConnection: close\r\nContent-type: text/html\r\nContent-Length: ${h.byteLength(n)}\r\n\r\n`+n)),e.removeListener("error",socketError),e.destroy()}e.exports=class WebSocketServer extends o{constructor(e,t){if(super(),null==(e=Object.assign({maxPayload:104857600,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null},e)).port&&!e.server&&!e.noServer)throw new TypeError("missing or invalid options");null!=e.port?(this._server=a.createServer((e,t)=>{const n=a.STATUS_CODES[426];t.writeHead(426,{"Content-Length":n.length,"Content-Type":"text/plain"}),t.end(n)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server&&(this._ultron=new s(this._server),this._ultron.on("listening",()=>this.emit("listening")),this._ultron.on("error",e=>this.emit("error",e)),this._ultron.on("upgrade",(e,t,n)=>{this.handleUpgrade(e,t,n,t=>{this.emit("connection",t,e)})})),!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set),this.options=e}close(e){if(this.clients)for(const e of this.clients)e.terminate();const t=this._server;if(t&&(this._ultron.destroy(),this._ultron=this._server=null,null!=this.options.port))return t.close(e);e&&e()}shouldHandle(e){return!this.options.path||c.parse(e.url).pathname===this.options.path}handleUpgrade(e,t,n,r){t.on("error",socketError);const o=+e.headers["sec-websocket-version"],i={};if("GET"!==e.method||"websocket"!==e.headers.upgrade.toLowerCase()||!e.headers["sec-websocket-key"]||8!==o&&13!==o||!this.shouldHandle(e))return abortConnection(t,400);if(this.options.perMessageDeflate){const n=new u(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const t=l.parse(e.headers["sec-websocket-extensions"]);t[u.extensionName]&&(n.accept(t[u.extensionName]),i[u.extensionName]=n)}catch(e){return abortConnection(t,400)}}var s=(e.headers["sec-websocket-protocol"]||"").split(/, */);if(this.options.handleProtocols){if(!1===(s=this.options.handleProtocols(s,e)))return abortConnection(t,401)}else s=s[0];if(this.options.verifyClient){const a={origin:e.headers[""+(8===o?"sec-websocket-origin":"origin")],secure:!(!e.connection.authorized&&!e.connection.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(a,(a,c,u)=>{if(!a)return abortConnection(t,c||401,u);this.completeUpgrade(s,i,o,e,t,n,r)});if(!this.options.verifyClient(a))return abortConnection(t,401)}this.completeUpgrade(s,i,o,e,t,n,r)}completeUpgrade(e,t,n,r,o,s,a){if(!o.readable||!o.writable)return o.destroy();const c=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade","Sec-WebSocket-Accept: "+i.createHash("sha1").update(r.headers["sec-websocket-key"]+d.GUID,"binary").digest("base64")];if(e&&c.push("Sec-WebSocket-Protocol: "+e),t[u.extensionName]){const e=t[u.extensionName].params,n=l.format({[u.extensionName]:[e]});c.push("Sec-WebSocket-Extensions: "+n)}this.emit("headers",c,r),o.write(c.concat("\r\n").join("\r\n"));const h=new p([o,s],null,{maxPayload:this.options.maxPayload,protocolVersion:n,extensions:t,protocol:e});this.clients&&(this.clients.add(h),h.on("close",()=>this.clients.delete(h))),o.removeListener("error",socketError),a(h)}}},function(e){e.exports=JSON.parse('{"_from":"socket.io-client@2.1.1","_id":"socket.io-client@2.1.1","_inBundle":false,"_integrity":"sha1-3LOBA0NqtFeN2wJmOK4vIbYjZx8=","_location":"/socket.io-client","_phantomChildren":{},"_requested":{"type":"version","registry":true,"raw":"socket.io-client@2.1.1","name":"socket.io-client","escapedName":"socket.io-client","rawSpec":"2.1.1","saveSpec":null,"fetchSpec":"2.1.1"},"_requiredBy":["/","/@adsk/forge-hfdm","/@rush-temp/fremont-js-lib","/socket.io"],"_resolved":"https://art-bobcat.autodesk.com:443/artifactory/api/npm/autodesk-npm-virtual/socket.io-client/-/socket.io-client-2.1.1.tgz","_shasum":"dcb38103436ab4578ddb026638ae2f21b623671f","_spec":"socket.io-client@2.1.1","_where":"/mnt/data/jenkins/workspace/ono_release_fremont-js-lib_21-03/common/temp","bugs":{"url":"https://github.com/Automattic/socket.io-client/issues"},"bundleDependencies":false,"contributors":[{"name":"Guillermo Rauch","email":"rauchg@gmail.com"},{"name":"Arnout Kazemier","email":"info@3rd-eden.com"},{"name":"Vladimir Dronnikov","email":"dronnikov@gmail.com"},{"name":"Einar Otto Stangvik","email":"einaros@gmail.com"}],"dependencies":{"backo2":"1.0.2","base64-arraybuffer":"0.1.5","component-bind":"1.0.0","component-emitter":"1.2.1","debug":"~3.1.0","engine.io-client":"~3.2.0","has-binary2":"~1.0.2","has-cors":"1.1.0","indexof":"0.0.1","object-component":"0.0.3","parseqs":"0.0.5","parseuri":"0.0.5","socket.io-parser":"~3.2.0","to-array":"0.1.4"},"deprecated":false,"description":"[![Build Status](https://secure.travis-ci.org/socketio/socket.io-client.svg?branch=master)](http://travis-ci.org/socketio/socket.io-client) [![Dependency Status](https://david-dm.org/socketio/socket.io-client.svg)](https://david-dm.org/socketio/socket.io-client) [![devDependency Status](https://david-dm.org/socketio/socket.io-client/dev-status.svg)](https://david-dm.org/socketio/socket.io-client#info=devDependencies) [![NPM version](https://badge.fury.io/js/socket.io-client.svg)](https://www.npmjs.com/package/socket.io-client) ![Downloads](http://img.shields.io/npm/dm/socket.io-client.svg?style=flat) [![](http://slack.socket.io/badge.svg?)](http://slack.socket.io)","devDependencies":{"babel-core":"^6.24.1","babel-eslint":"4.1.7","babel-loader":"7.0.0","babel-preset-es2015":"6.24.1","concat-stream":"^1.6.0","derequire":"^2.0.6","eslint-config-standard":"4.4.0","eslint-plugin-standard":"1.3.1","expect.js":"0.3.1","gulp":"^3.9.1","gulp-eslint":"1.1.1","gulp-file":"^0.3.0","gulp-istanbul":"^1.1.1","gulp-mocha":"^4.3.1","gulp-task-listing":"1.0.1","imports-loader":"^0.7.1","istanbul":"^0.4.5","mocha":"^3.3.0","socket.io":"2.1.1","socket.io-browsers":"^1.0.0","strip-loader":"0.1.2","text-blob-builder":"0.0.1","webpack-merge":"4.1.2","webpack-stream":"3.2.0","zuul":"^3.11.1  ","zuul-builder-webpack":"^1.2.0","zuul-ngrok":"4.0.0"},"files":["lib/","dist/"],"homepage":"https://github.com/Automattic/socket.io-client#readme","keywords":["realtime","framework","websocket","tcp","events","client"],"license":"MIT","main":"./lib/index","name":"socket.io-client","repository":{"type":"git","url":"git+https://github.com/Automattic/socket.io-client.git"},"scripts":{"test":"gulp test"},"version":"2.1.1"}')},function(e,t,n){var r=n(128),o=n(129)("socket.io:client"),i=n(51);function Client(e,t){this.server=e,this.conn=t,this.encoder=e.encoder,this.decoder=new e.parser.Decoder,this.id=t.id,this.request=t.request,this.setup(),this.sockets={},this.nsps={},this.connectBuffer=[]}e.exports=Client,Client.prototype.setup=function(){this.onclose=this.onclose.bind(this),this.ondata=this.ondata.bind(this),this.onerror=this.onerror.bind(this),this.ondecoded=this.ondecoded.bind(this),this.decoder.on("decoded",this.ondecoded),this.conn.on("data",this.ondata),this.conn.on("error",this.onerror),this.conn.on("close",this.onclose)},Client.prototype.connect=function(e,t){if(this.server.nsps[e])return o("connecting to namespace %s",e),this.doConnect(e,t);this.server.checkNamespace(e,t,n=>{n?(o("dynamic namespace %s was created",n.name),this.doConnect(e,t)):(o("creation of namespace %s was denied",e),this.packet({type:r.ERROR,nsp:e,data:"Invalid namespace"}))})},Client.prototype.doConnect=function(e,t){var n=this.server.of(e);if("/"==e||this.nsps["/"])var r=this,o=n.add(this,t,(function(){r.sockets[o.id]=o,r.nsps[n.name]=o,"/"==n.name&&r.connectBuffer.length>0&&(r.connectBuffer.forEach(r.connect,r),r.connectBuffer=[])}));else this.connectBuffer.push(e)},Client.prototype.disconnect=function(){for(var e in this.sockets)this.sockets.hasOwnProperty(e)&&this.sockets[e].disconnect();this.sockets={},this.close()},Client.prototype.remove=function(e){if(this.sockets.hasOwnProperty(e.id)){var t=this.sockets[e.id].nsp.name;delete this.sockets[e.id],delete this.nsps[t]}else o("ignoring remove for %s",e.id)},Client.prototype.close=function(){"open"==this.conn.readyState&&(o("forcing transport close"),this.conn.close(),this.onclose("forced server close"))},Client.prototype.packet=function(e,t){t=t||{};var n=this;function writeToEngine(e){if(!t.volatile||n.conn.transport.writable)for(var r=0;r<e.length;r++)n.conn.write(e[r],{compress:t.compress})}"open"==this.conn.readyState?(o("writing packet %j",e),t.preEncoded?writeToEngine(e):this.encoder.encode(e,writeToEngine)):o("ignoring packet write %j",e)},Client.prototype.ondata=function(e){try{this.decoder.add(e)}catch(e){this.onerror(e)}},Client.prototype.ondecoded=function(e){if(r.CONNECT==e.type)this.connect(i.parse(e.nsp).pathname,i.parse(e.nsp,!0).query);else{var t=this.nsps[e.nsp];t?process.nextTick((function(){t.onpacket(e)})):o("no socket for namespace %s",e.nsp)}},Client.prototype.onerror=function(e){for(var t in this.sockets)this.sockets.hasOwnProperty(t)&&this.sockets[t].onerror(e);this.conn.close()},Client.prototype.onclose=function(e){for(var t in o("client close with reason %s",e),this.destroy(),this.sockets)this.sockets.hasOwnProperty(t)&&this.sockets[t].onclose(e);this.sockets={},this.decoder.destroy()},Client.prototype.destroy=function(){this.conn.removeListener("data",this.ondata),this.conn.removeListener("error",this.onerror),this.conn.removeListener("close",this.onclose),this.decoder.removeListener("decoded",this.ondecoded)}},function(e,t,n){"undefined"==typeof process||"renderer"===process.type?e.exports=n(586):e.exports=n(588)},function(e,t,n){function load(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=n(267)).log=function log(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function formatArgs(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,r)},t.save=function save(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=load,t.useColors=function useColors(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function localstorage(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(load())},function(e,t){var n=1e3,r=6e4,o=60*r,i=24*o;function plural(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var s=typeof e;if("string"===s&&e.length>0)return function parse(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*o;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===s&&!1===isNaN(e))return t.long?function fmtLong(e){return plural(e,i,"day")||plural(e,o,"hour")||plural(e,r,"minute")||plural(e,n,"second")||e+" ms"}(e):function fmtShort(e){if(e>=i)return Math.round(e/i)+"d";if(e>=o)return Math.round(e/o)+"h";if(e>=r)return Math.round(e/r)+"m";if(e>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){var r=n(123),o=n(12);(t=e.exports=n(267)).init=function init(e){e.inspectOpts={};for(var n=Object.keys(t.inspectOpts),r=0;r<n.length;r++)e.inspectOpts[n[r]]=t.inspectOpts[n[r]]},t.log=function log(){return process.stderr.write(o.format.apply(o,arguments)+"\n")},t.formatArgs=function formatArgs(e){var n=this.namespace;if(this.useColors){var r=this.color,o="[3"+(r<8?r:"8;5;"+r),i="  "+o+";1m"+n+" [0m";e[0]=i+e[0].split("\n").join("\n"+i),e.push(o+"m+"+t.humanize(this.diff)+"[0m")}else e[0]=function getDate(){return t.inspectOpts.hideDate?"":(new Date).toISOString()+" "}()+n+" "+e[0]},t.save=function save(e){null==e?delete process.env.DEBUG:process.env.DEBUG=e},t.load=load,t.useColors=function useColors(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):r.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{var i=n(124);i&&i.level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}function load(){return process.env.DEBUG}t.inspectOpts=Object.keys(process.env).filter((function(e){return/^debug_/i.test(e)})).reduce((function(e,t){var n=t.substring(6).toLowerCase().replace(/_([a-z])/g,(function(e,t){return t.toUpperCase()})),r=process.env[t];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),e[n]=r,e}),{}),t.formatters.o=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts).split("\n").map((function(e){return e.trim()})).join(" ")},t.formatters.O=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts)},t.enable(load())},function(e,t,n){function Emitter(e){if(e)return function mixin(e){for(var t in Emitter.prototype)e[t]=Emitter.prototype[t];return e}(e)}e.exports=Emitter,Emitter.prototype.on=Emitter.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},Emitter.prototype.once=function(e,t){function on(){this.off(e,on),t.apply(this,arguments)}return on.fn=t,this.on(e,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return this},Emitter.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t);return this},Emitter.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},Emitter.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){var r=n(268),o=n(269),i=Object.prototype.toString,s="function"==typeof global.Blob||"[object BlobConstructor]"===i.call(global.Blob),a="function"==typeof global.File||"[object FileConstructor]"===i.call(global.File);t.deconstructPacket=function(e){var t=[],n=e.data,i=e;return i.data=function _deconstructPacket(e,t){if(!e)return e;if(o(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(r(e)){for(var i=new Array(e.length),s=0;s<e.length;s++)i[s]=_deconstructPacket(e[s],t);return i}if("object"==typeof e&&!(e instanceof Date)){i={};for(var a in e)i[a]=_deconstructPacket(e[a],t);return i}return e}(n,t),i.attachments=t.length,{packet:i,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function _reconstructPacket(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(r(e))for(var n=0;n<e.length;n++)e[n]=_reconstructPacket(e[n],t);else if("object"==typeof e)for(var o in e)e[o]=_reconstructPacket(e[o],t);return e}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,i=e;!function _removeBlobs(e,c,u){if(!e)return e;if(s&&e instanceof Blob||a&&e instanceof File){n++;var l=new FileReader;l.onload=function(){u?u[c]=this.result:i=this.result,--n||t(i)},l.readAsArrayBuffer(e)}else if(r(e))for(var d=0;d<e.length;d++)_removeBlobs(e[d],d,e);else if("object"==typeof e&&!o(e))for(var p in e)_removeBlobs(e[p],p,e)}(i),n||t(i)}},function(e,t,n){function load(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=n(270)).log=function log(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function formatArgs(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,r)},t.save=function save(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=load,t.useColors=function useColors(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function localstorage(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(load())},function(e,t){var n=1e3,r=6e4,o=60*r,i=24*o;function plural(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var s=typeof e;if("string"===s&&e.length>0)return function parse(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*o;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===s&&!1===isNaN(e))return t.long?function fmtLong(e){return plural(e,i,"day")||plural(e,o,"hour")||plural(e,r,"minute")||plural(e,n,"second")||e+" ms"}(e):function fmtShort(e){if(e>=i)return Math.round(e/i)+"d";if(e>=o)return Math.round(e/o)+"h";if(e>=r)return Math.round(e/r)+"m";if(e>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){var r=n(123),o=n(12);(t=e.exports=n(270)).init=function init(e){e.inspectOpts={};for(var n=Object.keys(t.inspectOpts),r=0;r<n.length;r++)e.inspectOpts[n[r]]=t.inspectOpts[n[r]]},t.log=function log(){return process.stderr.write(o.format.apply(o,arguments)+"\n")},t.formatArgs=function formatArgs(e){var n=this.namespace;if(this.useColors){var r=this.color,o="[3"+(r<8?r:"8;5;"+r),i="  "+o+";1m"+n+" [0m";e[0]=i+e[0].split("\n").join("\n"+i),e.push(o+"m+"+t.humanize(this.diff)+"[0m")}else e[0]=function getDate(){return t.inspectOpts.hideDate?"":(new Date).toISOString()+" "}()+n+" "+e[0]},t.save=function save(e){null==e?delete process.env.DEBUG:process.env.DEBUG=e},t.load=load,t.useColors=function useColors(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):r.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{var i=n(124);i&&i.level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}function load(){return process.env.DEBUG}t.inspectOpts=Object.keys(process.env).filter((function(e){return/^debug_/i.test(e)})).reduce((function(e,t){var n=t.substring(6).toLowerCase().replace(/_([a-z])/g,(function(e,t){return t.toUpperCase()})),r=process.env[t];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),e[n]=r,e}),{}),t.formatters.o=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts).split("\n").map((function(e){return e.trim()})).join(" ")},t.formatters.O=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts)},t.enable(load())},function(e,t,n){var r=n(29).EventEmitter,o=n(128),i=n(178),s=n(51),a=n(129)("socket.io:socket");e.exports=t=Socket,t.events=["error","connect","disconnect","disconnecting","newListener","removeListener"];var c=r.prototype.emit;function Socket(e,t,n){this.nsp=e,this.server=e.server,this.adapter=this.nsp.adapter,this.id="/"!==e.name?e.name+"#"+t.id:t.id,this.client=t,this.conn=t.conn,this.rooms={},this.acks={},this.connected=!0,this.disconnected=!1,this.handshake=this.buildHandshake(n),this.fns=[],this.flags={},this._rooms=[]}Socket.prototype.__proto__=r.prototype,["json","volatile","broadcast","local"].forEach((function(e){Object.defineProperty(Socket.prototype,e,{get:function(){return this.flags[e]=!0,this}})})),Object.defineProperty(Socket.prototype,"request",{get:function(){return this.conn.request}}),Socket.prototype.buildHandshake=function(e){var t=this;return{headers:this.request.headers,time:new Date+"",address:this.conn.remoteAddress,xdomain:!!this.request.headers.origin,secure:!!this.request.connection.encrypted,issued:+new Date,url:this.request.url,query:function buildQuery(){var n=s.parse(t.request.url,!0).query;return Object.assign({},e,n)}()}},Socket.prototype.emit=function(e){if(~t.events.indexOf(e))return c.apply(this,arguments),this;var n=Array.prototype.slice.call(arguments),r={type:(void 0!==this.flags.binary?this.flags.binary:i(n))?o.BINARY_EVENT:o.EVENT,data:n};if("function"==typeof n[n.length-1]){if(this._rooms.length||this.flags.broadcast)throw new Error("Callbacks are not supported when broadcasting");a("emitting packet with ack id %d",this.nsp.ids),this.acks[this.nsp.ids]=n.pop(),r.id=this.nsp.ids++}var s=this._rooms.slice(0),u=Object.assign({},this.flags);return this._rooms=[],this.flags={},s.length||u.broadcast?this.adapter.broadcast(r,{except:[this.id],rooms:s,flags:u}):this.packet(r,u),this},Socket.prototype.to=Socket.prototype.in=function(e){return~this._rooms.indexOf(e)||this._rooms.push(e),this},Socket.prototype.send=Socket.prototype.write=function(){var e=Array.prototype.slice.call(arguments);return e.unshift("message"),this.emit.apply(this,e),this},Socket.prototype.packet=function(e,t){e.nsp=this.nsp.name,(t=t||{}).compress=!1!==t.compress,this.client.packet(e,t)},Socket.prototype.join=function(e,t){a("joining room %s",e);var n=this;return Array.isArray(e)||(e=[e]),(e=e.filter((function(e){return!n.rooms.hasOwnProperty(e)}))).length?(this.adapter.addAll(this.id,e,(function(r){if(r)return t&&t(r);a("joined room %s",e),e.forEach((function(e){n.rooms[e]=e})),t&&t(null)})),this):(t&&t(null),this)},Socket.prototype.leave=function(e,t){a("leave room %s",e);var n=this;return this.adapter.del(this.id,e,(function(r){if(r)return t&&t(r);a("left room %s",e),delete n.rooms[e],t&&t(null)})),this},Socket.prototype.leaveAll=function(){this.adapter.delAll(this.id),this.rooms={}},Socket.prototype.onconnect=function(){a("socket connected - writing packet"),this.nsp.connected[this.id]=this,this.join(this.id),"/"===this.nsp.name&&0===this.nsp.fns.length?a("packet already sent in initial handshake"):this.packet({type:o.CONNECT})},Socket.prototype.onpacket=function(e){switch(a("got packet %j",e),e.type){case o.EVENT:case o.BINARY_EVENT:this.onevent(e);break;case o.ACK:case o.BINARY_ACK:this.onack(e);break;case o.DISCONNECT:this.ondisconnect();break;case o.ERROR:this.onerror(new Error(e.data))}},Socket.prototype.onevent=function(e){var t=e.data||[];a("emitting event %j",t),null!=e.id&&(a("attaching ack callback to event"),t.push(this.ack(e.id))),this.dispatch(t)},Socket.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){var r=Array.prototype.slice.call(arguments);a("sending ack %j",r),t.packet({id:e,type:i(r)?o.BINARY_ACK:o.ACK,data:r}),n=!0}}},Socket.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(a("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):a("bad ack %s",e.id)},Socket.prototype.ondisconnect=function(){a("got disconnect packet"),this.onclose("client namespace disconnect")},Socket.prototype.onerror=function(e){this.listeners("error").length?this.emit("error",e):(console.error("Missing error handler on `socket`."),console.error(e.stack))},Socket.prototype.onclose=function(e){if(!this.connected)return this;a("closing socket - reason %s",e),this.emit("disconnecting",e),this.leaveAll(),this.nsp.remove(this),this.client.remove(this),this.connected=!1,this.disconnected=!0,delete this.nsp.connected[this.id],this.emit("disconnect",e)},Socket.prototype.error=function(e){this.packet({type:o.ERROR,data:e})},Socket.prototype.disconnect=function(e){return this.connected?(e?this.client.disconnect():(this.packet({type:o.DISCONNECT}),this.onclose("server namespace disconnect")),this):this},Socket.prototype.compress=function(e){return this.flags.compress=e,this},Socket.prototype.binary=function(e){return this.flags.binary=e,this},Socket.prototype.dispatch=function(e){a("dispatching an event %j",e);var t=this;this.run(e,(function dispatchSocket(n){process.nextTick((function(){if(n)return t.error(n.data||n.message);c.apply(t,e)}))}))},Socket.prototype.use=function(e){return this.fns.push(e),this},Socket.prototype.run=function(e,t){var n=this.fns.slice(0);if(!n.length)return t(null);!function run(r){n[r](e,(function(e){return e?t(e):n[r+1]?void run(r+1):t(null)}))}(0)}},function(e,t,n){"use strict";const r=n(271);let o=0;e.exports=class ParentNamespace extends r{constructor(e){super(e,"/_"+o++),this.children=new Set}initAdapter(){}emit(){const e=Array.prototype.slice.call(arguments);this.children.forEach(t=>{t.rooms=this.rooms,t.flags=this.flags,t.emit.apply(t,e)}),this.rooms=[],this.flags={}}createChild(e){const t=new r(this.server,e);return t.fns=this.fns.slice(0),this.listeners("connect").forEach(e=>t.on("connect",e)),this.listeners("connection").forEach(e=>t.on("connection",e)),this.children.add(t),this.server.nsps[e]=t,t}}},function(e,t,n){var r=n(29).EventEmitter;function Adapter(e){this.nsp=e,this.rooms={},this.sids={},this.encoder=e.server.encoder}function Room(){if(!(this instanceof Room))return new Room;this.sockets={},this.length=0}e.exports=Adapter,Adapter.prototype.__proto__=r.prototype,Adapter.prototype.add=function(e,t,n){return this.addAll(e,[t],n)},Adapter.prototype.addAll=function(e,t,n){for(var r=0;r<t.length;r++){var o=t[r];this.sids[e]=this.sids[e]||{},this.sids[e][o]=!0,this.rooms[o]=this.rooms[o]||Room(),this.rooms[o].add(e)}n&&process.nextTick(n.bind(null,null))},Adapter.prototype.del=function(e,t,n){this.sids[e]&&delete this.sids[e][t],this.rooms.hasOwnProperty(t)&&(this.rooms[t].del(e),0===this.rooms[t].length&&delete this.rooms[t]),n&&process.nextTick(n.bind(null,null))},Adapter.prototype.delAll=function(e,t){var n=this.sids[e];if(n)for(var r in n)this.rooms.hasOwnProperty(r)&&(this.rooms[r].del(e),0===this.rooms[r].length&&delete this.rooms[r]);delete this.sids[e],t&&process.nextTick(t.bind(null,null))},Adapter.prototype.broadcast=function(e,t){var n,r=t.rooms||[],o=t.except||[],i=t.flags||{},s={preEncoded:!0,volatile:i.volatile,compress:i.compress},a={},c=this;e.nsp=this.nsp.name,this.encoder.encode(e,(function(e){if(r.length)for(var t=0;t<r.length;t++){var i=c.rooms[r[t]];if(i){var u=i.sockets;for(var l in u)if(u.hasOwnProperty(l)){if(a[l]||~o.indexOf(l))continue;(n=c.nsp.connected[l])&&(n.packet(e,s),a[l]=!0)}}}else for(var l in c.sids)if(c.sids.hasOwnProperty(l)){if(~o.indexOf(l))continue;(n=c.nsp.connected[l])&&n.packet(e,s)}}))},Adapter.prototype.clients=function(e,t){"function"==typeof e&&(t=e,e=null);var n={},r=[];if((e=e||[]).length)for(var o=0;o<e.length;o++){var i=this.rooms[e[o]];if(i){var s=i.sockets;for(var a in s)if(s.hasOwnProperty(a)){if(n[a])continue;this.nsp.connected[a]&&(r.push(a),n[a]=!0)}}}else for(var a in this.sids)this.sids.hasOwnProperty(a)&&this.nsp.connected[a]&&r.push(a);t&&process.nextTick(t.bind(null,null,r))},Adapter.prototype.clientRooms=function(e,t){var n=this.sids[e];t&&process.nextTick(t.bind(null,null,n?Object.keys(n):null))},Room.prototype.add=function(e){this.sockets.hasOwnProperty(e)||(this.sockets[e]=!0,this.length++)},Room.prototype.del=function(e){this.sockets.hasOwnProperty(e)&&(delete this.sockets[e],this.length--)}},function(e,t){function webpackEmptyContext(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,e.exports=webpackEmptyContext,webpackEmptyContext.id=597},function(e,t,n){"use strict";const r=n(272);r.createWebSocketStream=n(601),r.Server=n(602),r.Receiver=n(274),r.Sender=n(276),e.exports=r},function(e,t){e.exports=require("tls")},function(e,t,n){"use strict";class Event{constructor(e,t){this.target=t,this.type=e}}class MessageEvent extends Event{constructor(e,t){super("message",t),this.data=e}}class CloseEvent extends Event{constructor(e,t,n){super("close",n),this.wasClean=n._closeFrameReceived&&n._closeFrameSent,this.reason=t,this.code=e}}class OpenEvent extends Event{constructor(e){super("open",e)}}class ErrorEvent extends Event{constructor(e,t){super("error",t),this.message=e.message,this.error=e}}const r={addEventListener(e,t){function onMessage(e){t.call(this,new MessageEvent(e,this))}function onClose(e,n){t.call(this,new CloseEvent(e,n,this))}function onError(e){t.call(this,new ErrorEvent(e,this))}function onOpen(){t.call(this,new OpenEvent(this))}"function"==typeof t&&("message"===e?(onMessage._listener=t,this.on(e,onMessage)):"close"===e?(onClose._listener=t,this.on(e,onClose)):"error"===e?(onError._listener=t,this.on(e,onError)):"open"===e?(onOpen._listener=t,this.on(e,onOpen)):this.on(e,t))},removeEventListener(e,t){const n=this.listeners(e);for(let r=0;r<n.length;r++)n[r]!==t&&n[r]._listener!==t||this.removeListener(e,n[r])}};e.exports=r},function(e,t,n){"use strict";const{Duplex:r}=n(180);function emitClose(e){e.emit("close")}function duplexOnEnd(){!this.destroyed&&this._writableState.finished&&this.destroy()}function duplexOnError(e){this.removeListener("error",duplexOnError),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function createWebSocketStream(e,t){let n=!0;function receiverOnDrain(){n&&e._socket.resume()}e.readyState===e.CONNECTING?e.once("open",(function open(){e._receiver.removeAllListeners("drain"),e._receiver.on("drain",receiverOnDrain)})):(e._receiver.removeAllListeners("drain"),e._receiver.on("drain",receiverOnDrain));const o=new r({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",(function message(t){o.push(t)||(n=!1,e._socket.pause())})),e.once("error",(function error(e){o.destroy(e)})),e.once("close",(function close(){o.destroyed||o.push(null)})),o._destroy=function(t,n){if(e.readyState===e.CLOSED)return n(t),void process.nextTick(emitClose,o);e.once("close",(function close(){n(t),process.nextTick(emitClose,o)})),e.terminate()},o._final=function(t){e.readyState!==e.CONNECTING?e._socket._writableState.finished?(o._readableState.endEmitted&&o.destroy(),t()):(e._socket.once("finish",(function finish(){t()})),e.close()):e.once("open",(function open(){o._final(t)}))},o._read=function(){e.readyState!==e.OPEN||n||(n=!0,e._receiver._writableState.needDrain||e._socket.resume())},o._write=function(t,n,r){e.readyState!==e.CONNECTING?e.send(t,r):e.once("open",(function open(){o._write(t,n,r)}))},o.on("end",duplexOnEnd),o.on("error",duplexOnError),o}},function(e,t,n){"use strict";const r=n(29),{createHash:o}=n(16),{createServer:i,STATUS_CODES:s}=n(37),a=n(130),c=n(272),{format:u,parse:l}=n(277),{GUID:d}=n(74),p=/^[+/0-9A-Za-z]{22}==$/,h=Symbol("kUsedByWebSocketServer");function emitClose(e){e.emit("close")}function socketOnError(){this.destroy()}function abortHandshake(e,t,n,r){e.writable&&(n=n||s[t],r={Connection:"close","Content-type":"text/html","Content-Length":Buffer.byteLength(n),...r},e.write(`HTTP/1.1 ${t} ${s[t]}\r\n`+Object.keys(r).map(e=>`${e}: ${r[e]}`).join("\r\n")+"\r\n\r\n"+n)),e.removeListener("error",socketOnError),e.destroy()}e.exports=class WebSocketServer extends r{constructor(e,t){if(super(),null==(e={maxPayload:104857600,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,...e}).port&&!e.server&&!e.noServer)throw new TypeError('One of the "port", "server", or "noServer" options must be specified');if(null!=e.port)this._server=i((e,t)=>{const n=s[426];t.writeHead(426,{"Content-Length":n.length,"Content-Type":"text/plain"}),t.end(n)}),this._server.listen(e.port,e.host,e.backlog,t);else if(e.server){if(e.server[h])throw new Error("The HTTP/S server is already being used by another WebSocket server");e.server[h]=!0,this._server=e.server}this._server&&(this._removeListeners=function addListeners(e,t){for(const n of Object.keys(t))e.on(n,t[n]);return function removeListeners(){for(const n of Object.keys(t))e.removeListener(n,t[n])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(e,t,n)=>{this.handleUpgrade(e,t,n,t=>{this.emit("connection",t,e)})}})),!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set),this.options=e}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(e&&this.once("close",e),this.clients)for(const e of this.clients)e.terminate();const t=this._server;if(t){if(this._removeListeners(),this._removeListeners=this._server=null,null!=this.options.port)return void t.close(()=>this.emit("close"));delete t[h]}process.nextTick(emitClose,this)}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,n,r){t.on("error",socketOnError);const o=void 0!==e.headers["sec-websocket-key"]&&e.headers["sec-websocket-key"].trim(),i=+e.headers["sec-websocket-version"],s={};if("GET"!==e.method||"websocket"!==e.headers.upgrade.toLowerCase()||!o||!p.test(o)||8!==i&&13!==i||!this.shouldHandle(e))return abortHandshake(t,400);if(this.options.perMessageDeflate){const n=new a(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const t=l(e.headers["sec-websocket-extensions"]);t[a.extensionName]&&(n.accept(t[a.extensionName]),s[a.extensionName]=n)}catch(e){return abortHandshake(t,400)}}if(this.options.verifyClient){const a={origin:e.headers[""+(8===i?"sec-websocket-origin":"origin")],secure:!(!e.connection.authorized&&!e.connection.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(a,(i,a,c,u)=>{if(!i)return abortHandshake(t,a||401,c,u);this.completeUpgrade(o,s,e,t,n,r)});if(!this.options.verifyClient(a))return abortHandshake(t,401)}this.completeUpgrade(o,s,e,t,n,r)}completeUpgrade(e,t,n,r,i,s){if(!r.readable||!r.writable)return r.destroy();const l=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade","Sec-WebSocket-Accept: "+o("sha1").update(e+d).digest("base64")],p=new c(null);let h=n.headers["sec-websocket-protocol"];if(h&&(h=h.trim().split(/ *, */),h=this.options.handleProtocols?this.options.handleProtocols(h,n):h[0],h&&(l.push("Sec-WebSocket-Protocol: "+h),p.protocol=h)),t[a.extensionName]){const e=t[a.extensionName].params,n=u({[a.extensionName]:[e]});l.push("Sec-WebSocket-Extensions: "+n),p._extensions=t}this.emit("headers",l,n),r.write(l.concat("\r\n").join("\r\n")),r.removeListener("error",socketOnError),p.setSocket(r,i,this.options.maxPayload),this.clients&&(this.clients.add(p),p.on("close",()=>this.clients.delete(p))),s(p)}}},function(e,t,n){"use strict";const r=n(604);function Argv(e,t){const o=r(e,t,n(185));return function singletonify(e){Object.keys(e).forEach(t=>{"argv"===t?Argv.__defineGetter__(t,e.__lookupGetter__(t)):"function"==typeof e[t]?Argv[t]=e[t].bind(e):(Argv.__defineGetter__("$0",()=>e.$0),Argv.__defineGetter__("parsed",()=>e.parsed))})}(o),o}Argv(n(286).getProcessArgvWithoutBin()),e.exports=Argv},function(e,t,n){"use strict";(function(r){!async function requiresNode8OrGreater(){}();const o=n(181),i=n(21),s=n(278),a=n(610),c=n(281),u=n(11),l=n(612),d=n(622),p=n(624),h=n(184),m=n(283),y=n(625),{globalMiddlewareFactory:g}=n(280),_=n(132),v=n(286);function rebase(e,t){return u.relative(e,t)}(t=e.exports=function Yargs(e,t,E){e=e||[];const I={};let b=null,S=null,C={};const w=[];let A="";const O={};let P=null,D=null,x=null;const R=p({directory:u.resolve(r,"./locales"),updateFiles:!1});I.middleware=g(w,I),t||(t=process.cwd());I.scriptName=function(e){return I.customScriptName=!0,I.$0=e,I},/\b(node|iojs|electron)(\.exe)?$/.test(process.argv[0])?I.$0=process.argv.slice(1,2):I.$0=process.argv.slice(0,1);I.$0=I.$0.map((e,n)=>{const r=rebase(t,e);return e.match(/^(\/|([a-zA-Z]:)?\\)/)&&r.length<e.length?r:e}).join(" ").trim(),void 0!==process.env._&&v.getProcessArgvBin()===process.env._&&(I.$0=process.env._.replace(u.dirname(process.execPath)+"/",""));const N={resets:-1,commands:[],fullCommands:[],files:[]};let M;I.getContext=()=>N,I.resetOptions=I.reset=function resetOptions(e){N.resets++,e=e||{},M=M||{};const t={};t.local=M.local?M.local:[],t.configObjects=M.configObjects?M.configObjects:[];const n={};t.local.forEach(t=>{n[t]=!0,(e[t]||[]).forEach(e=>{n[e]=!0})}),Object.assign(O,Object.keys(C).reduce((e,t)=>{const r=C[t].filter(e=>!(e in n));return r.length>0&&(e[t]=r),e},{})),C={};return["array","boolean","string","skipValidation","count","normalize","number","hiddenOptions"].forEach(e=>{t[e]=(M[e]||[]).filter(e=>!n[e])}),["narg","key","alias","default","defaultDescription","config","choices","demandedOptions","demandedCommands","coerce","deprecatedOptions"].forEach(e=>{t[e]=h(M[e],(e,t)=>!n[e])}),t.envPrefix=M.envPrefix,M=t,P=P?P.reset(n):l(I,R),D=D?D.reset(n):d(I,P,R),b=b?b.reset():s(I,P,D,w),S||(S=a(I,P,b)),q=null,A="",K=null,Y=!1,I.parsed=!1,I},I.resetOptions();const L=[];function freeze(){const e={};L.push(e),e.options=M,e.configObjects=M.configObjects.slice(0),e.exitProcess=G,e.groups=C,P.freeze(),D.freeze(),b.freeze(),e.strict=U,e.strictCommands=V,e.completionCommand=q,e.output=A,e.exitError=K,e.hasOutput=Y,e.parsed=I.parsed,e.parseFn=k,e.parseContext=F,e.handlerFinishCommand=x}function unfreeze(){const e=L.pop();M=e.options,M.configObjects=e.configObjects,G=e.exitProcess,C=e.groups,A=e.output,K=e.exitError,Y=e.hasOutput,I.parsed=e.parsed,P.unfreeze(),D.unfreeze(),b.unfreeze(),U=e.strict,V=e.strictCommands,q=e.completionCommand,k=e.parseFn,F=e.parseContext,x=e.handlerFinishCommand}function populateParserHintArray(e,t,n){(t=[].concat(t)).forEach(t=>{t=sanitizeKey(t),M[e].push(t)})}function populateParserHintObject(e,t,n,r,o){if(Array.isArray(r)){const t=Object.create(null);r.forEach(e=>{t[e]=o}),e(t)}else"object"==typeof r?Object.keys(r).forEach(t=>{e(t,r[t])}):(r=sanitizeKey(r),M[n][r]=t?(M[n][r]||[]).concat(o):o)}function sanitizeKey(e){return"__proto__"===e?"___proto___":e}function deleteFromParserHintObject(e){Object.keys(M).forEach(t=>{const n=M[t];Array.isArray(n)?~n.indexOf(e)&&n.splice(n.indexOf(e),1):"object"==typeof n&&delete n[e]}),delete P.getDescriptions()[e]}I.boolean=function(e){return o("<array|string>",[e],arguments.length),populateParserHintArray("boolean",e),I},I.array=function(e){return o("<array|string>",[e],arguments.length),populateParserHintArray("array",e),I},I.number=function(e){return o("<array|string>",[e],arguments.length),populateParserHintArray("number",e),I},I.normalize=function(e){return o("<array|string>",[e],arguments.length),populateParserHintArray("normalize",e),I},I.count=function(e){return o("<array|string>",[e],arguments.length),populateParserHintArray("count",e),I},I.string=function(e){return o("<array|string>",[e],arguments.length),populateParserHintArray("string",e),I},I.requiresArg=function(e,t){return o("<array|string|object> [number]",[e],arguments.length),"string"==typeof e&&M.narg[e]||populateParserHintObject(I.requiresArg,!1,"narg",e,NaN),I},I.skipValidation=function(e){return o("<array|string>",[e],arguments.length),populateParserHintArray("skipValidation",e),I},I.nargs=function(e,t){return o("<string|object|array> [number]",[e,t],arguments.length),populateParserHintObject(I.nargs,!1,"narg",e,t),I},I.choices=function(e,t){return o("<object|string|array> [string|array]",[e,t],arguments.length),populateParserHintObject(I.choices,!0,"choices",e,t),I},I.alias=function(e,t){return o("<object|string|array> [string|array]",[e,t],arguments.length),populateParserHintObject(I.alias,!0,"alias",e,t),I},I.default=I.defaults=function(e,t,n){return o("<object|string|array> [*] [string]",[e,t,n],arguments.length),n&&(M.defaultDescription[e]=n),"function"==typeof t&&(M.defaultDescription[e]||(M.defaultDescription[e]=P.functionDescription(t)),t=t.call()),populateParserHintObject(I.default,!1,"default",e,t),I},I.describe=function(e,t){return o("<object|string|array> [string]",[e,t],arguments.length),populateParserHintObject(I.describe,!1,"key",e,!0),P.describe(e,t),I},I.demandOption=function(e,t){return o("<object|string|array> [string]",[e,t],arguments.length),populateParserHintObject(I.demandOption,!1,"demandedOptions",e,t),I},I.coerce=function(e,t){return o("<object|string|array> [function]",[e,t],arguments.length),populateParserHintObject(I.coerce,!1,"coerce",e,t),I},I.config=function config(e,n,r){return o("[object|string] [string|function] [function]",[e,n,r],arguments.length),"object"==typeof e?(e=y(e,t,I.getParserConfiguration()["deep-merge-config"]),M.configObjects=(M.configObjects||[]).concat(e),I):("function"==typeof n&&(r=n,n=null),e=e||"config",I.describe(e,n||P.deferY18nLookup("Path to JSON config file")),(Array.isArray(e)?e:[e]).forEach(e=>{M.config[e]=r||!0}),I)},I.example=function(e,t){return o("<string> [string]",[e,t],arguments.length),P.example(e,t),I},I.command=function(e,t,n,r,i){return o("<string|array|object> [string|boolean] [function|object] [function] [array]",[e,t,n,r,i],arguments.length),b.addHandler(e,t,n,r,i),I},I.commandDir=function(e,t){o("<string> [object]",[e,t],arguments.length);const r=E||n(185);return b.addDirectory(e,I.getContext(),r,n(626)(),t),I},I.demand=I.required=I.require=function demand(e,t,n){return Array.isArray(t)?(t.forEach(e=>{I.demandOption(e,n)}),t=1/0):"number"!=typeof t&&(n=t,t=1/0),"number"==typeof e?I.demandCommand(e,t,n,n):Array.isArray(e)?e.forEach(e=>{I.demandOption(e,n)}):"string"==typeof n?I.demandOption(e,n):!0!==n&&void 0!==n||I.demandOption(e),I},I.demandCommand=function demandCommand(e,t,n,r){return o("[number] [number|string] [string|null|undefined] [string|null|undefined]",[e,t,n,r],arguments.length),void 0===e&&(e=1),"number"!=typeof t&&(n=t,t=1/0),I.global("_",!1),M.demandedCommands._={min:e,max:t,minMsg:n,maxMsg:r},I},I.getDemandedOptions=()=>(o([],0),M.demandedOptions),I.getDemandedCommands=()=>(o([],0),M.demandedCommands),I.deprecateOption=function deprecateOption(e,t){return o("<string> [string|boolean]",[e,t],arguments.length),M.deprecatedOptions[e]=t,I},I.getDeprecatedOptions=()=>(o([],0),M.deprecatedOptions),I.implies=function(e,t){return o("<string|object> [number|string|array]",[e,t],arguments.length),D.implies(e,t),I},I.conflicts=function(e,t){return o("<string|object> [string|array]",[e,t],arguments.length),D.conflicts(e,t),I},I.usage=function(e,t,n,r){if(o("<string|null|undefined> [string|boolean] [function|object] [function]",[e,t,n,r],arguments.length),void 0!==t){if((e||"").match(/^\$0( |$)/))return I.command(e,t,n,r);throw new _(".usage() description must start with $0 if being used as alias for .command()")}return P.usage(e),I},I.epilogue=I.epilog=function(e){return o("<string>",[e],arguments.length),P.epilog(e),I},I.fail=function(e){return o("<function>",[e],arguments.length),P.failFn(e),I},I.onFinishCommand=function(e){return o("<function>",[e],arguments.length),x=e,I},I.getHandlerFinishCommand=()=>x,I.check=function(e,t){return o("<function> [boolean]",[e,t],arguments.length),D.check(e,!1!==t),I},I.global=function global(e,global){return o("<string|array> [boolean]",[e,global],arguments.length),e=[].concat(e),!1!==global?M.local=M.local.filter(t=>-1===e.indexOf(t)):e.forEach(e=>{-1===M.local.indexOf(e)&&M.local.push(e)}),I},I.pkgConf=function pkgConf(e,n){o("<string> [string]",[e,n],arguments.length);let r=null;const i=pkgUp(n||t);return i[e]&&"object"==typeof i[e]&&(r=y(i[e],n||t,I.getParserConfiguration()["deep-merge-config"]),M.configObjects=(M.configObjects||[]).concat(r)),I};const j={};function pkgUp(e){const t=e||"*";if(j[t])return j[t];const r=n(627);let o={};try{let t=e||n(633)(E||n(185));!e&&u.extname(t)&&(t=u.dirname(t));const s=r.sync("package.json",{cwd:t});o=JSON.parse(i.readFileSync(s))}catch(e){}return j[t]=o||{},j[t]}let k=null,F=null;I.parse=function parse(t,n,r){if(o("[string|array] [function|boolean|object] [function]",[t,n,r],arguments.length),freeze(),void 0===t){const t=I._parseArgs(e),n=I.parsed;return unfreeze(),I.parsed=n,t}"object"==typeof n&&(F=n,n=r),"function"==typeof n&&(k=n,n=null),n||(e=t),k&&(G=!1);const i=I._parseArgs(t,n);return S.setParsed(I.parsed),k&&k(K,i,A),unfreeze(),i},I._getParseContext=()=>F||{},I._hasParseCallback=()=>!!k,I.option=I.options=function option(e,t){if(o("<string|object> [object]",[e,t],arguments.length),"object"==typeof e)Object.keys(e).forEach(t=>{I.options(t,e[t])});else{"object"!=typeof t&&(t={}),M.key[e]=!0,t.alias&&I.alias(e,t.alias);const n=t.deprecate||t.deprecated;n&&I.deprecateOption(e,n);const r=t.demand||t.required||t.require;r&&I.demand(e,r),t.demandOption&&I.demandOption(e,"string"==typeof t.demandOption?t.demandOption:void 0),"conflicts"in t&&I.conflicts(e,t.conflicts),"default"in t&&I.default(e,t.default),"implies"in t&&I.implies(e,t.implies),"nargs"in t&&I.nargs(e,t.nargs),t.config&&I.config(e,t.configParser),t.normalize&&I.normalize(e),"choices"in t&&I.choices(e,t.choices),"coerce"in t&&I.coerce(e,t.coerce),"group"in t&&I.group(e,t.group),(t.boolean||"boolean"===t.type)&&(I.boolean(e),t.alias&&I.boolean(t.alias)),(t.array||"array"===t.type)&&(I.array(e),t.alias&&I.array(t.alias)),(t.number||"number"===t.type)&&(I.number(e),t.alias&&I.number(t.alias)),(t.string||"string"===t.type)&&(I.string(e),t.alias&&I.string(t.alias)),(t.count||"count"===t.type)&&I.count(e),"boolean"==typeof t.global&&I.global(e,t.global),t.defaultDescription&&(M.defaultDescription[e]=t.defaultDescription),t.skipValidation&&I.skipValidation(e);const o=t.describe||t.description||t.desc;I.describe(e,o),t.hidden&&I.hide(e),t.requiresArg&&I.requiresArg(e)}return I},I.getOptions=()=>M,I.positional=function(e,t){if(o("<string> <object>",[e,t],arguments.length),0===N.resets)throw new _(".positional() can only be called in a command's builder function");const n=["default","defaultDescription","implies","normalize","choices","conflicts","coerce","type","describe","desc","description","alias"];t=h(t,(e,t)=>{let r=-1!==n.indexOf(e);return"type"===e&&-1===["string","number","boolean"].indexOf(t)&&(r=!1),r});const r=N.fullCommands[N.fullCommands.length-1],i=r?b.cmdToParseOptions(r):{array:[],alias:{},default:{},demand:{}};return Object.keys(i).forEach(n=>{Array.isArray(i[n])?-1!==i[n].indexOf(e)&&(t[n]=!0):i[n][e]&&!(n in t)&&(t[n]=i[n][e])}),I.group(e,P.getPositionalGroupName()),I.option(e,t)},I.group=function group(e,t){o("<string|array> <string>",[e,t],arguments.length);const n=O[t]||C[t];O[t]&&delete O[t];const r={};return C[t]=(n||[]).concat(e).filter(e=>!r[e]&&(r[e]=!0)),I},I.getGroups=()=>Object.assign({},C,O),I.env=function(e){return o("[string|boolean]",[e],arguments.length),M.envPrefix=!1===e?void 0:e||"",I},I.wrap=function(e){return o("<number|null|undefined>",[e],arguments.length),P.wrap(e),I};let U=!1;I.strict=function(e){return o("[boolean]",[e],arguments.length),U=!1!==e,I},I.getStrict=()=>U;let V=!1;I.strictCommands=function(e){return o("[boolean]",[e],arguments.length),V=!1!==e,I},I.getStrictCommands=()=>V;let B={};I.parserConfiguration=function parserConfiguration(e){return o("<object>",[e],arguments.length),B=e,I},I.getParserConfiguration=()=>B,I.showHelp=function(t){return o("[string|function]",[t],arguments.length),I.parsed||I._parseArgs(e),b.hasDefaultCommand()&&(N.resets++,b.runDefaultBuilderOn(I,!0)),P.showHelp(t),I};let J=null;function guessVersion(){return pkgUp().version||"unknown"}I.version=function version(e,t,n){const r="version";if(o("[boolean|string] [string] [string]",[e,t,n],arguments.length),J&&(deleteFromParserHintObject(J),P.version(void 0),J=null),0===arguments.length)n=guessVersion(),e=r;else if(1===arguments.length){if(!1===e)return I;n=e,e=r}else 2===arguments.length&&(n=t,t=null);return J="string"==typeof e?e:r,t=t||P.deferY18nLookup("Show version number"),P.version(n||void 0),I.boolean(J),I.describe(J,t),I};let $=null;I.addHelpOpt=I.help=function addHelpOpt(e,t){const n="help";return o("[string|boolean] [string]",[e,t],arguments.length),$&&(deleteFromParserHintObject($),$=null),1===arguments.length&&!1===e||($="string"==typeof e?e:n,I.boolean($),I.describe($,t||P.deferY18nLookup("Show help"))),I};M.showHiddenOpt="show-hidden",I.addShowHiddenOpt=I.showHidden=function addShowHiddenOpt(e,t){if(o("[string|boolean] [string]",[e,t],arguments.length),1===arguments.length&&!1===e)return I;const n="string"==typeof e?e:"show-hidden";return I.boolean(n),I.describe(n,t||P.deferY18nLookup("Show hidden options")),M.showHiddenOpt=n,I},I.hide=function hide(e){return o("<string|object>",[e],arguments.length),M.hiddenOptions.push(e),I},I.showHelpOnFail=function showHelpOnFail(e,t){return o("[boolean|string] [string]",[e,t],arguments.length),P.showHelpOnFail(e,t),I};var G=!0;I.exitProcess=function(e){return o("[boolean]",[e],arguments.length),"boolean"!=typeof e&&(e=!0),G=e,I},I.getExitProcess=()=>G;var q=null;I.completion=function(e,t,n){return o("[string] [string|boolean|function] [function]",[e,t,n],arguments.length),"function"==typeof t&&(n=t,t=null),q=e||q||"completion",t||!1===t||(t="generate completion script"),I.command(q,t),n&&S.registerFunction(n),I},I.showCompletionScript=function(e,t){return o("[string] [string]",[e,t],arguments.length),e=e||I.$0,z.log(S.generateCompletionScript(e,t||q||"completion")),I},I.getCompletion=function(e,t){o("<array> <function>",[e,t],arguments.length),S.getCompletion(e,t)},I.locale=function(e){return o("[string]",[e],arguments.length),0===arguments.length?(guessLocale(),R.getLocale()):(H=!1,R.setLocale(e),I)},I.updateStrings=I.updateLocale=function(e){return o("<object>",[e],arguments.length),H=!1,R.updateLocale(e),I};let H=!0;I.detectLocale=function(e){return o("<boolean>",[e],arguments.length),H=e,I},I.getDetectLocale=()=>H;var Y=!1,K=null;I.exit=(e,t)=>{Y=!0,K=t,G&&process.exit(e)};const z={log(){const e=[];for(let t=0;t<arguments.length;t++)e.push(arguments[t]);I._hasParseCallback()||console.log.apply(console,e),Y=!0,A.length&&(A+="\n"),A+=e.join(" ")},error(){const e=[];for(let t=0;t<arguments.length;t++)e.push(arguments[t]);I._hasParseCallback()||console.error.apply(console,e),Y=!0,A.length&&(A+="\n"),A+=e.join(" ")}};let W;function guessLocale(){if(!H)return;const e=process.env.LC_ALL||process.env.LC_MESSAGES||process.env.LANG||process.env.LANGUAGE||"en_US";I.locale(e.replace(/[.:].*/,""))}return I._getLoggerInstance=()=>z,I._hasOutput=()=>Y,I._setHasOutput=()=>{Y=!0},I.recommendCommands=function(e){return o("[boolean]",[e],arguments.length),W="boolean"!=typeof e||e,I},I.getUsageInstance=()=>P,I.getValidationInstance=()=>D,I.getCommandInstance=()=>b,I.terminalWidth=()=>(o([],0),void 0!==process.stdout.columns?process.stdout.columns:null),Object.defineProperty(I,"argv",{get:()=>I._parseArgs(e),enumerable:!0}),I._parseArgs=function parseArgs(t,n,r,o){let i=!!r;t=t||e,M.__=R.__,M.configuration=I.getParserConfiguration();const s=!!M.configuration["populate--"],a=Object.assign({},M.configuration,{"populate--":!0}),u=c.detailed(t,Object.assign({},M,{configuration:a}));let l=u.argv;F&&(l=Object.assign({},l,F));const d=u.aliases;l.$0=I.$0,I.parsed=u;try{if(guessLocale(),n)return s||r?l:I._copyDoubleDash(l);if($){~[$].concat(d[$]||[]).filter(e=>e.length>1).indexOf(l._[l._.length-1])&&(l._.pop(),l[$]=!0)}const e=b.getCommands(),a=S.completionKey in l,c=l[$]||a,p=c&&(e.length>1||"$0"!==e[0]);if(l._.length){if(e.length){let t;for(let n,r=o||0;void 0!==l._[r];r++){if(n=String(l._[r]),~e.indexOf(n)&&n!==q){const e=b.runCommand(n,I,u,r+1);return s?e:I._copyDoubleDash(e)}if(!t&&n!==q){t=n;break}}if(b.hasDefaultCommand()&&!p){const e=b.runCommand(null,I,u);return s?e:I._copyDoubleDash(e)}W&&t&&!c&&D.recommendCommands(t,e)}q&&~l._.indexOf(q)&&!a&&(G&&m(!0),I.showCompletionScript(),I.exit(0))}else if(b.hasDefaultCommand()&&!p){const e=b.runCommand(null,I,u);return s?e:I._copyDoubleDash(e)}if(a){G&&m(!0);const e=t.slice(t.indexOf("--"+S.completionKey)+1);return S.getCompletion(e,e=>{(e||[]).forEach(e=>{z.log(e)}),I.exit(0)}),s||r?l:I._copyDoubleDash(l)}if(Y||Object.keys(l).forEach(e=>{e===$&&l[e]?(G&&m(!0),i=!0,I.showHelp("log"),I.exit(0)):e===J&&l[e]&&(G&&m(!0),i=!0,P.showVersion(),I.exit(0))}),!i&&M.skipValidation.length>0&&(i=Object.keys(l).some(e=>M.skipValidation.indexOf(e)>=0&&!0===l[e])),!i){if(u.error)throw new _(u.error.message);a||I._runValidation(l,d,{},u.error)}}catch(e){if(!(e instanceof _))throw e;P.fail(e.message,e)}return s||r?l:I._copyDoubleDash(l)},I._copyDoubleDash=function(e){if(!e._||!e["--"])return e;e._.push.apply(e._,e["--"]);try{delete e["--"]}catch(e){}return e},I._runValidation=function runValidation(e,t,n,r){if(r)throw new _(r.message);D.nonOptionCount(e),D.requiredArguments(e);let o=!1;V&&(o=D.unknownCommands(e,t,n)),U&&!o&&D.unknownArguments(e,t,n),D.customChecks(e,t),D.limitedChoices(e),D.implications(e),D.conflicting(e)},I.help(),I.version(),I}).Parser=c,t.rebase=rebase}).call(this,"/")},function(e,t,n){"use strict";const camelCase=(e,t)=>{if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("Expected the input to be `string | string[]`");t=Object.assign({pascalCase:!1},t);if(0===(e=Array.isArray(e)?e.map(e=>e.trim()).filter(e=>e.length).join("-"):e.trim()).length)return"";if(1===e.length)return t.pascalCase?e.toUpperCase():e.toLowerCase();return e!==e.toLowerCase()&&(e=(e=>{let t=!1,n=!1,r=!1;for(let o=0;o<e.length;o++){const i=e[o];t&&/[a-zA-Z]/.test(i)&&i.toUpperCase()===i?(e=e.slice(0,o)+"-"+e.slice(o),t=!1,r=n,n=!0,o++):n&&r&&/[a-zA-Z]/.test(i)&&i.toLowerCase()===i?(e=e.slice(0,o-1)+"-"+e.slice(o-1),r=n,n=!1,t=!0):(t=i.toLowerCase()===i&&i.toUpperCase()!==i,r=n,n=i.toUpperCase()===i&&i.toLowerCase()!==i)}return e})(e)),e=e.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,(e,t)=>t.toUpperCase()).replace(/\d+(\w|$)/g,e=>e.toUpperCase()),n=e,t.pascalCase?n.charAt(0).toUpperCase()+n.slice(1):n;var n};e.exports=camelCase,e.exports.default=camelCase},function(e,t){e.exports=function(e){if(Array.isArray(e))return e.map(e=>"string"!=typeof e?e+"":e);e=e.trim();let t=0,n=null,r=null,o=null;const i=[];for(let s=0;s<e.length;s++)n=r,r=e.charAt(s)," "!==r||o?(r===o?o=null:"'"!==r&&'"'!==r||o||(o=r),i[t]||(i[t]=""),i[t]+=r):" "!==n&&t++;return i}},function(e,t){function webpackEmptyContext(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,e.exports=webpackEmptyContext,webpackEmptyContext.id=607},function(e,t,n){"use strict";var r=n(21),o=n(11).join,i=n(11).resolve,s=n(11).dirname,a={extensions:["js","json","coffee"],recurse:!0,rename:function(e){return e},visit:function(e){return e}};e.exports=function requireDirectory(e,t,n){var c={};for(var u in t&&!n&&"string"!=typeof t&&(n=t,t=null),n=n||{},a)void 0===n[u]&&(n[u]=a[u]);return t=t?i(s(e.filename),t):s(e.filename),r.readdirSync(t).forEach((function(i){var s,a,u,l=o(t,i);r.statSync(l).isDirectory()&&n.recurse?(s=requireDirectory(e,l,n),Object.keys(s).length&&(c[n.rename(i,l,i)]=s)):l!==e.filename&&function checkFileInclusion(e,t,n){return new RegExp("\\.("+n.extensions.join("|")+")$","i").test(t)&&!(n.include&&n.include instanceof RegExp&&!n.include.test(e))&&!(n.include&&"function"==typeof n.include&&!n.include(e,t))&&!(n.exclude&&n.exclude instanceof RegExp&&n.exclude.test(e))&&!(n.exclude&&"function"==typeof n.exclude&&n.exclude(e,t))}(l,i,n)&&(a=i.substring(0,i.lastIndexOf(".")),u=e.require(l),c[n.rename(a,l,i)]=n.visit(u,l,i)||u)})),c},e.exports.defaults=a},function(e,t,n){"use strict";e.exports=function whichModule(e){for(var t,r=0,o=Object.keys(n.c);r<o.length;r++)if((t=n.c[o[r]]).exports===e)return t;return null}},function(e,t,n){"use strict";const r=n(11);e.exports=function completion(e,t,o){const i={completionKey:"get-yargs-completions"};let s;i.setParsed=function setParsed(e){s=e.aliases};const a=process.env.SHELL&&-1!==process.env.SHELL.indexOf("zsh")||process.env.ZSH_NAME&&-1!==process.env.ZSH_NAME.indexOf("zsh");i.getCompletion=function getCompletion(n,r){const i=[],u=n.length?n[n.length-1]:"",l=e.parse(n,!0),d=e.getContext().commands;if(c){if(c.length<3){const e=c(u,l);return"function"==typeof e.then?e.then(e=>{process.nextTick(()=>{r(e)})}).catch(e=>{process.nextTick(()=>{throw e})}):r(e)}return c(u,l,e=>{r(e)})}const p=o.getCommandHandlers();for(let t=0,r=n.length;t<r;++t)if(p[n[t]]&&p[n[t]].builder){const r=p[n[t]].builder;if("function"==typeof r){const t=e.reset();return r(t),t.argv}}if(u.match(/^-/)||d[d.length-1]===u||t.getCommands().forEach(e=>{const t=o.parseCommand(e[0]).cmd;if(-1===n.indexOf(t))if(a){const n=e[1]||"";i.push(t.replace(/:/g,"\\:")+":"+n)}else i.push(t)}),u.match(/^-/)||""===u&&0===i.length){const r=t.getDescriptions(),o=e.getOptions();Object.keys(o.key).forEach(e=>{const t=!!o.configuration["boolean-negation"]&&o.boolean.includes(e);let c=[e].concat(s[e]||[]);function completeOptionKey(e){if(c.every(e=>-1===n.indexOf("--"+e))){const isShortOption=e=>/^[^0-9]$/.test(e),t=!(e=>/^--/.test(e))(u)&&isShortOption(e)?"-":"--";if(a){const n=r[e]||"";i.push(t+`${e.replace(/:/g,"\\:")}:${n.replace("__yargsString__:","")}`)}else i.push(t+e)}}t&&(c=c.concat(c.map(e=>"no-"+e))),completeOptionKey(e),t&&o.default[e]&&completeOptionKey("no-"+e)})}r(i)},i.generateCompletionScript=function generateCompletionScript(e,t){const o=n(611);let i=a?o.completionZshTemplate:o.completionShTemplate;const s=r.basename(e);return e.match(/\.js$/)&&(e="./"+e),i=i.replace(/{{app_name}}/g,s),i=i.replace(/{{completion_command}}/g,t),i.replace(/{{app_path}}/g,e)};let c=null;return i.registerFunction=e=>{c=e},i}},function(e,t){t.completionShTemplate='###-begin-{{app_name}}-completions-###\n#\n# yargs command completion script\n#\n# Installation: {{app_path}} {{completion_command}} >> ~/.bashrc\n#    or {{app_path}} {{completion_command}} >> ~/.bash_profile on OSX.\n#\n_yargs_completions()\n{\n    local cur_word args type_list\n\n    cur_word="${COMP_WORDS[COMP_CWORD]}"\n    args=("${COMP_WORDS[@]}")\n\n    # ask yargs to generate completions.\n    type_list=$({{app_path}} --get-yargs-completions "${args[@]}")\n\n    COMPREPLY=( $(compgen -W "${type_list}" -- ${cur_word}) )\n\n    # if no match was found, fall back to filename completion\n    if [ ${#COMPREPLY[@]} -eq 0 ]; then\n      COMPREPLY=()\n    fi\n\n    return 0\n}\ncomplete -o default -F _yargs_completions {{app_name}}\n###-end-{{app_name}}-completions-###\n',t.completionZshTemplate='###-begin-{{app_name}}-completions-###\n#\n# yargs command completion script\n#\n# Installation: {{app_path}} {{completion_command}} >> ~/.zshrc\n#    or {{app_path}} {{completion_command}} >> ~/.zsh_profile on OSX.\n#\n_{{app_name}}_yargs_completions()\n{\n  local reply\n  local si=$IFS\n  IFS=$\'\n\' reply=($(COMP_CWORD="$((CURRENT-1))" COMP_LINE="$BUFFER" COMP_POINT="$CURSOR" {{app_path}} --get-yargs-completions "${words[@]}"))\n  IFS=$si\n  _describe \'values\' reply\n}\ncompdef _{{app_name}}_yargs_completions {{app_name}}\n###-end-{{app_name}}-completions-###\n'},function(e,t,n){"use strict";const r=n(282),o=n(182),i=n(184),s=n(11),a=n(283),c=n(132);e.exports=function usage(e,t){const u=t.__,l={},d=[];l.failFn=function failFn(e){d.push(e)};let p=null,h=!0;l.showHelpOnFail=function showHelpOnFailFn(e,t){return"string"==typeof e?(t=e,e=!0):void 0===e&&(e=!0),p=t,h=e,l};let m=!1;l.fail=function fail(t,n){const r=e._getLoggerInstance();if(!d.length){if(e.getExitProcess()&&a(!0),m||(m=!0,h&&(e.showHelp("error"),r.error()),(t||n)&&r.error(t||n),p&&((t||n)&&r.error(""),r.error(p))),n=n||new c(t),e.getExitProcess())return e.exit(1);if(e._hasParseCallback())return e.exit(1,n);throw n}for(let e=d.length-1;e>=0;--e)d[e](t,n,l)};let y=[],g=!1;l.usage=(e,t)=>null===e?(g=!0,void(y=[])):(g=!1,y.push([e,t||""]),l),l.getUsage=()=>y,l.getUsageDisabled=()=>g,l.getPositionalGroupName=()=>u("Positionals:");let _=[];l.example=(e,t)=>{_.push([e,t||""])};let v=[];l.command=function command(e,t,n,r){n&&(v=v.map(e=>(e[2]=!1,e))),v.push([e,t||"",n,r])},l.getCommands=()=>v;let E={};l.describe=function describe(e,t){"object"==typeof e?Object.keys(e).forEach(t=>{l.describe(t,e[t])}):E[e]=t},l.getDescriptions=()=>E;let I=[];l.epilog=e=>{I.push(e)};let b,S=!1;function getWrap(){return S||(b=function windowWidth(){return"object"==typeof process&&process.stdout&&process.stdout.columns?Math.min(80,process.stdout.columns):80}(),S=!0),b}l.wrap=e=>{S=!0,b=e};l.deferY18nLookup=e=>"__yargsString__:"+e;const C=u("Options:");function maxWidth(e,t,n){let r=0;return Array.isArray(e)||(e=Object.keys(e).map(t=>[e[t]])),e.forEach(e=>{r=Math.max(o(n?`${n} ${e[0]}`:e[0]),r)}),t&&(r=Math.min(r,parseInt(.5*t,10))),r}let w;function filterHiddenOptions(t){return e.getOptions().hiddenOptions.indexOf(t)<0||e.parsed.argv[e.getOptions().showHiddenOpt]}function defaultString(e,t){let n=`[${u("default:")} `;if(void 0===e&&!t)return null;if(t)n+=t;else switch(typeof e){case"string":n+=`"${e}"`;break;case"object":n+=JSON.stringify(e);break;default:n+=e}return n+"]"}l.help=function help(){if(w)return w;!function normalizeAliases(){const t=e.getDemandedOptions(),n=e.getOptions();(Object.keys(n.alias)||[]).forEach(r=>{n.alias[r].forEach(o=>{E[o]&&l.describe(r,E[o]),o in t&&e.demandOption(r,t[o]),~n.boolean.indexOf(o)&&e.boolean(r),~n.count.indexOf(o)&&e.count(r),~n.string.indexOf(o)&&e.string(r),~n.normalize.indexOf(o)&&e.normalize(r),~n.array.indexOf(o)&&e.array(r),~n.number.indexOf(o)&&e.number(r)})})}();const t=e.customScriptName?e.$0:s.basename(e.$0),r=e.getDemandedOptions(),o=e.getDemandedCommands(),i=e.getDeprecatedOptions(),a=e.getGroups(),c=e.getOptions();let d=[];d=d.concat(Object.keys(E)),d=d.concat(Object.keys(r)),d=d.concat(Object.keys(o)),d=d.concat(Object.keys(c.default)),d=d.filter(filterHiddenOptions),d=Object.keys(d.reduce((e,t)=>("_"!==t&&(e[t]=!0),e),{}));const p=getWrap(),h=n(616)({width:p,wrap:!!p});if(!g)if(y.length)y.forEach(e=>{h.div(""+e[0].replace(/\$0/g,t)),e[1]&&h.div({text:""+e[1],padding:[1,0,0,0]})}),h.div();else if(v.length){let e=null;e=o._?`${t} <${u("command")}>\n`:`${t} [${u("command")}]\n`,h.div(""+e)}if(v.length){h.div(u("Commands:"));const n=e.getContext(),r=n.commands.length?n.commands.join(" ")+" ":"";!0===e.getParserConfiguration()["sort-commands"]&&(v=v.sort((e,t)=>e[0].localeCompare(t[0]))),v.forEach(e=>{const n=`${t} ${r}${e[0].replace(/^\$0 ?/,"")}`;h.span({text:n,padding:[0,2,0,2],width:maxWidth(v,p,`${t}${r}`)+4},{text:e[1]});const o=[];e[2]&&o.push(`[${u("default")}]`),e[3]&&e[3].length&&o.push(`[${u("aliases:")} ${e[3].join(", ")}]`),o.length?h.div({text:o.join(" "),padding:[0,0,0,2],align:"right"}):h.div()}),h.div()}const m=(Object.keys(c.alias)||[]).concat(Object.keys(e.parsed.newAliases)||[]);if(d=d.filter(t=>!e.parsed.newAliases[t]&&m.every(e=>-1===(c.alias[e]||[]).indexOf(t))),a[C]||(a[C]=[]),function addUngroupedKeys(e,t,n){let r=[],o=null;return Object.keys(n).forEach(e=>{r=r.concat(n[e])}),e.forEach(e=>{o=[e].concat(t[e]),o.some(e=>-1!==r.indexOf(e))||n[C].push(e)}),r}(d,c.alias,a),Object.keys(a).forEach(e=>{if(!a[e].length)return;const t=a[e].filter(filterHiddenOptions).map(e=>{if(~m.indexOf(e))return e;for(let t,n=0;void 0!==(t=m[n]);n++)if(~(c.alias[t]||[]).indexOf(e))return t;return e});if(t.length<1)return;h.div(e);const n=t.reduce((t,n)=>(t[n]=[n].concat(c.alias[n]||[]).map(t=>e===l.getPositionalGroupName()?t:(/^[0-9]$/.test(t)?~c.boolean.indexOf(n)?"-":"--":t.length>1?"--":"-")+t).join(", "),t),{});t.forEach(e=>{const t=n[e];let o=E[e]||"",s=null;~o.lastIndexOf("__yargsString__:")&&(o=u(o.substring("__yargsString__:".length))),~c.boolean.indexOf(e)&&(s=`[${u("boolean")}]`),~c.count.indexOf(e)&&(s=`[${u("count")}]`),~c.string.indexOf(e)&&(s=`[${u("string")}]`),~c.normalize.indexOf(e)&&(s=`[${u("string")}]`),~c.array.indexOf(e)&&(s=`[${u("array")}]`),~c.number.indexOf(e)&&(s=`[${u("number")}]`);const a=[e in i?"string"==typeof i[e]?`[${u("deprecated: %s",i[e])}]`:`[${u("deprecated")}]`:null,s,e in r?`[${u("required")}]`:null,c.choices&&c.choices[e]?`[${u("choices:")} ${l.stringifiedValues(c.choices[e])}]`:null,defaultString(c.default[e],c.defaultDescription[e])].filter(Boolean).join(" ");h.span({text:t,padding:[0,2,0,2],width:maxWidth(n,p)+4},o),a?h.div({text:a,padding:[0,0,0,2],align:"right"}):h.div()}),h.div()}),_.length&&(h.div(u("Examples:")),_.forEach(e=>{e[0]=e[0].replace(/\$0/g,t)}),_.forEach(e=>{""===e[1]?h.div({text:e[0],padding:[0,2,0,2]}):h.div({text:e[0],padding:[0,2,0,2],width:maxWidth(_,p)+4},{text:e[1]})}),h.div()),I.length>0){const e=I.map(e=>e.replace(/\$0/g,t)).join("\n");h.div(e+"\n")}return h.toString().replace(/\s*$/,"")},l.cacheHelpMessage=function(){w=this.help()},l.clearCachedHelpMessage=function(){w=void 0},l.showHelp=t=>{const n=e._getLoggerInstance();t||(t="error");("function"==typeof t?t:n[t])(l.help())},l.functionDescription=e=>["(",e.name?r(e.name,"-"):u("generated-value"),")"].join(""),l.stringifiedValues=function stringifiedValues(e,t){let n="";const r=t||", ",o=[].concat(e);return e&&o.length?(o.forEach(e=>{n.length&&(n+=r),n+=JSON.stringify(e)}),n):n};let A=null;l.version=e=>{A=e},l.showVersion=()=>{e._getLoggerInstance().log(A)},l.reset=function reset(e){return p=null,m=!1,y=[],g=!1,I=[],_=[],v=[],E=i(E,(t,n)=>!e[t]),l};const O=[];return l.freeze=function freeze(){const e={};O.push(e),e.failMessage=p,e.failureOutput=m,e.usages=y,e.usageDisabled=g,e.epilogs=I,e.examples=_,e.commands=v,e.descriptions=E},l.unfreeze=function unfreeze(){const e=O.pop();p=e.failMessage,m=e.failureOutput,y=e.usages,g=e.usageDisabled,I=e.epilogs,_=e.examples,v=e.commands,E=e.descriptions},l}},function(e,t,n){"use strict";e.exports=({onlyFirst:e=!1}={})=>{const t=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:[a-zA-Z\\d]*(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(t,e?void 0:"g")}},function(e,t,n){"use strict";const isFullwidthCodePoint=e=>!Number.isNaN(e)&&(e>=4352&&(e<=4447||9001===e||9002===e||11904<=e&&e<=12871&&12351!==e||12880<=e&&e<=19903||19968<=e&&e<=42182||43360<=e&&e<=43388||44032<=e&&e<=55203||63744<=e&&e<=64255||65040<=e&&e<=65049||65072<=e&&e<=65131||65281<=e&&e<=65376||65504<=e&&e<=65510||110592<=e&&e<=110593||127488<=e&&e<=127569||131072<=e&&e<=262141));e.exports=isFullwidthCodePoint,e.exports.default=isFullwidthCodePoint},function(e,t,n){"use strict";e.exports=function(){return/\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F|\uD83D\uDC68(?:\uD83C\uDFFC\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68\uD83C\uDFFB|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFE])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|[\u2695\u2696\u2708]\uFE0F|\uD83D[\uDC66\uDC67]|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708])\uFE0F|\uD83C\uDFFB\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C[\uDFFB-\uDFFF])|(?:\uD83E\uDDD1\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83D\uDC69)\uD83C\uDFFB|\uD83E\uDDD1(?:\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1)|(?:\uD83E\uDDD1\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB-\uDFFE])|(?:\uD83E\uDDD1\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83D\uDC69)(?:\uD83C[\uDFFB\uDFFC])|\uD83D\uDC69(?:\uD83C\uDFFE\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFB\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFC-\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD]))|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83E\uDDD1\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83D\uDC69)(?:\uD83C[\uDFFB-\uDFFD])|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83D\uDC69(?:\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708]|\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])|(?:(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)\uFE0F|\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|\u200D[\u2640\u2642])|\uD83C\uDFF4\u200D\u2620)\uFE0F|\uD83D\uDC69\u200D\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83D\uDC15\u200D\uD83E\uDDBA|\uD83D\uDC69\u200D\uD83D\uDC66|\uD83D\uDC69\u200D\uD83D\uDC67|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDF6\uD83C\uDDE6|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDB5\uDDB6\uDDBB\uDDD2-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDED5\uDEEB\uDEEC\uDEF4-\uDEFA\uDFE0-\uDFEB]|\uD83E[\uDD0D-\uDD3A\uDD3C-\uDD45\uDD47-\uDD71\uDD73-\uDD76\uDD7A-\uDDA2\uDDA5-\uDDAA\uDDAE-\uDDCA\uDDCD-\uDDFF\uDE70-\uDE73\uDE78-\uDE7A\uDE80-\uDE82\uDE90-\uDE95])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFA\uDFE0-\uDFEB]|\uD83E[\uDD0D-\uDD3A\uDD3C-\uDD45\uDD47-\uDD71\uDD73-\uDD76\uDD7A-\uDDA2\uDDA5-\uDDAA\uDDAE-\uDDCA\uDDCD-\uDDFF\uDE70-\uDE73\uDE78-\uDE7A\uDE80-\uDE82\uDE90-\uDE95])\uFE0F|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDC8F\uDC91\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0F\uDD18-\uDD1F\uDD26\uDD30-\uDD39\uDD3C-\uDD3E\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD])/g}},function(e,t,n){"use strict";const r=n(182),o=n(183),i=n(617),s={right:function alignRight(e,t){e=e.trim();const n=r(e);if(n<t)return" ".repeat(t-n)+e;return e},center:function alignCenter(e,t){e=e.trim();const n=r(e);if(n>=t)return e;return" ".repeat(t-n>>1)+e}};class UI{constructor(e){this.width=e.width,this.wrap=e.wrap,this.rows=[]}span(...e){this.div(...e).span=!0}resetOutput(){this.rows=[]}div(...e){if(0===e.length&&this.div(""),this.wrap&&this._shouldApplyLayoutDSL(...e))return this._applyLayoutDSL(e[0]);const t=e.map(e=>"string"==typeof e?this._colFromString(e):e);return this.rows.push(t),t}_shouldApplyLayoutDSL(...e){return 1===e.length&&"string"==typeof e[0]&&/[\t\n]/.test(e[0])}_applyLayoutDSL(e){const t=e.split("\n").map(e=>e.split("\t"));let n=0;return t.forEach(e=>{e.length>1&&r(e[0])>n&&(n=Math.min(Math.floor(.5*this.width),r(e[0])))}),t.forEach(e=>{this.div(...e.map((t,r)=>({text:t.trim(),padding:this._measurePadding(t),width:0===r&&e.length>1?n:void 0})))}),this.rows[this.rows.length-1]}_colFromString(e){return{text:e,padding:this._measurePadding(e)}}_measurePadding(e){const t=o(e);return[0,t.match(/\s*$/)[0].length,0,t.match(/^\s*/)[0].length]}toString(){const e=[];return this.rows.forEach(t=>{this.rowToString(t,e)}),e.filter(e=>!e.hidden).map(e=>e.text).join("\n")}rowToString(e,t){return this._rasterize(e).forEach((n,o)=>{let i="";n.forEach((n,a)=>{const{width:c}=e[a],u=this._negatePadding(e[a]);let l=n;u>r(n)&&(l+=" ".repeat(u-r(n))),e[a].align&&"left"!==e[a].align&&this.wrap&&(l=s[e[a].align](l,u),r(l)<u&&(l+=" ".repeat(c-r(l)-1)));const d=e[a].padding||[0,0,0,0];d[3]&&(i+=" ".repeat(d[3])),i+=addBorder(e[a],l,"| "),i+=l,i+=addBorder(e[a],l," |"),d[1]&&(i+=" ".repeat(d[1])),0===o&&t.length>0&&(i=this._renderInline(i,t[t.length-1]))}),t.push({text:i.replace(/ +$/,""),span:e.span})}),t}_renderInline(e,t){const n=e.match(/^ */)[0].length,o=t.text,i=r(o.trimRight());return t.span?this.wrap?n<i?e:(t.hidden=!0,o.trimRight()+" ".repeat(n-i)+e.trimLeft()):(t.hidden=!0,o+e):e}_rasterize(e){const t=[],n=this._columnWidths(e);let r;return e.forEach((e,o)=>{e.width=n[o],r=this.wrap?i(e.text,this._negatePadding(e),{hard:!0}).split("\n"):e.text.split("\n"),e.border&&(r.unshift("."+"-".repeat(this._negatePadding(e)+2)+"."),r.push("'"+"-".repeat(this._negatePadding(e)+2)+"'")),e.padding&&(r.unshift(...new Array(e.padding[0]||0).fill("")),r.push(...new Array(e.padding[2]||0).fill(""))),r.forEach((e,n)=>{t[n]||t.push([]);const r=t[n];for(let e=0;e<o;e++)void 0===r[e]&&r.push("");r.push(e)})}),t}_negatePadding(e){let t=e.width;return e.padding&&(t-=(e.padding[3]||0)+(e.padding[1]||0)),e.border&&(t-=4),t}_columnWidths(e){if(!this.wrap)return e.map(e=>e.width||r(e.text));let t=e.length,n=this.width;const o=e.map(e=>{if(e.width)return t--,n-=e.width,e.width}),i=t?Math.floor(n/t):0;return o.map((t,n)=>void 0===t?Math.max(i,function _minWidth(e){const t=e.padding||[],n=1+(t[3]||0)+(t[1]||0);if(e.border)return n+4;return n}(e[n])):t)}}function addBorder(e,t,n){return e.border?/[.']-+[.']/.test(t)?"":0!==t.trim().length?n:"  ":""}function getWindowWidth(){if("object"==typeof process&&process.stdout&&process.stdout.columns)return process.stdout.columns}e.exports=function(e={}){return new UI({width:e.width||getWindowWidth()||80,wrap:!1!==e.wrap})}},function(e,t,n){"use strict";const r=n(182),o=n(183),i=n(618),s=new Set(["",""]),wrapAnsi=e=>`${s.values().next().value}[${e}m`,wrapWord=(e,t,n)=>{const i=[...t];let a=!1,c=r(o(e[e.length-1]));for(const[t,o]of i.entries()){const u=r(o);if(c+u<=n?e[e.length-1]+=o:(e.push(o),c=0),s.has(o))a=!0;else if(a&&"m"===o){a=!1;continue}a||(c+=u,c===n&&t<i.length-1&&(e.push(""),c=0))}!c&&e[e.length-1].length>0&&e.length>1&&(e[e.length-2]+=e.pop())},stringVisibleTrimSpacesRight=e=>{const t=e.split(" ");let n=t.length;for(;n>0&&!(r(t[n-1])>0);)n--;return n===t.length?e:t.slice(0,n).join(" ")+t.slice(n).join("")},exec=(e,t,n={})=>{if(!1!==n.trim&&""===e.trim())return"";let o,a="",c="";const u=(e=>e.split(" ").map(e=>r(e)))(e);let l=[""];for(const[o,i]of e.split(" ").entries()){!1!==n.trim&&(l[l.length-1]=l[l.length-1].trimLeft());let e=r(l[l.length-1]);if(0!==o&&(e>=t&&(!1===n.wordWrap||!1===n.trim)&&(l.push(""),e=0),(e>0||!1===n.trim)&&(l[l.length-1]+=" ",e++)),n.hard&&u[o]>t){const n=t-e,r=1+Math.floor((u[o]-n-1)/t);Math.floor((u[o]-1)/t)<r&&l.push(""),wrapWord(l,i,t)}else{if(e+u[o]>t&&e>0&&u[o]>0){if(!1===n.wordWrap&&e<t){wrapWord(l,i,t);continue}l.push("")}e+u[o]>t&&!1===n.wordWrap?wrapWord(l,i,t):l[l.length-1]+=i}}!1!==n.trim&&(l=l.map(stringVisibleTrimSpacesRight)),a=l.join("\n");for(const[e,t]of[...a].entries()){if(c+=t,s.has(t)){const t=parseFloat(/\d[^m]*/.exec(a.slice(e,e+4)));o=39===t?null:t}const n=i.codes.get(Number(o));o&&n&&("\n"===a[e+1]?c+=wrapAnsi(n):"\n"===t&&(c+=wrapAnsi(o)))}return c};e.exports=(e,t,n)=>String(e).normalize().replace(/\r\n/g,"\n").split("\n").map(e=>exec(e,t,n)).join("\n")},function(e,t,n){"use strict";(function(e){const wrapAnsi16=(e,t)=>(...n)=>`[${e(...n)+t}m`,wrapAnsi256=(e,t)=>(...n)=>{const r=e(...n);return`[${38+t};5;${r}m`},wrapAnsi16m=(e,t)=>(...n)=>{const r=e(...n);return`[${38+t};2;${r[0]};${r[1]};${r[2]}m`},ansi2ansi=e=>e,rgb2rgb=(e,t,n)=>[e,t,n],setLazyProperty=(e,t,n)=>{Object.defineProperty(e,t,{get:()=>{const r=n();return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0}),r},enumerable:!0,configurable:!0})};let t;const makeDynamicStyles=(e,r,o,i)=>{void 0===t&&(t=n(619));const s=i?10:0,a={};for(const[n,i]of Object.entries(t)){const t="ansi16"===n?"ansi":n;n===r?a[t]=e(o,s):"object"==typeof i&&(a[t]=e(i[r],s))}return a};Object.defineProperty(e,"exports",{enumerable:!0,get:function assembleStyles(){const e=new Map,t={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};t.color.gray=t.color.blackBright,t.bgColor.bgGray=t.bgColor.bgBlackBright,t.color.grey=t.color.blackBright,t.bgColor.bgGrey=t.bgColor.bgBlackBright;for(const[n,r]of Object.entries(t)){for(const[n,o]of Object.entries(r))t[n]={open:`[${o[0]}m`,close:`[${o[1]}m`},r[n]=t[n],e.set(o[0],o[1]);Object.defineProperty(t,n,{value:r,enumerable:!1})}return Object.defineProperty(t,"codes",{value:e,enumerable:!1}),t.color.close="[39m",t.bgColor.close="[49m",setLazyProperty(t.color,"ansi",()=>makeDynamicStyles(wrapAnsi16,"ansi16",ansi2ansi,!1)),setLazyProperty(t.color,"ansi256",()=>makeDynamicStyles(wrapAnsi256,"ansi256",ansi2ansi,!1)),setLazyProperty(t.color,"ansi16m",()=>makeDynamicStyles(wrapAnsi16m,"rgb",rgb2rgb,!1)),setLazyProperty(t.bgColor,"ansi",()=>makeDynamicStyles(wrapAnsi16,"ansi16",ansi2ansi,!0)),setLazyProperty(t.bgColor,"ansi256",()=>makeDynamicStyles(wrapAnsi256,"ansi256",ansi2ansi,!0)),setLazyProperty(t.bgColor,"ansi16m",()=>makeDynamicStyles(wrapAnsi16m,"rgb",rgb2rgb,!0)),t}})}).call(this,n(34)(e))},function(e,t,n){const r=n(284),o=n(621),i={};Object.keys(r).forEach(e=>{i[e]={},Object.defineProperty(i[e],"channels",{value:r[e].channels}),Object.defineProperty(i[e],"labels",{value:r[e].labels});const t=o(e);Object.keys(t).forEach(n=>{const r=t[n];i[e][n]=function wrapRounded(e){const wrappedFn=function(...t){const n=t[0];if(null==n)return n;n.length>1&&(t=n);const r=e(t);if("object"==typeof r)for(let e=r.length,t=0;t<e;t++)r[t]=Math.round(r[t]);return r};return"conversion"in e&&(wrappedFn.conversion=e.conversion),wrappedFn}(r),i[e][n].raw=function wrapRaw(e){const wrappedFn=function(...t){const n=t[0];return null==n?n:(n.length>1&&(t=n),e(t))};return"conversion"in e&&(wrappedFn.conversion=e.conversion),wrappedFn}(r)})}),e.exports=i},function(e,t,n){"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(e,t,n){const r=n(284);function deriveBFS(e){const t=function buildGraph(){const e={},t=Object.keys(r);for(let n=t.length,r=0;r<n;r++)e[t[r]]={distance:-1,parent:null};return e}(),n=[e];for(t[e].distance=0;n.length;){const e=n.pop(),o=Object.keys(r[e]);for(let r=o.length,i=0;i<r;i++){const r=o[i],s=t[r];-1===s.distance&&(s.distance=t[e].distance+1,s.parent=e,n.unshift(r))}}return t}function link(e,t){return function(n){return t(e(n))}}function wrapConversion(e,t){const n=[t[e].parent,e];let o=r[t[e].parent][e],i=t[e].parent;for(;t[i].parent;)n.unshift(t[i].parent),o=link(r[t[i].parent][i],o),i=t[i].parent;return o.conversion=n,o}e.exports=function(e){const t=deriveBFS(e),n={},r=Object.keys(t);for(let e=r.length,o=0;o<e;o++){const e=r[o];null!==t[e].parent&&(n[e]=wrapConversion(e,t))}return n}},function(e,t,n){"use strict";const r=n(181),o=n(184),i=["$0","--","_"];e.exports=function validation(e,t,s){const a=s.__,c=s.__n,u={nonOptionCount:function nonOptionCount(n){const r=e.getDemandedCommands(),o=n._.length-e.getContext().commands.length;r._&&(o<r._.min||o>r._.max)&&(o<r._.min?void 0!==r._.minMsg?t.fail(r._.minMsg?r._.minMsg.replace(/\$0/g,o).replace(/\$1/,r._.min):null):t.fail(c("Not enough non-option arguments: got %s, need at least %s","Not enough non-option arguments: got %s, need at least %s",o,o,r._.min)):o>r._.max&&(void 0!==r._.maxMsg?t.fail(r._.maxMsg?r._.maxMsg.replace(/\$0/g,o).replace(/\$1/,r._.max):null):t.fail(c("Too many non-option arguments: got %s, maximum of %s","Too many non-option arguments: got %s, maximum of %s",o,o,r._.max))))},positionalCount:function positionalCount(e,n){n<e&&t.fail(c("Not enough non-option arguments: got %s, need at least %s","Not enough non-option arguments: got %s, need at least %s",n,n,e))},requiredArguments:function requiredArguments(n){const r=e.getDemandedOptions();let o=null;if(Object.keys(r).forEach(e=>{Object.prototype.hasOwnProperty.call(n,e)&&void 0!==n[e]||(o=o||{},o[e]=r[e])}),o){const e=[];Object.keys(o).forEach(t=>{const n=o[t];n&&e.indexOf(n)<0&&e.push(n)});const n=e.length?"\n"+e.join("\n"):"";t.fail(c("Missing required argument: %s","Missing required arguments: %s",Object.keys(o).length,Object.keys(o).join(", ")+n))}},unknownArguments:function unknownArguments(n,r,o){const s=e.getCommandInstance().getCommands(),a=[],l=e.getContext();Object.keys(n).forEach(t=>{-1!==i.indexOf(t)||Object.prototype.hasOwnProperty.call(o,t)||Object.prototype.hasOwnProperty.call(e._getParseContext(),t)||u.isValidAndSomeAliasIsNotNew(t,r)||a.push(t)}),(l.commands.length>0||s.length>0)&&n._.slice(l.commands.length).forEach(e=>{-1===s.indexOf(e)&&a.push(e)}),a.length>0&&t.fail(c("Unknown argument: %s","Unknown arguments: %s",a.length,a.join(", ")))},unknownCommands:function unknownCommands(n,r,o){const i=e.getCommandInstance().getCommands(),s=[],a=e.getContext();return(a.commands.length>0||i.length>0)&&n._.slice(a.commands.length).forEach(e=>{-1===i.indexOf(e)&&s.push(e)}),s.length>0&&(t.fail(c("Unknown command: %s","Unknown commands: %s",s.length,s.join(", "))),!0)},isValidAndSomeAliasIsNotNew:function isValidAndSomeAliasIsNotNew(t,n){if(!Object.prototype.hasOwnProperty.call(n,t))return!1;const r=e.parsed.newAliases;for(const e of[t,...n[t]])if(!Object.prototype.hasOwnProperty.call(r,e)||!r[t])return!0;return!1},limitedChoices:function limitedChoices(n){const r=e.getOptions(),o={};if(!Object.keys(r.choices).length)return;Object.keys(n).forEach(e=>{-1===i.indexOf(e)&&Object.prototype.hasOwnProperty.call(r.choices,e)&&[].concat(n[e]).forEach(t=>{-1===r.choices[e].indexOf(t)&&void 0!==t&&(o[e]=(o[e]||[]).concat(t))})});const s=Object.keys(o);if(!s.length)return;let c=a("Invalid values:");s.forEach(e=>{c+="\n  "+a("Argument: %s, Given: %s, Choices: %s",e,t.stringifiedValues(o[e]),t.stringifiedValues(r.choices[e]))}),t.fail(c)}};let l=[];u.check=function check(e,t){l.push({func:e,global:t})},u.customChecks=function customChecks(e,n){for(let r,o=0;void 0!==(r=l[o]);o++){const o=r.func;let i=null;try{i=o(e,n)}catch(e){t.fail(e.message?e.message:e,e);continue}i?("string"==typeof i||i instanceof Error)&&t.fail(i.toString(),i):t.fail(a("Argument check failed: %s",o.toString()))}};let d={};function keyExists(e,t){const n=Number(t);return t="number"==typeof(t=isNaN(n)?t:n)?e._.length>=t:t.match(/^--no-.+/)?!e[t=t.match(/^--no-(.+)/)[1]]:e[t]}u.implies=function implies(t,n){r("<string|object> [array|number|string]",[t,n],arguments.length),"object"==typeof t?Object.keys(t).forEach(e=>{u.implies(e,t[e])}):(e.global(t),d[t]||(d[t]=[]),Array.isArray(n)?n.forEach(e=>u.implies(t,e)):d[t].push(n))},u.getImplied=function getImplied(){return d},u.implications=function implications(e){const n=[];if(Object.keys(d).forEach(t=>{const r=t;(d[t]||[]).forEach(t=>{let o=r;const i=t;o=keyExists(e,o),t=keyExists(e,t),o&&!t&&n.push(` ${r} -> ${i}`)})}),n.length){let e=a("Implications failed:")+"\n";n.forEach(t=>{e+=t}),t.fail(e)}};let p={};u.conflicts=function conflicts(t,n){r("<string|object> [array|string]",[t,n],arguments.length),"object"==typeof t?Object.keys(t).forEach(e=>{u.conflicts(e,t[e])}):(e.global(t),p[t]||(p[t]=[]),Array.isArray(n)?n.forEach(e=>u.conflicts(t,e)):p[t].push(n))},u.getConflicting=()=>p,u.conflicting=function conflictingFn(e){Object.keys(e).forEach(n=>{p[n]&&p[n].forEach(r=>{r&&void 0!==e[n]&&void 0!==e[r]&&t.fail(a("Arguments %s and %s are mutually exclusive",n,r))})})},u.recommendCommands=function recommendCommands(e,r){const o=n(623);r=r.sort((e,t)=>t.length-e.length);let i=null,s=1/0;for(let t,n=0;void 0!==(t=r[n]);n++){const n=o(e,t);n<=3&&n<s&&(s=n,i=t)}i&&t.fail(a("Did you mean %s?",i))},u.reset=function reset(e){return d=o(d,(t,n)=>!e[t]),p=o(p,(t,n)=>!e[t]),l=l.filter(e=>e.global),u};const h=[];return u.freeze=function freeze(){const e={};h.push(e),e.implied=d,e.checks=l,e.conflicting=p},u.unfreeze=function unfreeze(){const e=h.pop();d=e.implied,l=e.checks,p=e.conflicting},u}},function(e,t,n){"use strict";e.exports=function levenshtein(e,t){if(0===e.length)return t.length;if(0===t.length)return e.length;const n=[];let r,o;for(r=0;r<=t.length;r++)n[r]=[r];for(o=0;o<=e.length;o++)n[0][o]=o;for(r=1;r<=t.length;r++)for(o=1;o<=e.length;o++)t.charAt(r-1)===e.charAt(o-1)?n[r][o]=n[r-1][o-1]:n[r][o]=Math.min(n[r-1][o-1]+1,Math.min(n[r][o-1]+1,n[r-1][o]+1));return n[t.length][e.length]}},function(e,t,n){var r=n(21),o=n(11),i=n(12);function Y18N(e){e=e||{},this.directory=e.directory||"./locales",this.updateFiles="boolean"!=typeof e.updateFiles||e.updateFiles,this.locale=e.locale||"en",this.fallbackToLanguage="boolean"!=typeof e.fallbackToLanguage||e.fallbackToLanguage,this.cache=Object.create(null),this.writeQueue=[]}Y18N.prototype.__=function(){if("string"!=typeof arguments[0])return this._taggedLiteral.apply(this,arguments);var e=Array.prototype.slice.call(arguments),t=e.shift(),cb=function(){};return"function"==typeof e[e.length-1]&&(cb=e.pop()),cb=cb||function(){},this.cache[this.locale]||this._readLocaleFile(),!this.cache[this.locale][t]&&this.updateFiles?(this.cache[this.locale][t]=t,this._enqueueWrite([this.directory,this.locale,cb])):cb(),i.format.apply(i,[this.cache[this.locale][t]||t].concat(e))},Y18N.prototype._taggedLiteral=function(e){var t=arguments,n="";return e.forEach((function(e,r){var o=t[r+1];n+=e,void 0!==o&&(n+="%s")})),this.__.apply(null,[n].concat([].slice.call(arguments,1)))},Y18N.prototype._enqueueWrite=function(e){this.writeQueue.push(e),1===this.writeQueue.length&&this._processWriteQueue()},Y18N.prototype._processWriteQueue=function(){var e=this,t=this.writeQueue[0],n=t[0],o=t[1],i=t[2],s=this._resolveLocaleFile(n,o),a=JSON.stringify(this.cache[o],null,2);r.writeFile(s,a,"utf-8",(function(t){e.writeQueue.shift(),e.writeQueue.length>0&&e._processWriteQueue(),i(t)}))},Y18N.prototype._readLocaleFile=function(){var e={},t=this._resolveLocaleFile(this.directory,this.locale);try{e=JSON.parse(r.readFileSync(t,"utf-8"))}catch(n){if(n instanceof SyntaxError&&(n.message="syntax error in "+t),"ENOENT"!==n.code)throw n;e={}}this.cache[this.locale]=e},Y18N.prototype._resolveLocaleFile=function(e,t){var n=o.resolve(e,"./",t+".json");if(this.fallbackToLanguage&&!this._fileExistsSync(n)&&~t.lastIndexOf("_")){var r=o.resolve(e,"./",t.split("_")[0]+".json");this._fileExistsSync(r)&&(n=r)}return n},Y18N.prototype._fileExistsSync=function(e){try{return r.statSync(e).isFile()}catch(e){return!1}},Y18N.prototype.__n=function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),n=e.shift(),r=e.shift(),cb=function(){};"function"==typeof e[e.length-1]&&(cb=e.pop()),this.cache[this.locale]||this._readLocaleFile();var o=1===r?t:n;this.cache[this.locale][t]&&(o=this.cache[this.locale][t][1===r?"one":"other"]),!this.cache[this.locale][t]&&this.updateFiles?(this.cache[this.locale][t]={one:t,other:n},this._enqueueWrite([this.directory,this.locale,cb])):cb();var s=[o];return~o.indexOf("%d")&&s.push(r),i.format.apply(i,s.concat(e))},Y18N.prototype.setLocale=function(e){this.locale=e},Y18N.prototype.getLocale=function(){return this.locale},Y18N.prototype.updateLocale=function(e){for(var t in this.cache[this.locale]||this._readLocaleFile(),e)this.cache[this.locale][t]=e[t]},e.exports=function(e){var t=new Y18N(e);for(var n in t)"function"==typeof t[n]&&(t[n]=t[n].bind(t));return t}},function(e,t,n){"use strict";const r=n(21),o=n(11),i=n(132);let s=[];e.exports=function applyExtends(e,t,a){let c={};if(Object.prototype.hasOwnProperty.call(e,"extends")){if("string"!=typeof e.extends)return c;const u=/\.json|\..*rc$/.test(e.extends);let l=null;if(u)l=function getPathToDefaultConfig(e,t){return o.resolve(e,t)}(t,e.extends);else try{l=n(285).resolve(e.extends)}catch(e){}if(!l&&!u)return e;!function checkForCircularExtends(e){if(s.indexOf(e)>-1)throw new i(`Circular extended configurations: '${e}'.`)}(l),s.push(l),c=u?JSON.parse(r.readFileSync(l,"utf8")):n(285)(e.extends),delete e.extends,c=applyExtends(c,o.dirname(l),a)}return s=[],a?function mergeDeep(e,t){const n={},isObject=e=>e&&"object"==typeof e&&!Array.isArray(e);Object.assign(n,e);for(const r of Object.keys(t))isObject(t[r])&&isObject(n[r])?n[r]=mergeDeep(e[r],t[r]):n[r]=t[r];return n}(c,e):Object.assign({},c,e)}},function(e,t,n){"use strict";e.exports=function getCallerFile(e){if(void 0===e&&(e=2),e>=Error.stackTraceLimit)throw new TypeError("getCallerFile(position) requires position be less then Error.stackTraceLimit but position was: `"+e+"` and Error.stackTraceLimit was: `"+Error.stackTraceLimit+"`");var t=Error.prepareStackTrace;Error.prepareStackTrace=function(e,t){return t};var n=(new Error).stack;if(Error.prepareStackTrace=t,null!==n&&"object"==typeof n)return n[e]?n[e].getFileName():void 0}},function(e,t,n){"use strict";const r=n(11),o=n(628),i=n(632),s=Symbol("findUp.stop");e.exports=async(e,t={})=>{let n=r.resolve(t.cwd||"");const{root:i}=r.parse(n),a=[].concat(e),runMatcher=async t=>{if("function"!=typeof e)return o(a,t);const n=await e(t.cwd);return"string"==typeof n?o([n],t):n};for(;;){const e=await runMatcher({...t,cwd:n});if(e===s)return;if(e)return r.resolve(n,e);if(n===i)return;n=r.dirname(n)}},e.exports.sync=(e,t={})=>{let n=r.resolve(t.cwd||"");const{root:i}=r.parse(n),a=[].concat(e),runMatcher=t=>{if("function"!=typeof e)return o.sync(a,t);const n=e(t.cwd);return"string"==typeof n?o.sync([n],t):n};for(;;){const e=runMatcher({...t,cwd:n});if(e===s)return;if(e)return r.resolve(n,e);if(n===i)return;n=r.dirname(n)}},e.exports.exists=i,e.exports.sync.exists=i.sync,e.exports.stop=s},function(e,t,n){"use strict";const r=n(11),o=n(21),{promisify:i}=n(12),s=n(629),a=i(o.stat),c=i(o.lstat),u={directory:"isDirectory",file:"isFile"};function checkType({type:e}){if(!(e in u))throw new Error("Invalid type specified: "+e)}const matchType=(e,t)=>void 0===e||t[u[e]]();e.exports=async(e,t)=>{checkType(t={cwd:process.cwd(),type:"file",allowSymlinks:!0,...t});const n=t.allowSymlinks?a:c;return s(e,async e=>{try{const o=await n(r.resolve(t.cwd,e));return matchType(t.type,o)}catch(e){return!1}},t)},e.exports.sync=(e,t)=>{checkType(t={cwd:process.cwd(),allowSymlinks:!0,type:"file",...t});const n=t.allowSymlinks?o.statSync:o.lstatSync;for(const o of e)try{const e=n(r.resolve(t.cwd,o));if(matchType(t.type,e))return o}catch(e){}}},function(e,t,n){"use strict";const r=n(630);class EndError extends Error{constructor(e){super(),this.value=e}}const testElement=async(e,t)=>t(await e),finder=async e=>{const t=await Promise.all(e);if(!0===t[1])throw new EndError(t[0]);return!1},pLocate=async(e,t,n)=>{n={concurrency:1/0,preserveOrder:!0,...n};const o=r(n.concurrency),i=[...e].map(e=>[e,o(testElement,e,t)]),s=r(n.preserveOrder?1:1/0);try{await Promise.all(i.map(e=>s(finder,e)))}catch(e){if(e instanceof EndError)return e.value;throw e}};e.exports=pLocate,e.exports.default=pLocate},function(e,t,n){"use strict";const r=n(631),pLimit=e=>{if(!Number.isInteger(e)&&e!==1/0||!(e>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));const t=[];let n=0;const next=()=>{n--,t.length>0&&t.shift()()},run=(e,t,...o)=>{n++;const i=r(e,...o);t(i),i.then(next,next)},generator=(r,...o)=>new Promise(i=>((r,o,...i)=>{n<e?run(r,o,...i):t.push(run.bind(null,r,o,...i))})(r,i,...o));return Object.defineProperties(generator,{activeCount:{get:()=>n},pendingCount:{get:()=>t.length},clearQueue:{value:()=>{t.length=0}}}),generator};e.exports=pLimit,e.exports.default=pLimit},function(e,t,n){"use strict";const pTry=(e,...t)=>new Promise(n=>{n(e(...t))});e.exports=pTry,e.exports.default=pTry},function(e,t,n){"use strict";const r=n(21),{promisify:o}=n(12),i=o(r.access);e.exports=async e=>{try{return await i(e),!0}catch(e){return!1}},e.exports.sync=e=>{try{return r.accessSync(e),!0}catch(e){return!1}}},function(e,t,n){e.exports=function(e){var t=(e=e||n(634)).main;return t&&function isIISNode(e){return/\\iisnode\\/.test(e.filename)}(t)?function handleIISNode(e){return e.children.length?e.children[0].filename:e.filename}(t):t?t.filename:process.cwd()}},function(e,t){function webpackEmptyContext(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,e.exports=webpackEmptyContext,webpackEmptyContext.id=634},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(636),i=n(1339),s=r(n(21)),a=r(n(11)),c=n(91),u=n(1340);function spaceToTabs(e){return e.replace(/^ +/gm,e=>e.replace(/( {2})/g,"\t"))}t.init=function init(e,t){c.registerServices(e,[o.PIMLocalService,i.PIMDrawingService],t)},t.generate=function generate(e){console.info("Generating PIMLocalService interface");const t=u.generateCode(o.PIMLocalService);s.default.writeFileSync(a.default.join(e,t.className+".h"),spaceToTabs(t.header)),s.default.writeFileSync(a.default.join(e,t.className+".cpp"),spaceToTabs(t.code)),s.default.writeFileSync(a.default.join(e,t.className+".ts"),t.tscode),s.default.writeFileSync(a.default.join(e,t.className+"Utils.h"),spaceToTabs(t.utils)),console.info("Generating PIMDrawingService interface");const n=u.generateCode(i.PIMDrawingService);s.default.writeFileSync(a.default.join(e,n.className+".h"),spaceToTabs(n.header)),s.default.writeFileSync(a.default.join(e,n.className+".cpp"),spaceToTabs(n.code)),s.default.writeFileSync(a.default.join(e,n.className+".ts"),n.tscode),s.default.writeFileSync(a.default.join(e,n.className+"Utils.h"),spaceToTabs(n.utils))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),o=n(516),i=n(537),s=n(538),a=n(541),c=n(542),u=n(1296),l=n(56),d=n(1338),p=n(44),h=n(53),m=n(536);t.PIMLocalService={name:"PIMLocalService",constants:{EntityType:r.EntityTypes,AttributeKey:i.AttributeKeys,DocumentOperationState:h.DocumentOperationState,MigrationType:m.MigrationType},functions:{getVersionInfo:{handler:l.getVersionInfoHandler,arguments:[]},setProxy:{handler:l.setProxyHandler,arguments:["data:object"]},createItem:{handler:l.createItemHandler,arguments:["assetTypeId:string","name:istring","components:ComponentMap"]},getProduct:{handler:l.getItemHandler,arguments:["productUrn:string","snapshotUrn:string"]},getItem:{handler:l.getItemHandler,arguments:["itemUrn:string","snapshotUrn:string"]},patchProduct:{handler:l.patchItemHandler,arguments:["productUrn:string","patch:JSONPatch","doSave:boolean"],noPayload:!0},patchItem:{handler:l.patchItemHandler,arguments:["itemUrn:string","patch:JSONPatch","doSave:boolean"],noPayload:!0},deleteItem:{handler:l.deleteItemHandler,arguments:["itemUrn:string"],noPayload:!0},createAsset:{handler:l.createAssetHandler,arguments:["productUrn:string","assetTypeId:string","name:istring","components:ComponentMap"]},getAsset:{handler:l.getAssetHandler,arguments:["assetUrn:string","snapshotUrn:string"]},patchAsset:{handler:l.patchAssetHandler,arguments:["assetUrn:string","patch:JSONPatch","doSave:boolean"],noPayload:!0},deleteAsset:{handler:l.deleteAssetHandler,arguments:["assetUrn:string"],noPayload:!0},createRelationship:{handler:l.createRelationshipHandler,arguments:["fromUrn:string","toUrn:string","relationshipTypeId:string","name:istring","components:ComponentMap"]},getRelationship:{handler:l.getRelationshipHandler,arguments:["relationshipUrn:string"]},getRelationships:{handler:l.getRelationshipsHandler,arguments:["assetUrn:string","toTypeid:string"]},patchRelationship:{handler:l.patchRelationshipHandler,arguments:["relationshipUrn:string","patch:JSONPatch","doSave:boolean"],noPayload:!0},deleteRelationship:{handler:l.deleteRelationshipHandler,arguments:["relationshipUrn:string"],noPayload:!0},snapshot:{handler:l.snapshotHandler,arguments:["urnToSnapshot:string"]},getVersionSnapshotId:{handler:l.getVersionSnapshotIdHandler,arguments:["wipVersionUrn:string"]},getEntityInitStatus:{handler:l.getEntityInitStatusHandler,arguments:["entityUrn:string","entityType:string"]},getEntityAttribute:{handler:l.getEntityAttributeHandler,arguments:["entityUrn:string","entityType:string","name:string"]},setEntityAttribute:{handler:l.setEntityAttributeHandler,arguments:["entityUrn:string","entityType:string","name:string","value:string"]},softDelete:{handler:l.softDeleteHandler,arguments:["assetUrn:string","isDeleted:boolean"],noPayload:!0},createAssemblyRef:{handler:l.createAssemblyRefHandler,arguments:["fromUrn:string","toUrn:string","typeId:string","fromSnapshotUrn:string","toSnapshotUrn:string","components:ComponentMap"]},readAssemblyRef:{handler:l.readAssemblyRefHandler,arguments:["assemblyRefUrn:string"]},findAssemblyRefs:{handler:l.findAssemblyRefsHandler,arguments:["assetUrn:string"]},deleteAssemblyRef:{handler:l.deleteAssemblyRefHandler,arguments:["assemblyRefUrn:string"],noPayload:!0},createRepo:{handler:l.createRepoHandler,arguments:[]},performanceTest:{handler:l.performanceTestHandler,arguments:["filePath:string","testName:string","newRelicUrl:string","newRelicKey:string"]},batchSave:{handler:l.batchSaveHandler,arguments:["batchSaveData:object"]},batchCreateProduct:{handler:l.batchCreateProduct,arguments:["batchCreateProductData:object"]},batchCreateAssemblyRefs:{handler:l.batchCreateAssemblyRefs,arguments:["batchCreateAssemblyRefData:object"]},documentFullyOpened:{handler:s.documentFullyOpenedHandler,arguments:["data:object"]},assetClosing:{handler:s.assetClosingHandler,arguments:["data:object"]},reconcileCache:{handler:l.reconcileCacheHandler,arguments:["lineageUrn:string"]},documentClosed:{handler:s.documentClosedHandler,arguments:["data:object"]},documentDeleted:{handler:s.documentDeletedHandler,arguments:["data:object"]},documentSaved:{handler:s.documentSavedHandler,arguments:["data:object"]},documentUploaded:{handler:a.designUploadedHandler,arguments:["data:object"]},documentFileUploaded:{handler:s.documentFileUploadedHandler,arguments:["data:object"]},documentOpened:{handler:s.documentOpenedHandler,arguments:["data:object"]},hubSwitched:{handler:s.hubSwitchedHandler,arguments:["data:object"]},featureFlagsDownloaded:{handler:s.featureFlagsDownloadedHandler,arguments:["data:object"]},preDocumentClose:{handler:s.preDocumentCloseHandler,arguments:["data:object"]},preDocumentDelete:{handler:s.preDocumentDeleteHandler,arguments:["data:object"]},preDocumentSave:{handler:s.preDocumentSaveHandler,arguments:["data:object"]},documentDirtied:{handler:u.fremontEventStub("documentDirtied"),arguments:["data:object"]},documentCreated:{handler:u.fremontEventStub("documentCreated"),arguments:["data:object"]},preDocumentUpload:{handler:c.preDesignUploadHandler,arguments:["data:object"]},getAuditInfo:{handler:l.getAuditInfo,arguments:["wipVersionUrn:string"]},getLatestReleaseData:{handler:l.getLatestReleaseDataHandler,arguments:["wipLineageUrn:string","targetComponentId:string","wipVersionUrn:string"]},getRootProduct:{handler:l.getRootProductHandler,arguments:["wipLineageUrn:string","fetch:boolean"]},waitSynchronization:{handler:d.waitSynchronization,arguments:[]},getFremontCommand:{handler:p.getFremontCommand,arguments:["commandID:string"]},awaitCommand:{handler:p.awaitCommand,arguments:["commandID:string"]},getDocumentStatus:{handler:l.getDocumentStatus,arguments:["documentId:string"]},assignItemNumber:{handler:l.assignItemNumber,arguments:["data:object"]},quickRelease:{handler:l.quickRelease,arguments:["data:object"]},createMilestone:{handler:s.createMilestoneHandler,arguments:["data:object"]},fremontTextCommand:{handler:o.fremontTextCommand,arguments:["params:object"]},getAssemblyPIMData:{handler:l.getAssemblyPIMDataHandler,arguments:["wipVersionUrn:string","options:object"]},triggerMigration:{handler:l.triggerMigration,arguments:["parameters:object"]}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(638),n(1121),n(1122),n(1123),n(1124),n(1125),n(1126),n(1127),n(1128),n(1129),n(1130),n(1131),n(1132),n(1133),n(1134),n(1135),n(1136),n(1137),n(1138),n(116),n(1141),n(1147),n(1148),n(1149),n(1150),n(1151),n(1152),n(1153),n(1154),n(1160),n(1161),n(1162),n(1163),n(1164),n(1165),n(1166),n(1167),n(1168),n(501),n(1171),n(1172),n(1173),n(1174),n(1175),n(1176)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(3),o=n(0),i=n(9),s=n(1),a=n(32),c=n(17),u=n(23),l=n(3),d=n(4),p=n(52),h=n(27),m=n(10),y=n(492);d.failIfExistsOnSDK("pimCreateAssemblyRef"),o.FDModelingSDK.prototype.pimCreateAssemblyRef=async function(e,t,n,r,o){r=r||{};const a=p.getSkipValidation(o);if(l.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),t=await i.toAsset(this,e,t,{fetch:!a}),n=await i.toAsset(this,e,n,{fetch:!a}),!a){if(!await p.createAssemblyRefValidator(t,n))throw new c.PimError(c.GEN_ERROR_COMMAND,"Could not create the assemblyRef on this asset")}const m=r&&r.assemblyRef&&r.assemblyRef.typeid||s.schemaTypes.Product_RelationshipAssemblyRef_V1_0_0.typeid,y=d.getSkipCommit(o);let g;if(y||this.beginBatch(),g=r.toModelSnapshot||r.fromModelSnapshot?t.createPinnedRelationship(n,{toSnapshotId:r.toModelSnapshot,fromSnapshotId:r.fromModelSnapshot,typeId:m}):t.createRelationship(n,m),o&&o.additionalInfo&&h.addAdditionalInfo([g],o.additionalInfo),u.populateEntity(g,r.assemblyRef),!y){const e=await this.endBatch();d.validateBatchResult(e)}return{assemblyRef:g}},d.failIfExistsOnSDK("pimBatchCreateAssemblyRefs"),t.queryExternalAssemblyRefs=async(e,t,n,r,o)=>{const i=await e.getAsset(n,t),a=await i.getSpace(),c={startAssets:r.map(e=>({asset:n,snapshotContext:e})),relationshipFilters:[{type:{name:s.PIM_CONTAINS_RELATIONSHIP_TYPENAME},direction:"OUT"},{type:{name:s.PIM_ASSEMBLYREF_RELATIONSHIP_TYPENAME},direction:"OUT"}],maxDepth:0,include:{assetAttributes:!1,assetComponents:!1,relationshipAttributes:!0,relationshipComponents:!0}};return{assemblyRefs:(await a.getClosureV2(c)).getRelationships().filter(t=>y.isExternalAssemblyRef(e,t,r))}};const createAssemblyRefsInBatch=async(e,t,n,r)=>{e.beginBatch();const o=await e.getSpaceCollection(t,{fetch:!1}),i=[];for(const t of n){const n=await e.pimCreateAssemblyRef(o,t.fromModelId,t.toModelId,{fromModelSnapshot:t.fromModelSnapshotId,toModelSnapshot:t.toModelSnapshotId,assemblyRef:t.assemblyRef},{skipValidation:!0,skipCommit:!0,additionalInfo:t.additionalInfo});i.push(n.assemblyRef)}const s=await e.endBatch();try{d.validateBatchResult(s)}catch(e){throw await d.purgeEntities(i,r),e}return{assemblyRefs:i}};t.detectAndDeleteDuplicatedExternalAssemblyRefs=async(e,n,r,o,i)=>{const s=await t.queryExternalAssemblyRefs(e,n,r,o,i),a=[],c=[];return s.assemblyRefs.forEach(t=>{a.find(n=>{const r=e.pimGetComponentProxy(t,m.ComponentKeys.COMPONENT_INSTANCE),o=e.pimGetComponentProxy(n,m.ComponentKeys.COMPONENT_INSTANCE);return n.fromId===t.fromId&&n.fromSnapshotId===t.fromSnapshotId&&n.toId===t.toId&&n.toSnapshotId===t.toSnapshotId&&o.index===r.index})?c.push(t):a.push(t)}),c.length>0&&i&&i(`Detect duplicated assembly refs ${c.length} for product Id ${r}, trying deleting `),await Promise.all(c.map(e=>e.delete())),c},t.createExternalAssemblyRefsWithDuplicatedFiltered=async(e,n,r,o,i,s)=>{const a=await t.queryExternalAssemblyRefs(e,n,r,o,s),c=i.filter(t=>!(a.assemblyRefs||[]).find(n=>{n=n||{};const r=e.pimGetComponentProxy(n,m.ComponentKeys.COMPONENT_INSTANCE).index,o=t.assemblyRef&&t.assemblyRef.components&&t.assemblyRef.components.componentInstance&&t.assemblyRef.components.componentInstance.value&&t.assemblyRef.components.componentInstance.value.index||-1;return t.fromModelId===n.fromId&&t.fromModelSnapshotId===n.fromSnapshotId&&t.toModelId===n.toId&&t.toModelSnapshotId===n.toSnapshotId&&o===r}));return s&&s(`[createAssemblyRefsWithDuplicatedFiltered] Creating ${c.length} assembly refs for root product ${r}.`),await e.pimBatchCreateAssemblyRefs(n,c)},o.FDModelingSDK.prototype.pimBatchCreateAssemblyRefs=async function(e,t){const n=[],o=r.getLogger(this);try{const i=this._pimData.connectOptions.maxCommandsInParallel?this._pimData.connectOptions.maxCommandsInParallel:a.DEFAULT_MAX_COMMANDS_IN_PARALLEL,s=l.chunk(t,i),c=l.isString(e)?e:e.getId();for(const e of s){const t=l.chunk(e,a.BATCH_LIMIT);await Promise.all(t.map(async e=>{const t=this.getNewInstanceExperimental(),i=await r.retry(()=>createAssemblyRefsInBatch(t,c,e,o),o);n.push(...i.assemblyRefs)}))}return{assemblyRefs:n}}catch(e){throw await d.purgeEntities(n,o),e}}},function(e,t,n){"use strict";function assign(e,t){for(const n in t)Object.defineProperty(e,n,{value:t[n],enumerable:!0,configurable:!0});return e}e.exports=function createError(e,t,n){if(!e||"string"==typeof e)throw new TypeError("Please pass an Error to err-code");n||(n={}),"object"==typeof t&&(n=t,t=void 0),null!=t&&(n.code=t);try{return assign(e,n)}catch(t){n.message=e.message,n.stack=e.stack;const ErrClass=function(){};return ErrClass.prototype=Object.create(Object.getPrototypeOf(e)),assign(new ErrClass,n)}}},function(e,t,n){var r=n(641);t.operation=function(e){var n=t.timeouts(e);return new r(n,{forever:e&&e.forever,unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var n in e)t[n]=e[n];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var r=[],o=0;o<t.retries;o++)r.push(this.createTimeout(o,t));return e&&e.forever&&!r.length&&r.push(this.createTimeout(o,t)),r.sort((function(e,t){return e-t})),r},t.createTimeout=function(e,t){var n=t.randomize?Math.random()+1:1,r=Math.round(n*t.minTimeout*Math.pow(t.factor,e));return r=Math.min(r,t.maxTimeout)},t.wrap=function(e,n,r){if(n instanceof Array&&(r=n,n=null),!r)for(var o in r=[],e)"function"==typeof e[o]&&r.push(o);for(var i=0;i<r.length;i++){var s=r[i],a=e[s];e[s]=function retryWrapper(r){var o=t.operation(n),i=Array.prototype.slice.call(arguments,1),s=i.pop();i.push((function(e){o.retry(e)||(e&&(arguments[0]=o.mainError()),s.apply(this,arguments))})),o.attempt((function(){r.apply(e,i)}))}.bind(e,a),e[s].options=n}}},function(e,t){function RetryOperation(e,t){"boolean"==typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=RetryOperation,RetryOperation.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts},RetryOperation.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timeouts=[],this._cachedTimeouts=null},RetryOperation.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var n=this._timeouts.shift();if(void 0===n){if(!this._cachedTimeouts)return!1;this._errors.splice(this._errors.length-1,this._errors.length),this._timeouts=this._cachedTimeouts.slice(0),n=this._timeouts.shift()}var r=this,o=setTimeout((function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout((function(){r._operationTimeoutCb(r._attempts)}),r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)}),n);return this._options.unref&&o.unref(),!0},RetryOperation.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){n._operationTimeoutCb()}),n._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},RetryOperation.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},RetryOperation.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},RetryOperation.prototype.start=RetryOperation.prototype.try,RetryOperation.prototype.errors=function(){return this._errors},RetryOperation.prototype.attempts=function(){return this._attempts},RetryOperation.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,n=0,r=0;r<this._errors.length;r++){var o=this._errors[r],i=o.message,s=(e[i]||0)+1;e[i]=s,s>=n&&(t=o,n=s)}return t}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(133)),s=n(58),a=n(14),c=n(148),u=n(312),l=n(6),d=n(81),p=n(396);class FDModelingSDK{constructor(e,t,n,r,o,i){this._propertyFactory=n,this.logger=r,this.connectionOptions=e,this.journals=o,this.tracingOptions=i,this.core=new c.SDKCore(t,n,r,this.tracingOptions)}static initialize(e,t,n,r,o,i){const a=o||new l.NoOpLogger,c=new s.PropertyFactory,h=p.JournalsFactory.create(n,r),m=new u.DataConnector(e,h,a,{tracing:i});return c.register(d.getAttributeSchemas()),c.register(d.getSchemas()),c.addSchemaStore(t),new FDModelingSDK(e,m,c,a,h,i)}getNewInstanceExperimental(e,t){let n=this.journals;void 0!==e&&(n=p.JournalsFactory.createFrom(this.journals,e));const r=new u.DataConnector(this.connectionOptions,n,this.logger,{tracing:t});return new FDModelingSDK(this.connectionOptions,r,this.propertyFactory,this.logger,n,t)}getTracingOptions(){return this.tracingOptions}createSpaceCollection(e=a.spaceCollectionTypeId){return this.core.buildModel(a.spaceCollectionTypeId,e,"","")}getSpaceCollection(e,t){return r(this,void 0,void 0,(function*(){const n=i.default(t||{},{fetch:!0,assumeTypeId:a.spaceCollectionTypeId});return this.core.get(e,e,a.SpaceCollection.fetchPayload,n)}))}getSpace(e,t,n){return r(this,void 0,void 0,(function*(){const r=i.default(n||{},{fetch:!0,assumeTypeId:a.spaceTypeId});return this.core.get(e,t,a.Space.fetchPayload,r)}))}getAsset(e,t,n){return r(this,void 0,void 0,(function*(){const r=i.default(n||{},{fetch:!0,assumeTypeId:a.assetTypeId});return this.core.get(e,t,a.Asset.fetchPayload,r)}))}getRelationship(e,t,n){return r(this,void 0,void 0,(function*(){const r=i.default(n||{},{fetch:!0,assumeTypeId:a.relationshipTypeId});return this.core.get(e,t,a.Relationship.fetchPayload,r)}))}getSnapshot(e,t,n){return r(this,void 0,void 0,(function*(){const r=i.default(n||{},{fetch:!0,assumeTypeId:a.snapshotTypeId});return this.core.get(e,t,a.Snapshot.fetchPayload,r)}))}batch(e){return r(this,void 0,void 0,(function*(){let t;this.beginBatch();try{yield e(),t=this.endBatch()}catch(e){throw this.logger.error(e),this.cancelBatch(),e}return t}))}isBatching(){return this.core.isBatching()}beginBatch(){this.core.beginBatch()}endBatch(){return r(this,void 0,void 0,(function*(){return this.core.endBatch()}))}cancelBatch(){this.core.cancelBatch()}loadSchemas(e){return r(this,void 0,void 0,(function*(){return this.core.loadSchemas(e)}))}getJournals(){return this.journals}dispose(){return r(this,void 0,void 0,(function*(){return this.journals.getImplementation().dispose()}))}get propertyFactory(){return this._propertyFactory}}t.FDModelingSDK=FDModelingSDK},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(186)),s=o(n(59)),a=n(289),c=n(95),u=n(647),l=o(n(290)),d=o(n(13)),p=o(n(75)),h=o(n(96)),m=o(n(61)),y=o(n(133)),g=n(97),_=n(15),v=n(301);var E;!function(e){e[e.PENDING=0]="PENDING",e[e.COMPLETED=1]="COMPLETED",e[e.ERROR=2]="ERROR"}(E||(E={}));class PropertyFactory{constructor(e){this.forwardCompatibility=!1,this.versionedSchemas={},e&&e.forwardCompatibility&&(this.forwardCompatibility=e.forwardCompatibility),this.schemaStores=[],PropertyFactory.initializeStatic(),this.initialize()}isForwardCompatibilityEnabled(){return this.forwardCompatibility}setForwardCompatibilityMode(e){this.forwardCompatibility=e}static initializeStatic(){this.areConstructorsInitialized||(this.areConstructorsInitialized=!0,this.registerPrimitiveConstructor("NodeProperty",g.NodeProperty),this.registerPrimitiveConstructor("ContainerProperty",g.ContainerProperty),this.registerPrimitiveConstructor("Int8",g.Int8Property),this.registerPrimitiveConstructor("Uint8",g.Uint8Property),this.registerPrimitiveConstructor("Int16",g.Int16Property),this.registerPrimitiveConstructor("Uint16",g.Uint16Property),this.registerPrimitiveConstructor("Int32",g.Int32Property),this.registerPrimitiveConstructor("Int64",g.Int64Property),this.registerPrimitiveConstructor("Uint64",g.Uint64Property),this.registerPrimitiveConstructor("Uint32",g.Uint32Property),this.registerPrimitiveConstructor("Float32",g.Float32Property),this.registerPrimitiveConstructor("Float64",g.Float64Property),this.registerPrimitiveConstructor("Bool",g.BoolProperty),this.registerPrimitiveConstructor("String",g.StringProperty),this.registerPrimitiveConstructor("Enum",g.EnumProperty),this.registerPrimitiveConstructor("Int8",g.Int8ArrayProperty,"array"),this.registerPrimitiveConstructor("Uint8",g.Uint8ArrayProperty,"array"),this.registerPrimitiveConstructor("Int16",g.Int16ArrayProperty,"array"),this.registerPrimitiveConstructor("Uint16",g.Uint16ArrayProperty,"array"),this.registerPrimitiveConstructor("Int32",g.Int32ArrayProperty,"array"),this.registerPrimitiveConstructor("Uint32",g.Uint32ArrayProperty,"array"),this.registerPrimitiveConstructor("Int64",g.Int64ArrayProperty,"array"),this.registerPrimitiveConstructor("Uint64",g.Uint64ArrayProperty,"array"),this.registerPrimitiveConstructor("Float32",g.Float32ArrayProperty,"array"),this.registerPrimitiveConstructor("Float64",g.Float64ArrayProperty,"array"),this.registerPrimitiveConstructor("String",g.StringArrayProperty,"array"),this.registerPrimitiveConstructor("Bool",g.BoolArrayProperty,"array"),this.registerPrimitiveConstructor("Enum",g.EnumArrayProperty,"array"),this.registerPrimitiveConstructor("Int8",g.Int8MapProperty,"map"),this.registerPrimitiveConstructor("Uint8",g.Uint8MapProperty,"map"),this.registerPrimitiveConstructor("Int16",g.Int16MapProperty,"map"),this.registerPrimitiveConstructor("Uint16",g.Uint16MapProperty,"map"),this.registerPrimitiveConstructor("Int32",g.Int32MapProperty,"map"),this.registerPrimitiveConstructor("Uint32",g.Uint32MapProperty,"map"),this.registerPrimitiveConstructor("Int64",g.Int64MapProperty,"map"),this.registerPrimitiveConstructor("Uint64",g.Uint64MapProperty,"map"),this.registerPrimitiveConstructor("Float32",g.Float32MapProperty,"map"),this.registerPrimitiveConstructor("Float64",g.Float64MapProperty,"map"),this.registerPrimitiveConstructor("Bool",g.BoolMapProperty,"map"),this.registerPrimitiveConstructor("String",g.StringMapProperty,"map"))}static registerPrimitiveConstructor(e,t,n="single"){h.default(this.primitiveConstructors,[e,n],t)}register(e){Array.isArray(e)||(e=[e]),e=this.sortSchemas(e);for(const t of e){if(!a.PropertyTemplate.isTemplate(t))throw new Error("input is not a valid schema");const e=new a.PropertyTemplate(t),n=e.getDependencies();for(const e of n)if(!this.hasSchema(e))throw new u.SchemaError("Dependency is not registered. Typeid:"+e,e);this.registerSchema(e)}}prefetchSchemas(e){return r(this,void 0,void 0,(function*(){if(0===this.schemaStores.length)throw new Error("PropertyFactory is not connected to a schema store.");const t={},n=[],fetchSchema=e=>r(this,void 0,void 0,(function*(){try{const r=yield this.fetchSchema(e);t[e].schema=r,t[e].status=E.COMPLETED;const o=new a.PropertyTemplate(r).getDependencies();for(const e of o)this.hasSchema(e)||Object.keys(t).includes(e)||(t[e]={status:E.PENDING},n.push(fetchSchema(e)))}catch(n){throw t[e].status=E.ERROR,n}}));for(e.forEach(e=>{t[e]={status:E.PENDING},n.push(fetchSchema(e))});n.length;)yield n.shift();const o=Object.entries(t).reduce((e,t)=>{const n=t[0],r=t[1];if(r.status===E.PENDING)throw new Error(`Can't register schema ${n}: request still pending.`);return e.push(r.schema),e},[]);if(!d.default(o)){const e=this.sortSchemas(o);for(const t of e)this.hasSchema(t.typeid)||this.register(t)}}))}fetchSchema(e){return r(this,void 0,void 0,(function*(){const t=[];for(const n of this.schemaStores)try{const t=yield n.getSchema(e);if(t)return t}catch(e){t.push(e)}throw t.push(new Error(`Failed to find schema ${e} in any of the registered schema stores`)),new i.default(t)}))}getSchema(e){const t=this.getSchemaWrapper(e);return void 0===t?void 0:t.getPropertyTemplate()}getCompiledSchema(e){const t=this.getSchemaWrapper(e);return void 0===t?void 0:t.getCompiledTemplate(this)}getSchemaWrapper(e){const{typeidWithoutVersion:t,version:n}=c.TypeIdHelper.extractVersion(e);return m.default(this.versionedSchemas,[t,n])}getPropertyConstructor(e,t){return m.default(PropertyFactory.primitiveConstructors,[e,t])}hasSchema(e){return void 0!==this.getSchema(e)}create(e,t="single",n){return this._createProperty(e,t,n)}inheritsFrom(e,t){return(this.getAllParentsForTemplate(e)||[]).includes(t)}getAllParentsForTemplate(e){return this.getCompiledSchema(e).inherits}getSchemaClosestAncestor(e){if(!c.TypeIdHelper.isSchemaTypeid(e))throw new Error(`${_.MSG.INVALID_TYPEID_SPECIFIED} ${e}`);const t=c.TypeIdHelper.extractVersion(e);if(!this.versionedSchemas[t.typeidWithoutVersion])return null;const n=Object.keys(this.versionedSchemas[t.typeidWithoutVersion]);return l.default.maxSatisfying(n,`>=${t.version.split(".")[0]}.0.0 <${t.version}`)}checkForDegradedModeNeed(e){let t;if(c.TypeIdHelper.isSchemaTypeid(e)&&!this.hasSchema(e)&&this.isForwardCompatibilityEnabled()){if(t=this.getSchemaClosestAncestor(e),!t)throw new Error(_.MSG.MISSING_SCHEMA_NO_ANCESTOR_PRESENT+e);console.warn(`${e} is not registered but an older version (${t}) of the schema was found. Now running in degraded mode using this version.`)}return t}instanceOf(e,t,n){const r=this.getPropertyConstructor(t,n);let o=!1;return r&&(o=e instanceof r),o}sortSchemas(e){const t=e.slice(0);let n=!0;for(;n;){n=!1;for(let e=0;e<t.length;e++){const r=t[e],o=a.PropertyTemplate.extractDependencies(r);if(o.length>0)for(let i=t.length;i>e;--i){if(void 0===t[i]||null===t[i])continue;if(-1!==o.indexOf(t[i].typeid)){t[e]=t[i],t[i]=r,n=!0;break}}}}return t}_createProperty(e,t="single",n){let r=t;if(!r&&!c.TypeIdHelper.isReferenceTypeId(e)){const t=c.TypeIdHelper.extractContext(e);e=t.typeid,r=t.context}const o=this._createFromPropertyDeclaration({typeid:e,context:r||"single",id:void 0});return void 0!==n&&this._setInitialValue(o,{value:n}),o}_setInitialValue(e,t){if(e._unsetAsConstant(),e instanceof g.ValueProperty)e.setValue(t.value);else if(t.typed)e._setValues(t.value,!0,!0);else if("ContainerProperty"!==e.getTypeid()||e._getChildrenCount()>0)e._setValues(t.value,!1,!0);else{if(!t.typeid)throw new Error(_.MSG.FIELD_TYPEID_IS_REQUIRED+e._id+".typeid");e._setValues(t.value,!1,!0)}}ensurePropertyParentExists(e,t,n){const r={};this._getAllParentsForTemplateInternal(e,r),r[e]=!0;const o={typeid:e,id:t||null,propertyFactory:this};let i;return r.NodeProperty?i=g.NodeProperty:r.Enum?(o.enumDictionary=n.enumDictionary,i=g.EnumProperty):(i=g.ContainerProperty,o.id=t),new i(o)}_computeTypeid(e,t){let n=e.typeid;if("single"===t){const r=this._parseTypedValue(e,t);r.typed&&r.typeid&&(n=e.typedValue.typeid)}return n||"single"===t||(n="set"!==t?"ContainerProperty":"NamedProperty"),e.typeid&&c.TypeIdHelper.isReferenceTypeId(e.typeid)&&(n="Reference"),n}_createFromPropertyDeclaration(e){const t=void 0!==e.context?e.context:"single";let n=this._computeTypeid(e,t);const r=y.default(e,{propertyFactory:this});let o;if(n){const i=this.checkForDegradedModeNeed(n);if(i&&(n=`${c.TypeIdHelper.extractVersion(n).typeidWithoutVersion}-${i}`),!this.isRegisteredTypeid(n))throw new Error(_.MSG.UNKNOWN_TYPEID_SPECIFIED+n);const a=this.getPropertyConstructor(n,t);if(a){return new a(r)}const u=this.getCompiledSchema(n);if(void 0===u)throw new Error(_.MSG.UNKNOWN_TYPEID_SPECIFIED+n);if("single"!==t){const o=this.inheritsFrom(n,"Enum");let a;switch(t){case"array":if(o){const t=s.default(e);t.enumDictionary=u.enumDictionary,a=new g.EnumArrayProperty(t)}else a=new g.ArrayProperty(r);break;case"map":a=new g.MapProperty(r);break;default:throw new Error(_.MSG.UNKNOWN_CONTEXT_SPECIFIED+t)}return i&&a.setRemoteVersion(i),a}o=this.ensurePropertyParentExists(n,e.id,u),this._parseTemplate(u,o)}else e.properties||(e.properties=[]),o=new g.ContainerProperty(e),this._parseTemplate(e,o);return o}registerSchema(e){const{typeidWithoutVersion:t,version:n}=c.TypeIdHelper.extractVersion(e.typeid),r=new v.PropertyTemplateWrapper(new a.PropertyTemplate(e));r.constructCompiledTemplate(this),h.default(this.versionedSchemas,[t,n],r)}initialize(){this.registerSchema({typeid:"ContainerProperty"}),this.registerSchema({typeid:"NodeProperty"}),this.registerSchema({typeid:"NamedProperty",properties:[{id:"guid",typeid:"String"}]}),this.registerSchema({typeid:"NamedNodeProperty",inherits:["NodeProperty","NamedProperty"]}),this.registerSchema({typeid:"RelationshipProperty",inherits:["NodeProperty","NamedProperty"],properties:[{id:"to",typeid:"Reference"}]})}isRegisteredTypeid(e){const t=c.TypeIdHelper.extractTypeId(e),{typeidWithoutVersion:n,version:r}=c.TypeIdHelper.extractVersion(t),o=void 0!==m.default(this.versionedSchemas,[n,r]),i=void 0!==PropertyFactory.primitiveConstructors[t];return o||i}_parseTypedValue(e,t){const n={typed:!1,value:e.value,typeid:e.typeid};if(e.typedValue){const r=e.typeid||"ContainerProperty";if(c.TypeIdHelper.isPrimitiveType(r))throw new Error(_.MSG.TYPED_VALUES_FOR_PRIMITIVES_NOT_SUPPORTED+e.id);if(n.typed=!0,"single"===t){if(!e.typedValue.typeid)throw new Error(_.MSG.FIELD_TYPEID_IS_REQUIRED+"typedValue "+r);if(!this.inheritsFrom(e.typedValue.typeid,r))throw new Error(_.MSG.TYPED_VALUES_MUST_DERIVE_FROM_BASE_TYPE+e.typedValue.typeid+" must be a subclass of "+r);n.value=e.typedValue.value,n.typeid=e.typedValue.typeid}else n.value=e.typedValue}return n}_parseTemplate(e,t){if(e.properties||e.constants){const n=e.properties,r=e.constants;if(e.inherits&&e.inherits[0]&&"Enum"===e.inherits[0]);else{if(n)for(const e of n){const n=e.context||"single",r=this._parseTypedValue(e,n),o=this._createFromPropertyDeclaration(e);o&&(r.value&&this._setInitialValue(o,r),t._append(o,!1))}if(r)for(const e of r){const n=e.context||"single",r=this._parseTypedValue(e,n);e.context=n;const o=this._createFromPropertyDeclaration(e);r.value&&this._setInitialValue(o,r),o._setAsConstant(),t._append(o,!1)}}}}_getEnumTypeid(e){const t=/enum<(.*)>/;let n;return"enum<"===e.substr(0,5)&&(n=t.exec(e)[1],this._validateEnumTemplate(n)),n}_validateEnumTemplate(e){if(!this.getSchema(e))throw new Error(_.MSG.NON_EXISTING_TYPEID+e);if(c.TypeIdHelper.isReservedType(e))throw new Error(_.MSG.TYPEID_IS_NOT_ENUM)}_getAllParentsForTemplateInternal(e,t,n){if(c.TypeIdHelper.isPrimitiveType(e))return void(n&&(t.ContainerProperty=!0,t.BaseProperty=!0));const r=this.getSchema(e);if(!r)throw new Error(_.MSG.NON_EXISTING_TYPEID+e);if(n&&(t.ContainerProperty=!0,t.BaseProperty=!0),r.inherits){const e=p.default(r.inherits)?r.inherits:[r.inherits];for(const n of e)t[n]=!0,this._getAllParentsForTemplateInternal(n,t)}}addSchemaStore(e){this.schemaStores.push(e)}extractUnknownTypeids(e){let t=new Set;for(const n of Object.entries(e)){const e=n[0],r=n[1],o=c.TypeIdHelper.isSchemaTypeid(e)?c.TypeIdHelper.extractTypeId(e):"";let i=[];if(!c.TypeIdHelper.isPrimitiveType(o)){if(o&&!this.hasSchema(e)){t.add(o);for(const e of Object.values(r)){const t=this.extractUnknownTypeids(e);i=i.concat(t)}}else{if("insert"!==e&&"modify"!==e)continue;i=this.extractUnknownTypeids(r)}t=new Set([...t,...i])}}return[...t]}}t.PropertyFactory=PropertyFactory,PropertyFactory.primitiveConstructors={},PropertyFactory.areConstructorsInitialized=!1},function(e,t,n){"use strict";e.exports=(e,t=1,n)=>{if(n={indent:" ",includeEmptyLines:!1,...n},"string"!=typeof e)throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof e}\``);if("number"!=typeof t)throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof t}\``);if("string"!=typeof n.indent)throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof n.indent}\``);if(0===t)return e;const r=n.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return e.replace(r,n.indent.repeat(t))}},function(e,t,n){"use strict";const r=n(646),o=/\s+at.*(?:\(|\s)(.*)\)?/,i=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,s=void 0===r.homedir?"":r.homedir();e.exports=(e,t)=>(t=Object.assign({pretty:!1},t),e.replace(/\\/g,"/").split("\n").filter(e=>{const t=e.match(o);if(null===t||!t[1])return!0;const n=t[1];return!n.includes(".app/Contents/Resources/electron.asar")&&!n.includes(".app/Contents/Resources/default_app.asar")&&!i.test(n)}).filter(e=>""!==e.trim()).map(e=>t.pretty?e.replace(o,(e,t)=>e.replace(t,t.replace(s,"~"))):e).join("\n"))},function(e,t){e.exports=require("os")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(648);t.SchemaError=r.SchemaError},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class SchemaError extends Error{constructor(e,t){super(e),this._typeid=t}get typeid(){return this._typeid}}t.SchemaError=SchemaError},function(e,t,n){const r=n(78);e.exports=(e,t)=>{const n=r(e,t);return n?n.version:null}},function(e,t,n){const r=n(78);e.exports=(e,t)=>{const n=r(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},function(e,t,n){const r=n(25);e.exports=(e,t,n,o)=>{"string"==typeof n&&(o=n,n=void 0);try{return new r(e,n).inc(t,o).version}catch(e){return null}}},function(e,t,n){const r=n(78),o=n(188);e.exports=(e,t)=>{if(o(e,t))return null;{const n=r(e),o=r(t),i=n.prerelease.length||o.prerelease.length,s=i?"pre":"",a=i?"prerelease":"";for(const e in n)if(("major"===e||"minor"===e||"patch"===e)&&n[e]!==o[e])return s+e;return a}}},function(e,t,n){const r=n(25);e.exports=(e,t)=>new r(e,t).major},function(e,t,n){const r=n(25);e.exports=(e,t)=>new r(e,t).minor},function(e,t,n){const r=n(25);e.exports=(e,t)=>new r(e,t).patch},function(e,t,n){const r=n(78);e.exports=(e,t)=>{const n=r(e,t);return n&&n.prerelease.length?n.prerelease:null}},function(e,t,n){const r=n(38);e.exports=(e,t,n)=>r(t,e,n)},function(e,t,n){const r=n(38);e.exports=(e,t)=>r(e,t,!0)},function(e,t,n){const r=n(189);e.exports=(e,t)=>e.sort((e,n)=>r(e,n,t))},function(e,t,n){const r=n(189);e.exports=(e,t)=>e.sort((e,n)=>r(n,e,t))},function(e,t,n){const r=n(25),o=n(78),{re:i,t:s}=n(77);e.exports=(e,t)=>{if(e instanceof r)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let n=null;if((t=t||{}).rtl){let t;for(;(t=i[s.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&t.index+t[0].length===n.index+n[0].length||(n=t),i[s.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;i[s.COERCERTL].lastIndex=-1}else n=e.match(i[s.COERCE]);return null===n?null:o(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)}},function(e,t,n){"use strict";const r=n(663),o=Symbol("max"),i=Symbol("length"),s=Symbol("lengthCalculator"),a=Symbol("allowStale"),c=Symbol("maxAge"),u=Symbol("dispose"),l=Symbol("noDisposeOnSet"),d=Symbol("lruList"),p=Symbol("cache"),h=Symbol("updateAgeOnGet"),naiveLength=()=>1;const get=(e,t,n)=>{const r=e[p].get(t);if(r){const t=r.value;if(isStale(e,t)){if(del(e,r),!e[a])return}else n&&(e[h]&&(r.value.now=Date.now()),e[d].unshiftNode(r));return t.value}},isStale=(e,t)=>{if(!t||!t.maxAge&&!e[c])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[c]&&n>e[c]},trim=e=>{if(e[i]>e[o])for(let t=e[d].tail;e[i]>e[o]&&null!==t;){const n=t.prev;del(e,t),t=n}},del=(e,t)=>{if(t){const n=t.value;e[u]&&e[u](n.key,n.value),e[i]-=n.length,e[p].delete(n.key),e[d].removeNode(t)}};class Entry{constructor(e,t,n,r,o){this.key=e,this.value=t,this.length=n,this.now=r,this.maxAge=o||0}}const forEachStep=(e,t,n,r)=>{let o=n.value;isStale(e,o)&&(del(e,n),e[a]||(o=void 0)),o&&t.call(r,o.value,o.key,e)};e.exports=class LRUCache{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[o]=e.max||1/0;const t=e.length||naiveLength;if(this[s]="function"!=typeof t?naiveLength:t,this[a]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[c]=e.maxAge||0,this[u]=e.dispose,this[l]=e.noDisposeOnSet||!1,this[h]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[o]=e||1/0,trim(this)}get max(){return this[o]}set allowStale(e){this[a]=!!e}get allowStale(){return this[a]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[c]=e,trim(this)}get maxAge(){return this[c]}set lengthCalculator(e){"function"!=typeof e&&(e=naiveLength),e!==this[s]&&(this[s]=e,this[i]=0,this[d].forEach(e=>{e.length=this[s](e.value,e.key),this[i]+=e.length})),trim(this)}get lengthCalculator(){return this[s]}get length(){return this[i]}get itemCount(){return this[d].length}rforEach(e,t){t=t||this;for(let n=this[d].tail;null!==n;){const r=n.prev;forEachStep(this,e,n,t),n=r}}forEach(e,t){t=t||this;for(let n=this[d].head;null!==n;){const r=n.next;forEachStep(this,e,n,t),n=r}}keys(){return this[d].toArray().map(e=>e.key)}values(){return this[d].toArray().map(e=>e.value)}reset(){this[u]&&this[d]&&this[d].length&&this[d].forEach(e=>this[u](e.key,e.value)),this[p]=new Map,this[d]=new r,this[i]=0}dump(){return this[d].map(e=>!isStale(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[d]}set(e,t,n){if((n=n||this[c])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,a=this[s](t,e);if(this[p].has(e)){if(a>this[o])return del(this,this[p].get(e)),!1;const s=this[p].get(e).value;return this[u]&&(this[l]||this[u](e,s.value)),s.now=r,s.maxAge=n,s.value=t,this[i]+=a-s.length,s.length=a,this.get(e),trim(this),!0}const h=new Entry(e,t,a,r,n);return h.length>this[o]?(this[u]&&this[u](e,t),!1):(this[i]+=h.length,this[d].unshift(h),this[p].set(e,this[d].head),trim(this),!0)}has(e){if(!this[p].has(e))return!1;const t=this[p].get(e).value;return!isStale(this,t)}get(e){return get(this,e,!0)}peek(e){return get(this,e,!1)}pop(){const e=this[d].tail;return e?(del(this,e),e.value):null}del(e){del(this,this[p].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const r=e[n],o=r.e||0;if(0===o)this.set(r.k,r.v);else{const e=o-t;e>0&&this.set(r.k,r.v,e)}}}prune(){this[p].forEach((e,t)=>get(this,t,!1))}}},function(e,t,n){"use strict";function Yallist(e){var t=this;if(t instanceof Yallist||(t=new Yallist),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}function insert(e,t,n){var r=t===e.head?new Node(n,null,t,e):new Node(n,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function push(e,t){e.tail=new Node(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function unshift(e,t){e.head=new Node(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Node(e,t,n,r){if(!(this instanceof Node))return new Node(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}e.exports=Yallist,Yallist.Node=Node,Yallist.create=Yallist,Yallist.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},Yallist.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},Yallist.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},Yallist.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)push(this,arguments[e]);return this.length},Yallist.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)unshift(this,arguments[e]);return this.length},Yallist.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},Yallist.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},Yallist.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},Yallist.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},Yallist.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},Yallist.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},Yallist.prototype.map=function(e,t){t=t||this;for(var n=new Yallist,r=this.head;null!==r;)n.push(e.call(t,r.value,this)),r=r.next;return n},Yallist.prototype.mapReverse=function(e,t){t=t||this;for(var n=new Yallist,r=this.tail;null!==r;)n.push(e.call(t,r.value,this)),r=r.prev;return n},Yallist.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var o=0;null!==r;o++)n=e(n,r.value,o),r=r.next;return n},Yallist.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var o=this.length-1;null!==r;o--)n=e(n,r.value,o),r=r.prev;return n},Yallist.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},Yallist.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},Yallist.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new Yallist;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,o=this.head;null!==o&&r<e;r++)o=o.next;for(;null!==o&&r<t;r++,o=o.next)n.push(o.value);return n},Yallist.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new Yallist;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,o=this.tail;null!==o&&r>t;r--)o=o.prev;for(;null!==o&&r>e;r--,o=o.prev)n.push(o.value);return n},Yallist.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,o=this.head;null!==o&&r<e;r++)o=o.next;var i=[];for(r=0;o&&r<t;r++)i.push(o.value),o=this.removeNode(o);null===o&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev);for(r=0;r<n.length;r++)o=insert(this,o,n[r]);return i},Yallist.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{n(664)(Yallist)}catch(e){}},function(e,t,n){"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},function(e,t,n){const r=n(39);e.exports=(e,t)=>new r(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))},function(e,t,n){const r=n(25),o=n(39);e.exports=(e,t,n)=>{let i=null,s=null,a=null;try{a=new o(t,n)}catch(e){return null}return e.forEach(e=>{a.test(e)&&(i&&-1!==s.compare(e)||(i=e,s=new r(i,n)))}),i}},function(e,t,n){const r=n(25),o=n(39);e.exports=(e,t,n)=>{let i=null,s=null,a=null;try{a=new o(t,n)}catch(e){return null}return e.forEach(e=>{a.test(e)&&(i&&1!==s.compare(e)||(i=e,s=new r(i,n)))}),i}},function(e,t,n){const r=n(25),o=n(39),i=n(137);e.exports=(e,t)=>{e=new o(e,t);let n=new r("0.0.0");if(e.test(n))return n;if(n=new r("0.0.0-0"),e.test(n))return n;n=null;for(let t=0;t<e.set.length;++t){const o=e.set[t];let s=null;o.forEach(e=>{const t=new r(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!i(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}),!s||n&&!i(n,s)||(n=s)}return n&&e.test(n)?n:null}},function(e,t,n){const r=n(39);e.exports=(e,t)=>{try{return new r(e,t).range||"*"}catch(e){return null}}},function(e,t,n){const r=n(193);e.exports=(e,t,n)=>r(e,t,">",n)},function(e,t,n){const r=n(193);e.exports=(e,t,n)=>r(e,t,"<",n)},function(e,t,n){const r=n(39);e.exports=(e,t,n)=>(e=new r(e,n),t=new r(t,n),e.intersects(t))},function(e,t,n){const r=n(139),o=n(38);e.exports=(e,t,n)=>{const i=[];let s=null,a=null;const c=e.sort((e,t)=>o(e,t,n));for(const e of c){r(e,t,n)?(a=e,s||(s=e)):(a&&i.push([s,a]),a=null,s=null)}s&&i.push([s,null]);const u=[];for(const[e,t]of i)e===t?u.push(e):t||e!==c[0]?t?e===c[0]?u.push("<="+t):u.push(`${e} - ${t}`):u.push(">="+e):u.push("*");const l=u.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return l.length<d.length?l:t}},function(e,t,n){const r=n(39),o=n(138),{ANY:i}=o,s=n(139),a=n(38),simpleSubset=(e,t,n)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===i){if(1===t.length&&t[0].semver===i)return!0;e=n.includePrerelease?[new o(">=0.0.0-0")]:[new o(">=0.0.0")]}if(1===t.length&&t[0].semver===i){if(n.includePrerelease)return!0;t=[new o(">=0.0.0")]}const r=new Set;let c,u,l,d,p,h,m;for(const t of e)">"===t.operator||">="===t.operator?c=higherGT(c,t,n):"<"===t.operator||"<="===t.operator?u=lowerLT(u,t,n):r.add(t.semver);if(r.size>1)return null;if(c&&u){if(l=a(c.semver,u.semver,n),l>0)return null;if(0===l&&(">="!==c.operator||"<="!==u.operator))return null}for(const e of r){if(c&&!s(e,String(c),n))return null;if(u&&!s(e,String(u),n))return null;for(const r of t)if(!s(e,String(r),n))return!1;return!0}let y=!(!u||n.includePrerelease||!u.semver.prerelease.length)&&u.semver,g=!(!c||n.includePrerelease||!c.semver.prerelease.length)&&c.semver;y&&1===y.prerelease.length&&"<"===u.operator&&0===y.prerelease[0]&&(y=!1);for(const e of t){if(m=m||">"===e.operator||">="===e.operator,h=h||"<"===e.operator||"<="===e.operator,c)if(g&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===g.major&&e.semver.minor===g.minor&&e.semver.patch===g.patch&&(g=!1),">"===e.operator||">="===e.operator){if(d=higherGT(c,e,n),d===e&&d!==c)return!1}else if(">="===c.operator&&!s(c.semver,String(e),n))return!1;if(u)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),"<"===e.operator||"<="===e.operator){if(p=lowerLT(u,e,n),p===e&&p!==u)return!1}else if("<="===u.operator&&!s(u.semver,String(e),n))return!1;if(!e.operator&&(u||c)&&0!==l)return!1}return!(c&&h&&!u&&0!==l)&&(!(u&&m&&!c&&0!==l)&&(!g&&!y))},higherGT=(e,t,n)=>{if(!e)return t;const r=a(e.semver,t.semver,n);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},lowerLT=(e,t,n)=>{if(!e)return t;const r=a(e.semver,t.semver,n);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,n={})=>{if(e===t)return!0;e=new r(e,n),t=new r(t,n);let o=!1;e:for(const r of e.set){for(const e of t.set){const t=simpleSubset(r,e,n);if(o=o||null!==t,t)continue e}if(o)return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValueContainer=function isValueContainer(e){return"function"==typeof e._getValue}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(141)),i=r(n(13)),s=r(n(677)),a=r(n(195));t.ChangeSet=class ChangeSet{constructor(e={}){this.internalData=e}get serializedChangeSet(){return this.internalData}set serializedChangeSet(e){this.internalData=e}static isEmpty(e){return void 0===e||o.default(e)&&(i.default(e)||1===s.default(e)&&a.default(e,"typeid"))}static isReservedKeyword(e){return"insert"===e||"remove"===e||"modify"===e||"typeid"===e||"insertTemplates"===e||"insertSchemas"===e}}},function(e,t){var n="[object Map]",r="[object Set]",o=/^\[object .+?Constructor\]$/,i="[\\ud800-\\udfff]",s="[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]",a="\\ud83c[\\udffb-\\udfff]",c="[^\\ud800-\\udfff]",u="(?:\\ud83c[\\udde6-\\uddff]){2}",l="[\\ud800-\\udbff][\\udc00-\\udfff]",d="(?:"+s+"|"+a+")"+"?",p="[\\ufe0e\\ufe0f]?"+d+("(?:\\u200d(?:"+[c,u,l].join("|")+")[\\ufe0e\\ufe0f]?"+d+")*"),h="(?:"+[c+s+"?",s,u,l,i].join("|")+")",m=RegExp(a+"(?="+a+")|"+h+p,"g"),y=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0\\ufe0e\\ufe0f]"),g="object"==typeof global&&global&&global.Object===Object&&global,_="object"==typeof self&&self&&self.Object===Object&&self,v=g||_||Function("return this")(),E=function baseProperty(e){return function(t){return null==t?void 0:t[e]}}("length");function stringSize(e){return function hasUnicode(e){return y.test(e)}(e)?function unicodeSize(e){var t=m.lastIndex=0;for(;m.test(e);)t++;return t}(e):E(e)}var I,b=Function.prototype,S=Object.prototype,C=v["__core-js_shared__"],w=(I=/[^.]+$/.exec(C&&C.keys&&C.keys.IE_PROTO||""))?"Symbol(src)_1."+I:"",A=b.toString,O=S.hasOwnProperty,P=S.toString,D=RegExp("^"+A.call(O).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),x=function overArg(e,t){return function(n){return e(t(n))}}(Object.keys,Object),R=getNative(v,"DataView"),N=getNative(v,"Map"),M=getNative(v,"Promise"),L=getNative(v,"Set"),j=getNative(v,"WeakMap"),k=toSource(R),F=toSource(N),U=toSource(M),V=toSource(L),B=toSource(j);function baseIsNative(e){return!(!isObject(e)||function isMasked(e){return!!w&&w in e}(e))&&(isFunction(e)||function isHostObject(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?D:o).test(toSource(e))}function baseKeys(e){if(!function isPrototype(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||S;return e===n}(e))return x(e);var t=[];for(var n in Object(e))O.call(e,n)&&"constructor"!=n&&t.push(n);return t}function getNative(e,t){var n=function getValue(e,t){return null==e?void 0:e[t]}(e,t);return baseIsNative(n)?n:void 0}var J=function baseGetTag(e){return P.call(e)};function toSource(e){if(null!=e){try{return A.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(R&&"[object DataView]"!=J(new R(new ArrayBuffer(1)))||N&&J(new N)!=n||M&&"[object Promise]"!=J(M.resolve())||L&&J(new L)!=r||j&&"[object WeakMap]"!=J(new j))&&(J=function(e){var t=P.call(e),o="[object Object]"==t?e.constructor:void 0,i=o?toSource(o):void 0;if(i)switch(i){case k:return"[object DataView]";case F:return n;case U:return"[object Promise]";case V:return r;case B:return"[object WeakMap]"}return t});var $=Array.isArray;function isFunction(e){var t=isObject(e)?P.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function size(e){if(null==e)return 0;if(function isArrayLike(e){return null!=e&&function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!isFunction(e)}(e))return function isString(e){return"string"==typeof e||!$(e)&&function isObjectLike(e){return!!e&&"object"==typeof e}(e)&&"[object String]"==P.call(e)}(e)?stringSize(e):e.length;var t=J(e);return t==n||t==r?e.size:baseKeys(e).length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.INSERT="insert",e.MODIFY="modify",e.REMOVE="remove"}(t.ChangeSetOperations||(t.ChangeSetOperations={}))},function(e,t,n){"use strict";var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(98),s=n(15),a=n(142),c=n(295),u=n(140),l=o(n(13)),d=o(n(60));class ArrayProperty extends c.ArrayBaseProperty{constructor(){super(...arguments),this.isChildDirty=!1}insertRange(e,t,n=!0,r=!1){if(this.isDegraded()&&!r)throw new Error(s.MSG.ARRAY_INSERT_FORBIDDEN_IN_DEGRADED_MODE);if(!Array.isArray(t))throw new Error(s.MSG.IN_ARRAY_NOT_ARRAY+"ArrayProperty.insertRange");for(let n=0;n<t.length;n++)t[n]instanceof i.BaseProperty&&t[n]._validateInsertIn(this,e+n);if(this._checkIsNotReadOnly(!0),!d.default(e))throw new Error(s.MSG.NOT_NUMBER+"offset, method: ArrayProperty.insertRange or .insert");if(e<0||e>this.getLength())throw Error(s.MSG.START_OFFSET_INVALID+e);const o=[];for(let e=0;e<t.length;++e){let n=t[e];if(t[e]instanceof i.BaseProperty||(n=this.propertyFactory.create(this._typeid,void 0,t[e])),n.getParent())throw new Error(s.MSG.NO_INSERT_WITH_PARENT);n._setParent(this),o.push(n)}t=o,n&&this.updateDirtyChangeSetAtInsert(e,t),this._dataArrayInsertRange(e,t)}_setValues(e,t,n){if(t){if(!Array.isArray(e))throw new Error(s.MSG.IN_ARRAY_NOT_ARRAY+"ArrayProperty._setValues");const t=[];for(let n=0;n<e.length;n++){let r=e[n];r=e[n]instanceof u.ContainerProperty?e[n]:this.propertyFactory.create(e[n].typeid||this._typeid,null,e[n].value),t.push(r)}this._setValuesInternal(t)}else this._setValuesInternal(e)}_toJson(){const e={id:this.getId(),context:this._context,typeid:this.getTypeid(),isConstant:this._isConstant,value:[]},t=this.getIds();for(let n=0;n<t.length;n++)e.value.push(this.get(parseInt(t[n]))._toJson());return e}_dataArrayCreate(e){this._dataArrayRef=new a.UniversalDataArray(e);for(let t=0;t<e;t++){const e=this.propertyFactory.create(this.getTypeid());e._setParent(this),this._dataArraySetValue(t,e)}}_modifyRange(e,t,n=!0){if(e<0)throw Error(s.MSG.START_OFFSET_NEGATIVE+e);n&&this.updateDirtyChangeSetAtModify(e,t),this._clearRange(e,t.length,!1),this.insertRange(e,t,!1)}_clearRange(e,t,n=!0){for(let n=0;n<t;++n){if(this._dataArrayGetValue(e+n).getParent()!==this)throw new Error(s.MSG.CANNOT_REMOVE_WITH_DIFFERENT_PARENT);this._dataArrayGetValue(e+n)._setParent(void 0)}n&&this.updateDirtyChangeSetAtRemove(e,t),this._dataArrayRemoveRange(e,t)}_setValuesInternal(e){this._checkIsNotReadOnly(!0),this.clear(!1),this.insertRange(0,e,!1),this.updateDirtyChangeSetAtModify(0,e)}_prettyPrint(e,t,n){n(e+t+this.getId()+" (Array of "+this.getTypeid()+"): ["),this._prettyPrintChildren(e,n),n(e+"]")}handleModifyingEntries(e,t,n,r){const o=t-e[0];let i=0,s=Math.abs(o);for(o>0&&(i=s,s=0);void 0!==r[s]&&void 0!==e[1][i];)e[1][i]=Object.assign(Object.assign({},r[s]._serialize()),{typeid:r[s].getTypeid()||this._typeid}),r.splice(s,1),i++,l.default(r)||0,0===s&&t++;return t}updateDirtyChangeSetAtInsert(e,t){this.isDirty||(this.isDirty=!0);const n=e+t.length-1,r=t.length;this.findAndHandleOverlappingRange(this.dirtyChangeSet.insert,e,n,!1,{overlappingRangeCallback:n=>{const r=Math.abs(e-n[0]);return t.forEach((e,t)=>{n[1].splice(t+r,0,Object.assign(Object.assign({},e._serialize()),{typeid:e.getTypeid()||this._typeid}))}),t=[],e},nonOverlappingRangeCallback:()=>{const n=t.map(e=>Object.assign(Object.assign({},e._serialize()),{typeid:e.getTypeid()||this._typeid}));this.dirtyChangeSet.insert.push([e,n])}}),this.increaseIndexesInSet(this.dirtyChangeSet.insert,e,r),this.increaseIndexesInSet(this.dirtyChangeSet.modify,e-1,r),this.increaseIndexesInSet(this.dirtyChangeSet.remove,e-1,r)}updateDirtyChangeSetAtModify(e,t){this.isDirty=!!this.isDirty&&this.isDirty;const n=t.slice(),r=e+n.length-1;e=this.findAndHandleOverlappingRange(this.dirtyChangeSet.insert,e,r,!1,{overlappingRangeCallback:(e,t,r)=>this.handleModifyingEntries(e,r,t,n)}),e=this.findAndHandleOverlappingRange(this.dirtyChangeSet.modify,e,r,!1,{overlappingRangeCallback:(e,t,r)=>this.handleModifyingEntries(e,r,t,n)}),this.findAndHandleOverlappingRange(this.dirtyChangeSet.remove,e,r,!1,{nonOverlappingRangeCallback:()=>{if(!l.default(n)){const t=n.map(e=>Object.assign(Object.assign({},e._serialize()),{typeid:e.getTypeid()||this._typeid}));this.dirtyChangeSet.modify.push([e,t])}}})}_deserialize(e,t){this.dirtyChangeSet=e,this.clear(!1),t&&(this._remoteVersion=t),e.insert&&e.insert.forEach(e=>{const n=e[0];e[1].map((e,o)=>{const{typeid:i}=e,s=r(e,["typeid"]),a=this.propertyFactory.create(i||this._typeid);return this.insert(o+n,a,!1,!0),a._deserialize(s,t),a})})}_setDirty(e){this.isChildDirty=!0,super._setDirty(e)}clean(){this.isChildDirty=!1,this._dataArrayGetBuffer().map(e=>e.cleanSelf()),super.clean()}_serialize(){if(this.isChildDirty){let e=-1,t=[];this._dataArrayGetBuffer().forEach((n,r)=>{n.isDirty?(e<0&&(e=r,t=[]),t.push(n)):(l.default(t)||this.updateDirtyChangeSetAtModify(e,t),e=-1)}),!l.default(t)&&e>0&&this.updateDirtyChangeSetAtModify(e,t)}return this.groomDirtyChangeSet(),this.dirtyChangeSet}}t.ArrayProperty=ArrayProperty},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(294),o=n(40),i=n(35),s=Array,a=i._castFunctors.Boolean;class BoolDataArray extends r.UniversalDataArray{constructor(e){super(e,a)}getBufferCtor(){return s}insertRange(e,t){this.buffer.splice(e,0,...t.map(e=>a(e))),this.size=this.size+t.length}set(e=0,t){if(t instanceof s)arraySetBool(this.buffer,t,e);else{if(!(t instanceof o.BaseDataArray))throw new Error("DataArray set() must be called with Array, TypedArray or DataArray");arraySetBool(this.buffer,t.serialize(),e)}}}t.BoolDataArray=BoolDataArray;const arraySetBool=function(e,t,n=0){let r=0;t.forEach(t=>{e[r+n]=a(t),r++})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(40),o=n(35),i=Int8Array,s=o._castFunctors.Int8;class Int8DataArray extends r.BaseDataArray{constructor(e){super(i,s,e)}getBufferCtor(){return i}}t.Int8DataArray=Int8DataArray},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(40),o=n(35),i=Int16Array,s=o._castFunctors.Int16;class Int16DataArray extends r.BaseDataArray{constructor(e){super(i,s,e)}getBufferCtor(){return i}}t.Int16DataArray=Int16DataArray},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(40),o=n(35),i=Int32Array,s=o._castFunctors.Int32;class Int32DataArray extends r.BaseDataArray{constructor(e){super(i,s,e)}getBufferCtor(){return i}}t.Int32DataArray=Int32DataArray},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(40),o=n(35),i=Uint8Array,s=o._castFunctors.Uint8;class Uint8DataArray extends r.BaseDataArray{constructor(e){super(i,s,e)}getBufferCtor(){return i}}t.Uint8DataArray=Uint8DataArray},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(40),o=n(35),i=Uint16Array,s=o._castFunctors.Uint16;class Uint16DataArray extends r.BaseDataArray{constructor(e){super(i,s,e)}getBufferCtor(){return i}}t.Uint16DataArray=Uint16DataArray},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(40),o=n(35),i=Uint32Array,s=o._castFunctors.Uint32;class Uint32DataArray extends r.BaseDataArray{constructor(e){super(i,s,e)}getBufferCtor(){return i}}t.Uint32DataArray=Uint32DataArray},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(40),o=n(35),i=Float32Array,s=o._castFunctors.Float32;class Float32DataArray extends r.BaseDataArray{constructor(e){super(i,s,e)}getBufferCtor(){return i}}t.Float32DataArray=Float32DataArray},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(40),o=n(35),i=Float64Array,s=o._castFunctors.Float64;class Float64DataArray extends r.BaseDataArray{constructor(e){super(i,s,e)}getBufferCtor(){return i}}t.Float64DataArray=Float64DataArray},function(e,t){var n=/^\[object .+?Constructor\]$/,r="object"==typeof global&&global&&global.Object===Object&&global,o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();function apply(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function arrayIncludes(e,t){return!!(e?e.length:0)&&function baseIndexOf(e,t,n){if(t!=t)return function baseFindIndex(e,t,n,r){var o=e.length,i=n+(r?1:-1);for(;r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}(e,baseIsNaN,n);var r=n-1,o=e.length;for(;++r<o;)if(e[r]===t)return r;return-1}(e,t,0)>-1}function arrayIncludesWith(e,t,n){for(var r=-1,o=e?e.length:0;++r<o;)if(n(t,e[r]))return!0;return!1}function arrayPush(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}function baseIsNaN(e){return e!=e}function cacheHas(e,t){return e.has(t)}var s,a=Array.prototype,c=Function.prototype,u=Object.prototype,l=i["__core-js_shared__"],d=(s=/[^.]+$/.exec(l&&l.keys&&l.keys.IE_PROTO||""))?"Symbol(src)_1."+s:"",p=c.toString,h=u.hasOwnProperty,m=u.toString,y=RegExp("^"+p.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),g=i.Symbol,_=u.propertyIsEnumerable,v=a.splice,E=g?g.isConcatSpreadable:void 0,I=Math.max,b=getNative(i,"Map"),S=getNative(Object,"create");function Hash(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ListCache(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function MapCache(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function SetCache(e){var t=-1,n=e?e.length:0;for(this.__data__=new MapCache;++t<n;)this.add(e[t])}function assocIndexOf(e,t){for(var n,r,o=e.length;o--;)if((n=e[o][0])===(r=t)||n!=n&&r!=r)return o;return-1}function baseDifference(e,t,n,r){var o=-1,i=arrayIncludes,s=!0,a=e.length,c=[],u=t.length;if(!a)return c;n&&(t=function arrayMap(e,t){for(var n=-1,r=e?e.length:0,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}(t,function baseUnary(e){return function(t){return e(t)}}(n))),r?(i=arrayIncludesWith,s=!1):t.length>=200&&(i=cacheHas,s=!1,t=new SetCache(t));e:for(;++o<a;){var l=e[o],d=n?n(l):l;if(l=r||0!==l?l:0,s&&d==d){for(var p=u;p--;)if(t[p]===d)continue e;c.push(l)}else i(t,d,r)||c.push(l)}return c}function baseIsNative(e){return!(!isObject(e)||function isMasked(e){return!!d&&d in e}(e))&&(isFunction(e)||function isHostObject(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?y:n).test(function toSource(e){if(null!=e){try{return p.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function getMapData(e,t){var n=e.__data__;return function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function getNative(e,t){var n=function getValue(e,t){return null==e?void 0:e[t]}(e,t);return baseIsNative(n)?n:void 0}function isFlattenable(e){return w(e)||function isArguments(e){return isArrayLikeObject(e)&&h.call(e,"callee")&&(!_.call(e,"callee")||"[object Arguments]"==m.call(e))}(e)||!!(E&&e&&e[E])}Hash.prototype.clear=function hashClear(){this.__data__=S?S(null):{}},Hash.prototype.delete=function hashDelete(e){return this.has(e)&&delete this.__data__[e]},Hash.prototype.get=function hashGet(e){var t=this.__data__;if(S){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return h.call(t,e)?t[e]:void 0},Hash.prototype.has=function hashHas(e){var t=this.__data__;return S?void 0!==t[e]:h.call(t,e)},Hash.prototype.set=function hashSet(e,t){return this.__data__[e]=S&&void 0===t?"__lodash_hash_undefined__":t,this},ListCache.prototype.clear=function listCacheClear(){this.__data__=[]},ListCache.prototype.delete=function listCacheDelete(e){var t=this.__data__,n=assocIndexOf(t,e);return!(n<0)&&(n==t.length-1?t.pop():v.call(t,n,1),!0)},ListCache.prototype.get=function listCacheGet(e){var t=this.__data__,n=assocIndexOf(t,e);return n<0?void 0:t[n][1]},ListCache.prototype.has=function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1},ListCache.prototype.set=function listCacheSet(e,t){var n=this.__data__,r=assocIndexOf(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},MapCache.prototype.clear=function mapCacheClear(){this.__data__={hash:new Hash,map:new(b||ListCache),string:new Hash}},MapCache.prototype.delete=function mapCacheDelete(e){return getMapData(this,e).delete(e)},MapCache.prototype.get=function mapCacheGet(e){return getMapData(this,e).get(e)},MapCache.prototype.has=function mapCacheHas(e){return getMapData(this,e).has(e)},MapCache.prototype.set=function mapCacheSet(e,t){return getMapData(this,e).set(e,t),this},SetCache.prototype.add=SetCache.prototype.push=function setCacheAdd(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},SetCache.prototype.has=function setCacheHas(e){return this.__data__.has(e)};var C=function baseRest(e,t){return t=I(void 0===t?e.length-1:t,0),function(){for(var n=arguments,r=-1,o=I(n.length-t,0),i=Array(o);++r<o;)i[r]=n[t+r];r=-1;for(var s=Array(t+1);++r<t;)s[r]=n[r];return s[t]=i,apply(e,this,s)}}((function(e,t){return isArrayLikeObject(e)?baseDifference(e,function baseFlatten(e,t,n,r,o){var i=-1,s=e.length;for(n||(n=isFlattenable),o||(o=[]);++i<s;){var a=e[i];t>0&&n(a)?t>1?baseFlatten(a,t-1,n,r,o):arrayPush(o,a):r||(o[o.length]=a)}return o}(t,1,isArrayLikeObject,!0)):[]}));var w=Array.isArray;function isArrayLike(e){return null!=e&&function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!isFunction(e)}function isArrayLikeObject(e){return function isObjectLike(e){return!!e&&"object"==typeof e}(e)&&isArrayLike(e)}function isFunction(e){var t=isObject(e)?m.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=C},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(141)),i=r(n(13)),s=r(n(100)),a=n(297),c=n(140),u=n(98),l=r(n(293)),d=n(15),p=n(194);class MapProperty extends a.IndexedMapCollectionBaseProperty{constructor(e){super(e),this._contextKeyType=e.contextKeyType||"string"}insert(e,t){if(i.default(e))throw new Error(d.MSG.ID_SHOULD_NOT_BE_EMPTY_STRING);if(void 0!==this.dynamicChildren[e])throw new Error(d.MSG.PROPERTY_ALREADY_EXISTS+e);if(!(t instanceof u.BaseProperty))throw new Error(d.MSG.NONVALUE_MAP_INSERT_PROP);t._validateInsertIn(this,e),t._setId(e),this._insert(e,t)}_setValuesInternal(e,t){this._containsPrimitiveTypes?s.default(e,(e,t)=>{this.has(t)&&this.remove(t),this.insert(t,e)}):s.default(e,(e,t)=>{const n=this.get(String(t));if(n)if(p.isPrimitive(n))n.setValue(e);else{if(!(n instanceof c.ContainerProperty&&o.default(e)))throw new Error(d.MSG.SET_VALUES_PATH_INVALID+t);n._setValues(e,!1,!1)}})}_setValues(e,t,n){n&&this.clear(),this._setValuesInternal(e,t)}setValues(e){this._setValues(e,!1,!1)}getPathSegmentForChildNode(e){return"["+l.default.quotePathSegmentIfNeeded(e.getId())+"]"}remove(e){const t=this.get(e);return this._removeByKey(e),t}set(e,t){if(this._checkIsNotReadOnly(!0),this.dynamicChildren[e]!==t){if(!(t instanceof u.BaseProperty))throw new Error(d.MSG.NOT_A_PROPERTY);if(!1===this._containsPrimitiveTypes&&void 0!==t.getParent())throw new Error(d.MSG.INSERTED_ENTRY_WITH_PARENT);void 0!==this.dynamicChildren[e]&&this._removeByKey(e),!1===this._containsPrimitiveTypes&&t._setId(e),this._insert(e,t)}}getEntriesReadOnly(){return this.dynamicChildren}get(e){return this.dynamicChildren[e]}getAsArray(){return Object.values(this.dynamicChildren)}}t.MapProperty=MapProperty},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(13)),i=r(n(76)),s=r(n(60)),a=r(n(100)),c=n(97),u=n(15);class NodeProperty extends c.IndexedCollectionBaseProperty{getDefaultTypeid(){return"NodeProperty"}isDynamic(){return!0}insert(e,t){let n,r;if(void 0===e||!t&&!(e instanceof c.BaseProperty)||t&&e instanceof c.BaseProperty)throw new Error(u.MSG.NOT_A_PROPERTY);if(e instanceof c.BaseProperty?(r=e,n=r.getId()):(r=t,n=e),i.default(n)&&o.default(n))throw new Error(u.MSG.ID_SHOULD_NOT_BE_EMPTY_STRING);if(void 0!==this.dynamicChildren[n])throw new Error(u.MSG.PROPERTY_ALREADY_EXISTS+e);if(r._validateInsertIn(this,n),r._setId(n),void 0===r.getId()||null===r.getId())throw new Error(u.MSG.ADDED_CHILD_WITHOUT_ID);this._insert(n,r)}has(e){return super.has(e)||void 0!==this.dynamicChildren[e]}get(e){return this.dynamicChildren[e]||this.staticChildren[e]}remove(e){let t,n;if(i.default(e)||s.default(e)?(n=e,t=this.get(n)):(t=e,n=t.getId()),void 0===n)throw new Error(u.MSG.REMOVING_NON_EXISTING_ID);return this._removeByKey(n),t}clear(){this._checkIsNotReadOnly(!0),a.default(this.dynamicChildren,this.remove.bind(this))}getStaticIds(){return Object.keys(this.staticChildren)}getDynamicIds(){return Object.keys(this.dynamicChildren)}getIds(){return this.getDynamicIds().concat(this.getStaticIds())}setValues(e){this._setValues(e,!1)}_insert(e,t){this._checkIsNotReadOnly(!0),super._insert(e,t)}_removeByKey(e){if(this._checkIsNotReadOnly(!0),!this.dynamicChildren[e])throw this.staticChildren[e]?new Error("Cannot remove static children: "+e):new Error(u.MSG.REMOVING_NON_EXISTING_KEY+e);super._removeByKey(e)}_getDynamicChildrenReadOnly(){return this.dynamicChildren}}t.NodeProperty=NodeProperty},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(54);class BoolProperty extends r.ValueProperty{constructor(e){super(e),this._data=!1}getDefaultTypeid(){return"Bool"}_castFunctor(e){return r._castFunctors.Boolean(e)}}t.BoolProperty=BoolProperty},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(76)),i=n(299),s=n(15),a=n(95);class EnumProperty extends i.Int32Property{constructor(e){super(e),this._enumDictionary=e.enumDictionary,this._data=this._enumDictionary?this._enumDictionary.defaultValue:0}getDefaultTypeid(){return"Enum"}isPrimitiveType(){return!0}getEnumString(){const e=this._enumDictionary.enumEntriesByValue[this._data];if(e)return e.id;throw new Error(s.MSG.UNKNOWN_ENUM+this._data)}setValue(e){if(o.default(e))this.setEnumByString(e);else{if(!this._enumDictionary.enumEntriesByValue[e])throw new Error(s.MSG.UNKNOWN_ENUM+e);this._checkIsNotReadOnly(!this.isEqual(e)),super.setValue(e)}}setEnumByString(e){const t=this._enumDictionary.enumEntriesById[e];if(!t)throw new Error(s.MSG.UNKNOWN_ENUM+e);{const e=t.value;this.setValue(e)}}getFullTypeid(){return a.TypeIdHelper.createSerializationTypeId(this._typeid,"single",!0)}getValidEnumList(){return this._enumDictionary.enumEntriesById}}t.EnumProperty=EnumProperty},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(54),o=n(79);class Uint8Property extends r.ValueProperty{constructor(e){super(e),this._data=0}getDefaultTypeid(){return"Uint8"}_castFunctor(e){return r._castFunctors.Uint8(e)}}t.Uint8Property=Uint8Property;class Uint16Property extends r.ValueProperty{constructor(e){super(e),this._data=0}getDefaultTypeid(){return"Uint16"}_castFunctor(e){return r._castFunctors.Uint16(e)}}t.Uint16Property=Uint16Property;class Uint32Property extends r.ValueProperty{constructor(e){super(e),this._data=0}getDefaultTypeid(){return"Uint32"}_castFunctor(e){return r._castFunctors.Uint32(e)}}t.Uint32Property=Uint32Property;class Uint64Property extends r.Integer64Property{getDefaultTypeid(){return"Uint64"}_castFunctor(e,t){return r._castFunctors.Uint64(e,t)}createInteger(e,t){return new o.Uint64(e,t)}}t.Uint64Property=Uint64Property},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(54);class Float32Property extends r.ValueProperty{constructor(e){super(e),this._data=0}getDefaultTypeid(){return"Float32"}_castFunctor(e){return r._castFunctors.Float32(e)}}t.Float32Property=Float32Property;class Float64Property extends r.ValueProperty{constructor(e){super(e),this._data=0}getDefaultTypeid(){return"Float64"}_castFunctor(e){return r._castFunctors.Float64(e)}}t.Float64Property=Float64Property},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(298),o=n(35);class StringProperty extends r.ValueProperty{constructor(e){super(e),this._data=""}getDefaultTypeid(){return"String"}_castFunctor(e){return o._castFunctors.String(e)}}t.StringProperty=StringProperty},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(100)),i=n(35),s=n(79),a=n(142),c=n(295),u=n(15),l=r(n(13));class ValueArrayProperty extends c.ArrayBaseProperty{constructor(e){super(e),this._isPrimitive=!0}_getValue(e){return this._dataArrayRef.getValue(e)}getValues(){const e=[],t=this.getIds();for(let n=0;n<t.length;n++){const r=this.get(parseInt(t[n],10));e.push(r)}return e}insertRange(e,t,n=!0){if(!Array.isArray(t))throw new Error(u.MSG.IN_ARRAY_NOT_ARRAY+"ArrayProperty.insertRange");if(this._checkIsNotReadOnly(!0),e<0||e>this.getLength())throw Error(u.MSG.START_OFFSET_INVALID+e);n&&this.updateDirtyChangeSetAtInsert(e,t),this._dataArrayInsertRange(e,t)}_prettyPrint(e,t,n){n(e+t+this.getId()+" (Array of "+this.getTypeid()+"): [");const r=e+"  ";let o="",i="";"String"===this.getTypeid()&&(o='"',i='"');for(let e=0;e<this._dataArrayGetLength();e++)n(r+e+": "+o+this._dataArrayGetValue(e)+i);n(e+"]")}_setValues(e,t,n){t?super._setValues(e,t,n):this._setValuesInternal(e)}_modifyRange(e,t,n=!0){if(e<0)throw Error(u.MSG.START_OFFSET_NEGATIVE+e);let r;for(let n=0;n<t.length;n++)if(this._dataArrayGetValue(e+n)!==t[n]){for(r=n+1;r<t.length&&this._dataArrayGetValue(e+r)!==t[r];r++);this._dataArraySetRange(e+n,t.slice(n,r)),n=r}n&&this.updateDirtyChangeSetAtModify(e,t)}_setValuesInternal(e){e.length<this._dataArrayGetLength()&&(this._checkIsNotReadOnly(!0),this.removeRange(e.length,this._dataArrayGetLength()-e.length));const t=this._dataArrayGetLength()-1;o.default(e,(e,n)=>{const r=Math.round(n);r>t?(this._checkIsNotReadOnly(!0),this.insert(r,e)):this.isEqual(r,e)||(this._checkIsNotReadOnly(!0),this.set(r,e))})}isEqual(e,t){return this._dataArrayGetValue(e)===t}handleModifyingEntries(e,t,n,r){const o=t-e[0];let i=0,s=Math.abs(o);for(o>0&&(i=s,s=0);void 0!==r[s]&&void 0!==e[1][i];)e[1][i]=r[s],r.splice(s,1),i++,l.default(r)||0,0===s&&t++;return t}updateDirtyChangeSetAtInsert(e,t){this.isDirty||(this.isDirty=!0);const n=e+t.length-1,r=t.length;this.findAndHandleOverlappingRange(this.dirtyChangeSet.insert,e,n,!1,{overlappingRangeCallback:n=>{const r=Math.abs(e-n[0]);return t.forEach((e,t)=>{n[1].splice(t+r,0,e)}),t=[],e},nonOverlappingRangeCallback:()=>{this.dirtyChangeSet.insert.push([e,t])}}),this.increaseIndexesInSet(this.dirtyChangeSet.insert,e,r),this.increaseIndexesInSet(this.dirtyChangeSet.modify,e-1,r),this.increaseIndexesInSet(this.dirtyChangeSet.remove,e-1,r)}updateDirtyChangeSetAtModify(e,t){this.isDirty=!!this.isDirty&&this.isDirty;const n=t.slice(),r=e+n.length-1;e=this.findAndHandleOverlappingRange(this.dirtyChangeSet.insert,e,r,!1,{overlappingRangeCallback:(e,t,r)=>this.handleModifyingEntries(e,r,t,n)}),e=this.findAndHandleOverlappingRange(this.dirtyChangeSet.modify,e,r,!1,{overlappingRangeCallback:(e,t,r)=>this.handleModifyingEntries(e,r,t,n)}),this.findAndHandleOverlappingRange(this.dirtyChangeSet.remove,e,r,!1,{nonOverlappingRangeCallback:()=>{l.default(n)||this.dirtyChangeSet.modify.push([e,n])}})}_deserialize(e){this.dirtyChangeSet=e,e.insert&&e.insert.forEach(e=>{this.insertRange(e[0],e[1],!1)})}}t.ValueArrayProperty=ValueArrayProperty;t.Float32ArrayProperty=class Float32ArrayProperty extends ValueArrayProperty{constructor(e){super(e),this._typeid="Float32"}_dataArrayCreate(e){this._dataArrayRef=new a.BaseDataArray(Float32Array,i._castFunctors.Float32,e)}};t.Float64ArrayProperty=class Float64ArrayProperty extends ValueArrayProperty{constructor(e){super(e),this._typeid="Float64"}_dataArrayCreate(e){this._dataArrayRef=new a.BaseDataArray(Float64Array,i._castFunctors.Float64,e)}};t.Uint8ArrayProperty=class Uint8ArrayProperty extends ValueArrayProperty{constructor(e){super(e),this._typeid="Uint8"}_dataArrayCreate(e){this._dataArrayRef=new a.BaseDataArray(Uint8Array,i._castFunctors.Uint8,e)}};t.Int8ArrayProperty=class Int8ArrayProperty extends ValueArrayProperty{constructor(e){super(e),this._typeid="Int8"}_dataArrayCreate(e){this._dataArrayRef=new a.BaseDataArray(Int8Array,i._castFunctors.Int8,e)}};t.Uint16ArrayProperty=class Uint16ArrayProperty extends ValueArrayProperty{constructor(e){super(e),this._typeid="Uint16"}_dataArrayCreate(e){this._dataArrayRef=new a.BaseDataArray(Uint16Array,i._castFunctors.Uint16,e)}};t.Int16ArrayProperty=class Int16ArrayProperty extends ValueArrayProperty{constructor(e){super(e),this._typeid="Int16"}_dataArrayCreate(e){this._dataArrayRef=new a.BaseDataArray(Int16Array,i._castFunctors.Int16,e)}};t.Uint32ArrayProperty=class Uint32ArrayProperty extends ValueArrayProperty{constructor(e){super(e),this._typeid="Uint32"}_dataArrayCreate(e){this._dataArrayRef=new a.BaseDataArray(Uint32Array,i._castFunctors.Uint32,e)}};t.Int32ArrayProperty=class Int32ArrayProperty extends ValueArrayProperty{constructor(e){super(e),this._typeid="Int32"}_dataArrayCreate(e){this._dataArrayRef=new a.BaseDataArray(Int32Array,i._castFunctors.Int32,e)}};class Integer64ArrayProperty extends ValueArrayProperty{_prettyPrint(e,t,n){n(e+t+this.getId()+" (Array of "+this.getTypeid()+"): [");const r=e+"  ";for(let e=0;e<this._dataArrayGetLength();e++)n(r+e+": "+this._dataArrayGetValue(e));n(e+"]")}isEqual(e,t){const n=this._dataArrayGetValue(e);return t instanceof s.Integer64&&n instanceof s.Integer64&&(n.getValueHigh()===t.getValueHigh()&&n.getValueLow()===t.getValueLow())}}t.Integer64ArrayProperty=Integer64ArrayProperty;t.Int64ArrayProperty=class Int64ArrayProperty extends Integer64ArrayProperty{constructor(e){super(e),this._typeid="Int64"}setRange(e,t){const n=t.map(e=>i._castFunctors.Int64(e));super.setRange(e,n)}insertRange(e,t,n=!0){const r=t.map(e=>i._castFunctors.Int64(e));super.insertRange(e,r,n)}_dataArrayCreate(e){this._dataArrayRef=new a.UniversalDataArray(e,i._castFunctors.Int64);for(let t=0;t<e;t++)this._dataArraySetValue(t,new s.Int64(0,0))}};t.Uint64ArrayProperty=class Uint64ArrayProperty extends Integer64ArrayProperty{constructor(e){super(e),this._typeid="Uint64"}setRange(e,t){const n=t.map(e=>i._castFunctors.Uint64(e));super.setRange(e,n)}insertRange(e,t){const n=t.map(e=>i._castFunctors.Uint64(e));super.insertRange(e,n)}_dataArrayCreate(e){this._dataArrayRef=new a.UniversalDataArray(e,i._castFunctors.Uint64);for(let t=0;t<e;t++)this._dataArraySetValue(t,new s.Uint64(0,0))}};t.StringArrayProperty=class StringArrayProperty extends ValueArrayProperty{constructor(e){super(e),this._typeid="String"}_dataArrayCreate(e){this._dataArrayRef=new a.UniversalDataArray(e,i._castFunctors.String);for(let t=0;t<e;t++)this._dataArraySetValue(t,"")}};t.BoolArrayProperty=class BoolArrayProperty extends ValueArrayProperty{constructor(e){super(e),this._typeid="Bool"}_dataArrayCreate(e){this._dataArrayRef=new a.BoolDataArray(e);for(let t=0;t<e;t++)this._dataArraySetValue(t,!1)}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(75)),i=r(n(76)),s=r(n(60)),a=r(n(100)),c=n(95),u=n(15),l=n(54),d=n(142);class EnumArrayProperty extends l.ValueArrayProperty{constructor(e){super(e),this._enumDictionary=e._enumDictionary}getDefaultTypeid(){return"Enum"}_convertEnumToInternalValue(e){if(i.default(e)){var t=this._enumDictionary.enumEntriesById[e];if(!t)throw new Error(u.MSG.UNKNOWN_ENUM+e);return t.value}if(this._enumDictionary.enumEntriesByValue[e])return e;throw new Error(u.MSG.UNKNOWN_ENUM+e)}insertRange(e,t){if(!s.default(e))throw new Error(u.MSG.NOT_NUMBER+"in_offset, method: EnumArray.insertRange or .insert");if(!o.default(t))throw new Error(u.MSG.IN_ARRAY_NOT_ARRAY+"EnumArrayProperty.insertRange");var n=[];a.default(t,e=>{n.push(this._convertEnumToInternalValue(e))}),super.insertRange(e,n)}set(e,t){if(!s.default(t)&&!i.default(t))throw new Error(u.MSG.VALUE_STRING_OR_NUMBER+t);this.setRange(e,[t])}setEnumByString(e,t){this.set(e,t)}setRange(e,t){if(!s.default(e))throw new Error(u.MSG.NOT_NUMBER+"in_offset, method: EnumArray.setRange or .set");if(!o.default(t))throw new Error(u.MSG.IN_ARRAY_NOT_ARRAY+"EnumArrayProperty.setRange");var n=[],r=this;a.default(t,(function(e){n.push(r._convertEnumToInternalValue(e))})),super.setRange(e,n)}getEnumString(e){var t=this._dataArrayRef.getValue(e),n=this._enumDictionary.enumEntriesByValue[t];if(n)return n.id;throw new Error(u.MSG.UNKNOWN_ENUM+t)}getEnumStrings(e,t){if(!s.default(e))throw new Error(u.MSG.NOT_NUMBER+"in_offset, method: EnumArray.getEnumStrings");if(!s.default(t))throw new Error(u.MSG.NOT_NUMBER+"in_length, method: EnumArray.getEnumStrings");for(var n=[],r=0;r<t;r++)n.push(this.getEnumString(r+e));return n}getFullTypeid(e){return e?c.TypeIdHelper.createSerializationTypeId(this._typeid,"",!0):c.TypeIdHelper.createSerializationTypeId(this._typeid,"array",!0)}getValues(){for(var e=[],t=0;t<this._dataArrayRef.length;t++){var n=this._dataArrayRef.getValue(t);e.push(n)}return e}_dataArrayCreate(e){this._dataArrayRef=new d.Int32DataArray(e)}getValidEnumList(){return this._enumDictionary.enumEntriesById}}t.EnumArrayProperty=EnumArrayProperty},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(141)),i=r(n(100)),s=n(97),a=n(297),c=n(79),u=n(194),l=n(15),d=n(54);class ValueMapProperty extends a.IndexedMapCollectionBaseProperty{constructor(e){super(e),this._containsPrimitiveTypes=!0}_castFunctor(e,t){return e}_insert(e,t){if(this._checkIsNotReadOnly(!0),this.dynamicChildren[e])throw new Error(l.MSG.PROPERTY_ALREADY_EXISTS+e);this.dynamicChildren[e]=t}_setValuesInternal(e,t){this._containsPrimitiveTypes?i.default(e,(e,t)=>{if(this.has(t)){if(this.isEqual(t,e))return;this.remove(t)}this.insert(t,e)}):i.default(e,(function(e,t){const n=this.get(String(t));if(n)if(u.isPrimitive(n))n.setValue(e);else{if(!(n instanceof s.ContainerProperty&&o.default(e)))throw new Error(l.MSG.SET_VALUES_PATH_INVALID+t);n._setValues(e,!1,!1)}}))}insert(e,t){const n=this._castFunctor(t);this._insert(e,n)}_setValues(e,t,n){n&&this.clear(),this._setValuesInternal(e,t)}setValues(e){this._setValues(e,!1,!1)}_toJson(){return{id:this.getId(),context:this._context,typeid:this.getTypeid(),isConstant:this._isConstant,value:this.getValues()}}_prettyPrint(e,t,n){let r="";switch(this._context){case"map":r="Map of ";break;case"set":r="Set of "}n(e+t+this.getId()+" ("+r+this.getTypeid()+"):"),this._prettyPrintChildren(e,n)}_prettyPrintChildren(e,t){e+="  ";let n="",r="";"String"===this.getTypeid()&&(n='"',r='"');for(const[o,i]of Object.entries(this.dynamicChildren))t(e+o+": "+n+i+r)}set(e,t){const n=this._castFunctor?this._castFunctor(t):t;this.dynamicChildren[e]!==n&&(this._checkIsNotReadOnly(!0),void 0!==this.dynamicChildren[e]&&this._removeByKey(e),this._insert(e,n))}getEntriesReadOnly(){return this.dynamicChildren}_getValue(e){return this.dynamicChildren[e]}getAsArray(){return Object.values(this.dynamicChildren)}get(e){return this.dynamicChildren[e]}isEqual(e,t){return this.get(e)===t}}t.ValueMapProperty=ValueMapProperty;t.Float32MapProperty=class Float32MapProperty extends ValueMapProperty{constructor(e){super(e),this._typeid="Float32"}_castFunctor(e){return d._castFunctors.Float32(e)}};t.Float64MapProperty=class Float64MapProperty extends ValueMapProperty{constructor(e){super(e),this._typeid="Float64"}_castFunctor(e){return d._castFunctors.Float64(e)}};t.Uint32MapProperty=class Uint32MapProperty extends ValueMapProperty{constructor(e){super(e),this._typeid="Uint32"}_castFunctor(e){return d._castFunctors.Uint32(e)}};t.Uint16MapProperty=class Uint16MapProperty extends ValueMapProperty{constructor(e){super(e),this._typeid="Uint16"}_castFunctor(e){return d._castFunctors.Uint16(e)}};t.Uint8MapProperty=class Uint8MapProperty extends ValueMapProperty{constructor(e){super(e),this._typeid="Uint8"}_castFunctor(e){return d._castFunctors.Uint8(e)}};t.Int32MapProperty=class Int32MapProperty extends ValueMapProperty{constructor(e){super(e),this._typeid="Int32"}_castFunctor(e){return d._castFunctors.Int32(e)}};class Integer64MapProperty extends ValueMapProperty{constructor(){super(...arguments),this.set=function(e,t){const n=this._castFunctor(t),r=this.dynamicChildren[e];void 0===r?this._insert(e,n,!0):r.getValueHigh()===n.getValueHigh()&&r.getValueLow()===n.getValueLow()||(this._removeByKey(e,!1),this._insert(e,n,!1))}}_prettyPrintChildren(e,t){e+="  ";for(const[n,r]of Object.entries(this.dynamicChildren))t(e+n+": "+r)}isEqual(e,t){const n=this.get(e);return t instanceof c.Integer64&&n instanceof c.Integer64&&(n.getValueHigh()===t.getValueHigh()&&n.getValueLow()===t.getValueLow())}}t.Integer64MapProperty=Integer64MapProperty;t.Int64MapProperty=class Int64MapProperty extends Integer64MapProperty{constructor(e){super(e),this._typeid="Int64"}_castFunctor(e,t){return d._castFunctors.Int64(e,t)}};t.Uint64MapProperty=class Uint64MapProperty extends Integer64MapProperty{constructor(e){super(e),this._typeid="Uint64"}_castFunctor(e,t){return d._castFunctors.Uint64(e,t)}};t.Int16MapProperty=class Int16MapProperty extends ValueMapProperty{constructor(e){super(e),this._typeid="Int16"}_castFunctor(e){return d._castFunctors.Int16(e)}};t.Int8MapProperty=class Int8MapProperty extends ValueMapProperty{constructor(e){super(e),this._typeid="Int8"}_castFunctor(e){return d._castFunctors.Int8(e)}};t.StringMapProperty=class StringMapProperty extends ValueMapProperty{constructor(e){super(e),this._typeid="String"}_castFunctor(e){return d._castFunctors.String(e)}};t.BoolMapProperty=class BoolMapProperty extends ValueMapProperty{constructor(e){super(e),this._typeid="Bool"}_castFunctor(e){return d._castFunctors.Boolean(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(701);t.ConsoleLogger=r.ConsoleLogger;var o=n(711);t.NoOpLogger=o.NoOpLogger;var i=n(302);t.SimpleLogger=i.SimpleLogger},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(302);class ConsoleLogger extends r.SimpleLogger{constructor(e){super(e=>console.log(e),e)}}t.ConsoleLogger=ConsoleLogger},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(101);t.JournalType=r.JournalType;var o=n(703);t.SyncPriority=o.SyncPriority;var i=n(80);t.SyncSelectorType=i.SyncSelectorType,t.toSpacesSyncSelector=i.toSpacesSyncSelector},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.HIGHEST=Number.POSITIVE_INFINITY]="HIGHEST",e[e.NORMAL=0]="NORMAL",e[e.LOWEST=Number.NEGATIVE_INFINITY]="LOWEST"}(t.SyncPriority||(t.SyncPriority={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(705);t.LogLevel=r.LogLevel},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.DEBUG=10]="DEBUG",e[e.INFO=20]="INFO",e[e.WARN=30]="WARN",e[e.ERROR=40]="ERROR"}(t.LogLevel||(t.LogLevel={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(707);t.BinaryUploadStatus=r.BinaryUploadStatus},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.success="Success",e.fail="Fail",e.abort="Abort"}(t.BinaryUploadStatus||(t.BinaryUploadStatus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.outgoing=0]="outgoing",e[e.incoming=1]="incoming"}(t.RelationshipDirection||(t.RelationshipDirection={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TIP_REVISION="TIP"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Abort=0]="Abort",e[e.AbortThis=1]="AbortThis",e[e.Continue=2]="Continue"}(t.TraversalAction||(t.TraversalAction={})),t.INFINITE_DEPTH=1/0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NoOpLogger=class NoOpLogger{debug(e){}error(e){}info(e){}warn(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(58);t.AssetsConverter=class AssetsConverter{static convertChangeSetToAssetRevision(e){return void 0===e.insert||void 0===e.insert.String?[]:Object.entries(e.insert.String).map(([e,t])=>""===t?{id:e}:{id:e,revisionId:t})}static convertAssetsToChangeSet(e){const t=e,n=new r.PropertyFactory,o=n.create("NodeProperty");return t.forEach(e=>{const t=e.revision?e.revision.id:"",r=e.asset.id;o.insert(r,n.create("String","single",t))}),o.serialize()}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(58),i=r(n(13)),s=n(81),a=n(2);class AttributeConverter{static convertChangeSetToAttributesV2(e){if(i.default(e))return[];if(e.remove)throw new a.SDKError("Cannot remove attributes for attributes in upsert format");const t=[];return e.insert&&Object.values(e.insert).forEach(e=>{Object.entries(e).forEach(([e,n])=>{let r={};Object.values(n).forEach(e=>{r=Object.assign(Object.assign({},r),e)}),r.name=e,t.push(r)})}),e.modify&&Object.values(e.modify).forEach(e=>{Object.entries(e).forEach(([e,n])=>{let r={};Object.values(n).forEach(e=>{r=Object.assign(Object.assign({},r),e)}),r.name=e,t.push(r)})}),t}static convertObjectToAttributesV2(e){if(i.default(e))return[];if(e.insert||e.modify||e.delete)throw new a.SDKError("Changeset format is not supported.");return Object.entries(e).map(([e,t])=>{const n=typeof t;return{category:"application",name:e,value:t,type:n.charAt(0).toUpperCase()+n.substring(1)}})}static convertAttributesToChangeset(e){const t=new o.PropertyFactory;t.register(s.getAttributeSchemas());const n=t.create("NodeProperty");return e.forEach(e=>{n.insert(e.name,t.create(AttributeConverter.convertTypeToAttributeTypeid(e.type),"single",{category:e.category,value:e.value,type:e.type}))}),n.serialize()}static convertAttributesToSerializedChangeset(e){return i.default(e)||e.insert||e.modify||e.remove?e:AttributeConverter.convertAttributesToChangeset(e).serializedChangeSet}static convertTypedChangesetToGeneric(e){if(i.default(e))return{};const convertPropertyType=e=>{const t={};return Object.values(e).forEach(e=>{Object.entries(e).forEach(([e,n])=>{let r={};Object.entries(n).forEach(([e,t])=>{if("String"===e)r=Object.assign(Object.assign({},r),t);else{if(!("value"in t))throw new a.SDKError("Unknown field in changeset");r.value=""+t.value}}),t[e]={String:r}})}),{[AttributeConverter.serverTypeid]:t}},t={};return e.insert&&(t.insert=convertPropertyType(e.insert)),e.modify&&(t.modify=convertPropertyType(e.modify)),e.remove&&(t.remove=e.remove),t}static convertTypeToAttributeTypeid(e){let t;switch(e){case"Bool":t=s.boolAttributeSchema.typeid;break;case"String":t=s.stringAttributeSchema.typeid;break;case"Float32":t=s.float32AttributeSchema.typeid;break;case"Float64":t=s.float64AttributeSchema.typeid;break;case"Int8":t=s.int8AttributeSchema.typeid;break;case"Int16":t=s.int16AttributeSchema.typeid;break;case"Int32":t=s.int32AttributeSchema.typeid;break;case"Uint8":t=s.uInt8AttributeSchema.typeid;break;case"Uint16":t=s.uInt16AttributeSchema.typeid;break;case"Uint32":t=s.uInt32AttributeSchema.typeid;break;default:throw new a.SDKError(e+" is not a valid type for creating an attribute.")}return t}}t.AttributeConverter=AttributeConverter,AttributeConverter.serverTypeid="adsk.assetgraph:attribute-1.0.0"},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:component-1.0.0","annotation":{"description":"Base Component"}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:asset-1.0.0","annotation":{"description":"Base asset type tracking metadata on an asset construct."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:assetgraph-1.0.0","inherits":["autodesk.data:space-1.0.0"]}')},function(e){e.exports=JSON.parse('{"typeid":"adsk.forge:binary-asset-1.0.0","inherits":["autodesk.data:asset-1.0.0"],"annotation":{"description":"Asset with has an associated binary file"}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:snapshot-1.0.0","annotation":{"description":"A collection of assets at a specific revision in time"}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:space-1.0.0","annotation":{"description":"A top-level container for structured data."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:collection-1.0.0","annotation":{"description":"Defines a collection of spaces that share common history."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:space.collection-1.0.0","inherits":["autodesk.data:collection-1.0.0"],"annotation":{"description":"Deprecated Schema."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:relationship-1.0.0","annotation":{"description":"Relationship between two assets at tip or a specific point in time"}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:permissionContext-1.0.0","annotation":{"description":"Base Component"},"properties":[{"id":"type","typeid":"String"},{"id":"value","typeid":"String"}]}')},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(725));t.attributeSchema=o.default;const i=r(n(726));t.boolAttributeSchema=i.default;const s=r(n(727));t.float32AttributeSchema=s.default;const a=r(n(728));t.float64AttributeSchema=a.default;const c=r(n(729));t.int8AttributeSchema=c.default;const u=r(n(730));t.int16AttributeSchema=u.default;const l=r(n(731));t.int32AttributeSchema=l.default;const d=r(n(732));t.stringAttributeSchema=d.default;const p=r(n(733));t.uInt8AttributeSchema=p.default;const h=r(n(734));t.uInt16AttributeSchema=h.default;const m=r(n(735));t.uInt32AttributeSchema=m.default,t.getAttributeSchemas=()=>[o.default,i.default,s.default,a.default,c.default,u.default,l.default,d.default,p.default,h.default,m.default]},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:attribute-1.0.0","annotation":{"description":"Schema which represents an attribute"},"properties":[{"id":"type","typeid":"String"},{"id":"category","typeid":"String"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:boolAttribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Bool"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:float32Attribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Float32"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:float64Attribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Float64"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:int8Attribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Int8"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:int16Attribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Int16"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:int32Attribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Int32"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:stringAttribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"String"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:uInt8Attribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Uint8"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:uInt16Attribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Uint16"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:uInt32Attribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Uint32"}]}')},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),i=n(303);t.RequestRunner=class RequestRunner{constructor(e){this.logger=e}executeRequest(e){return r(this,void 0,void 0,(function*(){try{return yield e()}catch(e){if(e.response)throw this.logger.error(`${e.toString()} - ${JSON.stringify(e.response.data)}`),new o.ServerError(e.message,e.response.status,e);throw new i.InternalError(e.message,e)}}))}executeQuery(e){return r(this,void 0,void 0,(function*(){try{return yield e()}catch(e){throw this.logger.error(e.toString()),new o.SDKError("Unexpected Journal Error while executing query: "+e.message,e)}}))}executeCommand(e){return r(this,void 0,void 0,(function*(){let t;try{t=yield e()}catch(n){throw this.logger.error(n.toString()),new o.SDKError("Unexpected Journal Error while executing command: "+n.message,n)}const{error:n}=t;if(n){const e=new o.CommandError(n.message,n.trackingId);throw this.logger.error(e.toString()),e}return t}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JournalError=void 0;class JournalError extends Error{constructor(e,t,n,r){super(t),this.code=e,this.details=t,this.innerError=n,this.additionalInfo=r}toJSON(){var e;return{code:this.code.id,details:null!==(e=this.details)&&void 0!==e?e:this.code.description,error:JSON.stringify(this.innerError),additionalInfo:JSON.stringify(this.additionalInfo)}}}t.JournalError=JournalError},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JournalErrorCode=void 0;class JournalErrorCode{constructor(e,t){this.id=e,this.description=t}}t.JournalErrorCode=JournalErrorCode,JournalErrorCode.L7_UNKNOWN=new JournalErrorCode("L7_UNKNOWN","Unknown error."),JournalErrorCode.L7_GEN_NULL_VALUE=new JournalErrorCode("L7_GEN_NULL_VALUE","A required value is not provided."),JournalErrorCode.L7_GEN_DOWNSTREAM_ERROR=new JournalErrorCode("L7_GEN_DOWNSTREAM_ERROR","Something went wrong calling a downstream service."),JournalErrorCode.L7_REGISTRATION_PATH_NOT_FOUND=new JournalErrorCode("L7_REGISTRATION_PATH_NOT_FOUND","The path provided doesn't exists or is not accessible."),JournalErrorCode.L7_COMMAND_ALREADY_REGISTERED=new JournalErrorCode("L7_COMMAND_ALREADY_REGISTERED","A command with the same name is already registered."),JournalErrorCode.L7_COMMAND_NAME_NOT_ALLOWED=new JournalErrorCode("L7_COMMAND_NAME_NOT_ALLOWED","Command name is not allowed to be used."),JournalErrorCode.L7_COMMAND_NOT_REGISTERED=new JournalErrorCode("L7_COMMAND_NOT_REGISTERED","No command registered with the given name."),JournalErrorCode.L7_COMMAND_BATCH_EXECUTION_NOT_ALLOWED=new JournalErrorCode("L7_COMMAND_BATCH_EXECUTION_NOT_ALLOWED","Command batch execution not allowed for collection-less commands."),JournalErrorCode.L7_COMMAND_BATCH_BAD_DEPENDENT_PARAM=new JournalErrorCode("L7_COMMAND_BATCH_BAD_DEPENDENT_PARAM","Command batch element has invalid dependent parameter."),JournalErrorCode.L7_COMMAND_NOT_FOUND_IN_THE_BATCH=new JournalErrorCode("L7_COMMAND_NOT_FOUND_IN_THE_BATCH","Command was not found in the batch."),JournalErrorCode.L7_CREATE_COLLECTION_BAD_CALLBACK_RESULT=new JournalErrorCode("L7_CREATE_COLLECTION_BAD_CALLBACK_RESULT","Unexpected result executing a command. The execution ends well but the result is unexpected."),JournalErrorCode.L7_CREATE_COLLECTION_FAILED=new JournalErrorCode("L7_CREATE_COLLECTION_FAILED","Create collection on server failed."),JournalErrorCode.L7_QUERY_ALREADY_REGISTERED=new JournalErrorCode("L7_QUERY_ALREADY_REGISTERED","A query with the same name is already registered."),JournalErrorCode.L7_QUERY_NOT_REGISTERED=new JournalErrorCode("L7_QUERY_NOT_REGISTERED","No query registered with the given name."),JournalErrorCode.L7_FETCH_MODE_NOT_ALLOWED=new JournalErrorCode("L7_FETCH_MODE_NOT_ALLOWED","The fetch mode is not allowed with the current journal type."),JournalErrorCode.L7_BAD_QUERY_DEFINITION=new JournalErrorCode("L7_BAD_QUERY_DEFINITION","Query definition have missing parts."),JournalErrorCode.L7_QUERY_DEFINITION_URL_PARAM_NOT_FOUND=new JournalErrorCode("L7_QUERY_DEFINITION_URL_PARAM_NOT_FOUND","Query definition is missing some params for the given URL."),JournalErrorCode.L7_QUERY_DEFINITION_INVALID_URL=new JournalErrorCode("L7_QUERY_DEFINITION_INVALID_URL","The given URL is invalid."),JournalErrorCode.L7_JOURNAL_NOT_FOUND=new JournalErrorCode("L7_JOURNAL_NOT_FOUND","No journal found with the given journalId."),JournalErrorCode.L7_JOURNAL_CANNOT_FETCH=new JournalErrorCode("L7_JOURNAL_CANNOT_FETCH","Cannot fetch the requested collection."),JournalErrorCode.L7_JOURNAL_CANNOT_PULL=new JournalErrorCode("L7_JOURNAL_CANNOT_PULL","Cannot pull commands to a journal with role other than main."),JournalErrorCode.L7_JOURNAL_CANNOT_PUSH=new JournalErrorCode("L7_JOURNAL_CANNOT_PUSH","Journal cannot push."),JournalErrorCode.L7_JOURNAL_CANNOT_REBASE=new JournalErrorCode("L7_JOURNAL_CANNOT_REBASE","Journal cannot rebase."),JournalErrorCode.L7_JOURNAL_CANNOT_SET_PARENT=new JournalErrorCode("L7_JOURNAL_CANNOT_SET_PARENT","Journal cannot set the parent."),JournalErrorCode.L7_JOURNAL_NOT_PROVIDED=new JournalErrorCode("L7_JOURNAL_NOT_PROVIDED","No journal provided for the command execution."),JournalErrorCode.L7_JOURNAL_CANNOT_SYNC_WITH_REMOTE_JOURNAL=new JournalErrorCode("L7_JOURNAL_CANNOT_SYNC_WITH_REMOTE_JOURNAL","Journal cannot synchronize with remote journal."),JournalErrorCode.L7_INVALID_PARENT_JOURNAL=new JournalErrorCode("L7_INVALID_PARENT_JOURNAL","The current parent journal is invalid"),JournalErrorCode.L7_COMMAND_CANNOT_EXECUTE_LOCALLY=new JournalErrorCode("L7_COMMAND_CANNOT_EXECUTE_LOCALLY","Command cannot execute locally."),JournalErrorCode.L7_COMMAND_CANNOT_RE_EXECUTE_LOCALLY=new JournalErrorCode("L7_COMMAND_CANNOT_RE_EXECUTE_LOCALLY","Command could not be re-executed locally."),JournalErrorCode.L7_COMMAND_BATCH_LOCAL_EXECUTION_ERROR=new JournalErrorCode("L7_COMMAND_BATCH_LOCAL_EXECUTION_ERROR","An error occurred during local execution of command batch."),JournalErrorCode.L7_COMMAND_DEPENDENCY_INDEX_OUTSIDE_BOUNDARIES=new JournalErrorCode("L7_COMMAND_DEPENDENCY_INDEX_OUTSIDE_BOUNDARIES","Dependency index is outside of commandBatch boundaries"),JournalErrorCode.L7_COMMAND_NOT_FOUND_IN_JOURNAL=new JournalErrorCode("L7_COMMAND_NOT_FOUND_IN_JOURNAL","Command is not found in journal."),JournalErrorCode.L7_CONTEXT_CANNOT_GET_STORED_DATA=new JournalErrorCode("L7_CONTEXT_CANNOT_GET_STORED_DATA","Cannot get or generate the requested stored ID"),JournalErrorCode.L7_COMMAND_GRAPH_GEN_ERROR=new JournalErrorCode("L7_COMMAND_GRAPH_GEN_ERROR","An error occur when generating the dependency graph"),JournalErrorCode.L7_ACTION_NOT_SUPPORTED=new JournalErrorCode("L7_ACTION_NOT_SUPPORTED","The method is not supported by this version of the journal"),JournalErrorCode.L7_DISPOSING=new JournalErrorCode("L7_DISPOSING","L7 is being disposed or has already been disposed."),JournalErrorCode.L7_EVENT_NOT_SUPPORTED=new JournalErrorCode("L7_EVENT_NOT_SUPPORTED","The event is not supported")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Journaling=void 0;t.Journaling=class Journaling{}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(741),t),o(n(742),t),o(n(743),t),o(n(744),t),o(n(745),t),o(n(746),t),o(n(747),t),o(n(748),t),o(n(749),t),o(n(750),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommandStatus=void 0,function(e){e.NOT_PROCESSED="NOT_PROCESSED",e.STARTED="STARTED",e.BLOCKED="BLOCKED",e.SUCCESS="SUCCESS",e.FAILED="FAILED"}(t.CommandStatus||(t.CommandStatus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FetchMode=void 0,function(e){e.LOCAL_OR_SERVER="local_or_server",e.ONLY_SERVER="only_server",e.ONLY_LOCAL="only_local"}(t.FetchMode||(t.FetchMode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_RETRY_CODES=t.DEFAULT_RETRY_ERRORS=void 0,t.DEFAULT_RETRY_ERRORS=["EINTR","EAGAIN","EBUSY","EMFILE","EPIPE","EADDRINUSE","ENETDOWN","ENETUNREACH","ENETRESET","ECONNRESET","ENOBUFS","ENOTCONN","ETIMEDOUT","ECONNREFUSED","EHOSTDOWN","EHOSTUNREACH"],t.DEFAULT_RETRY_CODES=[408,429,500,502,503,504,506,507,508,510,511,530,598,522]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0});const o=n(197),i=n(145);class ServerError extends i.SDKError{constructor(e,t,n,r){super(e,n,Object.assign({code:i.SDKErrorCode.SERVER_ERROR,detailCode:t},r),ServerError.name),this.statusCode=t}}r([o.NonEnumerable],ServerError.prototype,"statusCode",void 0),t.ServerError=ServerError},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(145);class CommandError extends r.SDKError{constructor(e,t="",n,o){super(e,n,Object.assign({code:r.SDKErrorCode.COMMAND_ERROR,trackingId:t},o),CommandError.name)}}t.CommandError=CommandError},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(13)),i=n(2);t.PolicyConverter=class PolicyConverter{static convertChangeSetToPolicyRequests(e){if(o.default(e))return[];if(!e.insert||e.modify||e.remove)throw new i.InternalError('Actions other than "insert" are not supported. Updates/Remove follows the Changeset format.');const t=[];return Object.entries(e.insert).forEach(([,e])=>{Object.entries(e).forEach(([e])=>{t.push({name:e})})}),t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BatchResult=class BatchResult{constructor(e){this.content=new Map(e)}getErrors(){const e=[];for(const[t,n]of this.content.entries())n.errors&&n.errors.reduce((e,n)=>(e.push({entity:t,error:n}),e),e);return e}getResults(){const e=[];for(const[t,n]of this.content.entries())n.successes&&n.successes.reduce((e,n)=>(e.push({entity:t,result:n}),e),e);return e}getStatus(e){return this.content.get(e)||{successes:[],errors:[],pendingCommands:[]}}getEntities(){return Array.from(this.content.keys())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6);t.BatchResultBuilder=class BatchResultBuilder{constructor(){this.results=new Map}withError(e,t){let n=this.results.get(e);return n||(n={successes:[],errors:[],pendingCommands:[]},this.results.set(e,n)),n.errors.push(t),this}withSuccess(e,t){let n=this.results.get(e);return n||(n={successes:[],errors:[],pendingCommands:[]},this.results.set(e,n)),n.successes.push(t),this}build(){const e=new r.BatchResult(this.results);return this.results.clear(),e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNode=function isNode(){return"undefined"==typeof window&&"undefined"!=typeof process}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2);t.ModelRegistry=class ModelRegistry{constructor(e){this.registry=new Map,this.propertyFactory=e}register(e,t){if(this.registry.has(e))throw new o.SDKError("Typeid already has an associated typeid: "+e);this.registry.set(e,t),this.bestMatchCache=void 0}get(e){if(this.bestMatchCache||(this.bestMatchCache=new Map),!this.bestMatchCache.has(e)){let t;this.registry.forEach((n,r)=>{if(e===r||this.propertyFactory.hasSchema(e)&&this.propertyFactory.inheritsFrom(e,r))if(t){if(this.propertyFactory.inheritsFrom(r,t))t=r;else if(!this.propertyFactory.inheritsFrom(t,r))throw new o.SDKError(`Type ${e} inherits from both ${t} and ${r}: do not know what to build`)}else t=r}),this.bestMatchCache.set(e,t?this.registry.get(t):void 0)}return this.bestMatchCache.get(e)}validateData(e){return r(this,void 0,void 0,(function*(){if(!e.components)return;const{components:t}=e,n=this.propertyFactory.extractUnknownTypeids(t);yield this.propertyFactory.prefetchSchemas(n)}))}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(13)),s=n(6),a=n(147),c=n(2);t.RequestBuilder=class RequestBuilder{constructor(){this._url="",this._headers={}}url(e,t={}){return this._url=e,this._urlParams=t,this}queryParams(e,t){return this._queryParams=e,this._queryParamsDistribution=t||{},this}authToken(e){return this._getTokenFn=e,this}defaultHeaders(){return this._headers=Object.assign(Object.assign({},this._headers),a.headers),this}header(e,t){return this._headers[e]=t,this}headersFrom(e){return this._headers=Object.assign(Object.assign({},this._headers),e),this}build(){return r(this,void 0,void 0,(function*(){let e=this._url;if(i.default(this._urlParams)||(e=s.RequestTools.prepareUrl(this._url,this._urlParams)),!e)throw new c.InternalError("url cannot be empty");let t={},n={};if(null!=this._queryParams&&this._queryParamsDistribution&&(t=s.RequestTools.prepareParams(this._queryParams,this._queryParamsDistribution.query),n=s.RequestTools.prepareBody(this._queryParams,this._queryParamsDistribution.body)),null!=this._getTokenFn){const e=yield this._getTokenFn.apply(null);this._headers.Authorization="Bearer "+e}return{url:e,body:n,config:{headers:this._headers,params:t}}}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.urls={asset:"/v1/collections/${spaceCollectionId}/assets/${id}",assetChanges:"/v1/collections/${spaceCollectionId}/assets/${id}/revisions",assetRevision:"/v1/collections/${spaceCollectionId}/assets/${id}/revisions/${revisionId}",assets:"/v1/collections/${spaceCollectionId}/assets",assetsClosure:"/v1/collections/${spaceCollectionId}/assets/${fromAssetId}/closure",binaryDownload:"/v1/collections/${spaceCollectionId}/assets/${assetId}/binary:download",closure:"/v1/collections/${spaceCollectionId}/assets/closure:get",closurev2:"/v1/collections/${spaceCollectionId}/assets:get-closure",relationship:"/v1/collections/${spaceCollectionId}/relationships/${id}",relationshipChanges:"/v1/collections/${spaceCollectionId}/relationships/${id}/revisions",relationships:"/v1/collections/${fromCollection}/relationships",snapshot:"/v1/collections/${spaceCollectionId}/snapshots/${id}",snapshots:"/v1/collections/${spaceCollectionId}/snapshots",snapshotAssets:"/v1/collections/${spaceCollectionId}/snapshots/${id}/assets",space:"/v1/collections/${spaceCollectionId}/spaces/${id}",spaces:"/v1/collections/${spaceCollectionId}/spaces",spaceChanges:"/v1/collections/${spaceCollectionId}/spaces/${id}/revisions",spaceCollection:"/v1/collections/${id}",purgeSpaceCollection:"/v1/collections/${spaceCollectionId}:purge",spaceCollections:"/v1/collections"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.headers={}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(305),filterUndefined=e=>Object.entries(e).reduce((e,[t,n])=>{const r=e;return null!=n&&(r[t]=n),r},{});t.RequestTools=class RequestTools{static prepareUrl(e,t){let n=e;return Object.keys(t).forEach(e=>{n=n.replace(`\${${e}}`,t[e])}),n}static prepareParams(e,t=[]){const n=e.filter?e.filter:void 0;let o;"string"==typeof e.sort?o=r.toSortingString(e.sort.split(",").map(e=>e.trim())):e.sort&&(o=r.toSortingString(e.sort));const i=t.length>0?Object.keys(e).filter(e=>t.includes(e)).reduce((t,n)=>Object.assign(Object.assign({},t),{[n]:Object(e)[n]}),{}):{},s=Object.assign(Object.assign({},i),{limit:e.limit,filter:n,sort:o});return filterUndefined(s)}static prepareBody(e,t=[]){return t.length>0?filterUndefined(Object.keys(e).filter(e=>t.includes(e)).reduce((t,n)=>Object.assign(Object.assign({},t),{[n]:Object(e)[n]}),{})):{}}static extractParamsFromUrl(e){const[t,n]=e.split("?");return{url:t,params:n.split("&").reduce((e,t)=>{const[n,r]=t.split("=");return Object.assign(Object.assign({},e),{[n]:decodeURIComponent(r)})},{})}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(102);t.QueryRequestParamsBuilder=class QueryRequestParamsBuilder{constructor(){this._params={}}filter(e){return e instanceof r.FiltersBuilder?this._filter=e.build():this._filter=new r.FiltersBuilder(e).build(),this}sort(e){return this._sort=e,this}limit(e){return this._limit=e,this}param(e,t){return void 0!==t&&(this._params[e]=t),this}build(){const e=Object.assign({},this._params);return null!=this._filter&&(e.filter=this._filter),null!=this._sort&&(e.sort=this._sort),null!=this._limit&&(e.limit=this._limit),e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);function ensureDefined(e){if(null==e)throw new r.SDKError("Required value is undefined or null");return e}t.CommandParametersAdapter=class CommandParametersAdapter{static toCreateCollection(e){return{typeid:ensureDefined(e.typeid),scopeUrn:"scopeUrn",attributes:ensureDefined(e.attributes),components:ensureDefined(e.components),policies:ensureDefined(e.policies)}}static toCreateSpace(e){return{typeid:ensureDefined(e.typeid),spaceCollectionId:ensureDefined(e.spaceCollectionId),attributes:ensureDefined(e.attributes),components:ensureDefined(e.components),policies:ensureDefined(e.policies),permissionContext:ensureDefined(e.permissionContext),inheritParentPermissions:ensureDefined(e.inheritParentPermissions)}}static toCreateAsset(e){return{spaceCollectionId:ensureDefined(e.spaceCollectionId),typeid:ensureDefined(e.typeid),spaceId:ensureDefined(e.spaceId),attributes:ensureDefined(e.attributes),components:ensureDefined(e.components),policies:ensureDefined(e.policies)}}static toCreateSnapshot(e){return{spaceCollectionId:ensureDefined(e.spaceCollectionId),typeid:ensureDefined(e.typeid),attributes:ensureDefined(e.attributes),components:ensureDefined(e.components),assets:{}}}static toCreateRelationship(e){const t={spaceCollectionId:ensureDefined(e.spaceCollectionId),typeid:ensureDefined(e.typeid),attributes:ensureDefined(e.attributes),components:ensureDefined(e.components),fromId:ensureDefined(e.fromId),toId:ensureDefined(e.toId)};return e.fromSnapshotId&&(t.fromSnapshotId=e.fromSnapshotId),e.toSnapshotId&&(t.toSnapshotId=e.toSnapshotId),t}static toUpdateSnapshot(e){return{spaceCollectionId:ensureDefined(e.spaceCollectionId),resourceId:ensureDefined(e.resourceId),attributes:ensureDefined(e.attributes),components:ensureDefined(e.components),assets:{}}}static toUpdateRelationship(e){return{spaceCollectionId:ensureDefined(e.spaceCollectionId),resourceId:ensureDefined(e.resourceId),attributes:ensureDefined(e.attributes),components:ensureDefined(e.components)}}static toUpdateSpace(e){return{spaceCollectionId:ensureDefined(e.spaceCollectionId),resourceId:ensureDefined(e.resourceId),attributes:ensureDefined(e.attributes),components:ensureDefined(e.components),policies:ensureDefined(e.policies),permissionContext:ensureDefined(e.permissionContext)}}static toCreateEntity(e){return{typeid:ensureDefined(e.typeid),spaceCollectionId:ensureDefined(e.spaceCollectionId),attributes:ensureDefined(e.attributes),components:ensureDefined(e.components),policies:ensureDefined(e.policies)}}static toUpdateEntity(e){return{spaceCollectionId:ensureDefined(e.spaceCollectionId),resourceId:ensureDefined(e.resourceId),attributes:ensureDefined(e.attributes),components:ensureDefined(e.components),policies:ensureDefined(e.policies)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwServerErrorIfNecessary=function throwServerErrorIfNecessary(e){if(void 0!==e&&void 0!==e.errors&&e.errors.length>0)throw e.errors[0]}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(148),i=n(14),s=n(30),a=n(308),c=n(2),u=n(55),l=n(146),d=n(147),p=n(151),h=["ACTUAL"];class ClosureTraverser{constructor(e,t,n,r){this.tipRevisions=new Map,this.sdkCore=e,this.queryParameters=t,this.workingSet=n||new o.WorkingSet,this.topology=r,this.allTipRevisions=void 0!==t&&h.includes(t.algorithm)}getTipRevisions(e){e.assets.accessibleAssets.forEach(e=>{this.tipRevisions.set(e.id,e.revisionId)})}cleanQueryResults(e){e.topology.forEach(e=>{e.fromAsset.revisionId||(e.fromAsset.revisionId=this.tipRevisions.get(e.fromAsset.id)),e.toAsset.revisionId||(e.toAsset.revisionId=this.tipRevisions.get(e.toAsset.id))})}fulfillQuery(){return r(this,void 0,void 0,(function*(){return p.withSpan(this.sdkCore.getTracingOptions(),"query","closure",()=>r(this,void 0,void 0,(function*(){if(!this.queryParameters)throw new c.SDKError("ClosureTraverser has no query parameters.");const e=yield this.sdkCore.getDataConnector().query(d.urls.closure,this.queryParameters,{body:["startAssets","maxDepth","algorithm","direction","includeAssetAttributes","includeAssetComponents","includeRelationshipAttributes","includeRelationshipComponents","relationshipTypes","relationshipComponentTypes","assetTypes","assetComponentTypes"]},"post");this.getTipRevisions(e),this.cleanQueryResults(e),this.generateTopologyFromNodesJSON(e.topology),this.insertAccessibleAssetsToWorkingSet(e.assets.accessibleAssets),this.insertRelationshipsToWorkingSet(e.relationships)})))}))}traverse(e,t,n,o={}){return r(this,void 0,void 0,(function*(){this.topology||(yield this.fulfillQuery());const r=new Set;let i=e.map(e=>"string"==typeof e?a.EntityIdentifier.from(e):e);i=i.map(e=>e.revisionId!==s.TIP_REVISION?e:new a.EntityIdentifier(e.id,this.tipRevisions.get(e.id)));const u=i.map(e=>({asset:e,depth:0})),l=o.direction||"OUT",d=o.maxDepth?o.maxDepth:s.INFINITE_DEPTH;for(;u.length>0;){const e=u.shift();if(!e)throw new c.InternalError("ClosureTraverser queue has null elements.");const o=e.asset,i=e.depth;if(!r.has(o.getKey())){let e=yield this.applyAssetVisitorFunction(o,t);if(e===s.TraversalAction.Abort)return Promise.resolve();if(r.add(o.getKey()),i<d&&e!==s.TraversalAction.AbortThis){const t=this.topology.getRelationshipsAssetIdentifiersWithAsset(o),r=ClosureTraverser.filterRelationshipsRevisionsByDirection(l,t,o);for(const[t,o]of r.entries()){if(e=yield this.applyRelationshipVisitorFunction(t,n),e===s.TraversalAction.Abort)return Promise.resolve();e!==s.TraversalAction.AbortThis&&("OUT"===l?u.push({asset:o.to,depth:i+1}):u.push({asset:o.from,depth:i+1}))}}}}return Promise.resolve()}))}generateTopologyFromNodesJSON(e){const t=e.map(e=>({relationshipId:e.relationshipId,relationshipRevision:e.revisionId?e.revisionId:s.TIP_REVISION,fromAssetId:e.fromAsset.id,fromAssetRevision:e.fromAsset.revisionId,toAssetId:e.toAsset.id,toAssetRevision:e.toAsset.revisionId}));this.topology=o.Topology.from(t)}insertAccessibleAssetsToWorkingSet(e){e.forEach(e=>{const{id:t}=e,n=e.type,r=l.extractId(this.queryParameters.spaceCollectionId),o=u.AssetCommandsRegistry.parseFetchPayload(e),s=this.sdkCore.buildModel(i.assetTypeId,n,t,r,{initialData:o,fetched:!0});this.allTipRevisions&&this.workingSet.addAsTip(s),this.workingSet.add(s)})}insertRelationshipsToWorkingSet(e){e.forEach(e=>{const{id:t}=e,n=e.type,r=l.extractId(this.queryParameters.spaceCollectionId),o=u.RelationshipCommandsRegistry.parseFetchPayload(e),s=this.sdkCore.buildModel(i.relationshipTypeId,n,t,r,{initialData:o,fetched:!0});this.allTipRevisions&&this.workingSet.addAsTip(s),this.workingSet.add(s)})}static filterRelationshipsRevisionsByDirection(e,t,n){const r=new Map;for(const[o,i]of t.entries())i&&("OUT"===e&&n.isEqual(i.from)||"IN"===e&&n.isEqual(i.to)||"BOTH"===e)&&r.set(o,i);return r}applyAssetVisitorFunction(e,t){return r(this,void 0,void 0,(function*(){if(!t)return s.TraversalAction.Continue;const n=this.allTipRevisions?this.workingSet.getTip(e.id):this.workingSet.get(e.id,e.revisionId);return n?t(n,e.revisionId):s.TraversalAction.Continue}))}applyRelationshipVisitorFunction(e,t){return r(this,void 0,void 0,(function*(){if(!t)return s.TraversalAction.Continue;const n=this.topology.getRelationshipAssetIdentifiers(e);let r,o,i;return this.allTipRevisions?(r=this.workingSet.getTip(e.id),o=this.workingSet.getTip(n.from.id),i=this.workingSet.getTip(n.to.id)):(r=this.workingSet.get(e.id,e.revisionId),o=this.workingSet.get(n.from.id,n.from.revisionId),i=this.workingSet.get(n.to.id,n.to.revisionId)),t(r,o,i)}))}}t.ClosureTraverser=ClosureTraverser},function(e,t){var n=/^\[object .+?Constructor\]$/,r="object"==typeof global&&global&&global.Object===Object&&global,o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();function arrayIncludes(e,t){return!!(e?e.length:0)&&function baseIndexOf(e,t,n){if(t!=t)return function baseFindIndex(e,t,n,r){var o=e.length,i=n+(r?1:-1);for(;r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}(e,baseIsNaN,n);var r=n-1,o=e.length;for(;++r<o;)if(e[r]===t)return r;return-1}(e,t,0)>-1}function arrayIncludesWith(e,t,n){for(var r=-1,o=e?e.length:0;++r<o;)if(n(t,e[r]))return!0;return!1}function baseIsNaN(e){return e!=e}function cacheHas(e,t){return e.has(t)}function setToArray(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var s,a=Array.prototype,c=Function.prototype,u=Object.prototype,l=i["__core-js_shared__"],d=(s=/[^.]+$/.exec(l&&l.keys&&l.keys.IE_PROTO||""))?"Symbol(src)_1."+s:"",p=c.toString,h=u.hasOwnProperty,m=u.toString,y=RegExp("^"+p.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),g=a.splice,_=getNative(i,"Map"),v=getNative(i,"Set"),E=getNative(Object,"create");function Hash(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ListCache(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function MapCache(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function SetCache(e){var t=-1,n=e?e.length:0;for(this.__data__=new MapCache;++t<n;)this.add(e[t])}function assocIndexOf(e,t){for(var n,r,o=e.length;o--;)if((n=e[o][0])===(r=t)||n!=n&&r!=r)return o;return-1}function baseIsNative(e){return!(!isObject(e)||function isMasked(e){return!!d&&d in e}(e))&&(function isFunction(e){var t=isObject(e)?m.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)||function isHostObject(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?y:n).test(function toSource(e){if(null!=e){try{return p.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}Hash.prototype.clear=function hashClear(){this.__data__=E?E(null):{}},Hash.prototype.delete=function hashDelete(e){return this.has(e)&&delete this.__data__[e]},Hash.prototype.get=function hashGet(e){var t=this.__data__;if(E){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return h.call(t,e)?t[e]:void 0},Hash.prototype.has=function hashHas(e){var t=this.__data__;return E?void 0!==t[e]:h.call(t,e)},Hash.prototype.set=function hashSet(e,t){return this.__data__[e]=E&&void 0===t?"__lodash_hash_undefined__":t,this},ListCache.prototype.clear=function listCacheClear(){this.__data__=[]},ListCache.prototype.delete=function listCacheDelete(e){var t=this.__data__,n=assocIndexOf(t,e);return!(n<0)&&(n==t.length-1?t.pop():g.call(t,n,1),!0)},ListCache.prototype.get=function listCacheGet(e){var t=this.__data__,n=assocIndexOf(t,e);return n<0?void 0:t[n][1]},ListCache.prototype.has=function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1},ListCache.prototype.set=function listCacheSet(e,t){var n=this.__data__,r=assocIndexOf(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},MapCache.prototype.clear=function mapCacheClear(){this.__data__={hash:new Hash,map:new(_||ListCache),string:new Hash}},MapCache.prototype.delete=function mapCacheDelete(e){return getMapData(this,e).delete(e)},MapCache.prototype.get=function mapCacheGet(e){return getMapData(this,e).get(e)},MapCache.prototype.has=function mapCacheHas(e){return getMapData(this,e).has(e)},MapCache.prototype.set=function mapCacheSet(e,t){return getMapData(this,e).set(e,t),this},SetCache.prototype.add=SetCache.prototype.push=function setCacheAdd(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},SetCache.prototype.has=function setCacheHas(e){return this.__data__.has(e)};var I=v&&1/setToArray(new v([,-0]))[1]==1/0?function(e){return new v(e)}:function noop(){};function getMapData(e,t){var n=e.__data__;return function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function getNative(e,t){var n=function getValue(e,t){return null==e?void 0:e[t]}(e,t);return baseIsNative(n)?n:void 0}function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function uniq(e){return e&&e.length?function baseUniq(e,t,n){var r=-1,o=arrayIncludes,i=e.length,s=!0,a=[],c=a;if(n)s=!1,o=arrayIncludesWith;else if(i>=200){var u=t?null:I(e);if(u)return setToArray(u);s=!1,o=cacheHas,c=new SetCache}else c=t?[]:a;e:for(;++r<i;){var l=e[r],d=t?t(l):l;if(l=n||0!==l?l:0,s&&d==d){for(var p=c.length;p--;)if(c[p]===d)continue e;t&&c.push(d),a.push(l)}else o(c,d,n)||(c!==a&&c.push(d),a.push(l))}return a}(e):[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(311),o=n(2);t.CommandDependencyBatcher=class CommandDependencyBatcher{constructor(){this.creations=new r.IdentifiableMap,this.revisions=new r.IdentifiableMap,this.redefinitions=new r.IdentifiableMap,this.commands=[]}resolveResourceId(e){if("string"==typeof e)return{command:void 0,path:e};const t=this.creations.get(e);if(!t){if(e.isNewResource())throw new o.SDKError("Cannot save the entity since a dependent entity hasn't been saved yet");return{command:void 0,path:e.getId()}}return{command:t,path:t.getCreationIdentifier(e)}}resolveRevisionId(e,t){const n=this.revisions.get(e);if(!n){if(!t)throw new o.SDKError("Asset added to snapshot has not been saved yet.");return{command:void 0,path:t}}return{command:n,path:n.getRevisionIdentifier(e)}}getRedefiningCommands(e,t,n){const r=this.redefinitions.get(e),o=(null==r?void 0:r.get(t))||[],i=[];for(const e of o)void 0!==n&&e.getCommandId()===n||i.push(e.getCommandId());return i}addCommand(e){const t=this.commands.length;this.commands.push(e),e.assignCommandId(t);for(const t of e.getCreatedEntities()){if(this.creations.has(t))throw new o.InternalError("Multiple commands claim to create the same entity "+t.toString());this.creations.set(t,e)}for(const t of e.getRevisedEntities()){if(this.revisions.has(t))throw new o.InternalError("Multiple commands claim to revise the same entity "+t.toString());this.revisions.set(t,e)}for(const t of e.getRedefinedEntities()){let n=this.redefinitions.get(t.entity);n||(n=new r.IdentifiableMap,this.redefinitions.set(t.entity,n));for(const r of t.context){let t=n.get(r);t||(t=[],n.set(r,t)),t.push(e)}}}}},function(e,t,n){"use strict";var r=n(28),o=n(313),i=n(769),s=n(321);function createInstance(e){var t=new i(e),n=o(i.prototype.request,t);return r.extend(n,i.prototype,t),r.extend(n,t),n}var a=createInstance(n(315));a.Axios=i,a.create=function create(e){return createInstance(s(a.defaults,e))},a.Cancel=n(322),a.CancelToken=n(787),a.isCancel=n(314),a.all=function all(e){return Promise.all(e)},a.spread=n(788),a.isAxiosError=n(789),e.exports=a,e.exports.default=a},function(e,t,n){"use strict";var r=n(28),o=n(199),i=n(770),s=n(771),a=n(321);function Axios(e){this.defaults=e,this.interceptors={request:new i,response:new i}}Axios.prototype.request=function request(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[s,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function unshiftRequestInterceptors(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function pushResponseInterceptors(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},Axios.prototype.getUri=function getUri(e){return e=a(this.defaults,e),o(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function forEachMethodNoData(e){Axios.prototype[e]=function(t,n){return this.request(a(n||{},{method:e,url:t,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function forEachMethodWithData(e){Axios.prototype[e]=function(t,n,r){return this.request(a(r||{},{method:e,url:t,data:n}))}})),e.exports=Axios},function(e,t,n){"use strict";var r=n(28);function InterceptorManager(){this.handlers=[]}InterceptorManager.prototype.use=function use(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},InterceptorManager.prototype.eject=function eject(e){this.handlers[e]&&(this.handlers[e]=null)},InterceptorManager.prototype.forEach=function forEach(e){r.forEach(this.handlers,(function forEachHandler(t){null!==t&&e(t)}))},e.exports=InterceptorManager},function(e,t,n){"use strict";var r=n(28),o=n(772),i=n(314),s=n(315);function throwIfCancellationRequested(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function dispatchRequest(e){return throwIfCancellationRequested(e),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function cleanHeaderConfig(t){delete e.headers[t]})),(e.adapter||s.adapter)(e).then((function onAdapterResolution(t){return throwIfCancellationRequested(e),t.data=o(t.data,t.headers,e.transformResponse),t}),(function onAdapterRejection(t){return i(t)||(throwIfCancellationRequested(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var r=n(28);e.exports=function transformData(e,t,n){return r.forEach(n,(function transform(n){e=n(e,t)})),e}},function(e,t,n){"use strict";var r=n(28);e.exports=function normalizeHeaderName(e,t){r.forEach(e,(function processHeader(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},function(e,t,n){"use strict";var r=n(28),o=n(316),i=n(775),s=n(199),a=n(318),c=n(778),u=n(779),l=n(200);e.exports=function xhrAdapter(e){return new Promise((function dispatchXhrRequest(t,n){var d=e.data,p=e.headers;r.isFormData(d)&&delete p["Content-Type"];var h=new XMLHttpRequest;if(e.auth){var m=e.auth.username||"",y=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";p.Authorization="Basic "+btoa(m+":"+y)}var g=a(e.baseURL,e.url);if(h.open(e.method.toUpperCase(),s(g,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,h.onreadystatechange=function handleLoad(){if(h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in h?c(h.getAllResponseHeaders()):null,i={data:e.responseType&&"text"!==e.responseType?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:r,config:e,request:h};o(t,n,i),h=null}},h.onabort=function handleAbort(){h&&(n(l("Request aborted",e,"ECONNABORTED",h)),h=null)},h.onerror=function handleError(){n(l("Network Error",e,null,h)),h=null},h.ontimeout=function handleTimeout(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(l(t,e,"ECONNABORTED",h)),h=null},r.isStandardBrowserEnv()){var _=(e.withCredentials||u(g))&&e.xsrfCookieName?i.read(e.xsrfCookieName):void 0;_&&(p[e.xsrfHeaderName]=_)}if("setRequestHeader"in h&&r.forEach(p,(function setRequestHeader(e,t){void 0===d&&"content-type"===t.toLowerCase()?delete p[t]:h.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(h.withCredentials=!!e.withCredentials),e.responseType)try{h.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function onCanceled(e){h&&(h.abort(),n(e),h=null)})),d||(d=null),h.send(d)}))}},function(e,t,n){"use strict";var r=n(28);e.exports=r.isStandardBrowserEnv()?function standardBrowserEnv(){return{write:function write(e,t,n,o,i,s){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(o)&&a.push("path="+o),r.isString(i)&&a.push("domain="+i),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function read(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function remove(e){this.write(e,"",Date.now()-864e5)}}}():{write:function write(){},read:function read(){return null},remove:function remove(){}}},function(e,t,n){"use strict";e.exports=function isAbsoluteURL(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function combineURLs(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(28),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function parseHeaders(e){var t,n,i,s={};return e?(r.forEach(e.split("\n"),(function parser(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t){if(s[t]&&o.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([n]):s[t]?s[t]+", "+n:n}})),s):s}},function(e,t,n){"use strict";var r=n(28);e.exports=r.isStandardBrowserEnv()?function standardBrowserEnv(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function resolveURL(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=resolveURL(window.location.href),function isURLSameOrigin(t){var n=r.isString(t)?resolveURL(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function isURLSameOrigin(){return!0}},function(e,t,n){"use strict";var r=n(28),o=n(316),i=n(318),s=n(199),a=n(37),c=n(57),u=n(319).http,l=n(319).https,d=n(51),p=n(125),h=n(786),m=n(200),y=n(317),g=/https:?/;e.exports=function httpAdapter(e){return new Promise((function dispatchHttpRequest(t,n){var _=function resolve(e){t(e)},v=function reject(e){n(e)},E=e.data,I=e.headers;if(I["User-Agent"]||I["user-agent"]||(I["User-Agent"]="axios/"+h.version),E&&!r.isStream(E)){if(Buffer.isBuffer(E));else if(r.isArrayBuffer(E))E=Buffer.from(new Uint8Array(E));else{if(!r.isString(E))return v(m("Data after transformation must be a string, an ArrayBuffer, a Buffer, or a Stream",e));E=Buffer.from(E,"utf-8")}I["Content-Length"]=E.length}var b=void 0;e.auth&&(b=(e.auth.username||"")+":"+(e.auth.password||""));var S=i(e.baseURL,e.url),C=d.parse(S),w=C.protocol||"http:";if(!b&&C.auth){var A=C.auth.split(":");b=(A[0]||"")+":"+(A[1]||"")}b&&delete I.Authorization;var O=g.test(w),P=O?e.httpsAgent:e.httpAgent,D={path:s(C.path,e.params,e.paramsSerializer).replace(/^\?/,""),method:e.method.toUpperCase(),headers:I,agent:P,agents:{http:e.httpAgent,https:e.httpsAgent},auth:b};e.socketPath?D.socketPath=e.socketPath:(D.hostname=C.hostname,D.port=C.port);var x,R=e.proxy;if(!R&&!1!==R){var N=w.slice(0,-1)+"_proxy",M=process.env[N]||process.env[N.toUpperCase()];if(M){var L=d.parse(M),j=process.env.no_proxy||process.env.NO_PROXY,k=!0;if(j)k=!j.split(",").map((function trim(e){return e.trim()})).some((function proxyMatch(e){return!!e&&("*"===e||("."===e[0]&&C.hostname.substr(C.hostname.length-e.length)===e||C.hostname===e))}));if(k&&(R={host:L.hostname,port:L.port,protocol:L.protocol},L.auth)){var F=L.auth.split(":");R.auth={username:F[0],password:F[1]}}}}R&&(D.headers.host=C.hostname+(C.port?":"+C.port:""),function setProxy(e,t,n){if(e.hostname=t.host,e.host=t.host,e.port=t.port,e.path=n,t.auth){var r=Buffer.from(t.auth.username+":"+t.auth.password,"utf8").toString("base64");e.headers["Proxy-Authorization"]="Basic "+r}e.beforeRedirect=function beforeRedirect(e){e.headers.host=e.host,setProxy(e,t,e.href)}}(D,R,w+"//"+C.hostname+(C.port?":"+C.port:"")+D.path));var U=O&&(!R||g.test(R.protocol));e.transport?x=e.transport:0===e.maxRedirects?x=U?c:a:(e.maxRedirects&&(D.maxRedirects=e.maxRedirects),x=U?l:u),e.maxBodyLength>-1&&(D.maxBodyLength=e.maxBodyLength);var V=x.request(D,(function handleResponse(t){if(!V.aborted){var n=t,i=t.req||V;if(204!==t.statusCode&&"HEAD"!==i.method&&!1!==e.decompress)switch(t.headers["content-encoding"]){case"gzip":case"compress":case"deflate":n=n.pipe(p.createUnzip()),delete t.headers["content-encoding"]}var s={status:t.statusCode,statusText:t.statusMessage,headers:t.headers,config:e,request:i};if("stream"===e.responseType)s.data=n,o(_,v,s);else{var a=[];n.on("data",(function handleStreamData(t){a.push(t),e.maxContentLength>-1&&Buffer.concat(a).length>e.maxContentLength&&(n.destroy(),v(m("maxContentLength size of "+e.maxContentLength+" exceeded",e,null,i)))})),n.on("error",(function handleStreamError(t){V.aborted||v(y(t,e,null,i))})),n.on("end",(function handleStreamEnd(){var t=Buffer.concat(a);"arraybuffer"!==e.responseType&&(t=t.toString(e.responseEncoding),e.responseEncoding&&"utf8"!==e.responseEncoding||(t=r.stripBOM(t))),s.data=t,o(_,v,s)}))}}}));V.on("error",(function handleRequestError(t){V.aborted&&"ERR_FR_TOO_MANY_REDIRECTS"!==t.code||v(y(t,e,null,V))})),e.timeout&&V.setTimeout(e.timeout,(function handleRequestTimeout(){V.abort(),v(m("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",V))})),e.cancelToken&&e.cancelToken.promise.then((function onCanceled(e){V.aborted||(V.abort(),v(e))})),r.isStream(E)?E.on("error",(function handleStreamError(t){v(y(t,e,null,V))})).pipe(V):V.end(E)}))}},function(e,t,n){var r;e.exports=function(){if(!r)try{r=n(782)("follow-redirects")}catch(e){r=function(){}}r.apply(null,arguments)}},function(e,t,n){"use strict";"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=n(783):e.exports=n(785)},function(e,t,n){"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.log=function log(){var e;return"object"===("undefined"==typeof console?"undefined":_typeof(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function formatArgs(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function save(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function load(){var e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function useColors(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function localstorage(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(320)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},function(e,t){var n=1e3,r=6e4,o=60*r,i=24*o;function plural(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,t){t=t||{};var s=typeof e;if("string"===s&&e.length>0)return function parse(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*o;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===s&&isFinite(e))return t.long?function fmtLong(e){var t=Math.abs(e);if(t>=i)return plural(e,t,i,"day");if(t>=o)return plural(e,t,o,"hour");if(t>=r)return plural(e,t,r,"minute");if(t>=n)return plural(e,t,n,"second");return e+" ms"}(e):function fmtShort(e){var t=Math.abs(e);if(t>=i)return Math.round(e/i)+"d";if(t>=o)return Math.round(e/o)+"h";if(t>=r)return Math.round(e/r)+"m";if(t>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){"use strict";var r=n(123),o=n(12);t.init=function init(e){e.inspectOpts={};for(var n=Object.keys(t.inspectOpts),r=0;r<n.length;r++)e.inspectOpts[n[r]]=t.inspectOpts[n[r]]},t.log=function log(){return process.stderr.write(o.format.apply(o,arguments)+"\n")},t.formatArgs=function formatArgs(n){var r=this.namespace;if(this.useColors){var o=this.color,i="[3"+(o<8?o:"8;5;"+o),s="  ".concat(i,";1m").concat(r," [0m");n[0]=s+n[0].split("\n").join("\n"+s),n.push(i+"m+"+e.exports.humanize(this.diff)+"[0m")}else n[0]=function getDate(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+r+" "+n[0]},t.save=function save(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function load(){return process.env.DEBUG},t.useColors=function useColors(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):r.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{var i=n(124);i&&(i.stderr||i).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((function(e){return/^debug_/i.test(e)})).reduce((function(e,t){var n=t.substring(6).toLowerCase().replace(/_([a-z])/g,(function(e,t){return t.toUpperCase()})),r=process.env[t];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),e[n]=r,e}),{}),e.exports=n(320)(t);var s=e.exports.formatters;s.o=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts).split("\n").map((function(e){return e.trim()})).join(" ")},s.O=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts)}},function(e){e.exports=JSON.parse('{"_from":"axios@0.21.1","_id":"axios@0.21.1","_inBundle":false,"_integrity":"sha1-IlY0gZYvTWvemnbVFu8OXTwJsrg=","_location":"/axios","_phantomChildren":{},"_requested":{"type":"version","registry":true,"raw":"axios@0.21.1","name":"axios","escapedName":"axios","rawSpec":"0.21.1","saveSpec":null,"fetchSpec":"0.21.1"},"_requiredBy":["/","/@adsk/fd-modeling-sdk","/@adsk/fdsdk-journal","/@adsk/fdsdk-l7-lite","/@rush-temp/ace-client","/@rush-temp/devtools","/@rush-temp/fhq-client","/@rush-temp/flc-client","/@rush-temp/ft-client","/@rush-temp/identity-client","/@rush-temp/jp-api","/@rush-temp/lambda-utilities","/@rush-temp/oauth-client","/@rush-temp/pim-acm-client","/@rush-temp/pim-asset-graph-client","/@rush-temp/pim-lambdas-cloud-os","/@rush-temp/pim-lifecycle-sdk","/@rush-temp/pim-milestone-util-sdk","/@rush-temp/pim-sdk","/@rush-temp/test-shared","/@rush-temp/webhooks-client","/@rush-temp/wip-client","/github-api"],"_resolved":"https://art-bobcat.autodesk.com:443/artifactory/api/npm/autodesk-npm-virtual/axios/-/axios-0.21.1.tgz","_shasum":"22563481962f4d6bde9a76d516ef0e5d3c09b2b8","_spec":"axios@0.21.1","_where":"/mnt/data/jenkins/workspace/ono_release_fremont-js-lib_21-03/common/temp","author":{"name":"Matt Zabriskie"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"bugs":{"url":"https://github.com/axios/axios/issues"},"bundleDependencies":false,"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}],"dependencies":{"follow-redirects":"^1.10.0"},"deprecated":false,"description":"Promise based HTTP client for the browser and node.js","devDependencies":{"bundlesize":"^0.17.0","coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.0.2","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^20.1.0","grunt-karma":"^2.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^1.0.18","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^1.3.0","karma-chrome-launcher":"^2.2.0","karma-coverage":"^1.1.1","karma-firefox-launcher":"^1.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-opera-launcher":"^1.0.0","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^1.2.0","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.7","karma-webpack":"^1.7.0","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^5.2.0","sinon":"^4.5.0","typescript":"^2.8.1","url-search-params":"^0.10.0","webpack":"^1.13.1","webpack-dev-server":"^1.14.1"},"homepage":"https://github.com/axios/axios","jsdelivr":"dist/axios.min.js","keywords":["xhr","http","ajax","promise","node"],"license":"MIT","main":"index.js","name":"axios","repository":{"type":"git","url":"git+https://github.com/axios/axios.git"},"scripts":{"build":"NODE_ENV=production grunt build","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","examples":"node ./examples/server.js","fix":"eslint --fix lib/**/*.js","postversion":"git push && git push --tags","preversion":"npm test","start":"node ./sandbox/server.js","test":"grunt test && bundlesize","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json"},"typings":"./index.d.ts","unpkg":"dist/axios.min.js","version":"0.21.1"}')},function(e,t,n){"use strict";var r=n(322);function CancelToken(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function promiseExecutor(e){t=e}));var n=this;e((function cancel(e){n.reason||(n.reason=new r(e),t(n.reason))}))}CancelToken.prototype.throwIfRequested=function throwIfRequested(){if(this.reason)throw this.reason},CancelToken.source=function source(){var e;return{token:new CancelToken((function executor(t){e=t})),cancel:e}},e.exports=CancelToken},function(e,t,n){"use strict";e.exports=function spread(e){return function wrap(t){return e.apply(null,t)}}},function(e,t,n){"use strict";e.exports=function isAxiosError(e){return"object"==typeof e&&!0===e.isAxiosError}},function(e,t,n){(function(e){var n=/^\[object .+?Constructor\]$/,r=/^(?:0|[1-9]\d*)$/,o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1;var i="object"==typeof global&&global&&global.Object===Object&&global,s="object"==typeof self&&self&&self.Object===Object&&self,a=i||s||Function("return this")(),c=t&&!t.nodeType&&t,u=c&&"object"==typeof e&&e&&!e.nodeType&&e,l=u&&u.exports===c,d=l&&i.process,p=function(){try{var e=u&&u.require&&u.require("util").types;return e||d&&d.binding&&d.binding("util")}catch(e){}}(),h=p&&p.isTypedArray;function apply(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var m,y=Array.prototype,g=Function.prototype,_=Object.prototype,v=a["__core-js_shared__"],E=g.toString,I=_.hasOwnProperty,b=(m=/[^.]+$/.exec(v&&v.keys&&v.keys.IE_PROTO||""))?"Symbol(src)_1."+m:"",S=_.toString,C=E.call(Object),w=RegExp("^"+E.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),A=l?a.Buffer:void 0,O=a.Symbol,P=a.Uint8Array,D=A?A.allocUnsafe:void 0,x=function overArg(e,t){return function(n){return e(t(n))}}(Object.getPrototypeOf,Object),R=Object.create,N=_.propertyIsEnumerable,M=y.splice,L=O?O.toStringTag:void 0,j=function(){try{var e=getNative(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),k=A?A.isBuffer:void 0,F=Math.max,U=Date.now,V=getNative(a,"Map"),B=getNative(Object,"create"),J=function(){function object(){}return function(e){if(!isObject(e))return{};if(R)return R(e);object.prototype=e;var t=new object;return object.prototype=void 0,t}}();function Hash(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ListCache(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function MapCache(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Stack(e){var t=this.__data__=new ListCache(e);this.size=t.size}function arrayLikeKeys(e,t){var n=H(e),r=!n&&q(e),o=!n&&!r&&Y(e),i=!n&&!r&&!o&&K(e),s=n||r||o||i,a=s?function baseTimes(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],c=a.length;for(var u in e)!t&&!I.call(e,u)||s&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||isIndex(u,c))||a.push(u);return a}function assignMergeValue(e,t,n){(void 0!==n&&!eq(e[t],n)||void 0===n&&!(t in e))&&baseAssignValue(e,t,n)}function assignValue(e,t,n){var r=e[t];I.call(e,t)&&eq(r,n)&&(void 0!==n||t in e)||baseAssignValue(e,t,n)}function assocIndexOf(e,t){for(var n=e.length;n--;)if(eq(e[n][0],t))return n;return-1}function baseAssignValue(e,t,n){"__proto__"==t&&j?j(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}Hash.prototype.clear=function hashClear(){this.__data__=B?B(null):{},this.size=0},Hash.prototype.delete=function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Hash.prototype.get=function hashGet(e){var t=this.__data__;if(B){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return I.call(t,e)?t[e]:void 0},Hash.prototype.has=function hashHas(e){var t=this.__data__;return B?void 0!==t[e]:I.call(t,e)},Hash.prototype.set=function hashSet(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=B&&void 0===t?"__lodash_hash_undefined__":t,this},ListCache.prototype.clear=function listCacheClear(){this.__data__=[],this.size=0},ListCache.prototype.delete=function listCacheDelete(e){var t=this.__data__,n=assocIndexOf(t,e);return!(n<0)&&(n==t.length-1?t.pop():M.call(t,n,1),--this.size,!0)},ListCache.prototype.get=function listCacheGet(e){var t=this.__data__,n=assocIndexOf(t,e);return n<0?void 0:t[n][1]},ListCache.prototype.has=function listCacheHas(e){return assocIndexOf(this.__data__,e)>-1},ListCache.prototype.set=function listCacheSet(e,t){var n=this.__data__,r=assocIndexOf(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},MapCache.prototype.clear=function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(V||ListCache),string:new Hash}},MapCache.prototype.delete=function mapCacheDelete(e){var t=getMapData(this,e).delete(e);return this.size-=t?1:0,t},MapCache.prototype.get=function mapCacheGet(e){return getMapData(this,e).get(e)},MapCache.prototype.has=function mapCacheHas(e){return getMapData(this,e).has(e)},MapCache.prototype.set=function mapCacheSet(e,t){var n=getMapData(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Stack.prototype.clear=function stackClear(){this.__data__=new ListCache,this.size=0},Stack.prototype.delete=function stackDelete(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Stack.prototype.get=function stackGet(e){return this.__data__.get(e)},Stack.prototype.has=function stackHas(e){return this.__data__.has(e)},Stack.prototype.set=function stackSet(e,t){var n=this.__data__;if(n instanceof ListCache){var r=n.__data__;if(!V||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new MapCache(r)}return n.set(e,t),this.size=n.size,this};var $=function createBaseFor(e){return function(t,n,r){for(var o=-1,i=Object(t),s=r(t),a=s.length;a--;){var c=s[e?a:++o];if(!1===n(i[c],c,i))break}return t}}();function baseGetTag(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":L&&L in Object(e)?function getRawTag(e){var t=I.call(e,L),n=e[L];try{e[L]=void 0;var r=!0}catch(e){}var o=S.call(e);r&&(t?e[L]=n:delete e[L]);return o}(e):function objectToString(e){return S.call(e)}(e)}function baseIsArguments(e){return isObjectLike(e)&&"[object Arguments]"==baseGetTag(e)}function baseIsNative(e){return!(!isObject(e)||function isMasked(e){return!!b&&b in e}(e))&&(isFunction(e)?w:n).test(function toSource(e){if(null!=e){try{return E.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function baseKeysIn(e){if(!isObject(e))return function nativeKeysIn(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=isPrototype(e),n=[];for(var r in e)("constructor"!=r||!t&&I.call(e,r))&&n.push(r);return n}function baseMerge(e,t,n,r,o){e!==t&&$(t,(function(i,s){if(o||(o=new Stack),isObject(i))!function baseMergeDeep(e,t,n,r,o,i,s){var a=safeGet(e,n),c=safeGet(t,n),u=s.get(c);if(u)return void assignMergeValue(e,n,u);var l=i?i(a,c,n+"",e,t,s):void 0,d=void 0===l;if(d){var p=H(c),h=!p&&Y(c),m=!p&&!h&&K(c);l=c,p||h||m?H(a)?l=a:!function isArrayLikeObject(e){return isObjectLike(e)&&isArrayLike(e)}(a)?h?(d=!1,l=function cloneBuffer(e,t){if(t)return e.slice();var n=e.length,r=D?D(n):new e.constructor(n);return e.copy(r),r}(c,!0)):m?(d=!1,l=function cloneTypedArray(e,t){var n=t?function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new P(t).set(new P(e)),t}(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(c,!0)):l=[]:l=function copyArray(e,t){var n=-1,r=e.length;t||(t=Array(r));for(;++n<r;)t[n]=e[n];return t}(a):function isPlainObject(e){if(!isObjectLike(e)||"[object Object]"!=baseGetTag(e))return!1;var t=x(e);if(null===t)return!0;var n=I.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&E.call(n)==C}(c)||q(c)?(l=a,q(a)?l=function toPlainObject(e){return function copyObject(e,t,n,r){var o=!n;n||(n={});var i=-1,s=t.length;for(;++i<s;){var a=t[i],c=r?r(n[a],e[a],a,n,e):void 0;void 0===c&&(c=e[a]),o?baseAssignValue(n,a,c):assignValue(n,a,c)}return n}(e,keysIn(e))}(a):isObject(a)&&!isFunction(a)||(l=function initCloneObject(e){return"function"!=typeof e.constructor||isPrototype(e)?{}:J(x(e))}(c))):d=!1}d&&(s.set(c,l),o(l,c,r,i,s),s.delete(c));assignMergeValue(e,n,l)}(e,t,s,n,baseMerge,r,o);else{var a=r?r(safeGet(e,s),i,s+"",e,t,o):void 0;void 0===a&&(a=i),assignMergeValue(e,s,a)}}),keysIn)}function baseRest(e,t){return G(function overRest(e,t,n){return t=F(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,i=F(r.length-t,0),s=Array(i);++o<i;)s[o]=r[t+o];o=-1;for(var a=Array(t+1);++o<t;)a[o]=r[o];return a[t]=n(s),apply(e,this,a)}}(e,t,identity),e+"")}function customDefaultsMerge(e,t,n,r,o,i){return isObject(e)&&isObject(t)&&(i.set(t,e),baseMerge(e,t,void 0,customDefaultsMerge,i),i.delete(t)),e}function getMapData(e,t){var n=e.__data__;return function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function getNative(e,t){var n=function getValue(e,t){return null==e?void 0:e[t]}(e,t);return baseIsNative(n)?n:void 0}function isIndex(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&r.test(e))&&e>-1&&e%1==0&&e<t}function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||_)}function safeGet(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var G=function shortOut(e){var t=0,n=0;return function(){var r=U(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(j?function(e,t){return j(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:identity);function eq(e,t){return e===t||e!=e&&t!=t}var q=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike(e)&&I.call(e,"callee")&&!N.call(e,"callee")},H=Array.isArray;function isArrayLike(e){return null!=e&&isLength(e.length)&&!isFunction(e)}var Y=k||function stubFalse(){return!1};function isFunction(e){if(!isObject(e))return!1;var t=baseGetTag(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function isObjectLike(e){return null!=e&&"object"==typeof e}var K=h?function baseUnary(e){return function(t){return e(t)}}(h):function baseIsTypedArray(e){return isObjectLike(e)&&isLength(e.length)&&!!o[baseGetTag(e)]};var z=baseRest((function(e){return e.push(void 0,customDefaultsMerge),apply(W,void 0,e)}));function keysIn(e){return isArrayLike(e)?arrayLikeKeys(e,!0):baseKeysIn(e)}var W=function createAssigner(e){return baseRest((function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,s=o>2?n[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,s&&function isIterateeCall(e,t,n){if(!isObject(n))return!1;var r=typeof t;if("number"==r?isArrayLike(n)&&isIndex(t,n.length):"string"==r&&t in n)return eq(n[t],e);return!1}(n[0],n[1],s)&&(i=o<3?void 0:i,o=1),t=Object(t);++r<o;){var a=n[r];a&&e(t,a,r,i)}return t}))}((function(e,t,n,r){baseMerge(e,t,n,r)}));function identity(e){return e}e.exports=z}).call(this,n(34)(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntryTtl=void 0,function(e){e[e.NO_PROPAGATION=0]="NO_PROPAGATION",e[e.UNLIMITED_PROPAGATION=-1]="UNLIMITED_PROPAGATION"}(t.EntryTtl||(t.EntryTtl={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValueType=void 0,function(e){e[e.INT=0]="INT",e[e.DOUBLE=1]="DOUBLE"}(t.ValueType||(t.ValueType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SamplingDecision=void 0,function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(t.SamplingDecision||(t.SamplingDecision={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpanKind=void 0,function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(t.SpanKind||(t.SpanKind={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanonicalCode=void 0,function(e){e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(t.CanonicalCode||(t.CanonicalCode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoopContextManager=void 0;var r=n(332),o=function(){function NoopContextManager(){}return NoopContextManager.prototype.active=function(){return r.Context.ROOT_CONTEXT},NoopContextManager.prototype.with=function(e,t){return t()},NoopContextManager.prototype.bind=function(e,t){return e},NoopContextManager.prototype.enable=function(){return this},NoopContextManager.prototype.disable=function(){return this},NoopContextManager}();t.NoopContextManager=o},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(822),t)},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(823),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._globalThis=void 0,t._globalThis="object"==typeof globalThis?globalThis:global},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TraceAPI=void 0;var r=n(331),o=n(150),i=function(){function TraceAPI(){}return TraceAPI.getInstance=function(){return this._instance||(this._instance=new TraceAPI),this._instance},TraceAPI.prototype.setGlobalTracerProvider=function(e){return o._global[o.GLOBAL_TRACE_API_KEY]||(o._global[o.GLOBAL_TRACE_API_KEY]=o.makeGetter(o.API_BACKWARDS_COMPATIBILITY_VERSION,e,r.NOOP_TRACER_PROVIDER)),this.getTracerProvider()},TraceAPI.prototype.getTracerProvider=function(){var e,t;return null!==(t=null===(e=o._global[o.GLOBAL_TRACE_API_KEY])||void 0===e?void 0:e.call(o._global,o.API_BACKWARDS_COMPATIBILITY_VERSION))&&void 0!==t?t:r.NOOP_TRACER_PROVIDER},TraceAPI.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},TraceAPI.prototype.disable=function(){delete o._global[o.GLOBAL_TRACE_API_KEY]},TraceAPI}();t.TraceAPI=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsAPI=void 0;var r=n(327),o=n(150),i=function(){function MetricsAPI(){}return MetricsAPI.getInstance=function(){return this._instance||(this._instance=new MetricsAPI),this._instance},MetricsAPI.prototype.setGlobalMeterProvider=function(e){return o._global[o.GLOBAL_METRICS_API_KEY]?this.getMeterProvider():(o._global[o.GLOBAL_METRICS_API_KEY]=o.makeGetter(o.API_BACKWARDS_COMPATIBILITY_VERSION,e,r.NOOP_METER_PROVIDER),e)},MetricsAPI.prototype.getMeterProvider=function(){var e,t;return null!==(t=null===(e=o._global[o.GLOBAL_METRICS_API_KEY])||void 0===e?void 0:e.call(o._global,o.API_BACKWARDS_COMPATIBILITY_VERSION))&&void 0!==t?t:r.NOOP_METER_PROVIDER},MetricsAPI.prototype.getMeter=function(e,t){return this.getMeterProvider().getMeter(e,t)},MetricsAPI.prototype.disable=function(){delete o._global[o.GLOBAL_METRICS_API_KEY]},MetricsAPI}();t.MetricsAPI=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PropagationAPI=void 0;var r=n(323),o=n(324),i=n(325),s=n(333),a=n(150),c=s.ContextAPI.getInstance(),u=function(){function PropagationAPI(){}return PropagationAPI.getInstance=function(){return this._instance||(this._instance=new PropagationAPI),this._instance},PropagationAPI.prototype.setGlobalPropagator=function(e){return a._global[a.GLOBAL_PROPAGATION_API_KEY]?this._getGlobalPropagator():(a._global[a.GLOBAL_PROPAGATION_API_KEY]=a.makeGetter(a.API_BACKWARDS_COMPATIBILITY_VERSION,e,o.NOOP_HTTP_TEXT_PROPAGATOR),e)},PropagationAPI.prototype.inject=function(e,t,n){return void 0===t&&(t=i.defaultSetter),void 0===n&&(n=c.active()),this._getGlobalPropagator().inject(n,e,t)},PropagationAPI.prototype.extract=function(e,t,n){return void 0===t&&(t=r.defaultGetter),void 0===n&&(n=c.active()),this._getGlobalPropagator().extract(n,e,t)},PropagationAPI.prototype.disable=function(){delete a._global[a.GLOBAL_PROPAGATION_API_KEY]},PropagationAPI.prototype._getGlobalPropagator=function(){var e,t;return null!==(t=null===(e=a._global[a.GLOBAL_PROPAGATION_API_KEY])||void 0===e?void 0:e.call(a._global,a.API_BACKWARDS_COMPATIBILITY_VERSION))&&void 0!==t?t:o.NOOP_HTTP_TEXT_PROPAGATOR},PropagationAPI}();t.PropagationAPI=u},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(828),t),o(n(335),t),o(n(841),t),o(n(201),t),o(n(842),t),o(n(334),t),o(n(203),t),o(n(843),t),o(n(844),t),o(n(845),t),o(n(847),t),o(n(337),t),o(n(848),t),o(n(202),t),o(n(849),t),o(n(850),t),o(n(851),t),o(n(852),t),o(n(853),t),o(n(338),t),o(n(336),t),o(n(854),t),o(n(855),t),o(n(856),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsoleLogger=void 0;const r=n(201),o=n(202);t.ConsoleLogger=class ConsoleLogger{constructor(e=o.getEnv().OTEL_LOG_LEVEL){e>=r.LogLevel.DEBUG&&(this.debug=(...e)=>{console.debug(...e)}),e>=r.LogLevel.INFO&&(this.info=(...e)=>{console.info(...e)}),e>=r.LogLevel.WARN&&(this.warn=(...e)=>{console.warn(...e)}),e>=r.LogLevel.ERROR&&(this.error=(...e)=>{console.error(...e)})}debug(e,...t){}error(e,...t){}warn(e,...t){}info(e,...t){}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(830),t),o(n(833),t),o(n(835),t),o(n(836),t),o(n(837),t),o(n(839),t),o(n(840),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BasePlugin=void 0;const r=n(290),o=n(11),i=n(831);class BasePlugin extends i.BaseAbstractPlugin{enable(e,t,n,r){return this._moduleExports=e,this._tracer=t.getTracer(this._tracerName,this._tracerVersion),this._logger=n,this._internalFilesExports=this._loadInternalFilesExports(),r&&(this._config=r),this.patch()}disable(){this.unpatch()}_loadInternalFilesExports(){if(!this._internalFilesList)return{};if(!this.version||!this.moduleName||!this._basedir)return this._logger.debug("loadInternalFiles failed because one of the required fields was missing: moduleName=%s, version=%s, basedir=%s",this.moduleName,this.version,this._basedir),{};const e={};return this._logger.debug("loadInternalFiles %o",this._internalFilesList),Object.keys(this._internalFilesList).forEach(t=>{this._loadInternalModule(t,e)}),0===Object.keys(e).length&&this._logger.debug("No internal files could be loaded for %s@%s",this.moduleName,this.version),e}_loadInternalModule(e,t){r.satisfies(this.version,e)&&(Object.keys(t).length>0&&this._logger.warn("Plugin for %s@%s, has overlap version range (%s) for internal files: %o",this.moduleName,this.version,e,this._internalFilesList),this._requireInternalFiles(this._internalFilesList[e],this._basedir,t))}_requireInternalFiles(e,t,r){e&&Object.keys(e).forEach(i=>{try{this._logger.debug("loading File %s",e[i]),r[i]=n(832)(o.join(t,e[i]))}catch(n){this._logger.error("Could not load internal file %s of module %s. Error: %s",o.join(t,e[i]),this.moduleName,n.message)}})}}t.BasePlugin=BasePlugin},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseAbstractPlugin=void 0;t.BaseAbstractPlugin=class BaseAbstractPlugin{constructor(e,t){this._tracerName=e,this._tracerVersion=t}disable(){this.unpatch()}}},function(e,t){function webpackEmptyContext(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,e.exports=webpackEmptyContext,webpackEmptyContext.id=832},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEnv=void 0;const r=n(834);t.getEnv=function getEnv(){const e=r.parseEnvironment(process.env);return Object.assign({},r.DEFAULT_ENVIRONMENT,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseEnvironment=t.DEFAULT_ENVIRONMENT=void 0;const r=n(201),o=["OTEL_SAMPLING_PROBABILITY"];function parseNumber(e,t,n,r=-1/0,o=1/0){if(void 0!==n[e]){const i=Number(n[e]);!isNaN(i)&&i>=r&&i<=o&&(t[e]=i)}}function setLogLevelFromEnv(e,t,n){const o=n[e];switch("string"==typeof o?o.toUpperCase():o){case"DEBUG":t[e]=r.LogLevel.DEBUG;break;case"INFO":t[e]=r.LogLevel.INFO;break;case"WARN":t[e]=r.LogLevel.WARN;break;case"ERROR":t[e]=r.LogLevel.ERROR}}t.DEFAULT_ENVIRONMENT={OTEL_NO_PATCH_MODULES:"",OTEL_LOG_LEVEL:r.LogLevel.INFO,OTEL_SAMPLING_PROBABILITY:1},t.parseEnvironment=function parseEnvironment(e){const n={};for(const r in t.DEFAULT_ENVIRONMENT){const t=r;switch(t){case"OTEL_SAMPLING_PROBABILITY":parseNumber(t,n,e,0,1);break;case"OTEL_LOG_LEVEL":setLogLevelFromEnv(t,n,e);break;default:o.indexOf(t)>=0?parseNumber(t,n,e):void 0!==e[t]&&(n[t]=e[t])}}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hexToBase64=void 0,t.hexToBase64=function hexToBase64(e){const t=e.length;let n="";for(let r=0;r<t;r+=2){const t=e.substring(r,r+2),o=parseInt(t,16);n+=String.fromCharCode(o)}return Buffer.from(n,"ascii").toString("base64")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RandomIdGenerator=void 0;const r=n(16);t.RandomIdGenerator=class RandomIdGenerator{generateTraceId(){return r.randomBytes(16).toString("hex")}generateSpanId(){return r.randomBytes(8).toString("hex")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.otperformance=void 0;const r=n(838);t.otperformance=r.performance},function(e,t){e.exports=require("perf_hooks")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SDK_INFO=void 0;const r=n(334);t.SDK_INFO={NAME:"opentelemetry",RUNTIME:"node",LANGUAGE:"nodejs",VERSION:r.VERSION}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unrefTimer=void 0,t.unrefTimer=function unrefTimer(e){e.unref()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTimeInput=t.isTimeInputHrTime=t.hrTimeToMicroseconds=t.hrTimeToMilliseconds=t.hrTimeToNanoseconds=t.hrTimeToTimeStamp=t.hrTimeDuration=t.timeInputToHrTime=t.hrTime=void 0;const r=n(202),o=Math.pow(10,9);function numberToHrtime(e){const t=e/1e3,n=Math.trunc(t);return[n,Number((t-n).toFixed(9))*o]}function getTimeOrigin(){let e=r.otperformance.timeOrigin;if("number"!=typeof e){const t=r.otperformance;e=t.timing&&t.timing.fetchStart}return e}function hrTime(e){const t=numberToHrtime(getTimeOrigin()),n=numberToHrtime("number"==typeof e?e:r.otperformance.now());let i=t[0]+n[0],s=t[1]+n[1];return s>o&&(s-=o,i+=1),[i,s]}function isTimeInputHrTime(e){return Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}t.hrTime=hrTime,t.timeInputToHrTime=function timeInputToHrTime(e){if(isTimeInputHrTime(e))return e;if("number"==typeof e)return e<getTimeOrigin()?hrTime(e):numberToHrtime(e);if(e instanceof Date)return[e.getTime(),0];throw TypeError("Invalid input type")},t.hrTimeDuration=function hrTimeDuration(e,t){let n=t[0]-e[0],r=t[1]-e[1];return r<0&&(n-=1,r+=o),[n,r]},t.hrTimeToTimeStamp=function hrTimeToTimeStamp(e){const t=`${"0".repeat(9)}${e[1]}Z`,n=t.substr(t.length-9-1);return new Date(1e3*e[0]).toISOString().replace("000Z",n)},t.hrTimeToNanoseconds=function hrTimeToNanoseconds(e){return e[0]*o+e[1]},t.hrTimeToMilliseconds=function hrTimeToMilliseconds(e){return Math.round(1e3*e[0]+e[1]/1e6)},t.hrTimeToMicroseconds=function hrTimeToMicroseconds(e){return Math.round(1e6*e[0]+e[1]/1e3)},t.isTimeInputHrTime=isTimeInputHrTime,t.isTimeInput=function isTimeInput(e){return isTimeInputHrTime(e)||"number"==typeof e||e instanceof Date}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExportResult=void 0,function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILED_NOT_RETRYABLE=1]="FAILED_NOT_RETRYABLE",e[e.FAILED_RETRYABLE=2]="FAILED_RETRYABLE"}(t.ExportResult||(t.ExportResult={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.B3Propagator=t.X_B3_SAMPLED=t.X_B3_SPAN_ID=t.X_B3_TRACE_ID=void 0;const r=n(41),o=n(203);t.X_B3_TRACE_ID="x-b3-traceid",t.X_B3_SPAN_ID="x-b3-spanid",t.X_B3_SAMPLED="x-b3-sampled";const i=/^([0-9a-f]{16}){1,2}$/i,s=/^[0-9a-f]{16}$/i,a=/^0+$/i;function isValidTraceId(e){return i.test(e)&&!a.test(e)}function isValidSpanId(e){return s.test(e)&&!a.test(e)}t.B3Propagator=class B3Propagator{inject(e,n,i){const s=o.getParentSpanContext(e);s&&isValidTraceId(s.traceId)&&isValidSpanId(s.spanId)&&(i(n,t.X_B3_TRACE_ID,s.traceId),i(n,t.X_B3_SPAN_ID,s.spanId),void 0!==s.traceFlags&&i(n,t.X_B3_SAMPLED,(r.TraceFlags.SAMPLED&s.traceFlags)===r.TraceFlags.SAMPLED?"1":"0"))}extract(e,n,i){const s=i(n,t.X_B3_TRACE_ID),a=i(n,t.X_B3_SPAN_ID),c=i(n,t.X_B3_SAMPLED),u=Array.isArray(s)?s[0]:s,l=Array.isArray(a)?a[0]:a,d=Array.isArray(c)?c[0]:c;if("string"!=typeof u||"string"!=typeof l)return e;const p=u.padStart(32,"0");return isValidTraceId(p)&&isValidSpanId(l)?o.setExtractedSpanContext(e,{traceId:p,spanId:l,isRemote:!0,traceFlags:isNaN(Number(d))?r.TraceFlags.NONE:Number(d)}):e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompositePropagator=void 0;const r=n(335);t.CompositePropagator=class CompositePropagator{constructor(e={}){var t,n;this._propagators=null!==(t=e.propagators)&&void 0!==t?t:[],this._logger=null!==(n=e.logger)&&void 0!==n?n:new r.NoopLogger}inject(e,t,n){for(const r of this._propagators)try{r.inject(e,t,n)}catch(e){this._logger.warn(`Failed to inject with ${r.constructor.name}. Err: ${e.message}`)}}extract(e,t,n){return this._propagators.reduce((e,r)=>{try{return r.extract(e,t,n)}catch(e){this._logger.warn(`Failed to inject with ${r.constructor.name}. Err: ${e.message}`)}return e},e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpTraceContext=t.parseTraceParent=t.TRACE_STATE_HEADER=t.TRACE_PARENT_HEADER=void 0;const r=n(41),o=n(336),i=n(203);t.TRACE_PARENT_HEADER="traceparent",t.TRACE_STATE_HEADER="tracestate";const s=/^(?!ff)[\da-f]{2}-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-|$)/;function parseTraceParent(e){const t=e.match(s);return t&&"00000000000000000000000000000000"!==t[1]&&"0000000000000000"!==t[2]?{traceId:t[1],spanId:t[2],traceFlags:parseInt(t[3],16)}:null}t.parseTraceParent=parseTraceParent;t.HttpTraceContext=class HttpTraceContext{inject(e,n,o){const s=i.getParentSpanContext(e);if(!s)return;const a=`00-${s.traceId}-${s.spanId}-0${Number(s.traceFlags||r.TraceFlags.NONE).toString(16)}`;o(n,t.TRACE_PARENT_HEADER,a),s.traceState&&o(n,t.TRACE_STATE_HEADER,s.traceState.serialize())}extract(e,n,r){const s=r(n,t.TRACE_PARENT_HEADER);if(!s)return e;const a=Array.isArray(s)?s[0]:s;if("string"!=typeof a)return e;const c=parseTraceParent(a);if(!c)return e;c.isRemote=!0;const u=r(n,t.TRACE_STATE_HEADER);if(u){const e=Array.isArray(u)?u.join(","):u;c.traceState=new o.TraceState("string"==typeof e?e:void 0)}return i.setExtractedSpanContext(e,c)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateValue=t.validateKey=void 0;const r=new RegExp("^(?:[a-z][_0-9a-z-*/]{0,255}|[a-z0-9][_0-9a-z-*/]{0,240}@[a-z][_0-9a-z-*/]{0,13})$"),o=/^[ -~]{0,255}[!-~]$/,i=/,|=/;t.validateKey=function validateKey(e){return r.test(e)},t.validateValue=function validateValue(e){return o.test(e)&&!i.test(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpCorrelationContext=t.MAX_TOTAL_LENGTH=t.MAX_PER_NAME_VALUE_PAIRS=t.MAX_NAME_VALUE_PAIRS=t.CORRELATION_CONTEXT_HEADER=void 0;const r=n(337);t.CORRELATION_CONTEXT_HEADER="otcorrelations",t.MAX_NAME_VALUE_PAIRS=180,t.MAX_PER_NAME_VALUE_PAIRS=4096,t.MAX_TOTAL_LENGTH=8192;t.HttpCorrelationContext=class HttpCorrelationContext{inject(e,n,o){const i=r.getCorrelationContext(e);if(!i)return;const s=this._getKeyPairs(i).filter(e=>e.length<=t.MAX_PER_NAME_VALUE_PAIRS).slice(0,t.MAX_NAME_VALUE_PAIRS),a=this._serializeKeyPairs(s);a.length>0&&o(n,t.CORRELATION_CONTEXT_HEADER,a)}_serializeKeyPairs(e){return e.reduce((e,n)=>{const r=`${e}${""!=e?",":""}${n}`;return r.length>t.MAX_TOTAL_LENGTH?e:r},"")}_getKeyPairs(e){return Object.keys(e).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t].value)}`)}extract(e,n,o){const i=o(n,t.CORRELATION_CONTEXT_HEADER);if(!i)return e;const s={};if(0==i.length)return e;const a=i.split(",");return 1==a.length?e:(a.forEach(e=>{const t=this._parsePairKeyValue(e);t&&(s[t.key]={value:t.value})}),r.setCorrelationContext(e,s))}_parsePairKeyValue(e){const t=e.split(";");if(t.length<=0)return;const n=t.shift();if(!n)return;const r=n.split("=");if(r.length<=1)return;const o=decodeURIComponent(r[0].trim());let i=decodeURIComponent(r[1].trim());return t.length>0&&(i=i+";"+t.join(";")),{key:o,value:i}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoRecordingSpan=void 0;const r=n(41),o=n(338);class NoRecordingSpan extends r.NoopSpan{constructor(e){super(e),this._context=e||o.INVALID_SPAN_CONTEXT}context(){return this._context}}t.NoRecordingSpan=NoRecordingSpan},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AlwaysOffSampler=void 0;const r=n(41);t.AlwaysOffSampler=class AlwaysOffSampler{shouldSample(){return{decision:r.SamplingDecision.NOT_RECORD}}toString(){return"AlwaysOffSampler"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AlwaysOnSampler=void 0;const r=n(41);t.AlwaysOnSampler=class AlwaysOnSampler{shouldSample(){return{decision:r.SamplingDecision.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParentOrElseSampler=void 0;const r=n(41);t.ParentOrElseSampler=class ParentOrElseSampler{constructor(e){this._delegateSampler=e}shouldSample(e,t,n,o,i,s){return e?{decision:(r.TraceFlags.SAMPLED&e.traceFlags)===r.TraceFlags.SAMPLED?r.SamplingDecision.RECORD_AND_SAMPLED:r.SamplingDecision.NOT_RECORD}:this._delegateSampler.shouldSample(e,t,n,o,i,s)}toString(){return`ParentOrElse{${this._delegateSampler.toString()}}`}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProbabilitySampler=void 0;const r=n(41);t.ProbabilitySampler=class ProbabilitySampler{constructor(e=0){this._probability=e,this._probability=this._normalize(e)}shouldSample(e){return e?{decision:(r.TraceFlags.SAMPLED&e.traceFlags)===r.TraceFlags.SAMPLED?r.SamplingDecision.RECORD_AND_SAMPLED:r.SamplingDecision.NOT_RECORD}:{decision:Math.random()<this._probability?r.SamplingDecision.RECORD_AND_SAMPLED:r.SamplingDecision.NOT_RECORD}}toString(){return`ProbabilitySampler{${this._probability}}`}_normalize(e){return"number"!=typeof e||isNaN(e)?0:e>=1?1:e<=0?0:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";function urlMatches(e,t){return"string"==typeof t?e===t:!!e.match(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.isUrlIgnored=t.urlMatches=void 0,t.urlMatches=urlMatches,t.isUrlIgnored=function isUrlIgnored(e,t){if(!t)return!1;for(const n of t)if(urlMatches(e,n))return!0;return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWrapped=void 0,t.isWrapped=function isWrapped(e){return"function"==typeof e&&"function"==typeof e.__original&&"function"==typeof e.__unwrap&&!0===e.__wrapped}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r={binaryOptions:{chunkSize:n(307).FileHelper.sizeToBytes(5,"MB"),maximumConcurrentTransaction:4,retryOptions:{retry:3,minimumTimeout:100,maximumTimeout:1/0,retryableErrors:[429,"5XX"]}}};t.default=r},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(14),i=n(6),s=n(309),a=n(2),c=n(151);t.SDKCore=class SDKCore{constructor(e,t,n,r){this.dataConnector=e,this.propertyFactory=t,this.logger=n,this.tracing=r,this.batchStack=[],this.modelRegistry=new i.ModelRegistry(t),this.modelRegistry.register(o.binaryAssetTypeId,o.BinaryAsset),this.modelRegistry.register(o.assetTypeId,o.Asset),this.modelRegistry.register(o.spaceCollectionTypeId,o.SpaceCollection),this.modelRegistry.register(o.spaceTypeId,o.Space),this.modelRegistry.register(o.assetGraphTypeId,o.AssetGraph),this.modelRegistry.register(o.snapshotTypeId,o.Snapshot),this.modelRegistry.register(o.relationshipTypeId,o.Relationship)}getTracingOptions(){return this.tracing}getDataConnector(){return this.dataConnector}get(e,t,n,o){return r(this,void 0,void 0,(function*(){if(void 0===e||void 0===t)return;let r;if(o.fetch){const s=yield c.withSpan(this.tracing,"query","entity",()=>n(this,{spaceCollectionId:i.extractId(t),id:i.extractId(e),revisionId:o.revisionId||void 0}));if(!s)return;yield this.modelRegistry.validateData(s),r=this.buildModel(s.typeid,s.typeid,i.extractId(e),i.extractId(t),{initialData:s,fetched:!0})}else{if(!o.assumeTypeId)throw new a.SDKError("When building a proxy with fetch=false, assumeTypeId must be set");r=this.buildModel(o.assumeTypeId,o.assumeTypeId,i.extractId(e),i.extractId(t),{initialData:{spaceCollectionId:t},revisionId:o.revisionId||void 0,fetched:!1})}return r}))}buildModel(e,t,n,r,i){var s;if(e!==t&&!this.propertyFactory.inheritsFrom(t,e))throw new a.SDKError("The provided typeid does not inherit from "+e);const c=this.modelRegistry.get(t);if(!c)throw new a.SDKError(`Could not build a model for typeid '${t}'`);const u=new c(this,(null===(s=null==i?void 0:i.initialData)||void 0===s?void 0:s.id)||n,r,t);if(i){const e=i.initialData||{spaceCollectionId:r};u instanceof o.AccessControlEntity&&void 0!==i.inheritParentPermissions?u.initWithData(Object.assign(Object.assign({},e),{inheritParentPermissions:i.inheritParentPermissions}),!!i.fetched):u instanceof o.Entity&&i.revisionId?u.initWithData(Object.assign(Object.assign({},e),{revisionId:i.revisionId}),!!i.fetched):u.initWithData(e,!!i.fetched)}return u}isBatching(){return this.batchStack.length>0}beginBatch(){this.batchStack.push(new s.Batch(this))}endBatch(){return r(this,void 0,void 0,(function*(){const e=this.batchStack.pop();if(e)return e.execute();throw new a.SDKError("Trying to end batch when there are no batches to end.")}))}cancelBatch(){if(this.batchStack.length<1)throw new a.SDKError("Trying to cancel a batch when there are no batches to cancel.");this.batchStack.pop()}touch(e){if(0!==this.batchStack.length){return this.batchStack[this.batchStack.length-1].addEntity(e),!0}return!1}listTouchedEntities(){const e=this.batchStack[this.batchStack.length-1];if(e)return e.listEntities();throw new a.SDKError("Trying to list entities when there are no active batches")}unTouch(e){for(const t of this.batchStack)t.removeEntity(e)}loadSchemas(e){return r(this,void 0,void 0,(function*(){const t=[];for(const n of e)this.propertyFactory.hasSchema(n)?this.logger.warn(`Schema ${n} is already registered.`):t.push(n);return c.withSpan(this.tracing,"query","schemas",()=>this.propertyFactory.prefetchSchemas(t))}))}getSettings(){return this.dataConnector.getSettings()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(41);let o;t.getTracer=function getTracer(e){const t="string"==typeof e?r.trace.getTracer(e):e;return t||(o||(o=new r.NoopTracer),o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(30),o=n(2);t.WorkingSet=class WorkingSet{constructor(){this.entities=new Map}add(e){const t=e.getId(),n=e.getRevisionId();if(!n)throw new o.InternalError("The entity must have a revisionId");this.addEntity(t,n,e)}addAsTip(e){const t=e.getId(),n=r.TIP_REVISION;this.addEntity(t,n,e)}get(e,t){return this.getEntity(e,t)}getTip(e){return this.getEntity(e,r.TIP_REVISION)}remove(e,t){this.removeEntity(e,t)}removeTip(e){this.removeEntity(e,r.TIP_REVISION)}addEntity(e,t,n){const r=this.entities.get(e);r?r.set(t,n):this.entities.set(e,new Map([[t,n]]))}getEntity(e,t){const n=this.entities.get(e);if(!n)return;const r=n.get(t);return r||void 0}removeEntity(e,t){const n=this.entities.get(e);n&&(n.delete(t),n.size||this.entities.delete(e))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(30),o=n(6);class Topology{constructor(e,t){this.assets=e,this.relationships=t}static from(e){const t=new Map,n=new Map;return e.forEach(e=>Topology.createNode(e,t,n)),new Topology(t,n)}getRelationshipsWithAsset(e){const t=this.assets.get(e.id);let n;return t&&(n=t.get(e.revisionId)),n||new Set}getRelationshipAssetIdentifiers(e){const t=this.relationships.get(e.id);return t&&t.get(e.revisionId)||null}getRelationshipsAssetIdentifiers(e){const t=new Map;return e.forEach(e=>{t.set(e,this.getRelationshipAssetIdentifiers(e))}),t}getRelationshipsAssetIdentifiersWithAsset(e){return this.getRelationshipsAssetIdentifiers([...this.getRelationshipsWithAsset(e)])}static createNode(e,t,n){Topology.createNodeAssets(e,t),Topology.createNodeRelationships(e,n)}static createNodeAssets(e,t){Topology.createNodeAsset(e,e.fromAssetId,e.fromAssetRevision,t),e.toAssetId===e.fromAssetId&&e.toAssetRevision===e.fromAssetRevision||Topology.createNodeAsset(e,e.toAssetId,e.toAssetRevision,t)}static createNodeAsset(e,t,n,i){let s=i.get(t);s||(s=new Map,i.set(t,s));const a=n||r.TIP_REVISION;let c=s.get(a);c||(c=new Set,s.set(a,c));const u=new o.EntityIdentifier(e.relationshipId,e.relationshipRevision);c.add(u)}static createNodeRelationships(e,t){let n=t.get(e.relationshipId);n||(n=new Map,t.set(e.relationshipId,n)),n.set(e.relationshipRevision,{from:new o.EntityIdentifier(e.fromAssetId,e.fromAssetRevision),to:new o.EntityIdentifier(e.toAssetId,e.toAssetRevision)})}}t.Topology=Topology},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(6);class TopologyV2{constructor(e,t){this.nodes=e,this.edges=t}static buildFrom(e,t,n,r){const o=new Map,i=new Map;return e.nodes.forEach(e=>TopologyV2.createNode(e,o,t,n)),e.edges.forEach(o=>TopologyV2.createEdge(o,i,e.nodes,t,n,r)),new TopologyV2(o,i)}static createNode(e,t,n,r){const o=n[e.assetIdx],i=void 0!==e.snapshotContextIdx?r[e.snapshotContextIdx]:void 0,s=this.generateNodeIdentifier(o,i);t.set(s,{asset:o,snapshot:void 0!==e.assetInSnapshot&&e.assetInSnapshot?i:void 0,snapshotContext:i,excluded:e.excluded})}static createEdge(e,t,n,r,o,i){const s=i[e.relationshipIdx],a=n[e.fromNode],c=r[a.assetIdx],u=void 0!==a.snapshotContextIdx?o[a.snapshotContextIdx]:void 0,l=n[e.toNode],d=r[l.assetIdx],p=void 0!==l.snapshotContextIdx?o[l.snapshotContextIdx]:void 0,h=this.generateNodeIdentifier(c,u),m=this.generateNodeIdentifier(d,p),y=t.get(h)||[],g=t.get(m)||[],_={fromNodeIdentifier:h,toNodeIdentifier:m,relationship:s};y.push(_),g.push(_),t.set(h,y),t.set(m,g)}getNode(e){return this.nodes.get(e)}getEdges(e){return this.edges.get(e)||[]}static generateNodeIdentifier(e,t){const n=r.extractId(e);let o;return void 0!==t&&(o=r.extractId(t)),`${n}${t?"/"+o:""}`}}t.TopologyV2=TopologyV2},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(47),i=n(2),s=n(6),a=n(24),c=n(36),u=n(372),l=n(110);class AssetCommandsRegistry{static createPayload(e){return{type:e.typeid,space:{id:e.spaceId},attributes:s.AttributeConverter.convertChangeSetToAttributesV2(e.attributes),components:e.components,policies:s.PolicyConverter.convertChangeSetToPolicyRequests(e.policies),createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy}}static createLocally(e,t,n){return r(this,void 0,void 0,(function*(){c.validateUserState(n);const r=a.OfflineEntityWrapper.initialize();r.setEntityType("Asset"),r.setTypeId(t.typeid);const o=e.getStoredId("id"),s=e.getStoredId("revisionId");r.setId(o),r.setRevisionId(s);yield e.getEntity(t.spaceId);r.setParentId(t.spaceId),r.setAttributes(t.attributes),r.setComponents(t.components);const u=r.getFullEntity(),l=yield e.createEntity(u);if(!l)throw new i.SDKError("Error with creating an asset locally");return{resourceId:l.entityId,resourceUrn:"/asset/"+l.entityId,revisionId:l.revisionId,createdDate:new Date}}))}static updatePayload(e){return{attributes:s.AttributeConverter.convertTypedChangesetToGeneric(e.attributes),components:e.components,policies:e.policies,createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy}}static updateLocally(e,t,n){return r(this,void 0,void 0,(function*(){c.validateUserState(n);const r=yield e.getEntity(t.resourceId),o=a.OfflineEntityWrapper.initialize(r);if(!r)throw new Error("404");o.setId(t.resourceId),e.setStoredId("id",t.resourceId);const i=e.getStoredId("revisionId");o.setRevisionId(i),o.setAttributes(t.attributes),o.setComponents(t.components);const s=o.getFullEntity(),u=yield e.updateEntity(t.resourceId,s);return{resourceId:u.entityId,resourceUrn:"/asset/"+u.entityId,revisionId:u.revisionId,createdDate:new Date}}))}static deletePayload(e){return{}}static purgePayload(e){return{}}static restorePayload(e){return{}}static movePayload(e){return{space:{id:e.toSpaceId},assets:e.entitiesToMove.map(e=>({id:e}))}}static moveLocally(e,t,n){return r(this,void 0,void 0,(function*(){let r;c.validateUserState(n);for(const n of t.entitiesToMove){const o=yield e.getEntity(n),i=a.OfflineEntityWrapper.initialize(o);if(!o)throw new Error(`Asset ${n} not found locally`);i.setSpaceId(t.toSpaceId);const s=i.getFullEntity();r=yield e.updateEntity(n,s)}return{revisionId:r.revisionId}}))}static copyPayload(e){return{space:{id:e.toSpaceId},assets:e.entitiesToCopy.map(e=>({id:e}))}}static copyLocally(e,t,n){return r(this,void 0,void 0,(function*(){if(c.validateUserState(n),0===t.entitiesToCopy.length)throw new Error("No entity to copy");const r=[],o=[];let s;for(const n of t.entitiesToCopy){const c=yield e.getEntity(n);if(!c)throw new Error(`The asset to copy ${t.resourceId} does not exist`);const u=a.OfflineEntityWrapper.initialize(c),l=a.OfflineEntityWrapper.initialize();l.setEntityType("Asset"),l.setId(e.getStoredId("id")),l.setParentId(t.toSpaceId),l.setSpaceCollectionId(u.getSpaceCollectionId()),l.setTypeId(u.getTypeId()),l.setAttributes(u.getAttributes()),l.setComponents(u.getFullComponentView());const d=l.getFullEntity();if(s=yield e.createEntity(d),!s)throw new i.SDKError("Error with copying an asset locally");r.push(s.entityId),o.push("/asset/"+s.entityId)}return u.processBatchResults(e,{result:{resourceIds:r,resourceUrns:o,revisionId:s.revisionId}})}))}static parseFetchPayload(e){return{spaceCollectionId:s.extractCollectionIdFromUrl(e.attributes.url),spaceId:e.space.id,id:e.id,attributes:s.AttributeConverter.convertAttributesToChangeset(e.attributes.data).serializedChangeSet,components:e.components.data,typeid:e.type,revisionId:e.revisionId,createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy}}static parseQueryPayload(e){const t=Object.assign({},e);return t.results=t.results.map(e=>AssetCommandsRegistry.parseFetchPayload(e)),t}static createRewriteIds(e,t,n){return r(this,void 0,void 0,(function*(){let n=e.spaceId;try{n=(yield t(n)).entityId||n}catch(e){if(e.code!==o.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST)throw new i.SDKError(e.message,e)}return Object.assign(Object.assign({},e),{spaceId:n})}))}static copyRewriteIds(e,t,n){return r(this,void 0,void 0,(function*(){let n=e.toSpaceId;try{n=(yield t(n)).entityId||n}catch(e){if(e.code!==o.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST)throw new i.SDKError(e.message,e)}const r=e.entitiesToCopy.map(e=>AssetCommandsRegistry.rewriteEntityToCopy(e,t)),s=(yield Promise.all(r)).map(e=>e.entityId);return Object.assign(Object.assign({},e),{toSpaceId:n,entitiesToCopy:s})}))}static moveAssetRewriteIds(e,t,n){return r(this,void 0,void 0,(function*(){let n=e.toSpaceId;try{n=(yield t(n)).entityId||n}catch(e){if(e.code!==o.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST)throw new i.SDKError(e.message,e)}return Object.assign(Object.assign({},e),{toSpaceId:n})}))}static processResults(e,t,n){return r(this,void 0,void 0,(function*(){if(void 0===t&&e.commandId)return e;const r=l.validateServerCommandResponse(t);if(r)return{error:r};const o=e&&e.idStore().id;if(o){c.validateUserState(n);const r=a.OfflineEntityWrapper.initialize();r.setEntityType("Asset"),r.setAsPlaceholder();const i=r.getFullEntity();yield a.storePermanentId(e,t),yield e.createEntity(Object.assign(Object.assign({entityId:o},i),{revisionId:e.idStore().revisionId,revisionPermanentId:t.result.revisionId}))}return t.result}))}static rewriteEntityToCopy(e,t){return r(this,void 0,void 0,(function*(){return t(e).catch(t=>t.code!==o.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST?Promise.reject(t):Promise.resolve({entityId:e}))}))}}t.AssetCommandsRegistry=AssetCommandsRegistry},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntityStore=void 0;t.EntityStore=class EntityStore{}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(152),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createInMemoryStore=t.InMemoryStore=t.InMemoryJournalStore=t.InMemoryEntityStore=void 0;const r=n(342);Object.defineProperty(t,"InMemoryJournalStore",{enumerable:!0,get:function(){return r.InMemoryJournalStore}});const o=n(966);Object.defineProperty(t,"InMemoryStore",{enumerable:!0,get:function(){return o.InMemoryStore}});const i=n(370);Object.defineProperty(t,"InMemoryEntityStore",{enumerable:!0,get:function(){return i.InMemoryEntityStore}}),t.createInMemoryStore=function createInMemoryStore(e){return new o.InMemoryStore(e)}},function(e,t,n){var r=n(204),o=n(896),i=n(347),s=n(898),a=n(905),c=n(908),u=n(909),l=n(910),d=n(912),p=n(358),h=n(913),m=n(160),y=n(918),g=n(919),_=n(924),v=n(42),E=n(208),I=n(926),b=n(64),S=n(928),C=n(82),w=n(212),A={};A["[object Arguments]"]=A["[object Array]"]=A["[object ArrayBuffer]"]=A["[object DataView]"]=A["[object Boolean]"]=A["[object Date]"]=A["[object Float32Array]"]=A["[object Float64Array]"]=A["[object Int8Array]"]=A["[object Int16Array]"]=A["[object Int32Array]"]=A["[object Map]"]=A["[object Number]"]=A["[object Object]"]=A["[object RegExp]"]=A["[object Set]"]=A["[object String]"]=A["[object Symbol]"]=A["[object Uint8Array]"]=A["[object Uint8ClampedArray]"]=A["[object Uint16Array]"]=A["[object Uint32Array]"]=!0,A["[object Error]"]=A["[object Function]"]=A["[object WeakMap]"]=!1,e.exports=function baseClone(e,t,n,O,P,D){var x,R=1&t,N=2&t,M=4&t;if(n&&(x=P?n(e,O,P,D):n(e)),void 0!==x)return x;if(!b(e))return e;var L=v(e);if(L){if(x=y(e),!R)return u(e,x)}else{var j=m(e),k="[object Function]"==j||"[object GeneratorFunction]"==j;if(E(e))return c(e,R);if("[object Object]"==j||"[object Arguments]"==j||k&&!P){if(x=N||k?{}:_(e),!R)return N?d(e,a(x,e)):l(e,s(x,e))}else{if(!A[j])return P?e:{};x=g(e,j,R)}}D||(D=new r);var F=D.get(e);if(F)return F;D.set(e,x),S(e)?e.forEach((function(r){x.add(baseClone(r,t,n,r,e,D))})):I(e)&&e.forEach((function(r,o){x.set(o,baseClone(r,t,n,o,e,D))}));var U=L?void 0:(M?N?h:p:N?w:C)(e);return o(U||e,(function(r,o){U&&(r=e[o=r]),i(x,o,baseClone(r,t,n,o,e,D))})),x}},function(e,t){e.exports=function listCacheClear(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(155),o=Array.prototype.splice;e.exports=function listCacheDelete(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():o.call(t,n,1),--this.size,!0)}},function(e,t,n){var r=n(155);e.exports=function listCacheGet(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(155);e.exports=function listCacheHas(e){return r(this.__data__,e)>-1}},function(e,t,n){var r=n(155);e.exports=function listCacheSet(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},function(e,t,n){var r=n(154);e.exports=function stackClear(){this.__data__=new r,this.size=0}},function(e,t){e.exports=function stackDelete(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},function(e,t){e.exports=function stackGet(e){return this.__data__.get(e)}},function(e,t){e.exports=function stackHas(e){return this.__data__.has(e)}},function(e,t,n){var r=n(154),o=n(206),i=n(207);e.exports=function stackSet(e,t){var n=this.__data__;if(n instanceof r){var s=n.__data__;if(!o||s.length<199)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new i(s)}return n.set(e,t),this.size=n.size,this}},function(e,t,n){var r=n(344),o=n(881),i=n(64),s=n(346),a=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,l=c.toString,d=u.hasOwnProperty,p=RegExp("^"+l.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function baseIsNative(e){return!(!i(e)||o(e))&&(r(e)?p:a).test(s(e))}},function(e,t,n){var r=n(105),o=Object.prototype,i=o.hasOwnProperty,s=o.toString,a=r?r.toStringTag:void 0;e.exports=function getRawTag(e){var t=i.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var o=s.call(e);return r&&(t?e[a]=n:delete e[a]),o}},function(e,t){var n=Object.prototype.toString;e.exports=function objectToString(e){return n.call(e)}},function(e,t,n){var r,o=n(882),i=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function isMasked(e){return!!i&&i in e}},function(e,t,n){var r=n(48)["__core-js_shared__"];e.exports=r},function(e,t){e.exports=function getValue(e,t){return null==e?void 0:e[t]}},function(e,t,n){var r=n(885),o=n(154),i=n(206);e.exports=function mapCacheClear(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},function(e,t,n){var r=n(886),o=n(887),i=n(888),s=n(889),a=n(890);function Hash(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Hash.prototype.clear=r,Hash.prototype.delete=o,Hash.prototype.get=i,Hash.prototype.has=s,Hash.prototype.set=a,e.exports=Hash},function(e,t,n){var r=n(156);e.exports=function hashClear(){this.__data__=r?r(null):{},this.size=0}},function(e,t){e.exports=function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var r=n(156),o=Object.prototype.hasOwnProperty;e.exports=function hashGet(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(t,e)?t[e]:void 0}},function(e,t,n){var r=n(156),o=Object.prototype.hasOwnProperty;e.exports=function hashHas(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},function(e,t,n){var r=n(156);e.exports=function hashSet(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t,n){var r=n(157);e.exports=function mapCacheDelete(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,n){var r=n(157);e.exports=function mapCacheGet(e){return r(this,e).get(e)}},function(e,t,n){var r=n(157);e.exports=function mapCacheHas(e){return r(this,e).has(e)}},function(e,t,n){var r=n(157);e.exports=function mapCacheSet(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},function(e,t){e.exports=function arrayEach(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},function(e,t,n){var r=n(63),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},function(e,t,n){var r=n(158),o=n(82);e.exports=function baseAssign(e,t){return e&&r(t,o(t),e)}},function(e,t){e.exports=function baseTimes(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t,n){var r=n(104),o=n(65);e.exports=function baseIsArguments(e){return o(e)&&"[object Arguments]"==r(e)}},function(e,t){e.exports=function stubFalse(){return!1}},function(e,t,n){var r=n(104),o=n(209),i=n(65),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function baseIsTypedArray(e){return i(e)&&o(e.length)&&!!s[r(e)]}},function(e,t,n){var r=n(211),o=n(904),i=Object.prototype.hasOwnProperty;e.exports=function baseKeys(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},function(e,t,n){var r=n(353)(Object.keys,Object);e.exports=r},function(e,t,n){var r=n(158),o=n(212);e.exports=function baseAssignIn(e,t){return e&&r(t,o(t),e)}},function(e,t,n){var r=n(64),o=n(211),i=n(907),s=Object.prototype.hasOwnProperty;e.exports=function baseKeysIn(e){if(!r(e))return i(e);var t=o(e),n=[];for(var a in e)("constructor"!=a||!t&&s.call(e,a))&&n.push(a);return n}},function(e,t){e.exports=function nativeKeysIn(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t,n){(function(e){var r=n(48),o=t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,s=i&&i.exports===o?r.Buffer:void 0,a=s?s.allocUnsafe:void 0;e.exports=function cloneBuffer(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}}).call(this,n(34)(e))},function(e,t){e.exports=function copyArray(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},function(e,t,n){var r=n(158),o=n(213);e.exports=function copySymbols(e,t){return r(e,o(e),t)}},function(e,t){e.exports=function arrayFilter(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var s=e[n];t(s,n,e)&&(i[o++]=s)}return i}},function(e,t,n){var r=n(158),o=n(355);e.exports=function copySymbolsIn(e,t){return r(e,o(e),t)}},function(e,t,n){var r=n(359),o=n(355),i=n(212);e.exports=function getAllKeysIn(e){return r(e,i,o)}},function(e,t,n){var r=n(63)(n(48),"DataView");e.exports=r},function(e,t,n){var r=n(63)(n(48),"Promise");e.exports=r},function(e,t,n){var r=n(63)(n(48),"Set");e.exports=r},function(e,t,n){var r=n(63)(n(48),"WeakMap");e.exports=r},function(e,t){var n=Object.prototype.hasOwnProperty;e.exports=function initCloneArray(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&n.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},function(e,t,n){var r=n(214),o=n(920),i=n(921),s=n(922),a=n(923);e.exports=function initCloneByTag(e,t,n){var c=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new c(+e);case"[object DataView]":return o(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(e,n);case"[object Map]":return new c;case"[object Number]":case"[object String]":return new c(e);case"[object RegExp]":return i(e);case"[object Set]":return new c;case"[object Symbol]":return s(e)}}},function(e,t,n){var r=n(214);e.exports=function cloneDataView(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},function(e,t){var n=/\w*$/;e.exports=function cloneRegExp(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}},function(e,t,n){var r=n(105),o=r?r.prototype:void 0,i=o?o.valueOf:void 0;e.exports=function cloneSymbol(e){return i?Object(i.call(e)):{}}},function(e,t,n){var r=n(214);e.exports=function cloneTypedArray(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},function(e,t,n){var r=n(925),o=n(357),i=n(211);e.exports=function initCloneObject(e){return"function"!=typeof e.constructor||i(e)?{}:r(o(e))}},function(e,t,n){var r=n(64),o=Object.create,i=function(){function object(){}return function(e){if(!r(e))return{};if(o)return o(e);object.prototype=e;var t=new object;return object.prototype=void 0,t}}();e.exports=i},function(e,t,n){var r=n(927),o=n(159),i=n(210),s=i&&i.isMap,a=s?o(s):r;e.exports=a},function(e,t,n){var r=n(160),o=n(65);e.exports=function baseIsMap(e){return o(e)&&"[object Map]"==r(e)}},function(e,t,n){var r=n(929),o=n(159),i=n(210),s=i&&i.isSet,a=s?o(s):r;e.exports=a},function(e,t,n){var r=n(160),o=n(65);e.exports=function baseIsSet(e){return o(e)&&"[object Set]"==r(e)}},function(e,t,n){var r=n(931),o=n(42);e.exports=function orderBy(e,t,n,i){return null==e?[]:(o(t)||(t=null==t?[]:[t]),o(n=i?void 0:n)||(n=null==n?[]:[n]),r(e,t,n))}},function(e,t,n){var r=n(361),o=n(215),i=n(217),s=n(957),a=n(963),c=n(159),u=n(964),l=n(368),d=n(42);e.exports=function baseOrderBy(e,t,n){t=t.length?r(t,(function(e){return d(e)?function(t){return o(t,1===e.length?e[0]:e)}:e})):[l];var p=-1;t=r(t,c(i));var h=s(e,(function(e,n,o){return{criteria:r(t,(function(t){return t(e)})),index:++p,value:e}}));return a(h,(function(e,t){return u(e,t,n)}))}},function(e,t,n){var r=n(933),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,s=r((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,(function(e,n,r,o){t.push(r?o.replace(i,"$1"):n||e)})),t}));e.exports=s},function(e,t,n){var r=n(934);e.exports=function memoizeCapped(e){var t=r(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},function(e,t,n){var r=n(207);function memoize(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var memoized=function(){var n=arguments,r=t?t.apply(this,n):n[0],o=memoized.cache;if(o.has(r))return o.get(r);var i=e.apply(this,n);return memoized.cache=o.set(r,i)||o,i};return memoized.cache=new(memoize.Cache||r),memoized}memoize.Cache=r,e.exports=memoize},function(e,t,n){var r=n(936);e.exports=function toString(e){return null==e?"":r(e)}},function(e,t,n){var r=n(105),o=n(361),i=n(42),s=n(108),a=r?r.prototype:void 0,c=a?a.toString:void 0;e.exports=function baseToString(e){if("string"==typeof e)return e;if(i(e))return o(e,baseToString)+"";if(s(e))return c?c.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(e,t,n){var r=n(938),o=n(949),i=n(366);e.exports=function baseMatches(e){var t=o(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},function(e,t,n){var r=n(204),o=n(363);e.exports=function baseIsMatch(e,t,n,i){var s=n.length,a=s,c=!i;if(null==e)return!a;for(e=Object(e);s--;){var u=n[s];if(c&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++s<a;){var l=(u=n[s])[0],d=e[l],p=u[1];if(c&&u[2]){if(void 0===d&&!(l in e))return!1}else{var h=new r;if(i)var m=i(d,p,l,e,t,h);if(!(void 0===m?o(p,d,3,i,h):m))return!1}}return!0}},function(e,t,n){var r=n(204),o=n(364),i=n(945),s=n(948),a=n(160),c=n(42),u=n(208),l=n(352),d="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function baseIsEqualDeep(e,t,n,h,m,y){var g=c(e),_=c(t),v=g?"[object Array]":a(e),E=_?"[object Array]":a(t),I=(v="[object Arguments]"==v?d:v)==d,b=(E="[object Arguments]"==E?d:E)==d,S=v==E;if(S&&u(e)){if(!u(t))return!1;g=!0,I=!1}if(S&&!I)return y||(y=new r),g||l(e)?o(e,t,n,h,m,y):i(e,t,v,n,h,m,y);if(!(1&n)){var C=I&&p.call(e,"__wrapped__"),w=b&&p.call(t,"__wrapped__");if(C||w){var A=C?e.value():e,O=w?t.value():t;return y||(y=new r),m(A,O,n,h,y)}}return!!S&&(y||(y=new r),s(e,t,n,h,m,y))}},function(e,t,n){var r=n(207),o=n(941),i=n(942);function SetCache(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}SetCache.prototype.add=SetCache.prototype.push=o,SetCache.prototype.has=i,e.exports=SetCache},function(e,t){e.exports=function setCacheAdd(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(e,t){e.exports=function setCacheHas(e){return this.__data__.has(e)}},function(e,t){e.exports=function arraySome(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},function(e,t){e.exports=function cacheHas(e,t){return e.has(t)}},function(e,t,n){var r=n(105),o=n(360),i=n(205),s=n(364),a=n(946),c=n(947),u=r?r.prototype:void 0,l=u?u.valueOf:void 0;e.exports=function equalByTag(e,t,n,r,u,d,p){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new o(e),new o(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var h=a;case"[object Set]":var m=1&r;if(h||(h=c),e.size!=t.size&&!m)return!1;var y=p.get(e);if(y)return y==t;r|=2,p.set(e,t);var g=s(h(e),h(t),r,u,d,p);return p.delete(e),g;case"[object Symbol]":if(l)return l.call(e)==l.call(t)}return!1}},function(e,t){e.exports=function mapToArray(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},function(e,t){e.exports=function setToArray(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},function(e,t,n){var r=n(358),o=Object.prototype.hasOwnProperty;e.exports=function equalObjects(e,t,n,i,s,a){var c=1&n,u=r(e),l=u.length;if(l!=r(t).length&&!c)return!1;for(var d=l;d--;){var p=u[d];if(!(c?p in t:o.call(t,p)))return!1}var h=a.get(e),m=a.get(t);if(h&&m)return h==t&&m==e;var y=!0;a.set(e,t),a.set(t,e);for(var g=c;++d<l;){var _=e[p=u[d]],v=t[p];if(i)var E=c?i(v,_,p,t,e,a):i(_,v,p,e,t,a);if(!(void 0===E?_===v||s(_,v,n,i,a):E)){y=!1;break}g||(g="constructor"==p)}if(y&&!g){var I=e.constructor,b=t.constructor;I==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof I&&I instanceof I&&"function"==typeof b&&b instanceof b||(y=!1)}return a.delete(e),a.delete(t),y}},function(e,t,n){var r=n(365),o=n(82);e.exports=function getMatchData(e){for(var t=o(e),n=t.length;n--;){var i=t[n],s=e[i];t[n]=[i,s,r(s)]}return t}},function(e,t,n){var r=n(363),o=n(367),i=n(951),s=n(216),a=n(365),c=n(366),u=n(162);e.exports=function baseMatchesProperty(e,t){return s(e)&&a(t)?c(u(e),t):function(n){var s=o(n,e);return void 0===s&&s===t?i(n,e):r(t,s,3)}}},function(e,t,n){var r=n(952),o=n(953);e.exports=function hasIn(e,t){return null!=e&&o(e,t,r)}},function(e,t){e.exports=function baseHasIn(e,t){return null!=e&&t in Object(e)}},function(e,t,n){var r=n(362),o=n(350),i=n(42),s=n(351),a=n(209),c=n(162);e.exports=function hasPath(e,t,n){for(var u=-1,l=(t=r(t,e)).length,d=!1;++u<l;){var p=c(t[u]);if(!(d=null!=e&&n(e,p)))break;e=e[p]}return d||++u!=l?d:!!(l=null==e?0:e.length)&&a(l)&&s(p,l)&&(i(e)||o(e))}},function(e,t,n){var r=n(955),o=n(956),i=n(216),s=n(162);e.exports=function property(e){return i(e)?r(s(e)):o(e)}},function(e,t){e.exports=function baseProperty(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,n){var r=n(215);e.exports=function basePropertyDeep(e){return function(t){return r(t,e)}}},function(e,t,n){var r=n(958),o=n(106);e.exports=function baseMap(e,t){var n=-1,i=o(e)?Array(e.length):[];return r(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}},function(e,t,n){var r=n(959),o=n(962)(r);e.exports=o},function(e,t,n){var r=n(960),o=n(82);e.exports=function baseForOwn(e,t){return e&&r(e,t,o)}},function(e,t,n){var r=n(961)();e.exports=r},function(e,t){e.exports=function createBaseFor(e){return function(t,n,r){for(var o=-1,i=Object(t),s=r(t),a=s.length;a--;){var c=s[e?a:++o];if(!1===n(i[c],c,i))break}return t}}},function(e,t,n){var r=n(106);e.exports=function createBaseEach(e,t){return function(n,o){if(null==n)return n;if(!r(n))return e(n,o);for(var i=n.length,s=t?i:-1,a=Object(n);(t?s--:++s<i)&&!1!==o(a[s],s,a););return n}}},function(e,t){e.exports=function baseSortBy(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},function(e,t,n){var r=n(965);e.exports=function compareMultiple(e,t,n){for(var o=-1,i=e.criteria,s=t.criteria,a=i.length,c=n.length;++o<a;){var u=r(i[o],s[o]);if(u)return o>=c?u:u*("desc"==n[o]?-1:1)}return e.index-t.index}},function(e,t,n){var r=n(108);e.exports=function compareAscending(e,t){if(e!==t){var n=void 0!==e,o=null===e,i=e==e,s=r(e),a=void 0!==t,c=null===t,u=t==t,l=r(t);if(!c&&!l&&!s&&e>t||s&&a&&u&&!c&&!l||o&&a&&u||!n&&u||!i)return 1;if(!o&&!s&&!l&&e<t||l&&n&&i&&!o&&!s||c&&n&&i||!a&&i||!u)return-1}return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryStore=void 0;const r=n(369),o=n(370),i=n(342);class InMemoryStore extends r.Store{constructor(e){const t=new i.InMemoryJournalStore;super(new o.InMemoryEntityStore(t,e),t)}}t.InMemoryStore=InMemoryStore},function(e,t,n){var r=n(968)(n(969));e.exports=r},function(e,t,n){var r=n(217),o=n(106),i=n(82);e.exports=function createFind(e){return function(t,n,s){var a=Object(t);if(!o(t)){var c=r(n,3);t=i(t),n=function(e){return c(a[e],e,a)}}var u=e(t,n,s);return u>-1?a[c?t[u]:u]:void 0}}},function(e,t,n){var r=n(970),o=n(217),i=n(971),s=Math.max,a=Math.min;e.exports=function findLastIndex(e,t,n){var c=null==e?0:e.length;if(!c)return-1;var u=c-1;return void 0!==n&&(u=i(n),u=n<0?s(c+u,0):a(u,c-1)),r(e,o(t,3),u,!0)}},function(e,t){e.exports=function baseFindIndex(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}},function(e,t,n){var r=n(972);e.exports=function toInteger(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},function(e,t,n){var r=n(973);e.exports=function toFinite(e){return e?(e=r(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},function(e,t,n){var r=n(974),o=n(64),i=n(108),s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt;e.exports=function toNumber(e){if("number"==typeof e)return e;if(i(e))return NaN;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=a.test(e);return n||c.test(e)?u(e.slice(2),n?2:8):s.test(e)?NaN:+e}},function(e,t,n){var r=n(975),o=/^\s+/;e.exports=function baseTrim(e){return e?e.slice(0,r(e)+1).replace(o,""):e}},function(e,t){var n=/\s/;e.exports=function trimmedEndIndex(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(977),t),o(n(978),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JournalStore=void 0;t.JournalStore=class JournalStore{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processQueryResults=function processQueryResults(e,t){return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2),o=n(163);t.processCommandResults=function processCommandResults(e,t){if(void 0===t&&e.commandId)return e;const n=o.validateNotProcessedResponse(t);if(n)throw new r.ServerError(n.message,n.code,n.innerError);return t.result}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(218),i=n(2),s=n(163);t.processSingleBatchResults=function processSingleBatchResults(e,t){return r(this,void 0,void 0,(function*(){const{result:n}=t;if(n.error)throw n.error;const r=s.validateNotProcessedResponse(t);if(r)throw new i.ServerError(r.message,r.code,r.innerError);if(o.isLocalContext(e)){const t=e.idStore().id;"string"==typeof t&&(yield e.setEntityPermanentId(t,n.resourceIds[0]))}return{resourceId:n.resourceIds[0],resourceUrn:n.resourceUrns[0],revisionId:n.revisionId}}))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(218);t.storePermanentId=function storePermanentId(e,t){return r(this,void 0,void 0,(function*(){if(o.isLocalContext(e)){const n=e.idStore().id;"string"==typeof n&&(yield e.setEntityPermanentId(n,t.result.resourceId))}}))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(47),i=n(2);t.updateRewriteIds=function updateRewriteIds(e,t,n){return r(this,void 0,void 0,(function*(){let n=e.resourceId;try{n=(yield t(n)).entityId||n}catch(e){if(e.code!==o.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST)throw new i.SDKError(e.message,e)}return Object.assign(Object.assign({},e),{resourceId:n})}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(99);t.mergeChangeSets=(e,t)=>{const n=t.create("NodeProperty");for(const t of e)n.applyChangeSet(new r.ChangeSet(t||{}));return n.serialize().serializedChangeSet}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(220);t.isArrayChangeSet=function isArrayChangeSet(e){return r.isChangeSet(e)&&(Array.isArray(e.insert)||Array.isArray(e.modify))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(61)),i=r(n(96)),s=r(n(13)),a=n(24),c=n(6),u=n(2),l=n(219);class OfflineRevisionWrapper extends a.OfflineEntityWrapper{static initialize(e,t){const n=new OfflineRevisionWrapper,r={};if(n.entityInfo=r,e){const d=o.default(e,["staticData"]);if(d)i.default(r,["staticDataChanges"],d),i.default(r,["staticDataChanges","attributes"],c.AttributeConverter.convertAttributesToSerializedChangeset(o.default(r,["staticDataChanges","attributes"])));else{const t=o.default(e,["staticDataChanges"]);t&&i.default(r,["staticDataChanges"],t)}const p=o.default(e,["data"]);s.default(p)||(Array.isArray(p)?(n.fullComponentView=l.ChangesetMerger.mergeAndNormalizeChangesetList(p.map(e=>e.components||{})),n.assets=l.ChangesetMerger.mergeAndNormalizeChangesetList(p.map(e=>a.OfflineEntityWrapper.alignAsset(e.assets)||{}))):(n.fullComponentView=p.components,n.assets=a.OfflineEntityWrapper.alignAsset(p.assets)));const h=o.default(e,["dataChanges"]);h&&i.default(r,["dataChanges"],h);const m=o.default(e,["parentEntityId"]);m&&n.setParentId(m);const y=o.default(e,["revisionId"]);y&&n.setRevisionId(y);const g=o.default(e,["createdBy"]);if(g&&n.setCreatedBy(g),void 0!==t&&n.getEntityType()!==t)throw new u.InternalError(`Trying to build wrapper for ${t} but entity type is ${n.getEntityType()}`)}return n}}t.OfflineRevisionWrapper=OfflineRevisionWrapper},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(6),i=n(2),s=n(24),a=n(36),c=n(110);t.CollectionCommandsRegistry=class CollectionCommandsRegistry{static createPayload(e){return{type:e.typeid,scopeUrn:e.scopeUrn,attributes:o.AttributeConverter.convertChangeSetToAttributesV2(e.attributes),components:e.components,policies:o.PolicyConverter.convertChangeSetToPolicyRequests(e.policies),createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy}}static createLocally(e,t,n){return r(this,void 0,void 0,(function*(){a.validateUserState(n);const r=s.OfflineEntityWrapper.initialize();r.setEntityType("Collection"),r.setTypeId(t.typeid);const o=e.getStoredId("id");r.setId(o),r.setAttributes(t.attributes),r.setComponents(t.components);const c=r.getFullEntity(),u=yield e.createEntity(c);if(!u)throw new i.SDKError("Error with creating a spaceCollection locally");return{resourceId:u.entityId,resourceUrn:"/collection/"+u.entityId,revisionId:u.revisionId,createdDate:new Date}}))}static updatePayload(e){return{attributes:o.AttributeConverter.convertTypedChangesetToGeneric(e.attributes),components:e.components,policies:e.policies,createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy}}static updateLocally(e,t,n){return r(this,void 0,void 0,(function*(){a.validateUserState(n);const r=yield e.getEntity(t.spaceCollectionId),o=s.OfflineEntityWrapper.initialize(r);if(!r||"Collection"!==o.getEntityType()&&"SpaceCollection"!==o.getEntityType())throw new Error("404");o.setAttributes(t.attributes),o.setComponents(t.components);const i=o.getFullEntity(),c=yield e.updateEntity(t.spaceCollectionId,i);return{resourceId:c.entityId,resourceUrn:"/collection/"+c.entityId,revisionId:c.revisionId,createdDate:new Date}}))}static deletePayload(e){return{}}static purgePayload(e){return{}}static restorePayload(e){return{}}static parseFetchPayload(e){return{spaceCollectionId:e.id,id:e.id,attributes:o.AttributeConverter.convertAttributesToChangeset(e.attributes.data).serializedChangeSet,components:e.components.data,typeid:e.type,revisionId:e.revisionId,createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy}}static processResults(e,t,n){return r(this,void 0,void 0,(function*(){if(void 0===t&&e.commandId)return e;const n=c.validateServerCommandResponse(t);return n?{error:n}:(yield s.storePermanentId(e,t),t.result)}))}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(36);t.EntityCommandsRegistry=class EntityCommandsRegistry{static deleteLocally(e,t,n){return r(this,void 0,void 0,(function*(){o.validateUserState(n);const r=yield e.getEntity(t.resourceId);if(!r)throw new Error("404");return yield e.removeEntity(r.entityId),{id:r.entityId}}))}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(6),i=n(109),s=n(2),a=n(36),c=n(24),u=n(110);class SpaceCommandsRegistry{static createPayload(e){return{type:e.typeid,attributes:o.AttributeConverter.convertChangeSetToAttributesV2(e.attributes),components:e.components,policies:o.PolicyConverter.convertChangeSetToPolicyRequests(e.policies),permissionContext:o.PermissionContextConverter.convertChangesetToContext(e.permissionContext),inheritParentPermissions:e.inheritParentPermissions,createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy}}static createLocally(e,t,n){return r(this,void 0,void 0,(function*(){a.validateUserState(n);const r=i.OfflineEntityWrapper.initialize();r.setEntityType("Space"),r.setTypeId(t.typeid);const o=e.getStoredId("id");r.setId(o),r.setParentId(t.spaceCollectionId),r.setAttributes(t.attributes),r.setComponents(t.components);const c=r.getFullEntity(),u=yield e.createEntity(c);if(!u)throw new s.SDKError("Error with creating an asset locally");return{resourceId:u.entityId,resourceUrn:"/spaces/"+u.entityId,revisionId:u.revisionId,createdDate:new Date}}))}static updatePayload(e){return{attributes:o.AttributeConverter.convertTypedChangesetToGeneric(e.attributes),components:e.components,policies:e.policies,permissionContext:o.PermissionContextConverter.convertChangesetToContext(e.permissionContext),createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy}}static updateLocally(e,t,n){return r(this,void 0,void 0,(function*(){a.validateUserState(n);const r=yield e.getEntity(t.resourceId),o=i.OfflineEntityWrapper.initialize(r);if(!r)throw new Error("404");o.setAttributes(t.attributes),o.setComponents(t.components);const s=o.getFullEntity(),c=yield e.updateEntity(t.resourceId,s);return{resourceId:c.entityId,resourceUrn:"/spaces/"+c.entityId,revisionId:c.revisionId,createdDate:new Date}}))}static deletePayload(e){return{}}static purgePayload(e){return{}}static restorePayload(e){return{}}static refreshPermissionContext(e){return{}}static movePayload(e){return{collection:{id:e.toSpaceCollectionId},spaces:e.entitiesToMove.map(e=>({id:e}))}}static copyPayload(e){return{collection:{id:e.toSpaceCollectionId},spaces:e.entitiesToCopy.map(e=>({id:e}))}}static parseFetchPayload(e){return{spaceCollectionId:o.extractCollectionIdFromUrl(e.attributes.url),id:e.id,attributes:o.AttributeConverter.convertAttributesToChangeset(e.attributes.data).serializedChangeSet,components:e.components.data,typeid:e.type,revisionId:e.revisionId,createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy}}static processResults(e,t,n){return r(this,void 0,void 0,(function*(){if(void 0===t&&e.commandId)return e;const n=u.validateServerCommandResponse(t);return n?{error:n}:(yield c.storePermanentId(e,t),t.result)}))}static parseQueryPayload(e){return e.results=e.results.map(e=>SpaceCommandsRegistry.parseFetchPayload(e)),e}}t.SpaceCommandsRegistry=SpaceCommandsRegistry},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(58),i=n(47),s=n(6),a=n(109),c=n(2),u=n(36),l=n(24),d=n(83),p=n(110);class SnapshotCommandsRegistry{static createPayload(e){return{type:e.typeid,assets:s.AssetsConverter.convertChangeSetToAssetRevision(e.assets),attributes:s.AttributeConverter.convertChangeSetToAttributesV2(e.attributes),components:e.components,createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy}}static createLocally(e,t,n){return r(this,void 0,void 0,(function*(){u.validateUserState(n);const r=a.OfflineEntityWrapper.initialize();r.setEntityType("Snapshot"),r.setTypeId(t.typeid);const o=e.getStoredId("id");r.setId(o),r.setParentId(t.spaceCollectionId),r.setAttributes(t.attributes),r.setComponents(t.components),r.setAssets(t.assets);const i=r.getFullEntity(),s=yield e.createEntity(i);if(!s)throw new c.SDKError("Error with creating a snapshot locally");return{resourceId:s.entityId,resourceUrn:"/snapshot/"+s.entityId,revisionId:s.revisionId,createdDate:new Date}}))}static updatePayload(e){return{attributes:s.AttributeConverter.convertChangeSetToAttributesV2(e.attributes),components:e.components,id:e.resourceId,createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy}}static updateLocally(e,t,n){return r(this,void 0,void 0,(function*(){u.validateUserState(n);const r=yield e.getEntity(t.resourceId),o=a.OfflineEntityWrapper.initialize(r);if(!r)throw new Error("404");if(t.assets&&"modify"in t.assets)throw new Error("You cannot modify a local asset");o.setAttributes(t.attributes),o.setComponents(t.components),o.setAssets(t.assets);const i=o.getFullEntity(),s=yield e.updateEntity(t.resourceId,i);return{resourceId:s.entityId,resourceUrn:"/spaces/"+s.entityId,revisionId:s.revisionId,createdDate:new Date}}))}static addAssetsLocally(e,t,n){var o,i,s;return r(this,void 0,void 0,(function*(){u.validateUserState(n);const r=yield e.getEntity(t.resourceId);if(!r)return{error:new Error("404")};if("modify"in t.assets||"remove"in t.assets)return{error:new Error("You cannot modify/remove in a Snapshot addAssets")};const c=a.OfflineEntityWrapper.initialize(r),l=null===(o=c.getAssets().insert)||void 0===o?void 0:o.String,d=null===(s=null===(i=t.assets)||void 0===i?void 0:i.insert)||void 0===s?void 0:s.String;if(l&&d){if(Object.keys(l).some(e=>e in d))return{error:new Error("assets: only a single revision of the same asset is allowed in a snapshot")}}c.setAssets(t.assets);const p=c.getFullEntity(),h=yield e.updateEntity(t.resourceId,p);return{resourceId:r.entityId,resourceUrn:"/snapshot/"+r.entityId,revisionId:h.revisionId,createdDate:new Date}}))}static removeAssetsLocally(e,t,n){return r(this,void 0,void 0,(function*(){u.validateUserState(n);const r=yield e.getEntity(t.resourceId);if(!r)throw new Error("404");if(t.assets&&("modify"in t.assets||"insert"in t.assets))return{error:new c.SDKError("You cannot modify/insert in a Snapshot removeAssets")};const o=a.OfflineEntityWrapper.initialize(r);o.setAssets(t.assets);const i=o.getFullEntity(),s=yield e.updateEntity(t.resourceId,i);return{resourceId:r.entityId,resourceUrn:"/snapshot/"+r.entityId,revisionId:s.revisionId,createdDate:new Date}}))}static addAssetsPayload(e){return{id:e.resourceId,assets:s.AssetsConverter.convertChangeSetToAssetRevision(e.assets)}}static removeAssetsPayload(e){const t=e.assets.remove;return{id:e.resourceId,assets:t.map(e=>({id:e}))}}static parseFetchPayload(e){const t={spaceCollectionId:s.extractCollectionIdFromUrl(e.attributes.url),id:e.snapshot.id,attributes:s.AttributeConverter.convertAttributesToChangeset(e.attributes.data).serializedChangeSet,components:e.components.data,typeid:e.type,revisionId:e.revisionId,createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy};return e.assets.data&&(t.assets=SnapshotCommandsRegistry.convertAssets(e.assets.data).serializedChangeSet),t}static deleteLocally(e,t,n){return r(this,void 0,void 0,(function*(){u.validateUserState(n);const r=yield e.getEntity(t.resourceId);if(!r)throw new Error("No snapshot found for this id");const o=yield d.RelationshipQueriesRegistry.queryRelationships(e,{fromCollection:t.spaceCollectionId,spaceCollectionId:t.spaceCollectionId,filter:{$or:[{fromSnapshot:t.resourceId},{toSnapshot:t.resourceId}]}},n);return o&&(yield Promise.all(o.results.map(t=>e.removeEntity(t.id)))),yield e.removeEntity(r.entityId),{id:r.entityId}}))}static deletePayload(e){return{}}static purgePayload(e){return{}}static restorePayload(e){return{}}static createRewriteIds(e,t,n){return r(this,void 0,void 0,(function*(){const n=e.assets;if(n){const e=[];e.push(SnapshotCommandsRegistry.rewriteAssetChangeset(n.insert,t)),e.push(SnapshotCommandsRegistry.rewriteAssetChangeset(n.modify,t)),e.push(SnapshotCommandsRegistry.rewriteAssetChangeset(n.remove,t)),yield Promise.all(e)}return e}))}static updateAssetsRewriteIds(e,t,n){return r(this,void 0,void 0,(function*(){let r=e.resourceId;try{r=(yield t(r)).entityId||r}catch(e){if(e.code!==i.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST)throw new c.SDKError(e.message,e)}return SnapshotCommandsRegistry.createRewriteIds({resourceId:r,assets:e.assets},t,n)}))}static processResults(e,t,n){return r(this,void 0,void 0,(function*(){if(void 0===t&&e.commandId)return e;const n=p.validateServerCommandResponse(t);return n?{error:n}:(yield l.storePermanentId(e,t),t.result)}))}static rewriteAssetChangeset(e,t){return r(this,void 0,void 0,(function*(){let n;if(!e)return Promise.resolve();if(Array.isArray(e)){const r=[];n=e.map(e=>SnapshotCommandsRegistry.rewrite(e,void 0,r,t)),yield Promise.all(n),e.length=0,e.push(...r)}else{const r={};n=Object.entries(e.String).map(([e,n])=>SnapshotCommandsRegistry.rewrite(e,n,r,t)),yield Promise.all(n),Object.assign(e,{String:r})}return Promise.resolve()}))}static rewrite(e,t,n,o){return r(this,void 0,void 0,(function*(){let r=e,s=t;try{if(r=(yield o(r)).entityId||r,t){const t=yield o(e,s);s=t&&t.revisionId||s}}catch(e){if(e.code!==i.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST&&e.code!==i.ErrorCode.L5_ENTITY_STORE_REVISION_NOT_EXIST)throw new c.SDKError(e.message,e)}Array.isArray(n)?n.push(r):Object.assign(n,{[r]:s})}))}static parseQueryPayload(e){const t=Object.assign({},e);return t.results=t.results.map(e=>SnapshotCommandsRegistry.parseFetchPayload(e)),t}static convertAssets(e){const t=e,n=new o.PropertyFactory,r=n.create("NodeProperty");return t.forEach(e=>{const t=e.revision?e.revision.id:"",o=e.asset.id;r.insert(o,n.create("String","single",t))}),r.serialize()}}t.SnapshotCommandsRegistry=SnapshotCommandsRegistry},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(84);class CollectionQueriesRegistry{static getLocally(e,t,n){return r(this,void 0,void 0,(function*(){return o.EntityQueriesRegistry.getLocally(e,Object.assign(Object.assign({},t),{id:t.spaceCollectionId}),CollectionQueriesRegistry.packageCollection,n)}))}}t.CollectionQueriesRegistry=CollectionQueriesRegistry,CollectionQueriesRegistry.packageCollection=(e,t)=>o.EntityQueriesRegistry.packageEntity(e,t)},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(61)),i=n(6),getAssetsRevisionTable=e=>{const t=Array.isArray(e.data)?e.data[0]:e.data;if(t&&t.assets&&t.assets.insert)return t.assets.insert.String},typeSplitter=e=>{const t=["",""];if(!e)return t;const n=e.lastIndexOf("-");return n<1||(t[0]=e.substring(0,n),t[1]=e.substring(n+1,e.length)),t},attributeValueResolver=(e,t)=>{var n;const r=null===(n=e.staticData)||void 0===n?void 0:n.attributes;if(void 0===r)return;let o=[];o=Array.isArray(r)?o.concat(r):i.AttributeConverter.convertChangeSetToAttributesV2(r);const s=t.split(".")[1],a=o.find(e=>e.name===s);return void 0!==a?String(a.value):void 0},attributeTypeValueResolver=(e,t)=>{var n;let r=[];const o=null===(n=e.staticData)||void 0===n?void 0:n.attributes;if(void 0===o)return;let s=[];return s=Array.isArray(o)?s.concat(o):i.AttributeConverter.convertChangeSetToAttributesV2(o),r=s.map(e=>e.type),r},componentTypeValueResolver=(e,t)=>{var n;let r=[];return Array.isArray(e.data)?r=e.data.reduce((e,t)=>{var n;return(null===(n=null==t?void 0:t.components)||void 0===n?void 0:n.insert)?e.concat(Object.keys(t.components.insert)):e},[]):(null===(n=e.data.components)||void 0===n?void 0:n.insert)&&(r=r.concat(Object.keys(e.data.components.insert))),r},componentTypeNameValueResolver=(e,t)=>{var n;let r=[];return Array.isArray(e.data)?r=e.data.reduce((e,t)=>{var n;return(null===(n=null==t?void 0:t.components)||void 0===n?void 0:n.insert)?e.concat(Object.keys(t.components.insert).map(e=>typeSplitter(e)[0])):e},[]):(null===(n=e.data.components)||void 0===n?void 0:n.insert)&&(r=r.concat(Object.keys(e.data.components.insert).map(e=>typeSplitter(e)[0]))),r},componentTypeVersionValueResolver=(e,t)=>{var n;let r=[];return Array.isArray(e.data)?r=e.data.reduce((e,t)=>{var n;return(null===(n=null==t?void 0:t.components)||void 0===n?void 0:n.insert)?e.concat(Object.keys(t.components.insert).map(e=>typeSplitter(e)[1])):e},[]):(null===(n=e.data.components)||void 0===n?void 0:n.insert)&&(r=r.concat(Object.keys(e.data.components.insert).map(e=>typeSplitter(e)[1]))),r},typeNameValueResolver=(e,t)=>{const n=e.staticData.metadata.type;return typeSplitter(n)[0]},typeVersionValueResolver=(e,t)=>{const n=e.staticData.metadata.type;return typeSplitter(n)[1]},assetValueResolver=(e,t)=>{const n=[],r=getAssetsRevisionTable(e);return r&&n.push(...Object.keys(r)),n},assetRevisionValueResolver=(e,t)=>{const n=[],r=getAssetsRevisionTable(e);return r&&n.push(...Object.values(r).filter(e=>e.length)),n};t.getValueResolver=(e,t)=>t.startsWith("attribute.")?attributeValueResolver:"has.component.type"===t?componentTypeValueResolver:"has.component.type.name"===t?componentTypeNameValueResolver:"has.component.type.version"===t?componentTypeVersionValueResolver:"has.attribute.type"===t?attributeTypeValueResolver:"type.name"===t?typeNameValueResolver:"type.version"===t?typeVersionValueResolver:"Snapshot"===e.staticData.metadata.entityType&&"asset.id"===t?assetValueResolver:"Snapshot"===e.staticData.metadata.entityType&&"asset.revision.id"===t?assetRevisionValueResolver:(e,t)=>o.default(e,t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processCommaList=function processCommaList(e){if(void 0===e)return;const t=e.split(",").map(e=>e.trim()).filter(e=>""!==e);return t.length>0?t:void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);t.relationshipFiltersToRsql=function relationshipFiltersToRsql(e,t){return t.map(t=>{const n=[];if(t.direction&&n.push(function directionClause(e,t){let n;if("OUT"===t)n="staticData.metadata.from.assetId==";else{if("IN"!==t)throw new r.InternalError("Unknown direction in relationship filter: "+t);n="staticData.metadata.to.assetId=="}return n.concat(e)}(e,t.direction)),t.type&&(n.push("type.name=="+t.type.name),t.type.version&&n.push("type.version=="+t.type.version)),t.componentTypes&&t.componentTypes.length){const e=t.componentTypes.map(e=>{let t;return t=e.version?`has.component.type==${e.name}-${e.version}`:"has.component.type.name=="+e.name,t}).join(";");n.push(`(${e})`)}return`(${n.join(";")})`}).join(",")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitType=function splitType(e){if(!e)return;const t=e.trim().split("-");return t.length>1?{name:t[0],version:t[1]}:{name:e}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(84);class SpaceQueriesRegistry{static getLocally(e,t,n){return r(this,void 0,void 0,(function*(){return o.EntityQueriesRegistry.getLocally(e,t,SpaceQueriesRegistry.packageSpace,n)}))}static queryLocally(e,t,n){return r(this,void 0,void 0,(function*(){return o.EntityQueriesRegistry.queryLocally(e,t,{customKeyMapper:SpaceQueriesRegistry.customKeyMapper,packageEntity:SpaceQueriesRegistry.packageSpace,entityType:"Space",nativeKeys:SpaceQueriesRegistry.nativeKeys},n)}))}}t.SpaceQueriesRegistry=SpaceQueriesRegistry,SpaceQueriesRegistry.nativeKeys=[...o.EntityQueriesRegistry.nativeKeys,"spaceId"],SpaceQueriesRegistry.customKeyMapper=e=>"spaceId"===e?["entityId","entityPermanentId"]:o.EntityQueriesRegistry.customKeyMapper(e),SpaceQueriesRegistry.packageSpace=(e,t)=>{const n=o.EntityQueriesRegistry.packageEntity(e,t);return Object.assign(Object.assign({},n),{spaceCollectionId:t})}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(85),i=n(24),s=n(36),a=n(164),c=n(84),u=n(375);class SnapshotAssetsQueriesRegistry{static queryLocally(e,t,n){return r(this,void 0,void 0,(function*(){s.validateUserState(n);const r=yield e.getEntity(t.id);if(!r)return;const c=SnapshotAssetsQueriesRegistry.getAssetRevisionTable(r);if(!c)return;const l=new u.LocalFilterHelper(t.filter||"",SnapshotAssetsQueriesRegistry.nativeKeys,SnapshotAssetsQueriesRegistry.customKeyMapper),d=[],p=t.limit||o.PaginationConstants.LIMIT;try{for(const[t,n]of Object.entries(c)){const r=yield e.getEntity(t,""===n?void 0:n);r&&d.push(r)}}catch(e){throw new Error("Unable to query entities")}if(0===d.length)return;return{results:a.applyFilter(d,l.getFilter(),SnapshotAssetsQueriesRegistry.customKeyMapper).map(e=>{if(!e)return;const t=i.OfflineEntityWrapper.initialize(e),n=e.entityPermanentId||e.permanentId||e.entityId;return{id:n,asset:{id:n},spaceCollectionId:t.getSpaceCollectionId(),spaceId:t.getParentId(),typeid:t.getTypeId(),components:t.getFullComponentView(),attributes:t.getAttributes(),revision:{id:void 0!==c[n]&&""!==c[n]?c[n]:null},createdBy:t.getCreatedBy(),lastModifiedBy:t.getLastModifiedBy()}}),pagination:{limit:p,offset:-1}}}))}static getAssetRevisions(e,t,n){return r(this,void 0,void 0,(function*(){s.validateUserState(n);const r=yield e.getEntity(t.id);if(!r)throw new Error(`Cannot get asset revisions. Snapshot ${t.id} does not exist locally.`);const o=Array.from(Array(t.ids.length)),i=SnapshotAssetsQueriesRegistry.getAssetRevisionTable(r);if(i)for(let e=0;e<o.length;++e){const n=t.ids[e];o[e]=i[n]}return o}))}static getAssetRevisionTable(e){const t=e.data,n=t?t.assets:void 0;if(!n)return;let r={};if(n.insert&&n.insert.String)r=n.insert.String;else if(Array.isArray(n))for(const e of n){let t;e.revision&&(t=e.revision.id),Object.assign(r,{[e.asset.id]:t})}return r}}t.SnapshotAssetsQueriesRegistry=SnapshotAssetsQueriesRegistry,SnapshotAssetsQueriesRegistry.nativeKeys=[...c.EntityQueriesRegistry.nativeKeys,"assetId"],SnapshotAssetsQueriesRegistry.customKeyMapper=e=>"spaceId"===e?"parentEntityId":"assetId"===e?["entityId","entityPermanentId"]:c.EntityQueriesRegistry.customKeyMapper(e)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommandBatchJournalError=void 0;const r=n(19);class CommandBatchJournalError extends r.JournalError{constructor(e,t,n,r,o,i){super(e,t,n),this.code=e,this.details=t,this.innerError=n,this.errorIndex=r,this.successfulCommandsInfo=o,this.pendingCommandsInfo=i}toJSON(){var e;return{code:this.code.id,details:null!==(e=this.details)&&void 0!==e?e:this.code.description,error:JSON.stringify(this.innerError),batchCommandError:{errorIndex:this.errorIndex,successfulCommandsInfo:this.successfulCommandsInfo,pendingCommandsInfo:this.pendingCommandsInfo}}}}t.CommandBatchJournalError=CommandBatchJournalError},function(e,t,n){"use strict";var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.CommandContext=void 0;const o=n(19),i=n(121),s=n(47),a=n(152),c=n(380);class CommandContext extends c.QueryContext{constructor(e,t,n,r,o,i,s){super(e,i,s,o),this.command=t,this.commandExecutor=r,this.idStoreStack=[],this.localIdStore=n}commandId(){return this.command.id}async getEntity(e,t){const n=await super.getEntity(e,t);return n&&await this.command.addInputEntities([n.entityId]),n}async getEntities(e){const t=await super.getEntities(e),n=t.map(e=>null==e?void 0:e.entityId).filter(e=>void 0!==e);return await this.command.addInputEntities(n),t}async createRelationship(e,t){const{revisionId:n,revisionPermanentId:o}=e,i=r(e,["revisionId","revisionPermanentId"]),s=await this.entityStore.createRelationship(Object.assign(Object.assign({},i),{type:a.EntityType.RELATIONSHIP}),t,{revisionId:n,revisionPermanentId:o,journalId:this.journal.id,commandId:this.command.id,revisionDate:new Date});return await this.command.addModifiedEntity(s),s}async createEntity(e){const{revisionId:t,revisionPermanentId:n}=e,o=r(e,["revisionId","revisionPermanentId"]),i=await this.entityStore.createEntity(Object.assign(Object.assign({},o),{type:a.EntityType.ENTITY}),{revisionId:t,revisionPermanentId:n,journalId:this.journal.id,commandId:this.command.id,revisionDate:new Date});return await this.command.addModifiedEntity(i),i}async updateEntity(e,t){const{revisionId:n,revisionPermanentId:o}=t,i=r(t,["revisionId","revisionPermanentId"]),s=await this.entityStore.updateEntity(e,i,{revisionId:n,revisionPermanentId:o,journalId:this.journal.id,commandId:this.command.id,revisionDate:new Date});return await this.command.addModifiedEntity(s),s}async removeEntity(e,{revisionId:t,revisionPermanentId:n}={}){const r=await this.entityStore.removeEntity(e,{revisionId:t,revisionPermanentId:n,journalId:this.journal.id,commandId:this.command.id,revisionDate:new Date});return await this.command.addModifiedEntity(r),r}async restoreEntity(e,{revisionId:t,revisionPermanentId:n}={}){const{entityLocalId:r}=await this.entityStore.getEntityIds(e);if(!await this.lineageHelper.isEntityRemovedInLineage(this.journal.id,r))throw new s.StoreError(s.ErrorCode.L5_ENTITY_STORE_ENTITY_IS_NOT_REMOVED,`Entity with ID ${e} is not removed.`);await this.entityStore.createRevision(r,this.journal.id,{revisionId:t,revisionPermanentId:n,commandId:this.command.id,revisionDate:new Date,removed:!1});const o=(await this.entityStore.getEntities([r],{journalId:this.journal.id}))[0];return await this.command.addModifiedEntity({entityId:o.entityId,revisionId:o.revisionId}),o}async setEntityPermanentId(e,t){return this.entityStore.setEntityPermanentId(e,t)}idStore(){return this.localIdStore}getStoredId(e){let t=this.localIdStore[e];if(void 0===t)t=CommandContext.generateId(),this.localIdStore[e]=t;else if("string"!=typeof t)throw new o.JournalError(o.JournalErrorCode.L7_CONTEXT_CANNOT_GET_STORED_DATA,"Entry at key exists but is not a string.");return t}setStoredId(e,t){return this.localIdStore[e]=t,this.localIdStore[e]}static generateId(){return i.nanoid()}async executeCommand(e,t,n){if(void 0!==n){let e=this.localIdStore[n];if(void 0===e)e={},this.localIdStore[n]=e;else if("object"!=typeof e)throw new o.JournalError(o.JournalErrorCode.L7_CONTEXT_CANNOT_GET_STORED_DATA,"Entry at key exists but is not an object.");this.idStoreStack.push(this.localIdStore),this.localIdStore=e}try{return await this.commandExecutor.executeNested(e,t,this)}finally{void 0!==n&&(this.localIdStore=this.idStoreStack.pop())}}}t.CommandContext=CommandContext},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.JournalingSDK=void 0;const c=n(19),u=a(n(46)),l=n(47),d=n(381),p=n(165),h=n(1005),m=n(384);class JournalingSDK{constructor(e,t,n){var r,o,i,s,a,u,l;this.store=e,this.syncHandler=t,this.config=n,this.registry=new d.CommandQueryRegistry,this.restClient=m.getClient({getBearerToken:this.config.getBearerToken,baseURL:this.config.server+"/v1",retryCodes:(null===(r=this.config.clientConfig)||void 0===r?void 0:r.retryCodes)||c.DEFAULT_RETRY_CODES,retryErrors:(null===(o=this.config.clientConfig)||void 0===o?void 0:o.retryErrors)||c.DEFAULT_RETRY_ERRORS,headers:null===(i=this.config.clientConfig)||void 0===i?void 0:i.headers,retries:null===(s=this.config.clientConfig)||void 0===s?void 0:s.retries,proxy:null===(a=this.config.clientConfig)||void 0===a?void 0:a.proxy,keepAlive:null===(u=this.config.clientConfig)||void 0===u?void 0:u.keepAlive,socketTimeout:null===(l=this.config.clientConfig)||void 0===l?void 0:l.socketTimeout}),this.queryExecutor=new h.QueryExecutor(this.store,this.getRestClient(),this.registry),this.commandExecutor=new h.CommandExecutor(this.store,this.getRestClient(),this.registry,{commandPollingInterval:this.config.commandPollingInterval||100,commandPollingAttempts:this.config.commandPollingAttempts||120},this.queryExecutor),this.journalManager=new d.JournalManager(this.commandExecutor,this.store),this.journalEventEmitter=new d.JournalEventEmitter,this.autoSynchronizationMode=new Map,this._disposing=!1,this._pendingPromises=new Set}on(e,t,n){return this.journalEventEmitter.on(e,t,n)}getType(){return"JournalingSDK"}off(e){this.journalEventEmitter.off(e)}registeredListeners(e){return this.journalEventEmitter.registeredListeners(e)}async registerCommandsAndQueriesByPath(e){const t=await Promise.resolve().then(()=>s(n(21))),r=await Promise.resolve().then(()=>s(n(11)));if(!e||!t.existsSync(e))throw new c.JournalError(c.JournalErrorCode.L7_REGISTRATION_PATH_NOT_FOUND,"path="+e);if(t.lstatSync(e).isDirectory()){const n=t.readdirSync(e);for(let t=0;t<n.length;t++){const o=r.join(e,n[t]);await this.registerCommandsAndQueriesByPath(o)}}else try{const t=await Promise.resolve().then(()=>s(n(1012)(e)));this.registry.registerCommandsAndQueries(t)}catch(e){}}registerCommandsAndQueries(e){this.registry.registerCommandsAndQueries(e)}getRegisteredQuery(e){return this.registry.getRegisteredQuery(e)}getRegisteredQueries(){const e={};return this.registry.getRegisteredQueries().forEach((t,n)=>{e[n]=t}),e}async executeQuery(e,{queryName:t,parameters:n,traceContext:r},o){if(!t)throw new c.JournalError(c.JournalErrorCode.L7_GEN_NULL_VALUE,"queryName");if(!n)throw new c.JournalError(c.JournalErrorCode.L7_GEN_NULL_VALUE,"parameters");const i=this.registry.getRegisteredQuery(t);if(!i)throw new c.JournalError(c.JournalErrorCode.L7_QUERY_NOT_REGISTERED,`No query registered with name ${t}.`);const s=(null==o?void 0:o.fetchMode)||c.FetchMode.LOCAL_OR_SERVER,{role:a}=await this.store.getJournalStore().getJournal(e),u={queryDefinition:i,parameters:n,fetchMode:s,journal:new d.Journal(e,this.store),traceContext:r};return"remote"===a?this.queryExecutor.executeOnServer(u):this.queryExecutor.executeLocally(u)}getRegisteredCommand(e){return this.registry.getRegisteredCommand(e)}getRegisteredCommands(){const e={};return this.registry.getRegisteredCommands().forEach((t,n)=>{e[n]=t}),e}async executeCommand(e,{commandName:t,parameters:n,dependsOn:r}){if(!t)throw new c.JournalError(c.JournalErrorCode.L7_GEN_NULL_VALUE,"commandName");if(!n)throw new c.JournalError(c.JournalErrorCode.L7_GEN_NULL_VALUE,"parameters");return this.executeCommandBatch(e,[{commandName:t,parameters:n}],{batchDependsOn:r}).then(([e])=>e)}async executeCommandBatch(e,t,n={}){let r;const o=new d.Journal(e,this.store),i=await o.getData();if("remote"===i.role){u.default(void 0===n.batchDependsOn,"batchDependsOn is not currently supported for remote execution");const e=await this.commandExecutor.executeOnServer(t,i.collectionId,o);r=t.map((t,n)=>({commandId:e.commands[n]?e.commands[n].commandId:"",result:e.processedResults[n]}))}else r=await this.journalManager.staging(e).execute(({[e]:r})=>this.commandExecutor.executeLocally(r,t,n.batchDependsOn)),this.runAutoSynchronization(e);return r}async runAutoSynchronization(e,t=0){const n=new d.Journal(e,this.store),{collectionId:r,role:o}=await n.getData(),i=this.autoSynchronizationMode.get(r);if("main"===o&&i&&i.autoSynchronize)try{this.journalEventEmitter.dispatchEvent("autoSynchronizeStart",[{collectionId:r,journalId:e}]),await this.runSynchronizeWithServer(e,o,r),this.journalEventEmitter.dispatchEvent("autoSynchronizeComplete",[{collectionId:r,journalId:e}])}catch(n){if(this.journalEventEmitter.dispatchEvent("autoSynchronizeError",[{collectionId:r,journalId:e}]),"ENOTFOUND"!==n.code)throw n;const o=t+1;await setTimeout(async()=>this.runAutoSynchronization(e,o),1e3*[0,5,10,30,60,300][o<=5?o:5])}}async createCollection({commandName:e,parameters:t},{createOnServer:n=!1}={}){const r=this.registry.getRegisteredCommand(e);if(!r)throw new c.JournalError(c.JournalErrorCode.L7_COMMAND_NOT_REGISTERED,`No command registered with name ${e}.`);if(n||!r.executeLocally){const{remoteJournal:n,commandId:r,processedResults:o}=await this.createCollectionOnServer(void 0,{commandName:e,parameters:t}),{journalId:i,parentJournalId:s,properties:a}=await this.store.getJournalStore().createJournal({role:"main",collectionId:n.journalId,parentJournalId:n.journalId,properties:{}});return{collectionId:n.journalId,mainJournal:{journalId:i,parentJournalId:s,properties:a},remoteJournal:n,commandId:r,commandResult:o}}const{journalId:o,parentJournalId:i,properties:s}=await this.store.getJournalStore().createJournal({role:"main",parentJournalId:null,properties:{}}),[{commandId:a,result:u}]=await this.commandExecutor.executeLocally(new d.Journal(o,this.store),[{commandName:e,parameters:t}])||[],l=this.extractCollectionId(u);return await this.store.getJournalStore().updateJournal(o,{collectionId:l}),{collectionId:l,mainJournal:{journalId:o,parentJournalId:i,properties:s},commandId:a,commandResult:u}}getRestClient(){return this.restClient}setAutoSynchronizationMode(e,t){if(t.autoSynchronize)throw new c.JournalError(c.JournalErrorCode.L7_ACTION_NOT_SUPPORTED,"auto sync not supported, please refer to: https://jira.autodesk.com/browse/FDC-1553");this.autoSynchronizationMode.set(e,t)}getAutoSynchronizationMode(e){return this.autoSynchronizationMode.get(e)}async synchronizeJournals(e,t){const n=this.store.getJournalStore(),[r,o]=await Promise.all([n.getJournal(e),n.getJournal(t)]),i=new d.Journal(r.journalId,this.store),s=new d.Journal(o.journalId,this.store);if("remote"===(await s.getData()).role)throw new c.JournalError(c.JournalErrorCode.L7_JOURNAL_CANNOT_SYNC_WITH_REMOTE_JOURNAL,"Cannot synchronize with remote journal.");if(await this.journalManager.store.getJournalStore().canBeFastForwarded(i.id,s.id)){const e=await h.CommandExecutor.getJournalLeafCommandIds(s);let t;if(e.length){t=(await s.addCommand({commandName:p.COMMAND_EXECUTION_NOOP,parameters:{},dependsOn:e,status:c.CommandStatus.SUCCESS})).id}await this.journalManager.fastForward(i,s,t)}else{const t=await n.getJournalCommands(e),r=await this.commandExecutor.createBatchForReexecution(t);await this.journalManager.staging(o.journalId).execute(({[o.journalId]:e})=>this.commandExecutor.executeLocally(e,r,void 0))}await i.reset(s),this.runAutoSynchronization(t)}async createIsolationJournal(e,t={}){var n;const r=this.store.getJournalStore(),o=await r.getJournal(e),i=new d.Journal(e,this.store);if("remote"===o.role)throw new c.JournalError(c.JournalErrorCode.L7_INVALID_PARENT_JOURNAL,`The journal with the ID ${e} does not have a role main or isolation.`);if(e===t.journalId)throw new c.JournalError(c.JournalErrorCode.L7_INVALID_PARENT_JOURNAL,`The journal with the ID ${e} cannot be parent of itself.`);const s=await i.getCollectionId(),{journalId:a}=await r.createJournal({journalId:null==t?void 0:t.journalId,role:"isolation",collectionId:s,parentJournalId:e,properties:null!==(n=null==t?void 0:t.properties)&&void 0!==n?n:{}});return a}async deleteIsolationJournal(e,t){const n=this.store.getJournalStore(),{role:r}=await n.getJournal(e);if("isolation"!==r)throw new c.JournalError(c.JournalErrorCode.L7_ACTION_NOT_SUPPORTED,`The journal with the ID ${e} cannot be deleted because is not an isolation journal.`);if((await n.getJournalCommands(e)).length>0&&!t)throw new c.JournalError(c.JournalErrorCode.L7_ACTION_NOT_SUPPORTED,`The journal with the ID ${e} contains commands and cannot be deleted.\n          To force the deletion set ignoreCommands as true.`);const o=new d.Journal(e,this.store);if(await o.hasChildren()){const t=await o.getParentJournal(),r=await n.getJournalsByParent(e);await this.journalManager.staging(...r.map(e=>e.journalId)).execute(async e=>{for(const r in e){const o=e[r];await n.updateJournal(o.id,{parentJournalId:t.id}),await this.journalManager.rebase(o)}})}await n.deleteJournal(e)}async fetch(e,t){const n=this.store.getJournalStore();let r=e,o=await n.getJournalSet(r);if(!o)try{r=(await n.getJournal(e)).collectionId,o=await n.getJournalSet(r)}catch(e){}const i=await this._runFetch(r,o,t),s=this.autoSynchronizationMode.get(e);if(s&&s.autoPull){const t=new d.Journal(i.mainJournal.journalId,this.store),n=new d.Journal(e,this.store);await this.journalManager.staging(n.id).execute(async({[n.id]:e})=>{e.setTargetJournal(t),await this.journalManager.rebase(e)})}return i}async _runFetch(e,t,n){const r=!t,o=this.store.getJournalStore();let i;if(r)i=await o.createJournal({journalId:e,role:"remote",collectionId:e,parentJournalId:null,properties:{}});else{if(!t.remoteJournal)throw new c.JournalError(c.JournalErrorCode.L7_JOURNAL_CANNOT_FETCH,"Collection with ID is a local collection that was never pushed to the server.");i=t.remoteJournal}const s=null==t?void 0:t.serverSyncToken,a=await o.addCommandToJournal(i.journalId,{commandName:p.COMMAND_REMOTE_SYNC,parameters:{serverSyncToken:s},status:c.CommandStatus.STARTED,dependsOn:[]});let u=!1;try{const t=await this.syncHandler.fetch(i.journalId,s,n,a),r=await o.getCommandModifiedEntities(a.commandId);r&&(u=r.length>0,this.journalEventEmitter.dispatchEvent("fetch",r.map(e=>({cmdModEntity:e,collectionId:i.journalId,journalId:i.journalId})))),await Promise.all([o.updateJournalSet(e,{serverSyncToken:null!=t?t:null}),o.updateCommand(a.commandId,{status:c.CommandStatus.SUCCESS})])}catch(e){throw r&&(await o.clearJournalCommands(i.journalId),await o.deleteJournal(i.journalId)),e}const l=await o.getJournalSet(e);if(!l)throw new c.JournalError(c.JournalErrorCode.L7_JOURNAL_NOT_FOUND,`The journal with the ID ${e} does not exist.`);return l.mainJournal||(l.mainJournal=await o.createJournal({role:"main",collectionId:l.remoteJournal.collectionId,parentJournalId:l.remoteJournal.journalId,properties:{}})),{change:u,remoteJournal:i,mainJournal:{journalId:l.mainJournal.journalId,parentJournalId:l.mainJournal.parentJournalId,properties:l.mainJournal.properties},isolationJournals:(l.isolationJournals||[]).map(e=>({journalId:e.journalId,parentJournalId:e.parentJournalId,properties:e.properties}))}}async rebase(e,t){const n=new d.Journal(e,this.store);if("remote"===(await n.getData()).role)throw new c.JournalError(c.JournalErrorCode.L7_JOURNAL_CANNOT_REBASE,"Cannot rebase a remote journal.");const r=await n.getParentJournal();r&&await this.journalManager.staging(r.id).execute(async({[r.id]:e})=>{e.setTargetJournal(n),await this.journalManager.rebase(e,null==t?void 0:t.removeCommands)})}async getJournals(e,t){let n=await this.store.getJournalStore().getJournalSet(e,t);if(!n)try{const r=await this.store.getEntityStore().getEntityIds(e),[o]=[r.entityLocalId,r.entityPermanentId].filter(t=>t&&t!==e);n=o?await this.store.getJournalStore().getJournalSet(o,t):void 0}catch(e){if(e.code.id!==l.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST.id)throw e;return}const{remoteJournal:r}=n;return n&&n.mainJournal?{remoteJournal:r,mainJournal:{journalId:n.mainJournal.journalId,parentJournalId:n.mainJournal.parentJournalId,properties:n.mainJournal.properties},isolationJournals:(n.isolationJournals||[]).map(e=>({journalId:e.journalId,parentJournalId:e.parentJournalId,properties:e.properties}))}:void 0}async dropEntities(e,t=!0){const n=this.store.getEntityStore(),r=e.map(e=>n.deleteEntity(e,t));await Promise.all(r)}async push(e,t){const n=await this.commandExecutor.createBatchForReexecution(e),r=await this.commandExecutor.executeOnServer(n,void 0,t),o=r.commands.map((e,t)=>({commandId:e.commandId,result:r.processedResults[t]}));return this.journalEventEmitter.dispatchEvent("push",o.map(e=>Object.assign(Object.assign({},e),{collectionId:t.id,journalId:t.id}))),o}async pull(e,t){const n=new d.Journal(e,this.store),r=await n.getData();if("main"!==r.role)throw new c.JournalError(c.JournalErrorCode.L7_JOURNAL_CANNOT_PULL,`Cannot pull ${r.role} journal.`);const o=r.collectionId,i=await this.store.getJournalStore().getJournalSet(o),s=this.journalManager.store.getJournalStore(),a=i.remoteJournal&&!await s.canBeFastForwarded(e,i.remoteJournal.journalId),{change:u,remoteJournal:l}=await this._runFetch(o,i,t),p=new d.Journal(l.journalId,this.store);(u||a)&&await this.journalManager.staging(p.id).execute(async({[p.id]:e})=>{e.setTargetJournal(n),await this.journalManager.rebase(e)})}extractCollectionId(e){let t;if(t="string"==typeof e?e:e.result?e.result.resourceId:e.entityId||e.resourceId,!t)throw new c.JournalError(c.JournalErrorCode.L7_CREATE_COLLECTION_BAD_CALLBACK_RESULT,"Expecting string or object with `entityId`/`resourceId` string property as a execution result.");return t}async createCollectionOnServer(e,t){var n;const r=await this.commandExecutor.executeOnServer([t],e),o=null===(n=r.commands)||void 0===n?void 0:n[0];if(o&&o.status!==c.CommandStatus.SUCCESS)throw new c.JournalError(c.JournalErrorCode.L7_CREATE_COLLECTION_FAILED,`Create collection command didn't execute successfully.\n        Command Status: ${o.status}, CommandResult: ${JSON.stringify(r.processedResults)}.`);return{remoteJournal:r.remoteJournal,commandId:r.commands[0].commandId,processedResults:r.processedResults[0]}}async synchronizeWithServer(e,t){const n=new d.Journal(e,this.store),{role:r,collectionId:o}=await n.getData(),i=this.autoSynchronizationMode.get(o);if(i&&i.autoSynchronize)throw new Error("Manual synchronization is not allowed on a collection with auto synchronization set to true.\n      This is a temporary restriction to avoid a race condition, that might occurred,\n      in the case of multiple synchronizations at the same  time,\n      and it will be removed once the journal lock functionality is in place (JIRA FDC-1099 & FDC-1282)");return this.runSynchronizeWithServer(e,r,o,t)}async runSynchronizeWithServer(e,t,n,r){const o=new d.Journal(e,this.store);if("main"!==t)throw new c.JournalError(c.JournalErrorCode.L7_JOURNAL_CANNOT_PULL,`Cannot pull ${t} journal.`);const i=this.store.getJournalStore();let s=await i.getJournalSet(n);s.remoteJournal&&await this.pull(e,r);const a=await this.store.getJournalStore().getJournalCommands(o.id);if(!s.remoteJournal){const e=a.shift();await this.createCollectionOnServer(n,{commandName:e.commandName,parameters:e.parameters,localIdStore:await this.store.getJournalStore().getCommandLocalIdStore(e.commandId)}),s=await i.getJournalSet(n)}const u=new d.Journal(s.remoteJournal.journalId,this.store),l=await this.push(a,u);return await this._runFetch(n,s,r),await o.reset(u),l}async reset(e){const t=await this.store.getJournalStore().getJournal(e);await new d.Journal(t.journalId,this.store).reset()}async clearLocalStore(){await this.store.clearLocalStore()}async updateJournalProperties(e,t){const n=this.store.getJournalStore();await n.updateJournal(e,{properties:t})}async getJournalCommands(e,t){return this.store.getJournalStore().getJournalCommands(e,{fields:["commandId","commandName","status","modifiedDate","parameters","dependsOn","inputEntities","modifiedEntities"],filters:t})}async setParentJournal(e,t,{mode:n="tree",rebase:r=!0,recursiveRebase:o=!1}={}){o&&u.default(!0===r,"rebase should be set to true for recursive rebase");const i=new d.Journal(e,this.store),s=await i.getData();if("isolation"!==s.role)throw new c.JournalError(c.JournalErrorCode.L7_JOURNAL_CANNOT_SET_PARENT,`Cannot set the parent journal of a ${s.role} journal.`);const a=this.store.getJournalStore();if("remote"===(await a.getJournal(t)).role)throw new c.JournalError(c.JournalErrorCode.L7_JOURNAL_CANNOT_SET_PARENT,"Parent journal cannot be the remote journal.");if("tree"===n){const n=new d.Journal(t,this.store);if((await n.getLineage()).includes(e))throw new c.JournalError(c.JournalErrorCode.L7_JOURNAL_CANNOT_SET_PARENT,`${t} is a descendant of ${e}, try single mode.`)}const l=[],p=[{journalId:e,parentJournalId:t}];if("single"===n){const e=await i.getParentJournal();u.default(e);const t=await a.getJournalsByParent(i.id);if(t.forEach(t=>{p.push({journalId:t.journalId,parentJournalId:e.id})}),o){const e=t.map(e=>this._getChildJournalsToRebase(e.journalId)),n=(await Promise.all(e)).reduce((e,t)=>e.concat(t),[]);l.push(...n)}}else if(o){const t=await this._getChildJournalsToRebase(e);l.push(...t)}if(r){const e=[...p.map(e=>e.journalId),...l.map(e=>e.journalId)];await this.journalManager.staging(...e).execute(async e=>{const t=this._getRootJournals(p);await Promise.all(t.map(async t=>{const n=e[t.journalId];u.default(n),await a.updateJournal(n.id,{parentJournalId:t.parentJournalId}),await this.journalManager.rebase(n),o&&await this._rebaseChildJournals(t.journalId,l,e);const r=p.filter(e=>e.parentJournalId===t.journalId);await Promise.all(r.map(async n=>{const r=e[n.journalId];u.default(r),await a.updateJournal(r.id,{parentJournalId:n.parentJournalId}),await this.journalManager.rebase(r),o&&await this._rebaseChildJournals(t.journalId,l,e)}))}))})}else await Promise.all(p.map(e=>a.updateJournal(e.journalId,{parentJournalId:e.parentJournalId})))}async dispose(){this._disposing=!0,this.autoSynchronizationMode.clear(),await Promise.all([...this._pendingPromises].map(e=>e.catch(e=>e))),u.default(0===this._pendingPromises.size,"There are still pending promisses."),await this.syncHandler.dispose(),this.restClient.dispose(),await this.store.dispose()}_getRootJournals(e){const t=new Map,n=[];for(let n=0;n<e.length;n++)t.set(e[n].journalId,e[n].parentJournalId);return t.forEach((e,r)=>{t.get(e)||n.push({journalId:r,parentJournalId:e})}),n}async _getChildJournalsToRebase(e){let t=(await this.store.getJournalStore().getJournalsByParent(e)).map(t=>({journalId:t.journalId,parentJournalId:e}));if(t.length){const e=t.map(e=>this._getChildJournalsToRebase(e.journalId)),n=(await Promise.all(e)).reduce((e,t)=>e.concat(t),[]);t=t.concat(n)}return t}async _rebaseChildJournals(e,t,n){const r=t.filter(t=>t.parentJournalId===e);await Promise.all(r.map(async e=>{const r=this.store.getJournalStore(),o=n[e.journalId];u.default(o),await r.updateJournal(o.id,{parentJournalId:e.parentJournalId}),await this.journalManager.rebase(o),await this._rebaseChildJournals(e.journalId,t,n)}))}static observePromises(e,t,n){const r=n.value;return n.value=function observe(...e){const t=r.apply(this,e).finally(()=>{this._pendingPromises.delete(t)});return this._pendingPromises.add(t),t},n}static rejectIfDisposing(e,t,n){const r=n.value;return n.value=function assertNotDisposing(...e){return this._disposing?Promise.reject(new c.JournalError(c.JournalErrorCode.L7_DISPOSING,c.JournalErrorCode.L7_DISPOSING.description)):r.apply(this,e)},n}}i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"executeQuery",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"executeCommand",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"executeCommandBatch",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"createCollection",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"synchronizeJournals",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"createIsolationJournal",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"deleteIsolationJournal",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"fetch",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"rebase",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"getJournals",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"dropEntities",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"pull",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"synchronizeWithServer",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"reset",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"clearLocalStore",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"updateJournalProperties",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"getJournalCommands",null),i([JournalingSDK.rejectIfDisposing,JournalingSDK.observePromises],JournalingSDK.prototype,"setParentJournal",null),t.JournalingSDK=JournalingSDK},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JournalManager=void 0;const r=n(19),o=n(1002),i=n(383);t.JournalManager=class JournalManager{constructor(e,t){this.commandExecutor=e,this.store=t}async rebase(e,t){let n=await e.getCommands();if(t&&t.length>0)try{n=i.removeCommands(i.bridgeOrNoop)(n,t)}catch(e){if(e instanceof r.JournalError&&e.code===r.JournalErrorCode.L7_COMMAND_NOT_FOUND_IN_THE_BATCH)throw new r.JournalError(r.JournalErrorCode.L7_COMMAND_NOT_FOUND_IN_JOURNAL,"The command was not found in the batch",e);throw e}if(0===n.length)return;const o=await this.commandExecutor.createBatchForReexecution(n);await this.commandExecutor.executeLocally(e,o,[])}staging(...e){return new o.StagingArea(this,e)}async fastForward(e,t,n){await this.store.getJournalStore().transferCommands(e.id,t.id,n),await this.store.getEntityStore().transferRevisions(e.id,t.id)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StagingArea=void 0;const r=n(1003);t.StagingArea=class StagingArea{constructor(e,t){this.journalManager=e,this.targetJournals=t,this.stagingJournals={},this.journalStore=this.journalManager.store.getJournalStore()}async execute(e){try{await this._begin();const t=await e(this.stagingJournals);return await this._commit(),t}catch(e){throw await this._drop(),e}}async _begin(){const e=this.targetJournals.map(e=>this.journalStore.createJournal({parentJournalId:e,role:"staging",properties:{}})),t=await Promise.all(e);this.targetJournals.forEach((e,n)=>{this.stagingJournals[e]=new r.StagingJournal(t[n].journalId,this.journalManager.store,e)})}async _commit(){const e=this.targetJournals.map(async e=>{const t=this.stagingJournals[e],n=await t.getParentJournal();return n&&t.targetJournal.id!==(null==n?void 0:n.id)&&await t.targetJournal.reset(n),this.journalManager.fastForward(t,t.targetJournal)});await Promise.all(e),await this._drop()}async _drop(){const e=Object.values(this.stagingJournals).map(e=>this.journalStore.deleteJournal(e.id));await Promise.all(e),this.stagingJournals={},this.targetJournals=[]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StagingJournal=void 0;const r=n(382);class StagingJournal extends r.Journal{constructor(e,t,n){super(e,t),this.targetJournal=new r.Journal(n,t)}setTargetJournal(e){this.targetJournal=e}async getCommands(){return[...await this.store.getJournalStore().getJournalCommands(this.targetJournal.id),...await this.store.getJournalStore().getJournalCommands(this.id)]}}t.StagingJournal=StagingJournal},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JournalEventEmitter=void 0;const r=n(19),o=n(121),i=n(161);t.JournalEventEmitter=class JournalEventEmitter{constructor(){this.journalEvents={fetch:{listeners:{}},push:{listeners:{}},autoSynchronizeStart:{listeners:{}},autoSynchronizeComplete:{listeners:{}},autoSynchronizeError:{listeners:{}}}}on(e,t,n){if(!(e in this.journalEvents))throw new r.JournalError(r.JournalErrorCode.L7_EVENT_NOT_SUPPORTED,""+e);const i=o.nanoid();return this.journalEvents[e].listeners[i]={listener:t,options:{filters:n||{}}},i}off(e){Object.values(this.journalEvents).forEach(t=>{e.forEach(e=>{e in t.listeners&&delete t.listeners[e]})})}registeredListeners(e){return Object.keys(this.journalEvents[e].listeners)}dispatchEvent(e,t){for(const n in this.journalEvents[e].listeners){const{filters:r}=this.journalEvents[e].listeners[n].options,o=i.filterHelper(t,r);if(o.length){const t=this.journalEvents[e].listeners[n].listener;try{t(o).catch(()=>{})}catch(e){}}}}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(1006),t),o(n(1009),t)},function(e,t,n){"use strict";var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CommandExecutionEvents=t.CommandExecutor=t.L2_BATCH_SIZE=void 0;const i=n(153),s=n(19),a=o(n(46)),c=n(29),u=n(121),l=o(n(227)),d=n(381),p=n(379),h=n(225),m=n(226),y=n(1007),g=n(165),_=n(383);function commandIsProcessed(e){return"FAILED"===e||"SUCCESS"===e}function validateServerResponseData(e){if(!e||!e.status||!e.commandId)throw new s.JournalError(s.JournalErrorCode.L7_GEN_DOWNSTREAM_ERROR,"The server response body is incomplete: no commandId and/or status were returned for the command/s.",void 0,e);if(!["SUCCESS","FAILED","STARTED","BLOCKED","NOT_PROCESSED"].includes(e.status))throw new s.JournalError(s.JournalErrorCode.L7_GEN_DOWNSTREAM_ERROR,`The command status ${e.status} in the server response is not supported by L7.`,void 0,e)}function validateCommandBatchResponse(e){var t;if(!e.data)throw new s.JournalError(s.JournalErrorCode.L7_GEN_DOWNSTREAM_ERROR,"The server response body is empty.",void 0,e.data);const n=e.data;(null!==(t=n.commands)&&void 0!==t?t:[n]).forEach(validateServerResponseData)}t.L2_BATCH_SIZE=100;class CommandExecutor extends c.EventEmitter{constructor(e,t,n,r,o){super(),this.store=e,this.restClient=t,this.commandRegistry=n,this.config=r,this.queryExecutor=o,this.waitingLine=[],this.busy=!1,this.on("NEXT:JOB",()=>{if(this.waitingLine.length){const e=this.waitingLine.shift();this.emit(e)}})}setGenerateTokenFn(e){this.restClient.config.getBearerToken=e}async executeLocally(e,t,n){a.default(t.length>0,"command batch is empty");const r=t.map(e=>e.commandName===g.COMMAND_NOOP||e.commandName===g.COMMAND_EXECUTION_NOOP?null:this.commandRegistry.getRegisteredCommand(e.commandName)),o=r.indexOf(void 0);if(-1!==o)throw new s.JournalError(s.JournalErrorCode.L7_COMMAND_NOT_REGISTERED,`No command registered with name ${t[o].commandName}.`);const i=r.findIndex(e=>e&&!e.executeLocally);if(-1!==i)throw new s.JournalError(s.JournalErrorCode.L7_COMMAND_CANNOT_EXECUTE_LOCALLY,`Command definition with name '${t[i].commandName}' does not define an \`executeLocally\` callback.`);CommandExecutor.validateBatchElementsDependentParameters(t),n&&n.length>0&&await CommandExecutor.validateBatchDependencies(e,n);try{return this.busy||this.waitingLine.length>0?(this.busy=!0,await this._enqueueJob({id:u.nanoid(),commands:t,journal:e})):(this.busy=!0,await this._doExecuteLocally(e,t,n))}finally{this.busy=!1}}static ifDependentParameter(e,t){if("string"==typeof e){const[n,r,...o]=e.split(".");"$"===n&&t(r,o)}}static mapDependentParameters(e,t){const n=[],r=l.default(e).map((function(e){this.key&&CommandExecutor.ifDependentParameter(this.key,(e,r)=>{n.push({path:this.path,newKey:t(e,r)})}),CommandExecutor.ifDependentParameter(e,(e,n)=>this.update(t(e,n)))})),o=[];let i=0;for(const e of n)o[e.path.length]=o[e.path.length]||[],o[e.path.length].push(i++);for(;o.length;){const e=o.pop()||[],t=[];for(const o of e){const e=n[o],i=[...e.path],s=i.pop(),a=l.default(r).get(i),c=a[s];t.push({parent:a,key:e.newKey,value:c}),delete a[s]}for(const e of t)e.parent[e.key]=e.value}return r}static mapDependentIntKeyParameters(e,t){return CommandExecutor.mapDependentParameters(e,(e,n)=>{const r=Number(e);return Number.isInteger(r)&&r>=0?t(r,n):`$.${e}.${n.join(".")}`})}static mapDependentParameterIndices(e,t){return CommandExecutor.mapDependentIntKeyParameters(e,(e,n)=>`$.${t(e)}.${n.join(".")}`)}static mapDependentParameterWithValue(e,t){return CommandExecutor.mapDependentIntKeyParameters(e,(e,n)=>{const r=l.default(t[e]);return r.has(n)?r.get(n):["$",e,...n].join(".")})}static validateBatchElementsDependentParameters(e){e.forEach(({parameters:t,dependsOn:n},r)=>{const o=new Set(n);CommandExecutor.mapDependentParameters(t,(t,n)=>{const i=Number(t);if(!Number.isInteger(i)||i<0||i>=e.length)throw new s.JournalError(s.JournalErrorCode.L7_COMMAND_BATCH_BAD_DEPENDENT_PARAM,`Batch element at index ${r} has dependent parameter with dependency '${t}' which is not the index of another command in the same batch.`);if(!o.has(i))throw new s.JournalError(s.JournalErrorCode.L7_COMMAND_BATCH_BAD_DEPENDENT_PARAM,`Batch element at index ${r} uses dependency index ${i} in dependent parameter missing from element dependency list (dependsOn).`);if(e[i].commandName===g.COMMAND_NOOP||e[i].commandName===g.COMMAND_EXECUTION_NOOP)throw new s.JournalError(s.JournalErrorCode.L7_COMMAND_BATCH_BAD_DEPENDENT_PARAM,`Batch element at index ${r} has dependent parameter with dependency '${i}' which is a NOOP command.`);return`$.${i}.${n.join(".")}`})})}static async validateBatchDependencies(e,t){const n=(await e.getCommands()).filter(e=>e.status===s.CommandStatus.SUCCESS).map(e=>e.commandId);t.forEach(e=>{if(!n.includes(e))throw new s.JournalError(s.JournalErrorCode.L7_COMMAND_NOT_FOUND_IN_JOURNAL,"The command dependency is not valid.")})}static async getJournalLeafCommandIds(e){const t=(await e.getCommands()).filter(e=>e.status===s.CommandStatus.SUCCESS),n=new Set;return t.forEach(e=>{e.dependsOn&&e.dependsOn.forEach(e=>{n.add(e)})}),t.filter(e=>!n.has(e.commandId)).map(e=>e.commandId)}async _doExecuteLocally(e,t,n){var r,o;try{let i;const getBatchRootDependencies=async()=>{if(!i&&(i=n||await CommandExecutor.getJournalLeafCommandIds(e),i.length)){const t=await e.addCommand({commandName:g.COMMAND_EXECUTION_NOOP,parameters:{},dependsOn:i,status:s.CommandStatus.SUCCESS});i=[t.id]}return i},a=y.sortCommandBatch(t.map((e,t)=>Object.assign(Object.assign({},e),{originalIndex:t}))),c=new Array(t.length);for(const{commandName:n,parameters:i,localIdStore:u={},originalIndex:l}of a){const a=null!==(o=null===(r=t[l].dependsOn)||void 0===r?void 0:r.map(e=>c[e].commandId))&&void 0!==o?o:await getBatchRootDependencies(),d=await e.addCommand({commandName:n,parameters:CommandExecutor.mapDependentParameterIndices(i,e=>c[e].commandId),status:s.CommandStatus.NOT_PROCESSED,dependsOn:a});if(n===g.COMMAND_NOOP||n===g.COMMAND_EXECUTION_NOOP){c[l]={commandId:d.id,result:void 0};continue}const m=this.commandRegistry.getRegisteredCommand(n),y=new h.CommandContext(e,d,u,this,this.queryExecutor,this.store.getJournalStore(),this.store.getEntityStore());try{await e.updateCommand(d.id,{status:s.CommandStatus.STARTED});const t=await this._invokeExecuteLocallyCallback(m,CommandExecutor.mapDependentParameterWithValue(i,c),y);await e.updateCommand(d.id,{status:s.CommandStatus.SUCCESS}),c[l]={commandId:d.id,result:t},await d.setLocalIdStore(y.idStore())}catch(r){await e.updateCommand(d.id,{status:s.CommandStatus.FAILED});const o=`An error occurred executing the command with INPUT POSITION: ${l} and NAME: ${n}.`,i=[],a=[];for(const[e,n]of c.entries())n&&n.commandId?i.push({inputIndex:e,commandName:t[e].commandName}):a.push({inputIndex:e,commandName:t[e].commandName});throw new p.CommandBatchJournalError(s.JournalErrorCode.L7_COMMAND_BATCH_LOCAL_EXECUTION_ERROR,o,r,l,i,a)}finally{delete y.journal,delete y.command}}return c}finally{this.busy=!1,this.emit("NEXT:JOB")}}async executeNested(e,t,n){const r=this.commandRegistry.getRegisteredCommand(e);if(!r)throw new s.JournalError(s.JournalErrorCode.L7_COMMAND_NOT_REGISTERED,`No command registered with name ${e}.`);if(!r.executeLocally)throw new s.JournalError(s.JournalErrorCode.L7_COMMAND_CANNOT_EXECUTE_LOCALLY,"Command definition does not define local execution routine.");return this._invokeExecuteLocallyCallback(r,t,n)}async _invokeExecuteLocallyCallback(e,t,n){try{await this.store.startTransaction();const r=await e.executeLocally(n,t,e.userState);return await this.store.endTransaction(!0),r}catch(e){throw await this.store.endTransaction(!1),e}}async executeOnServer(e,n,r){if(r){const e=await r.getData();if("remote"!==e.role)throw new s.JournalError(s.JournalErrorCode.L7_JOURNAL_CANNOT_PUSH,`Cannot record push into '${e.role}' journal.`)}if(!r&&(e.length>1||e[0].dependsOn))throw new s.JournalError(s.JournalErrorCode.L7_COMMAND_BATCH_EXECUTION_NOT_ALLOWED,"Commands cannot be executed in batch without a collection.");const o=e.map(e=>e.commandName===g.COMMAND_NOOP||e.commandName===g.COMMAND_EXECUTION_NOOP?null:this.commandRegistry.getRegisteredCommand(e.commandName)).indexOf(void 0);if(-1!==o)throw new s.JournalError(s.JournalErrorCode.L7_COMMAND_NOT_REGISTERED,`No command registered with name ${e[o].commandName}.`);if(!r)return this._executeRootCommandOnServer(Object.assign(Object.assign({},e[0]),{commandId:0}),n);CommandExecutor.validateBatchElementsDependentParameters(e);const a=e.map((e,t)=>{var n;return Object.assign(Object.assign({},e),{originalIndex:t,dependentNodes:[],dependsOn:null!==(n=e.dependsOn)&&void 0!==n?n:[]})}),c=y.sortCommandBatch(a),u=new Map,l=new Map,d=_.splitBy(c.map((e,t)=>(u.set(e.originalIndex,t),l.set(t,e.originalIndex),Object.assign(Object.assign({},e),{commandId:t,parameters:CommandExecutor.mapDependentParameterIndices(e.parameters,e=>u.get(e))}))),e=>e.commandName===g.COMMAND_EXECUTION_NOOP),p=new Array(a.length),h=new Array(a.length),m=new Array(a.length),processAllCommandDependentNodes=e=>{const{commandName:t,parameters:n,dependsOn:r,dependentNodes:o}=c[e.index],i=l.get(e.index);void 0===p[i]&&t!==g.COMMAND_EXECUTION_NOOP&&t!==g.COMMAND_NOOP&&(p[i]={result:s.CommandStatus.NOT_PROCESSED},h[i]={commandId:s.CommandStatus.NOT_PROCESSED,status:s.CommandStatus.NOT_PROCESSED,commandName:t,parameters:n,dependsOn:r.map(e=>""+e)},e.dependentNodes.forEach(e=>processAllCommandDependentNodes({index:e,dependentNodes:o})))},v=_.removeCommands(_.bridge);for(const e of d){const n=i.chunk(v(e,e.filter(({commandName:e})=>e===g.COMMAND_NOOP).map(e=>e.commandId)),t.L2_BATCH_SIZE),o=new Array(e.length);n.forEach((e,t)=>{e.forEach(({originalIndex:e})=>{o[e]=t})});const a={promises:new Array(n.length)},{promises:l}=n.reduce((e,t,n)=>{const i=[...new Set([].concat(...t.map(({dependsOn:e})=>(null!=e?e:[]).map(e=>o[e]))))],a=Promise.all(i.map(t=>e.promises[t]));return e.promises[n]=a.then(async()=>{const e=t.filter(({originalIndex:e})=>!h[e]).map(e=>{const t=CommandExecutor.mapDependentParameterWithValue(e.parameters,m),n=e.dependsOn.filter(e=>void 0===m[e]);return Object.assign(Object.assign({},e),{dependsOn:n,parameters:t})});if(e.length>0){const t=await this._executeCommandBatchOnServer(r,e);e.forEach(({originalIndex:e,dependentNodes:n},r)=>{t.commands[r].status!==s.CommandStatus.SUCCESS&&n.forEach(e=>{processAllCommandDependentNodes({index:e,dependentNodes:c[e].dependentNodes})}),p[e]=t.processedResults[r],h[e]=t.commands[r],m[u.get(e)]={commandId:t.commands[r].commandId,result:t.processedResults[r]}})}}),e},a);await Promise.all(l)}const E=await r.getData();return{processedResults:p.filter(e=>void 0!==e),commands:h.filter(e=>void 0!==e),remoteJournal:{journalId:E.journalId,parentJournalId:E.parentJournalId,properties:E.properties}}}async _prepareCommandBatch(e,t){const n=new Array(t.length),o=new Array(t.length);return await Promise.all(t.map(async(t,i)=>{var s,{commandName:c,parameters:u}=t,l=r(t,["commandName","parameters"]);const d=this.commandRegistry.getRegisteredCommand(c);a.default(d);let p=u;if(e&&d.rewriteIds){const t=this.store.getEntityStore();p=await d.rewriteIds(p,async(n,r)=>{const{entityPermanentId:o,revisionPermanentId:i}=await t.getEntityIds(n,r?{journalId:e.id,revisionId:r}:void 0);return Object.assign({entityId:o},r&&{revisionId:i})},d.userState)}const h=d.createPayload(p,d.userState),m={temporaryId:l.commandId,commandType:d.serverCommandName,payload:h,dependsOn:null!==(s=l.dependsOn)&&void 0!==s?s:[]},{resourceId:y,metadata:g}=p;y&&(m.resourceId=y),g&&(m.metadata=g),o[i]=m,n[i]={commandName:c,parameters:u}})),{commandsData:n,requestPayload:o}}async _executeCommandBatchOnServer(e,t){const{commandsData:n,requestPayload:r}=await this._prepareCommandBatch(e,t),o=await this.restClient.post(`collections/${e.id}/commands`,{commands:r}),i={},s=[];validateCommandBatchResponse(o);const a=o.data.commands;for(let r=0;r<a.length;r++){const o=await this.store.getJournalStore().addCommandToJournal(e.id,{commandId:a[r].commandId,status:a[r].status,commandName:n[r].commandName,parameters:n[r].parameters,dependsOn:[]});i[o.commandId]={index:r,data:o,localIdStore:t[r].localIdStore},commandIsProcessed(a[r].status)||s.push(a[r].commandId)}const c=await this._waitForCollectionCommandBatchExecution(e,s,i),u=Object.values(i).reduce((e,{index:t,data:n})=>(e[t]=n,e),new Array(t.length)),l=await e.getData();return{processedResults:u.map(e=>c[e.commandId]),commands:u,remoteJournal:{journalId:l.journalId,parentJournalId:l.parentJournalId,properties:l.properties}}}async _executeRootCommandOnServer(e,t){var n,r,o;const{requestPayload:i}=await this._prepareCommandBatch(void 0,[e]),a=await this.restClient.post("commands",i[0]);validateServerResponseData(a.data);const c={commandId:a.data.commandId,status:a.data.status,commandName:e.commandName,parameters:e.parameters,dependsOn:[]};let u,l=0;for(;!commandIsProcessed(c.status)&&l++<this.config.commandPollingAttempts;)u=await this.restClient.get("commands/"+c.commandId,{retries:this.config.commandPollingAttempts,retriesInterval:this.config.commandPollingInterval}),validateServerResponseData(u.data),c.status=u.data.status,commandIsProcessed(c.status)||await new Promise(e=>setTimeout(e,this.config.commandPollingInterval));const p=null===(r=null===(n=u.data)||void 0===n?void 0:n.result)||void 0===r?void 0:r.resourceId;if(!p)throw new s.JournalError(s.JournalErrorCode.L7_CREATE_COLLECTION_FAILED,"Create collection failed.",void 0,null===(o=u.data)||void 0===o?void 0:o.result);const{journalId:m,parentJournalId:y,properties:g}=await this.store.getJournalStore().createJournal({journalId:p,collectionId:t||p,role:"remote",parentJournalId:null,properties:{}}),_=new d.Journal(m,this.store),v=await _.addCommand(c),E=new h.CommandContext(_,v,e.localIdStore||{},this,this.queryExecutor,this.store.getJournalStore(),this.store.getEntityStore()),I=this.commandRegistry.getRegisteredCommand(e.commandName);return{processedResults:[await I.processResults(E,u.data,I.userState)],commands:[c],remoteJournal:{journalId:m,parentJournalId:y,properties:g}}}_enqueueJob(e){return new Promise(t=>{const n="NEXT:JOB:"+e.id;this.waitingLine.push(n);const waitFn=async()=>{this.removeListener(n,waitFn);const r=await this._doExecuteLocally(e.journal,e.commands);t(r)};this.on(n,waitFn)})}async _waitForCollectionCommandBatchExecution(e,t,n){const r=t.map(e=>({commandId:e,serverResult:void 0})),o={};let i=0;for(;r.length>0&&i++<this.config.commandPollingAttempts;){let t="commands/"+r[0].commandId;if(r.length>1){const n=r.map(e=>"commandId="+e.commandId).join("&");t=`collections/${e.id}/commands?${n}`}const i=await this.restClient.get(t,{retries:this.config.commandPollingAttempts,retriesInterval:this.config.commandPollingInterval});r.splice(0,r.length),validateCommandBatchResponse(i);let s=i.data.commands;s||(s=[i.data]);for(const t of s){const{commandId:i,status:s}=t;if(commandIsProcessed(s)){const r=await e.updateCommand(i,{status:s});n[i].data=await r.getData();const{data:a,localIdStore:c}=n[i],u=new h.CommandContext(e,r,c||{},this,this.queryExecutor,this.store.getJournalStore(),this.store.getEntityStore()),l=this.commandRegistry.getRegisteredCommand(a.commandName);o[i]=await l.processResults(u,t,l.userState)}else r.push({commandId:i,serverResult:t})}r.length>0&&await new Promise(e=>setTimeout(e,this.config.commandPollingInterval))}if(r.length>0)for(const{commandId:t,serverResult:i}of r){const{data:r,localIdStore:s}=n[t],a=new m.Command(t,this.store.getJournalStore()),c=new h.CommandContext(e,a,s||{},this,this.queryExecutor,this.store.getJournalStore(),this.store.getEntityStore()),u=this.commandRegistry.getRegisteredCommand(r.commandName);o[r.commandId]=await u.processResults(c,i,u.userState)}return o}async createBatchForReexecution(e){const t=e.reduce((e,t,n)=>Object.assign(Object.assign({},e),{[t.commandId]:n}),{});return Promise.all(e.map(async e=>{const n=CommandExecutor.mapDependentParameters(e.parameters,(e,n)=>{const r=t[e];return void 0!==r?`$.${r}.${n.join(".")}`:`$.${e}.${n.join(".")}`});return{commandName:e.commandName,parameters:n,dependsOn:e.dependsOn.length?e.dependsOn.map(e=>t[e]).filter(e=>void 0!==e):void 0,localIdStore:await this.store.getJournalStore().getCommandLocalIdStore(e.commandId)}}))}}t.CommandExecutor=CommandExecutor,t.CommandExecutionEvents={NEXT_JOB:"NEXT:JOB"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitCommandBatch=t.sortCommandBatch=t.getBatchWithDependenciesFromGraph=t.getGraphFromCommandBatch=void 0;const r=n(19),o=n(1008);function getGraphFromCommandBatch(e){const t={nodes:[],edges:[]};return e.forEach((n,o)=>{t.nodes.push(n),n.dependsOn&&n.dependsOn.forEach(n=>{if(n<0||n>=e.length)throw new r.JournalError(r.JournalErrorCode.L7_COMMAND_DEPENDENCY_INDEX_OUTSIDE_BOUNDARIES,"Dependency indexes are outside of commandBatch boundaries.");const i=[n,o];t.edges.push(i)})}),t}function getBatchWithDependenciesFromGraph(e){const t=e.nodes.map(e=>Object.assign(Object.assign(Object.assign({},e),e.dependsOn&&{dependsOn:[]}),{dependentNodes:[]}));return e.edges.forEach(e=>{t[e[1]].dependsOn.push(e[0]),t[e[0]].dependentNodes.push(e[1])}),t}t.getGraphFromCommandBatch=getGraphFromCommandBatch,t.getBatchWithDependenciesFromGraph=getBatchWithDependenciesFromGraph,t.sortCommandBatch=function sortCommandBatch(e){try{let t=getGraphFromCommandBatch(e);return t=o.topologicalSort(t),getBatchWithDependenciesFromGraph(t)}catch(e){throw new r.JournalError(r.JournalErrorCode.L7_COMMAND_GRAPH_GEN_ERROR,e)}},t.splitCommandBatch=function splitCommandBatch(e,t){try{const n=getGraphFromCommandBatch(e);return o.coffmanGraham(n,t)}catch(e){throw new r.JournalError(r.JournalErrorCode.L7_COMMAND_GRAPH_GEN_ERROR,e)}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.coffmanGraham=t.topologicalSort=void 0;const o=r(n(46));function topologicalSort(e){if(!e.nodes.length||!e.edges.length)return function clone(e){return{nodes:[...e.nodes],edges:[...e.edges]}}(e);const t=new Array(e.nodes.length).fill(0),n=Array.from({length:e.nodes.length},()=>[]),r=Array.from({length:e.nodes.length},()=>[]);e.edges.forEach(([n,i])=>{o.default(Number.isInteger(n)&&n>=0&&n<e.nodes.length),o.default(Number.isInteger(i)&&i>=0&&i<e.nodes.length),++t[i],r[n].push(i)});const i=[];t.forEach((e,t)=>{0===e&&i.push(t)});const s={nodes:new Array(e.nodes.length),edges:new Array(e.edges.length)};for(let o=0,a=0,c=i.shift();void 0!==c;++o,c=i.shift()){s.nodes[o]=e.nodes[c];const u=n[c];delete n[c],s.edges.splice(a,u.length,...u.map(e=>[e,o])),a+=u.length;const l=r[c];if(delete r[c],l.length){const e=[];l.forEach(r=>{0==--t[r]&&e.push(r),n[r].push(o)}),e.sort((e,t)=>{const r=n[e],o=n[t];let i,s,a=r.length-2,c=o.length-2;do{i=r[a--],s=o[c--]}while(i===s&&void 0!==i);return i===s?0:void 0===i||i<=s?-1:1}),i.push(...e)}}if(r.some(e=>void 0!==e))throw Error("graph has at least one cycle");return s}t.topologicalSort=topologicalSort,t.coffmanGraham=function coffmanGraham(e,t=Number.POSITIVE_INFINITY){var n;o.default(t>0&&(Number.isInteger(t)||!Number.isFinite(t)),"invalid value for parameter `w`: "+t);const{nodes:r,edges:i}=topologicalSort(e),s=new Array(r.length),a=[];for(let e=0,o=0;e<r.length;++e){const c=r[e];let u=-1;for(;(null===(n=i[o])||void 0===n?void 0:n[1])===e;){const[e]=i[o++];u=Math.max(u,s[e])}let l=!1;for(let n=u+1;n<a.length;++n){const r=a[n];r.length<t&&(s[e]=n,l=!0,r.push(c))}l||(s[e]=a.length,a.push([c]))}return a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryExecutor=void 0;const r=n(19),o=n(225);class QueryExecutor{constructor(e,t,n){this.store=e,this.restClient=t,this.queryRegistry=n}setGenerateTokenFn(e){this.restClient.config.getBearerToken=e}async executeOnServer(e){const{queryDefinition:t,parameters:n,fetchMode:i,journal:s,context:a,traceContext:c}=e;let u;if(i!==r.FetchMode.ONLY_SERVER&&t.executeLocally&&(u=await t.executeLocally.call(this,null!=a?a:new o.QueryContext(s,this.store.getJournalStore(),this.store.getEntityStore(),this),n,t.userState)),!u&&i!==r.FetchMode.ONLY_LOCAL){let e=n;if(s&&t.rewriteIds){const n=this.store.getEntityStore();e=await t.rewriteIds(e,async(e,t)=>{const{entityPermanentId:r,revisionPermanentId:o}=await n.getEntityIds(e,t?{journalId:s.id,revisionId:t}:void 0);return Object.assign({entityId:r},t&&{revisionId:o})},t.userState)}const r=QueryExecutor.resolveURL(t,e),i=t.createPayload(e,t.userState),l={url:r,method:t.httpMethod||"GET"};"GET"===l.method?l.params=i:l.data=i,c&&(l.headers={traceparent:null==c?void 0:c.traceParent,tracestate:null==c?void 0:c.traceState}),u=await this.restClient.request(l),u=await t.processResults(null!=a?a:new o.QueryContext(s,this.store.getJournalStore(),this.store.getEntityStore(),this),u.data,t.userState)}return u}async executeLocally(e){const{queryDefinition:t,parameters:n,fetchMode:i,journal:s,context:a}=e;if(i===r.FetchMode.ONLY_SERVER)throw new r.JournalError(r.JournalErrorCode.L7_FETCH_MODE_NOT_ALLOWED,"Cannot fetch local-only state from the server.");if(!t.executeLocally)throw new r.JournalError(r.JournalErrorCode.L7_BAD_QUERY_DEFINITION,"executeLocally should be defined if the query is executed in a main or isolation journal.");return t.executeLocally(null!=a?a:new o.QueryContext(s,this.store.getJournalStore(),this.store.getEntityStore(),this),n,t.userState)}async executeNested(e,t,n,o,i,s){if(!e)throw new r.JournalError(r.JournalErrorCode.L7_GEN_NULL_VALUE,"queryName");if(!t)throw new r.JournalError(r.JournalErrorCode.L7_GEN_NULL_VALUE,"parameters");const a=this.queryRegistry.getRegisteredQuery(e);if(!a)throw new r.JournalError(r.JournalErrorCode.L7_QUERY_NOT_REGISTERED,`No query registered with name ${e}.`);const{role:c}=await i.getData(),u={queryDefinition:a,parameters:t,fetchMode:n,journal:i,context:o,traceContext:s};return"remote"===c?this.executeOnServer(u):this.executeLocally(u)}static resolveURL(e,t){let n;if("string"==typeof e.serverQueryEndpoint){if(n=e.serverQueryEndpoint,n.indexOf("{")>-1||n.indexOf("}")>-1){if(null==n.match(/^([^{}]*{[^{}]*})*[^{}]*$/g))throw new r.JournalError(r.JournalErrorCode.L7_QUERY_DEFINITION_INVALID_URL,r.JournalErrorCode.L7_QUERY_DEFINITION_INVALID_URL.description);n=n.replace(/{.*?}/g,e=>{const n=t[e.substring(1,e.length-1)];if(void 0!==n)return encodeURIComponent(n);throw new r.JournalError(r.JournalErrorCode.L7_QUERY_DEFINITION_URL_PARAM_NOT_FOUND,e+" is missing from parameters.")})}}else n=e.serverQueryEndpoint(t);return n}}t.QueryExecutor=QueryExecutor},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CONFIG=t.PARALLEL_REQUESTS_LIMIT=void 0;const r=n(19);t.PARALLEL_REQUESTS_LIMIT=13,t.DEFAULT_CONFIG={retries:1,retriesInterval:100,maximumRetriesInterval:6e4,exponentialBackOff:!0,retryCodes:new Array,retryErrors:new Array,noRetryCodes:new Array,throwIfNotSuccess:!0};class Client{constructor(e,n,r,o){this.adapter=e,this.config=n,this.httpAgent=r,this.httpsAgent=o,this.pendingRequests={},this.config=Object.assign(Object.assign({},t.DEFAULT_CONFIG),n)}async request(e){const n=Object.assign(Object.assign(Object.assign({},t.DEFAULT_CONFIG),this.config),e||{});(!n.retries||n.retries<=0)&&(n.retries=1);return Client.httpRetry(()=>this.doRequestConcurrently(n),n)}async get(e,t){return this.request(Object.assign(Object.assign({},t),{url:e,method:"GET"}))}async delete(e,t){return this.request(Object.assign(Object.assign({},t),{url:e,method:"DELETE"}))}async head(e,t){return this.request(Object.assign(Object.assign({},t),{url:e,method:"HEAD"}))}async post(e,t,n){return this.request(Object.assign(Object.assign({},n),{url:e,method:"POST",data:t}))}async put(e,t,n){return this.request(Object.assign(Object.assign({},n),{url:e,method:"PUT",data:t}))}async patch(e,t,n){return this.request(Object.assign(Object.assign({},n),{url:e,method:"PATCH",data:t}))}dispose(){var e,t;null===(e=this.httpAgent)||void 0===e||e.destroy(),null===(t=this.httpsAgent)||void 0===t||t.destroy()}static isBrowser(){return"undefined"!=typeof window&&void 0!==window.document}static async httpRetry(e,n){let o,i=1,s=n.retriesInterval||t.DEFAULT_CONFIG.retriesInterval;return async function tryFn(){var t,a,c;let u,l,d,p;try{if(u=await e(),d=null===(t=n.retryCodes)||void 0===t?void 0:t.includes(null==u?void 0:u.status),p=null===(a=n.noRetryCodes)||void 0===a?void 0:a.includes(null==u?void 0:u.status),u.status>=200&&u.status<300)return u;if(!n.throwIfNotSuccess&&(!d||p))return u}catch(e){if(l=e,!(null===(c=n.retryErrors)||void 0===c?void 0:c.includes(null==l?void 0:l.code)))throw new r.JournalError(r.JournalErrorCode.L7_GEN_DOWNSTREAM_ERROR,`Request failed after ${i} attempt(s). With error: ${(null==l?void 0:l.message)||(null==l?void 0:l.stack)}.`,l)}if(i>=n.retries||u&&(!d||p)){if(u)throw new r.JournalError(r.JournalErrorCode.L7_GEN_DOWNSTREAM_ERROR,`Request failed after ${i} attempt(s). With status: ${u.status} and message: ${JSON.stringify(u.data)}.`,l,{status:u.status,statusMessage:u.statusText,data:u.data});throw new r.JournalError(r.JournalErrorCode.L7_GEN_DOWNSTREAM_ERROR,`Request failed after ${i} attempt(s). With error: ${(null==l?void 0:l.message)||(null==l?void 0:l.stack)}.`,l)}return i+=1,s*=n.exponentialBackOff?2:1,o=n.maximumRetriesInterval&&s>=n.maximumRetriesInterval?n.maximumRetriesInterval:s,h=tryFn,m=o,new Promise((e,t)=>{setTimeout(()=>{h().then(e).catch(t)},m)});var h,m}()}async doRequestConcurrently(e){let n;const r=e.setAuthHeader?await e.setAuthHeader(e.getBearerToken):await Client.setDefaultAuthHeader(e.getBearerToken),o=Object.assign(Object.assign({},e.headers),r);if(0!==Object.keys(o).length&&(e.headers=o),Client.isBrowser()){Object.values(this.pendingRequests).length===t.PARALLEL_REQUESTS_LIMIT&&await Promise.race(Object.values(this.pendingRequests));const r=(Math.random()*Math.random()).toString(16),deleteRequest=()=>delete this.pendingRequests[r];n=Promise.resolve().then(()=>this.adapter.request(e)),this.pendingRequests[r]=n.then(deleteRequest).catch(deleteRequest)}else n=this.adapter.request(e);return n}static async setDefaultAuthHeader(e){if(!e)return{};let t=await e();return t.startsWith("Bearer")||(t="Bearer "+t),{authorization:t}}}t.default=Client},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t){function webpackEmptyContext(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,e.exports=webpackEmptyContext,webpackEmptyContext.id=1012},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(1014),t),o(n(1015),t),o(n(1016),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(24),i=n(36),s=n(164),a=n(221),c=n(223),u=n(6),l=n(222);class RevisionQueriesRegistry{static queryLocally(e,t,n){return r(this,void 0,void 0,(function*(){i.validateUserState(n);const r=t.limit||l.DEFAULT_QUERY_USER_LIMIT,a={limit:l.QUERY_BUFFER_SIZE};let d=t.offset||0,p=[],h=[];do{try{a.offset=d,p=(yield e.getEntityRevisions(t.id,a)).items}catch(e){throw new Error("Unable to query revisions")}if(0===p.length){if(0===h.length)return;break}h=h.concat(s.applyFilter(p,t.filter,RevisionQueriesRegistry.customKeyMapper)),d+=a.limit}while(h.length<r&&p.length>=a.limit);let m=a.offset;h.length<=r?m+=a.limit:(h=h.slice(0,r),m+=p.indexOf(h[h.length-1])+1);const y=[];for(const r of h){if(!r)return;const i=[],s=new u.FiltersBuilder({"asset.revision.id":r.revisionId}).build();let a=yield c.SnapshotQueriesRegistry.queryLocally(e,{filter:s},n);for(;a;){for(const e of a.results)i.push({id:e.id,url:`/collections/${t.spaceCollectionId}/snapshots/${e.id}`,type:e.typeid});a=yield c.SnapshotQueriesRegistry.queryLocally(e,{filter:s,offset:a.pagination.offset+a.pagination.limit},n)}const l=o.OfflineRevisionWrapper.initialize(r),d=l.getAttributes(),p=l.getComponentsChanges();y.push({resourceId:t.id,revisionId:l.getRevisionId(),changeTime:r.revisionDate.toISOString(),attributeChanged:!!d&&Object.keys(d).length>1,attributeChangeSet:d,metaChanged:!!p&&Object.keys(p).length>1,metaChangeSet:p,snapshotted:i.length>0,createdBy:l.getCreatedBy(),snapshots:i})}return{results:y,pagination:{limit:r,offset:y.length<r?-1:m}}}))}}t.RevisionQueriesRegistry=RevisionQueriesRegistry,RevisionQueriesRegistry.customKeyMapper=e=>a.getKeyMapper(e)},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(148),i=n(14),s=n(30),a=n(2),c=n(146);function applyAssetVisitorFunction(e,t){return r(this,void 0,void 0,(function*(){return t?t(e):s.TraversalAction.Continue}))}function applyRelationshipVisitorFunction(e,t,n,o){return r(this,void 0,void 0,(function*(){return o?o(e,t,n):s.TraversalAction.Continue}))}function filterEdgesByDirection(e,t,n){return t.filter(t=>"BOTH"===e||"OUT"===e&&n===t.fromNodeIdentifier||"IN"===e&&n===t.toNodeIdentifier)}class ClosureV2Traverser{constructor(e,t){if(this.assets=[],this.relationships=[],this.snapshots=[],t&&t.startAssets.length>ClosureV2Traverser.START_ASSETS_COUNT_LIMIT)throw new a.SDKError(`Exceeded closure starting assets limit ClosureV2Traverser.START_ASSETS_COUNT_LIMIT (${ClosureV2Traverser.START_ASSETS_COUNT_LIMIT})`);e instanceof i.AssetGraph?this.query={assetGraph:e,params:t}:this.queryResults=e}generateTopologyFromNodesJSON(e,t,n,r){this.topology=o.TopologyV2.buildFrom(e,t,n,r)}loadQueryResults(){return r(this,void 0,void 0,(function*(){this.query&&!this.queryResults&&(this.queryResults=yield this.query.assetGraph.getClosureV2(this.query.params));const e=this.queryResults;this.assets=e.getAssets(),this.relationships=e.getRelationships(),this.snapshots=e.getSnapshots();const t=e.getTopology();this.generateTopologyFromNodesJSON(t,this.assets,this.snapshots,this.relationships)}))}traverse(e,t,n,i={}){return r(this,void 0,void 0,(function*(){if(yield this.loadQueryResults(),!this.topology)throw new a.InternalError("Internal error: The topology should not be undefined.");const r=new Set,u=new Set,l=[];for(const t of e)l.push({asset:c.extractId(t.asset),snapshotContext:c.extractId(t.snapshotContext),depth:0});let d=s.INFINITE_DEPTH;i.maxDepth&&i.maxDepth>=1&&(d=i.maxDepth);const p=i.direction||"BOTH";for(;l.length>0;){const e=l.shift();if(!e)throw new a.InternalError("Internal error: ClosureTraverser queue has null elements.");const i=e.asset,h=e.snapshotContext,m=e.depth,y=o.TopologyV2.generateNodeIdentifier(i,h);if(!r.has(y)){const e=this.topology.getNode(y);if(!e)throw 0===m?new a.SDKError("Invalid start asset: asset/snapshot combination not part of closure results."):new a.InternalError(`Internal error: Can't find node (${y}) in closure results.`);let o=yield applyAssetVisitorFunction(e,t);if(o===s.TraversalAction.Abort)return Promise.resolve();if(r.add(y),m<d&&o!==s.TraversalAction.AbortThis){const e=filterEdgesByDirection(p,this.topology.getEdges(y),y);for(const t of e){const e=this.topology.getNode(t.fromNodeIdentifier),r=this.topology.getNode(t.toNodeIdentifier);if(!r)throw new a.InternalError(`Internal error: Can't find toAsset node (${t.toNodeIdentifier}) in closure results.`);if(!e)throw new a.InternalError(`Internal error: Can't find fromAsset node (${t.fromNodeIdentifier}) in closure results.`);if(u.has(t)?o=s.TraversalAction.AbortThis:(o=yield applyRelationshipVisitorFunction(t.relationship,e,r,n),u.add(t)),o===s.TraversalAction.Abort)return Promise.resolve();if(o!==s.TraversalAction.AbortThis)switch(p){case"OUT":l.push({asset:c.extractId(r.asset),snapshotContext:c.extractId(r.snapshotContext),depth:m+1});break;case"IN":l.push({asset:c.extractId(e.asset),snapshotContext:c.extractId(e.snapshotContext),depth:m+1});break;case"BOTH":t.fromNodeIdentifier===y?l.push({asset:c.extractId(r.asset),snapshotContext:c.extractId(r.snapshotContext),depth:m+1}):l.push({asset:c.extractId(e.asset),snapshotContext:c.extractId(e.snapshotContext),depth:m+1})}}}}}return Promise.resolve()}))}}t.ClosureV2Traverser=ClosureV2Traverser,ClosureV2Traverser.START_ASSETS_COUNT_LIMIT=50},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(14);t.extractIdOrReference=function extractIdOrReference(e){return e instanceof r.Entity&&!e.isNewResource()?e.getId():e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.WIP_URN="WIP_permission_context_urn"}(t.PermissionContextType||(t.PermissionContextType={})),function(e){e.PIM_CONTEXT="pim_wip_urn"}(t.PermissionContextName||(t.PermissionContextName={}))},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(13)),i=n(2);t.PermissionContextConverter=class PermissionContextConverter{static convertChangesetToContext(e){if(o.default(e))return;if(!e.insert||e.modify||e.remove)throw new i.InternalError('Actions other than "insert" are not supported. Updates/Remove follows the Changeset format.');const t=[];return Object.entries(e.insert).forEach(([,e])=>{Object.entries(e).forEach(([e,n])=>{t.push(Object.assign({name:e},n.String))})}),t}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(224)),i=r(n(376));t.chunkObject=function chunkObject(e,t){const n=Object.keys(e);return o.default(n,t).map(t=>i.default(e,t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);t.extractCollectionIdFromUrl=function extractCollectionIdFromUrl(e){const t=e.split("/"),n=t.indexOf("collections");if(-1===n||n===t.length-1)throw new r.InternalError("Could not extract collection name from "+e);return t[n+1]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(87);class RelationshipQueryPage extends r.QueryPage{constructor(e,t,n,r,o){super(e,n,r,o),this.relationships=t}getRelationships(){return this.relationships}}t.RelationshipQueryPage=RelationshipQueryPage},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1026);t.AssetRevisionsQueryResult=r.AssetRevisionsQueryResult;var o=n(1039);t.AssetsQueryResult=o.AssetsQueryResult;var i=n(1040);t.ClosureV2QueryResults=i.ClosureV2QueryResults;var s=n(67);t.QueryResult=s.QueryResult;var a=n(1041);t.RelationshipRevisionsQueryResult=a.RelationshipRevisionsQueryResult;var c=n(1042);t.RelationshipsQueryResult=c.RelationshipsQueryResult;var u=n(166);t.RevisionsQueryResult=u.RevisionsQueryResult;var l=n(392);t.SnapshotAssetsQueryResult=l.SnapshotAssetsQueryResult;var d=n(1043);t.SnapshotQueryResult=d.SnapshotQueryResult;var p=n(1044);t.SpaceQueryResult=p.SpaceQueryResult;var h=n(1045);t.SpaceRevisionsQueryResult=h.SpaceRevisionsQueryResult},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(166),i=n(26);class AssetRevisionsQueryResult extends o.RevisionsQueryResult{queryPage(){return r(this,void 0,void 0,(function*(){return this.sdkCore.getDataConnector().journalQuery(i.GetAssetRevisionsQueryName,this.queryParameters)}))}}t.AssetRevisionsQueryResult=AssetRevisionsQueryResult},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(24),o=n(55),i=n(83),s=n(31);t.CollectionDefinitions={commands:{[s.CreateCollectionCommandName]:{serverCommandName:"CreateCollection",createPayload:o.CollectionCommandsRegistry.createPayload,executeLocally:o.CollectionCommandsRegistry.createLocally,processResults:o.CollectionCommandsRegistry.processResults,userState:{}},[s.UpdateCollectionCommandName]:{serverCommandName:"UpdateCollection",createPayload:o.CollectionCommandsRegistry.updatePayload,executeLocally:o.CollectionCommandsRegistry.updateLocally,processResults:r.processCommandResults,userState:{}},[s.DeleteCollectionCommandName]:{serverCommandName:"DeleteCollection",createPayload:o.CollectionCommandsRegistry.deletePayload,processResults:r.processCommandResults},[s.PurgeCollectionCommandName]:{serverCommandName:"PurgeCollection",createPayload:o.CollectionCommandsRegistry.purgePayload,processResults:r.processCommandResults},[s.RestoreCollectionCommandName]:{serverCommandName:"RestoreCollection",createPayload:o.CollectionCommandsRegistry.restorePayload,processResults:r.processCommandResults}},queries:{[s.GetCollectionQueryName]:{serverQueryEndpoint:"collections/{id}",createPayload:e=>e,processResults:(e,t)=>o.CollectionCommandsRegistry.parseFetchPayload(t),executeLocally:i.CollectionQueriesRegistry.getLocally,userState:{}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(24),o=n(55),i=n(83),s=n(31);t.SpaceDefinitions={commands:{[s.CreateSpaceCommandName]:{serverCommandName:"CreateSpace",createPayload:o.SpaceCommandsRegistry.createPayload,executeLocally:o.SpaceCommandsRegistry.createLocally,processResults:o.SpaceCommandsRegistry.processResults,userState:{}},[s.UpdateSpaceCommandName]:{serverCommandName:"UpdateSpace",createPayload:o.SpaceCommandsRegistry.updatePayload,executeLocally:o.SpaceCommandsRegistry.updateLocally,processResults:r.processCommandResults,rewriteIds:r.updateRewriteIds,userState:{}},[s.DeleteSpaceCommandName]:{serverCommandName:"DeleteSpace",createPayload:o.SpaceCommandsRegistry.deletePayload,processResults:r.processCommandResults},[s.PurgeSpaceCommandName]:{serverCommandName:"PurgeSpace",createPayload:o.SpaceCommandsRegistry.purgePayload,processResults:r.processCommandResults},[s.RestoreSpaceCommandName]:{serverCommandName:"RestoreSpace",createPayload:o.SpaceCommandsRegistry.restorePayload,processResults:r.processCommandResults},[s.MoveSpaceBatchCommandName]:{serverCommandName:"MoveSpaceBatch",createPayload:o.SpaceCommandsRegistry.movePayload,processResults:r.processCommandResults},[s.CopySpaceCommandName]:{serverCommandName:"CopySpaceBatch",createPayload:o.SpaceCommandsRegistry.copyPayload,processResults:r.processSingleBatchResults},[s.RefreshPoliciesCommandName]:{serverCommandName:"RefreshSpacePolicies",createPayload:o.SpaceCommandsRegistry.refreshPermissionContext,executeLocally:o.SpaceCommandsRegistry.refreshPermissionContext,processResults:r.processCommandResults}},queries:{[s.GetSpaceQueryName]:{serverQueryEndpoint:"collections/{spaceCollectionId}/spaces/{id}",createPayload:e=>e,processResults:(e,t)=>o.SpaceCommandsRegistry.parseFetchPayload(t),executeLocally:i.SpaceQueriesRegistry.getLocally,userState:{}},[s.GetSpacesQueryName]:{serverQueryEndpoint:"collections/{spaceCollectionId}/spaces",createPayload:e=>e,processResults:(e,t)=>o.SpaceCommandsRegistry.parseQueryPayload(t),executeLocally:i.SpaceQueriesRegistry.queryLocally,userState:{}},[s.GetSpaceRevisionsQueryName]:{serverQueryEndpoint:"collections/{spaceCollectionId}/spaces/{id}/revisions",createPayload:e=>e,processResults:r.processQueryResults}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1030),o=n(31);t.AssetGraphDefinitions={commands:{},queries:{[o.GetClosureV2QueryName]:{serverQueryEndpoint:"collections/{spaceCollectionId}/assets:get-closure",httpMethod:"POST",createPayload:e=>e,processResults:r.AssetGraphQueriesRegistry.processResults,executeLocally:r.AssetGraphQueriesRegistry.localClosureQueryV2,userState:{}}}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(1031),i=n(36),s=n(55);t.AssetGraphQueriesRegistry=class AssetGraphQueriesRegistry{static localClosureQueryV2(e,t,n){return r(this,void 0,void 0,(function*(){i.validateUserState(n);const r={queryContext:e,userState:n},s=t.startAssets.map(e=>({asset:e.assetId,snapshot:e.snapshotContextId})),a=new o.LocalClosurev2(r,s,t.spaceCollectionId,t.relationshipFilters,t.assetFilters,t.maxDepth);yield a.traverse();return yield a.serialize(t.include)}))}static processResults(e,t,n){return r(this,void 0,void 0,(function*(){return{topology:t.topology,assets:t.assets.map(e=>s.AssetCommandsRegistry.parseFetchPayload(e)),relationships:t.relationships.map(e=>s.RelationshipCommandsRegistry.parseFetchPayload(e)),snapshots:t.snapshots.map(e=>s.SnapshotCommandsRegistry.parseFetchPayload(e))}}))}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(59)),s=n(83),a=n(6),c=n(1032),u=n(1033),l=n(2);function matchType(e,t){if(t.version){if(e!==`${t.name}-${t.version}`)return!1}else if(!e.startsWith(t.name+"-"))return!1;return!0}t.LocalClosurev2=class LocalClosurev2{constructor(e,t,n,r=[],o=[],i=0){if(!(o&&0!==o.length||r&&0!==r.length))throw new l.SDKError("At least one closure filter must be provided, of either relationship or asset type.");this.spaceCollectionId=n,this.context=e,this.startAssets=t,this.relationshipFilters=r,this.assetFilters=o,this.maxDepth=i,this.maxDepth<0&&(this.maxDepth=0),this.topologyHolder=new c.TopologyHolder}traverse(){var e;return r(this,void 0,void 0,(function*(){let t=[];for(const e of this.startAssets)if(!this.topologyHolder.getNode(e.asset,e.snapshot)){const n=this.topologyHolder.createNode(e.asset,e.snapshot);t.push(n)}let n=0;for(;t.length>0&&(0===this.maxDepth||n<this.maxDepth);){const r=t;t=[];const o=n>0;yield this.resolveFrontier(r,o);for(const n of r)if(void 0===(null===(e=n.resolution)||void 0===e?void 0:e.excluded)){const e=yield this.getRelationships(n.assetId);for(const r of e){const e=r.direction,o=this.normalizeDirection(r);if(n.snapshotContextId&&void 0===o.relationship.fromSnapshotId||n.snapshotContextId===o.relationship.fromSnapshotId){const r=o.relationship.toSnapshotId?a.extractId(o.relationship.toSnapshotId):n.snapshotContextId,i=a.extractId(o.relationship.toId);let s=this.topologyHolder.getNode(i,r);s||(s=this.topologyHolder.createNode(i,r),t.push(s)),"IN"===e?this.topologyHolder.createEdge(o.relationship.id,s,n,o.relationship):this.topologyHolder.createEdge(o.relationship.id,n,s,o.relationship)}}}n++}const r=n>0;yield this.resolveFrontier(t,r)}))}serialize(e){return this.topologyHolder.serialize(this.context,u.serializeTopology,this.spaceCollectionId,e)}resolveFrontier(e,t){return r(this,void 0,void 0,(function*(){let n;const r=[],o={};for(let t=0;t<e.length;t++){const n=e[t],r=n.snapshotContextId?n.snapshotContextId:"";o[r]?o[r].push({snapshotContextId:r,assetId:n.assetId,index:t}):o[r]=[{snapshotContextId:r,assetId:n.assetId,index:t}]}for(const[e,t]of Object.entries(o)){const o=t.map(e=>e.assetId);if(""!==e){const i=yield s.SnapshotAssetsQueriesRegistry.getAssetRevisions(this.context.queryContext,{id:e,ids:o},this.context.userState);if(!i)throw new Error("Could not get revisions for snapshot "+e);for(let e=0;e<o.length;e++)void 0===i[e]&&(n=void 0,t[e].snapshotContextId=""),n=i[e],r.push({asset:o[e],revision:""!==n?n:void 0})}else for(let e=0;e<o.length;e++)r.push({asset:o[e],revision:void 0})}const i=yield this.getAssets(r);let a=0;for(const n of Object.keys(o)){const r=o[n];for(const n of r){const r=i[a];if(!r)throw new Error("Could not get asset "+n.assetId);const o=t&&!this.keepAsset(r)?"FILTERED":void 0,s={snapshotId:""!==n.snapshotContextId?n.snapshotContextId:void 0,excluded:o,data:r};e[n.index].resolution=s,a++}}}))}getAssets(e){return r(this,void 0,void 0,(function*(){return s.AssetQueriesRegistry.queryAssetsLocally(this.context.queryContext,{collectionId:this.spaceCollectionId,assetIds:e.map(e=>({entityId:e.asset,revisionId:e.revision}))},this.context.userState)}))}keepAsset(e){return 0===this.assetFilters.length||this.assetFilters.some(t=>{var n;if(!matchType(e.typeid,t.type))return!1;const r=null===(n=e.components)||void 0===n?void 0:n.insert;if(t.componentTypes&&r){const e=Object.keys(r);if(!t.componentTypes.every(t=>e.some(e=>matchType(e,t))))return!1}return!0})}getRelationships(e){return r(this,void 0,void 0,(function*(){return(yield s.RelationshipQueriesRegistry.getAssetRelationships(this.context.queryContext,{assetId:e,filters:this.relationshipFilters,spaceCollectionId:this.spaceCollectionId},this.context.userState)).map(t=>({relationship:t,direction:t.fromId===e?"OUT":"IN"}))}))}normalizeDirection(e){if("OUT"===e.direction)return e;const t=i.default(e);return[t.relationship.fromId,t.relationship.fromSnapshotId,t.relationship.toId,t.relationship.toSnapshotId]=[t.relationship.toId,t.relationship.toSnapshotId,t.relationship.fromId,t.relationship.fromSnapshotId],t.direction="OUT",t}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});class TopologyHolder{constructor(){this.nodes=new Map,this.edges=new Map}serialize(e,t,n,o){return r(this,void 0,void 0,(function*(){return t(e.queryContext,this.nodes,this.edges,n,o,e.userState)}))}getNode(e,t){const n=TopologyHolder.getKey({asset:e,snapshot:t});return this.nodes.get(n)}createNode(e,t){const n=TopologyHolder.getKey({asset:e,snapshot:t}),r={assetId:e,snapshotContextId:t};return this.nodes.set(n,r),r}createEdge(e,t,n,r){const o={fromNode:t,toNode:n,relationshipId:e,data:r},i=TopologyHolder.getKey({asset:t.assetId,snapshot:t.snapshotContextId}),s=TopologyHolder.getKey({asset:n.assetId,snapshot:n.snapshotContextId}),a=`${i}/${o.relationshipId}/${s}`;this.edges.set(a,o)}static getKey(e){return`${e.asset}/${e.snapshot}`}}t.TopologyHolder=TopologyHolder},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(198)),s=n(223),a=n(2);class KeyedArray{constructor(){this.mapping=new Map,this.data=new Array}has(e){return this.mapping.has(e)}add(e,t){const n=this.data.length;return this.mapping.set(e,this.data.length),this.data.push(t),n}getData(){return this.data}getIndex(e){return this.mapping.get(e)}}t.serializeTopology=function serializeTopology(e,t,n,o,c,u){return r(this,void 0,void 0,(function*(){const l=new WeakMap,d=new Array,p=new Array,h=yield function pullAssetData(e,t){return r(this,void 0,void 0,(function*(){const n={assetSnapshotMapping:new Map,assets:new KeyedArray},r=t&&t.indexOf("asset_attributes")>-1,o=t&&t.indexOf("asset_components")>-1,s=t&&t.indexOf("filtered_asset_data")>-1;for(const t of e.values()){const e=t.resolution;if(void 0===e)throw new a.InternalError(`Unresolved node (asset: ${t.assetId}, snapshot: ${t.snapshotContextId})in the topology to be serialized`);const c=`${t.assetId} ${e.data.revisionId}`,u=`${t.assetId} ${void 0===e.snapshotId?"":e.snapshotId}`;let l=e.data;const d="FILTERED"===e.excluded;let p=n.assets.getIndex(c);void 0===p&&((!r||d&&!s)&&(l=i.default(l,"attributes")),(!o||d&&!s)&&(l=i.default(l,"components")),p=n.assets.add(c,l)),n.assetSnapshotMapping.set(u,p)}return n}))}(t,c),m=yield function pullSnapshotData(e,t,n,o){return r(this,void 0,void 0,(function*(){const r=new KeyedArray;for(const c of t.values()){const t=c.resolution;if(void 0===t)throw new a.InternalError(`Unresolved node (asset: ${c.assetId}, snapshot: ${c.snapshotContextId})in the topology to be serialized`);for(const a of[t.snapshotId,c.snapshotContextId])if(void 0!==a&&!r.has(a)){const t=yield s.SnapshotQueriesRegistry.getLocally(e,{id:a,spaceCollectionId:n},o);if(void 0===t)throw new Error("Unknown snapshot while serializing result");const c=i.default(t,["attributes","components"]);r.add(a,c)}}return r}))}(e,t,o,u),y=yield function pullRelationshipData(e,t){return r(this,void 0,void 0,(function*(){const n=new KeyedArray,r=t&&t.indexOf("relationship_attributes")>-1,o=t&&t.indexOf("relationship_components")>-1;for(const t of e.values())if(!n.has(t.relationshipId)){let e=t.data;r||(e=i.default(e,"attributes")),o||(e=i.default(e,"components")),n.add(t.relationshipId,e)}return n}))}(n,c);return t.forEach(e=>{const t=e.resolution;if(void 0===t)throw new a.InternalError(`Unresolved node (asset: ${e.assetId}, snapshot: ${e.snapshotContextId})in the topology to be serialized`);const n=`${e.assetId} ${void 0===t.snapshotId?"":t.snapshotId}`,r=h.assetSnapshotMapping.get(n);if(void 0===r)throw new Error("Could not find asset in resulting table");const o={assetIdx:r};if(void 0===t.snapshotId&&void 0!==e.snapshotContextId&&(o.assetInSnapshot=!1),void 0!==e.snapshotContextId){const t=m.getIndex(e.snapshotContextId);if(void 0===t)throw new Error("Could not find context snapshot in resulting table");o.snapshotContextIdx=t}void 0!==t.excluded&&(o.excluded=t.excluded),l.set(e,d.length),d.push(o)}),n.forEach(e=>{const t=y.getIndex(e.relationshipId),n=l.get(e.fromNode),r=l.get(e.toNode);if(void 0===t||void 0===n||void 0===r)throw new Error("Could not find edge data");const o={relationshipIdx:t,fromNode:n,toNode:r};p.push(o)}),{topology:{nodes:d,edges:p},relationships:y.getData(),snapshots:m.getData(),assets:h.assets.getData()}}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(24),o=n(55),i=n(378),s=n(372),a=n(83),c=n(31);t.AssetDefinitions={commands:{[c.CreateAssetCommandName]:{serverCommandName:"CreateAsset",createPayload:o.AssetCommandsRegistry.createPayload,executeLocally:o.AssetCommandsRegistry.createLocally,processResults:o.AssetCommandsRegistry.processResults,rewriteIds:o.AssetCommandsRegistry.createRewriteIds,userState:{}},[c.UpdateAssetCommandName]:{serverCommandName:"UpdateAsset",createPayload:o.AssetCommandsRegistry.updatePayload,executeLocally:o.AssetCommandsRegistry.updateLocally,processResults:o.AssetCommandsRegistry.processResults,rewriteIds:r.updateRewriteIds,userState:{}},[c.DeleteAssetCommandName]:{serverCommandName:"DeleteAsset",createPayload:o.AssetCommandsRegistry.deletePayload,processResults:r.processCommandResults},[c.PurgeAssetCommandName]:{serverCommandName:"PurgeAsset",createPayload:o.AssetCommandsRegistry.purgePayload,processResults:r.processCommandResults},[c.RestoreAssetCommandName]:{serverCommandName:"RestoreAsset",createPayload:o.AssetCommandsRegistry.restorePayload,processResults:r.processCommandResults},[c.MoveAssetBatchCommandName]:{serverCommandName:"MoveAssetBatch",createPayload:o.AssetCommandsRegistry.movePayload,processResults:r.processCommandResults,executeLocally:o.AssetCommandsRegistry.moveLocally,rewriteIds:o.AssetCommandsRegistry.moveAssetRewriteIds,userState:{}},[c.CopyAssetCommandName]:{serverCommandName:"CopyAssetBatch",createPayload:o.AssetCommandsRegistry.copyPayload,executeLocally:o.AssetCommandsRegistry.copyLocally,processResults:s.processBatchResults,rewriteIds:o.AssetCommandsRegistry.copyRewriteIds,userState:{}}},queries:{[c.GetAssetQueryName]:{serverQueryEndpoint:"collections/{spaceCollectionId}/assets/{id}",createPayload:e=>e,processResults:(e,t)=>o.AssetCommandsRegistry.parseFetchPayload(t),executeLocally:i.AssetQueriesRegistry.getLocally,userState:{}},[c.GetAssetAtRevisionQueryName]:{serverQueryEndpoint:"collections/{spaceCollectionId}/assets/{id}/revisions/{revisionId}",createPayload:e=>e,processResults:(e,t)=>o.AssetCommandsRegistry.parseFetchPayload(t),executeLocally:i.AssetQueriesRegistry.getLocally,userState:{}},[c.GetAssetsQueryName]:{serverQueryEndpoint:"collections/{spaceCollectionId}/assets",createPayload:e=>e,processResults:(e,t)=>o.AssetCommandsRegistry.parseQueryPayload(t),executeLocally:i.AssetQueriesRegistry.queryLocally,userState:{}},[c.GetAssetRevisionsQueryName]:{serverQueryEndpoint:"collections/{spaceCollectionId}/assets/{id}/revisions",createPayload:e=>e,processResults:r.processQueryResults,executeLocally:a.RevisionQueriesRegistry.queryLocally,userState:{}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(24),o=n(385),i=n(31);t.BinaryAssetDefinitions={commands:{[i.UploadBinaryAssetCommandName]:{serverCommandName:"UploadBinaryAsset",createPayload:o.BinaryAssetCommandsRegistry.uploadBinaryPayload,processResults:r.processCommandResults},[i.CompleteUploadCommandName]:{serverCommandName:"CompleteUpload",createPayload:o.BinaryAssetCommandsRegistry.completeUploadPayload,processResults:r.processCommandResults}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(24),o=n(373),i=n(377),s=n(55),a=n(102),c=n(31);t.RelationshipDefinitions={commands:{[c.CreateRelationshipCommandName]:{serverCommandName:"CreateRelationship",createPayload:o.RelationshipCommandsRegistry.createPayload,executeLocally:o.RelationshipCommandsRegistry.createLocally,processResults:o.RelationshipCommandsRegistry.processResults,rewriteIds:o.RelationshipCommandsRegistry.createRewriteIds,userState:{}},[c.UpdateRelationshipCommandName]:{serverCommandName:"UpdateRelationship",createPayload:o.RelationshipCommandsRegistry.updatePayload,executeLocally:o.RelationshipCommandsRegistry.updateLocally,processResults:r.processCommandResults,rewriteIds:r.updateRewriteIds,userState:{}},[c.DeleteRelationshipCommandName]:{serverCommandName:"DeleteRelationship",createPayload:o.RelationshipCommandsRegistry.deletePayload,executeLocally:s.EntityCommandsRegistry.deleteLocally,processResults:r.processCommandResults,rewriteIds:r.updateRewriteIds,userState:{}},[c.PurgeRelationshipCommandName]:{serverCommandName:"PurgeRelationship",createPayload:o.RelationshipCommandsRegistry.purgePayload,processResults:r.processCommandResults},[c.RestoreRelationshipCommandName]:{serverCommandName:"RestoreRelationship",createPayload:o.RelationshipCommandsRegistry.restorePayload,processResults:r.processCommandResults}},queries:{[c.GetRelationshipQueryName]:{serverQueryEndpoint:"collections/{spaceCollectionId}/relationships/{id}",createPayload:e=>e,processResults:(e,t)=>o.RelationshipCommandsRegistry.parseFetchPayload(t),executeLocally:i.RelationshipQueriesRegistry.getLocally,userState:{}},[c.GetRelationshipsQueryName]:{serverQueryEndpoint:"collections/{spaceCollectionId}/relationships",createPayload:e=>{const t=Object.assign({},e);return t.filter=new a.FiltersBuilder(e.filter).appendCondition("type",e.type).appendCondition("fromAsset",e.fromAsset).appendCondition("toAsset",e.toAsset).build(),t},processResults:(e,t)=>o.RelationshipCommandsRegistry.parseQueryPayload(t),executeLocally:i.RelationshipQueriesRegistry.queryRelationships,userState:{}},[c.GetRelationshipRevisionsQueryName]:{serverQueryEndpoint:"collections/{spaceCollectionId}/relationships/{id}/revisions",createPayload:e=>e,processResults:r.processQueryResults}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(24),o=n(55),i=n(83),s=n(31);t.SnapshotDefinitions={commands:{[s.CreateSnapshotCommandName]:{serverCommandName:"CreateSnapshot",createPayload:o.SnapshotCommandsRegistry.createPayload,executeLocally:o.SnapshotCommandsRegistry.createLocally,processResults:o.SnapshotCommandsRegistry.processResults,rewriteIds:o.SnapshotCommandsRegistry.createRewriteIds,userState:{}},[s.UpdateSnapshotCommandName]:{serverCommandName:"UpdateSnapshot",createPayload:o.SnapshotCommandsRegistry.updatePayload,executeLocally:o.SnapshotCommandsRegistry.updateLocally,processResults:r.processCommandResults,rewriteIds:r.updateRewriteIds,userState:{}},[s.AddAssetsToSnapshotCommandName]:{serverCommandName:"AddAssetsToSnapshot",createPayload:o.SnapshotCommandsRegistry.addAssetsPayload,executeLocally:o.SnapshotCommandsRegistry.addAssetsLocally,processResults:r.processCommandResults,rewriteIds:o.SnapshotCommandsRegistry.updateAssetsRewriteIds,userState:{}},[s.RemoveAssetsFromSnapshotCommandName]:{serverCommandName:"RemoveAssetsFromSnapshot",createPayload:o.SnapshotCommandsRegistry.removeAssetsPayload,executeLocally:o.SnapshotCommandsRegistry.removeAssetsLocally,processResults:r.processCommandResults,rewriteIds:o.SnapshotCommandsRegistry.updateAssetsRewriteIds,userState:{}},[s.DeleteSnapshotCommandName]:{serverCommandName:"DeleteSnapshot",createPayload:o.SnapshotCommandsRegistry.deletePayload,executeLocally:o.SnapshotCommandsRegistry.deleteLocally,processResults:r.processCommandResults,rewriteIds:r.updateRewriteIds,userState:{}},[s.PurgeSnapshotCommandName]:{serverCommandName:"PurgeSnapshot",createPayload:o.SnapshotCommandsRegistry.purgePayload,processResults:r.processCommandResults},[s.RestoreSnapshotCommandName]:{serverCommandName:"RestoreSnapshot",createPayload:o.SnapshotCommandsRegistry.restorePayload,processResults:r.processCommandResults}},queries:{[s.GetSnapshotQueryName]:{serverQueryEndpoint:"collections/{spaceCollectionId}/snapshots/{id}",createPayload:e=>e,processResults:(e,t)=>o.SnapshotCommandsRegistry.parseFetchPayload(t),executeLocally:i.SnapshotQueriesRegistry.getLocally,userState:{}},[s.GetSnapshotsQueryName]:{serverQueryEndpoint:"collections/{spaceCollectionId}/snapshots",createPayload:e=>e,processResults:(e,t)=>o.SnapshotCommandsRegistry.parseQueryPayload(t),executeLocally:i.SnapshotQueriesRegistry.queryLocally,userState:{}},[s.GetAssetsInSnapshotQueryName]:{serverQueryEndpoint:"collections/{spaceCollectionId}/snapshots/{id}/assets",createPayload:e=>e,executeLocally:i.SnapshotAssetsQueriesRegistry.queryLocally,processResults:r.processQueryResults,userState:{}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(230);t.Registrator=class Registrator{static registerCommands(e){e.registerCommandsAndQueries(r.CollectionDefinitions),e.registerCommandsAndQueries(r.SpaceDefinitions),e.registerCommandsAndQueries(r.AssetDefinitions),e.registerCommandsAndQueries(r.RelationshipDefinitions),e.registerCommandsAndQueries(r.SnapshotDefinitions),e.registerCommandsAndQueries(r.BinaryAssetDefinitions),e.registerCommandsAndQueries(r.AssetGraphDefinitions)}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(67),i=n(229),s=n(26),a=n(14);class AssetsQueryResult extends o.QueryResult{queryPage(){return r(this,void 0,void 0,(function*(){return this.sdkCore.getDataConnector().journalQuery(s.GetAssetsQueryName,this.queryParameters)}))}createPage(e,t=-1,n=0){const r=[],{results:o}=e;for(const e of o){const{id:t,typeid:n}=e,o=this.sdkCore.buildModel(a.assetTypeId,n,t,this.collectionId,{initialData:e,fetched:!0});r.push(o)}return new i.AssetQueryPage(e,r,s.GetAssetsQueryName,t,n)}}t.AssetsQueryResult=AssetsQueryResult},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(14);t.ClosureV2QueryResults=class ClosureV2QueryResults{constructor(e,t,n){this.relationships=[],this.assets=[],this.snapshots=[];const o=(null==n?void 0:n.assetAttributes)&&(null==n?void 0:n.assetComponents),i=(null==n?void 0:n.relationshipAttributes)&&(null==n?void 0:n.relationshipComponents),s=[],{assets:a,relationships:c,snapshots:u,topology:l}=t;!(null==n?void 0:n.filteredAssetData)&&o&&l.nodes.forEach(e=>{void 0!==e.excluded&&(s[e.assetIdx]=e.excluded)});for(const t of a){const{id:i,typeid:a,spaceCollectionId:c}=t,u=this.assets.length,l=e.buildModel(r.assetTypeId,a,i,c,{initialData:t,fetched:o&&((null==n?void 0:n.filteredAssetData)||void 0===s[u])});this.assets.push(l)}for(const t of c){const{id:n,typeid:o,spaceCollectionId:s}=t,a=e.buildModel(r.relationshipTypeId,o,n,s,{initialData:t,fetched:i});this.relationships.push(a)}for(const t of u){const{id:n,typeid:o,spaceCollectionId:i}=t,s=e.buildModel(r.snapshotTypeId,o,n,i,{initialData:t,fetched:!1});this.snapshots.push(s)}this.results=t}getTopology(){return this.results.topology}getAssets(){return this.assets}getRelationships(){return this.relationships}getSnapshots(){return this.snapshots}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(166),i=n(26);class RelationshipRevisionsQueryResult extends o.RevisionsQueryResult{queryPage(){return r(this,void 0,void 0,(function*(){return this.sdkCore.getDataConnector().journalQuery(i.GetRelationshipRevisionsQueryName,this.queryParameters)}))}}t.RelationshipRevisionsQueryResult=RelationshipRevisionsQueryResult},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(67),i=n(388),s=n(14),a=n(26);class RelationshipsQueryResult extends o.QueryResult{queryPage(){return r(this,void 0,void 0,(function*(){return this.sdkCore.getDataConnector().journalQuery(a.GetRelationshipsQueryName,this.queryParameters)}))}createPage(e,t=-1,n=0){const r=[],o=e.results;for(const e of o){const{id:t,typeid:n}=e,o=this.sdkCore.buildModel(s.relationshipTypeId,n,t,this.collectionId,{initialData:e,fetched:!0});r.push(o)}return new i.RelationshipQueryPage(e,r,a.GetRelationshipsQueryName,t,n)}}t.RelationshipsQueryResult=RelationshipsQueryResult},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(390),i=n(67),s=n(14),a=n(26);class SnapshotQueryResult extends i.QueryResult{queryPage(){return r(this,void 0,void 0,(function*(){return this.sdkCore.getDataConnector().journalQuery(a.GetSnapshotsQueryName,this.queryParameters)}))}createPage(e,t=-1,n=0){const r=[];for(const t of e.results){const{id:e,typeid:n}=t,o=this.sdkCore.buildModel(s.snapshotTypeId,n,e,this.collectionId,{initialData:t,fetched:!0});r.push(o)}return new o.SnapshotQueryPage(e,r,a.GetSnapshotsQueryName,t,n)}}t.SnapshotQueryResult=SnapshotQueryResult},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(391),i=n(67),s=n(14),a=n(26);class SpaceQueryResult extends i.QueryResult{queryPage(){return r(this,void 0,void 0,(function*(){return this.sdkCore.getDataConnector().journalQuery(a.GetSpacesQueryName,this.queryParameters)}))}createPage(e,t=-1,n=0){const r=[],i=e.results;for(const e of i){const t=this.sdkCore.buildModel(s.spaceTypeId,e.typeid,e.id,this.collectionId,{initialData:e,fetched:!0});r.push(t)}return new o.SpaceQueryPage(e,r,a.GetSpacesQueryName,t,n)}}t.SpaceQueryResult=SpaceQueryResult},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(166),i=n(26);class SpaceRevisionsQueryResult extends o.RevisionsQueryResult{queryPage(){return r(this,void 0,void 0,(function*(){return this.sdkCore.getDataConnector().journalQuery(i.GetSpaceRevisionsQueryName,this.queryParameters)}))}}t.SpaceRevisionsQueryResult=SpaceRevisionsQueryResult},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(227)),i=n(14);t.buildParameterDependencies=(e,t)=>{const n=[];return o.default.forEach(e,(function visitor(e){if(e instanceof i.Entity){const r=t.resolveResourceId(e);r.command&&n.push(r.command.getCommandId()),this.update(r.path)}})),{parameters:e,dependencies:n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(393);class UpdateEntityBlueprint extends r.EntityBlueprint{getRevisionIdentifier(e){return`$.${this.getCommandId()}.result.revisionId`}}t.UpdateEntityBlueprint=UpdateEntityBlueprint},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(1049),i=n(228),s=n(2),a=n(66),c=n(6),u=n(86),l=n(26);class AssetGraph extends i.Space{createRelationship(e,t,n=a.relationshipTypeId){return this.sdkCore.buildModel(a.relationshipTypeId,n,"",this.spaceCollectionId,{initialData:{fromId:e,toId:t},fetched:!1})}createPinnedRelationship(e,t,n){const r={fromId:e,toId:t,spaceCollectionId:this.spaceCollectionId};return n.toSnapshotId&&(r.toSnapshotId=c.extractId(n.toSnapshotId)),n.fromSnapshotId&&(r.fromSnapshotId=c.extractId(n.fromSnapshotId)),this.sdkCore.buildModel(a.relationshipTypeId,n.typeId||a.relationshipTypeId,"",this.spaceCollectionId,{initialData:r,fetched:!1})}getClosureV2(e){return r(this,void 0,void 0,(function*(){return AssetGraph.getClosureV2Internal(this.sdkCore,this.spaceCollectionId,e)}))}static getClosureV2(e,t,n){return r(this,void 0,void 0,(function*(){return AssetGraph.getClosureV2Internal(c.befriend(e).core,t,n)}))}static getClosureV2Internal(e,t,n){var o,i,a,d,p;return r(this,void 0,void 0,(function*(){if(n.startAssets.length>c.ClosureV2Traverser.START_ASSETS_COUNT_LIMIT)throw new s.SDKError(`Exceeded closure starting assets limit ClosureV2Traverser.START_ASSETS_COUNT_LIMIT (${c.ClosureV2Traverser.START_ASSETS_COUNT_LIMIT})`);if(!(n.assetFilters&&0!==n.assetFilters.length||n.relationshipFilters&&0!==n.relationshipFilters.length))throw new s.SDKError("At least one closure filter must be provided, of either relationship or asset type.");const r=e.getDataConnector(),h=[];(null===(o=n.include)||void 0===o?void 0:o.assetAttributes)&&h.push("asset_attributes"),(null===(i=n.include)||void 0===i?void 0:i.assetComponents)&&h.push("asset_components"),(null===(a=n.include)||void 0===a?void 0:a.relationshipAttributes)&&h.push("relationship_attributes"),(null===(d=n.include)||void 0===d?void 0:d.relationshipComponents)&&h.push("relationship_components"),(null===(p=n.include)||void 0===p?void 0:p.filteredAssetData)&&h.push("filtered_asset_data");const m={spaceCollectionId:c.extractId(t),startAssets:n.startAssets.map(e=>({assetId:c.extractId(e.asset),snapshotContextId:e.snapshotContext?c.extractId(e.snapshotContext):void 0})),assetFilters:n.assetFilters,relationshipFilters:n.relationshipFilters,include:h,maxDepth:n.maxDepth},y=yield r.journalQuery(l.GetClosureV2QueryName,m);return new u.ClosureV2QueryResults(e,y,n.include)}))}getClosureV2Traverser(e){return new c.ClosureV2Traverser(this,e)}static syncByClosure(e,t,n,i){return r(this,void 0,void 0,(function*(){const r=yield AssetGraph.getClosureV2(e,t,n);return(yield e.getJournals().getRemote(t)).sync(Object.assign(Object.assign({},i),{selector:o.toSyncSelector(r)}))}))}static rebaseByClosure(e,t,n,i){return r(this,void 0,void 0,(function*(){const r=yield AssetGraph.getClosureV2(e,t,n);return(yield e.getJournals().getMain(t)).rebase(Object.assign(Object.assign({},i),{selector:o.toSyncSelector(r)}))}))}static publishByClosure(e,t,n,i){return r(this,void 0,void 0,(function*(){const r=yield AssetGraph.getClosureV2(e,t,n);return(yield e.getJournals().getMain(t)).publish(Object.assign(Object.assign({},i),{selector:o.toSyncSelector(r)}))}))}}t.AssetGraph=AssetGraph},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2),o=n(80),i=n(146);function uniqueSpaces(e){const t=new Set;return e.getAssets().forEach(e=>{if(!e.spaceId)throw new r.InternalError("Cannot create SyncSelector from this closure result since there are missing space ids.");t.add(i.extractId(e.spaceId))}),Array.from(t)}t.toSyncSelector=function toSyncSelector(e){return{type:o.SyncSelectorType.SPACES,parameters:{spaces:uniqueSpaces(e)}}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(340)),s=o(n(1051)),a=n(14),c=n(6),u=n(30),l=n(2);class BinaryAsset extends a.Asset{uploadBinary(e){return r(this,void 0,void 0,(function*(){return c.withSpan(this.sdkCore.getTracingOptions(),"uploadBinary","OSS",()=>r(this,void 0,void 0,(function*(){if(void 0===this.id)throw new l.SDKError("Cannot upload file on an unsaved Binary Asset");const{chunkSize:t,maximumConcurrentTransaction:n,retryOptions:{retry:o,minimumTimeout:a,maximumTimeout:d}}=this.sdkCore.getSettings().binaryOptions,p=e.getSize(),h=c.FileHelper.getChunksQuantity(p,t),m=h>1,{signedUploadUrl:y}=yield this.sdkCore.getDataConnector().getUploadBinarySignedURL({spaceCollectionId:c.extractId(this.spaceCollectionId),resourceId:c.extractId(this.id),resumable:m}),g=[],_=s.default(n);for(let n=0;n<h;n++){const s=yield e.getChunk(t,n),u=s.length,l=c.FileHelper.getChunkRange(n,t,u,p),h=Math.random().toString(36).slice(2),m=_(()=>r(this,void 0,void 0,(function*(){return i.default(()=>r(this,void 0,void 0,(function*(){return this.sdkCore.getDataConnector().uploadBinaryData({signedUrl:y,size:u,data:s,contentRange:l,sessionId:h})})),{retries:o,minTimeout:a,maxTimeout:d})})));g.push(m)}let v,E=u.BinaryUploadStatus.success;try{yield Promise.all(g)}catch(e){v=e,E=u.BinaryUploadStatus.fail}return yield this.sdkCore.getDataConnector().uploadBinaryComplete({spaceCollectionId:c.extractId(this.spaceCollectionId),resourceId:c.extractId(this.id),status:E}),v?Promise.reject(v):Promise.resolve()})))}))}download(e){return r(this,void 0,void 0,(function*(){return this.sdkCore.getDataConnector().downloadBinary({assetId:c.extractId(this),spaceCollectionId:c.extractId(this.spaceCollectionId),revisionId:this.revisionId||void 0,source:e})}))}}t.BinaryAsset=BinaryAsset},function(e,t,n){"use strict";const r=n(1052);e.exports=e=>{if(!Number.isInteger(e)&&e!==1/0||!(e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const t=new r;let n=0;const run=async(e,r,...o)=>{n++;const i=(async()=>e(...o))();r(i);try{await i}catch{}n--,t.size>0&&t.dequeue()()},generator=(r,...o)=>new Promise(i=>{((r,o,...i)=>{t.enqueue(run.bind(null,r,o,...i)),(async()=>{await Promise.resolve(),n<e&&t.size>0&&t.dequeue()()})()})(r,i,...o)});return Object.defineProperties(generator,{activeCount:{get:()=>n},pendingCount:{get:()=>t.size},clearQueue:{value:()=>{t.clear()}}}),generator}},function(e,t){class Node{constructor(e){this.value=e,this.next=void 0}}class Queue{constructor(){this.clear()}enqueue(e){const t=new Node(e);this._head?(this._tail.next=t,this._tail=t):(this._head=t,this._tail=t),this._size++}dequeue(){const e=this._head;if(e)return this._head=this._head.next,this._size--,e.value}clear(){this._head=void 0,this._tail=void 0,this._size=0}get size(){return this._size}*[Symbol.iterator](){let e=this._head;for(;e;)yield e.value,e=e.next}}e.exports=Queue},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Revision=class Revision{constructor(e,t){this.id=e.resourceId,this.revisionId=e.revisionId,this.changeTime=e.changeTime,this.snapshotted=e.snapshotted,this.snapshots=t,this.attributeChangeSet=e.attributeChangeSet,this.componentChangeSet=e.metaChangeSet,this.createdBy=e.createdBy?{userId:e.createdBy.userId,date:new Date(e.createdBy.date),serviceId:e.createdBy.serviceId}:void 0}getId(){return this.id}getRevisionId(){return this.revisionId}getChangeTime(){return this.changeTime}isSnapshotted(){return this.snapshotted}getAttributeChangeSet(){return this.attributeChangeSet}getComponentChangeSet(){return this.componentChangeSet}getSnapshots(){return this.snapshots}getCreatedBy(){return this.createdBy}getLastModifiedBy(){return this.lastModifiedBy}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(133)),s=n(144),a=n(387),c=n(394),u=n(66),l=n(6),d=n(86),p=n(2),h=n(26),m=n(111),y=n(1059);class Relationship extends s.Entity{get fromId(){return this._from}get toId(){return this._to}get fromSnapshotId(){return this._fromSnapshot}get toSnapshotId(){return this._toSnapshot}getCreateCommands(){const e=l.CommandParametersAdapter.toCreateRelationship(this.serialize());return this.attachAdditionalDataToParameters(e),[new y.CreateRelationshipBlueprint(this,e)]}getUpdateCommands(){const e=l.CommandParametersAdapter.toUpdateRelationship(this.serialize());return this.attachAdditionalDataToParameters(e),[new m.UpdateEntityBlueprint(this,h.UpdateRelationshipCommandName,e)]}serialize(){const e=super.serialize();return e.toId=this.toId,e.fromId=this.fromId,e.fromSnapshotId=this._fromSnapshot,e.toSnapshotId=this._toSnapshot,e}initWithData(e,t){this._from=e.fromId,this._fromSnapshot=e.fromSnapshotId,this._to=e.toId,this._toSnapshot=e.toSnapshotId,super.initWithData(e,t)}getFrom(e){return r(this,void 0,void 0,(function*(){return this.getAsset(this.fromId,this.fromSnapshotId,e)}))}getTo(e){return r(this,void 0,void 0,(function*(){return this.getAsset(this.toId,this.toSnapshotId,e)}))}getToSnapshot(e){return r(this,void 0,void 0,(function*(){return Relationship.getSnapshot(this.sdkCore,this.toSnapshotId,this.spaceCollectionId,e)}))}getFromSnapshot(e){return r(this,void 0,void 0,(function*(){return Relationship.getSnapshot(this.sdkCore,this.fromSnapshotId,this.spaceCollectionId,e)}))}getRevisions(e={}){const t=(new l.QueryRequestParamsBuilder).filter(e.filter).sort(e.sort).limit(e.limit).param("spaceCollectionId",l.extractId(this.spaceCollectionId)).param("id",this.id).build();return new d.RelationshipRevisionsQueryResult(this.sdkCore,t)}getDeleteCommand(){const e={spaceCollectionId:l.extractId(this.spaceCollectionId),resourceId:this.getId()};return{commandName:h.DeleteRelationshipCommandName,parameters:e,dependsOn:void 0}}getPurgeCommand(){const e={spaceCollectionId:l.extractId(this.spaceCollectionId),resourceId:this.getId()};return{commandName:h.PurgeRelationshipCommandName,parameters:e,dependsOn:void 0}}restoreInternal(){const e={spaceCollectionId:l.extractId(this.spaceCollectionId),resourceId:this.getId()};return{commandName:h.RestoreRelationshipCommandName,parameters:e,dependsOn:void 0}}clearData(){super.clearData(),this._from=void 0,this._to=void 0,this._toSnapshot=void 0,this._fromSnapshot=void 0}fetchPayload(e){return r(this,void 0,void 0,(function*(){return Relationship.fetchPayload(this.sdkCore,{spaceCollectionId:l.extractId(this.spaceCollectionId),id:this.id,revisionId:e||!this.revisionId?void 0:this.revisionId})}))}static fetchPayload(e,t){return r(this,void 0,void 0,(function*(){return e.getDataConnector().journalQuery(h.GetRelationshipQueryName,t)}))}getAsset(e,t,n){return r(this,void 0,void 0,(function*(){if(!e)return;const r=i.default(n||{},{fetch:!0,assumeTypeId:u.assetTypeId});if(!t)return this.sdkCore.get(e,this.spaceCollectionId,a.Asset.fetchPayload,r);const o=yield Relationship.getSnapshot(this.sdkCore,t,this.spaceCollectionId,{fetch:!1,assumeTypeId:u.snapshotTypeId});if(!o)throw new p.SDKError("Could not fetch Snapshot with id "+t);const s=yield o.getAsset(e);if(!s)throw new p.SDKError(`Asset with id ${e} was not found in snapshot ${t}`);return r.fetch&&(yield s.fetch()),s}))}static getSnapshot(e,t,n,o){return r(this,void 0,void 0,(function*(){const r=i.default(o||{},{fetch:!0,assumeTypeId:u.snapshotTypeId});return e.get(t,n,c.Snapshot.fetchPayload,r)}))}}t.Relationship=Relationship},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(31),o=n(231),i=n(395);class CreateSnapshotBlueprint extends o.CreateEntityBlueprint{constructor(e,t,n){super(e,r.CreateSnapshotCommandName,t),this.addAssets=n}serialize(e){var t;const n=super.serialize(e);if(null===(t=this.addAssets)||void 0===t?void 0:t.size){const t=i.makeAddAssetsChangeSet(this.entity,this.addAssets,e);n.parameters.assets=t.changeSet,t.dependencies.length&&(n.dependsOn=n.dependsOn||[],n.dependsOn.push(...t.dependencies))}return n}getRedefinedEntities(){if(this.addAssets){const e={entity:this.entity,context:[]};for(const[t]of this.addAssets)e.context.push(t);return[e]}return[]}}t.CreateSnapshotBlueprint=CreateSnapshotBlueprint},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(232),o=n(31),i=n(395);class AddAssetsToSnapshotBlueprint extends r.CommandBlueprint{constructor(e,t,n){super(),this.snapshot=e,this.addedAssets=t,this.additionalData=n}getAffectedEntities(){return[this.snapshot]}serialize(e){const{dependencies:t,changeSet:n}=i.makeAddAssetsChangeSet(this.snapshot,this.addedAssets,e),r=e.resolveResourceId(this.snapshot),s=Object.assign(Object.assign({},this.additionalData),{resourceId:r.path,spaceCollectionId:this.snapshot.getSpaceCollectionID(),assets:n});for(const[n]of this.addedAssets){const r=e.getRedefiningCommands(this.snapshot,n,this.getCommandId());t.push(...r)}return r.command&&t.push(r.command.getCommandId()),{commandName:o.AddAssetsToSnapshotCommandName,parameters:s,dependsOn:0===t.length?void 0:t}}getRedefinedEntities(){const e={entity:this.snapshot,context:[]};for(const[t]of this.addedAssets)e.context.push(t);return[e]}}t.AddAssetsToSnapshotBlueprint=AddAssetsToSnapshotBlueprint},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(232),o=n(31),i=n(1058);class RemoveAssetsFromSnapshotBlueprint extends r.CommandBlueprint{constructor(e,t,n){super(),this.snapshot=e,this.removedAssets=t,this.additionalData=n}getAffectedEntities(){return[this.snapshot]}serialize(e){const{dependencies:t,changeSet:n}=i.makeRemoveAssetsChangeset(this.removedAssets,e),r=e.resolveResourceId(this.snapshot);r.command&&t.push(r.command.getCommandId());const s=Object.assign(Object.assign({},this.additionalData),{resourceId:r.path,spaceCollectionId:this.snapshot.getSpaceCollectionID(),assets:n});return{commandName:o.RemoveAssetsFromSnapshotCommandName,parameters:s,dependsOn:0===t.length?void 0:t}}getRedefinedEntities(){const e={entity:this.snapshot,context:[]};for(const t of this.removedAssets)e.context.push(t);return[e]}}t.RemoveAssetsFromSnapshotBlueprint=RemoveAssetsFromSnapshotBlueprint},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeRemoveAssetsChangeset=(e,t)=>{const n=[],r=[];for(const o of e){const e=t.resolveResourceId(o);e.command&&n.push(e.command.getCommandId()),r.push(e.path)}return{changeSet:{remove:r},dependencies:n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(31),o=n(231);class CreateRelationshipBlueprint extends o.CreateEntityBlueprint{constructor(e,t){super(e,r.CreateRelationshipCommandName,t),this.relationship=e}serialize(e){const t=super.serialize(e);if(this.relationship.fromSnapshotId&&this.relationship.fromId){const n=e.getRedefiningCommands(this.relationship.fromSnapshotId,this.relationship.fromId);n.length&&(t.dependsOn=t.dependsOn||[],t.dependsOn.push(...n))}if(this.relationship.toSnapshotId&&this.relationship.toId){const n=e.getRedefiningCommands(this.relationship.toSnapshotId,this.relationship.toId);n.length&&(t.dependsOn=t.dependsOn||[],t.dependsOn.push(...n))}return t}}t.CreateRelationshipBlueprint=CreateRelationshipBlueprint},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),i=n(6),s=n(66),a=n(143),c=n(86),u=n(26),l=n(111);class SpaceCollection extends a.AccessControlEntity{getCreateCommands(){const e=i.CommandParametersAdapter.toCreateCollection(this.serialize());return[new l.CreateEntityBlueprint(this,u.CreateCollectionCommandName,e)]}getUpdateCommands(){const e=i.CommandParametersAdapter.toUpdateEntity(this.serialize());return[new l.UpdateEntityBlueprint(this,u.UpdateCollectionCommandName,e)]}save(){const e=Object.create(null,{save:{get:()=>super.save}});return r(this,void 0,void 0,(function*(){if(this.newResource){const e=i.CommandParametersAdapter.toCreateCollection(this.serialize()),t={commandName:u.CreateCollectionCommandName,parameters:e,dependsOn:void 0},n=yield this.sdkCore.getDataConnector().createCollection(t);return this.upgrade(n,!0),this.spaceCollectionId=this,n}return e.save.call(this)}))}serialize(){const e=super.serialize();return e.spaceCollectionId=this.id,e}createSpace(e=s.spaceTypeId,t){return this.sdkCore.buildModel(s.spaceTypeId,e,"",this,t)}createSnapshot(e=s.snapshotTypeId){return this.sdkCore.buildModel(s.snapshotTypeId,e,"",this)}getAssets(e={}){const t=(new i.QueryRequestParamsBuilder).filter(e.filter).sort(e.sort).limit(e.limit).param("spaceCollectionId",this.id).build();return new c.AssetsQueryResult(this.sdkCore,t)}getSpaces(e={}){const t=(new i.QueryRequestParamsBuilder).filter(e.filter).sort(e.sort).limit(e.limit).param("spaceCollectionId",this.id).build();return new c.SpaceQueryResult(this.sdkCore,t)}getSnapshots(e={}){if(e.assetId&&e.assetIds)throw new o.SDKError("The assetId and assetIds parameters cannot both be used in the same request.");const t=(new i.QueryRequestParamsBuilder).filter(new i.FiltersBuilder(e.filter).appendCondition("asset.id",e.assetId?i.extractId(e.assetId):void 0).appendCondition("asset.id",e.assetIds?e.assetIds.map(e=>i.extractId(e)):void 0,"$in").appendCondition("asset.revision.id",e.revisionIds?e.revisionIds:void 0,"$in")).sort(e.sort).limit(e.limit).param("spaceCollectionId",this.id).param("include",e.include?e.include.join(","):void 0).build();return new c.SnapshotQueryResult(this.sdkCore,t)}getDeleteCommand(){const e={spaceCollectionId:i.extractId(this.spaceCollectionId),resourceId:this.getId()};return{commandName:u.DeleteCollectionCommandName,parameters:e,dependsOn:void 0}}getPurgeCommand(){const e={spaceCollectionId:i.extractId(this.spaceCollectionId),resourceId:this.getId()};return{commandName:u.PurgeCollectionCommandName,parameters:e,dependsOn:void 0}}restoreInternal(){const e={spaceCollectionId:i.extractId(this.spaceCollectionId),resourceId:this.getId()};return{commandName:u.RestoreCollectionCommandName,parameters:e,dependsOn:void 0}}fetchPayload(e){return r(this,void 0,void 0,(function*(){return SpaceCollection.fetchPayload(this.sdkCore,{spaceCollectionId:this.id,id:this.id,revisionId:e||!this.revisionId?void 0:this.revisionId})}))}static fetchPayload(e,t){return r(this,void 0,void 0,(function*(){return e.getDataConnector().journalQuery(u.GetCollectionQueryName,t)}))}getRelationships(e={}){return SpaceCollection.queryRelationships(this.id,this.sdkCore,e)}static queryRelationships(e,t,n){const r=(new i.QueryRequestParamsBuilder).filter(n.filter).sort(n.sort).limit(n.limit).param("type",n.type?n.type:void 0).param("fromAsset",n.fromAsset?i.extractId(n.fromAsset):void 0).param("toAsset",n.toAsset?i.extractId(n.toAsset):void 0).param("spaceCollectionId",i.extractId(e)).build();return new c.RelationshipsQueryResult(t,r)}refreshPermissionContexts(e){return r(this,void 0,void 0,(function*(){const t=i.extractId(this.spaceCollectionId),n=e.map(e=>{const n={spaceCollectionId:t,resourceId:i.extractId(e)};return{commandName:u.RefreshPoliciesCommandName,parameters:n,dependsOn:void 0}});return this.sdkCore.getDataConnector().handleSingleEntityCommands(n,t)}))}copyAssets(e,t){return r(this,void 0,void 0,(function*(){const n=i.extractId(this.spaceCollectionId),r=i.extractId(t),a=e.map(e=>i.extractId(e)),c={spaceCollectionId:n,resourceId:n,toSpaceId:r,entitiesToCopy:a},l={commandName:u.CopyAssetCommandName,parameters:c,dependsOn:void 0},d=yield this.sdkCore.getDataConnector().handleSingleEntityCommands([l],c.spaceCollectionId);if(!d)throw new o.InternalError("Copy was called within a subbatch. This should not happen.");i.throwServerErrorIfNecessary(d);const p=d.successes[0];return p.resourceIds.map(e=>this.sdkCore.buildModel(s.assetTypeId,s.assetTypeId,e,n,{initialData:{spaceCollectionId:n},fetched:!1,revisionId:p.revisionId}))}))}}t.SpaceCollection=SpaceCollection},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(59)),i=r(n(13)),s=n(6),a=n(219);t.combineChanges=function combineChanges(e,t){if(0===t.length)return e||{};const n=t[t.length-1],r=o.default(e||{});if(n.metadata&&!i.default(n.metadata)&&(r.metadata=n.metadata),n.components){const e=t.map(e=>e.components);r.components&&e.unshift(r.components),r.components=a.ChangesetMerger.mergeAndNormalizeChangesetList(e)}if(n.attributes){let{attributes:e}=n;Array.isArray(e)&&(e=s.AttributeConverter.convertAttributesToSerializedChangeset(n.attributes)),r.attributes=e}if(n.assets&&!i.default(n.assets))if(s.isChangeSet(n.assets)){const e=t.map(e=>function alignAsset(e){return i.default(e)?{}:s.isChangeSet(e)?e:s.AssetsConverter.convertAssetsToChangeSet(e).serializedChangeSet}(e.assets));r.assets&&e.unshift(r.assets),r.assets=a.ChangesetMerger.mergeAndNormalizeChangesetList(e)}else r.assets=s.AssetsConverter.convertAssetsToChangeSet(n.assets).serializedChangeSet;return n.createdBy&&(r.createdBy=n.createdBy),n.lastModifiedBy&&(r.lastModifiedBy=n.lastModifiedBy),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(397),o=n(401),i=n(2),s=n(26),a=n(1065);class JournalsFactory{static create(e,t={}){return JournalsFactory.internalCreate(e,t,!0)}static createFrom(e,t={}){return JournalsFactory.internalCreate(e.getImplementation(),t,!1)}static internalCreate(e,t={},n){switch(e.getType()){case"JournalingSDK":return n&&s.Registrator.registerCommands(e),new r.L7Journals(e,t);case"NoJournalingSDK":return n&&s.Registrator.registerCommands(e),new o.L7LiteJournals(e);case"JournalingServiceClient":return new a.L7ServiceJournals(e,t);default:throw new i.SDKError("Unsupported journal implementation: "+e.getType())}}}t.JournalsFactory=JournalsFactory},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(400)),s=n(101),a=n(398),c=n(2),u=n(0),l=n(6),d=n(80);class L7Journals{constructor(e,t={}){this.journalSDK=e,this.journalMappings=t.journalMappings||{}}getImplementation(){return this.journalSDK}list(e,t){return r(this,void 0,void 0,(function*(){const n=l.extractId(e);let r=yield this.journalSDK.getJournals(n);if(!r){const e=Object.assign(Object.assign({},d.noopSelector),{priority:u.SyncPriority.HIGHEST});r=yield this.journalSDK.fetch(n,e)}const o=[];return r.isolationJournals.forEach(e=>{const{properties:n}=e;let r=!t||t&&Object.keys(t).length>0;t&&Object.keys(t).forEach(e=>{n[e]&&i.default(n[e],t[e])||(r=!1)}),r&&o.push(e)}),{remoteJournal:r.remoteJournal,mainJournal:r.mainJournal,isolationJournals:o}}))}getRemote(e){return r(this,void 0,void 0,(function*(){const t=l.extractId(e),n=yield this.list(t);return new a.L7JournalInstance(this.journalSDK,n.remoteJournal?n.remoteJournal.journalId:"",s.JournalType.REMOTE,e)}))}getMain(e){return r(this,void 0,void 0,(function*(){const t=l.extractId(e),n=yield this.list(t);return new a.L7JournalInstance(this.journalSDK,n.mainJournal.journalId,s.JournalType.MAIN,e)}))}getIsolated(e,t){return r(this,void 0,void 0,(function*(){const n=l.extractId(e);if(void 0!==(yield this.list(n)).isolationJournals.find(e=>e.journalId===t))return new a.L7JournalInstance(this.journalSDK,t,s.JournalType.ISOLATED,e);throw new c.SDKError(`Cannot find isolated journal ${t} for collection ${n}`)}))}get(e){return r(this,void 0,void 0,(function*(){const t=l.extractId(e),n=this.journalMappings.collections&&this.journalMappings.collections[t]||this.journalMappings.default;return n?this.getJournal(t,n):L7Journals.defaultType===s.JournalType.REMOTE?this.getRemote(t):this.getMain(t)}))}createCollection(e,t){return r(this,void 0,void 0,(function*(){const n={commandName:e,parameters:t};return this.journalSDK.createCollection(n,{createOnServer:this.shouldCreateCollectionOnServer()})}))}registerCommandsAndQueries(e){return r(this,void 0,void 0,(function*(){return"string"==typeof e?this.journalSDK.registerCommandsAndQueriesByPath(e):this.journalSDK.registerCommandsAndQueries(e)}))}getJournal(e,t){return r(this,void 0,void 0,(function*(){const n=l.extractId(e);if(t===s.JournalType.ISOLATED)throw new c.SDKError(`Unsupported ${t} journal mapping for collection ${n}`);let r;try{r=yield this.list(n)}catch(e){throw new c.SDKError("With status: 403 Details: Journal not found for collection "+n,e)}if(t===s.JournalType.MAIN||t===r.mainJournal.journalId)return new a.L7JournalInstance(this.journalSDK,r.mainJournal.journalId,s.JournalType.MAIN,e);if(t===s.JournalType.REMOTE||r.remoteJournal&&t===r.remoteJournal.journalId)return new a.L7JournalInstance(this.journalSDK,r.remoteJournal.journalId,s.JournalType.REMOTE,e);if(r.isolationJournals.map(e=>e.journalId).indexOf(t)>-1)return new a.L7JournalInstance(this.journalSDK,t,s.JournalType.ISOLATED,e);throw new c.SDKError(`Journal id ${t} not found under collection ${n}`)}))}shouldCreateCollectionOnServer(){return(this.journalMappings.default||L7Journals.defaultType)===s.JournalType.REMOTE}}t.L7Journals=L7Journals,L7Journals.defaultType=s.JournalType.REMOTE},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),i=n(6),s=n(402);t.L7LiteJournals=class L7LiteJournals{constructor(e){this.errorMessage="Local journals are disabled in lite mode.",this.journalSDK=e}getImplementation(){return this.journalSDK}registerCommandsAndQueries(e){return r(this,void 0,void 0,(function*(){return"string"==typeof e?this.journalSDK.registerCommandsAndQueriesByPath(e):this.journalSDK.registerCommandsAndQueries(e)}))}createCollection(e,t){return r(this,void 0,void 0,(function*(){return this.journalSDK.createCollection({commandName:e,parameters:t})}))}getRemote(e){return r(this,void 0,void 0,(function*(){return new s.L7LiteJournalInstance(this.journalSDK,i.extractId(e))}))}get(e){return r(this,void 0,void 0,(function*(){return this.getRemote(e)}))}list(e){return r(this,void 0,void 0,(function*(){throw new o.InternalError(this.errorMessage)}))}getMain(e){return r(this,void 0,void 0,(function*(){throw new o.InternalError(this.errorMessage)}))}getIsolated(e,t){return r(this,void 0,void 0,(function*(){throw new o.InternalError(this.errorMessage)}))}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(400)),s=n(101),a=n(1066),c=n(2),u=n(6);class L7ServiceJournals{constructor(e,t={}){this.journalSDK=e,this.journalMappings=t.journalMappings||{}}getImplementation(){return this.journalSDK}list(e,t){return r(this,void 0,void 0,(function*(){const n=u.extractId(e);let r=yield this.journalSDK.getJournals(n);r||(r=yield this.journalSDK.fetch(n));const o=[];return r.isolationJournals.forEach(e=>{const{properties:n}=e;let r=!t||t&&Object.keys(t).length>0;t&&Object.keys(t).forEach(e=>{n[e]&&i.default(n[e],t[e])||(r=!1)}),r&&o.push(e)}),{remoteJournal:r.remoteJournal,mainJournal:r.mainJournal,isolationJournals:o}}))}getRemote(e){return r(this,void 0,void 0,(function*(){const t=u.extractId(e),n=yield this.list(t);return new a.L7ServiceJournalInstance(this.journalSDK,n.remoteJournal?n.remoteJournal.journalId:"",s.JournalType.REMOTE,e)}))}getMain(e){return r(this,void 0,void 0,(function*(){const t=u.extractId(e),n=yield this.list(t);return new a.L7ServiceJournalInstance(this.journalSDK,n.mainJournal.journalId,s.JournalType.MAIN,e)}))}getIsolated(e,t){return r(this,void 0,void 0,(function*(){const n=u.extractId(e);if(void 0!==(yield this.list(n)).isolationJournals.find(e=>e.journalId===t))return new a.L7ServiceJournalInstance(this.journalSDK,t,s.JournalType.ISOLATED,e);throw new c.SDKError(`Cannot find isolated journal ${t} for collection ${n}`)}))}get(e){return r(this,void 0,void 0,(function*(){const t=u.extractId(e),n=this.journalMappings.collections&&this.journalMappings.collections[t]||this.journalMappings.default;return n?this.getJournal(t,n):L7ServiceJournals.defaultType===s.JournalType.REMOTE?this.getRemote(t):this.getMain(t)}))}createCollection(e,t){return r(this,void 0,void 0,(function*(){const n={commandName:e,parameters:t};return this.journalSDK.createCollection(n,{createOnServer:this.shouldCreateCollectionOnServer()})}))}registerCommandsAndQueries(e){return r(this,void 0,void 0,(function*(){throw new c.InternalError("Command And Query registration is disabled with the Service Client. Please register you commands directly in the service.")}))}getJournal(e,t){return r(this,void 0,void 0,(function*(){const n=u.extractId(e);if(t===s.JournalType.ISOLATED)throw new c.SDKError(`Unsupported ${t} journal mapping for collection ${n}`);let r;try{r=yield this.list(n)}catch(e){throw new c.SDKError("With status: 403 Details: Journal not found for collection "+n,e)}if(t===s.JournalType.MAIN||t===r.mainJournal.journalId)return new a.L7ServiceJournalInstance(this.journalSDK,r.mainJournal.journalId,s.JournalType.MAIN,e);if(t===s.JournalType.REMOTE||r.remoteJournal&&t===r.remoteJournal.journalId)return new a.L7ServiceJournalInstance(this.journalSDK,r.remoteJournal.journalId,s.JournalType.REMOTE,e);if(r.isolationJournals.map(e=>e.journalId).indexOf(t)>-1)return new a.L7ServiceJournalInstance(this.journalSDK,t,s.JournalType.ISOLATED,e);throw new c.SDKError(`Journal id ${t} not found under collection ${n}`)}))}shouldCreateCollectionOnServer(){return(this.journalMappings.default||L7ServiceJournals.defaultType)===s.JournalType.REMOTE}}t.L7ServiceJournals=L7ServiceJournals,L7ServiceJournals.defaultType=s.JournalType.REMOTE},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),i=n(101),s=n(30),a=n(6),c=n(80),u=n(399);class L7ServiceJournalInstance{constructor(e,t,n,r){this.journalSDK=e,this.id=t,this.type=n,this.collection=r}getId(){return this.id}getType(){return this.type}getParent(){return r(this,void 0,void 0,(function*(){const e=yield this.getParentInfo();if(e&&e.data)return new L7ServiceJournalInstance(this.journalSDK,e.data.journalId,e.type,this.collection)}))}setParent(e,t){return r(this,void 0,void 0,(function*(){throw new o.InternalError("Journal service does not allow to change the parent journal")}))}executeCommands(e){return r(this,void 0,void 0,(function*(){if(!e.length)return Promise.resolve([]);if(!a.isSerializableCommands(e))throw new o.InternalError("Attempting to execute commands that are not serializable.");return this.journalSDK.executeCommandBatch(this.id,e)}))}executeQuery(e,t,n){return r(this,void 0,void 0,(function*(){return this.journalSDK.executeQuery(this.id,{queryName:e,parameters:t},n)}))}isolate(e,t){return r(this,void 0,void 0,(function*(){const n={journalId:e};t&&(n.properties=t);const r=yield this.journalSDK.createIsolationJournal(this.getId(),n);return new L7ServiceJournalInstance(this.journalSDK,r,i.JournalType.ISOLATED,this.collection)}))}sync(e){return r(this,void 0,void 0,(function*(){if(this.type!==i.JournalType.REMOTE)throw new o.SDKError("The sync method can only be called on a remote journal");yield this.journalSDK.fetch(this.getId(),u.toSyncRequest(e))}))}rebase(e){return r(this,void 0,void 0,(function*(){if(this.type===i.JournalType.REMOTE)throw new o.SDKError("The rebase method cannot be called on a remote journal.");return this.type===i.JournalType.MAIN?this.journalSDK.pull(this.getId(),u.toSyncRequest(e)):this.journalSDK.rebase(this.getId())}))}rebaseOnly(){return r(this,void 0,void 0,(function*(){return this.rebase({selector:c.noopSelector,priority:s.SyncPriority.HIGHEST})}))}publish(e){return r(this,void 0,void 0,(function*(){if(this.type===i.JournalType.REMOTE)throw new o.SDKError("The publish method cannot be called on a remote journal");this.type!==i.JournalType.MAIN?yield this.getParent().then(e=>{if(void 0===e)throw new o.SDKError("Cannot publish to parent journal. Parent journal does not exist.");const t=e.getId();return this.journalSDK.synchronizeJournals(this.getId(),t)}):yield this.journalSDK.synchronizeWithServer(this.getId(),u.toSyncRequest(e))}))}publishOnly(){return r(this,void 0,void 0,(function*(){return this.publish({selector:c.noopSelector,priority:s.SyncPriority.HIGHEST})}))}delete(){return r(this,void 0,void 0,(function*(){if(this.type===i.JournalType.REMOTE||this.type===i.JournalType.MAIN)throw new o.SDKError(`A journal of type ${this.type} cannot be deleted.`);return this.journalSDK.deleteIsolationJournal(this.getId())}))}setAutoSynchronizationMode(e){if(this.getType()!==i.JournalType.MAIN)throw new o.SDKError("Automatic sync is only available on the MAIN journal. Current is "+this.getType());this.journalSDK.setAutoSynchronizationMode(a.extractId(this.collection),e)}setProperties(e){return r(this,void 0,void 0,(function*(){yield this.journalSDK.updateJournalProperties(this.id,e)}))}getProperties(){return r(this,void 0,void 0,(function*(){const e=yield this.journalSDK.getJournals(a.extractId(this.collection));if(!e)return{};if("main"===this.type)return e.mainJournal.properties;if("remote"===this.type)return e.remoteJournal.properties;const t=e.isolationJournals.find(e=>e.journalId===this.id);return t?t.properties:{}}))}purgeCommandsForEntity(e){return r(this,void 0,void 0,(function*(){throw new o.InternalError("Journal service does not allow to purge commands")}))}getParentInfo(){return r(this,void 0,void 0,(function*(){if(this.getType()===i.JournalType.REMOTE)return;const e=yield this.journalSDK.getJournals(a.extractId(this.collection));if(this.type===i.JournalType.MAIN){const t=null==e?void 0:e.remoteJournal;return{type:i.JournalType.REMOTE,data:t}}const{parentJournalId:t}=null==e?void 0:e.isolationJournals.find(e=>e.journalId===this.id);if(t===(null==e?void 0:e.mainJournal.journalId))return{type:i.JournalType.MAIN,data:null==e?void 0:e.mainJournal};const n=null==e?void 0:e.isolationJournals.find(e=>e.journalId===t);return{type:i.JournalType.ISOLATED,data:n}}))}dispose(){return r(this,void 0,void 0,(function*(){return this.journalSDK.dispose()}))}}t.L7ServiceJournalInstance=L7ServiceJournalInstance},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1068);t.ForgeSchemaStore=r.ForgeSchemaStore},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(61)),s=o(n(62));t.ForgeSchemaStore=class ForgeSchemaStore{constructor(e){this.restClient=s.default.create({baseURL:e.url,timeout:1e3})}getSchema(e){return r(this,void 0,void 0,(function*(){const t=`/versions/propertySets:${e}?filter[schema][compile]=false`,n=yield this.restClient.get(t,{headers:{"Content-Type":"application/vnd.api+json",Accept:"application/vnd.api+json"}});return i.default(n.data,["data","attributes","schema"])}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(230),{commands:o,queries:i}=[r.AssetDefinitions,r.CollectionDefinitions,r.SpaceDefinitions,r.RelationshipDefinitions,r.SnapshotDefinitions,r.BinaryAssetDefinitions,r.AssetGraphDefinitions].reduce((e,t)=>({commands:Object.assign(t.commands||{},e.commands||{}),queries:Object.assign(t.queries||{},e.queries||{})}),{});t.commands=o,t.queries=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toType=function toType(e){return"boolean"==typeof e?"Bool":"number"==typeof e?"Int32":"String"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Design=0]="Design",e[e.Drawing=1]="Drawing"}(t.DOCUMENT_TYPE||(t.DOCUMENT_TYPE={}))},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(405)),i=r(n(406)),s=r(n(407)),a=r(n(408)),c=r(n(409)),u=r(n(410)),l=r(n(411)),d=r(n(412)),p=r(n(413)),h=r(n(414)),m=r(n(415)),y=r(n(416)),g=r(n(417)),_=r(n(418)),v=r(n(419)),E=r(n(420)),I=r(n(421)),b=r(n(422)),S=r(n(423)),C=r(n(424)),w=r(n(425)),A=r(n(426)),O=r(n(427)),P=r(n(428)),D=r(n(429)),x=r(n(430)),R=r(n(431)),N=r(n(1073)),M=r(n(432)),L=r(n(433)),j=r(n(434)),k=r(n(435)),F=r(n(436)),U=r(n(437)),V=r(n(438)),B=r(n(439)),J=r(n(1074)),$=r(n(1075)),G=r(n(440)),q=r(n(441)),H=r(n(442)),Y=r(n(443)),K=r(n(444)),z=r(n(1076)),W=r(n(445)),Q=r(n(446)),X=r(n(1077)),Z=r(n(1078)),ee=r(n(1079)),te=r(n(447)),ne=r(n(1080)),re=r(n(1081)),oe=r(n(448)),ie=r(n(449)),se=r(n(1082)),ae=r(n(450)),ce=r(n(451)),ue=r(n(1083)),le=r(n(1084)),de=r(n(452)),pe=r(n(1085)),he=r(n(453)),fe=r(n(454)),me=r(n(1086)),ye=r(n(455)),ge=r(n(456)),_e=r(n(457)),ve=r(n(458)),Ee=r(n(1087)),Ie=r(n(459)),be=r(n(1088)),Se=r(n(1089)),Ce=r(n(460)),we=r(n(1090)),Ae=r(n(461)),Oe=r(n(1091)),Te=r(n(462)),Pe=r(n(463)),De=r(n(1092)),xe=r(n(464)),Re=r(n(1093)),Ne=r(n(1094)),Me=r(n(1095)),Le=r(n(465)),je=r(n(1096)),ke=r(n(1097)),Fe=r(n(466)),Ue=r(n(1098)),Ve=r(n(467)),Be=r(n(1099)),Je=r(n(1100)),$e=r(n(1101)),Ge=r(n(468)),qe=r(n(469)),He=r(n(470)),Ye=r(n(1102)),Ke=r(n(1103)),ze=r(n(471)),We=r(n(472)),Qe=r(n(1104)),Xe=r(n(1105)),Ze=r(n(1106)),et=r(n(1107)),tt=r(n(473)),nt=r(n(1108)),rt=r(n(1109)),ot=r(n(474)),it=r(n(475)),st=r(n(476)),at=r(n(477)),ct=r(n(478)),ut=r(n(479)),lt=r(n(1110)),dt=r(n(480)),pt=r(n(1111)),ht=r(n(481)),ft=r(n(482)),mt=r(n(483)),yt=r(n(484)),gt=r(n(485)),_t=r(n(475)),vt=r(n(474)),Et=r(n(473)),It=r(n(472)),bt=r(n(471)),St=r(n(470)),Ct=r(n(469)),wt=r(n(468)),At=r(n(467)),Ot=r(n(466)),Tt=r(n(465)),Pt=r(n(464)),Dt=r(n(463)),xt=r(n(440)),Rt=r(n(481)),Nt=r(n(480)),Mt=r(n(462)),Lt=r(n(461)),jt=r(n(460)),kt=r(n(459)),Ft=r(n(458)),Ut=r(n(457)),Vt=r(n(456)),Bt=r(n(455)),Jt=r(n(454)),$t=r(n(453)),Gt=r(n(452)),qt=r(n(451)),Ht=r(n(450)),Yt=r(n(449)),Kt=r(n(448)),zt=r(n(447)),Wt=r(n(446)),Qt=r(n(445)),Xt=r(n(444)),Zt=r(n(443)),en=r(n(442)),tn=r(n(441)),nn=r(n(476)),rn=r(n(439)),sn=r(n(438)),an=r(n(437)),cn=r(n(436)),un=r(n(435)),ln=r(n(434)),dn=r(n(433)),pn=r(n(432)),hn=r(n(421)),fn=r(n(419)),mn=r(n(418)),yn=r(n(413)),gn=r(n(412)),_n=r(n(411)),vn=r(n(417)),En=r(n(422)),In=r(n(415)),bn=r(n(431)),Sn=r(n(430)),Cn=r(n(414)),wn=r(n(410)),An=r(n(420)),On=r(n(409)),Tn=r(n(408)),Pn=r(n(407)),Dn=r(n(406)),xn=r(n(405)),Rn=r(n(416)),Nn=r(n(429)),Mn=r(n(428)),Ln=r(n(423)),jn=r(n(427)),kn=r(n(425)),Fn=r(n(424)),Un=r(n(426)),Vn=r(n(485)),Bn=r(n(484)),Jn=r(n(483)),$n=r(n(482)),Gn=r(n(479)),qn=r(n(478)),Hn=r(n(477)),Yn={Unit_UnitRelative_V1_0_0:o.default,Unit_UnitPrimitiveDimensional_V1_0_0:i.default,Unit_UnitPrimitive_V1_0_0:s.default,Unit_UnitDerived_V1_0_1:a.default,Unit_Unit_V1_0_0:c.default,Unit_System_V1_0_0:u.default,Unit_FactorDerived_V1_0_1:l.default,Unit_Factor_V1_0_0:d.default,Unit_Dimension_V1_0_0:p.default,UnitUnit_SquareCentimeters_V1_0_1:h.default,UnitUnit_Meters_V1_0_0:m.default,UnitUnit_KilogramsPerCubicCentimeter_V1_0_0:y.default,UnitUnit_Kilograms_V1_0_0:g.default,UnitUnit_CubicCentimeters_V1_0_1:_.default,UnitUnit_Centimeters_V1_0_1:v.default,UnitFactor_Ten_V1_0_0:E.default,UnitFactorPrefix_Centi_V1_0_0:I.default,UnitDimension_Mass_V1_0_0:b.default,UnitDimension_Length_V1_0_0:S.default,Spec_SpecMeasurable_V1_0_0:C.default,Spec_Spec_V1_0_0:w.default,SpecProduct_Volume_V1_0_0:A.default,SpecProduct_Mass_V1_0_0:O.default,SpecProduct_Density_V1_0_0:P.default,SpecProduct_Area_V1_0_0:D.default,Range_RangeFloat64_V1_0_0:x.default,Range_Range_V1_0_0:R.default,Product_Snapshot_V0_0_1:N.default,Product_Snapshot_V1_0_0:M.default,Product_RelationshipXRef_V2_0_0:L.default,Product_RelationshipUse_V1_0_0:j.default,Product_RelationshipDescribes_V1_0_0:k.default,Product_RelationshipDerived_V1_0_0:F.default,Product_RelationshipContains_V2_0_0:U.default,Product_RelationshipContained_V2_0_0:V.default,Product_RelationshipAssemblyRef_V1_0_0:B.default,Product_ComponentsWIPReference_V0_0_1:J.default,Product_ComponentsWIPReference_V1_0_0:$.default,Product_ComponentsWIPReference_V2_0_0:G.default,Product_ComponentsVersion_V1_0_0:q.default,Product_ComponentsTransformation_V1_0_0:H.default,Product_ComponentsSnapshot_V1_0_0:Y.default,Product_ComponentsRevision_V1_0_0:K.default,Product_ComponentsRelease_V1_0_0:z.default,Product_ComponentsRelease_V2_0_0:W.default,Product_ComponentsProduct_V3_0_0:Q.default,Product_ComponentsPhysicalProperties_V2_0_0:X.default,Product_ComponentsPhysicalProperties_V3_0_0:Z.default,Product_ComponentsPhysicalProperties_V4_0_0:ee.default,Product_ComponentsPhysicalProperties_V5_0_0:te.default,Product_ComponentsPartNumber_V1_0_0:ne.default,Product_ComponentsPartNumber_V2_0_0:re.default,Product_ComponentsPartNumber_V2_1_0:oe.default,Product_ComponentsName_V1_0_0:ie.default,Product_ComponentsMilestone_V1_0_0:se.default,Product_ComponentsMilestone_V2_0_0:ae.default,Product_ComponentsMaterial_V1_0_0:ce.default,Product_ComponentsLifecycle_V0_0_0:ue.default,Product_ComponentsLifecycle_V1_0_0:le.default,Product_ComponentsLifecycle_V1_1_0:de.default,Product_ComponentsItemNumber_V0_0_0:pe.default,Product_ComponentsItemNumber_V1_0_0:he.default,Product_ComponentsInternalFlag_V1_0_0:fe.default,Product_ComponentsInternalComponent_V1_0_0:me.default,Product_ComponentsInternalComponent_V2_0_0:ye.default,Product_ComponentsErrorStatus_V1_0_0:ge.default,Product_ComponentsError_V1_0_0:_e.default,Product_ComponentsEco_V1_0_0:ve.default,Product_ComponentsDrawing_V1_0_0:Ee.default,Product_ComponentsDrawing_V2_0_0:Ie.default,Product_ComponentsDeleteStatus_V0_0_0:be.default,Product_ComponentsDeleteStatus_V1_0_0:Se.default,Product_ComponentsDeleteStatus_V1_1_0:Ce.default,Product_ComponentsComponentInstance_V1_0_0:we.default,Product_ComponentsComponentInstance_V1_1_0:Ae.default,Product_ComponentsCam_V1_0_0:Oe.default,Product_ComponentsCam_V2_0_0:Te.default,Product_AssetsSheets_V1_0_0:Pe.default,Product_AssetsRelease_V1_0_0:De.default,Product_AssetsRelease_V2_0_0:xe.default,Product_AssetsProduct_V1_0_1:Re.default,Product_AssetsProduct_V2_0_0:Ne.default,Product_AssetsProduct_V3_0_0:Me.default,Product_AssetsProduct_V4_0_0:Le.default,Product_AssetsModel_V0_0_2:je.default,Product_AssetsModel_V1_0_0:ke.default,Product_AssetsModel_V2_0_0:Fe.default,Product_AssetsMilestone_V1_0_0:Ue.default,Product_AssetsMilestone_V2_0_0:Ve.default,Product_AssetsLifecycle_V0_0_2:Be.default,Product_AssetsLifecycle_V1_0_0:Je.default,Product_AssetsLifecycle_V1_1_0:$e.default,Product_AssetsLifecycle_V2_0_0:Ge.default,Product_AssetsItem_V1_0_0:qe.default,Product_AssetsFile_V1_0_0:He.default,Product_AssetsDrawing_V1_0_0:Ye.default,Product_AssetsDrawing_V2_0_0:Ke.default,Product_AssetsDrawing_V3_0_0:ze.default,Product_AssetsDocumentation_V1_0_0:We.default,Product_AssetsDesign_V2_0_1:Qe.default,Product_AssetsDesign_V3_0_0:Xe.default,Product_AssetsDesign_V4_0_0:Ze.default,Product_AssetsDesign_V5_0_0:et.default,Product_AssetsDesign_V6_0_0:tt.default,Product_AssetsCam_V1_0_0:nt.default,Product_AssetsCam_V2_0_0:rt.default,Product_AssetsCam_V3_0_0:ot.default,Product_AssetgraphProcess_V1_0_0:it.default,Math_Matrix44f_V1_0_0:st.default,Data_Space_V1_0_0:at.default,Data_Snapshot_V1_0_0:ct.default,Data_Relationship_V1_0_0:ut.default,Data_ComponentsAceManageExtensionWorkspace_V1_0_0:lt.default,Data_ComponentsAceManageExtensionWorkspace_V2_0_0:dt.default,Data_ComponentsAceManageExtension_V1_0_0:pt.default,Data_ComponentsAceManageExtension_V2_0_0:ht.default,Data_Component_V1_0_0:ft.default,Data_BinaryAsset_V1_0_0:mt.default,Data_Assetgraph_V1_0_0:yt.default,Data_Asset_V1_0_0:gt.default,Product_AssetgraphProcess_latest:_t.default,Product_AssetsCam_latest:vt.default,Product_AssetsDesign_latest:Et.default,Product_AssetsDocumentation_latest:It.default,Product_AssetsDrawing_latest:bt.default,Product_AssetsFile_latest:St.default,Product_AssetsItem_latest:Ct.default,Product_AssetsLifecycle_latest:wt.default,Product_AssetsMilestone_latest:At.default,Product_AssetsModel_latest:Ot.default,Product_AssetsProduct_latest:Tt.default,Product_AssetsRelease_latest:Pt.default,Product_AssetsSheets_latest:Dt.default,Product_ComponentsWIPReference_latest:xt.default,Data_ComponentsAceManageExtension_latest:Rt.default,Data_ComponentsAceManageExtensionWorkspace_latest:Nt.default,Product_ComponentsCam_latest:Mt.default,Product_ComponentsComponentInstance_latest:Lt.default,Product_ComponentsDeleteStatus_latest:jt.default,Product_ComponentsDrawing_latest:kt.default,Product_ComponentsEco_latest:Ft.default,Product_ComponentsError_latest:Ut.default,Product_ComponentsErrorStatus_latest:Vt.default,Product_ComponentsInternalComponent_latest:Bt.default,Product_ComponentsInternalFlag_latest:Jt.default,Product_ComponentsItemNumber_latest:$t.default,Product_ComponentsLifecycle_latest:Gt.default,Product_ComponentsMaterial_latest:qt.default,Product_ComponentsMilestone_latest:Ht.default,Product_ComponentsName_latest:Yt.default,Product_ComponentsPartNumber_latest:Kt.default,Product_ComponentsPhysicalProperties_latest:zt.default,Product_ComponentsProduct_latest:Wt.default,Product_ComponentsRelease_latest:Qt.default,Product_ComponentsRevision_latest:Xt.default,Product_ComponentsSnapshot_latest:Zt.default,Product_ComponentsTransformation_latest:en.default,Product_ComponentsVersion_latest:tn.default,Math_Matrix44f_latest:nn.default,Product_RelationshipAssemblyRef_latest:rn.default,Product_RelationshipContained_latest:sn.default,Product_RelationshipContains_latest:an.default,Product_RelationshipDerived_latest:cn.default,Product_RelationshipDescribes_latest:un.default,Product_RelationshipUse_latest:ln.default,Product_RelationshipXRef_latest:dn.default,Product_Snapshot_latest:pn.default,UnitFactorPrefix_Centi_latest:hn.default,UnitUnit_Centimeters_latest:fn.default,UnitUnit_CubicCentimeters_latest:mn.default,Unit_Dimension_latest:yn.default,Unit_Factor_latest:gn.default,Unit_FactorDerived_latest:_n.default,UnitUnit_Kilograms_latest:vn.default,UnitDimension_Mass_latest:En.default,UnitUnit_Meters_latest:In.default,Range_Range_latest:bn.default,Range_RangeFloat64_latest:Sn.default,UnitUnit_SquareCentimeters_latest:Cn.default,Unit_System_latest:wn.default,UnitFactor_Ten_latest:An.default,Unit_Unit_latest:On.default,Unit_UnitDerived_latest:Tn.default,Unit_UnitPrimitive_latest:Pn.default,Unit_UnitPrimitiveDimensional_latest:Dn.default,Unit_UnitRelative_latest:xn.default,UnitUnit_KilogramsPerCubicCentimeter_latest:Rn.default,SpecProduct_Area_latest:Nn.default,SpecProduct_Density_latest:Mn.default,UnitDimension_Length_latest:Ln.default,SpecProduct_Mass_latest:jn.default,Spec_Spec_latest:kn.default,Spec_SpecMeasurable_latest:Fn.default,SpecProduct_Volume_latest:Un.default,Data_Asset_latest:Vn.default,Data_Assetgraph_latest:Bn.default,Data_BinaryAsset_latest:Jn.default,Data_Component_latest:$n.default,Data_Relationship_latest:Gn.default,Data_Snapshot_latest:qn.default,Data_Space_latest:Hn.default};t.schemas=Yn},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:snapshot-0.0.1","properties":[{"id":"value","typeid":"String","annotation":{"description":"Snapshot URN of the subcomponent."}}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.WIPReference-0.0.1","properties":[{"id":"default","typeid":"Bool","annotation":{"description":"Indicates if this the best default targetComponent to represent the Lineage as a whole"}},{"id":"lineageURN","typeid":"String","annotation":{"description":"The urn for the file lineage in WIP"}},{"id":"targetComponent","typeid":"String","annotation":{"description":"a unique identifier for the target model-component"}}],"annotation":{"description":"Specialized component for data refences of an asset."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.WIPReference-1.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"default","typeid":"Bool","annotation":{"description":"Indicates if this the best default targetComponent to represent the Lineage as a whole"}},{"id":"lineageURN","typeid":"String","annotation":{"description":"The urn for the file lineage in WIP"}},{"id":"targetComponent","typeid":"String","annotation":{"description":"a unique identifier for the target model-component"}}],"annotation":{"description":"Specialized component for data refences of an asset."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.release-1.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"isLocked","typeid":"Bool","annotation":{"description":"Whether the released asset is now in a locked state, and is not editable"}},{"id":"releaseDate","typeid":"String","annotation":{"description":"The date the asset was released"}},{"id":"approvedBy","typeid":"String","annotation":{"description":"The users that approved the asset\'s release"}},{"id":"approvers","typeid":"String","annotation":{"description":"The users that can approve the asset\'s release"}},{"id":"owner","typeid":"String","annotation":{"description":"The user that initiated the release of the asset"}}],"annotation":{"description":"Specialized component storing the release information for the engineering change order."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.physicalProperties-2.0.0","properties":[{"id":"mass","properties":[{"id":"value","typeid":"Float64"},{"id":"unit","typeid":"String"}]},{"id":"material","typeid":"String"},{"id":"area","properties":[{"id":"value","typeid":"Float64"},{"id":"unit","typeid":"String"}]},{"id":"density","properties":[{"id":"value","typeid":"Float64"},{"id":"unit","typeid":"String"}]},{"id":"volume","properties":[{"id":"value","typeid":"Float64"},{"id":"unit","typeid":"String"}]}],"annotation":{"description":"Specialized component storing physical properties computed from a model."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.physicalProperties-3.0.0","properties":[{"id":"mass","properties":[{"id":"value","typeid":"Float64"},{"id":"unit","typeid":"autodesk.spec.product:mass-1.0.0"}]},{"id":"material","typeid":"String"},{"id":"area","properties":[{"id":"value","typeid":"Float64"},{"id":"unit","typeid":"autodesk.spec.product:area-1.0.0"}]},{"id":"density","properties":[{"id":"value","typeid":"Float64"},{"id":"unit","typeid":"autodesk.spec.product:density-1.0.0"}]},{"id":"volume","properties":[{"id":"value","typeid":"Float64"},{"id":"unit","typeid":"autodesk.spec.product:volume-1.0.0"}]}],"annotation":{"description":"Specialized component storing physical properties computed from a model."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.physicalProperties-4.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"mass","properties":[{"id":"value","typeid":"Float64"},{"id":"unit","typeid":"autodesk.spec.product:mass-1.0.0"}]},{"id":"material","typeid":"String"},{"id":"area","properties":[{"id":"value","typeid":"Float64"},{"id":"unit","typeid":"autodesk.spec.product:area-1.0.0"}]},{"id":"density","properties":[{"id":"value","typeid":"Float64"},{"id":"unit","typeid":"autodesk.spec.product:density-1.0.0"}]},{"id":"volume","properties":[{"id":"value","typeid":"Float64"},{"id":"unit","typeid":"autodesk.spec.product:volume-1.0.0"}]}],"annotation":{"description":"Specialized component storing physical properties computed from a model."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.partNumber-1.0.0","properties":[{"id":"partNumber","typeid":"String"},{"id":"partName","typeid":"String"}],"annotation":{"description":"Specialized component containing information to describe a product\'s Partnumber."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.partNumber-2.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"partNumber","typeid":"String"},{"id":"partName","typeid":"String"}],"annotation":{"description":"Specialized component containing information to describe a product\'s Partnumber."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.milestone-1.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"wipVersionUrn","typeid":"String","annotation":{"description":"WIP versionUrn of the WIP version"}},{"id":"name","typeid":"String","annotation":{"description":"Name of the PIM milestone"}},{"id":"description","typeid":"String","annotation":{"description":"Description of the PIM milestone"}},{"id":"category","typeid":"String","annotation":{"description":"Category of the milestone, can be \'release\' or \'\' (standard non-release milestone)"}},{"id":"lastModifiedTime","typeid":"String","annotation":{"description":"Last modified time of the milestone in ISO 8601 format."}},{"id":"createTime","typeid":"String","annotation":{"description":"Creation time of the milestone in ISO 8601 format."}},{"id":"lastModifiedUserId","typeid":"String","annotation":{"description":"User id of the last modification of the milestone."}},{"id":"createUserId","typeid":"String","annotation":{"description":"User id of the creation of the milestone."}}],"annotation":{"description":"Specialized component storing the milestone information for a corresponding WIP version."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.lifecycle-0.0.0","properties":[{"id":"URN","typeid":"String","annotation":{"description":"The urn for the FLC item"}},{"id":"descriptor","typeid":"String","annotation":{"description":"Descriptor for the FLC item"}},{"id":"revision","typeid":"String","annotation":{"description":"Revision for the FLC item"}},{"id":"lifecycle","typeid":"String","annotation":{"description":"Lifecycle for the FLC item"}}],"annotation":{"description":"Specialized component storing data for an FLC asset."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.lifecycle-1.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"URN","typeid":"String","annotation":{"description":"The urn for the FLC item"}},{"id":"descriptor","typeid":"String","annotation":{"description":"Descriptor for the FLC item"}},{"id":"revision","typeid":"String","annotation":{"description":"Revision for the FLC item"}},{"id":"lifecycle","typeid":"String","annotation":{"description":"Lifecycle for the FLC item"}}],"annotation":{"description":"Specialized component storing data for an FLC asset."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.itemNumber-0.0.0","properties":[{"id":"itemNumber","typeid":"String","annotation":{"description":"The generated item number for the managed asset."}}],"annotation":{"description":"Specialized component storing the item number for the managed asset."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.internalComponent-1.0.0","properties":[{"id":"targetComponent","typeid":"String","annotation":{"description":"a unique identifier for the target model-component"}}],"annotation":{"description":"Specialized component storing a reference to the  model-component."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.drawing-1.0.0","properties":[]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.deleteStatus-0.0.0","properties":[{"id":"file","typeid":"Bool","annotation":{"description":"Indicates if the file associated with the asset is deleted"}},{"id":"modelComponent","typeid":"Bool","annotation":{"description":"Indicates if the model-component associated with the asset is deleted"}}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.deleteStatus-1.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"file","typeid":"Bool","annotation":{"description":"Indicates if the file associated with the asset is deleted"}},{"id":"modelComponent","typeid":"Bool","annotation":{"description":"Indicates if the model-component associated with the asset is deleted"}}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.componentInstance-1.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"index","typeid":"Int32","annotation":{"description":"Identifies the component instance that the assembly reference refers to. This differentiates otherwise identical assembly references, and is unique per subcomponent."}},{"id":"name","typeid":"String","annotation":{"description":"The name of the subcomponent as used in the assembly."}}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.product:components.cam-1.0.0","properties":[]}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[{"id":"lifecycle","typeid":"autodesk.product:components.lifecycle-1.0.0"},{"id":"release","typeid":"autodesk.product:components.release-1.0.0"}],"typeid":"autodesk.product:assets.release-1.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[{"id":"product","typeid":"autodesk.product:components.product-1.0.0"}],"typeid":"autodesk.product:assets.product-1.0.1"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.product:assets.item-1.0.0"],"properties":[{"id":"product","typeid":"autodesk.product:components.product-1.0.1"},{"id":"partNumber","typeid":"autodesk.product:components.partNumber-1.0.0"}],"typeid":"autodesk.product:assets.product-2.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.product:assets.item-1.0.0"],"properties":[{"id":"product","typeid":"autodesk.product:components.product-3.0.0"},{"id":"partNumber","typeid":"autodesk.product:components.partNumber-2.0.0"}],"typeid":"autodesk.product:assets.product-3.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[{"id":"wipReference","typeid":"autodesk.product:components.WIPReference-0.0.1"}],"typeid":"autodesk.product:assets.model-0.0.2"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[{"id":"wipReference","typeid":"autodesk.product:components.WIPReference-1.0.0"}],"typeid":"autodesk.product:assets.model-1.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[{"id":"milestone","typeid":"autodesk.product:components.milestone-1.0.0"}],"typeid":"autodesk.product:assets.milestone-1.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[{"id":"lifecycle","typeid":"autodesk.product:components.lifecycle-0.0.0"}],"typeid":"autodesk.product:assets.lifecycle-0.0.2"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[{"id":"lifecycle","typeid":"autodesk.product:components.lifecycle-1.0.0"}],"typeid":"autodesk.product:assets.lifecycle-1.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[{"id":"lifecycle","typeid":"autodesk.product:components.lifecycle-1.1.0"}],"typeid":"autodesk.product:assets.lifecycle-1.1.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[{"id":"drawing","typeid":"autodesk.product:components.drawing-1.0.0"}],"typeid":"autodesk.product:assets.drawing-1.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[{"id":"drawing","typeid":"autodesk.product:components.drawing-2.0.0"}],"typeid":"autodesk.product:assets.drawing-2.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[{"id":"physicalProperties","typeid":"autodesk.product:components.physicalProperties-2.0.0"}],"typeid":"autodesk.product:assets.design-2.0.1"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[{"id":"physicalProperties","typeid":"autodesk.product:components.physicalProperties-3.0.0"}],"typeid":"autodesk.product:assets.design-3.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[{"id":"physicalProperties","typeid":"autodesk.product:components.physicalProperties-4.0.0"}],"typeid":"autodesk.product:assets.design-4.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.data:asset-1.0.0"],"properties":[{"id":"physicalProperties","typeid":"autodesk.product:components.physicalProperties-5.0.0"}],"typeid":"autodesk.product:assets.design-5.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.product:assets.item-1.0.0"],"properties":[{"id":"cam","typeid":"autodesk.product:components.cam-1.0.0"}],"typeid":"autodesk.product:assets.cam-1.0.0"}')},function(e){e.exports=JSON.parse('{"inherits":["autodesk.product:assets.item-1.0.0"],"properties":[{"id":"cam","typeid":"autodesk.product:components.cam-2.0.0"}],"typeid":"autodesk.product:assets.cam-2.0.0"}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:components.aceManageExtensionWorkspace-1.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"sectionId","typeid":"String"},{"id":"workspace","typeid":"String"},{"id":"workspaceId","typeid":"String"},{"id":"ecoWorkspace","typeid":"String"},{"id":"ecoWorkspaceId","typeid":"String"},{"id":"assetUrnFieldId","typeid":"String"},{"id":"itemNumberFieldId","typeid":"String"},{"id":"productUrnFieldId","typeid":"String"},{"id":"spaceCollectionId","typeid":"String"},{"id":"quickReleaseEndPoint","typeid":"String"},{"id":"rootFolderUrnFieldId","typeid":"String"}],"annotation":{"description":"FLC workspace ACE data model."}}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:components.aceManageExtension-1.0.0","inherits":["autodesk.data:component-1.0.0"],"properties":[{"id":"appName","typeid":"String"},{"id":"appType","typeid":"String"},{"id":"appId","typeid":"String"},{"id":"designs","typeid":"autodesk.data:components.aceManageExtensionWorkspace-1.0.0"},{"id":"drawings","typeid":"autodesk.data:components.aceManageExtensionWorkspace-1.0.0"}],"annotation":{"description":"FLC ACE data model."}}')},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.majorVersionSum=115},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1),i=n(1114),s=n(3),a=n(236);async function purgeEntities(e,t){try{if(0==e.length)return;const n=e.map(e=>e.getId());t&&t("Purge entities: "+n),await Promise.all(e.map(async e=>{e&&(e.isNewResource()||(await e.delete(),await e.purge()))}))}catch(e){t&&t("Failed to purge entities.")}}t.purgeEntities=purgeEntities,t.purgeEntitiesOfF3DComponents=async function purgeEntitiesOfF3DComponents(e,t,n){const a=s.getLogger(e);try{if(0==n.length)return 0;const s=await async function getRelatedDataOfF3dComponent(e,t,n){const s=[],a=new Set,c=[];for(const r of n){const n=await i.getModelFromF3dComponent(e,t,r);c.push(...n);for(const e of n){const t=await e.getSpace({fetch:!1});s.push(t),a.add(t.getId())}}if(c.length<1)return[];const u=[];for(let e=0;e<c.length;e+=20)u.push(c.slice(e,e+20));const l=s;for(const n of u){const i={startAssets:n.map(e=>({asset:e.getId()})),maxDepth:0,relationshipFilters:[{direction:"IN",type:{name:o.PIM_CONTAINS_RELATIONSHIP_TYPENAME}}]},s=await r.AssetGraph.getClosureV2(e,t,i),c=s.getRelationships(),u=s.getAssets(),d={};u.map(e=>{d[e.getId()]=e});const p=c.filter(e=>{const t=d[e.fromId].spaceId;if(a.has(t))return!1;const n=d[e.toId].spaceId;return!!a.has(n)});l.push(...p)}return l}(e,t,n);return await purgeEntities(s,a),s.length}catch(e){return a&&a("Failed to purge entities."),0}},t.purgeEntitiesOfF2DComponents=async function purgeEntitiesOfF2DComponents(e,t,n){const i=[],c=new Set,u=[],l=await a.getSheetsFromLineage(e,t,n);if(l){u.push(...l);for(const e of l){const t=await e.getSpace({fetch:!1});i.push(t),c.add(t.getId())}}if(u.length<1)return u.length;const d=[];for(let e=0;e<u.length;e+=20)d.push(u.slice(e,e+20));const p=i;for(const n of d){const i={startAssets:n.map(e=>({asset:e.getId()})),maxDepth:0,relationshipFilters:[{direction:"IN",type:{name:o.PIM_CONTAINS_RELATIONSHIP_TYPENAME}}]},s=await r.AssetGraph.getClosureV2(e,t,i),a=s.getRelationships(),u=s.getAssets(),l={};u.map(e=>{l[e.getId()]=e});const d=a.filter(e=>{const t=l[e.fromId].spaceId;if(c.has(t))return!1;const n=l[e.toId].spaceId;return!!c.has(n)});p.push(...d)}const h=s.getLogger(e);try{return h&&h("Partial data found for lineage urn"+n.toString()),await purgeEntities(p,h),p.length}catch(e){return h&&h("Failed to purge entities."),0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(3),o=n(9);t.getModelFromF3dComponent=async function getModelFromF3dComponent(e,t,n){const i=(t=await o.toSpaceCollection(e,t,{fetch:!1})).getAssets({limit:10,filter:{"attribute.f3dComponentId":n}});await i.nextPage();const s=i.getPage();if(s){const t=s.getAssets();if(t.length>=1){const t=r.getLogger(e);t&&t("Multi model assets with targetComponent: "+n)}return t}return[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(10),o=n(1),i=n(235),s=n(43);t.setVersionSnapshot=function setVersionSnapshot(e,t){s.setComponent(e,r.ComponentKeys.SNAPSHOT,s.snapshotComponent(t)),i.setEntityAttribute(e,"name","versionSnapshot"),i.setEntityAttribute(e,"wipVersionUrn",t.wipVersionUrn),i.setEntityAttribute(e,r.AttributeKeys.DM_VERSION_ID,t.wipVersionUrn),s.setComponent(e,"version",{typeid:o.schemaTypes.Product_ComponentsVersion_V1_0_0.typeid,value:{}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.ASSET="asset",e.SNAPSHOT="snapshot",e.RELATIONSHIP="relationship"}(t.EntityTypes||(t.EntityTypes={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.UNDER_CONSTRUCTION="underConstruction",e.CONTENT_READY="contentReady",e.ERROR="error",e.COMPLETE="complete"}(t.IncompleteState||(t.IncompleteState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCommandsDefinitions=function createCommandsDefinitions(e){return e.reduce((e,t)=>{return{commands:Object.assign(Object.assign({},e.commands),{[t]:(n=t,{createPayload:e=>e,processResults:(e,t)=>t,serverCommandName:n})})};var n},{commands:{}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(236),i=n(10),s=n(18),a=n(1),c=n(22),u=n(70),l=n(3),d=n(7),p=n(23),h=n(33);function isDescribesRel(e){return s.schemaManager.getFamilyTypeIds(a.PIM_FAMILY.DESCRIBES).includes(e.getTypeId())}t.createPIMDataFromF2DStructure=async function createPIMDataFromF2DStructure(e,t,n,s,m,y){e.beginBatch();const g=[];if(l.isString(t)&&(t=await e.getSpaceCollection(t,{fetch:!1})),void 0===y.lineageUrn&&void 0===y.projectUrn)throw new Error("At least either the lineage OR the project urn must be passed");let _,v;m&&(_=await e.getSnapshot(m,t,{fetch:!0}));const E=u.getPimSchemaFactory(e.pimGetSchemasVersion()).getVersionSnapshotPayload({wipVersionUrn:"PlaceHolder:"+m,incompleteState:"local-journal",description:y.description});if(_){p.populateEntity(_,E);const e=await c.getAllPages(_.getAssets(),"getAssets");for(const t of e)await t.fetch(),h.getFamily(t)===a.PIM_FAMILY.DOCUMENTATION&&(v=t);console.log("Snapshots found with attribute: ",`localSnapshot: { typeid: 'String', value: ${m} }`)}else{if(console.log("No snapshot found for this journal"),void 0===y.lineageUrn&&void 0===y.projectUrn)throw new Error("Either lineageUrn or project Urn must be set");const s=[];let c;y.lineageUrn&&(c=await o.getSheetsFromLineage(e,t,y.lineageUrn));let l=!1;if(c&&c.length){const t=await c[0].getSpace({fetch:!1,assumeTypeId:r.assetGraphTypeId}),o=(await t.getClosureV2({startAssets:[{asset:c[0],snapshotContext:_}],maxDepth:2,relationshipFilters:[{direction:"IN",type:{name:a.PIM_CONTAINS_RELATIONSHIP_TYPENAME}}],include:{assetAttributes:!0,assetComponents:!0,relationshipAttributes:!1,relationshipComponents:!1}})).getAssets(),m=o.filter(e=>h.getFamily(e)===a.PIM_FAMILY.DRAWING),y=o.filter(e=>h.getFamily(e)===a.PIM_FAMILY.DOCUMENTATION);if(m.length&&y.length){v=y[0],s.push({id:y[0].getId(),revisionId:y[0].getRevisionId()},{id:m[0].getId(),revisionId:m[0].getRevisionId()},{id:c[0].getId(),revisionId:c[0].getRevisionId()});const t=m[0].getAttribute(i.AttributeKeys.DRAWING_NAME);let r=!1;if(n.drawingName&&t&&t!==n.drawingName?(m[0].updateAttribute(i.AttributeKeys.DRAWING_NAME,n.drawingName),r=!0):n.drawingName&&null==t&&(m[0].createAttribute(i.AttributeKeys.DRAWING_NAME,"String",n.drawingName),r=!0),r){const t=u.getDocumentationStructurePayload(e.pimGetSchemasVersion(),n);e.beginBatch(),p.populateEntity(m[0],t.drawing);const r=await e.endBatch();d.validateBatchResult(r)}l=!0}}if(!l){const o=u.getDocumentationStructurePayload(e.pimGetSchemasVersion(),n);e.beginBatch();const i=await e.pimCreateDocumentationStructure(t,o,[{name:r.PermissionContextName.PIM_CONTEXT,type:r.PermissionContextType.WIP_URN,value:y.lineageUrn||y.projectUrn}],{skipCommit:!0,skipValidation:!0});g.push(i.documentationSpace);const a=await e.endBatch();d.validateBatchResult(a),v=i.documentation,function listAssets(e,t){e.push({id:t.documentation.getId(),revisionId:t.documentation.getRevisionId()},{id:t.drawing.getId(),revisionId:t.drawing.getRevisionId()},{id:t.sheets.getId(),revisionId:t.sheets.getRevisionId()})}(s,i)}_=(await e.pimCreateSnapshot(t,s,E)).snapshot}if(!v)throw new Error("Could not find root asset in drawing version snaphot "+m);const I=(await c.getAllPages(t.getRelationships({filter:{fromSnapshot:_.getId()}}),"getRelationships")).filter(isDescribesRel);await Promise.all(I.map(e=>e.delete()));const b=await c.getAllPages(_.getAssets({filter:{"type.name":a.PIM_SHEETS_ASSETS_TYPENAME}}),"getAssets");if(!b.length)throw new Error("No sheets found to create describes from");if(Object.keys(s).length)for(const n of Object.entries(s))n.length&&await e.pimCreateDescribes(t,b[0],n[0],_,n[1]);return await e.endBatch(),{snapshot:_,rootItem:v,newSpaceIds:g.map(e=>e.getId())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(235),o=n(10),i=n(43),s=n(70),a=n(18),c=n(1),u=n(27);async function completeVersionSnapshot(e,t,n,l){if(l){r.setEntityAttribute(t,o.AttributeKeys.INCOMPLETE,o.IncompleteState.ERROR),r.setEntityAttribute(t,o.AttributeKeys.ERROR_CODE,l.errorCode.id);const n=a.getSchemaManager(e.pimGetSchemasVersion());t.createComponent(o.ComponentKeys.ERROR_STATUS,n.getFamilyTypeId(c.PIM_COMPONENT_FAMILY.ERROR_STATUS)).setValues({code:l.errorCode.id,message:l.errorCode.description})}else r.setEntityAttribute(t,o.AttributeKeys.INCOMPLETE,o.IncompleteState.COMPLETE);if(!l||l.addVersionComponent){const n=s.getPimSchemaFactory(e.pimGetSchemasVersion()).getVersionSnapshotComponentMap(),r=Object.keys(n);for(const e of r)i.setComponent(t,e,n[e])}u.addAdditionalInfo([t],n),await t.save()}t.completeVersionSnapshot=completeVersionSnapshot,t.moveToNextIncompleteState=async function moveToNextIncompleteState(e,t,n,r,i){n&&n===o.IncompleteState.ERROR&&await completeVersionSnapshot(e,t,r,i),n&&n!==o.IncompleteState.COMPLETE?(t.updateAttribute(o.AttributeKeys.INCOMPLETE,n),u.addAdditionalInfo([t],r),await t.save()):await completeVersionSnapshot(e,t,r)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(9),i=n(1),s=n(17),a=n(23),c=n(3),u=n(7),l=n(52),d=n(27);u.failIfExistsOnSDK("pimCreateChildProductRelationship"),r.FDModelingSDK.prototype.pimCreateChildProductRelationship=async function(e,t,n,r,p){r=r||{};const h=l.getSkipValidation(p);if(c.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),t=await o.toAsset(this,e,t,{fetch:!h}),n=await o.toAsset(this,e,n,{fetch:!h}),!h){if(!await l.createChildProductRelationshipValidator(e,t,n))throw new s.PimError(s.GEN_ERROR_COMMAND,"Could not create the child product relationship on this asset")}const m=r&&r.productProductContains&&r.productProductContains.typeid||i.schemaTypes.Product_RelationshipContains_V2_0_0.typeid,y=t.createRelationship(n,m);if(p&&p.additionalInfo&&d.addAdditionalInfo([y],p.additionalInfo),a.populateEntity(y,r.productProductContains),!u.getSkipCommit(p)){const e=await y.save();u.validateRequestResult(e)}return{contains:y}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1),i=n(17),s=n(23),a=n(3),c=n(4),u=n(52),l=n(90),d=n(32),p=n(4),h=n(18),m=n(27);c.failIfExistsOnSDK("pimCreateChildProductStructure"),r.FDModelingSDK.prototype.pimCreateChildProductStructure=async function(e,t,n,r,y){n=n||{};const g=u.getSkipValidation(y);if(a.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),t=await p.toAsset(this,e,t,{fetch:!g}),!g){if(!await u.createChildProductStructureValidator(t))throw new i.PimError(i.GEN_ERROR_COMMAND,"Could not create the child product structure on this asset")}const _=c.getSkipCommit(y);let v;_||this.beginBatch(),v=r?l.createSpace(e,{schemasVersion:this._pimData.schemasVersion,accessPolicyId:d.PIMServiceAccessPolicyId,permissionContext:r,additionalInfo:y&&y.additionalInfo}):l.createSpace(e,{schemasVersion:this._pimData.schemasVersion,additionalInfo:y&&y.additionalInfo});const E=h.getSchemaManager(this._pimData.schemasVersion),I=n&&n.product&&n.product.typeid||E.getFamilyTypeId(o.PIM_FAMILY.PRODUCT,this.pimGetSchemasVersion()),b=n&&n.design&&n.design.typeid||E.getFamilyTypeId(o.PIM_FAMILY.DESIGN,this.pimGetSchemasVersion()),S=n&&n.model&&n.model.typeid||E.getFamilyTypeId(o.PIM_FAMILY.MODEL,this.pimGetSchemasVersion()),C=n&&n.productDesignContains&&n.productDesignContains.typeid||E.getFamilyTypeId(o.PIM_FAMILY.CONTAINS,this.pimGetSchemasVersion()),w=n&&n.designModelContains&&n.designModelContains.typeid||E.getFamilyTypeId(o.PIM_FAMILY.CONTAINS,this.pimGetSchemasVersion()),A=n&&n.productProductContains&&n.productProductContains.typeid||E.getFamilyTypeId(o.PIM_FAMILY.CONTAINS,this.pimGetSchemasVersion()),O=v.createAsset(I),P=v.createAsset(b),D=v.createAsset(S),x=O.createRelationship(P,C),R=P.createRelationship(D,w),N=t.createRelationship(O,A);if(y&&y.additionalInfo&&m.addAdditionalInfo([O,P,D,x,R,N],y.additionalInfo),s.populateEntity(O,n.product),s.populateEntity(P,n.design),s.populateEntity(D,n.model),s.populateEntity(x,n.productDesignContains),s.populateEntity(R,n.designModelContains),s.populateEntity(N,n.productProductContains),!_){const e=await this.endBatch();try{c.validateBatchResult(e)}catch(e){throw await c.purgeEntities([N,v],a.getLogger(this)),e}}return{productSpace:v,product:O,design:P,model:D,productDesignContains:x,designModelContains:R,productProductContains:N}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(9),i=n(1),s=n(17),a=n(23),c=n(3),u=n(7),l=n(52),d=n(18),p=n(27);u.failIfExistsOnSDK("pimCreateDescribes"),r.FDModelingSDK.prototype.pimCreateDescribes=async function(e,t,n,r,h,m,y){m=m||{};const g=l.getSkipValidation(y),_=void 0!==(v=y)&&void 0!==v.skipCommit&&v.skipCommit;var v;if(c.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),t=await o.toAsset(this,e,t,{fetch:!g}),n=await o.toAsset(this,e,n,{fetch:!g}),!g){if(!await l.createDescribesValidator(t,n))throw new s.PimError(s.GEN_ERROR_COMMAND,"Could not create the describes on this asset")}const E=d.getSchemaManager(this._pimData.schemasVersion),I=m&&m.describes&&m.describes.typeid||E.getFamilyTypeId(i.PIM_FAMILY.DESCRIBES,this.pimGetSchemasVersion());_||this.beginBatch();const b=t.createPinnedRelationship(n,{toSnapshotId:h,fromSnapshotId:r,typeId:I});if(y&&y.additionalInfo&&p.addAdditionalInfo([b],y.additionalInfo),a.populateEntity(b,m.describes),!_){const e=await this.endBatch();u.validateBatchResult(e)}return{describes:b}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(9),i=n(1),s=n(17),a=n(23),c=n(3),u=n(7),l=n(52);u.failIfExistsOnSDK("pimCreateDesign"),r.FDModelingSDK.prototype.pimCreateDesign=async function(e,t,n,r){n=n||{};const d=l.getSkipValidation(r);if(c.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),t=await o.toAsset(this,e,t,{fetch:!d}),!d){if(!await l.createDesignValidator(t))throw new s.PimError(s.GEN_ERROR_COMMAND,"Could not create the design on this asset")}this.beginBatch(),t.spaceId||await t.fetch();const p=await t.getSpace(),h=n&&n.design&&n.design.typeid||i.schemaTypes.Product_AssetsDesign_V5_0_0.typeid,m=n&&(n.productDesignContains||n.productDesignRelationship),y=m&&m.typeid||i.schemaTypes.Product_RelationshipContains_V2_0_0.typeid,g=p.createAsset(h),_=t.createRelationship(g,y);a.populateEntity(g,n.design),a.populateEntity(_,m);const v=await this.endBatch();return u.validateBatchResult(v),{design:g,containsRelationship:_}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1);n(7).failIfExistsOnSDK("pimCreateDocumentation"),r.FDModelingSDK.prototype.pimCreateDocumentation=async function(e,t,n){const r=(t=t||{}).documentation,{documentationSpace:i,item:s}=await this.pimCreateDocumentationItem(e,{item:{typeid:o.schemaTypes.Product_AssetsDocumentation_V1_0_0.typeid,components:r?r.components:{},attributes:r?r.attributes:{}}},n);return{documentationSpace:i,documentation:s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1),i=n(23),s=n(3),a=n(7),c=n(90),u=n(32);a.failIfExistsOnSDK("pimCreateDocumentationItem"),r.FDModelingSDK.prototype.pimCreateDocumentationItem=async function(e,t,n){let r;s.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),this.beginBatch(),r=n?c.createSpace(e,{schemasVersion:this._pimData.schemasVersion,accessPolicyId:u.PIMServiceAccessPolicyId,permissionContext:n}):c.createSpace(e,{schemasVersion:this._pimData.schemasVersion});const l=t&&t.item&&t.item.typeid||o.schemaTypes.Product_AssetsDocumentation_V1_0_0.typeid,d=r.createAsset(l);i.populateEntity(d,t.item);const p=await this.endBatch();return a.validateBatchResult(p),{documentationSpace:r,item:d}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1),i=n(23),s=n(3),a=n(4),c=n(90),u=n(32),l=n(27);a.failIfExistsOnSDK("pimCreateDocumentationStructure"),r.FDModelingSDK.prototype.pimCreateDocumentationStructure=async function(e,t,n,r){s.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),t=t||{};const d=a.getSkipCommit(r);d||this.beginBatch();const p=r&&r.additionalInfo;let h;h=n?c.createSpace(e,{schemasVersion:this._pimData.schemasVersion,accessPolicyId:u.PIMServiceAccessPolicyId,permissionContext:n,additionalInfo:p}):c.createSpace(e,{schemasVersion:this._pimData.schemasVersion,additionalInfo:p});const m=t&&t.documentation&&t.documentation.typeid||o.schemaTypes.Product_AssetsDocumentation_V1_0_0.typeid,y=t&&t.drawing&&t.drawing.typeid||o.schemaTypes.Product_AssetsDrawing_V3_0_0.typeid,g=t&&t.sheets&&t.sheets.typeid||o.schemaTypes.Product_AssetsSheets_V1_0_0.typeid,_=t&&t.documentationDrawingContains&&t.documentationDrawingContains.typeid||o.schemaTypes.Product_RelationshipContains_V2_0_0.typeid,v=t&&t.drawingSheetsContains&&t.drawingSheetsContains.typeid||o.schemaTypes.Product_RelationshipContains_V2_0_0.typeid,E=h.createAsset(m),I=h.createAsset(y),b=h.createAsset(g),S=E.createRelationship(I,_),C=I.createRelationship(b,v);if(r&&r.additionalInfo&&l.addAdditionalInfo([E,I,b,S,C],r.additionalInfo),i.populateEntity(E,t.documentation),i.populateEntity(I,t.drawing),i.populateEntity(b,t.sheets),i.populateEntity(S,t.documentationDrawingContains),i.populateEntity(C,t.drawingSheetsContains),!d){const e=await this.endBatch();try{a.validateBatchResult(e)}catch(e){const t=s.getLogger(this);throw a.purgeEntities([S,C,h],t),e}}return{documentationSpace:h,documentation:E,drawing:I,sheets:b,documentationDrawingContains:S,drawingSheetsContains:C}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(9),i=n(1),s=n(17),a=n(23),c=n(3),u=n(7),l=n(52);u.failIfExistsOnSDK("pimCreateDrawing"),r.FDModelingSDK.prototype.pimCreateDrawing=async function(e,t,n,r){n=n||{};const d=l.getSkipValidation(r);if(c.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),t=await o.toAsset(this,e,t,{fetch:!d}),!d){if(!await l.createDrawingValidator(t))throw new s.PimError(s.GEN_ERROR_COMMAND,"Could not create the drawing on this asset")}this.beginBatch(),t.spaceId||await t.fetch();const p=await t.getSpace(),h=n&&n.drawing&&n.drawing.typeid||i.schemaTypes.Product_AssetsDrawing_V3_0_0.typeid,m=n&&n.documentationDrawingContains,y=m&&m.typeid||i.schemaTypes.Product_RelationshipContains_V2_0_0.typeid,g=p.createAsset(h),_=t.createRelationship(g,y);a.populateEntity(g,n.drawing),a.populateEntity(_,m);const v=await this.endBatch();return u.validateBatchResult(v),{drawing:g,containsRelationship:_}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1),i=n(23),s=n(3),a=n(7),c=n(90),u=n(32),l=n(18);a.failIfExistsOnSDK("pimCreateItem"),r.FDModelingSDK.prototype.pimCreateItem=async function(e,t,n){let r;s.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),this.beginBatch(),r=n?c.createSpace(e,{schemasVersion:this._pimData.schemasVersion,accessPolicyId:u.PIMServiceAccessPolicyId,permissionContext:n}):c.createSpace(e,{schemasVersion:this._pimData.schemasVersion});const d=l.getSchemaManager(this._pimData.schemasVersion),p=t&&t.item&&t.item.typeid||d.getFamilyTypeId(o.PIM_FAMILY.ITEM,this.pimGetSchemasVersion()),h=r.createAsset(p);i.populateEntity(h,t.item);const m=await this.endBatch();return a.validateBatchResult(m),{productSpace:r,item:h}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(9),i=n(1),s=n(17),a=n(23),c=n(3),u=n(7),l=n(52);u.failIfExistsOnSDK("pimCreateModel"),r.FDModelingSDK.prototype.pimCreateModel=async function(e,t,n,r){n=n||{};const d=l.getSkipValidation(r);if(c.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),t=await o.toAsset(this,e,t,{fetch:!d}),!d){if(!await l.createModelValidator(t))throw new s.PimError(s.GEN_ERROR_COMMAND,"Could not create the model on this asset")}this.beginBatch(),t.spaceId||await t.fetch();const p=await t.getSpace(),h=n&&n.model&&n.model.typeid||i.schemaTypes.Product_AssetsModel_V1_0_0.typeid,m=n&&(n.designModelContains||n.designModelRelationship),y=m&&m.typeid||i.schemaTypes.Product_RelationshipContains_V2_0_0.typeid,g=p.createAsset(h),_=t.createRelationship(g,y);a.populateEntity(g,n.model),a.populateEntity(_,m);const v=await this.endBatch();return u.validateBatchResult(v),{model:g,containsRelationship:_}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1),i=n(7),s=n(18);i.failIfExistsOnSDK("pimCreateProduct"),r.FDModelingSDK.prototype.pimCreateProduct=async function(e,t,n){const r=(t=t||{}).product||t.item,i=s.getSchemaManager(this._pimData.schemasVersion),{productSpace:a,item:c}=await this.pimCreateItem(e,{item:{typeid:t.product&&t.product.typeid||i.getFamilyTypeId(o.PIM_FAMILY.PRODUCT,this.pimGetSchemasVersion()),components:r?r.components:{},attributes:r?r.attributes:{}}},n);return{productSpace:a,product:c}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(18),i=n(1),s=n(32),a=n(23),c=n(90),u=n(3),l=n(4),d=n(27);l.failIfExistsOnSDK("pimCreateProductStructure"),r.FDModelingSDK.prototype.pimCreateProductStructure=async function(e,t,n,r){u.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),t=t||{};const p=l.getSkipCommit(r);p||this.beginBatch();const h=r&&r.additionalInfo;let m;m=n?c.createSpace(e,{schemasVersion:this._pimData.schemasVersion,accessPolicyId:s.PIMServiceAccessPolicyId,permissionContext:n,additionalInfo:h}):c.createSpace(e,{schemasVersion:this._pimData.schemasVersion,additionalInfo:h});const y=o.getSchemaManager(this._pimData.schemasVersion),g=t&&t.product&&t.product.typeid||y.getFamilyTypeId(i.PIM_FAMILY.PRODUCT,this.pimGetSchemasVersion()),_=t&&t.design&&t.design.typeid||y.getFamilyTypeId(i.PIM_FAMILY.DESIGN,this.pimGetSchemasVersion()),v=t&&t.model&&t.model.typeid||y.getFamilyTypeId(i.PIM_FAMILY.MODEL,this.pimGetSchemasVersion()),E=t&&t.productDesignContains&&t.productDesignContains.typeid||y.getFamilyTypeId(i.PIM_FAMILY.CONTAINS,this.pimGetSchemasVersion()),I=t&&t.designModelContains&&t.designModelContains.typeid||y.getFamilyTypeId(i.PIM_FAMILY.CONTAINS,this.pimGetSchemasVersion()),b=m.createAsset(g),S=m.createAsset(_),C=m.createAsset(v),w=b.createRelationship(S,E),A=S.createRelationship(C,I);if(r&&r.additionalInfo&&d.addAdditionalInfo([b,S,C,w,A],r.additionalInfo),a.populateEntity(b,t.product),a.populateEntity(S,t.design),a.populateEntity(C,t.model),a.populateEntity(w,t.productDesignContains),a.populateEntity(A,t.designModelContains),!p){const e=await this.endBatch();try{l.validateBatchResult(e)}catch(e){throw await l.purgeEntities([m],u.getLogger(this)),e}}return{productSpace:m,product:b,design:S,model:C,productDesignContains:w,designModelContains:A}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(9),i=n(43),s=n(3),a=n(7),c=n(17),u=n(1),l=n(89);a.failIfExistsOnSDK("pimRestore"),r.FDModelingSDK.prototype.pimRestore=async function(e,t,n){s.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),t=await o.toAsset(this,e,t,{fetch:!1});const r=await this.pimGetModelFromProduct(e,t);if(!r)throw new c.PimError(c.GEN_ERROR_COMMAND,"Model not found");a.getSkipCommit(n)||this.beginBatch();const d=l.getSchemaManager(this.pimGetSchemasVersion()).getFamilyTypeId(u.PIM_COMPONENT_FAMILY.DELETE_STATUS);if(i.restoreEntity(r,d),!a.getSkipCommit(n)){const e=await this.endBatch();a.validateBatchResult(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(9),i=n(7),s=n(1),a=n(18),c=n(114),u=n(4),l=n(3),d=n(3);i.failIfExistsOnSDK("pimRestoreDocument"),r.FDModelingSDK.prototype.pimRestoreDocument=async function(e,t,n,r){e=await o.toSpaceCollection(this,e);const p=await u.getAllPages(e.getAssets({filter:{"attribute.wipLineageUrn":t,"type.name":n}}),"getAssets"),h=this._pimData.connectOptions.maxCommandsInParallel?this._pimData.connectOptions.maxCommandsInParallel:u.DEFAULT_MAX_COMMANDS_IN_PARALLEL,m=l.chunk(p,h);for(const t of m){const n=l.chunk(t,u.BATCH_LIMIT);await Promise.all(n.map(async t=>{const n=this.getNewInstanceExperimental();await d.retry(async()=>{n.beginBatch(),await Promise.all(t.map(async t=>{t=await n.getAsset(t.getId(),e,{fetch:!0}),u.setComponent(t,c.ComponentKeys.DELETE_STATUS,{typeid:a.SchemasVersions[this.pimGetSchemasVersion()][s.PIM_COMPONENT_FAMILY.DELETE_STATUS].typeid,value:{file:!1}}),u.removeDeleteStatus(t)}));const r=await n.endBatch();i.validateBatchResult(r)})}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(9),i=n(1),s=n(17),a=n(23),c=n(3),u=n(7),l=n(52);u.failIfExistsOnSDK("pimCreateSheets"),r.FDModelingSDK.prototype.pimCreateSheets=async function(e,t,n,r){n=n||{};const d=l.getSkipValidation(r);if(c.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),t=await o.toAsset(this,e,t,{fetch:!d}),!d){if(!await l.createSheetsValidator(t))throw new s.PimError(s.GEN_ERROR_COMMAND,"Could not create the sheets on this asset")}this.beginBatch(),t.spaceId||await t.fetch();const p=await t.getSpace(),h=n&&n.sheets&&n.sheets.typeid||i.schemaTypes.Product_AssetsSheets_V1_0_0.typeid,m=n&&n.drawingSheetsContains,y=m&&m.typeid||i.schemaTypes.Product_RelationshipContains_V2_0_0.typeid,g=p.createAsset(h),_=t.createRelationship(g,y);a.populateEntity(g,n.sheets),a.populateEntity(_,m);const v=await this.endBatch();return u.validateBatchResult(v),{sheets:g,containsRelationship:_}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(9),i=n(43),s=n(17),a=n(3),c=n(7),u=n(1),l=n(89);c.failIfExistsOnSDK("pimSoftDelete"),r.FDModelingSDK.prototype.pimSoftDelete=async function(e,t,n){a.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),t=await o.toAsset(this,e,t);const r=await this.pimGetModelFromProduct(e,t);if(!r)throw new s.PimError(s.GEN_ERROR_COMMAND,"Model not found");c.getSkipCommit(n)||this.beginBatch();const d=l.getSchemaManager(this.pimGetSchemasVersion()).getFamilyTypeId(u.PIM_COMPONENT_FAMILY.DELETE_STATUS);if(i.softDeleteEntity(r,d),!c.getSkipCommit(n)){const e=await this.endBatch();c.validateBatchResult(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(9),i=n(7),s=n(1),a=n(18),c=n(114),u=n(23),l=n(4),d=n(3),p=n(3);i.failIfExistsOnSDK("pimSoftDeleteDocument"),r.FDModelingSDK.prototype.pimSoftDeleteDocument=async function(e,t,n,r){e=await o.toSpaceCollection(this,e);const h=await l.getAllPages(e.getAssets({filter:{"attribute.wipLineageUrn":t,"type.name":n}}),"getAssets"),m=this._pimData.connectOptions.maxCommandsInParallel?this._pimData.connectOptions.maxCommandsInParallel:l.DEFAULT_MAX_COMMANDS_IN_PARALLEL,y=d.chunk(h,m);for(const t of y){const n=d.chunk(t,l.BATCH_LIMIT);await Promise.all(n.map(async t=>{const n=this.getNewInstanceExperimental();await p.retry(async()=>{n.beginBatch(),await Promise.all(t.map(async t=>{t=await n.getAsset(t.getId(),e,{fetch:!0}),u.populateEntity(t,{components:{[c.ComponentKeys.DELETE_STATUS]:{typeid:a.SchemasVersions[this.pimGetSchemasVersion()][s.PIM_COMPONENT_FAMILY.DELETE_STATUS].typeid,value:{file:!0}}}})}));const r=await n.endBatch();i.validateBatchResult(r)})}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(10),i=n(1),s=n(4),a=n(23),c=n(3),u=n(7),l=n(27),addAssetsToSnapshot=async(e,t,n)=>{if(t.forEach(t=>{e.addVersionedAsset(t.id,t.revisionId?t.revisionId:null)}),!n){const t=await e.save();u.validateRequestResult(t)}};u.failIfExistsOnSDK("pimCreateSnapshot"),r.FDModelingSDK.prototype.pimCreateSnapshot=async function(e,t,n,r,u){e=c.isString(e)?await this.getSpaceCollection(e):e;const d=n&&n.typeid||i.schemaTypes.Product_Snapshot_V1_0_0.typeid,p=e.createSnapshot(d);p.createAttribute(o.AttributeKeys.SCHEMAS_VERSION,"String",this.pimGetSchemasVersion()),l.addAdditionalInfo([p],r,!0),a.populateEntity(p,n);const h=c.chunk(t,s.BATCH_LIMIT);if(await addAssetsToSnapshot(p,h.length?h[0]:[],u||!1),h.length>1){const t=p.getId(),n=e.getId(),r=h.slice(1),o=this._pimData.connectOptions.maxCommandsInParallel?this._pimData.connectOptions.maxCommandsInParallel:s.DEFAULT_MAX_COMMANDS_IN_PARALLEL,i=c.chunk(r,Math.floor(o/s.BATCH_LIMIT));for(const e of i)await Promise.all(e.map(async e=>{const r=this.getNewInstanceExperimental(),o=await r.getSnapshot(t,n,{fetch:!1});await addAssetsToSnapshot(o,e,u||!1)}));await p.fetch()}return{snapshot:p}}},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=n(4),i=r(n(68)),s=n(10),a=n(233);t.validateProductStructure=async function validateProductStructure(e,t,n){const r=await o.toSpaceCollection(e,t),c=await async function getModelAssets(e,t,n){return await o.getAllPages(t.getAssets({filter:{"attribute.wipLineageUrn":n,"type.name":a.PIM_MODEL_ASSETS_TYPENAME}}),"getAssets")}(0,r,n);if(!c||0===c.length)throw new o.PimError(i.NOT_FOUND_MODEL);const u={};c.forEach(e=>{const t=e.getAttribute(s.AttributeKeys.F3D_COMPONENT_ID);if(!t){const t=`No attribute ${s.AttributeKeys.F3D_COMPONENT_ID} in model: ${e.getId()}`;throw new o.PimError(i.INVALID_MODEL,t)}const n=u[t];if(n){const r=`Same attribute ${s.AttributeKeys.F3D_COMPONENT_ID}: ${t} in two models: ${e.getId()}, ${n.getId()}`;throw new o.PimError(i.MULTI_MODELS_OF_SAME_F3DCOMPONENT,r)}u[t]=e});const l=await async function getIncompleteModelAssets(e,t,n){return await o.getAllPages(t.getAssets({filter:{"attribute.wipLineageUrnTmp":n,"type.name":a.PIM_MODEL_ASSETS_TYPENAME}}),"getAssets")}(0,r,n);if(l&&l.length>0){const e="Incomplete model assets: "+l.map(e=>e.getId());throw new o.PimError(i.HAS_INCOMPLETE_MODEL_ASSETS,e)}}},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=n(4),i=r(n(68)),s=n(239),a=n(10);function getSnapshotsInfo(e){const t=[];return e.forEach(e=>{const n=e.getId(),r=e.getAttribute(a.AttributeKeys.INCOMPLETE);t.push({snapshotId:n,incomplete:r})}),JSON.stringify(t)}t.validateVersionSnapshot=async function validateVersionSnapshot(e,t,n){const r=await o.toSpaceCollection(e,t),a=await s.getVersionSnapshots(e,r,n,!0);if(!a||0==a.length)throw new o.PimError(i.NOT_FOUND_VERSION_SNAPSHOT);const c=[],u=[];if(a.forEach(e=>{e.getComponent("version")?c.push(e):u.push(e)}),0==c.length)throw new o.PimError(i.NO_VALID_VERSION_SNAPSHOT,getSnapshotsInfo(a));if(c.length>1)throw new o.PimError(i.MULTI_VALID_VERSION_SNAPSHOTS,getSnapshotsInfo(a));if(a.length>1)throw new o.PimError(i.HAS_INCOMPLETE_VERSION_SNAPSHOTS,getSnapshotsInfo(a));return c[0]}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),i=r(n(62)),s=n(495),a=n(17),c=n(7),u=n(1145),l=u.ADSK_PACKAGE_INFO.version;async function getToken(e){const t=e._pimData.connectOptions;if(!t||!t.getToken)throw new a.PimError(a.GEN_INVALID_INPUT,"No token function provided");return await t.getToken()}c.failIfExistsOnSDK("pimExecuteCommand"),o.FDModelingSDK.prototype.pimExecuteCommand=async function(e,t){const n=this._pimData.connectOptions;if(!n||!n.commandServerUrl)throw new a.PimError(a.COMMAND_SERVER_URL_NOT_PROVIDED);const r=n.commandServerUrl,o=t.requestContext,c=o&&o.requestId?o.requestId:s.uuid(),u=n&&n.logger?n.logger:console.info,d={authorization:"Bearer "+await getToken(this),"x-request-id":c,"x-client-pim-sdk-version":l,"X-Adsk-SpaceCollectionId":e};u(`Send command with x-request-id: ${c} and x-client-pim-sdk-version: ${l}`);try{const e=i.default.create({timeout:3e5}),{data:n}=await e.post(r,t,{headers:d});return n}catch(e){const n=e.response;if(!n)throw u(`And error occured while processing the command ${t.commandType}, ${e.message} with x-request-id: ${c} and x-client-pim-sdk-version: ${l}`),new a.PimError(a.GEN_ERROR_COMMAND,`Command ${t.commandType} execution failed, an error occured while processing the command: ${e.message}`,e);throw u(`And error occured while processing the command ${t.commandType}, ${n.status}: data=${n.data} with x-request-id: ${c} and x-client-pim-sdk-version: ${l}`),new a.PimError(a.GEN_ERROR_COMMAND,`Command ${t.commandType} execution failed, http status is ${n.status} (${n.statusText})`,e)}}},function(e,t,n){var r=n(1143),o=n(1144);e.exports=r("v5",80,o)},function(e,t,n){var r=n(240);e.exports=function(e,t,n){var generateUUID=function(e,o,i,s){var a=i&&s||0;if("string"==typeof e&&(e=function stringToBytes(e){e=unescape(encodeURIComponent(e));for(var t=new Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(e)),"string"==typeof o&&(o=function uuidToBytes(e){var t=[];return e.replace(/[a-fA-F0-9]{2}/g,(function(e){t.push(parseInt(e,16))})),t}(o)),!Array.isArray(e))throw TypeError("value must be an array of bytes");if(!Array.isArray(o)||16!==o.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var c=n(o.concat(e));if(c[6]=15&c[6]|t,c[8]=63&c[8]|128,i)for(var u=0;u<16;++u)i[a+u]=c[u];return i||r(c)};try{generateUUID.name=e}catch(e){}return generateUUID.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",generateUUID.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",generateUUID}},function(e,t,n){"use strict";var r=n(16);e.exports=function sha1(e){return"function"==typeof Buffer.from?Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")):Array.isArray(e)?e=new Buffer(e):"string"==typeof e&&(e=new Buffer(e,"utf8")),r.createHash("sha1").update(e).digest()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});try{t.ADSK_PACKAGE_INFO=n(1146)}catch(e){t.ADSK_PACKAGE_INFO={name:"<unknown-name>",version:"<unknown-version>",buildNumber:"<unknown-build-number>",revision:"unknown-revision",dependencies:{}}}},function(e,t,n){"use strict";e.exports={name:"@adsk/pim-sdk",version:"2.2.0",pimSolutionVersion:"<unknown-version>",buildNumber:"7",revision:"d1c1e079b1eba15119d298375466bdb64a5cd3cb",dependencies:{"@adsk/fdsdk-journal-interfaces":"0.9.9"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(3),i=n(7),s=n(1),a=n(4),c=n(498);i.failIfExistsOnSDK("pimGetAssemblyRefFromProduct"),r.FDModelingSDK.prototype.pimGetAssemblyRefFromProduct=async function(e,t,n,r){const i=Object.assign(Object.assign({},c.defaultXrefOptions),r);if(e=await a.toSpaceCollection(this,e,{fetch:!1}),i.boundaries===c.XrefBoundaries.SINGLE)return async function getSingleBoundaryAssemblyRefs(e,t,n,r){const i=await e.pimGetModelFromProduct(t,n,r);if(!i)return[];const c=o.isString(r)?r:r.getId();return a.getAllPages(t.getRelationships({filter:{fromAsset:i.getId(),fromSnapshot:c,"type.name":s.PIM_ASSEMBLYREF_RELATIONSHIP_TYPENAME}}),"getRelationships")}(this,e,t,n);if(i.boundaries===c.XrefBoundaries.SNAPSHOT)return async function getSnapshotBoundaryAssemblyRefs(e,t){const n=o.isString(t)?t:t.getId();return a.getAllPages(e.getRelationships({filter:{fromSnapshot:n,"type.name":s.PIM_ASSEMBLYREF_RELATIONSHIP_TYPENAME}}),"getRelationships")}(e,n);throw new Error("[pimGetAssemblyRefFromProduct] Unhandled XRef boundary: "+i.boundaries)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(58),i=n(4);function propertyFacade(e,t="",n=null){const r={childStores:{},property:e,parentStore:n,facade:null};return n&&(n.childStores[t]=r),r.facade=new Proxy(new Object,{get(e,t){if("symbol"==typeof t)return;if("typeid"===(t=t.toString()))return r.property.getTypeid();const n=r.property.get(t);return n?n instanceof o.ContainerProperty?(r.childStores[t]&&r.childStores[t].property===n||propertyFacade(n,t,r),r.childStores[t].facade):n.getValue():void 0},set(t,n,i){if("symbol"==typeof n)return!1;n=n.toString();const s=r.property.get(n);return!!s&&(!(s instanceof o.ContainerProperty&&s.isDynamic())&&(e.setValues({[n]:i}),!0))},defineProperty:()=>!1,getOwnPropertyDescriptor(e,t){if("symbol"!=typeof t)return"typeid"===(t=t.toString())?{configurable:!0,enumerable:!1,get:()=>this.get(e,t,void 0)}:void 0!==r.property.get(t)?{configurable:!0,enumerable:!0,get:()=>this.get(e,t,void 0),set:n=>{this.set(e,t,n,void 0)}}:void 0},ownKeys:()=>["typeid",...r.property.getIds()],has:(e,t)=>"symbol"!=typeof t&&("typeid"===(t=t.toString())||!!r.property.get(t))}),r.facade}t.propertyFacade=propertyFacade,r.FDModelingSDK.prototype.pimGetComponentProxy=function(e,t,n){const r=n?n.typeid:void 0,o=e.getComponent(t);if(!o)throw new i.PimError(i.GEN_COMPONENT_NOT_FOUND,`Component ${t} not found in object; requestedTypeid is ${r}; componentType is ${n}`);const s=o,a=s.getTypeid();if(r&&r!==a&&!i.isCompatibleWith(a,r))throw new i.PimError(i.GEN_INVALID_TYPEID,`Requested type ${r} is not compatible with the actual data type ${a}`);return propertyFacade(s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(3),i=n(7),s=n(33),a=n(1),c=n(22),u=n(9);i.failIfExistsOnSDK("pimGetDesignFromProduct"),r.FDModelingSDK.prototype.pimGetDesignFromProduct=async function(e,t,n){e=await u.toSpaceCollection(this,e,{fetch:!1}),t=await u.toAsset(this,e,t,{fetch:!0});const i={startAssets:[{asset:t}],relationshipFilters:[{type:{name:a.PIM_CONTAINS_RELATIONSHIP_TYPENAME},direction:"OUT"}],maxDepth:1,include:{assetAttributes:!0,assetComponents:!0}},l=(await t.getSpace({fetch:!1,assumeTypeId:r.assetGraphTypeId})).getClosureV2Traverser(i),d=[];if(await l.traverse(i.startAssets,async e=>{var t;return t=e.asset,s.getFamily(t)===a.PIM_FAMILY.DESIGN&&d.push(e.asset),r.TraversalAction.Continue}),n&&d.length){o.isString(n)&&(n=await this.getSnapshot(n,e,{fetch:!1}));const t=(await c.getAllPages(await n.getAssets({assetId:d[0]}),"getAssets")).find(e=>e.getId()===d[0].getId());if(t)return t.isFetched()||await t.fetch(),t}return d.length?d[0]:void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(3),i=n(7),s=n(33),a=n(9),c=n(1);i.failIfExistsOnSDK("pimGetProductFromDesign"),r.FDModelingSDK.prototype.pimGetProductFromDesign=async function(e,t,n){o.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),t=await a.toAsset(this,e,t,{fetch:!0});const r=await t.getSpace(),i={startAssets:[{asset:t,snapshotContext:n||void 0}],relationshipFilters:[{type:{name:c.PIM_CONTAINS_RELATIONSHIP_TYPENAME},direction:"IN"}],maxDepth:1,include:{assetAttributes:!0,assetComponents:!0}},u=(await r.getClosureV2(i)).getAssets().filter(e=>s.getFamily(e)===c.PIM_FAMILY.PRODUCT);return u.length?u[0]:void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(3),i=n(7),s=n(33),a=n(9),c=n(1);i.failIfExistsOnSDK("pimGetProductFromDrawing"),r.FDModelingSDK.prototype.pimGetProductFromDrawing=async function(e,t,n){o.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),t=await a.toAsset(this,e,t,{fetch:!0});const r=await t.getSpace(),i={startAssets:[{asset:t,snapshotContext:n}],relationshipFilters:[{type:{name:c.PIM_DESCRIBES_RELATIONSHIP_TYPENAME},direction:"OUT"},{type:{name:c.PIM_CONTAINS_RELATIONSHIP_TYPENAME},direction:"IN"},{type:{name:c.PIM_CONTAINS_RELATIONSHIP_TYPENAME},direction:"OUT"}],maxDepth:4,include:{assetAttributes:!0,assetComponents:!0}},u=(await r.getClosureV2(i)).getAssets().filter(e=>s.getFamily(e)===c.PIM_FAMILY.PRODUCT);return u.length?u[0]:void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(4),i=n(1);o.failIfExistsOnSDK("pimGetLatestReleaseData"),r.FDModelingSDK.prototype.pimGetLatestReleaseData=async function(e,t,n){e=await o.toSpaceCollection(this,e,{fetch:!0}),t=await o.toAsset(this,e,t,{fetch:!0});const r=await this.pimGetLifecycleData(e,t);if(!r)return{};const s=await o.getAllPages(e.getSnapshots({assetId:t.getId(),filter:{"attribute.wipVersionUrn":n,"has.component.type.name":i.PIM_REVISION_COMPONENTS_TYPENAME}}),"getSnapshots");if(0==s.length)return{lifecycleAsset:r};const a=s[s.length-1],c=await o.getAllPages(a.getAssets({filter:{"type.name":i.PIM_RELEASE_ASSETS_TYPENAME}}),"getAssets");if(1!=c.length)throw new o.PimError(o.UNEXPECTED_RELEASE_DATA,"An unexpected number of release assets were found: "+c.length);return await c[0].fetch(),{lifecycleAsset:r,releaseAsset:c[0]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1),i=n(4);i.failIfExistsOnSDK("pimGetLifecycleData"),r.FDModelingSDK.prototype.pimGetLifecycleData=async function(e,t){e=await i.toSpaceCollection(this,e,{fetch:!0});const n={startAssets:[{asset:(t=await i.toAsset(this,e,t,{fetch:!0})).getId()}],maxDepth:1,relationshipFilters:[{type:{name:o.PIM_CONTAINS_RELATIONSHIP_TYPENAME},direction:"OUT"}],include:{assetAttributes:!0,assetComponents:!0}},s=(await t.getSpace()).getClosureV2Traverser(n);let a;if(await s.traverse(n.startAssets,async e=>i.getFamilyFromTypeid(e.asset.getTypeId()).family===o.PIM_FAMILY.LIFECYCLE?(a=e.asset,r.TraversalAction.Abort):r.TraversalAction.Continue),a){const e=await a.getSpace({fetch:!0,assumeTypeId:r.assetGraphTypeId});if(i.getFamilyFromTypeid(e.getTypeId()).family!==o.PIM_FAMILY.PROCESS)throw new i.PimError(i.ILLEGAL_STATE_PROCESS_DATA_NOT_IN_PROCESS_SPACE,"Lifecycle asset found in the wrong space")}return a}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),i=r(n(499)),s=n(7),a=n(33),c=n(4),u=n(1),l=n(10),d=o.ClosureV2Traverser.START_ASSETS_COUNT_LIMIT;async function getAssetDataRelatedToDesignOrDrawing(e,t,n,r){const i=[u.PIM_FAMILY.DESIGN,u.PIM_FAMILY.MODEL,u.PIM_FAMILY.PRODUCT,u.PIM_FAMILY.RELEASE,u.PIM_FAMILY.LIFECYCLE],s=[u.PIM_FAMILY.DRAWING,u.PIM_FAMILY.DOCUMENTATION,u.PIM_FAMILY.SHEETS,u.PIM_FAMILY.RELEASE,u.PIM_FAMILY.LIFECYCLE],d=[u.PIM_DESIGN_ASSETS_TYPENAME,u.PIM_MODEL_ASSETS_TYPENAME,u.PIM_PRODUCT_ASSETS_TYPENAME,u.PIM_LIFECYCLE_ASSETS_TYPENAME,u.PIM_RELEASE_ASSETS_TYPENAME,u.PIM_DOCUMENTATION_ASSETS_TYPENAME,u.PIM_DRAWING_ASSETS_TYPENAME,u.PIM_SHEETS_ASSETS_TYPENAME],p=[u.PIM_FAMILY.DOCUMENTATION,u.PIM_FAMILY.PRODUCT],h=d.map(e=>({type:{name:e}})),m={startAssets:t,maxDepth:2,relationshipFilters:[{type:{name:u.PIM_CONTAINS_RELATIONSHIP_TYPENAME},direction:"IN"},{type:{name:u.PIM_CONTAINS_RELATIONSHIP_TYPENAME},direction:"OUT"},{type:{name:u.PIM_USE_RELATIONSHIP_TYPENAME},direction:"IN"}],assetFilters:h,include:{assetAttributes:r.includeAssetAttributes,assetComponents:r.includeAssetComponents}},y=[],g=await o.AssetGraph.getClosureV2(e,n,m),_=new o.ClosureV2Traverser(g),v={};t.forEach(e=>{v[e.snapshotContext.getId()]=""});const E=await n.getSnapshots({filter:{snapshotId:{$in:Object.keys(v)}},include:["snapshot_attributes"]});(await c.getAllPages(E,"getSnapshots")).forEach(e=>{if(e){const t=e.getAttribute(l.AttributeKeys.WIP_VERSION_URN);t&&(v[e.getId()]=t)}});const I=t.map(async e=>{const t={snapshotId:e.snapshotContext.getId(),wipVersionUrn:v[e.snapshotContext.getId()]||"",relatedAssets:[],rootAssetId:""},n=a.getFamily(e.asset)==u.PIM_FAMILY.MODEL?i:s;await _.traverse([{asset:e.asset,snapshotContext:e.snapshotContext}],e=>n.includes(a.getFamily(e.asset))?(p.includes(a.getFamily(e.asset))&&(t.rootAssetId=e.asset.getId()),t.relatedAssets.push(e.asset),Promise.resolve(o.TraversalAction.Continue)):Promise.resolve(o.TraversalAction.AbortThis)),y.push(t)});return await Promise.all(I),y}s.failIfExistsOnSDK("pimGetAssemblyAssetData"),o.FDModelingSDK.prototype.pimGetAssemblyAssetData=async function(e,t,n,r){const s=Object.assign({traverseRelatedItems:!0,includeAssetComponents:!0,includeAssetAttributes:!0},r),l=await c.toSpaceCollection(this,e,{fetch:!1});t=await c.toAsset(this,l,t,{fetch:!0});const p=a.getFamily(t);let h=[];if(p===u.PIM_FAMILY.DOCUMENTATION){const e=await this.pimGetSheetsFromDocumentation(l,t);if(!e)throw new c.PimError(c.NOT_FOUND_ASSET);h=e.map(e=>({asset:e,snapshotContext:n}))}else{if(p!==u.PIM_FAMILY.PRODUCT)throw new c.PimError(c.UNSUPPORTED_ASSET_TYPE);{const e=await this.pimGetModelFromProduct(l,t);if(!e)throw new c.PimError(c.NOT_FOUND_MODEL);h.push({asset:e,snapshotContext:n})}}let m=[];if(!s.traverseRelatedItems){const e=await c.toSnapshot(this,l,n,{fetch:!1});return await Promise.all(h.map(async t=>{const n=await getAssetDataRelatedToDesignOrDrawing(this,[{asset:t.asset,snapshotContext:e}],l,s);m=m.concat(n)})),m}const y={startAssets:h,maxDepth:0,relationshipFilters:[{type:{name:u.PIM_ASSEMBLYREF_RELATIONSHIP_TYPENAME},direction:"OUT"},{type:{name:u.PIM_DESCRIBES_RELATIONSHIP_TYPENAME},direction:"OUT"}],assetFilters:[{type:{name:u.PIM_MODEL_ASSETS_TYPENAME}}]},g=await o.AssetGraph.getClosureV2(this,l,y),_=g.getAssets().length;if(0==_)throw new c.PimError(c.NOT_FOUND_ASSET);const v=new o.ClosureV2Traverser(g),E=[];await v.traverse(y.startAssets,e=>{if(!e.asset)throw new c.PimError(c.NOT_FOUND_ASSET);if(!e.snapshotContext)throw new c.PimError(c.NOT_FOUND_SNAPSHOT);const t={snapshotContext:e.snapshotContext,asset:e.asset};return E.push(t),Promise.resolve(o.TraversalAction.Continue)},void 0);const I=_<100?5:20,b=new i.default({concurrency:I}),S=Math.ceil(_/d);for(let e=0;e<S;e++){const t=e===S-1?void 0:(e+1)*d,n=E.slice(e*d,t);b.add(async()=>{const e=await getAssetDataRelatedToDesignOrDrawing(this,n,l,s);m=m.concat(e)})}return await b.onIdle(),m}},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,o="~";function Events(){}function EE(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function addListener(e,t,n,r,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new EE(n,r||e,i),a=o?o+t:t;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],s]:e._events[a].push(s):(e._events[a]=s,e._eventsCount++),e}function clearEvent(e,t){0==--e._eventsCount?e._events=new Events:delete e._events[t]}function EventEmitter(){this._events=new Events,this._eventsCount=0}Object.create&&(Events.prototype=Object.create(null),(new Events).__proto__||(o=!1)),EventEmitter.prototype.eventNames=function eventNames(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(o?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},EventEmitter.prototype.listeners=function listeners(e){var t=o?o+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,i=n.length,s=new Array(i);r<i;r++)s[r]=n[r].fn;return s},EventEmitter.prototype.listenerCount=function listenerCount(e){var t=o?o+e:e,n=this._events[t];return n?n.fn?1:n.length:0},EventEmitter.prototype.emit=function emit(e,t,n,r,i,s){var a=o?o+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,i),!0;case 6:return l.fn.call(l.context,t,n,r,i,s),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var p,h=l.length;for(u=0;u<h;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,r);break;default:if(!c)for(p=1,c=new Array(d-1);p<d;p++)c[p-1]=arguments[p];l[u].fn.apply(l[u].context,c)}}return!0},EventEmitter.prototype.on=function on(e,t,n){return addListener(this,e,t,n,!1)},EventEmitter.prototype.once=function once(e,t,n){return addListener(this,e,t,n,!0)},EventEmitter.prototype.removeListener=function removeListener(e,t,n,r){var i=o?o+e:e;if(!this._events[i])return this;if(!t)return clearEvent(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||r&&!s.once||n&&s.context!==n||clearEvent(this,i);else{for(var a=0,c=[],u=s.length;a<u;a++)(s[a].fn!==t||r&&!s[a].once||n&&s[a].context!==n)&&c.push(s[a]);c.length?this._events[i]=1===c.length?c[0]:c:clearEvent(this,i)}return this},EventEmitter.prototype.removeAllListeners=function removeAllListeners(e){var t;return e?(t=o?o+e:e,this._events[t]&&clearEvent(this,t)):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prefixed=o,EventEmitter.EventEmitter=EventEmitter,e.exports=EventEmitter},function(e,t,n){"use strict";const r=n(1157);class TimeoutError extends Error{constructor(e){super(e),this.name="TimeoutError"}}const pTimeout=(e,t,n)=>new Promise((o,i)=>{if("number"!=typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void o(e);const s=setTimeout(()=>{if("function"==typeof n){try{o(n())}catch(e){i(e)}return}const r=n instanceof Error?n:new TimeoutError("string"==typeof n?n:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),i(r)},t);r(e.then(o,i),()=>{clearTimeout(s)})});e.exports=pTimeout,e.exports.default=pTimeout,e.exports.TimeoutError=TimeoutError},function(e,t,n){"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then(e=>new Promise(e=>{e(t())}).then(()=>e),e=>new Promise(e=>{e(t())}).then(()=>{throw e})))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1159);t.default=class PriorityQueue{constructor(){this._queue=[]}enqueue(e,t){const n={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(n);const o=r.default(this._queue,n,(e,t)=>t.priority-e.priority);this._queue.splice(o,0,n)}dequeue(){const e=this._queue.shift();return null==e?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(e=>e.run)}get size(){return this._queue.length}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function lowerBound(e,t,n){let r=0,o=e.length;for(;o>0;){const i=o/2|0;let s=r+i;n(e[s],t)<=0?(r=++s,o-=i+1):o=i}return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(3),i=n(7),s=n(33),a=n(1),c=n(22);i.failIfExistsOnSDK("pimGetModelFromDesign"),r.FDModelingSDK.prototype.pimGetModelFromDesign=async function(e,t,n){o.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),o.isString(t)&&(t=await this.getAsset(t,e,{fetch:!1}));const i={startAssets:[{asset:t}],relationshipFilters:[{type:{name:a.PIM_CONTAINS_RELATIONSHIP_TYPENAME},direction:"OUT"}],maxDepth:1,include:{assetAttributes:!0,assetComponents:!0}},u=(await t.getSpace({fetch:!1,assumeTypeId:r.assetGraphTypeId})).getClosureV2Traverser(i),l=[];if(await u.traverse(i.startAssets,async e=>{var t;return t=e.asset,s.getFamily(t)===a.PIM_FAMILY.MODEL&&l.push(e.asset),r.TraversalAction.Continue}),n&&l.length){o.isString(n)&&(n=await this.getSnapshot(n,e,{fetch:!1}));const t=(await c.getAllPages(await n.getAssets({assetId:l[0]}),"getAssets")).find(e=>e.getId()===l[0].getId());if(t)return t.isFetched()||await t.fetch(),t}return l.length?l[0]:void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1),i=n(4),s=n(17),a=n(33),c=n(9);n(7).failIfExistsOnSDK("pimGetModelFromProduct"),r.FDModelingSDK.prototype.pimGetModelFromProduct=async function(e,t,n){e=await c.toSpaceCollection(this,e,{fetch:!1}),t=await c.toAsset(this,e,t,{fetch:!0});const r=await t.getSpace(),u=(await r.getClosureV2({startAssets:[{asset:t,snapshotContext:n||void 0}],maxDepth:2,relationshipFilters:[{direction:"OUT",type:{name:o.PIM_CONTAINS_RELATIONSHIP_TYPENAME}}],include:{assetAttributes:!0,assetComponents:!0,relationshipAttributes:!1,relationshipComponents:!1}})).getAssets().filter(e=>(e=>a.getFamily(e)===o.PIM_FAMILY.MODEL)(e));if(1!==u.length)throw new s.PimError(s.GEN_INVALID_INPUT,"Unexpected number of model assets for a given product: "+u.length);return u[0].spaceCollectionId=i.extractId(e),u[0]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(3),i=n(7),s=n(9),a=n(1),c=n(33);i.failIfExistsOnSDK("pimGetDesignFromDocumentation"),r.FDModelingSDK.prototype.pimGetDrawingFromDocumentation=async function(e,t,n){o.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),t=await s.toAsset(this,e,t,{fetch:!0});const r=await t.getSpace(),i={startAssets:[{asset:t,snapshotContext:n||void 0}],maxDepth:2,relationshipFilters:[{direction:"OUT",type:{name:a.PIM_CONTAINS_RELATIONSHIP_TYPENAME}}],include:{assetAttributes:!0,assetComponents:!0,relationshipAttributes:!1,relationshipComponents:!1}},u=(await r.getClosureV2(i)).getAssets().filter(e=>c.getFamily(e)===a.PIM_FAMILY.DRAWING);return u.length?u[0]:void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(3),i=n(7),s=n(9),a=n(1),c=n(33);i.failIfExistsOnSDK("pimGetSheetsFromDrawing"),r.FDModelingSDK.prototype.pimGetSheetsFromDrawing=async function(e,t,n){o.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1}));const r=await s.toAsset(this,e,t,{fetch:!0}),i=await r.getSpace(),u={startAssets:[{asset:r,snapshotContext:n||void 0}],maxDepth:1,relationshipFilters:[{direction:"OUT",type:{name:a.PIM_CONTAINS_RELATIONSHIP_TYPENAME}}],include:{assetAttributes:!0,assetComponents:!0,relationshipAttributes:!1,relationshipComponents:!1}},l=(await i.getClosureV2(u)).getAssets().filter(e=>c.getFamily(e)===a.PIM_FAMILY.SHEETS);return l.length?l:void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(3),i=n(7),s=n(9),a=n(1),c=n(33);i.failIfExistsOnSDK("pimGetSheetsFromDocumentation"),r.FDModelingSDK.prototype.pimGetSheetsFromDocumentation=async function(e,t,n){o.isString(e)&&(e=await this.getSpaceCollection(e,{fetch:!1})),t=await s.toAsset(this,e,t,{fetch:!0});const r=await t.getSpace(),i={startAssets:[{asset:t,snapshotContext:n||void 0}],maxDepth:2,relationshipFilters:[{direction:"OUT",type:{name:a.PIM_CONTAINS_RELATIONSHIP_TYPENAME}}],include:{assetAttributes:!0,assetComponents:!0,relationshipAttributes:!1,relationshipComponents:!1}},u=(await r.getClosureV2(i)).getAssets().filter(e=>c.getFamily(e)===a.PIM_FAMILY.SHEETS);return u.length?u:void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(3),i=n(7),s=n(1),a=n(4);i.failIfExistsOnSDK("pimGetDescribesFromDocumentation"),r.FDModelingSDK.prototype.pimGetDescribesFromDocumentation=async function(e,t,n){e=await a.toSpaceCollection(this,e,{fetch:!1});const r=await this.pimGetSheetsFromDocumentation(e,t,n),i=[],c=o.isString(n)?n:n.getId();if(void 0!==r)for(const t of r){const n=await a.getAllPages(e.getRelationships({filter:{fromAsset:t.getId(),fromSnapshot:c,"type.name":s.PIM_DESCRIBES_RELATIONSHIP_TYPENAME}}),"getRelationships");i.push(...n)}return i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(4);o.failIfExistsOnSDK("pimGetRepresentation"),r.FDModelingSDK.prototype.pimGetRepresentation=function(e){const t=e.getAttributes(),n={};Object.getOwnPropertyNames(t).forEach(r=>{const i=e.getAttributeTypeId(r);if(!i)throw new o.PimError(o.GEN_INVALID_INPUT);n[r]={typeid:i,value:t[r]}});const r={};return e.listComponents().forEach(t=>{const n=e.getComponent(t);if(!n)throw new o.PimError(o.GEN_INVALID_INPUT);r[t]={typeid:n.getTypeid(),value:n.getValues()}}),{typeid:e.getTypeId(),attributes:n,components:r,revisionId:e.getRevisionId(),id:e.getId(),spaceCollectionId:e.getSpaceCollectionID()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1);n(7).failIfExistsOnSDK("pimLoadAssembly"),r.FDModelingSDK.prototype.pimLoadAssembly=async function(e,t,n){return this.pimGetTopology(e,t,n,{fetch:!0,strategy:o.TopologyStrategies.CLOSUREV2,type:o.TopologyTypes.AS_SAVED})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(88),i=n(17),s=n(7),a=n(1169),c=n(1170);s.failIfExistsOnSDK("pimGetTopology"),r.FDModelingSDK.prototype.pimGetTopology=async function(e,t,n,r){const s=Object.assign({type:o.TopologyTypes.FULL,strategy:o.TopologyStrategies.BRUTE_FORCE,fetch:!0},r);switch(s.strategy){case o.TopologyStrategies.BRUTE_FORCE:return a.bruteForceTopology(this,e,t,n,r);case o.TopologyStrategies.CLOSUREV2:if(!t)throw new i.PimError(i.GEN_NOT_IMPLEMENTED,"Topology strategy with closures v2 requires a starting asset");return c.closureV2Topology(this,e,t,n);default:throw new i.PimError(i.GEN_NOT_IMPLEMENTED,"Unknown options "+s.strategy)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1),o=n(88),i=n(17),s=n(22),a=n(9),c=n(3),u=n(500),l=n(115);t.bruteForceTopology=async function bruteForceTopology(e,t,n,d,p){const h=Object.assign({type:o.TopologyTypes.FULL,fetch:!0},p);if(h.type===o.TopologyTypes.AS_SAVED&&!d)throw new i.PimError(i.GEN_INVALID_INPUT,"A snapshot must be provided for the AS-SAVED topology type");if(h.type===o.TopologyTypes.AS_LATEST)throw new i.PimError(i.GEN_NOT_IMPLEMENTED);const m=h.cache?h.cache.visitedAssets:{},y=h.cache?h.cache.visitedRelationships:{},g=h.cache?h.cache.visitedSnapshots:{},_=h&&h.fetch;let v;v=c.isString(t)?await e.getSpaceCollection(t,{fetch:!1}):t;const E=[],fetchEntity=async e=>{const t=e;return e.isFetched()||t._isFetching||(t._isFetching=e.fetch().then(),E.push(t._isFetching)),t._isFetching},visitSnapshot=(e,t)=>{if(!e)return;const n=u.getTopoSnapshotId(e,t);if(g[n])return g[n];_&&fetchEntity(e);const r=g[n]={id:n,snapshot:e};return r._complete=(async()=>{const n=await s.getAllPages(e.getAssets(),"getAssets");t&&await fetchEntity(t);const o=n.map(t=>visitAsset(t,e)).filter(e=>e);r.assets=o,await Promise.all(o.map(e=>fetchEntity(e.asset)))})(),E.push(r._complete),r},visitRelationship=(t,n,i)=>{if(!t)return;const s=u.getTopoRelationshipId(t,i);if(y[s])return y[s];const c=y[s]={id:s,relationship:t};return c._complete=(async()=>{if(i&&t.fromSnapshotId&&t.fromSnapshotId!==i.getId())return;let s,d=i&&visitSnapshot(i,n);if(!d&&h.type===o.TopologyTypes.AS_SAVED&&(t.isFetched()||await fetchEntity(t),!function isContainsRelationship(e){const t=l.getFamilyFromTypeid(e);return!!t&&t.family===r.PIM_FAMILY.CONTAINS}(t.getTypeId())))return;if(t.toSnapshotId){const e=await t.getToSnapshot({fetch:!1});if(!e)return;const n=visitSnapshot(e);if(!n)return;await n._complete;const r=n.assets.find(e=>e.asset.getId()===t.toId);if(!r)return;s=r.asset}else{const e=await t.getTo({fetch:!1});if(!e)return;s=e}if(t.toSnapshotId){fetchEntity(s);const n=await a.toSnapshot(e,v,t.toSnapshotId,{fetch:!1});if(h.type===o.TopologyTypes.AS_SAVED&&(await fetchEntity(n),!function isVersionSnapshot(e){return e.listComponents().includes("version")}(n)))return;if(h.type===o.TopologyTypes.SNAPSHOT_CONSTRAINED&&i&&t.toSnapshotId!==i.getId())return;await fetchEntity(s),d=visitSnapshot(n,s)}else if(i){const e=g[u.getTopoSnapshotId(i)];if(e){await e._complete;if(!e.assets.find(e=>t.toId&&e.id===u.getTopoAssetId(t.toId,i))){if(h.type===o.TopologyTypes.AS_SAVED)return;d=void 0}}}_&&fetchEntity(t);const p=visitAsset(n,i);await fetchEntity(s);const m=visitAsset(s,d&&d.snapshot),y=i&&visitSnapshot(i,n);m&&p&&(p.outgoing.push(c),c.fromAsset=p,c.fromAssetSnapshot=y,c.toAsset=m,m.incoming.push(c),c.toAssetSnapshot=d)})(),E.push(c._complete),c};function visitAsset(e,t){const n=u.getTopoAssetId(e,t);if(m[n])return m[n];const r=m[n]={id:n,asset:e,incoming:[],outgoing:[]},o=t?visitSnapshot(t,e):void 0;r.snapshot=o;return r._complete=(async()=>{_&&fetchEntity(e);const n=v.getRelationships({fromAsset:e}),r=await s.getAllPages(n,"getRelationships");for(let n=0;n<r.length;n++){const o=r[n];t&&o.fromSnapshotId&&o.fromSnapshotId!==t.getId()||(!t&&o.fromSnapshotId||visitRelationship(o,e,t))}})(),E.push(r._complete),r}c.isString(d)&&(d=await e.getSnapshot(d,v,{fetch:!1}));let I,b=void 0;if(d)if(Array.isArray(d)){if(0===d.length)throw new i.PimError(i.GEN_INVALID_INPUT,"No snapshot provided in list");const t=(await Promise.all(d.map(t=>e.getSnapshot(s.extractId(t),v,{fetch:!1})))).map(e=>visitSnapshot(e)).filter(e=>e);if(await Promise.all(t.map(e=>e._complete)),b=t[0].snapshot,n){const e=s.extractId(n),r=t[0].assets.find(t=>t.asset.getId()===e);if(!r)throw new i.PimError(i.GEN_INVALID_INPUT,"Asset not in snapshot");n=r.asset}}else{b=await e.getSnapshot(s.extractId(d),v,{fetch:!1});const t=visitSnapshot(b);if(!t)throw new i.PimError(i.GEN_INVALID_INPUT,"Snapshot not found");if(await t._complete,n){const e=s.extractId(n),r=t.assets.find(t=>t.asset.getId()===e);if(!r)throw new i.PimError(i.GEN_INVALID_INPUT,"Asset not in snapshot");n=r.asset}}else if(n)n=await a.toAsset(e,v,n,{fetch:!1}),await fetchEntity(n);else{(await s.getAllPages(v.getAssets(),"getAssets")).forEach(e=>visitAsset(e))}for(n&&(I=visitAsset(n=await a.toAsset(e,v,n,{fetch:!1}),b));0!==E.length;)await E.shift();if(!I){if(!b)throw new i.PimError(i.GEN_INVALID_INPUT,"A snapshot or a starting asset must be provided");const e=visitSnapshot(b);if(!e)throw new i.PimError(i.NOT_FOUND_SNAPSHOT,"A requested snapshot could not be found in the topology");await e._complete,I=e.assets[0]}for(const e of Object.keys(y))y[e].fromAsset&&y[e].toAsset||delete y[e];return{root:I,visitedAssets:m,visitedRelationships:y,visitedSnapshots:g}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(88),i=n(1),s=n(17),a=n(22),c=n(3),u=n(500);function isVersionSnapshot(e){return e.listComponents().includes("version")}t.closureV2Topology=async function closureV2Topology(e,t,n,l,d){const p=Object.assign({type:o.TopologyTypes.FULL,fetch:!0},d);if(p.type===o.TopologyTypes.AS_SAVED&&!l)throw new s.PimError(s.GEN_INVALID_INPUT,"A snapshot must be provided for the AS-SAVED topology type");if(!n)throw new s.PimError(s.GEN_INVALID_INPUT,"A start asset must be provided for the CLOSUREV2 strategy");p.type,o.TopologyTypes.AS_LATEST;const h=p.cache?p.cache.visitedAssets:{},m=p.cache?p.cache.visitedRelationships:{},y=p.cache?p.cache.visitedSnapshots:{};let g;g=c.isString(t)?await e.getSpaceCollection(t,{fetch:!1}):t;const _=a.extractId(n),v=await e.getSpace("bob",g,{fetch:!1,assumeTypeId:r.assetGraphTypeId});let E=void 0;l&&(E=Array.isArray(l)?l.length>0?l.map(a.extractId):void 0:[a.extractId(l)]);const I={contains:i.PIM_CONTAINS_RELATIONSHIP_TYPENAME,assemblyRef:i.PIM_ASSEMBLYREF_RELATIONSHIP_TYPENAME,use:i.PIM_USE_RELATIONSHIP_TYPENAME,product:i.PIM_PRODUCT_ASSETS_TYPENAME,design:i.PIM_DESIGN_ASSETS_TYPENAME,model:i.PIM_MODEL_ASSETS_TYPENAME,lifecycle:i.PIM_LIFECYCLE_ASSETS_TYPENAME,release:i.PIM_RELEASE_ASSETS_TYPENAME,drawing:i.PIM_DRAWING_ASSETS_TYPENAME,sheets:i.PIM_SHEETS_ASSETS_TYPENAME},b=[I.contains,I.assemblyRef,I.use],S=[I.product,I.design,I.model,I.lifecycle,I.release,I.drawing,I.sheets],C=[...b.map(e=>({direction:"IN",type:{name:e}})),...b.map(e=>({direction:"OUT",type:{name:e}}))],w=S.map(e=>({type:{name:e}})),A={[o.TopologyTypes.AS_SAVED]:[{direction:"OUT",type:{name:I.contains}},{direction:"IN",type:{name:I.contains}},{direction:"OUT",type:{name:I.assemblyRef}}],[o.TopologyTypes.FULL]:C,[o.TopologyTypes.AS_LATEST]:C,[o.TopologyTypes.SNAPSHOT_CONSTRAINED]:C},O={[o.TopologyTypes.AS_SAVED]:[{type:{name:I.product}},{type:{name:I.design}},{type:{name:I.model}}],[o.TopologyTypes.FULL]:w,[o.TopologyTypes.AS_LATEST]:w,[o.TopologyTypes.SNAPSHOT_CONSTRAINED]:w};let P;for(;void 0===P;){let e=[{asset:_}];E&&(e=E.map(e=>({asset:_,snapshotContext:e}))),P=await v.getClosureV2({startAssets:e,relationshipFilters:A[p.type],assetFilters:O[p.type],include:{assetAttributes:!0,assetComponents:!0,relationshipAttributes:!0,relationshipComponents:!0}})}const D=P.getTopology(),x=P.getAssets(),R=P.getRelationships(),N=P.getSnapshots();function filterRelationshipOutOfSnapshot(e){if(!E)return!0;const t=e.fromNode,n=e.toNode,r=D.nodes[t],o=D.nodes[n];return!(!r.assetInSnapshot||!o.assetInSnapshot)}function filterAssetsOutOfSnapshot(e){return!E||!!e.assetInSnapshot}function visitSnapshot(e,t){if(!e)return;const n=u.getTopoSnapshotId(e,t);if(y[n])return y[n];const r=y[n]={id:n,snapshot:e,assets:[]};return r.assets=D.nodes.filter(e=>void 0!==e.snapshotContextIdx).filter(t=>N[t.snapshotContextIdx].getId()===e.getId()).filter(filterAssetsOutOfSnapshot).map(e=>visitAsset(e)),r}function visitAsset(e){const t=x[e.assetIdx],n=e.assetInSnapshot&&void 0!==e.snapshotContextIdx?N[e.snapshotContextIdx]:void 0,r=u.getTopoAssetId(t,n);if(h[r])return h[r];const o=h[r]={id:r,asset:t};return o.incoming=D.edges.filter(t=>D.nodes[t.toNode]===e).filter(filterRelationshipOutOfSnapshot).map(e=>visitRelationship(e)).filter(e=>e),o.outgoing=D.edges.filter(t=>D.nodes[t.fromNode]===e).filter(filterRelationshipOutOfSnapshot).map(e=>visitRelationship(e)).filter(e=>e),o.snapshot=n?visitSnapshot(n,t):void 0,o}function visitRelationship(e){const t=R[e.relationshipIdx],n=e.fromNode,r=e.toNode,i=D.nodes[n],s=D.nodes[r],a=void 0!==i.snapshotContextIdx?N[i.snapshotContextIdx]:void 0,c=void 0!==s.snapshotContextIdx?N[s.snapshotContextIdx]:void 0,l=u.getTopoRelationshipId(t,a);if(m[l])return m[l];if(p.type===o.TopologyTypes.AS_SAVED){if(a&&!isVersionSnapshot(a))return;if(c&&!isVersionSnapshot(c))return}const d=m[l]={id:l,relationship:t};return d.fromAsset=visitAsset(i),d.toAsset=visitAsset(s),d.fromAssetSnapshot=a?visitSnapshot(a,x[i.assetIdx]):void 0,d.toAssetSnapshot=c?visitSnapshot(c,x[s.assetIdx]):void 0,d}D.nodes.filter(filterAssetsOutOfSnapshot).forEach(visitAsset);for(const e of Object.keys(m))m[e].fromAsset&&m[e].toAsset||delete m[e];let M=D.nodes.filter(e=>x[e.assetIdx].getId()===_);if(void 0!==E&&(M=M.filter(e=>void 0!==e.snapshotContextIdx&&N[e.snapshotContextIdx].getId()===E[0])),0===M.length)throw new s.PimError(s.GEN_INVALID_INPUT,"Could not find the root node");if(p.fetch){const e=Object.values(y).map(e=>e.snapshot.getId()),t=await a.getAllPages(g.getSnapshots({filter:{snapshotId:{$in:e}},include:["snapshot_attributes","snapshot_components"]}),"getSnapshots"),n={};for(const e of t)n[e.getId()]=e;for(const e of Object.values(y))n[e.snapshot.getId()]&&(e.snapshot=n[e.snapshot.getId()])}return{root:visitAsset(M[0]),visitedAssets:h,visitedRelationships:m,visitedSnapshots:y}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1),i=n(7),s=n(501);i.failIfExistsOnSDK("pimFindRootProduct"),i.failIfExistsOnSDK("pimFindRootProductAndVersionSnapshot"),r.FDModelingSDK.prototype.pimFindRootProduct=async function(e,t){const n=[o.PIM_FAMILY.PRODUCT],r=[o.PIM_MODEL_ASSETS_TYPENAME];return await s.findRootAsset(this,e,t,n,r)},r.FDModelingSDK.prototype.pimFindRootProductAndVersionSnapshot=async function(e,t){const n=[o.PIM_FAMILY.PRODUCT],r=[o.PIM_MODEL_ASSETS_TYPENAME],i=await s.findRootAssetAndVersionSnapshot(this,e,t,n,r);return i?{rootProduct:i.rootAsset,snapshot:i.snapshot}:void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1),i=n(4),s=n(22),a=n(9);async function getRootProductClosureV2(e,t,n){let a;const c=await s.getAllPages(n.getAssets({filter:{"type.name":o.PIM_MODEL_ASSETS_TYPENAME}}),"getAssets",1);if(c.length<1)throw new i.PimError(i.NOT_FOUND_ASSET);const u=await c[0].fetch();if(u){const s={startAssets:[{asset:u.getId(),snapshotContext:n.getId()}],maxDepth:0,relationshipFilters:[{direction:"IN",type:{name:o.PIM_CONTAINS_RELATIONSHIP_TYPENAME}}]},c=(await e.getSpace("bob",t,{fetch:!1,assumeTypeId:r.assetGraphTypeId})).getClosureV2Traverser(s),assetVisitor=e=>(i.getFamilyFromTypeid(e.asset.getTypeId()).family===o.PIM_FAMILY.PRODUCT&&(a=e.asset),Promise.resolve(r.TraversalAction.Continue));await c.traverse(s.startAssets,assetVisitor,void 0,{direction:"IN"}),a||i.getFamilyFromTypeid(u.getTypeId()).family!==o.PIM_FAMILY.PRODUCT||(a=u)}if(!a)throw new i.PimError(i.NOT_FOUND_PRODUCT);return a}t.getRootProductIterate=async function getRootProductIterate(e,t,n){const r=await s.getAllPages(n.getAssets({}),"getAssets");let c;for(let n=0;n<r.length&&void 0===c;n++){const u=await a.toAsset(e,t,r[n],{fetch:!0});if(i.getFamilyFromTypeid(u.getTypeId()).family===o.PIM_FAMILY.PRODUCT){0===(await s.getAllPages(t.getRelationships({toAsset:u.getId()}),"getRelationships")).filter(e=>i.getFamilyFromTypeid(e.getTypeId()).family===o.PIM_FAMILY.CONTAINS).length&&(c=r[n])}}if(!c)throw new i.PimError(i.NOT_FOUND_PRODUCT);return c},t.getRootProductClosureV2=getRootProductClosureV2,t.getRootProduct=getRootProductClosureV2,i.failIfExistsOnSDK("pimGetRootProductFromSnapshot"),r.FDModelingSDK.prototype.pimGetRootProductFromSnapshot=async function(e,t){return getRootProductClosureV2(this,e=await a.toSpaceCollection(this,e,{fetch:!1}),t=await a.toSnapshot(this,e,t,{fetch:!0}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(10),i=n(9);function semverIsCompatible(e,t){const n=e.split("."),r=t.split(".");return r[0]===n[0]&&!(n[0]<r[0])}n(7).failIfExistsOnSDK("pimValidateSchemasVersion"),r.FDModelingSDK.prototype.pimValidateSchemasVersion=async function(e,t,n){const r=await Promise.all([this.pimFindRootProduct(e,t),this.pimFindRootProductAndVersionSnapshot(e,t)]);let s;if(r[0]){const t=await i.toAsset(this,e,r[0],{fetch:!0}),n=(await t.getSpace({fetch:!0})).getAttribute(o.AttributeKeys.SCHEMAS_VERSION);s=n?n.toString():void 0}else if(r[1]){const t=await i.toAsset(this,e,r[1].rootProduct,{fetch:!0}),n=(await t.getSpace({fetch:!0})).getAttribute(o.AttributeKeys.SCHEMAS_VERSION);s=n?n.toString():void 0}return s?{dataVersion:s,isCompatible:semverIsCompatible(n||this._pimData.schemasVersion,s)}:{dataVersion:void 0,isCompatible:!0}},r.FDModelingSDK.prototype.pimGetSchemasVersion=function(){return this._pimData.schemasVersion}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(10),i=n(4),s=n(27);r.FDModelingSDK.prototype.pimCreateFullAccessSpaceCollection=async function(e){const t=["PIMFullAccess","PIMServiceAccess"],n=this.createSpaceCollection();n.createAttribute(o.AttributeKeys.SCHEMAS_VERSION,"String",this.pimGetSchemasVersion()),t&&t.forEach(e=>n.assignPolicy(e)),s.addAdditionalInfo([n],e);const r=await n.save();return i.validateRequestResult(r),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(237),i=n(89),s=n(4),a=n(32),c=n(22);class PIMCustomSchemaStore{constructor(e,t){this.logger=t,this.schemasVersion=e}async getSchema(e){const t=i.getSchemaManager(this.schemasVersion).getSchema(e,this.ignoreWarnings);return void 0===t||t.annotations&&t.annotations.skipFDML8Registration?(this.logger&&this.logger(`Schema type ${e} is unknown, creating empty placeholder`),{typeid:e}):c.convertSchemaForL8(t)}}t.PIMCustomSchemaStore=PIMCustomSchemaStore,r.FDModelingSDK.initializeWithPIM=async function(e){let t,n;if(!e||!e.schemasVersion)throw new s.PimError(s.GEN_INVALID_INPUT,"options.schemasVersion is required to initialize PIM");t=e.schemasVersion,(!e.maxCommandsInParallel||e.maxCommandsInParallel<=0)&&(e.maxCommandsInParallel=a.DEFAULT_MAX_COMMANDS_IN_PARALLEL),n=e.useFSS?new r.ForgeSchemaStore({url:"https://developer-stg.api.autodesk.com/schema"}):new PIMCustomSchemaStore(t,e.logger);const c=e.l8Logger;if(void 0!==c&&function installInterceptor(e){const t={FDModelingSDK:r.FDModelingSDK,SpaceCollection:r.SpaceCollection,AssetGraph:r.AssetGraph,Asset:r.Asset,Relationship:r.Relationship,Snapshot:r.Snapshot,Space:r.Space};if(u)return;u=!0;const n="#".repeat(200),o=" ".repeat(200),purge=t=>{t.length>0&&t[0].start!==t[0].end&&e("_".repeat(120));const r=70/(t[0].end-t[0].start),i=t[0].start,s=t[0].end;for(;t.length>0;){const a=t.shift(),c=(a.end-a.start)*r,u=(a.start-i)*r,l=(s-a.end)*r;a.end!==a.start&&e(`${o.substr(0,a.indent)}${a.message.substr(0,50)}${o.substr(0,50-a.message.length-a.indent)} ${o.substr(0,u)}${n.substr(0,c)}${o.substr(0,l)} ${a.end-a.start}ms`)}},i=[];let s=0;Object.keys(t).forEach(e=>{const n=t[e];Object.getOwnPropertyNames(n.prototype).forEach(t=>{const r=n.prototype[t];"function"==typeof r&&(n.prototype[t]=function(...n){const o=Object.assign({},{message:`${e}.${t}`,indent:s,start:(new Date).getTime(),end:(new Date).getTime()});i.push(o),s++;const a=r.call(this,...n);return a instanceof Promise?a.then(e=>{const t=(new Date).getTime();return o.end=t,--s,0===s&&purge(i),e}):(--s,o.end=(new Date).getTime(),0===s&&purge(i),a)})})})}(c),void 0===e.getToken)throw new s.PimError(s.GEN_INVALID_INPUT,"Missing getToken function");let l=void 0;c&&(l={debug:c,info:c,warn:c,error:c});const d={host:e.serverUrl,getToken:e.getToken,headers:{}};e.headers&&(d.headers=e.headers);const p=r.FDModelingSDK.initialize(d,n,e.journalSDK,e.journalOptions,l);p._pimData={schemasVersion:t,connectOptions:Object.assign({},e),logger:e.logger||function(){}},p._pimData.connectOptions.serverUrl.toLowerCase().startsWith("http")||(p._pimData.connectOptions.serverUrl="https://"+p._pimData.connectOptions.serverUrl),p.getNewInstanceExperimental=function(e,t){const n=r.FDModelingSDK.prototype.getNewInstanceExperimental.call(this,e,t);return n._pimData=p._pimData,n.getNewInstanceExperimental=p.getNewInstanceExperimental,n};const h=i.getSchemaManager(t).getAllRegisteredTypeIds().filter(e=>!e.includes("autodesk.data"));n instanceof PIMCustomSchemaStore&&(n.ignoreWarnings=!0),await p.loadSchemas(h),n instanceof PIMCustomSchemaStore&&(n.ignoreWarnings=!1);const m=[o.COMMANDS_NAMES.GENERATE_ITEM_NUMBER,o.COMMANDS_NAMES.CREATE_MILESTONE,o.COMMANDS_NAMES.UPDATE_MILESTONE,o.COMMANDS_NAMES.QUICK_RELEASE_ASSET],y=s.createCommandsDefinitions(m);return await p.getJournals().registerCommandsAndQueries(y),p};let u=!1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(32),i=n(3),s=n(237);r.FDModelingSDK.prototype.pimQuickRelease=async function(e,t){const n=await this.getJournals().getRemote(e),r=[],a=i.chunk(t,o.BATCH_LIMIT);return await Promise.all(a.map(async e=>{const t=e.map(e=>({commandName:s.COMMANDS_NAMES.QUICK_RELEASE_ASSET,parameters:e,dependsOn:[]})),o=await n.executeCommands(t);r.push(...o.map(e=>{const t=e.result,n=t.result.error?{status:t.result.error.status,message:t.result.error.message}:void 0;return{commandId:t.commandId,status:t.status,data:t.result.data,error:n}}))})),r},r.FDModelingSDK.prototype.pimGenerateItemNumberCommand=async function(e,t){const n=await this.getJournals().getRemote(e),r=[],a=i.chunk(t,o.BATCH_LIMIT);return await Promise.all(a.map(async e=>{const t=e.map(e=>({commandName:s.COMMANDS_NAMES.GENERATE_ITEM_NUMBER,parameters:e,dependsOn:[]})),o=await n.executeCommands(t);r.push(...o.map(e=>{const t=e.result,n=t.result.error?{status:t.result.error.status,message:t.result.error.message}:void 0;return{commandId:t.commandId,status:t.status,data:t.result.data,error:n}}))})),r},r.FDModelingSDK.prototype.pimCreateMilestoneCommand=async function(e,t){const n=await this.getJournals().getRemote(e),r=[],a=i.chunk(t,o.BATCH_LIMIT);return await Promise.all(a.map(async e=>{const t=e.map(e=>({commandName:s.COMMANDS_NAMES.CREATE_MILESTONE,parameters:e,dependsOn:[]})),o=await n.executeCommands(t);r.push(...o.map(e=>{const t=e.result,n=t.result.error?{status:t.result.error.status,message:t.result.error.message}:void 0;return{commandId:t.commandId,status:t.status,data:t.result.data,error:n}}))})),r},r.FDModelingSDK.prototype.pimUpdateMilestoneCommand=async function(e,t){const n=await this.getJournals().getRemote(e),r=[],a=i.chunk(t,o.BATCH_LIMIT);return await Promise.all(a.map(async e=>{const t=e.map(e=>({commandName:s.COMMANDS_NAMES.UPDATE_MILESTONE,parameters:e,dependsOn:[]})),o=await n.executeCommands(t);r.push(...o.map(e=>{const t=e.result,n=t.result.error?{status:t.result.error.status,message:t.result.error.message}:void 0;return{commandId:t.commandId,status:t.status,data:t.result.data,error:n}}))})),r}},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(503)),__export(n(1178)),__export(n(1179)),__export(n(1181)),__export(n(1182)),__export(n(1187)),__export(n(1188)),__export(n(509)),__export(n(508))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(4),o=n(116),i=n(10),s=n(504),a=n(170),c=n(506),u=n(507),l=n(3),d=n(171);t.f3dFirstVersionToPIM=async function f3dFirstVersionToPIM(e,t,n,p,h,m){const y={},g=l.getLogger(e);let _,v=[];try{if(n.wipVersionUrn){const r=n.components.map(e=>e.persistentId),o=await d.getOrPurgeHalfWayCreatedPIMVersionData(e,t,p,n.wipVersionUrn,r,g);if(o)return o}let l;l=n.errorCode?await u.f3dNewErrorComponentsToPIM(e,t,n.components,y,p,void 0,m):await s.f3dNewComponentsToPIM(e,t,n.components,y,p,void 0,m);const E=a.getAssetAndRevisionIds(y),I=await o.createVersionSnapshotWithAssets(e,t,E,h,m);if(!I||!I.snapshot)throw new Error("Unknown error creating snapshot, no result returned.");if(_=I.snapshot,n.errorCode||(v=await c.f3dStructureToPIM(e,t,n,y,_.getId(),m)),n.errorCode){const t={errorCode:n.errorCode,addVersionComponent:!0};await r.moveToNextIncompleteState(e,_,i.IncompleteState.ERROR,m,t)}else await r.moveToNextIncompleteState(e,_,h.nextIncompleteState,m);return{compAndProducts:y,rootProductStructure:l,versionSnapshot:_,assemblyRefs:v,isNewlyCreated:!0}}catch(e){v&&v.length>0&&await r.purgeEntities(v,g),_&&await r.purgeEntities([_],g),await r.purgeEntities(Object.values(y).map(e=>e.productSpace),g);const t=`FAILED: Creating PIM data for version ${n.wipVersionUrn}, ${e.message}`;throw new r.PimError(r.GEN_ERROR_COMMAND,t,e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(4),o=n(116),i=n(170),s=n(10),a=n(1180),c=n(3),u=n(171);t.f2dFirstVersionToPIM=async function f2dFirstVersionToPIM(e,t,n,l,d,p){const h=[],m=d.wipVersionUrn;try{if(n.wipVersionUrn){const r=await u.getOrPurgeF2dVersionSnapshotData(e,t,n.wipVersionUrn,l);if(r)return r}const c=[],m=await a.f2dDrawingToPIM(e,t,n.drawingName,l,p);h.push(m.documentationSpace),i.getDocumentAssetsAndRevisionIds(c,m);const y=await o.createVersionSnapshotWithAssets(e,t,c,d,p&&p.additionalInfo);if(!y||!y.snapshot)throw new Error("Unknown error creating snapshot, no result returned.");const g=y.snapshot;if(n.errorCode){const t={errorCode:n.errorCode,addVersionComponent:!0};await r.moveToNextIncompleteState(e,g,s.IncompleteState.ERROR,p&&p.additionalInfo,t)}else await r.moveToNextIncompleteState(e,g,d.nextIncompleteState,p&&p.additionalInfo);return{documentationStructure:m,versionSnapshot:g}}catch(t){const n=c.getLogger(e);r.purgeEntities(h,n);const o=`FAILED: Creating PIM data for version ${m}, ${t.message}`;throw new r.PimError(r.GEN_ERROR_COMMAND,o,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(70),o=n(4),i=n(3),s=n(3);t.f2dDrawingToPIM=async function f2dDrawingToPIM(e,t,n,a,c){const u=[Object.assign(Object.assign({},o.DefaultPermissionContext),{value:a})],l={drawingName:n,wip:{lineageUrn:a}},d=r.getDocumentationStructurePayload(e.pimGetSchemasVersion(),l),p=await s.retry(async()=>await e.pimCreateDocumentationStructure(t,d,u,c),i.getLogger(e));return{documentationSpace:p.documentationSpace,documentation:p.documentation,drawing:p.drawing,sheets:p.sheets}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(116),o=n(10),i=n(170),s=n(4),a=n(171);t.f2dNewVersionToPIM=async function f2dNewVersionToPIM(e,t,n,c,u,l,d){const p=u.wipVersionUrn;try{if(n.wipVersionUrn){const r=await a.getOrPurgeF2dVersionSnapshotData(e,t,n.wipVersionUrn,c,l);if(r)return r}const p=l.drawing.getAttribute(o.AttributeKeys.DRAWING_NAME);n.drawingName&&p&&p!==n.drawingName?(l.drawing.updateAttribute(o.AttributeKeys.DRAWING_NAME,n.drawingName),await l.drawing.save()):n.drawingName&&null==p&&l.drawing.createAttribute(o.AttributeKeys.DRAWING_NAME,"String",n.drawingName);const h=[];i.getDocumentAssetsAndRevisionIds(h,l);const m=await r.createVersionSnapshotWithAssets(e,t,h,u,d&&d.additionalInfo);if(!m||!m.snapshot)throw new Error("Unknown error creating snapshot, no result returned.");const y=m.snapshot;if(n.errorCode){const t={errorCode:n.errorCode,addVersionComponent:!0};await s.moveToNextIncompleteState(e,y,o.IncompleteState.ERROR,d&&d.additionalInfo,t)}else await s.moveToNextIncompleteState(e,y,u.nextIncompleteState,d&&d.additionalInfo);return{documentationStructure:l,versionSnapshot:y}}catch(e){const t=`FAILED: Creating PIM data for version ${p}, ${e.message}`;throw new s.PimError(s.GEN_ERROR_COMMAND,t,e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(116),o=n(171),i=n(10),s=n(167),a=n(1183),c=n(170),u=n(504),l=n(507),d=n(4),p=n(506),h=n(43),m=n(27),y=n(114),g=n(3);t.f3dNewVersionToPIM=async function f3dNewVersionToPIM(e,t,n,_,v,E,I,b){const S=n.components,C=g.getLogger(e),w={},A=[];let O,P=[];try{const g=[];if(n.errorCode)await l.f3dNewErrorComponentsToPIM(e,t,S,w,_,I,b);else{for(const e of S){const t=e.persistentId,n=E[t];n?(w[t]=n,g.push(e)):A.push(e)}if(I){if(I&&I.model){const e=I.model.getComponent(y.ComponentKeys.DELETE_STATUS);e&&h.isFileUnsupported(I.model)&&(e.setValues({unsupported:!1}),h.removeDeleteStatus(I.model),m.addAdditionalInfo([I.model],b),await I.model.save())}const e=A.findIndex(e=>!0===e.isRootComponent);if(e>-1){const t=A[e];w[t.persistentId]=I,g.push(t),A.splice(e,1)}}if(n.wipVersionUrn){const r=A.map(e=>e.persistentId),i=await o.getOrPurgeHalfWayCreatedPIMVersionData(e,t,_,n.wipVersionUrn,r,C);if(i)return i}if(I&&(d.setEntityAttribute(I.product,i.AttributeKeys.CREATE_STATUS,s.F3DComponentCreateStatus.UNDER_CONSTRUCTION),m.addAdditionalInfo([I.product],b),await I.product.save()),await u.f3dNewComponentsToPIM(e,t,A,w,_,I,b),await a.f3dChangedComponentsToPIM(e,t,g,w,E,b),b&&b.corruptDataTest)return{};I&&(d.removeEntityAttribute(I.product,i.AttributeKeys.CREATE_STATUS),m.addAdditionalInfo([I.product],b),await I.product.save())}const D=c.getAssetAndRevisionIds(w),x=await r.createVersionSnapshotWithAssets(e,t,D,v,b);if(!x||!x.snapshot)throw new Error("Unknown error creating snapshot, no result returned.");if(O=x.snapshot,n.errorCode||(P=await p.f3dStructureToPIM(e,t,n,w,O.getId(),b)),n.errorCode){const t={errorCode:n.errorCode,addVersionComponent:!0};await d.moveToNextIncompleteState(e,O,i.IncompleteState.ERROR,b,t)}else await d.moveToNextIncompleteState(e,O,v.nextIncompleteState,b);return{compAndProducts:w,rootProductStructure:I,versionSnapshot:O,assemblyRefs:P,isNewlyCreated:!0}}catch(r){P&&P.length>0&&await d.purgeEntities(P,C),O&&await d.purgeEntities([O],C);const o=A.map(e=>e.persistentId);o.length>0&&await d.purgeEntitiesOfF3DComponents(e,t,o);const i=`FAILED: Creating PIM data for version ${n.wipVersionUrn}, ${r.message}`;throw new d.PimError(d.GEN_ERROR_COMMAND,i,r)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(172),o=n(172),i=n(242),s=n(4);async function getComponentsAssets(e){const t=[];for(const n of Object.keys(e)){const r=e[n];t.push(r.product),t.push(r.design),t.push(r.model)}const n={};for(const e of t){const t=(await e.getSpace({fetch:!1})).getId();n[t]?n[t].push(e):n[t]=[e]}return[n,t]}t.f3dChangedComponentsToPIM=async function f3dChangedComponentsToPIM(e,t,n,a,c,u){try{const t=await async function getCompAndSpaceIdMap(e){const t={};for(const n of Object.keys(e)){const r=e[n].product,o=(await r.getSpace({fetch:!1})).getId();t[n]=o}return t}(a),[s,l]=await getComponentsAssets(a),d=r.getModelAssets(e,l),p=function getComponentsProperties(e,t){const n={};for(const r of e){const e=r.properties.find(e=>"Part Number"===e.propertyKey),o=r.properties.find(e=>"Part Name"===e.propertyKey),s=r.properties.find(e=>"Description"===e.propertyKey),a=r.massProperties.find(e=>"material"===e.propertyKey),c={};o&&(c[i.PIMModelDataPropKey.partName]=o.value),e&&(c[i.PIMModelDataPropKey.partNumber]=e.value),s&&(c[i.PIMModelDataPropKey.description]=s.value),a&&(c[i.PIMModelDataPropKey.material]=a.value);n[t[r.persistentId]]=c}return n}(n,t),[,h]=await getComponentsAssets(c),m=await o.getConflictModelDataFromAssets(e,h);await o.resolveConflictsForProperties(e,p,m.properties,s,u);const y=await o.resolveNoCADComponents(e,d,m.modelsWithCad,u);return await async function updateModelAssets(e,t){const{restoredAssets:n}=t;if(0!==n.size)for(const t of Array.from(n.keys()))for(const n of Object.values(e))if(n.model.getId()===t){n.model=await n.model.getLatestAsset();break}}(a,y),y}catch(e){const t=`Failed in f3dChangedComponentsToPIM, componentNum: ${n.length}.`;throw new s.PimError(s.GEN_ERROR_COMMAND,t,e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(4),i=n(1185),s=n(1);async function getLatestVersionSnapshot(e,t,n,r){const o=await e.pimFindRootItem(t,n);if(!o)return;const a={};return r?a["attribute.name"]="versionSnapshot":a["has.component.type.name"]=s.PIM_VERSION_COMPONENTS_TYPENAME,await i.getLatestSnapshot(e,t,o,a,r)}t.getLatestVersionSnapshot=getLatestVersionSnapshot,o.failIfExistsOnSDK("pimGetLatestVersionSnapshot"),r.FDModelingSDK.prototype.pimGetLatestVersionSnapshot=async function(e,t,n){return getLatestVersionSnapshot(this,e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(4),i=n(10),s=n(494);t.getLatestSnapshot=async function getLatestSnapshot(e,t,n,a,c){const log=t=>{e._pimData&&e._pimData.logger(t)};t=await o.toSpaceCollection(e,t,{fetch:!1});const extractWIPVersion=e=>e?parseInt(e.split("?version=").pop()):-1,getVersionUrn=e=>e.getAttribute(i.AttributeKeys.WIP_VERSION_URN),sortSnapshotsByVersion=e=>e.map(e=>({snapshot:e,versionUrn:getVersionUrn(e)})).sort((e,t)=>{const n=extractWIPVersion(e.versionUrn);return extractWIPVersion(t.versionUrn)-n}).map(e=>e.snapshot);let u;const l=await e.getJournals();if((await l.get(t)).getType()!==r.JournalType.REMOTE){const e=await o.getAllPages(t.getSnapshots({assetId:n.getId(),filter:a,include:["snapshot_components","snapshot_attributes"]}),"getSnapshots");if(0===e.length)return void log("[getLatestSnapshot]: Found no snapshots");u=sortSnapshotsByVersion(e)[0]}else{const e=t.getSnapshots({assetId:n.getId(),sort:"snapshotId desc",filter:a,limit:5,include:["snapshot_components","snapshot_attributes"]}),r=await o.getAllPages(e,"getSnapshots",5);if(0===r.length)return void log("[getLatestSnapshot]: Found no snapshots");const i=sortSnapshotsByVersion(r),l=getVersionUrn(i[0]);l||log(`[getLatestSnapshot]: Found version snapshot ${i[0].getId()} with no wipVersionUrn attribute.`);const d=i.filter(e=>{const t=getVersionUrn(e);return l===t});u=await s.decideVersionSnapshotToUse(d,c)}return u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(241),o=n(510),i=n(511),s=n(1);t.rebaseIsolationJournal=async(e,t)=>{await e.rebase();const n=await e.getProperties();e.setProperties(Object.assign(Object.assign({},n),{baseSnapshotId:t.getId()}))},t.rebaseAndResolveConflicts=async function rebaseAndResolveConflicts(e,n,a,c,u,l,d){return d!=s.DOCUMENT_TYPE.Design||await async function rebaseAndResolveDesignConflicts(e,n,s,a,c,u){const{needResolve:l,mainSnapshot:d}=await o.needResolveConflicts(e,n,s,a,u);if(!d)return!1;if(!l)return await t.rebaseIsolationJournal(a,d),!0;const p=await r.getConflictModelData(n,c);return await t.rebaseIsolationJournal(a,d),await i.resolveConflicts(n,c,d,p),!0}(e,n,a,c,u,l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(4),o=n(3);t.f2dRelationshipsToPIM=async function f2dRelationshipsToPIM(e,t,n){const i=[],s=o.getLogger(e),a=new Array(Math.ceil(n.length/20)).fill([]).map(()=>n.splice(0,20));try{for(const n of a){const o=[];e.beginBatch();for(const r of n){const n=await e.pimCreateDescribes(t,r.fromSheets,r.toModel,r.fromSheetsSnapshot,r.toModelSnapshot,r.describes?{describes:r.describes}:void 0,{skipCommit:!0,skipValidation:!0,additionalInfo:r.additionalInfo});o.push(n.describes)}const a=await e.endBatch();try{r.validateBatchResult(a)}catch(e){throw r.purgeEntities(o,s),s&&s("Failed: Creating batchRelationships: "+o),e}i.push(...o)}}catch(e){throw r.purgeEntities(i,s),new Error("FAILED: Creating PIM data for f2d structure, "+e)}return i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(488),o=n(4),i=n(88);t.pimVersionSnapshotToF3d=async function pimVersionSnapshotToF3d(e,t,n){try{const o=await e.pimFindRootProductAndVersionSnapshot(t,n);if(!o)throw new Error("Fail to find root product and snapshot by versionUrn: "+n);const s=await e.pimGetTopology(t,o.rootProduct,o.snapshot,{fetch:!0,type:i.TopologyTypes.AS_SAVED});return r.buildF3DStructureFromTopology(e,s)}catch(e){const t=`FAILED: convert PIM data as f3d Version Json, ${n}, ${e.message}`;throw new o.PimError(o.GEN_ERROR_COMMAND,t,e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(4);t.findSnapshotAssetsAndRevisions=async function findSnapshotAssetsAndRevisions(e){return(await r.getAllPages(e.getAssets(),"getAssets")||[]).map(e=>({id:e.getId(),revisionId:e.getRevisionId()}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(1191))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(1),i=n(4),s=n(10),a=n(3),c=n(514),u=n(18),l=n(515),d=n(502);t.PIM_FAMILY_USE="use",t.createStandardMilestoneSnapshot=async function createStandardMilestoneSnapshot(e,t,n,r){const s=await e.getSpaceCollection(t,{fetch:!1});let u;!function _validate(e){if(e.createTime&&!a.isDateFormatString(e.createTime)||e.lastModifiedTime&&!a.isDateFormatString(e.lastModifiedTime))throw new Error("Invalid date format string");if(!e.createUserId)throw new Error("No userId provided in payload.");if(!e.createTime)throw new Error("No createTime provided in payload.");if(!e.snapshotId)throw new Error("No snapshotId provided in payload.");if(!e.name)throw new Error("No milestone name provided in payload.");if(!e.wipVersionUrn)throw new Error("No wipVersionUrn provided in payload.")}(n);const l=n.snapshotId;try{u=await e.getSnapshot(l,s,{fetch:!0})}catch(e){throw new Error(`Version snaphost ${l} does not exists.`)}const d=await c.findSnapshotAssetsAndRevisions(u),p={components:{snapshot:i.snapshotComponent(n),milestone:{typeid:o.schemaTypes.Product_ComponentsMilestone_V2_0_0.typeid,value:{}}},attributes:{name:{typeid:"String",value:"milestoneSnapshot"},wipVersionUrn:{typeid:"String",value:n.wipVersionUrn},dmVersionId:{typeid:"String",value:n.wipVersionUrn}}};return(await e.pimCreateSnapshot(s,d,p,r)).snapshot.getId()};const getFamily=e=>i.getFamilyFromTypeid(e.getTypeId()).family,isDesignOrDrawingFamily=e=>getFamily(e)==o.PIM_FAMILY.DESIGN||getFamily(e)==o.PIM_FAMILY.DRAWING,isLifecycleFamily=e=>getFamily(e)==o.PIM_FAMILY.LIFECYCLE;async function readLatestPimMilestone(e,t,n){const extractWIPVersion=e=>{if(!e)return-1;const t=e.split("?version=");return parseInt(t[1])},r={"has.component.type.name":o.PIM_MILESTONE_COMPONENTS_TYPENAME},a=t.getSnapshots({assetId:n.getId(),filter:r,include:["snapshot_components","snapshot_attributes"]}),c=await i.getAllPages(a,"getSnapshots");if(0===c.length)return u="[readLatestPimMilestone]: Found no milestone snapshots",void(e._pimData&&e._pimData.logger(u));var u;return c.map(e=>{const t=(e=>e.getAttribute(s.AttributeKeys.WIP_VERSION_URN))(e);return{snapshot:e,versionUrn:t}}).sort((e,t)=>{const n=extractWIPVersion(e.versionUrn);return extractWIPVersion(t.versionUrn)-n}).map(e=>e.snapshot)[0]}async function moveForwardLifecycleWorkingPointersV2(e,n,s,a,c,d,p){c.info("UpdateLifecycleWorkingPointersByClosureQuery Start:");const h=await i.toSnapshot(e,n,s,{fetch:!0});c.info("UpdateLifecycleWorkingPointersByClosureQuery With Parameters: ",{latestMilestoneSnapshotId:h.getId()});const m=new Map,y=new Map;try{const g=await i.toAsset(e,n,a,{fetch:!0});if(!h)return c.error(`Couldn't find milestone ${s} under spaceCollection ${n} when update working pointer`),{created:-1,deleted:-1};let _;if(getFamily(g)==o.PIM_FAMILY.PRODUCT?_=o.PIM_DESIGN_ASSETS_TYPENAME:(e=>getFamily(e)==o.PIM_FAMILY.DOCUMENTATION)(g)&&(_=o.PIM_DRAWING_ASSETS_TYPENAME),!_)return c.error(`Invalid startAssetId ${a} should be assetId of type Product or Documentation.`),{created:-1,deleted:-1};const v=await i.getAllPages(h.getAssets({filter:{"type.name":_}}),"getAssets"),isDesignOrDrawingInLatestMilestone=e=>!!v.find(t=>t.getId()===e.getId());await(async(e,n,i)=>{const s=await e.getSpace({fetch:!1,assumeTypeId:r.assetGraphTypeId}),a={startAssets:[{asset:e,snapshotContext:i}],relationshipFilters:[{type:{name:o.PIM_CONTAINS_RELATIONSHIP_TYPENAME},direction:"OUT"},{type:{name:o.PIM_USE_RELATIONSHIP_TYPENAME},direction:"OUT"}],maxDepth:5,include:{assetAttributes:!0,assetComponents:!0,relationshipAttributes:!0,relationshipComponents:!0}},l=s.getClosureV2Traverser(a);await l.traverse(a.startAssets,void 0,(e,s,a)=>{if(u.schemaManager.getFamilyName(e.getTypeId())===o.PIM_FAMILY.CONTAINS&&isDesignOrDrawingFamily(s.asset)&&isLifecycleFamily(a.asset))n(s.asset)?y.set(a.asset,s.asset):c.warn(`Could not found design or drawing ${s.asset.getId()} in milestone snapshot: ${i}`);else if(u.schemaManager.getFamilyName(e.getTypeId())===t.PIM_FAMILY_USE&&isLifecycleFamily(s.asset)&&isDesignOrDrawingFamily(a.asset))if(n(a.asset)){const t=m.get(s.asset)||new Set;t.add(e),m.set(s.asset,t)}else c.error(`Could not found ${s.asset.getId()} in milestone snapshot.${i}, means the related component has been deleted, just skip it.`);return Promise.resolve(r.TraversalAction.Continue)})})(g,isDesignOrDrawingInLatestMilestone,h.getId());if(!Array.from(y.keys()).find(e=>!l.isLifecycleLocked(e)))return c.info("No lifecycle asset found for milestone snapshot "+s),{created:0,deleted:0};p&&p();const E=[],I=[];let b=0;for(const e of y.keys()){const t=y.get(e);if(t)if(l.isLifecycleLocked(e))c.warn(`Lifecycle asset ${e.getId()} has been locked`);else if(isDesignOrDrawingInLatestMilestone(t)&&E.push({lifecycleAsset:e,designAsset:t,pimMilestoneSnapshotId:h.getId()}),m.has(e)){const t=Array.from((m.get(e)||new Set).values());I.push(...t)}}c.info("UpdateLifecycleWorkingPointersByClosureQuery deleting old:"),await Promise.all(I.map(async e=>{try{e&&await e.delete(),b++}catch(t){const n=e&&e.getId();c.error(`Failed to move working pointer to ${h.getId()} due to relationship ${n} delete error.`,t)}})),c.info(`UpdateLifecycleWorkingPointersByClosureQuery [${I.length}] finish deleting old:`),c.info("UpdateLifecycleWorkingPointersByClosureQuery start adding new:");const S=await l.batchSavePinnedRelationship(e,E,d);return c.info(`UpdateLifecycleWorkingPointersByClosureQuery [${E.length}] finish adding new:`),c.info("UpdateLifecycleWorkingPointersByClosureQuery Finish:"),{created:S,deleted:b}}catch(e){c.warn("Error happened when trying to update working pointer for milestone snapshot "+s,e),c.info("UpdateLifecycleWorkingPointersByClosureQuery Failed:",e)}return{created:0,deleted:0}}t.readLatestPimMilestone=readLatestPimMilestone,t.moveForwardLifecycleWorkingPointersV2=moveForwardLifecycleWorkingPointersV2,t.updateWorkingPointerForNewMilestone=async function updateWorkingPointerForNewMilestone(e,t,n,r,o){o.info("UpdateWorkingPointerForNewMilestone Start:");const s=await d.findRootAssetBySnapshot(e,t,n);if(!s)throw o.info("UpdateLifecycleWorkingPointersByClosureQuery Failed:"),new Error("No root product found for milestone: "+n);const a=await i.toSpaceCollection(e,t,{fetch:!1}),c=await readLatestPimMilestone(e,a,s);if(!c)throw o.info("UpdateLifecycleWorkingPointersByClosureQuery Failed:"),new Error("No milestone found for given rootProduct assetUrn: "+s.getId());const u=await moveForwardLifecycleWorkingPointersV2(e,t,c,s.getId(),o,void 0,r);return o.info("UpdateWorkingPointerForNewMilestone Finish:"),u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1),o=n(18),i=n(4);t.BATCH_SAVE_SIZE=50,t.batchSavePinnedRelationship=async function batchSavePinnedRelationship(e,n,s){const a=e.pimGetSchemasVersion()||r.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0;let c=0;for(let u=0;u<n.length;u+=t.BATCH_SAVE_SIZE){e.beginBatch();const l=n.slice(u,u+t.BATCH_SAVE_SIZE);for(const e of l){const t=e.lifecycleAsset.createPinnedRelationship(e.designAsset,{typeId:o.SchemasVersions[a][r.PIM_FAMILY.USE].typeid,toSnapshotId:e.pimMilestoneSnapshotId});i.addAdditionalInfo([t],s),i.populateEntity(t)}const d=await e.endBatch(),p=d.getErrors();if(p.length>0)throw new i.PimError(i.SERVER_ERROR,"L2 Errors: "+p.map(e=>e.error.message).join("\n"));c+=d.getResults().length-p.length}return c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LIFECYCLE_IS_LOCKED="isLocked",t.isLifecycleLocked=function isLifecycleLocked(e){const n=e&&e.getComponent("lifecycle");if(!n)return!1;const r=n.get(t.LIFECYCLE_IS_LOCKED);return r&&r.value}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(69),o=n(1);t.stringifyRelatedAssets=async function stringifyRelatedAssets(e,t){const n={};return t.forEach(t=>{const i=t.snapshotId.concat(t.rootAssetId);let s;n[i]={snapshotId:t.snapshotId,rootAssetId:t.rootAssetId,wipVersionUrn:t.wipVersionUrn},n[i].releaseAsset={typeid:"",attributes:{},components:{lifecycle:{value:{revision:"",lifecycle:"Working"}}},revisionId:"",id:"",spaceCollectionId:""},t.relatedAssets.forEach(t=>{const a=e.pimGetRepresentation(t);switch(r.getFamilyFromTypeid(t.getTypeId()).family){case o.PIM_FAMILY.MODEL:n[i].modelAsset=a;break;case o.PIM_FAMILY.LIFECYCLE:n[i].lifecycleAsset=a;break;case o.PIM_FAMILY.RELEASE:if(null==s)s=t.getLastModifiedBy(),n[i].releaseAsset=a;else{const e=t.getLastModifiedBy();e&&s&&s.date<e.date&&(n[i].releaseAsset=a,s=e)}break;case o.PIM_FAMILY.PRODUCT:n[i].productAsset=a;break;case o.PIM_FAMILY.DESIGN:n[i].designAsset=a;break;case o.PIM_FAMILY.SHEETS:n[i].sheetAsset=a;break;case o.PIM_FAMILY.DRAWING:n[i].drawingAsset=a;break;case o.PIM_FAMILY.DOCUMENTATION:n[i].documentationAsset=a}})}),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(243);t.fremontTextCommand=async function fremontTextCommand(e,t,n){let{command:o,params:i}=n;i||(i=[]);let s="";if(o!==r.FremontTextCommands.DIFF&&(s+=`PIM Text command: ${o}, ${JSON.stringify(i)}\n`),function _validateTextCommandPayload(e){if("string"!=typeof e)throw new Error(`Unexpected type for the fremont text command: type=${typeof e} ; value=${e}`);if(!Object.values(r.FremontTextCommands).includes(e))throw new Error("Invalid fremont text command: "+e);return!0}(o)&&void 0!==o){const n=r.getTextCommand(o).handler;s+=(await n(e,t,{command:o,params:i})).message}return{message:s}}},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(1197)),__export(n(1198)),__export(n(1263)),__export(n(1264)),__export(n(1265))},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.ON="on",e.OFF="off"}(r=t.FremontTextCommandSwitches||(t.FremontTextCommandSwitches={})),t.journalReorderingTextCommandHandler=async function journalReorderingTextCommandHandler(e,t,n){let o="";const{params:i}=n;return i.length>=1&&t.pimStateService.setJournalReorderingEnabled(function _convertSwitchToBoolean(e){switch(e.toLowerCase()){case r.ON:return!0;case r.OFF:return!1;default:throw new Error("Unsupported value: "+e)}}(i[0])),o+=`Journal reordering ${t.pimStateService.isJournalReorderingEnabled()?"enabled":"disabled"}\n`,{message:o}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);var o;!function(e){e.JOURNALS="journals"}(o=t.FremontJsStatusParams||(t.FremontJsStatusParams={})),t.statusTextCommandHandler=async function statusTextCommandHandler(e,t,n){const i=t.pimStateService;let s="hub sync status = "+r.getSynchStatus();if(s+="\n"+t.pimStateService.state(),n.params.length>0){if(n.params[0]===o.JOURNALS){s+="\n",s+="Journal status\n\n";s+="Journal reordering: ",s+=(i.isJournalReorderingEnabled()?"Enabled":"Disabled")+"\n",s+=await r.listJournalQueue(e,t)}}return{message:s}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.NoJournalingSDK=void 0;const a=n(19),c=n(518),u=n(1200),l=n(1203);class NoJournalingSDK{constructor(e){this.config=e,this.registry=new c.CommandQueryRegistry,this.commandExecutor=new l.CommandExecutorLite(this.getRestClient(),this.registry,{commandPollingInterval:this.config.commandPollingInterval||100,commandPollingAttempts:this.config.commandPollingAttempts||120}),this._disposing=!1,this._pendingPromises=new Set}getType(){return"NoJournalingSDK"}on(e,t,n){throw new Error("This operation is not supported in this implementation of the Journaling.")}off(e){throw new Error("This operation is not supported in this implementation of the Journaling.")}registeredListeners(e){throw new Error("This operation is not supported in this implementation of the Journaling.")}async registerCommandsAndQueriesByPath(e){const t=await Promise.resolve().then(()=>s(n(21))),r=await Promise.resolve().then(()=>s(n(11)));if(!e||!t.existsSync(e))throw new a.JournalError(a.JournalErrorCode.L7_REGISTRATION_PATH_NOT_FOUND,"path="+e);if(t.lstatSync(e).isDirectory()){const n=t.readdirSync(e);for(let t=0;t<n.length;t++){const o=r.join(e,n[t]);await this.registerCommandsAndQueriesByPath(o)}}else try{const t=await Promise.resolve().then(()=>s(n(1204)(e)));this.registry.registerCommandsAndQueries(t)}catch(e){}}registerCommandsAndQueries(e){this.registry.registerCommandsAndQueries(e)}setAutoSynchronizationMode(e,t){throw new Error("This operation is not supported in this implementation of the Journaling.")}getAutoSynchronizationMode(e){throw new Error("This operation is not supported in this implementation of the Journaling.")}getRegisteredQuery(e){return this.registry.getRegisteredQuery(e)}getRegisteredQueries(){const e={};return this.registry.getRegisteredQueries().forEach((t,n)=>{e[n]=t}),e}async executeQuery(e,{queryName:t,parameters:n,traceContext:r},o){if(this._disposing)return Promise.reject(new a.JournalError(a.JournalErrorCode.L7_DISPOSING,a.JournalErrorCode.L7_DISPOSING.description));if(!t)throw new a.JournalError(a.JournalErrorCode.L7_GEN_NULL_VALUE,"queryName");if(!n)throw new a.JournalError(a.JournalErrorCode.L7_GEN_NULL_VALUE,"parameters");const i=this.registry.getRegisteredQuery(t);if(!i)throw new a.JournalError(a.JournalErrorCode.L7_QUERY_NOT_REGISTERED,`No query registered with name ${t}.`);let s=null;const c=(null==o?void 0:o.fetchMode)||a.FetchMode.ONLY_SERVER;if(!s&&c===a.FetchMode.ONLY_LOCAL)return[];const u=NoJournalingSDK.resolveURL(i,n),l=i.createPayload(n),d={url:u,method:i.httpMethod||"GET"};return"GET"===d.method?d.params=l:d.data=l,r&&(d.headers={traceparent:null==r?void 0:r.traceParent,tracestate:null==r?void 0:r.traceState}),s=await this.getRestClient().request(d),s=await i.processResults(void 0,s.data),s}getRegisteredCommand(e){return this.registry.getRegisteredCommand(e)}getRegisteredCommands(){const e={};return this.registry.getRegisteredCommands().forEach((t,n)=>{e[n]=t}),e}async executeCommand(e,{commandName:t,parameters:n}){if(!t)throw new a.JournalError(a.JournalErrorCode.L7_GEN_NULL_VALUE,"commandName");if(!n)throw new a.JournalError(a.JournalErrorCode.L7_GEN_NULL_VALUE,"parameters");return this.executeCommandBatch(e,[{commandName:t,parameters:n}],{}).then(([e])=>e)}async executeCommandBatch(e,t,n={}){return this._disposing?Promise.reject(new a.JournalError(a.JournalErrorCode.L7_DISPOSING,a.JournalErrorCode.L7_DISPOSING.description)):this.commandExecutor.executeBatch(t,e)}async createCollection({commandName:e,parameters:t},n){if(this._disposing)return Promise.reject(new a.JournalError(a.JournalErrorCode.L7_DISPOSING,a.JournalErrorCode.L7_DISPOSING.description));if(!e)throw new a.JournalError(a.JournalErrorCode.L7_GEN_NULL_VALUE,"commandName");if(!t)throw new a.JournalError(a.JournalErrorCode.L7_GEN_NULL_VALUE,"parameters");if(!this.registry.getRegisteredCommand(e))throw new a.JournalError(a.JournalErrorCode.L7_COMMAND_NOT_REGISTERED,`No command registered with name ${e}.`);const r=await this.commandExecutor.executeBatch([{commandName:e,parameters:t}]).then(([e])=>e);return{collectionId:r.collectionId,mainJournal:{journalId:"",parentJournalId:null,properties:{}},commandId:r.commandId,commandResult:r.result}}getRestClient(){var e,t,n,r,o,i,s;return u.getClient({getBearerToken:this.config.getBearerToken,baseURL:this.config.server+"/v1",retryCodes:(null===(e=this.config.clientConfig)||void 0===e?void 0:e.retryCodes)||a.DEFAULT_RETRY_CODES,retryErrors:(null===(t=this.config.clientConfig)||void 0===t?void 0:t.retryErrors)||a.DEFAULT_RETRY_ERRORS,headers:null===(n=this.config.clientConfig)||void 0===n?void 0:n.headers,retries:null===(r=this.config.clientConfig)||void 0===r?void 0:r.retries,proxy:null===(o=this.config.clientConfig)||void 0===o?void 0:o.proxy,keepAlive:null===(i=this.config.clientConfig)||void 0===i?void 0:i.keepAlive,socketTimeout:null===(s=this.config.clientConfig)||void 0===s?void 0:s.socketTimeout})}synchronizeJournals(e,t){return Promise.reject(new Error("This operation is not supported in this implementation of the Journaling."))}createIsolationJournal(e,t={}){return Promise.reject(new Error("This operation is not supported in this implementation of the Journaling."))}deleteIsolationJournal(e,t){return Promise.reject(new Error("This operation is not supported in this implementation of the Journaling."))}fetch(e){return Promise.reject(new Error("This operation is not supported in this implementation of the Journaling."))}rebase(e,t){return Promise.reject(new Error("This operation is not supported in this implementation of the Journaling."))}getJournals(e,t){return Promise.reject(new Error("This operation is not supported in this implementation of the Journaling."))}dropEntities(e,t){return Promise.reject(new Error("This operation is not supported in this implementation of the Journaling."))}static resolveURL(e,t){let n;if("string"==typeof e.serverQueryEndpoint){if(n=e.serverQueryEndpoint,n.indexOf("{")>-1||n.indexOf("}")>-1){if(null==n.match(/^([^{}]*{[^{}]*})*[^{}]*$/g))throw new a.JournalError(a.JournalErrorCode.L7_QUERY_DEFINITION_INVALID_URL,a.JournalErrorCode.L7_QUERY_DEFINITION_INVALID_URL.description);n=n.replace(/{.*?}/g,e=>{const n=t[e.substring(1,e.length-1)];if(void 0!==n)return encodeURIComponent(n);throw new a.JournalError(a.JournalErrorCode.L7_QUERY_DEFINITION_URL_PARAM_NOT_FOUND,e+" is missing from parameters")})}}else n=e.serverQueryEndpoint(t);return n}pull(e){return Promise.reject(new Error("This operation is not supported in this implementation of the Journaling."))}reset(e){return Promise.reject(new Error("This operation is not supported in this implementation of the Journaling."))}clearLocalStore(){return Promise.reject(new Error("This operation is not supported in this implementation of the Journaling."))}synchronizeWithServer(e){return Promise.reject(new Error("This operation is not supported in this implementation of the Journaling."))}updateJournalProperties(e,t){return Promise.reject(new Error("This operation is not supported in this implementation of the Journaling."))}getJournalCommands(e,t){return Promise.reject(new Error("This operation is not supported in this implementation of the Journaling."))}async setParentJournal(e,t,n){return Promise.reject(new Error("This operation is not supported in this implementation of the Journaling."))}async dispose(){this._disposing=!0,await Promise.all([...this._pendingPromises].map(e=>e.catch(e=>e)))}static observePromises(e,t,n){const r=n.value;return n.value=function observe(...e){const t=r.apply(this,e).finally(()=>{this._pendingPromises.delete(t)});return this._pendingPromises.add(t),t},n}}i([NoJournalingSDK.observePromises],NoJournalingSDK.prototype,"executeQuery",null),i([NoJournalingSDK.observePromises],NoJournalingSDK.prototype,"executeCommandBatch",null),i([NoJournalingSDK.observePromises],NoJournalingSDK.prototype,"createCollection",null),t.NoJournalingSDK=NoJournalingSDK},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getClient=t.getSingleInstance=void 0;const s=i(n(62)),a=i(n(37)),c=i(n(57)),u=i(n(1201));let l=null;const d={keepAlive:!0,timeout:3e4};t.getSingleInstance=async(e,t)=>(l||(l=new u.default(s.default,e),t&&"function"==typeof t.initializer&&await t.initializer(l)),l),t.getClient=e=>{const t=Object.assign(Object.assign(Object.assign({},d),e&&"boolean"==typeof e.keepAlive&&{keepAlive:e.keepAlive}),(null==e?void 0:e.socketTimeout)&&{timeout:e.socketTimeout}),n=new a.default.Agent(t),r=new c.default.Agent(t),o=s.default.create({httpAgent:n,httpsAgent:r});return o.defaults.validateStatus=()=>!0,new u.default(o,e,n,r)},o(n(1202),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CONFIG=t.PARALLEL_REQUESTS_LIMIT=void 0;const r=n(19);t.PARALLEL_REQUESTS_LIMIT=13,t.DEFAULT_CONFIG={retries:1,retriesInterval:100,maximumRetriesInterval:6e4,exponentialBackOff:!0,retryCodes:new Array,retryErrors:new Array,noRetryCodes:new Array,throwIfNotSuccess:!0};class Client{constructor(e,n,r,o){this.adapter=e,this.config=n,this.httpAgent=r,this.httpsAgent=o,this.pendingRequests={},this.config=Object.assign(Object.assign({},t.DEFAULT_CONFIG),n)}async request(e){const n=Object.assign(Object.assign(Object.assign({},t.DEFAULT_CONFIG),this.config),e||{});(!n.retries||n.retries<=0)&&(n.retries=1);return Client.httpRetry(()=>this.doRequestConcurrently(n),n)}async get(e,t){return this.request(Object.assign(Object.assign({},t),{url:e,method:"GET"}))}async delete(e,t){return this.request(Object.assign(Object.assign({},t),{url:e,method:"DELETE"}))}async head(e,t){return this.request(Object.assign(Object.assign({},t),{url:e,method:"HEAD"}))}async post(e,t,n){return this.request(Object.assign(Object.assign({},n),{url:e,method:"POST",data:t}))}async put(e,t,n){return this.request(Object.assign(Object.assign({},n),{url:e,method:"PUT",data:t}))}async patch(e,t,n){return this.request(Object.assign(Object.assign({},n),{url:e,method:"PATCH",data:t}))}dispose(){var e,t;null===(e=this.httpAgent)||void 0===e||e.destroy(),null===(t=this.httpsAgent)||void 0===t||t.destroy()}static isBrowser(){return"undefined"!=typeof window&&void 0!==window.document}static async httpRetry(e,n){let o,i=1,s=n.retriesInterval||t.DEFAULT_CONFIG.retriesInterval;return async function tryFn(){var t,a,c;let u,l,d,p;try{if(u=await e(),d=null===(t=n.retryCodes)||void 0===t?void 0:t.includes(null==u?void 0:u.status),p=null===(a=n.noRetryCodes)||void 0===a?void 0:a.includes(null==u?void 0:u.status),u.status>=200&&u.status<300)return u;if(!n.throwIfNotSuccess&&(!d||p))return u}catch(e){if(l=e,!(null===(c=n.retryErrors)||void 0===c?void 0:c.includes(null==l?void 0:l.code)))throw new r.JournalError(r.JournalErrorCode.L7_GEN_DOWNSTREAM_ERROR,`Request failed after ${i} attempt(s). With error: ${(null==l?void 0:l.message)||(null==l?void 0:l.stack)}.`,l)}if(i>=n.retries||u&&(!d||p)){if(u)throw new r.JournalError(r.JournalErrorCode.L7_GEN_DOWNSTREAM_ERROR,`Request failed after ${i} attempt(s). With status: ${u.status} and message: ${JSON.stringify(u.data)}.`,l,{status:u.status,statusMessage:u.statusText,data:u.data});throw new r.JournalError(r.JournalErrorCode.L7_GEN_DOWNSTREAM_ERROR,`Request failed after ${i} attempt(s). With error: ${(null==l?void 0:l.message)||(null==l?void 0:l.stack)}.`,l)}return i+=1,s*=n.exponentialBackOff?2:1,o=n.maximumRetriesInterval&&s>=n.maximumRetriesInterval?n.maximumRetriesInterval:s,h=tryFn,m=o,new Promise((e,t)=>{setTimeout(()=>{h().then(e).catch(t)},m)});var h,m}()}async doRequestConcurrently(e){let n;const r=e.setAuthHeader?await e.setAuthHeader(e.getBearerToken):await Client.setDefaultAuthHeader(e.getBearerToken),o=Object.assign(Object.assign({},e.headers),r);if(0!==Object.keys(o).length&&(e.headers=o),Client.isBrowser()){Object.values(this.pendingRequests).length===t.PARALLEL_REQUESTS_LIMIT&&await Promise.race(Object.values(this.pendingRequests));const r=(Math.random()*Math.random()).toString(16),deleteRequest=()=>delete this.pendingRequests[r];n=Promise.resolve().then(()=>this.adapter.request(e)),this.pendingRequests[r]=n.then(deleteRequest).catch(deleteRequest)}else n=this.adapter.request(e);return n}static async setDefaultAuthHeader(e){if(!e)return{};let t=await e();return t.startsWith("Bearer")||(t="Bearer "+t),{authorization:t}}}t.default=Client},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CommandExecutorLite=t.L2_BATCH_SIZE=void 0;const o=n(19),i=r(n(46)),s=n(1345),a=r(n(227)),c=n(518);function commandIsProcessed(e){return"FAILED"===e||"SUCCESS"===e}function validateServerResponseData(e){if(!e||!e.status||!e.commandId)throw new o.JournalError(o.JournalErrorCode.L7_GEN_DOWNSTREAM_ERROR,"The server response body is incomplete: no commandId and/or status were returned for the command/s.",void 0,e);if(!["SUCCESS","FAILED","STARTED","BLOCKED","NOT_PROCESSED"].includes(e.status))throw new o.JournalError(o.JournalErrorCode.L7_GEN_DOWNSTREAM_ERROR,`The command status ${e.status} in the server response is not supported by L7.`,void 0,e)}function validateCommandBatchResponse(e){var t;if(!e.data)throw new o.JournalError(o.JournalErrorCode.L7_GEN_DOWNSTREAM_ERROR,"The server response body is empty.",void 0,e.data);const n=e.data;(null!==(t=n.commands)&&void 0!==t?t:[n]).forEach(validateServerResponseData)}t.L2_BATCH_SIZE=100;class CommandExecutorLite{constructor(e,t,n){this.restClient=e,this.commandRegistry=t,this.config=n}async executeBatch(e,n,r){if(i.default(e.length>0,"Command batch cannot be empty"),i.default(e.length<=t.L2_BATCH_SIZE,"Command batch cannot be larger than "+t.L2_BATCH_SIZE),!n&&e.length>1)throw new o.JournalError(o.JournalErrorCode.L7_COMMAND_BATCH_EXECUTION_NOT_ALLOWED,"Commands cannot be executed in batch without a collection.");const s=e.map(e=>e.commandName===c.COMMAND_NOOP?null:this.commandRegistry.getRegisteredCommand(e.commandName)).indexOf(void 0);if(-1!==s)throw new o.JournalError(o.JournalErrorCode.L7_COMMAND_NOT_REGISTERED,`No command registered with name ${e[s].commandName}.`);CommandExecutorLite.validateBatchElementsDependentParameters(e);return n?this.executeCommandBatch(e,n,r):this.executeRootCommand(e[0])}static ifDependentParameter(e,t){if("string"==typeof e){const[n,r,...o]=e.split(".");"$"===n&&t(r,o)}}static mapDependentParameters(e,t){const n=[],r=a.default(e).map((function(e){this.key&&CommandExecutorLite.ifDependentParameter(this.key,(e,r)=>{n.push({path:this.path,newKey:t(e,r)})}),CommandExecutorLite.ifDependentParameter(e,(e,n)=>this.update(t(e,n)))})),o=[];let i=0;for(const e of n)o[e.path.length]=o[e.path.length]||[],o[e.path.length].push(i++);for(;o.length;){const e=o.pop()||[],t=[];for(const o of e){const e=n[o],i=[...e.path],s=i.pop(),c=a.default(r).get(i),u=c[s];t.push({parent:c,key:e.newKey,value:u}),delete c[s]}for(const e of t)e.parent[e.key]=e.value}return r}static mapDependentIntKeyParameters(e,t){return CommandExecutorLite.mapDependentParameters(e,(e,n)=>{const r=Number(e);return Number.isInteger(r)&&r>=0?t(r,n):`$.${e}.${n.join(".")}`})}static mapDependentParameterIndices(e,t){return CommandExecutorLite.mapDependentIntKeyParameters(e,(e,n)=>`$.${t(e)}.${n.join(".")}`)}static validateBatchElementsDependentParameters(e){e.forEach(({parameters:t,dependsOn:n},r)=>{const i=new Set(n);CommandExecutorLite.mapDependentParameters(t,(t,n)=>{const s=Number(t);if(!Number.isInteger(s)||s<0||s>=e.length)throw new o.JournalError(o.JournalErrorCode.L7_COMMAND_BATCH_BAD_DEPENDENT_PARAM,`Batch element at index ${r} has dependent parameter with dependency '${t}' which is not the index of another command in the same batch.`);if(!i.has(s))throw new o.JournalError(o.JournalErrorCode.L7_COMMAND_BATCH_BAD_DEPENDENT_PARAM,`Batch element at index ${r} uses dependency index ${s} in dependent parameter missing from element dependency list (dependsOn).`);return`$.${s}.${n.join(".")}`})})}async prepareCommandBatch(e,t){const n=new Array(e.length);e.forEach(({commandName:e,parameters:t},r)=>{const o=s.nanoid();n[r]={commandName:e,parameters:t,temporaryId:o,index:r}});const r=new Array(e.length);return await Promise.all(e.map(async({commandName:e,parameters:o,dependsOn:s},a)=>{const c=this.commandRegistry.getRegisteredCommand(e);i.default(c);let u=o;u=CommandExecutorLite.mapDependentParameterIndices(o,e=>n[e].temporaryId);const l=c.createPayload(u,c.userState),d=[...(s||[]).map(e=>n[e].temporaryId),...t||[]],p={commandType:c.serverCommandName,payload:l,temporaryId:n[a].temporaryId,dependsOn:d},{resourceId:h,metadata:m}=u;h&&(p.resourceId=h),m&&(p.metadata=m),r[a]=p})),{commandsData:n,requestPayload:r}}async executeCommandBatch(e,t,n){const{commandsData:r,requestPayload:o}=await this.prepareCommandBatch(e,n),i=await this.restClient.post(`collections/${t}/commands`,{commands:o});validateCommandBatchResponse(i);const s=[],a={},c=t?i.data.commands:[i.data];for(let e=0;e<c.length;e++){const t={commandId:c[e].commandId,status:c[e].status,commandName:r[e].commandName};a[t.commandId]={index:r[e].index,data:t},commandIsProcessed(c[e].status)||s.push(c[e].commandId)}const u=await this.waitForCollectionCommandBatchExecution(t,s,a);return e.map((e,t)=>u[t])}async executeRootCommand(e){const{requestPayload:t}=await this.prepareCommandBatch([e],[]),n=await this.restClient.post("commands",t[0]);validateServerResponseData(n.data);const r={commandId:n.data.commandId,status:n.data.status,commandName:e.commandName};let i,s,a=0;for(;!commandIsProcessed(r.status)&&a++<this.config.commandPollingAttempts;)i=await this.restClient.get("commands/"+r.commandId,{retries:this.config.commandPollingAttempts,retriesInterval:this.config.commandPollingInterval}),validateServerResponseData(i.data),r.status=i.data.status,commandIsProcessed(r.status)||await new Promise(e=>setTimeout(e,this.config.commandPollingInterval));r.status===o.CommandStatus.SUCCESS&&(s=i.data.result.resourceId);const c=await this.commandRegistry.getRegisteredCommand(e.commandName).processResults(void 0,i.data);return[{commandId:r.commandId,result:c,collectionId:s}]}async waitForCollectionCommandBatchExecution(e,t,n){const r=[...t],o={};let i=0;for(;r.length>0&&i++<this.config.commandPollingAttempts;){const[t,...i]=r;let s="commands/"+t;if(i.length>0){let n="?commandId="+t;i.length&&(n=`${n}&commandId=${i.join("&commandId=")}`),s=`collections/${e}/commands${n}`}const a=await this.restClient.get(s,{retries:this.config.commandPollingAttempts,retriesInterval:this.config.commandPollingInterval});validateCommandBatchResponse(a),r.splice(0,r.length);const c=a.data.commands?a.data.commands:[a.data];for(const e of c)if(commandIsProcessed(e.status)){n[e.commandId].data.status=e.status;const{data:t,index:r}=n[e.commandId];o[r]={commandId:e.commandId,result:await this.commandRegistry.getRegisteredCommand(t.commandName).processResults(void 0,e)}}else r.push(e.commandId);r.length>0&&await new Promise(e=>setTimeout(e,this.config.commandPollingInterval))}if(r.length>0)for(const e of r){const t=n[e];o[t.index]={commandId:e,result:await this.commandRegistry.getRegisteredCommand(t.data.commandName).processResults(void 0,{commandId:t.data.commandId,status:t.data.status})}}return o}}t.CommandExecutorLite=CommandExecutorLite},function(e,t){function webpackEmptyContext(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,e.exports=webpackEmptyContext,webpackEmptyContext.id=1204},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(1206),t),o(n(1207),t),o(n(1208),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){(function(e){(function(t){"use strict";function slice(e,t){t|=0;for(var n=Math.max(e.length-t,0),r=Array(n),o=0;o<n;o++)r[o]=e[t+o];return r}var apply=function(e){var t=slice(arguments,1);return function(){var n=slice(arguments);return e.apply(null,t.concat(n))}},initialParams=function(e){return function(){var t=slice(arguments),n=t.pop();e.call(this,t,n)}};function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var n="function"==typeof setImmediate&&setImmediate,r="object"==typeof process&&"function"==typeof process.nextTick;function fallback(e){setTimeout(e,0)}function wrap(e){return function(t){var n=slice(arguments,1);e((function(){t.apply(null,n)}))}}var o=wrap(n?setImmediate:r?process.nextTick:fallback);function asyncify(e){return initialParams((function(t,n){var r;try{r=e.apply(this,t)}catch(e){return n(e)}isObject(r)&&"function"==typeof r.then?r.then((function(e){invokeCallback(n,null,e)}),(function(e){invokeCallback(n,e.message?e:new Error(e))})):n(null,r)}))}function invokeCallback(e,t,n){try{e(t,n)}catch(e){o(rethrow,e)}}function rethrow(e){throw e}var i="function"==typeof Symbol;function isAsync(e){return i&&"AsyncFunction"===e[Symbol.toStringTag]}function wrapAsync(e){return isAsync(e)?asyncify(e):e}function applyEach$1(e){return function(t){var n=slice(arguments,1),r=initialParams((function(n,r){var o=this;return e(t,(function(e,t){wrapAsync(e).apply(o,n.concat(t))}),r)}));return n.length?r.apply(this,n):r}}var s="object"==typeof global&&global&&global.Object===Object&&global,a="object"==typeof self&&self&&self.Object===Object&&self,c=s||a||Function("return this")(),u=c.Symbol,l=Object.prototype,d=l.hasOwnProperty,p=l.toString,h=u?u.toStringTag:void 0,m=Object.prototype.toString,y=u?u.toStringTag:void 0;function baseGetTag(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":y&&y in Object(e)?function getRawTag(e){var t=d.call(e,h),n=e[h];try{e[h]=void 0;var r=!0}catch(e){}var o=p.call(e);return r&&(t?e[h]=n:delete e[h]),o}(e):function objectToString(e){return m.call(e)}(e)}function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function isArrayLike(e){return null!=e&&isLength(e.length)&&!function isFunction(e){if(!isObject(e))return!1;var t=baseGetTag(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}(e)}var g={};function noop(){}function once(e){return function(){if(null!==e){var t=e;e=null,t.apply(this,arguments)}}}var _="function"==typeof Symbol&&Symbol.iterator;function isObjectLike(e){return null!=e&&"object"==typeof e}function baseIsArguments(e){return isObjectLike(e)&&"[object Arguments]"==baseGetTag(e)}var v=Object.prototype,E=v.hasOwnProperty,I=v.propertyIsEnumerable,b=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike(e)&&E.call(e,"callee")&&!I.call(e,"callee")},S=Array.isArray,C="object"==typeof t&&t&&!t.nodeType&&t,w=C&&"object"==typeof e&&e&&!e.nodeType&&e,A=w&&w.exports===C?c.Buffer:void 0,O=(A?A.isBuffer:void 0)||function stubFalse(){return!1},P=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&P.test(e))&&e>-1&&e%1==0&&e<t}var D={};D["[object Float32Array]"]=D["[object Float64Array]"]=D["[object Int8Array]"]=D["[object Int16Array]"]=D["[object Int32Array]"]=D["[object Uint8Array]"]=D["[object Uint8ClampedArray]"]=D["[object Uint16Array]"]=D["[object Uint32Array]"]=!0,D["[object Arguments]"]=D["[object Array]"]=D["[object ArrayBuffer]"]=D["[object Boolean]"]=D["[object DataView]"]=D["[object Date]"]=D["[object Error]"]=D["[object Function]"]=D["[object Map]"]=D["[object Number]"]=D["[object Object]"]=D["[object RegExp]"]=D["[object Set]"]=D["[object String]"]=D["[object WeakMap]"]=!1;var x="object"==typeof t&&t&&!t.nodeType&&t,R=x&&"object"==typeof e&&e&&!e.nodeType&&e,N=R&&R.exports===x&&s.process,M=function(){try{var e=R&&R.require&&R.require("util").types;return e||N&&N.binding&&N.binding("util")}catch(e){}}(),L=M&&M.isTypedArray,j=L?function baseUnary(e){return function(t){return e(t)}}(L):function baseIsTypedArray(e){return isObjectLike(e)&&isLength(e.length)&&!!D[baseGetTag(e)]},k=Object.prototype.hasOwnProperty;function arrayLikeKeys(e,t){var n=S(e),r=!n&&b(e),o=!n&&!r&&O(e),i=!n&&!r&&!o&&j(e),s=n||r||o||i,a=s?function baseTimes(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],c=a.length;for(var u in e)!t&&!k.call(e,u)||s&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||isIndex(u,c))||a.push(u);return a}var F=Object.prototype,U=function overArg(e,t){return function(n){return e(t(n))}}(Object.keys,Object),V=Object.prototype.hasOwnProperty;function baseKeys(e){if(!function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||F)}(e))return U(e);var t=[];for(var n in Object(e))V.call(e,n)&&"constructor"!=n&&t.push(n);return t}function keys(e){return isArrayLike(e)?arrayLikeKeys(e):baseKeys(e)}function iterator(e){if(isArrayLike(e))return function createArrayIterator(e){var t=-1,n=e.length;return function next(){return++t<n?{value:e[t],key:t}:null}}(e);var t=function(e){return _&&e[_]&&e[_]()}(e);return t?function createES2015Iterator(e){var t=-1;return function next(){var n=e.next();return n.done?null:(t++,{value:n.value,key:t})}}(t):function createObjectIterator(e){var t=keys(e),n=-1,r=t.length;return function next(){var o=t[++n];return n<r?{value:e[o],key:o}:null}}(e)}function onlyOnce(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function _eachOfLimit(e){return function(t,n,r){if(r=once(r||noop),e<=0||!t)return r(null);var o=iterator(t),i=!1,s=0,a=!1;function iterateeCallback(e,t){if(s-=1,e)i=!0,r(e);else{if(t===g||i&&s<=0)return i=!0,r(null);a||replenish()}}function replenish(){for(a=!0;s<e&&!i;){var t=o();if(null===t)return i=!0,void(s<=0&&r(null));s+=1,n(t.value,t.key,onlyOnce(iterateeCallback))}a=!1}replenish()}}function eachOfLimit(e,t,n,r){_eachOfLimit(t)(e,wrapAsync(n),r)}function doLimit(e,t){return function(n,r,o){return e(n,t,r,o)}}function eachOfArrayLike(e,t,n){n=once(n||noop);var r=0,o=0,i=e.length;function iteratorCallback(e,t){e?n(e):++o!==i&&t!==g||n(null)}for(0===i&&n(null);r<i;r++)t(e[r],r,onlyOnce(iteratorCallback))}var B=doLimit(eachOfLimit,1/0),eachOf=function(e,t,n){(isArrayLike(e)?eachOfArrayLike:B)(e,wrapAsync(t),n)};function doParallel(e){return function(t,n,r){return e(eachOf,t,wrapAsync(n),r)}}function _asyncMap(e,t,n,r){r=r||noop,t=t||[];var o=[],i=0,s=wrapAsync(n);e(t,(function(e,t,n){var r=i++;s(e,(function(e,t){o[r]=t,n(e)}))}),(function(e){r(e,o)}))}var J=doParallel(_asyncMap),$=applyEach$1(J);function doParallelLimit(e){return function(t,n,r,o){return e(_eachOfLimit(n),t,wrapAsync(r),o)}}var G=doParallelLimit(_asyncMap),q=doLimit(G,1),H=applyEach$1(q);function arrayEach(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}var Y=function createBaseFor(e){return function(t,n,r){for(var o=-1,i=Object(t),s=r(t),a=s.length;a--;){var c=s[e?a:++o];if(!1===n(i[c],c,i))break}return t}}();function baseForOwn(e,t){return e&&Y(e,t,keys)}function baseIsNaN(e){return e!=e}function baseIndexOf(e,t,n){return t==t?function strictIndexOf(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}(e,t,n):function baseFindIndex(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}(e,baseIsNaN,n)}var auto=function(e,t,n){"function"==typeof t&&(n=t,t=null),n=once(n||noop);var r=keys(e).length;if(!r)return n(null);t||(t=r);var o={},i=0,s=!1,a=Object.create(null),c=[],u=[],l={};function enqueueTask(e,t){c.push((function(){!function runTask(e,t){if(!s){var r=onlyOnce((function(t,r){if(i--,arguments.length>2&&(r=slice(arguments,1)),t){var c={};baseForOwn(o,(function(e,t){c[t]=e})),c[e]=r,s=!0,a=Object.create(null),n(t,c)}else o[e]=r,taskComplete(e)}));i++;var c=wrapAsync(t[t.length-1]);t.length>1?c(o,r):c(r)}}(e,t)}))}function processQueue(){if(0===c.length&&0===i)return n(null,o);for(;c.length&&i<t;)c.shift()()}function taskComplete(e){arrayEach(a[e]||[],(function(e){e()})),processQueue()}function getDependents(t){var n=[];return baseForOwn(e,(function(e,r){S(e)&&baseIndexOf(e,t,0)>=0&&n.push(r)})),n}baseForOwn(e,(function(t,n){if(!S(t))return enqueueTask(n,[t]),void u.push(n);var r=t.slice(0,t.length-1),o=r.length;if(0===o)return enqueueTask(n,t),void u.push(n);l[n]=o,arrayEach(r,(function(i){if(!e[i])throw new Error("async.auto task `"+n+"` has a non-existent dependency `"+i+"` in "+r.join(", "));!function addListener(e,t){var n=a[e];n||(n=a[e]=[]),n.push(t)}(i,(function(){0==--o&&enqueueTask(n,t)}))}))})),function checkForDeadlocks(){for(var e,t=0;u.length;)e=u.pop(),t++,arrayEach(getDependents(e),(function(e){0==--l[e]&&u.push(e)}));if(t!==r)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}(),processQueue()};function arrayMap(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}var K=u?u.prototype:void 0,z=K?K.toString:void 0;function baseToString(e){if("string"==typeof e)return e;if(S(e))return arrayMap(e,baseToString)+"";if(function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&"[object Symbol]"==baseGetTag(e)}(e))return z?z.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function castSlice(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:function baseSlice(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(o);++r<o;)i[r]=e[r+t];return i}(e,t,n)}var W=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),Q="[\\ud800-\\udfff]",X="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Z="\\ud83c[\\udffb-\\udfff]",ee="[^\\ud800-\\udfff]",te="(?:\\ud83c[\\udde6-\\uddff]){2}",ne="[\\ud800-\\udbff][\\udc00-\\udfff]",re="(?:"+X+"|"+Z+")?",oe="[\\ufe0e\\ufe0f]?"+re+"(?:\\u200d(?:"+[ee,te,ne].join("|")+")[\\ufe0e\\ufe0f]?"+re+")*",ie="(?:"+[ee+X+"?",X,te,ne,Q].join("|")+")",se=RegExp(Z+"(?="+Z+")|"+ie+oe,"g");function stringToArray(e){return function hasUnicode(e){return W.test(e)}(e)?function unicodeToArray(e){return e.match(se)||[]}(e):function asciiToArray(e){return e.split("")}(e)}var ae=/^\s+|\s+$/g;function trim(e,t,n){if((e=function toString(e){return null==e?"":baseToString(e)}(e))&&(n||void 0===t))return e.replace(ae,"");if(!e||!(t=baseToString(t)))return e;var r=stringToArray(e),o=stringToArray(t);return castSlice(r,function charsStartIndex(e,t){for(var n=-1,r=e.length;++n<r&&baseIndexOf(t,e[n],0)>-1;);return n}(r,o),function charsEndIndex(e,t){for(var n=e.length;n--&&baseIndexOf(t,e[n],0)>-1;);return n}(r,o)+1).join("")}var ce=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,ue=/,/,le=/(=.+)?(\s*)$/,de=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function autoInject(e,t){var n={};baseForOwn(e,(function(e,t){var r,o=isAsync(e),i=!o&&1===e.length||o&&0===e.length;if(S(e))r=e.slice(0,-1),e=e[e.length-1],n[t]=r.concat(r.length>0?newTask:e);else if(i)n[t]=e;else{if(r=function parseParams(e){return e=(e=(e=(e=e.toString().replace(de,"")).match(ce)[2].replace(" ",""))?e.split(ue):[]).map((function(e){return trim(e.replace(le,""))}))}(e),0===e.length&&!o&&0===r.length)throw new Error("autoInject task functions require explicit parameters.");o||r.pop(),n[t]=r.concat(newTask)}function newTask(t,n){var o=arrayMap(r,(function(e){return t[e]}));o.push(n),wrapAsync(e).apply(null,o)}})),auto(n,t)}function DLL(){this.head=this.tail=null,this.length=0}function setInitial(e,t){e.length=1,e.head=e.tail=t}function queue(e,t,n){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var r=wrapAsync(e),i=0,s=[],a=!1;function _insert(e,t,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(u.started=!0,S(e)||(e=[e]),0===e.length&&u.idle())return o((function(){u.drain()}));for(var r=0,i=e.length;r<i;r++){var s={data:e[r],callback:n||noop};t?u._tasks.unshift(s):u._tasks.push(s)}a||(a=!0,o((function(){a=!1,u.process()})))}function _next(e){return function(t){i-=1;for(var n=0,r=e.length;n<r;n++){var o=e[n],a=baseIndexOf(s,o,0);0===a?s.shift():a>0&&s.splice(a,1),o.callback.apply(o,arguments),null!=t&&u.error(t,o.data)}i<=u.concurrency-u.buffer&&u.unsaturated(),u.idle()&&u.drain(),u.process()}}var c=!1,u={_tasks:new DLL,concurrency:t,payload:n,saturated:noop,unsaturated:noop,buffer:t/4,empty:noop,drain:noop,error:noop,started:!1,paused:!1,push:function(e,t){_insert(e,!1,t)},kill:function(){u.drain=noop,u._tasks.empty()},unshift:function(e,t){_insert(e,!0,t)},remove:function(e){u._tasks.remove(e)},process:function(){if(!c){for(c=!0;!u.paused&&i<u.concurrency&&u._tasks.length;){var e=[],t=[],n=u._tasks.length;u.payload&&(n=Math.min(n,u.payload));for(var o=0;o<n;o++){var a=u._tasks.shift();e.push(a),s.push(a),t.push(a.data)}i+=1,0===u._tasks.length&&u.empty(),i===u.concurrency&&u.saturated();var l=onlyOnce(_next(e));r(t,l)}c=!1}},length:function(){return u._tasks.length},running:function(){return i},workersList:function(){return s},idle:function(){return u._tasks.length+i===0},pause:function(){u.paused=!0},resume:function(){!1!==u.paused&&(u.paused=!1,o(u.process))}};return u}function cargo(e,t){return queue(e,1,t)}DLL.prototype.removeLink=function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e},DLL.prototype.empty=function(){for(;this.head;)this.shift();return this},DLL.prototype.insertAfter=function(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1},DLL.prototype.insertBefore=function(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1},DLL.prototype.unshift=function(e){this.head?this.insertBefore(this.head,e):setInitial(this,e)},DLL.prototype.push=function(e){this.tail?this.insertAfter(this.tail,e):setInitial(this,e)},DLL.prototype.shift=function(){return this.head&&this.removeLink(this.head)},DLL.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},DLL.prototype.toArray=function(){for(var e=Array(this.length),t=this.head,n=0;n<this.length;n++)e[n]=t.data,t=t.next;return e},DLL.prototype.remove=function(e){for(var t=this.head;t;){var n=t.next;e(t)&&this.removeLink(t),t=n}return this};var pe=doLimit(eachOfLimit,1);function reduce(e,t,n,r){r=once(r||noop);var o=wrapAsync(n);pe(e,(function(e,n,r){o(t,e,(function(e,n){t=n,r(e)}))}),(function(e){r(e,t)}))}function seq(){var e=arrayMap(arguments,wrapAsync);return function(){var t=slice(arguments),n=this,r=t[t.length-1];"function"==typeof r?t.pop():r=noop,reduce(e,t,(function(e,t,r){t.apply(n,e.concat((function(e){var t=slice(arguments,1);r(e,t)})))}),(function(e,t){r.apply(n,[e].concat(t))}))}}var compose=function(){return seq.apply(null,slice(arguments).reverse())},he=Array.prototype.concat,concatLimit=function(e,t,n,r){r=r||noop;var o=wrapAsync(n);G(e,t,(function(e,t){o(e,(function(e){return e?t(e):t(null,slice(arguments,1))}))}),(function(e,t){for(var n=[],o=0;o<t.length;o++)t[o]&&(n=he.apply(n,t[o]));return r(e,n)}))},fe=doLimit(concatLimit,1/0),me=doLimit(concatLimit,1),constant=function(){var e=slice(arguments),t=[null].concat(e);return function(){var e=arguments[arguments.length-1];return e.apply(this,t)}};function identity(e){return e}function _createTester(e,t){return function(n,r,o,i){i=i||noop;var s,a=!1;n(r,(function(n,r,i){o(n,(function(r,o){r?i(r):e(o)&&!s?(a=!0,s=t(!0,n),i(null,g)):i()}))}),(function(e){e?i(e):i(null,a?s:t(!1))}))}}function _findGetResult(e,t){return t}var ye=doParallel(_createTester(identity,_findGetResult)),ge=doParallelLimit(_createTester(identity,_findGetResult)),_e=doLimit(ge,1);function consoleFunc(e){return function(t){var n=slice(arguments,1);n.push((function(t){var n=slice(arguments,1);"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&arrayEach(n,(function(t){console[e](t)})))})),wrapAsync(t).apply(null,n)}}var ve=consoleFunc("dir");function doDuring(e,t,n){n=onlyOnce(n||noop);var r=wrapAsync(e),o=wrapAsync(t);function next(e){if(e)return n(e);var t=slice(arguments,1);t.push(check),o.apply(this,t)}function check(e,t){return e?n(e):t?void r(next):n(null)}check(null,!0)}function doWhilst(e,t,n){n=onlyOnce(n||noop);var r=wrapAsync(e),next=function(e){if(e)return n(e);var o=slice(arguments,1);if(t.apply(this,o))return r(next);n.apply(null,[null].concat(o))};r(next)}function doUntil(e,t,n){doWhilst(e,(function(){return!t.apply(this,arguments)}),n)}function during(e,t,n){n=onlyOnce(n||noop);var r=wrapAsync(t),o=wrapAsync(e);function next(e){if(e)return n(e);o(check)}function check(e,t){return e?n(e):t?void r(next):n(null)}o(check)}function _withoutIndex(e){return function(t,n,r){return e(t,r)}}function eachLimit(e,t,n){eachOf(e,_withoutIndex(wrapAsync(t)),n)}function eachLimit$1(e,t,n,r){_eachOfLimit(t)(e,_withoutIndex(wrapAsync(n)),r)}var Ee=doLimit(eachLimit$1,1);function ensureAsync(e){return isAsync(e)?e:initialParams((function(t,n){var r=!0;t.push((function(){var e=arguments;r?o((function(){n.apply(null,e)})):n.apply(null,e)})),e.apply(this,t),r=!1}))}function notId(e){return!e}var Ie=doParallel(_createTester(notId,notId)),be=doParallelLimit(_createTester(notId,notId)),Se=doLimit(be,1);function baseProperty(e){return function(t){return null==t?void 0:t[e]}}function filterArray(e,t,n,r){var o=new Array(t.length);e(t,(function(e,t,r){n(e,(function(e,n){o[t]=!!n,r(e)}))}),(function(e){if(e)return r(e);for(var n=[],i=0;i<t.length;i++)o[i]&&n.push(t[i]);r(null,n)}))}function filterGeneric(e,t,n,r){var o=[];e(t,(function(e,t,r){n(e,(function(n,i){n?r(n):(i&&o.push({index:t,value:e}),r())}))}),(function(e){e?r(e):r(null,arrayMap(o.sort((function(e,t){return e.index-t.index})),baseProperty("value")))}))}function _filter(e,t,n,r){(isArrayLike(t)?filterArray:filterGeneric)(e,t,wrapAsync(n),r||noop)}var Ce=doParallel(_filter),we=doParallelLimit(_filter),Ae=doLimit(we,1);function forever(e,t){var n=onlyOnce(t||noop),r=wrapAsync(ensureAsync(e));!function next(e){if(e)return n(e);r(next)}()}var groupByLimit=function(e,t,n,r){r=r||noop;var o=wrapAsync(n);G(e,t,(function(e,t){o(e,(function(n,r){return n?t(n):t(null,{key:r,val:e})}))}),(function(e,t){for(var n={},o=Object.prototype.hasOwnProperty,i=0;i<t.length;i++)if(t[i]){var s=t[i].key,a=t[i].val;o.call(n,s)?n[s].push(a):n[s]=[a]}return r(e,n)}))},Oe=doLimit(groupByLimit,1/0),Te=doLimit(groupByLimit,1),Pe=consoleFunc("log");function mapValuesLimit(e,t,n,r){r=once(r||noop);var o={},i=wrapAsync(n);eachOfLimit(e,t,(function(e,t,n){i(e,t,(function(e,r){if(e)return n(e);o[t]=r,n()}))}),(function(e){r(e,o)}))}var De=doLimit(mapValuesLimit,1/0),xe=doLimit(mapValuesLimit,1);function has(e,t){return t in e}function memoize(e,t){var n=Object.create(null),r=Object.create(null);t=t||identity;var i=wrapAsync(e),s=initialParams((function memoized(e,s){var a=t.apply(null,e);has(n,a)?o((function(){s.apply(null,n[a])})):has(r,a)?r[a].push(s):(r[a]=[s],i.apply(null,e.concat((function(){var e=slice(arguments);n[a]=e;var t=r[a];delete r[a];for(var o=0,i=t.length;o<i;o++)t[o].apply(null,e)}))))}));return s.memo=n,s.unmemoized=e,s}var Re=wrap(r?process.nextTick:n?setImmediate:fallback);function _parallel(e,t,n){n=n||noop;var r=isArrayLike(t)?[]:{};e(t,(function(e,t,n){wrapAsync(e)((function(e,o){arguments.length>2&&(o=slice(arguments,1)),r[t]=o,n(e)}))}),(function(e){n(e,r)}))}function parallelLimit(e,t){_parallel(eachOf,e,t)}function parallelLimit$1(e,t,n){_parallel(_eachOfLimit(t),e,n)}var queue$1=function(e,t){var n=wrapAsync(e);return queue((function(e,t){n(e[0],t)}),t,1)},priorityQueue=function(e,t){var n=queue$1(e,t);return n.push=function(e,t,r){if(null==r&&(r=noop),"function"!=typeof r)throw new Error("task callback must be a function");if(n.started=!0,S(e)||(e=[e]),0===e.length)return o((function(){n.drain()}));t=t||0;for(var i=n._tasks.head;i&&t>=i.priority;)i=i.next;for(var s=0,a=e.length;s<a;s++){var c={data:e[s],priority:t,callback:r};i?n._tasks.insertBefore(i,c):n._tasks.push(c)}o(n.process)},delete n.unshift,n};function race(e,t){if(t=once(t||noop),!S(e))return t(new TypeError("First argument to race must be an array of functions"));if(!e.length)return t();for(var n=0,r=e.length;n<r;n++)wrapAsync(e[n])(t)}function reduceRight(e,t,n,r){reduce(slice(e).reverse(),t,n,r)}function reflect(e){var t=wrapAsync(e);return initialParams((function reflectOn(e,n){return e.push((function callback(e,t){var r;e?n(null,{error:e}):(r=arguments.length<=2?t:slice(arguments,1),n(null,{value:r}))})),t.apply(this,e)}))}function reflectAll(e){var t;return S(e)?t=arrayMap(e,reflect):(t={},baseForOwn(e,(function(e,n){t[n]=reflect.call(this,e)}))),t}function reject$1(e,t,n,r){_filter(e,t,(function(e,t){n(e,(function(e,n){t(e,!n)}))}),r)}var Ne=doParallel(reject$1),Me=doParallelLimit(reject$1),Le=doLimit(Me,1);function constant$1(e){return function(){return e}}function retry(e,t,n){var r=5,o=0,i={times:r,intervalFunc:constant$1(o)};function parseTimes(e,t){if("object"==typeof t)e.times=+t.times||r,e.intervalFunc="function"==typeof t.interval?t.interval:constant$1(+t.interval||o),e.errorFilter=t.errorFilter;else{if("number"!=typeof t&&"string"!=typeof t)throw new Error("Invalid arguments for async.retry");e.times=+t||r}}if(arguments.length<3&&"function"==typeof e?(n=t||noop,t=e):(parseTimes(i,e),n=n||noop),"function"!=typeof t)throw new Error("Invalid arguments for async.retry");var s=wrapAsync(t),a=1;function retryAttempt(){s((function(e){e&&a++<i.times&&("function"!=typeof i.errorFilter||i.errorFilter(e))?setTimeout(retryAttempt,i.intervalFunc(a)):n.apply(null,arguments)}))}retryAttempt()}var retryable=function(e,t){t||(t=e,e=null);var n=wrapAsync(t);return initialParams((function(t,r){function taskFn(e){n.apply(null,t.concat(e))}e?retry(e,taskFn,r):retry(taskFn,r)}))};function series(e,t){_parallel(pe,e,t)}var je=doParallel(_createTester(Boolean,identity)),ke=doParallelLimit(_createTester(Boolean,identity)),Fe=doLimit(ke,1);function sortBy(e,t,n){var r=wrapAsync(t);function comparator(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0}J(e,(function(e,t){r(e,(function(n,r){if(n)return t(n);t(null,{value:e,criteria:r})}))}),(function(e,t){if(e)return n(e);n(null,arrayMap(t.sort(comparator),baseProperty("value")))}))}function timeout(e,t,n){var r=wrapAsync(e);return initialParams((function(o,i){var s,a=!1;o.push((function(){a||(i.apply(null,arguments),clearTimeout(s))})),s=setTimeout((function timeoutCallback(){var t=e.name||"anonymous",r=new Error('Callback function "'+t+'" timed out.');r.code="ETIMEDOUT",n&&(r.info=n),a=!0,i(r)}),t),r.apply(null,o)}))}var Ue=Math.ceil,Ve=Math.max;function timeLimit(e,t,n,r){var o=wrapAsync(n);G(function baseRange(e,t,n,r){for(var o=-1,i=Ve(Ue((t-e)/(n||1)),0),s=Array(i);i--;)s[r?i:++o]=e,e+=n;return s}(0,e,1),t,o,r)}var Be=doLimit(timeLimit,1/0),Je=doLimit(timeLimit,1);function transform(e,t,n,r){arguments.length<=3&&(r=n,n=t,t=S(e)?[]:{}),r=once(r||noop);var o=wrapAsync(n);eachOf(e,(function(e,n,r){o(t,e,n,r)}),(function(e){r(e,t)}))}function tryEach(e,t){var n,r=null;t=t||noop,Ee(e,(function(e,t){wrapAsync(e)((function(e,o){n=arguments.length>2?slice(arguments,1):o,r=e,t(!e)}))}),(function(){t(r,n)}))}function unmemoize(e){return function(){return(e.unmemoized||e).apply(null,arguments)}}function whilst(e,t,n){n=onlyOnce(n||noop);var r=wrapAsync(t);if(!e())return n(null);var next=function(t){if(t)return n(t);if(e())return r(next);var o=slice(arguments,1);n.apply(null,[null].concat(o))};r(next)}function until(e,t,n){whilst((function(){return!e.apply(this,arguments)}),t,n)}var waterfall=function(e,t){if(t=once(t||noop),!S(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var n=0;function nextTask(t){var r=wrapAsync(e[n++]);t.push(onlyOnce(next)),r.apply(null,t)}function next(r){if(r||n===e.length)return t.apply(null,arguments);nextTask(slice(arguments,1))}nextTask([])},$e={apply:apply,applyEach:$,applyEachSeries:H,asyncify:asyncify,auto:auto,autoInject:autoInject,cargo:cargo,compose:compose,concat:fe,concatLimit:concatLimit,concatSeries:me,constant:constant,detect:ye,detectLimit:ge,detectSeries:_e,dir:ve,doDuring:doDuring,doUntil:doUntil,doWhilst:doWhilst,during:during,each:eachLimit,eachLimit:eachLimit$1,eachOf:eachOf,eachOfLimit:eachOfLimit,eachOfSeries:pe,eachSeries:Ee,ensureAsync:ensureAsync,every:Ie,everyLimit:be,everySeries:Se,filter:Ce,filterLimit:we,filterSeries:Ae,forever:forever,groupBy:Oe,groupByLimit:groupByLimit,groupBySeries:Te,log:Pe,map:J,mapLimit:G,mapSeries:q,mapValues:De,mapValuesLimit:mapValuesLimit,mapValuesSeries:xe,memoize:memoize,nextTick:Re,parallel:parallelLimit,parallelLimit:parallelLimit$1,priorityQueue:priorityQueue,queue:queue$1,race:race,reduce:reduce,reduceRight:reduceRight,reflect:reflect,reflectAll:reflectAll,reject:Ne,rejectLimit:Me,rejectSeries:Le,retry:retry,retryable:retryable,seq:seq,series:series,setImmediate:o,some:je,someLimit:ke,someSeries:Fe,sortBy:sortBy,timeout:timeout,times:Be,timesLimit:timeLimit,timesSeries:Je,transform:transform,tryEach:tryEach,unmemoize:unmemoize,until:until,waterfall:waterfall,whilst:whilst,all:Ie,allLimit:be,allSeries:Se,any:je,anyLimit:ke,anySeries:Fe,find:ye,findLimit:ge,findSeries:_e,forEach:eachLimit,forEachSeries:Ee,forEachLimit:eachLimit$1,forEachOf:eachOf,forEachOfSeries:pe,forEachOfLimit:eachOfLimit,inject:reduce,foldl:reduce,foldr:reduceRight,select:Ce,selectLimit:we,selectSeries:Ae,wrapSync:asyncify};t.default=$e,t.apply=apply,t.applyEach=$,t.applyEachSeries=H,t.asyncify=asyncify,t.auto=auto,t.autoInject=autoInject,t.cargo=cargo,t.compose=compose,t.concat=fe,t.concatLimit=concatLimit,t.concatSeries=me,t.constant=constant,t.detect=ye,t.detectLimit=ge,t.detectSeries=_e,t.dir=ve,t.doDuring=doDuring,t.doUntil=doUntil,t.doWhilst=doWhilst,t.during=during,t.each=eachLimit,t.eachLimit=eachLimit$1,t.eachOf=eachOf,t.eachOfLimit=eachOfLimit,t.eachOfSeries=pe,t.eachSeries=Ee,t.ensureAsync=ensureAsync,t.every=Ie,t.everyLimit=be,t.everySeries=Se,t.filter=Ce,t.filterLimit=we,t.filterSeries=Ae,t.forever=forever,t.groupBy=Oe,t.groupByLimit=groupByLimit,t.groupBySeries=Te,t.log=Pe,t.map=J,t.mapLimit=G,t.mapSeries=q,t.mapValues=De,t.mapValuesLimit=mapValuesLimit,t.mapValuesSeries=xe,t.memoize=memoize,t.nextTick=Re,t.parallel=parallelLimit,t.parallelLimit=parallelLimit$1,t.priorityQueue=priorityQueue,t.queue=queue$1,t.race=race,t.reduce=reduce,t.reduceRight=reduceRight,t.reflect=reflect,t.reflectAll=reflectAll,t.reject=Ne,t.rejectLimit=Me,t.rejectSeries=Le,t.retry=retry,t.retryable=retryable,t.seq=seq,t.series=series,t.setImmediate=o,t.some=je,t.someLimit=ke,t.someSeries=Fe,t.sortBy=sortBy,t.timeout=timeout,t.times=Be,t.timesLimit=timeLimit,t.timesSeries=Je,t.transform=transform,t.tryEach=tryEach,t.unmemoize=unmemoize,t.until=until,t.waterfall=waterfall,t.whilst=whilst,t.all=Ie,t.allLimit=be,t.allSeries=Se,t.any=je,t.anyLimit=ke,t.anySeries=Fe,t.find=ye,t.findLimit=ge,t.findSeries=_e,t.forEach=eachLimit,t.forEachSeries=Ee,t.forEachLimit=eachLimit$1,t.forEachOf=eachOf,t.forEachOfSeries=pe,t.forEachOfLimit=eachOfLimit,t.inject=reduce,t.foldl=reduce,t.foldr=reduceRight,t.select=Ce,t.selectLimit=we,t.selectSeries=Ae,t.wrapSync=asyncify,Object.defineProperty(t,"__esModule",{value:!0})})(t)}).call(this,n(34)(e))},function(e,t,n){var r,o,i=n(497),s=n(240),a=0,c=0;e.exports=function v1(e,t,n){var u=t&&n||0,l=t||[],d=(e=e||{}).node||r,p=void 0!==e.clockseq?e.clockseq:o;if(null==d||null==p){var h=i();null==d&&(d=r=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==p&&(p=o=16383&(h[6]<<8|h[7]))}var m=void 0!==e.msecs?e.msecs:(new Date).getTime(),y=void 0!==e.nsecs?e.nsecs:c+1,g=m-a+(y-c)/1e4;if(g<0&&void 0===e.clockseq&&(p=p+1&16383),(g<0||m>a)&&void 0===e.nsecs&&(y=0),y>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=m,c=y,o=p;var _=(1e4*(268435455&(m+=122192928e5))+y)%4294967296;l[u++]=_>>>24&255,l[u++]=_>>>16&255,l[u++]=_>>>8&255,l[u++]=255&_;var v=m/4294967296*1e4&268435455;l[u++]=v>>>8&255,l[u++]=255&v,l[u++]=v>>>24&15|16,l[u++]=v>>>16&255,l[u++]=p>>>8|128,l[u++]=255&p;for(var E=0;E<6;++E)l[u+E]=d[E];return t||s(l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),o=n(173);t.purgeRelationshipCommands=async function purgeRelationshipCommands(e,t,n){const i=await t.getProperties(),s=i[o.JOURNAL_PIM_PROPERTIES.ROOT_ITEM_ID],a=i[o.JOURNAL_PIM_PROPERTIES.SNAPSHOT_ID];if(!s||!a)throw new Error(`Cannot find root item or snapshot in journal ${t.getId()}. rootItemId: ${s}\n localSnapshot: ${a}\n Properties: `+JSON.stringify(i));const c=e.getNewInstanceExperimental({journalMappings:{collections:{[n]:t.getId()}}}),u=await c.getAsset(s,n),l=r.getFamilyFromTypeid(u.getTypeId()).family,d=[];l===r.PIM_FAMILY.DOCUMENTATION?d.push(...await c.pimGetDescribesFromDocumentation(n,s,a)):l===r.PIM_FAMILY.PRODUCT?d.push(...await c.pimGetAssemblyRefFromProduct(n,s,a,{boundaries:r.XrefBoundaries.SNAPSHOT})):console.log(`Typeid ${u.getTypeId()} of rootItem ${u.getId()} in journal ${t.getId()} is not Documentation or Product. Relationship commands will not be purged.`);for(const e of d)console.log("Purging commands of relationship "+e.getId()),await t.purgeCommandsForEntity(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(8),i=n(5),s=n(521),a=n(117),c=n(1213);t.rootProductAndVersionSnapshotFetcher=async function rootProductAndVersionSnapshotFetcher(e,t,n,u){const l=u.ToWipVersionUrn,d=u.ToWipLineageUrn,{options:p}=t;if(p.pimStateService.isJournalReorderingEnabled()){const n=await s.findLocalRootProductAndSnapshot(t,e.spaceCollectionId,u.ToDocId,u.ToWipLineageUrn,u.ToLocalFileVersion);if(void 0!==n)return n}if(!l)throw new o.PimError(o.GEN_INVALID_INPUT,`Could not create an external assemblyRef without a version in WIP (componentIds ${u.SourceId} and ${u.TargetId})`);if(!d)throw new o.PimError(o.GEN_INVALID_INPUT,`Cannot create an external assemblyRef without a lineage in WIP at this time (componentIds ${u.SourceId} and ${u.TargetId})`);if(u.ToDocId){const t=(await a.getSdkForSpaceCollectionId(e.spaceCollectionId,p,u.ToWipLineageUrn,u.ToDocId,u.ToLocalFileVersion)).journal;if(void 0!==t&&t.getType()===r.JournalType.ISOLATED)throw new Error("[rootProductAndVersionSnapshotFetcher]: Does not support local references yet")}const h=t.pimsdk.getNewInstanceExperimental({journalMappings:{default:r.JournalType.REMOTE}});return await c.retryOnSyncCompleted(async()=>await t.pimsdk.pimFindRootProductAndVersionSnapshot(n,l),async()=>{const t=i.getDocumentSyncFromLineage(d);if(void 0!==t)return t;const{spaceCollectionId:n}=e,r=await h.pimFindRootItem(n,d);if(!r)throw new Error("[onPostSave] Can not find the root product for lineage "+d);return i.documentRootSync(h,n,r)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.retryOnSyncCompleted=async function retryOnSyncCompleted(e,t){const n=await e();if(void 0!==n)return n;const r=t();return r?(await r,e()):n}},function(e,t,n){"use strict";e.exports={name:"@adsk/fremont-js-lib",version:"2.4.14",pimSolutionVersion:"<unknown-version>",buildNumber:"7",revision:"d1c1e079b1eba15119d298375466bdb64a5cd3cb",dependencies:{"@adsk/fd-ag-sync":"1.6.17","@adsk/fd-modeling-sdk":"2.12.6","@adsk/fd-property-sets":"0.0.19","@adsk/fd-store-sqlite":"0.3.12","@adsk/fdsdk-journal":"0.13.10","@adsk/fdsdk-l7-lite":"0.3.13","@adsk/ft-client":"1.1.1","@adsk/oauth-client":"1.0.0-trunk","@adsk/pim-sdk":"2.2.0"}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(523),i=n(49),s=n(53),a=n(5),c=r(n(11));t.clearUserCacheCommandHandler=async function clearUserCacheCommandHandler(e,t){if(!t.userFolder)return void i.reportTelemetry({componentName:"clearUserCache",componentAttributes:{extInfo:i.ReportType.ClearUserCache,misc:"No user directory provided"},logLocation:i.LogLocation.All,logLevel:i.LogLevel.Warning});const n=await async function extractSpaceCollectionIds(e){const t=o.glob.sync(e+"/co.*_v2.sql"),n=[];return await Promise.all(t.map(async e=>{const t=new RegExp(`(co.[^\\${c.default.sep}]+)_v2.sql$`,"gm").exec(e);t&&n.push(t[1])})),n}(t.userFolder),r=Object.values(a.getSdkList()).map(e=>e.spaceCollectionId),u=n.filter(e=>!r.includes(e)),l=new s.JournalService;await Promise.all(u.map(async n=>{var r;const o={spaceCollectionId:n,testing:e.testing},{journalSDK:s}=await l.initSDK(o,t),a=null===(r=await s.getJournals(n))||void 0===r?void 0:r.isolationJournals;if(a&&a.length>0)i.reportTelemetry({componentName:"clearUserCache",componentAttributes:{extInfo:i.ReportType.ClearUserCache,misc:`Will not delete cache for ${n} - pending uploads found`},logLocation:i.LogLocation.Console,logLevel:i.LogLevel.Warning});else try{await s.dispose(),l.removeDatabaseFiles(o,t),i.reportTelemetry({componentName:"clearUserCache",componentAttributes:{extInfo:i.ReportType.ClearUserCache,misc:"Deleted cache file for "+n},logLocation:i.LogLocation.Console,logLevel:i.LogLevel.Info})}catch(e){i.reportTelemetry({componentName:"clearUserCache",componentAttributes:{extInfo:i.ReportType.ClearUserCache,misc:"Failed to delete cache files for "+n},logLocation:i.LogLocation.Console,logLevel:i.LogLevel.Severe})}}))}},function(e,t,n){var r=n(11),o="win32"===process.platform,i=n(21),s=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function maybeCallback(e){return"function"==typeof e?e:function rethrow(){var e;if(s){var t=new Error;e=function debugCallback(e){e&&(t.message=e.message,missingCallback(e=t))}}else e=missingCallback;return e;function missingCallback(e){if(e){if(process.throwDeprecation)throw e;if(!process.noDeprecation){var t="fs: missing callback "+(e.stack||e.message);process.traceDeprecation?console.trace(t):console.error(t)}}}}()}r.normalize;if(o)var a=/(.*?)(?:[\/\\]+|$)/g;else a=/(.*?)(?:[\/]+|$)/g;if(o)var c=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else c=/^[\/]*/;t.realpathSync=function realpathSync(e,t){if(e=r.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return t[e];var n,s,u,l,d=e,p={},h={};function start(){var t=c.exec(e);n=t[0].length,s=t[0],u=t[0],l="",o&&!h[u]&&(i.lstatSync(u),h[u]=!0)}for(start();n<e.length;){a.lastIndex=n;var m=a.exec(e);if(l=s,s+=m[0],u=l+m[1],n=a.lastIndex,!(h[u]||t&&t[u]===u)){var y;if(t&&Object.prototype.hasOwnProperty.call(t,u))y=t[u];else{var g=i.lstatSync(u);if(!g.isSymbolicLink()){h[u]=!0,t&&(t[u]=u);continue}var _=null;if(!o){var v=g.dev.toString(32)+":"+g.ino.toString(32);p.hasOwnProperty(v)&&(_=p[v])}null===_&&(i.statSync(u),_=i.readlinkSync(u)),y=r.resolve(l,_),t&&(t[u]=y),o||(p[v]=_)}e=r.resolve(y,e.slice(n)),start()}}return t&&(t[d]=e),e},t.realpath=function realpath(e,t,n){if("function"!=typeof n&&(n=maybeCallback(t),t=null),e=r.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return process.nextTick(n.bind(null,null,t[e]));var s,u,l,d,p=e,h={},m={};function start(){var t=c.exec(e);s=t[0].length,u=t[0],l=t[0],d="",o&&!m[l]?i.lstat(l,(function(e){if(e)return n(e);m[l]=!0,LOOP()})):process.nextTick(LOOP)}function LOOP(){if(s>=e.length)return t&&(t[p]=e),n(null,e);a.lastIndex=s;var r=a.exec(e);return d=u,u+=r[0],l=d+r[1],s=a.lastIndex,m[l]||t&&t[l]===l?process.nextTick(LOOP):t&&Object.prototype.hasOwnProperty.call(t,l)?gotResolvedLink(t[l]):i.lstat(l,gotStat)}function gotStat(e,r){if(e)return n(e);if(!r.isSymbolicLink())return m[l]=!0,t&&(t[l]=l),process.nextTick(LOOP);if(!o){var s=r.dev.toString(32)+":"+r.ino.toString(32);if(h.hasOwnProperty(s))return gotTarget(null,h[s],l)}i.stat(l,(function(e){if(e)return n(e);i.readlink(l,(function(e,t){o||(h[s]=t),gotTarget(e,t)}))}))}function gotTarget(e,o,i){if(e)return n(e);var s=r.resolve(d,o);t&&(t[i]=s),gotResolvedLink(s)}function gotResolvedLink(t){e=r.resolve(t,e.slice(s)),start()}start()}},function(e,t,n){var r=n(1218),o=n(1219);e.exports=function expandTop(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return function expand(e,t){var n=[],i=o("{","}",e);if(!i||/\$$/.test(i.pre))return[e];var s,c=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),l=c||u,d=i.body.indexOf(",")>=0;if(!l&&!d)return i.post.match(/,.*\}/)?(e=i.pre+"{"+i.body+a+i.post,expand(e)):[e];if(l)s=i.body.split(/\.\./);else{if(1===(s=function parseCommaParts(e){if(!e)return[""];var t=[],n=o("{","}",e);if(!n)return e.split(",");var r=n.pre,i=n.body,s=n.post,a=r.split(",");a[a.length-1]+="{"+i+"}";var c=parseCommaParts(s);s.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c));return t.push.apply(t,a),t}(i.body)).length)if(1===(s=expand(s[0],!1).map(embrace)).length)return(m=i.post.length?expand(i.post,!1):[""]).map((function(e){return i.pre+s[0]+e}))}var p,h=i.pre,m=i.post.length?expand(i.post,!1):[""];if(l){var y=numeric(s[0]),g=numeric(s[1]),_=Math.max(s[0].length,s[1].length),v=3==s.length?Math.abs(numeric(s[2])):1,E=lte;g<y&&(v*=-1,E=gte);var I=s.some(isPadded);p=[];for(var b=y;E(b,g);b+=v){var S;if(u)"\\"===(S=String.fromCharCode(b))&&(S="");else if(S=String(b),I){var C=_-S.length;if(C>0){var w=new Array(C+1).join("0");S=b<0?"-"+w+S.slice(1):w+S}}p.push(S)}}else p=r(s,(function(e){return expand(e,!1)}));for(var A=0;A<p.length;A++)for(var O=0;O<m.length;O++){var P=h+p[A]+m[O];(!t||l||P)&&n.push(P)}return n}(function escapeBraces(e){return e.split("\\\\").join(i).split("\\{").join(s).split("\\}").join(a).split("\\,").join(c).split("\\.").join(u)}(e),!0).map(unescapeBraces)};var i="\0SLASH"+Math.random()+"\0",s="\0OPEN"+Math.random()+"\0",a="\0CLOSE"+Math.random()+"\0",c="\0COMMA"+Math.random()+"\0",u="\0PERIOD"+Math.random()+"\0";function numeric(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function unescapeBraces(e){return e.split(i).join("\\").split(s).join("{").split(a).join("}").split(c).join(",").split(u).join(".")}function embrace(e){return"{"+e+"}"}function isPadded(e){return/^-?0\d/.test(e)}function lte(e,t){return e<=t}function gte(e,t){return e>=t}},function(e,t){e.exports=function(e,t){for(var r=[],o=0;o<e.length;o++){var i=t(e[o],o);n(i)?r.push.apply(r,i):r.push(i)}return r};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";function balanced(e,t,n){e instanceof RegExp&&(e=maybeMatch(e,n)),t instanceof RegExp&&(t=maybeMatch(t,n));var r=range(e,t,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+e.length,r[1]),post:n.slice(r[1]+t.length)}}function maybeMatch(e,t){var n=t.match(e);return n?n[0]:null}function range(e,t,n){var r,o,i,s,a,c=n.indexOf(e),u=n.indexOf(t,c+1),l=c;if(c>=0&&u>0){for(r=[],i=n.length;l>=0&&!a;)l==c?(r.push(l),c=n.indexOf(e,l+1)):1==r.length?a=[r.pop(),u]:((o=r.pop())<i&&(i=o,s=u),u=n.indexOf(t,l+1)),l=c<u&&c>=0?c:u;r.length&&(a=[i,s])}return a}e.exports=balanced,balanced.range=range},function(e,t,n){try{var r=n(12);if("function"!=typeof r.inherits)throw"";e.exports=r.inherits}catch(t){e.exports=n(1221)}},function(e,t){"function"==typeof Object.create?e.exports=function inherits(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function inherits(e,t){if(t){e.super_=t;var TempCtor=function(){};TempCtor.prototype=t.prototype,e.prototype=new TempCtor,e.prototype.constructor=e}}},function(e,t,n){e.exports=globSync,globSync.GlobSync=GlobSync;var r=n(21),o=n(524),i=n(246),s=(i.Minimatch,n(523).Glob,n(12),n(11)),a=n(46),c=n(247),u=n(525),l=(u.alphasort,u.alphasorti,u.setopts),d=u.ownProp,p=u.childrenIgnored,h=u.isIgnored;function globSync(e,t){if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new GlobSync(e,t).found}function GlobSync(e,t){if(!e)throw new Error("must provide pattern");if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof GlobSync))return new GlobSync(e,t);if(l(this,e,t),this.noprocess)return this;var n=this.minimatch.set.length;this.matches=new Array(n);for(var r=0;r<n;r++)this._process(this.minimatch.set[r],r,!1);this._finish()}GlobSync.prototype._finish=function(){if(a(this instanceof GlobSync),this.realpath){var e=this;this.matches.forEach((function(t,n){var r=e.matches[n]=Object.create(null);for(var i in t)try{i=e._makeAbs(i),r[o.realpathSync(i,e.realpathCache)]=!0}catch(t){if("stat"!==t.syscall)throw t;r[e._makeAbs(i)]=!0}}))}u.finish(this)},GlobSync.prototype._process=function(e,t,n){a(this instanceof GlobSync);for(var r,o=0;"string"==typeof e[o];)o++;switch(o){case e.length:return void this._processSimple(e.join("/"),t);case 0:r=null;break;default:r=e.slice(0,o).join("/")}var s,u=e.slice(o);null===r?s=".":c(r)||c(e.join("/"))?(r&&c(r)||(r="/"+r),s=r):s=r;var l=this._makeAbs(s);p(this,s)||(u[0]===i.GLOBSTAR?this._processGlobStar(r,s,l,u,t,n):this._processReaddir(r,s,l,u,t,n))},GlobSync.prototype._processReaddir=function(e,t,n,r,o,i){var a=this._readdir(n,i);if(a){for(var c=r[0],u=!!this.minimatch.negate,l=c._glob,d=this.dot||"."===l.charAt(0),p=[],h=0;h<a.length;h++){if("."!==(g=a[h]).charAt(0)||d)(u&&!e?!g.match(c):g.match(c))&&p.push(g)}var m=p.length;if(0!==m)if(1!==r.length||this.mark||this.stat){r.shift();for(h=0;h<m;h++){var y;g=p[h];y=e?[e,g]:[g],this._process(y.concat(r),o,i)}}else{this.matches[o]||(this.matches[o]=Object.create(null));for(var h=0;h<m;h++){var g=p[h];e&&(g="/"!==e.slice(-1)?e+"/"+g:e+g),"/"!==g.charAt(0)||this.nomount||(g=s.join(this.root,g)),this._emitMatch(o,g)}}}},GlobSync.prototype._emitMatch=function(e,t){if(!h(this,t)){var n=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=n),!this.matches[e][t]){if(this.nodir){var r=this.cache[n];if("DIR"===r||Array.isArray(r))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}},GlobSync.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var t,n;try{n=r.lstatSync(e)}catch(e){if("ENOENT"===e.code)return null}var o=n&&n.isSymbolicLink();return this.symlinks[e]=o,o||!n||n.isDirectory()?t=this._readdir(e,!1):this.cache[e]="FILE",t},GlobSync.prototype._readdir=function(e,t){if(t&&!d(this.symlinks,e))return this._readdirInGlobStar(e);if(d(this.cache,e)){var n=this.cache[e];if(!n||"FILE"===n)return null;if(Array.isArray(n))return n}try{return this._readdirEntries(e,r.readdirSync(e))}catch(t){return this._readdirError(e,t),null}},GlobSync.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var n=0;n<t.length;n++){var r=t[n];r="/"===e?e+r:e+"/"+r,this.cache[r]=!0}return this.cache[e]=t,t},GlobSync.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(e);if(this.cache[n]="FILE",n===this.cwdAbs){var r=new Error(t.code+" invalid cwd "+this.cwd);throw r.path=this.cwd,r.code=t.code,r}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t)}},GlobSync.prototype._processGlobStar=function(e,t,n,r,o,i){var s=this._readdir(n,i);if(s){var a=r.slice(1),c=e?[e]:[],u=c.concat(a);this._process(u,o,!1);var l=s.length;if(!this.symlinks[n]||!i)for(var d=0;d<l;d++){if("."!==s[d].charAt(0)||this.dot){var p=c.concat(s[d],a);this._process(p,o,!0);var h=c.concat(s[d],r);this._process(h,o,!0)}}}},GlobSync.prototype._processSimple=function(e,t){var n=this._stat(e);if(this.matches[t]||(this.matches[t]=Object.create(null)),n){if(e&&c(e)&&!this.nomount){var r=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=s.join(this.root,e):(e=s.resolve(this.root,e),r&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e)}},GlobSync.prototype._stat=function(e){var t=this._makeAbs(e),n="/"===e.slice(-1);if(e.length>this.maxLength)return!1;if(!this.stat&&d(this.cache,t)){var o=this.cache[t];if(Array.isArray(o)&&(o="DIR"),!n||"DIR"===o)return o;if(n&&"FILE"===o)return!1}var i=this.statCache[t];if(!i){var s;try{s=r.lstatSync(t)}catch(e){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return this.statCache[t]=!1,!1}if(s&&s.isSymbolicLink())try{i=r.statSync(t)}catch(e){i=s}else i=s}this.statCache[t]=i;o=!0;return i&&(o=i.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||o,(!n||"FILE"!==o)&&o},GlobSync.prototype._mark=function(e){return u.mark(this,e)},GlobSync.prototype._makeAbs=function(e){return u.makeAbs(this,e)}},function(e,t,n){var r=n(526),o=Object.create(null),i=n(527);function slice(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r]=e[r];return n}e.exports=r((function inflight(e,t){return o[e]?(o[e].push(t),null):(o[e]=[t],function makeres(e){return i((function RES(){var t=o[e],n=t.length,r=slice(arguments);try{for(var i=0;i<n;i++)t[i].apply(null,r)}finally{t.length>n?(t.splice(0,n),process.nextTick((function(){RES.apply(null,r)}))):delete o[e]}}))}(e))}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FREMONT_JS_LIB="[Fremont JS Lib]",t.FREMONT_NOT_IMPLEMENTED_MSG=t.FREMONT_JS_LIB+" Not Implemented: ",t.FEATUREFLAG_PROPERTIES="fusion-pim-properties",t.FEATUREFLAG_WRITE="fusion-pim-write-jslib-data"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1226);Object.defineProperty(t,"AGL2Client",{enumerable:!0,get:function(){return r.AGL2Client}});var o=n(1233);Object.defineProperty(t,"AGSyncHandler",{enumerable:!0,get:function(){return o.AGSyncHandler}});var i=n(1237);Object.defineProperty(t,"combineChanges",{enumerable:!0,get:function(){return i.combineChanges}})},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__await||function(e){return this instanceof o?(this.v=e,this):new o(e)},i=this&&this.__asyncGenerator||function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r={},verb("next"),verb("throw"),verb("return"),r[Symbol.asyncIterator]=function(){return this},r;function verb(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||resume(e,t)}))})}function resume(e,t){try{!function step(e){e.value instanceof o?Promise.resolve(e.value.v).then(fulfill,reject):settle(s[0][2],e)}(i[e](t))}catch(e){settle(s[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),s.shift(),s.length&&resume(s[0][0],s[0][1])}},s=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},verb("next"),verb("throw"),verb("return"),t[Symbol.asyncIterator]=function(){return this},t);function verb(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){(function settle(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,o,(t=e[n](t)).done,t.value)}))}}};Object.defineProperty(t,"__esModule",{value:!0}),t.AGL2Client=void 0;const a=n(152),c=n(530),u=n(248),l=n(531);class AGL2Client{constructor(e){var t;this.defaultConfig={throwIfNotSuccess:!1},this.client=e;const n=null===(t=this.client.config)||void 0===t?void 0:t.baseURL;(null==n?void 0:n.includes("v1"))&&console.warn("It is no longer necessary to provide the version (eg: /v1) in the rest client provided to the SyncHandler.")}setBearerToken(e){this.defaultConfig.getBearerToken=e}setTraces(e){this.traces=e}sync(e,t,n){var r;return i(this,arguments,(function*sync_1(){let i,s,a=n,c=!0;this.beginTrace("Sync Endpoint");do{const u=Object.assign({params:{syncToken:n,cursor:s}},this.defaultConfig);if(i=yield o(this.enqueue(e,()=>this.client.get(`${this.setVersion("v1/")}collections/${t}/sync`,u))),200!==i.status){const e=i.data||{},n=JSON.stringify(i.data);throw new l.SyncServerError(t,"collection",i.status,n,e.trackingId)}s=null===(r=i.data.pagination)||void 0===r?void 0:r.cursor,a=i.data.syncToken,c=!!i.data.pagination.nextUrl;const d={changes:{Collection:{},Space:{},Asset:{},Relationship:{},Snapshot:{}},purged:[],fullSync:i.data.fullSync,syncToken:a};i.data.results.forEach(e=>{if("purged"!==e.changeType){d.changes[e.entityType][e.entityId]=e}else d.purged.push(e)}),yield yield o(d)}while(200===i.status&&c);this.endTrace("Sync Endpoint")}))}syncWithSpaces(e,t,n,r){return i(this,arguments,(function*syncWithSpaces_1(){let i;this.beginTrace("Sync Spaces Endpoint");let s,a=!0;const d=n.reduce((e,t)=>{const n=e;return n[t.id]={assets:{limit:u.SYNC_ENTITY_LIMIT},relationships:{limit:u.SYNC_ENTITY_LIMIT},snapshots:{limit:u.SYNC_ENTITY_LIMIT},syncToken:t.syncToken||void 0,includeSpace:a},n},{}),p=`${this.setVersion("v1/")}collections/${t}:sync`;do{if(s=!1,i=yield o(this.enqueue(e,()=>this.client.post(p,d,this.defaultConfig))),200!==i.status){const e=i.data||{},t=JSON.stringify(i.data);throw new c.ServerError(p,i.status,t,e.trackingId)}const t=i.data,n={changes:{Space:{},Asset:{},Relationship:{},Snapshot:{}},syncToken:{}};for(const[e,o]of Object.entries(t)){const{error:t}=o;if(t){const n=JSON.stringify(t);r.push(new l.SyncServerError(e,"space",t.status,n,t.trackingId)),delete d[e]}else if(void 0===o.syncToken)r.push(new c.SyncError("Missing sync token for space "+e,e,o.syncToken)),delete d[e];else{const t={syncToken:d[e].syncToken,includeSpace:!1};a&&(n.syncToken[e]=o.syncToken),o.space&&(n.changes.Space[e]=o.space);const r=this.parseSyncSpacesPage(o,"assets",t,n.changes.Asset),i=this.parseSyncSpacesPage(o,"snapshots",t,n.changes.Snapshot),c=this.parseSyncSpacesPage(o,"relationships",t,n.changes.Relationship);s=s||r||i||c,void 0!==t.assets||void 0!==t.snapshots||void 0!==t.relationships?d[e]=t:delete d[e]}}a&&(a=!1),yield yield o(n)}while(200===i.status&&s);this.endTrace("Sync Spaces Endpoint")}))}getCollection(e,t){return r(this,void 0,void 0,(function*(){const n=`${this.setVersion("v1/")}collections/${t}`,r=yield this.enqueue(e,()=>this.client.get(n,this.defaultConfig));if(r.status>=200&&r.status<300){const e=r.data;return{id:e.id,components:e.components.data,attributes:e.attributes.data,revisionId:e.revisionId,type:a.EntityType.ENTITY,createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy,metadata:{scopeUrn:e.scopeUrn,type:e.type,entityType:"Collection"}}}throw new c.ServerError(n,r.status,JSON.stringify(r.data),r.data.trackingId)}))}getSpaces(e,t,n,o){return r(this,void 0,void 0,(function*(){this.beginTrace("Sync - Spaces");const r=[];for(const o of c.chunk(n,u.ENTITY_FILTER_LIMIT))r.push(this.enqueue(e,()=>this.fetchBatchEntities(`${this.setVersion("v1/")}collections/${t}/spaces?limit=${u.ENTITY_FILTER_LIMIT}&filter=spaceId=in=(${o})`)));return Promise.all(r).then(e=>{this.endTrace("Sync - Spaces");const n=[];return e.forEach(e=>{e.error?o.push(e.error):n.push(...e.results.map(e=>({id:e.id,components:e.components.data,attributes:e.attributes.data,type:a.EntityType.ENTITY,revisionId:e.revisionId,parentEntityId:t,createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy,metadata:{type:e.type,entityType:"Space"}})))}),n})}))}getAssets(e,t,n,o){return r(this,void 0,void 0,(function*(){this.beginTrace("Sync - Assets");const r=[];for(const o of c.chunk(n,u.ENTITY_FILTER_LIMIT))r.push(this.enqueue(e,()=>this.fetchBatchEntities(`${this.setVersion("v1/")}collections/${t}/assets?limit=${u.ENTITY_FILTER_LIMIT}&filter=assetId=in=(${o})`)));return Promise.all(r).then(e=>{this.endTrace("Sync - Assets");const t=[];return e.forEach(e=>{e.error?o.push(e.error):t.push(...e.results.map(e=>({id:e.id,components:e.components.data,attributes:e.attributes.data,type:a.EntityType.ENTITY,revisionId:e.revisionId,parentEntityId:e.space.id,createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy,metadata:{type:e.type,entityType:"Asset"}})))}),t})}))}getRelationships(e,t,n,o){return r(this,void 0,void 0,(function*(){this.beginTrace("Sync - Relationships");const r=[];for(const o of c.chunk(n,u.ENTITY_FILTER_LIMIT))r.push(this.enqueue(e,()=>this.fetchBatchEntities(`${this.setVersion("v1/")}collections/${t}/relationships?limit=${u.ENTITY_FILTER_LIMIT}&filter=relationshipId=in=(${o})`)));return Promise.all(r).then(e=>{this.endTrace("Sync - Relationships");const t=[];return e.forEach(e=>{e.error?o.push(e.error):t.push(...e.results.map(e=>({id:e.id,components:e.components.data,attributes:e.attributes.data,type:a.EntityType.RELATIONSHIP,revisionId:e.revisionId,createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy,metadata:{type:e.type,to:e.to,from:e.from,category:e.category,entityType:"Relationship"}})))}),t})}))}getSnapshots(e,t,n,o){return r(this,void 0,void 0,(function*(){this.beginTrace("Sync - Snapshots");const r=[];for(const o of c.chunk(n,u.SYNC_ENTITY_LIMIT))r.push(this.enqueue(e,()=>this.fetchBatchEntities(`${this.setVersion("v1/")}collections/${t}/snapshots?limit=${u.SYNC_ENTITY_LIMIT}&filter=snapshotId=in=(${o})`)));return Promise.all(r).then(e=>{this.endTrace("Sync - Snapshots");const t=[];return e.forEach(e=>{e.error?o.push(e.error):t.push(...e.results.map(e=>({id:e.snapshot.id,components:e.components.data,attributes:e.attributes.data,type:a.EntityType.ENTITY,revisionId:e.revisionId,assets:e.assets.data,createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy,metadata:{isSnapshot:!0,type:e.type,collection:e.collection.id,entityType:"Snapshot"}})))}),t})}))}getEntityRevisions(e,t,n,r){return i(this,arguments,(function*getEntityRevisions_1(){var i,a;try{for(var c,l=s(this.fetchPages(e,`${this.setVersion("v1/")}collections/${t}/${r}/${n}/revisions?limit=`+u.ENTITY_FILTER_LIMIT));!(c=yield o(l.next())).done;){const e=c.value;yield yield o(e.map(e=>({revisionId:e.revisionId,revisionPermanentId:e.revisionId,revisionDate:new Date(e.createdBy.date),created:!1,removed:!1,staticDataChanges:e.attributeChangeSet,dataChanges:e.metaChangeSet,entityId:e.resourceId,createdBy:e.createdBy})))}}catch(e){i={error:e}}finally{try{c&&!c.done&&(a=l.return)&&(yield o(a.call(l)))}finally{if(i)throw i.error}}}))}getAllSpaces(e,t){return i(this,arguments,(function*getAllSpaces_1(){var n,r;try{for(var i,a=s(this.fetchPages(e,`${this.setVersion("v1/")}collections/${t}/spaces?limit=${u.ENTITY_FILTER_LIMIT}`));!(i=yield o(a.next())).done;){const e=i.value;yield yield o(e)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&(yield o(r.call(a)))}finally{if(n)throw n.error}}}))}fetchPages(e,t){return i(this,arguments,(function*fetchPages_1(){let n,r=!0;for(;r;){const i=Object.assign(Object.assign({},this.defaultConfig),{params:{cursor:n}}),s=yield o(this.enqueue(e,()=>this.client.get(t,i)));if(s.status>=200&&s.status<300)r=!!s.data.pagination.nextUrl,n=s.data.pagination.cursor,yield yield o(s.data.results);else{if(!AGL2Client.shouldIgnoreError(s))throw new c.ServerError(t,s.status,JSON.stringify(s.data),null==s?void 0:s.data.trackingId);r=!1}}}))}static shouldIgnoreError(e){return 403===e.status||404===e.status}fetchBatchEntities(e){return r(this,void 0,void 0,(function*(){const t=yield this.client.get(e,this.defaultConfig);return t.status>=200&&t.status<300?{results:t.data.results}:{results:[],error:new c.ServerError(e,t.status,JSON.stringify(t.data),null==t?void 0:t.data.trackingId)}}))}beginTrace(e){this.traces&&this.traces.beginTrace(e)}endTrace(e){this.traces&&this.traces.endTrace(e)}setVersion(e){var t;const n=null===(t=this.client.config)||void 0===t?void 0:t.baseURL;return(null==n?void 0:n.includes("v1"))?"":e}parseSyncSpacesPage(e,t,n,r){const o=e[t];return!!o&&(o.pagination.cursor&&(n[t]={limit:u.SYNC_ENTITY_LIMIT,cursor:o.pagination.cursor}),o.results.reduce((e,t)=>(e[t.entityId]=t,e),r),!!o.pagination.nextUrl)}enqueue(e,t){return e.queue.add(t,{priority:e.priority})}}t.AGL2Client=AGL2Client},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Traces=void 0;t.Traces=class Traces{constructor(){this.enabled=!1}setEnabled(e){this.enabled=e}beginTrace(e){this.enabled&&console.time(e.toString())}endTrace(e){this.enabled&&console.timeEnd(e.toString())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.chunk=void 0,t.chunk=function chunk(e,t){if(!e||0===e.length)return[];const n=[];for(let r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1230);Object.defineProperty(t,"SyncError",{enumerable:!0,get:function(){return r.SyncError}});var o=n(531);Object.defineProperty(t,"SyncServerError",{enumerable:!0,get:function(){return o.SyncServerError}});var i=n(1231);Object.defineProperty(t,"ServerError",{enumerable:!0,get:function(){return i.ServerError}});var s=n(1232);Object.defineProperty(t,"extractErrorFromAgregate",{enumerable:!0,get:function(){return s.extractErrorFromAgregate}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncError=void 0;class SyncError extends Error{constructor(e,t,n=""){super("[SyncError] "+e),this._entityId=t,this._syncToken=n}get entityId(){return this._entityId}get syncToken(){return this._syncToken}}t.SyncError=SyncError},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerError=void 0;class ServerError extends Error{constructor(e,t,n,r=""){super(`[SyncServerError] Status ${t} for ${e} with trackingId ${r}. Details: ${n}`),this._trackingId=r,this._status=t}get trackingId(){return this._trackingId}get status(){return this._status}}t.ServerError=ServerError},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.extractErrorFromAgregate=void 0;const o=r(n(186));t.extractErrorFromAgregate=function extractErrorFromAgregate(e,t){e instanceof o.default?t.push(...e):t.push(e)}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))},o=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},verb("next"),verb("throw"),verb("return"),t[Symbol.asyncIterator]=function(){return this},t);function verb(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){(function settle(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,o,(t=e[n](t)).done,t.value)}))}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AGSyncHandler=t.SPACE_TOKEN_PROPERTY_KEY=void 0;const s=i(n(499)),a=n(1344),c=n(47),u=n(1234),l=i(n(13)),d=i(n(186)),p=n(530),h=n(248),m=n(1235),y=n(1236),toSpaceSelector=(e,t)=>({parameters:{spaces:e},type:"spaces",priority:null!=t?t:y.defaultSyncPriority});t.SPACE_TOKEN_PROPERTY_KEY="spaceToken";class AGSyncHandler extends u.SyncHandler{constructor(e,t,n){super(),this.priorityQueueMaxReachedSize=0,this.remoteClient=e,this.store=t,this.traces=new p.Traces,this.options=n||{},this.priorityQueue=new s.default({concurrency:(null==n?void 0:n.priorityQueueWorkerSize)||h.DEFAULT_PRIORITY_QUEUE_WORKER_SIZE}),this.mutexes={[h.IDENTIFIERS.COLLECTIONS]:new a.Mutex,[h.IDENTIFIERS.SPACES]:new a.Mutex,[h.IDENTIFIERS.ASSETS]:new a.Mutex,[h.IDENTIFIERS.RELATIONSHIPS]:new a.Mutex,[h.IDENTIFIERS.SNAPSHOTS]:new a.Mutex,[h.IDENTIFIERS.TOKENS]:new a.Mutex},e.setTraces(this.traces),m.validateAGSyncHandlerOptions(n)}setTracesEnabled(e){this.traces.setEnabled(e),e?this.priorityQueue.on("next",()=>{this.priorityQueue.size>this.priorityQueueMaxReachedSize&&(this.priorityQueueMaxReachedSize=this.priorityQueue.size,console.debug("Max queue size reached: "+this.priorityQueueMaxReachedSize))}):this.priorityQueue.off("next")}fetch(e,t,n,o){return r(this,void 0,void 0,(function*(){switch(this.generateTokenFn&&this.remoteClient.setBearerToken(this.generateTokenFn),null==n?void 0:n.type){case"noop":return t;case"spaces":return this.fetchBySpaces(e,t,n,o);case"collection_legacy":return this.fetchByCollectionLegacy(e,t,o,n.priority);case"collection":return this.fetchByCollection(e,t,n,o);case"bootstrap":return this.bootstrapCollection(e,t,n,o);default:return this.fetchByCollection(e,t,n,o)}}))}fetchByCollectionLegacy(e,t,n,i){var s,a;return r(this,void 0,void 0,(function*(){this.traces.beginTrace("Sync - Total");const c=[];let u=!0;const l=[],m=[];let y=[];const g={queue:this.priorityQueue,priority:i},_=this.createFetchJobQueue();let v;try{const i=this.remoteClient.sync(g,e,t);try{for(var E,I=o(i);!(E=yield I.next()).done;){const t=E.value,o=this.store.getEntityStore();if(v=t.syncToken,u){if(u=!1,t.fullSync){(yield o.getJournalEntities(e)).forEach(e=>{e.entityPermanentId&&m.push(e)})}t.fullSync&&void 0===t.changes.Collection[e]&&(t.changes.Collection[e]={entityId:e,revisionId:"",entityType:"entity",changeType:"created"})}if(t.fullSync)Object.values(t.changes).forEach(e=>{y=y.concat(Object.values(e).map(e=>e.entityId))});else if(t.purged.length>0){const n=t.purged.map(e=>e.entityId),r=yield o.getEntities(n,{journalId:e});if(r){const e=r.filter(e=>void 0!==e);e.length>0&&(yield this.deleteEntities(e))}}yield this.fetchAndStoreCollections(g,n,t.changes.Collection,e),_.add(()=>this.fetchAndStoreSpaceData(g,t.changes.Space,n,e,c)),_.add(()=>this.fetchAndStoreAssetData(g,t.changes.Asset,n,e,c)),_.add(()=>this.fetchAndStoreSnapshots(g,t.changes.Snapshot,n,e,c));const i=t.changes.Relationship,s=Object.keys(i);s.length>0&&_.add(()=>r(this,void 0,void 0,(function*(){const t=yield this.remoteClient.getRelationships(g,e,s,c);l.push({data:t,changes:i})})))}}catch(e){s={error:e}}finally{try{E&&!E.done&&(a=I.return)&&(yield a.call(I))}finally{if(s)throw s.error}}yield _.onIdle();for(const t of l)_.add(()=>this.saveEntities(g,t.data,n,t.changes,e,h.IDENTIFIERS.RELATIONSHIPS));yield _.onIdle(),y.length>0&&(yield this.checkForPurgedEntities(m,y))}catch(e){c.push(e)}if(this.traces.endTrace("Sync - Total"),void 0===v&&c.length<=0&&c.push(new p.SyncError("Failed to get a new sync token for collection "+e,e)),c.length>0)throw new d.default(c);return v}))}withMutex(e,t){return r(this,void 0,void 0,(function*(){const n=yield this.mutexes[e].acquire();let r;try{r=yield t()}finally{n()}return r}))}fetchByCollection(e,n,i,s){var a,c,u;return r(this,void 0,void 0,(function*(){const r={queue:this.priorityQueue,priority:null!==(u=null==i?void 0:i.priority)&&void 0!==u?u:y.defaultSyncPriority},l=[],h=[],m=(yield this.store.getJournalStore().getJournal(s.journalId)).properties[t.SPACE_TOKEN_PROPERTY_KEY]||{};l.push(this.fetchBySpaces(e,n,toSpaceSelector(Object.keys(m),null==i?void 0:i.priority),s).catch(e=>{p.extractErrorFromAgregate(e,h)}));const g=this.remoteClient.getAllSpaces(r,e),_=[];try{for(var v,E=o(g);!(v=yield E.next()).done;){const e=v.value;for(const t of e)m[t.id]||_.push(t.id)}}catch(e){a={error:e}}finally{try{v&&!v.done&&(c=E.return)&&(yield c.call(E))}finally{if(a)throw a.error}}return l.push(this.fetchBySpaces(e,n,toSpaceSelector(_,null==i?void 0:i.priority),s).catch(e=>{p.extractErrorFromAgregate(e,h)})),Promise.all(l).then(()=>{if(h.length>0)throw new d.default(h);return n})}))}bootstrapCollection(e,t,n,o){var i;return r(this,void 0,void 0,(function*(){const r={queue:this.priorityQueue,priority:null!==(i=null==n?void 0:n.priority)&&void 0!==i?i:y.defaultSyncPriority},s=[],a={id:e,components:{},attributes:{},revisionId:"",type:c.EntityType.ENTITY,createdBy:{date:"",serviceId:"",userId:""},lastModifiedBy:{date:"",serviceId:"",userId:""},metadata:{scopeUrn:"",type:"autodesk.data:collection-1.0.0",entityType:"Collection",isPlaceholder:!0}},u={[e]:{entityId:e,revisionId:"",entityType:"entity",changeType:"created"}};try{yield this.saveEntities(r,[a],o,u,e,h.IDENTIFIERS.COLLECTIONS)}catch(e){s.push(e)}return Promise.all([]).then(()=>{if(s.length>0)throw new d.default(s);return t})}))}fetchBySpaces(e,n,i,s){var a,u,m,g,_,v;return r(this,void 0,void 0,(function*(){if(void 0===(null===(m=null==i?void 0:i.parameters)||void 0===m?void 0:m.spaces))throw new Error("Missing selector. Cannot sync by spaces.");this.traces.beginTrace("Sync - Spaces");const E=null!==(g=i.priority)&&void 0!==g?g:y.defaultSyncPriority,I=[],b=[],S=null===(_=i.parameters)||void 0===_?void 0:_.spaces;try{let n=yield this.store.getJournalStore().getJournal(s.journalId);const i=n.properties[t.SPACE_TOKEN_PROPERTY_KEY]||{},d=[],m={queue:this.priorityQueue,priority:E},y=this.createFetchJobQueue(),g=new Set,_=new Map,A=new Set,O=new Map,P={[e]:{entityId:e,revisionId:"",entityType:"entity",changeType:"created"}};yield this.fetchAndStoreCollections(m,s,P,e);const D=(null===(v=this.options.spaces)||void 0===v?void 0:v.spaceLimit)||h.MAX_SPACE_CHUNK_SIZE;for(const t of p.chunk(S,D)){const n=t.map(e=>({id:e,syncToken:i[e]})),l=this.remoteClient.syncWithSpaces(m,e,n,I);try{for(var C,w=(a=void 0,o(l));!(C=yield w.next()).done;){const t=C.value;d.push(t.syncToken),y.add(()=>this.fetchAndStoreSpaceData(m,t.changes.Space,s,e,I)),y.add(()=>this.fetchAndStoreAssetData(m,t.changes.Asset,s,e,I)),Object.keys(t.changes.Asset).forEach(e=>{"deleted"!==t.changes.Asset[e].changeType&&g.add(e)});const n=Object.keys(t.changes.Snapshot).filter(e=>"deleted"!==t.changes.Snapshot[e].changeType&&!A.has(e));y.add(()=>this.fetchAndStoreSnapshotSubset(m,n,t.changes.Snapshot,s,e,I)),n.forEach(e=>{"deleted"!==t.changes.Snapshot[e].changeType&&A.add(e)});const o=t.changes.Relationship,i=Object.keys(o);i.length>0&&y.add(()=>r(this,void 0,void 0,(function*(){const t=yield this.remoteClient.getRelationships(m,e,i,I);t.map(e=>e.metadata.to).forEach(e=>{var t,n;(null===(t=null==e?void 0:e.asset)||void 0===t?void 0:t.id)&&!g.has(e.asset.id)&&_.set(e.asset.id,{entityId:e.asset.id,entityType:c.EntityType.ENTITY,revisionId:"",changeType:"created"}),(null===(n=null==e?void 0:e.snapshot)||void 0===n?void 0:n.id)&&!A.has(e.snapshot.id)&&O.set(e.snapshot.id,{entityId:e.snapshot.id,entityType:c.EntityType.ENTITY,revisionId:"",changeType:"created"})}),b.push({data:t,changes:o})})))}}catch(e){a={error:e}}finally{try{C&&!C.done&&(u=w.return)&&(yield u.call(w))}finally{if(a)throw a.error}}}yield y.onIdle();const x={};for(const[e,t]of _)g.has(e)||Object.assign(x,{[e]:t});const R={};for(const[e,t]of O)A.has(e)||Object.assign(R,{[e]:t});y.add(()=>this.fetchAndStoreAssetData(m,x,s,e,I)),y.add(()=>this.fetchAndStoreSnapshots(m,R,s,e,I)),yield y.onIdle();for(const t of b)y.add(()=>this.saveEntities(m,t.data,s,t.changes,e,h.IDENTIFIERS.RELATIONSHIPS));yield y.onIdle(),l.default(d)||(yield this.withMutex(h.IDENTIFIERS.TOKENS,()=>r(this,void 0,void 0,(function*(){n=yield this.store.getJournalStore().getJournal(s.journalId);const e=n.properties[t.SPACE_TOKEN_PROPERTY_KEY]||{};d.forEach(t=>Object.assign(e,t)),n.properties[t.SPACE_TOKEN_PROPERTY_KEY]=e,yield this.store.getJournalStore().updateJournal(s.journalId,n)}))))}catch(e){I.push(e)}if(this.traces.endTrace("Sync - Spaces"),I.length>0)throw new d.default(I);return n}))}fetchAndStoreCollections(e,t,n,o){return r(this,void 0,void 0,(function*(){if(Object.keys(n).length>0){const r=[];if(0===Object.values(n).filter(e=>"deleted"===e.changeType).length){const t=yield this.remoteClient.getCollection(e,o);t&&r.push(t)}yield this.saveEntities(e,r,t,n,o,h.IDENTIFIERS.COLLECTIONS)}}))}saveEntities(e,t,n,o,i,s,a){return r(this,void 0,void 0,(function*(){this.traces.beginTrace(`Sync - saveEntities - ${s} - ${t.length}`),yield this.syncEntityStore(e,t,o,i,s,n.commandId,a),yield this.updateSyncCommand(n.commandId,t),this.traces.endTrace(`Sync - saveEntities - ${s} - ${t.length}`)}))}syncEntityStore(e,t,n,o,i,s,a){return r(this,void 0,void 0,(function*(){const r=[];for(const c of t)r.push(e.queue.add(()=>this.withMutex(i,()=>this.storeNewOrModifiedEntity(c,n[c.id].changeType,o,s,a?a[c.id]:void 0)),{priority:e.priority}));r.push(e.queue.add(()=>this.withMutex(i,()=>this.markEntitiesAsRemoved(n,o,s)),{priority:e.priority})),yield Promise.all(r)}))}storeNewOrModifiedEntity(e,t,n,o,i){var s,a,u,l;return r(this,void 0,void 0,(function*(){const r=this.store.getEntityStore(),{id:d}=e,p={staticData:{attributes:e.attributes,metadata:e.metadata||{},createdBy:e.createdBy,lastModifiedBy:e.lastModifiedBy},data:{components:e.components},type:e.type,parentEntityId:e.parentEntityId};let h,m,y=!0;try{const e=yield r.getEntityIds(d),t=yield r.getEntities([d],{journalId:n});t&&t[0]&&(null===(a=null===(s=t[0].staticData)||void 0===s?void 0:s.metadata)||void 0===a?void 0:a.isPlaceholder)&&(yield r.deleteRevision(d,n,t[0].revisionId),yield r.deleteEntity(d),y=!1),h=e.entityLocalId}catch(e){if(e.code.id!==c.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST.id)throw e;y=!1}if(p.staticData.metadata.isSnapshot)p.data.assets=e.assets;else if(e.type===c.EntityType.RELATIONSHIP){try{m=yield this.getRelationshipParams(e,n)}catch(e){return void console.warn(e.message)}p.staticData.metadata.from={assetId:e.metadata.from.asset.id,snapshotId:null===(u=e.metadata.from.snapshot)||void 0===u?void 0:u.id},p.staticData.metadata.to={assetId:e.metadata.to.asset.id,snapshotId:null===(l=e.metadata.to.snapshot)||void 0===l?void 0:l.id},y&&(yield r.updateRelationshipStaticObject(h,m))}if(!y){h=(yield r.createEntityStaticObject(Object.assign({localId:h,permanentId:d,parentEntityId:p.parentEntityId},p),m)).localId}try{const s=e.lastModifiedBy.date||e.createdBy.date||Date.now(),a=i?i[e.revisionId]:void 0;yield r.createRevision(h,n,{revisionId:a||e.revisionId,revisionPermanentId:e.revisionId,commandId:o,revisionDate:new Date(s),staticDataChanges:p.staticData,dataChanges:p.data||[],created:"created"===t,removed:"deleted"===t,parentEntityId:p.parentEntityId}),yield r.createMaterializedView(h,n,e.revisionId,{data:p.data,removed:"deleted"===t})}catch(e){if(void 0===e.code||e.code.id!==c.ErrorCode.L5_ENTITY_STORE_MV_ALREADY_EXIST.id&&e.code.id!==c.ErrorCode.L5_ENTITY_STORE_REVISION_ALREADY_EXIST.id)throw e}}))}markEntitiesAsRemoved(e,t,n){return r(this,void 0,void 0,(function*(){const r=this.store.getEntityStore(),o=Object.values(e).filter(e=>"deleted"===e.changeType);for(const e of o)try{yield r.createRevision(e.entityId,t,{revisionId:e.revisionId,revisionPermanentId:e.revisionId,commandId:n,revisionDate:new Date,staticDataChanges:{},dataChanges:{},created:!1,removed:!0}),yield r.createMaterializedView(e.entityId,t,e.revisionId,{data:{},removed:!0})}catch(e){if(e.code.id!==c.ErrorCode.L5_ENTITY_STORE_MV_ALREADY_EXIST.id&&e.code.id!==c.ErrorCode.L5_ENTITY_STORE_REVISION_ALREADY_EXIST.id&&e.code.id!==c.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST.id)throw e}}))}getRelationshipParams(e,t){return r(this,void 0,void 0,(function*(){let n;if(e.type===c.EntityType.RELATIONSHIP){const r=[];r.push(this.getNodeRevisionId({collectionId:t,relationshipId:e.id,assetId:e.metadata.from.asset.id,snapshotId:e.metadata.from.snapshot?e.metadata.from.snapshot.id:void 0})),r.push(this.getNodeRevisionId({collectionId:t,relationshipId:e.id,assetId:e.metadata.to.asset.id,snapshotId:e.metadata.to.snapshot?e.metadata.to.snapshot.id:void 0}));const[o,i]=yield Promise.all(r);n={from:{entityId:e.metadata.from.asset.id,revisionId:o},to:{entityId:e.metadata.to.asset.id,revisionId:i}}}return n}))}getNodeRevisionId(e){return r(this,void 0,void 0,(function*(){if(!e.snapshotId)return"";const t=(yield this.store.getEntityStore().getEntities([e.snapshotId],{journalId:e.collectionId}))[0];if(!t)throw new Error(`Could not find snapshot ${e.snapshotId} locally. Relationship ${e.relationshipId} cannot be resolved.`);const n=t.data.assets.insert.String[e.assetId];return void 0===n?"":n}))}getEntityRevision(e,t,n){return r(this,void 0,void 0,(function*(){const r=this.store.getEntityStore(),o=yield r.getEntities([{entityId:e,revisionId:t}],{journalId:n});return o&&o.length>0?o[0]:void 0}))}updateSyncCommand(e,t){var n,o;return r(this,void 0,void 0,(function*(){const r={};t.forEach(e=>{r[e.id]=e.revisionId}),yield null===(o=(n=this.store.getJournalStore()).addCommandModifiedEntities)||void 0===o?void 0:o.call(n,e,r)}))}checkForPurgedEntities(e,t){return r(this,void 0,void 0,(function*(){const n=[];e.forEach(e=>{t.includes(e.entityPermanentId)||n.push(e)}),n.length>0&&(yield this.deleteEntities(n))}))}deleteEntities(e){return r(this,void 0,void 0,(function*(){const t=this.store.getEntityStore(),n=e.filter(e=>e.type===c.EntityType.RELATIONSHIP).map(e=>t.deleteEntity(e.entityId)),r=e.filter(e=>e.type===c.EntityType.ENTITY).map(e=>t.deleteEntity(e.entityId));yield Promise.all(n),yield Promise.all(r)}))}fetchAndStoreSpaceData(e,t,n,o,i){return r(this,void 0,void 0,(function*(){const r=Object.keys(t);if(r.length>0){const s=yield this.remoteClient.getSpaces(e,o,r,i);yield this.saveEntities(e,s,n,t,o,h.IDENTIFIERS.SPACES)}}))}getRevisionIdMappingsForEntity(e,t){return r(this,void 0,void 0,(function*(){const n={},r=this.store.getEntityStore(),o={offset:0,limit:512};let i;do{try{i=(yield r.getEntityRevisions(e,t,o)).items}catch(e){if(e.code.id!==c.ErrorCode.L5_ENTITY_STORE_ENTITY_NOT_EXIST.id)throw new Error("Unable to query revisions");i=[]}if(0===i.length)break;i.forEach(e=>{n[e.revisionPermanentId]=e.revisionId}),o.offset+=i.length}while(i.length>=o.limit);return n}))}getAssetRevisionIdMappings(e,t){return r(this,void 0,void 0,(function*(){const n={};for(const r of e)n[r]=yield this.getRevisionIdMappingsForEntity(r,t);return n}))}fetchAndStoreAssetData(e,t,n,o,i){return r(this,void 0,void 0,(function*(){const r=Object.keys(t);if(r.length>0){const s=yield this.remoteClient.getAssets(e,o,r,i),a=yield this.getAssetRevisionIdMappings(r,o);yield this.saveEntities(e,s,n,t,o,h.IDENTIFIERS.ASSETS,a),yield this.getAllRevisions(e,r,o,n.commandId,a,i)}}))}fetchAndStoreSnapshots(e,t,n,o,i){return r(this,void 0,void 0,(function*(){return this.fetchAndStoreSnapshotSubset(e,Object.keys(t),t,n,o,i)}))}fetchAndStoreSnapshotSubset(e,t,n,o,i,s){return r(this,void 0,void 0,(function*(){if(t.length>0){const r=yield this.remoteClient.getSnapshots(e,i,t,s);yield this.saveEntities(e,r,o,n,i,h.IDENTIFIERS.SNAPSHOTS)}}))}getAllRevisions(e,t,n,o,i,s){return r(this,void 0,void 0,(function*(){const r=[];for(const a of t)r.push(this.fetchAndStoreAssetRevisions(e,a,n,o,i[a]||{},s));yield Promise.all(r)}))}fetchAndStoreAssetRevisions(e,t,n,i,s,a){var c,u;return r(this,void 0,void 0,(function*(){const r=this.remoteClient.getEntityRevisions(e,n,t,"assets");try{try{for(var l,d=o(r);!(l=yield d.next()).done;){const e=l.value;yield this.storeRevisions(e,n,h.IDENTIFIERS.ASSETS,i,s)}}catch(e){c={error:e}}finally{try{l&&!l.done&&(u=d.return)&&(yield u.call(d))}finally{if(c)throw c.error}}}catch(e){a.push(e)}}))}storeRevisions(e,t,n,o,i){return r(this,void 0,void 0,(function*(){const s=this.store.getEntityStore();for(const a of e)yield this.withMutex(n,()=>r(this,void 0,void 0,(function*(){const e=i[a.revisionPermanentId]||a.revisionPermanentId;let n=yield this.getEntityRevision(a.entityId,e,t);n&&n.staticData.metadata.isPlaceholder&&(yield s.deleteRevision(a.entityId,t,n.revisionId),n=void 0),n||(yield s.createRevision(a.entityId,t,Object.assign(Object.assign({},a),{revisionId:e,commandId:o})))})))}))}createFetchJobQueue(){return new s.default}dispose(){return r(this,void 0,void 0,(function*(){return Promise.resolve()}))}}t.AGSyncHandler=AGSyncHandler},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncHandler=void 0;t.SyncHandler=class SyncHandler{setGenerateTokenFn(e){this.generateTokenFn=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateAGSyncHandlerOptions=void 0;const r=n(248);t.validateAGSyncHandlerOptions=function validateAGSyncHandlerOptions(e){var t,n,o;if((null==e?void 0:e.spaces)&&void 0!==(null===(t=e.spaces)||void 0===t?void 0:t.spaceLimit)&&((null===(n=e.spaces)||void 0===n?void 0:n.spaceLimit)<1||(null===(o=e.spaces)||void 0===o?void 0:o.spaceLimit)>r.MAX_SPACE_CHUNK_SIZE))throw new Error(`Invalid Option: spaceLimit is out of range: ${e.spaces.spaceLimit}. Valid range is [1, ${r.MAX_SPACE_CHUNK_SIZE}]`)}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSyncPriority=t.SyncPriority=void 0,function(e){e[e.HIGHEST=Number.POSITIVE_INFINITY]="HIGHEST",e[e.NORMAL=0]="NORMAL",e[e.LOWEST=Number.NEGATIVE_INFINITY]="LOWEST"}(r=t.SyncPriority||(t.SyncPriority={})),t.defaultSyncPriority=r.NORMAL},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.combineChanges=void 0;const o=r(n(59)),i=r(n(13)),s=n(1238),a=n(1253);t.combineChanges=function combineChanges(e,t){if(0===t.length)return e||{};const n=t[t.length-1],r=o.default(e||{});if(n.metadata&&!i.default(n.metadata)&&(r.metadata=n.metadata),n.components){const e=t.map(e=>e.components);r.components&&e.unshift(r.components),r.components=a.ChangesetMerger.mergeAndNormalizeChangesetList(e)}if(n.attributes){let{attributes:e}=n;Array.isArray(e)&&(e=s.AttributeConverter.convertAttributesToSerializedChangeset(n.attributes)),r.attributes=e}if(n.assets&&!i.default(n.assets))if(a.isChangeset(n.assets)){const e=t.map(e=>function alignAsset(e){return i.default(e)?{}:a.isChangeset(e)?e:s.AssetsConverter.convertAssetsToChangeSet(e).serializedChangeSet}(e.assets));r.assets&&e.unshift(r.assets),r.assets=a.ChangesetMerger.mergeAndNormalizeChangesetList(e)}else r.assets=s.AssetsConverter.convertAssetsToChangeSet(n.assets).serializedChangeSet;return n.createdBy&&(r.createdBy=n.createdBy),n.lastModifiedBy&&(r.lastModifiedBy=n.lastModifiedBy),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1239);Object.defineProperty(t,"AssetsConverter",{enumerable:!0,get:function(){return r.AssetsConverter}});var o=n(1240);Object.defineProperty(t,"AttributeConverter",{enumerable:!0,get:function(){return o.AttributeConverter}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AssetsConverter=void 0;const r=n(58);t.AssetsConverter=class AssetsConverter{static convertChangeSetToAssetRevision(e){return void 0===e.insert||void 0===e.insert.String?[]:Object.entries(e.insert.String).map(([e,t])=>""===t?{id:e}:{id:e,revisionId:t})}static convertAssetsToChangeSet(e){const t=e,n=new r.PropertyFactory,o=n.create("NodeProperty");return t.forEach(e=>{const t=e.revision?e.revision.id:"",r=e.asset.id;o.insert(r,n.create("String","single",t))}),o.serialize()}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeConverter=void 0;const o=n(58),i=r(n(13)),s=n(1241);class AttributeConverter{static convertChangeSetToAttributesV2(e){if(i.default(e))return[];if(e.remove)throw new Error("Cannot remove attributes for attributes in upsert format");const t=[];return e.insert&&Object.values(e.insert).forEach(e=>{Object.entries(e).forEach(([e,n])=>{let r={};Object.values(n).forEach(e=>{r=Object.assign(Object.assign({},r),e)}),r.name=e,t.push(r)})}),e.modify&&Object.values(e.modify).forEach(e=>{Object.entries(e).forEach(([e,n])=>{let r={};Object.values(n).forEach(e=>{r=Object.assign(Object.assign({},r),e)}),r.name=e,t.push(r)})}),t}static convertObjectToAttributesV2(e){if(i.default(e))return[];if(e.insert||e.modify||e.delete)throw new Error("Changeset format is not supported.");return Object.entries(e).map(([e,t])=>{const n=typeof t;return{category:"application",name:e,value:t,type:n.charAt(0).toUpperCase()+n.substring(1)}})}static convertAttributesToChangeset(e){const t=new o.PropertyFactory;t.register(s.getAttributeSchemas());const n=t.create("NodeProperty");return e.forEach(e=>{n.insert(e.name,t.create(AttributeConverter.convertTypeToAttributeTypeid(e.type),"single",{category:e.category,value:e.value,type:e.type}))}),n.serialize()}static convertAttributesToSerializedChangeset(e){return i.default(e)||e.insert||e.modify||e.remove?e:AttributeConverter.convertAttributesToChangeset(e).serializedChangeSet}static convertTypedChangesetToGeneric(e){if(i.default(e))return{};const convertPropertyType=e=>{const t={};return Object.values(e).forEach(e=>{Object.entries(e).forEach(([e,n])=>{let r={};Object.entries(n).forEach(([e,t])=>{if("String"===e)r=Object.assign(Object.assign({},r),t);else{if(!("value"in t))throw new Error("Unknown field in changeset");r.value=""+t.value}}),t[e]={String:r}})}),{[AttributeConverter.serverTypeid]:t}},t={};return e.insert&&(t.insert=convertPropertyType(e.insert)),e.modify&&(t.modify=convertPropertyType(e.modify)),e.remove&&(t.remove=e.remove),t}static convertTypeToAttributeTypeid(e){let t;switch(e){case"Bool":t=s.boolAttributeSchema.typeid;break;case"String":t=s.stringAttributeSchema.typeid;break;case"Float32":t=s.float32AttributeSchema.typeid;break;case"Float64":t=s.float64AttributeSchema.typeid;break;case"Int8":t=s.int8AttributeSchema.typeid;break;case"Int16":t=s.int16AttributeSchema.typeid;break;case"Int32":t=s.int32AttributeSchema.typeid;break;case"Uint8":t=s.uInt8AttributeSchema.typeid;break;case"Uint16":t=s.uInt16AttributeSchema.typeid;break;case"Uint32":t=s.uInt32AttributeSchema.typeid;break;default:throw new Error(e+" is not a valid type for creating an attribute.")}return t}}t.AttributeConverter=AttributeConverter,AttributeConverter.serverTypeid="adsk.assetgraph:attribute-1.0.0"},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getAttributeSchemas=t.uInt32AttributeSchema=t.uInt16AttributeSchema=t.uInt8AttributeSchema=t.stringAttributeSchema=t.int32AttributeSchema=t.int16AttributeSchema=t.int8AttributeSchema=t.float64AttributeSchema=t.float32AttributeSchema=t.boolAttributeSchema=t.attributeSchema=void 0;const o=r(n(1242));t.attributeSchema=o.default;const i=r(n(1243));t.boolAttributeSchema=i.default;const s=r(n(1244));t.float32AttributeSchema=s.default;const a=r(n(1245));t.float64AttributeSchema=a.default;const c=r(n(1246));t.int8AttributeSchema=c.default;const u=r(n(1247));t.int16AttributeSchema=u.default;const l=r(n(1248));t.int32AttributeSchema=l.default;const d=r(n(1249));t.stringAttributeSchema=d.default;const p=r(n(1250));t.uInt8AttributeSchema=p.default;const h=r(n(1251));t.uInt16AttributeSchema=h.default;const m=r(n(1252));t.uInt32AttributeSchema=m.default,t.getAttributeSchemas=()=>[o.default,i.default,s.default,a.default,c.default,u.default,l.default,d.default,p.default,h.default,m.default]},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:attribute-1.0.0","annotation":{"description":"Schema which represents an attribute"},"properties":[{"id":"type","typeid":"String"},{"id":"category","typeid":"String"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:boolAttribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Bool"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:float32Attribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Float32"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:float64Attribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Float64"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:int8Attribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Int8"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:int16Attribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Int16"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:int32Attribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Int32"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:stringAttribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"String"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:uInt8Attribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Uint8"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:uInt16Attribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Uint16"}]}')},function(e){e.exports=JSON.parse('{"typeid":"autodesk.data:uInt32Attribute-1.0.0","inherits":"autodesk.data:attribute-1.0.0","properties":[{"id":"value","typeid":"Uint32"}]}')},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1254);Object.defineProperty(t,"ChangesetMerger",{enumerable:!0,get:function(){return r.ChangesetMerger}});var o=n(532);Object.defineProperty(t,"isArrayChangeSet",{enumerable:!0,get:function(){return o.isArrayChangeSet}});var i=n(249);Object.defineProperty(t,"isChangeset",{enumerable:!0,get:function(){return i.isChangeset}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ChangesetMerger=void 0;const o=r(n(196)),i=r(n(13)),s=r(n(59)),a=n(249),c=n(532);class ChangesetMerger{static mergeChangesets(e,t){if(i.default(e)&&i.default(t))return e;if(i.default(t))return e;if(i.default(e))return s.default(t);if(!a.isChangeset(e))throw new Error("The source object is not a changeset");if(!a.isChangeset(t))throw new Error("The applied object is not a changeset.");return ChangesetMerger.handleRemove(e,t),ChangesetMerger.handleInsert(e,t),ChangesetMerger.handleModify(e,t),e}static mergeChangesetList(e){if(0===e.length)return{};let t=s.default(e[0]);for(const n of e.slice(1))t=ChangesetMerger.mergeChangesets(t,n);return ChangesetMerger.cleanupChangeSet(t)}static handleInsert(e,t){var n,r,o,i;const s=e;if(void 0===t.insert)return e;for(const[e,u]of Object.entries(t.insert))for(const[t,l]of Object.entries(u)){let u=!1;if(s.remove&&s.remove.includes(t)){u=!0;const n=s.remove.indexOf(t);n>=0&&s.remove.splice(n,1),ChangesetMerger.setValueInChangeset(s,"modify",e,t,l)}else void 0!==(null===(r=null===(n=s.insert)||void 0===n?void 0:n[e])||void 0===r?void 0:r[t])?(u=!0,a.isChangeset(l)&&a.isChangeset(s.insert[e][t])&&!c.isArrayChangeSet(l)?s.insert[e][t]=ChangesetMerger.mergeChangesets(s.insert[e][t],l):ChangesetMerger.setValueInChangeset(s,"insert",e,t,l)):void 0!==(null===(i=null===(o=s.modify)||void 0===o?void 0:o[e])||void 0===i?void 0:i[t])&&(u=!0,a.isChangeset(l)&&a.isChangeset(s.modify[e][t])&&!c.isArrayChangeSet(l)?s.modify[e][t]=ChangesetMerger.mergeChangesets(s.modify[e][t],l):ChangesetMerger.setValueInChangeset(s,"modify",e,t,l));u||ChangesetMerger.setValueInChangeset(s,"insert",e,t,l)}return s}static handleModify(e,t){var n,r,o,i,s,u,l,d;const p=e;if(void 0===t.modify)return e;for(const[e,h]of Object.entries(t.modify))for(const[t,m]of Object.entries(h)){let h=!1;if(p.remove&&p.remove.includes(t)){const e=p.remove.indexOf(t);e>=0&&p.remove.splice(e,1)}else void 0!==(null===(r=null===(n=p.insert)||void 0===n?void 0:n[e])||void 0===r?void 0:r[t])?(h=!0,a.isChangeset(m)&&a.isChangeset(p.insert[e][t])?c.isArrayChangeSet(m)?ChangesetMerger.setValueInChangeset(p,"insert",e,t,m):p.insert[e][t]=ChangesetMerger.mergeChangesets(p.insert[e][t],m):"object"==typeof(null===(i=null===(o=p.insert)||void 0===o?void 0:o[e])||void 0===i?void 0:i[t])&&"object"==typeof m?ChangesetMerger.mergeStaticChangesets(null===(u=null===(s=p.insert)||void 0===s?void 0:s[e])||void 0===u?void 0:u[t],m):ChangesetMerger.setValueInChangeset(p,"insert",e,t,m)):void 0!==(null===(d=null===(l=p.modify)||void 0===l?void 0:l[e])||void 0===d?void 0:d[t])&&(h=!0,a.isChangeset(m)&&a.isChangeset(p.modify[e][t])&&!c.isArrayChangeSet(m)?p.modify[e][t]=ChangesetMerger.mergeChangesets(p.modify[e][t],m):ChangesetMerger.setValueInChangeset(p,"modify",e,t,m));h||ChangesetMerger.setValueInChangeset(p,"modify",e,t,m)}return p}static handleRemove(e,t){const n=e;if(void 0===t.remove)return e;for(const e of t.remove){let t=!1;if(n.insert)for(const r of Object.keys(n.insert))n.insert[r]&&void 0!==n.insert[r][e]&&(delete n.insert[r][e],t=!0);if(!t&&n.modify)for(const t of Object.keys(n.modify))delete n.modify[t][e];t||(n.remove?n.remove.includes(e)||n.remove.push(e):n.remove=[e])}return n}static mergeStaticChangesets(e,t){var n;if(i.default(e))return t;if(i.default(t))return e;const r=e;for(const[e,o]of Object.entries(t))for(const[t,i]of Object.entries(o))void 0!==(null===(n=null==r?void 0:r[e])||void 0===n?void 0:n[t])&&void 0!==i&&(r[e][t]=i);return r}static setValueInChangeset(e,t,n,r,o){const i=e;if(void 0!==o)if("remove"===t){const e=i[t];void 0===e?i[t]=[r]:e.push(r)}else{const e=i[t];void 0===e?i[t]={[n]:{[r]:o}}:e&&void 0===e[n]?e[n]={[r]:o}:e[n][r]=o}}static cleanupChangeSet(e){if(i.default(e))return e;if(!a.isChangeset(e))throw new Error("[cleanupChangeset] The object passed is not a changeset");const t=s.default(e);return t.insert&&(t.insert=o.default(t.insert,i.default)),t.modify&&(t.modify=o.default(t.modify,i.default)),o.default(t,i.default)}static normalizeChangeset(e){var t;if(i.default(e))return e;if(!a.isChangeset(e))throw new Error("[normalizeChangeSet] Cannot normalize input: Not a changeset.");const n={insert:e.insert};if(void 0!==e.modify)if(void 0===n.insert)n.insert=e.modify;else for(const[r,o]of Object.entries(e.modify))if(void 0===(null===(t=n.insert)||void 0===t?void 0:t[r]))n.insert[r]=o;else for(const[e,t]of Object.entries(o))a.isChangeset(t)?n.insert[r][e]=this.normalizeChangeset(t):n.insert[r][e]=t;return n}static mergeAndNormalizeChangesetList(e){return ChangesetMerger.normalizeChangeset(ChangesetMerger.mergeChangesetList(e))}}t.ChangesetMerger=ChangesetMerger},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSqLiteStore=t.SqliteStore=t.SqliteDatabase=t.SqliteJournalStore=t.SqliteEntityStore=void 0;const r=n(1256);Object.defineProperty(t,"SqliteStore",{enumerable:!0,get:function(){return r.SqliteStore}});const o=n(1257);Object.defineProperty(t,"SqliteDatabase",{enumerable:!0,get:function(){return o.SqliteDatabase}});const i=n(533);Object.defineProperty(t,"SqliteEntityStore",{enumerable:!0,get:function(){return i.SqliteEntityStore}});const s=n(534);Object.defineProperty(t,"SqliteJournalStore",{enumerable:!0,get:function(){return s.SqliteJournalStore}});var a=n(250);Object.defineProperty(t,"SqliteUtils",{enumerable:!0,get:function(){return a.SqliteUtils}}),t.createSqLiteStore=async function createSqLiteStore(e,t){const n=new o.SqliteDatabase(e);return await n.initialize(),new r.SqliteStore(n,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SqliteStore=void 0;const r=n(85),o=n(533),i=n(534);class SqliteStore extends r.Store{constructor(e,t){const n=new i.SqliteJournalStore(e);super(new o.SqliteEntityStore(e,n,t),n),this.sqliteDB=e}async startTransaction(){return new Promise((e,t)=>{this.sqliteDB.Db().exec("SAVEPOINT default_savepoint;\n",n=>{n?t(n):e()})})}async endTransaction(e){return new Promise((t,n)=>{this.sqliteDB.Db().exec((e?"":"ROLLBACK TO default_savepoint;")+"\nRELEASE default_savepoint;\n",e=>{e?n(e):t()})})}async dispose(){await this.sqliteDB.closeConnection()}}t.SqliteStore=SqliteStore},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SqliteDatabase=void 0;const o=r(n(1258)),i=n(1259);t.SqliteDatabase=class SqliteDatabase{constructor(e){this.dbFile=e||":memory:",this.db=new o.default.Database(this.dbFile,e=>{if(e)throw e})}async initialize(){const e=new i.DatabaseTables;await e.create(this.db)}Db(){return this.db}closeConnection(){return new Promise((e,t)=>{this.db.close(n=>n?t(n):e())})}async deleteEntityTables(){const e=new i.DatabaseTables;await e.deleteEntityTables(this.db)}async deleteJournalCommandTables(){const e=new i.DatabaseTables;await e.deleteJournalCommandTables(this.db)}}},function(e,t){e.exports=require("sqlite3")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DatabaseTables=void 0;class DatabaseTables{constructor(){this.createJournal="CREATE TABLE IF NOT EXISTS journal(\n    journalId TEXT NOT NULL PRIMARY KEY,\n    role TEXT NOT NULL,\n    collectionId TEXT,\n    parentJournalId TEXT,\n    syncToken TEXT,\n    properties TEXT NOT NULL,\n    createdAt TEXT NOT NULL DEFAULT (STRFTIME('%Y-%m-%d %H:%M:%f', 'NOW', 'localtime')),\n    FOREIGN KEY (parentJournalId) REFERENCES journal(journalId)\n  )",this.journalCollectionIdIndex="CREATE INDEX IF NOT EXISTS\n    journalCollectionIdIndex ON journal (collectionId, role, parentJournalId)",this.createCommand="CREATE TABLE IF NOT EXISTS command(\n    commandOrder INTEGER PRIMARY KEY AUTOINCREMENT,\n    commandId TEXT UNIQUE,\n    createDate TEXT NOT NULL,\n    commandName TEXT NOT NULL,\n    journalId TEXT NOT NULL,\n    status TEXT NOT NULL,\n    localIdStore TEXT,\n    modifiedDate TEXT NOT NULL,\n    parameters TEXT,\n    FOREIGN KEY (journalId) REFERENCES journal(journalId) ON DELETE CASCADE\n  )",this.commandJournalIdIndex="CREATE INDEX IF NOT EXISTS\n    commandJournalIdIndex ON command (journalId)",this.createCommandDependencies="CREATE TABLE IF NOT EXISTS commandDependencies(\n    commandId TEXT NOT NULL,\n    dependencyId TEXT NOT NULL,\n    PRIMARY KEY (commandId, dependencyId),\n    FOREIGN KEY (commandId) REFERENCES command(commandId) ON DELETE CASCADE\n    FOREIGN KEY (dependencyId) REFERENCES command(commandId) ON DELETE CASCADE\n  )",this.createEntity="CREATE TABLE IF NOT EXISTS entity(\n    entityIdx INTEGER PRIMARY KEY,\n    localId TEXT UNIQUE NOT NULL,\n    permanentId TEXT UNIQUE,\n    type TEXT NOT NULL\n  )",this.createEntityRevision="CREATE TABLE IF NOT EXISTS entityRevision(\n    entityIdx INTEGER NOT NULL,\n    journalId TEXT NOT NULL,\n    revisionId TEXT NOT NULL,\n    revisionPermanentId TEXT,\n    revisionDate TEXT NOT NULL,\n    parentEntityId TEXT,\n    commandId TEXT,\n    staticDataChanges TEXT,\n    dataChanges TEXT,\n    removed INTEGER,\n    created INTEGER,\n    PRIMARY KEY (entityIdx, journalId, revisionId),\n    FOREIGN KEY (commandId) REFERENCES command(commandId) ON DELETE CASCADE,\n    FOREIGN KEY (journalId, entityIdx) REFERENCES entityRevisionJournal(journalId, entityIdx) ON UPDATE CASCADE\n  )",this.revisionPermanentIdIndex="CREATE UNIQUE INDEX IF NOT EXISTS revisionPermanentIdIndex ON entityRevision (entityIdx, revisionPermanentId)",this.entityRevisionJournalIndex="CREATE INDEX IF NOT EXISTS entityRevisionJournalIndex\n      ON entityRevision (journalId, entityIdx, revisionDate, revisionId, revisionPermanentId)",this.entityRevisionCommandIdIndex="CREATE INDEX IF NOT EXISTS entityRevisionCommandIdIndex\n      ON entityRevision (commandId)",this.createRelationship="CREATE TABLE IF NOT EXISTS relationship(\n    entityIdx INTEGER NOT NULL,\n    toEntityId TEXT NOT NULL,\n    toRevisionId TEXT,\n    fromEntityId TEXT NOT NULL,\n    fromRevisionId TEXT,\n    PRIMARY KEY (entityIdx),\n    FOREIGN KEY (entityIdx) REFERENCES entity(entityIdx) ON DELETE CASCADE\n  )",this.relToEntityToRevisionIndex="CREATE INDEX IF NOT EXISTS relToEntityToRevisionIndex\n    ON relationship (toEntityId, toRevisionId)",this.relFromEntityFromRevisionIndex="CREATE INDEX IF NOT EXISTS relFromEntityFromRevisionIndex\n    ON relationship (fromEntityId, fromRevisionId)",this.createMaterializedView="CREATE TABLE IF NOT EXISTS materializedView(\n    entityIdx INTEGER NOT NULL,\n    journalId TEXT NOT NULL,\n    revisionId TEXT NOT NULL,\n    removed INTEGER NOT NULL,\n    parentEntityId TEXT,\n    data TEXT,\n    PRIMARY KEY (entityIdx, journalId, revisionId),\n    FOREIGN KEY (entityIdx, journalId, revisionId) REFERENCES entityRevision(entityIdx, journalId, revisionId)\n      ON DELETE CASCADE\n      ON UPDATE CASCADE\n  )",this.createEntityRevisionJournal="CREATE TABLE IF NOT EXISTS entityRevisionJournal(\n    entityIdx INTEGER NOT NULL,\n    journalId TEXT NOT NULL,\n    staticData TEXT NOT NULL,\n    PRIMARY KEY (entityIdx, journalId),\n    FOREIGN KEY (journalId) REFERENCES journal(journalId) ON DELETE CASCADE,\n    FOREIGN KEY (entityIdx) REFERENCES entity(entityIdx) ON DELETE CASCADE\n  )",this.createCommandInputEntity="CREATE TABLE IF NOT EXISTS commandInputEntity(\n    entityId TEXT NOT NULL,\n    commandId TEXT NOT NULL,\n    FOREIGN KEY (commandId) REFERENCES command(commandId) ON DELETE CASCADE,\n    PRIMARY KEY (entityId, commandId)\n  )"}async create(e){e.run("PRAGMA foreign_keys = ON;"),e.run("PRAGMA journal_mode = WAL;"),await DatabaseTables.executeSQL(e,this.createCommandDependencies),await DatabaseTables.executeSQL(e,this.createCommand),await DatabaseTables.executeSQL(e,this.createJournal),await DatabaseTables.executeSQL(e,this.commandJournalIdIndex),await DatabaseTables.executeSQL(e,this.journalCollectionIdIndex),await DatabaseTables.executeSQL(e,this.createEntity),await DatabaseTables.executeSQL(e,this.createEntityRevision),await DatabaseTables.executeSQL(e,this.createEntityRevisionJournal),await DatabaseTables.executeSQL(e,this.revisionPermanentIdIndex),await DatabaseTables.executeSQL(e,this.entityRevisionJournalIndex),await DatabaseTables.executeSQL(e,this.entityRevisionCommandIdIndex),await DatabaseTables.executeSQL(e,this.createMaterializedView),await DatabaseTables.executeSQL(e,this.createCommandInputEntity),await DatabaseTables.executeSQL(e,this.createRelationship),await DatabaseTables.executeSQL(e,this.relToEntityToRevisionIndex),await DatabaseTables.executeSQL(e,this.relFromEntityFromRevisionIndex)}async deleteEntityTables(e){e.run("PRAGMA foreign_keys = ON;");const t=["materializedView","relationship","entityRevision","entityRevisionJournal","entity"];for(const n of t)await DatabaseTables.executeSQL(e,"DELETE FROM "+n)}async deleteJournalCommandTables(e){e.run("PRAGMA foreign_keys = ON;");const t=["commandDependencies","commandInputEntity","command","journal"];for(const n of t)await DatabaseTables.executeSQL(e,"DELETE FROM "+n)}static async executeSQL(e,t){return new Promise((n,r)=>{e.run(t,e=>{e?r(e):n()})})}}t.DatabaseTables=DatabaseTables},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1261),o=n(5);t.DocumentIdentityService=class DocumentIdentityService{constructor(){this.INVARIANT_VERSION_SEPARATOR=":",this.SERIALIZE_INVARIANT_MAP_KEY="invariantMap",this.SERIALIZE_ALIASES_KEY="invariantAliases",this.invariantMap=new Map,this.aliases=new Map}updateJournalProperties(e){e[this.SERIALIZE_INVARIANT_MAP_KEY]=JSON.stringify(Array.from(this.invariantMap.entries())),e[this.SERIALIZE_ALIASES_KEY]=JSON.stringify(Array.from(this.aliases.entries()))}async getMainJournal(e,t){let n;try{const r=await o.getPIMSDK(e,t);n=await r.getJournals().getMain(e.spaceCollectionId)}catch(t){console.log("[documentIdentityService]: Cannot get main journal. Possible that space\n        collection has not completed syncing. Space Collection id: "+e.spaceCollectionId)}return n}async serializeState(e,t){if(!t.pimStateService.isGloballyEnabled()||!t.pimStateService.isSpaceCollectionEnabled(e.spaceCollectionId))return void console.debug("[documentIdentityService]: PIM is disabled for this hub. Skipping\n        serializing state. Space Collection id: "+e.spaceCollectionId);const n=await this.getMainJournal(e,t);if(!n)return void console.log("[documentIdentityService]: Cannot find main journal. Skipping serializing\n        service. Space Collection id: "+e.spaceCollectionId);const r=await n.getProperties();r?(this.updateJournalProperties(r),await n.setProperties(r)):console.log("[documentIdentityService]: Cannot find main journal properties. Skipping\n       serialize service. Space Collection id: "+e.spaceCollectionId)}mergeMap(e,t){t.forEach((t,n)=>{e.has(n)||e.set(n,t)})}parseSerializedMap(e){let t=new Map;if(!e)return t;try{t=new Map(JSON.parse(e))}catch(e){console.log("documentIdentityService]: Parsing error when trying to rehydrate\n      serialized map. Error: "+e)}return t}async rehydrateState(e,t){if(!t.pimStateService.isGloballyEnabled()||!t.pimStateService.isSpaceCollectionEnabled(e.spaceCollectionId))return void console.debug("[documentIdentityService]: PIM is disabled for this hub. Skipping\n        rehydrating service. Space Collection id: "+e.spaceCollectionId);await o.getOrCreateSdkInstance(e,t);const n=await this.getMainJournal(e,t);if(!n)return void console.log("[documentIdentityService]: Cannot find main journal. Skipping rehydrating\n        service. Space Collection id: "+e.spaceCollectionId);const r=await n.getProperties();if(!r)return void console.log("[documentIdentityService]: Cannot find main journal properties. Skipping\n       rehydrating service. Space Collection id: "+e.spaceCollectionId);const i=r[this.SERIALIZE_INVARIANT_MAP_KEY],s=r[this.SERIALIZE_ALIASES_KEY];if(i&&"string"==typeof i){const e=this.parseSerializedMap(i);this.mergeMap(this.invariantMap,e)}if(s&&"string"==typeof s){const e=this.parseSerializedMap(s);this.mergeMap(this.aliases,e)}console.log("[documentIdentityService]: Successfully rehydrated service.\n     Space Collection id: "+e.spaceCollectionId)}async makeAlias(e,t,n,o){this.aliases.set(n,o);let i=this.invariantMap.get(o);i?(i.alias=n,this.invariantMap.set(o,i)):(i=new r.DocumentInvariant(o,n),this.invariantMap.set(o,i)),await this.serializeState(e,t)}async createInvariant(e,t,n,o){let i,s,a;if(n&&o)i=o,s=new r.DocumentInvariant(o,n),a=n;else if(n)i=n,s=new r.DocumentInvariant(n);else{if(!o)throw new Error("[documentIdentityService]: ERROR - Both docId and lineageUrn parameters\n      are empty. Cannot create invariant records.");i=o,s=new r.DocumentInvariant(o)}return i&&s&&(this.invariantMap.set(i,s),a&&await this.makeAlias(e,t,a,i),await this.serializeState(e,t)),s}async findInvariant(e,t,n,r){if(!n&&!r)return;const o=r?this.invariantMap.get(r):void 0,i=n?this.invariantMap.get(n):void 0;if(o&&i)return o!==i&&console.log(`[documentIdentityService]: WARNING - Both lineageUrn and docId found in invariant map.\n        Expected at least one of them to be an alias. lineageUrn: ${r}, docId: ${n}`),o;let s=void 0;return o&&(s=o,r&&n&&(await this.makeAlias(e,t,n,r),r&&(s=this.invariantMap.get(r)),await this.serializeState(e,t))),i&&(s=i,r&&n&&(await this.makeAlias(e,t,r,n),n&&(s=this.invariantMap.get(n)),await this.serializeState(e,t))),s}getInvariantIdFromMap(e){if(!e)return;const t=this.invariantMap.get(e);return t?t.id:void 0}findInvariantIdSync(e,t){let n;if(t?n=this.getInvariantIdFromMap(t):e&&(n=this.getInvariantIdFromMap(e)),!n){let r;t?r=this.aliases.get(t):e&&(r=this.aliases.get(e)),r&&(n=this.getInvariantIdFromMap(r))}return n}async generateInvariantId(e,t,n,r){let o=await this.findInvariant(e,t,n,r);if(!o){let e=void 0;r?e=this.aliases.get(r):n&&(e=this.aliases.get(n)),e&&(o=this.invariantMap.get(e))}return o||(o=await this.createInvariant(e,t,n,r)),o?o.id:void 0}clearCurrentState(){this.invariantMap=new Map,this.aliases=new Map}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DocumentInvariant=class DocumentInvariant{constructor(e,t){this.id=e,t&&(this.alias=t)}}},function(e,t,n){"use strict";function repeatString(e,t){let n=t,r="";for(;n>0;)r+=e,n--;return r}function formatRow(e,t,n){return e.reduce((e,n,r)=>{const o=""+n,i=2+(t[r]-o.length)/2;return e+repeatString(" ",Math.floor(i))+o+repeatString(" ",Math.ceil(i))+"|"},"|")+"\n"}Object.defineProperty(t,"__esModule",{value:!0}),t.formatTable=function formatTable(e,t){const n=e.map(e=>e.trim().length);return t.forEach((t,r)=>{if(t.length<e.length)throw new Error(`Cannot format table. Row ${r} is smaller than expected.`);if(t.length>e.length)throw new Error(`Cannot format table. Row ${r} is larger than expected.`);t.forEach((e,t)=>{const r=(""+e).trim();r.length>n[t]&&(n[t]=r.length)})}),formatRow(e,n)+t.reduce((e,t)=>e+formatRow(t,n),"")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(516),o=n(243);t.helpReorderingTextCommandHandler=async function helpReorderingTextCommandHandler(e,t,n){let i="pim.fremontjs <command>:\n";return i+=Object.values(r.FremontTextCommands).map(e=>{const{description:t,parameters:n}=o.FremontTextCommandRegistry[e],r=` [${(n||[]).join(", ")}]`;return`\t${e}${void 0!==n?r:""}: ${t}`}).join("\n"),{message:i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),o=n(5),i=n(118);t.createReadableDiff=e=>{let t="";if(0!==e.components.extraneous.remote.length){t+="  Extraneous Components (remote): ";const n=[];e.components.extraneous.remote.forEach(e=>n.push(`"${e.name}"`)),t+=n.sort().join(", "),t+="\n"}if(0!==e.components.extraneous.local.length){t+="  Extraneous Components (local): ";const n=[];e.components.extraneous.local.forEach(e=>n.push(`"${e.name}"`)),t+=n.sort().join(", "),t+="\n"}if(0!==Object.keys(e.components.properties).length&&(t+="  Mismatching Properties:\n",Object.keys(e.components.properties).sort().forEach(n=>{Object.keys(e.components.properties[n]).sort().forEach(r=>{t+=`    ${n}:\n`,t+=`      ${r}:\n`,t+=`        Remote: ${e.components.properties[n][r].remote}\n`,t+=`        Local: ${e.components.properties[n][r].local}\n`})})),0!==e.extraneousInstances.remote.length){t+="  Extraneous Instances (remote): ";const n=[];e.extraneousInstances.remote.forEach(e=>n.push(`"${e.LinkName}"`)),t+=n.sort().join(", "),t+="\n"}if(0!==e.extraneousInstances.local.length){t+="  Extraneous Instances (local): ";const n=[];e.extraneousInstances.local.forEach(e=>n.push(`"${e.LinkName}"`)),t+=n.sort().join(", ")}return t},t.diffTextCommandHandler=async function diffTextCommandHandler(e,n,s){const a=o.getSDKInstance(e,n);if(void 0===a)return{message:"Unable to get SDK instance"};const c=a.pimsdk,u=e.spaceCollectionId,l=JSON.parse(s.params[0]);if(".f3d"!==l.extension)return{message:"Please use pim.diff on a design document"};if(l.docId&&l.lineageUrn){const t=await n.documentIdentityService.generateInvariantId(e,n,l.docId,l.lineageUrn);if(void 0!==t){const e=n.pimStateService.getDocumentLastOperation(t);if(console.info("The last operation was "+e),e!==i.DocumentOperationState.UPLOADED&&e!==i.DocumentOperationState.OPENED&&void 0!==e)return{message:"Please wait until the Document is done opening/uploading/saving"}}else console.info("Unable to get invariant ID. Attempting to diff anyway")}const d=await c.pimFindRootProductAndVersionSnapshot(u,l.wipVersionUrn);if(void 0===d)return{message:"Unable to find root product and version snapshot. Maybe pim data is not in useable state."};const{rootProduct:p,snapshot:h}=d;if(!p)throw new Error("Root product cannot be found for that remote version urn");if(!h)throw new Error("Snapshot version cannot be found for that remote version urn");const m=await c.pimGetTopology(u,p,h,{fetch:!0,type:r.TopologyTypes.FULL}),y=r.buildF3DStructureFromTopology(c,m),g=r.createF3DMap(l.components),_=r.createF3DMap(y.component.components),v=void 0===l.instances?[]:l.instances,{component:{instances:E}}=y,I={components:r.compareComponents(g,_),extraneousInstances:r.compareInstances(v,E)},b=t.createReadableDiff(I);return b.length>0?{message:`Differences Found\nREADABLE\n${b}\n\nRAW\n${JSON.stringify(I)}`}:{message:"Success"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),o=n(251),i=n(118);t.waitTextCommandHandler=async function waitTextCommandHandler(e,t,n){const s=r.getSDKInstance(e,t);if(void 0===s)return{message:"Unable to get SDK instance"};const a=s.pimsdk,c=e.spaceCollectionId,u=n.params[0],l=parseInt(n.params[1]),d=n.params[2],p=n.params[3];console.info("Waiting for "+u);let h=await a.pimGetVersionSnapshot(c,u);const m=Date.now();for(;void 0===h;){if((Date.now()-m)/1e3>=l)return{message:"Timed out while waiting for PIM data"};await o.sleep(2e3),h=await a.pimGetVersionSnapshot(c,u)}if(void 0===d&&void 0===p)return{message:"Wait complete. Snapshot ID: "+h.getId()};const y=await t.documentIdentityService.generateInvariantId(e,t,d,p);if(void 0===y)throw Error(`Could not find invariantId for docId ${d} and lineageUrn ${p}`);let g=t.pimStateService.getDocumentLastOperation(y);for(;g!==i.DocumentOperationState.UPLOADED&&g!==i.DocumentOperationState.OPENED;){if((Date.now()-m)/1e3>=l)return{message:"Timed out while waiting for PIM data"};if(await o.sleep(1e3),g=t.pimStateService.getDocumentLastOperation(y),void 0===g)throw Error("Last operation was undefined");console.info("The last operation was "+g)}return{message:"Wait complete. Snapshot ID: "+h.getId()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8);t.AttributeKeys=r.AttributeKeys},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(175);t.assetClosingHandler=async function assetClosingHandler(e,t,n){return r.wipVersionToSnapshotManager.clearCachedWipVersion(n.wipVersionUrn),{}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1269),o={};t.getSpaceCollectionForHub=async function getSpaceCollectionForHub(e,t,n){if(o[t])return o[t];const i=new r.FTClient(e.fusionTeamUrl,t);let s;try{s=await i.getHubInfoByTenantId(e.bearerToken,n)}catch(e){throw console.log(`Could not get hub ${t}: ${e}`),e}return s.pimRepositoryUrn},t.clearCachedSpaceCollections=function clearCachedSpaceCollections(){for(const e of Object.keys(o))delete o[e]}},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(176),s=r(n(1270)),a=n(1271),c=n(539),u=o(n(1272));class FTClient{constructor(e,t,n){if(this.hubDomain=e,this.hubId=t,n=n||`https://${t}.${e}`,!this.hubDomain||!this.hubId)throw new Error("[ft-client]: FTClient configuration parameters missing in runtime environment.\n      Cannot instantiate FTClient.");this.apiInstance=s.default({baseURL:n}),this.apiLoginInstance=s.default({baseURL:"https://login."+e})}async getSystemInfo(e,t){const n=await this._requestWithRetry(this._getSystemInfoRequestData(e,t),"LOGIN");console.info(n);const r=c.get(n,"data.success.body"),o={services:{}};return console.info(r),r.services.forEach(e=>{console.info("service",e,e.name,e.info),o.services[e.name]={},Array.isArray(e.info)?e.info.forEach(t=>{console.info(e.name,o.services[e.name]),o.services[e.name][t.name]=t.value}):e.info.name&&e.info.value&&(o.services[e.name][e.info.name]=e.info.value)}),o}async getHubInfo(e,t){const n=await this._requestWithRetry(this._getHubInfoRequestData(e,t)),r=c.get(n,"data.success.body.objects[0]");if(r)return r;throw new Error("[ft-client]: Failed to fetch Hub info.")}async getHubInfoByTenantId(e,t,n){const r=await this._requestWithRetry(this._getHubInfoRequestData(e,n,t)),o=c.get(r,"data.success.body");if(o)return o;throw new Error("[ft-client]: Failed to fetch Hub info.")}async getHubInfoByHubId(e,t,n){const r=await this._requestWithRetry(this._getHubInfoRequestData(e,n)),o=c.get(r,"data.success.body.objects");for(let e=0;e<o.length;e++)if(o[e].hubId===t)return o[e];throw new Error("[ft-client]: Failed to fetch Hub info.")}async getProject(e,t,n){const r=await this._requestWithRetry(this._getProjectRequestData(e,t,n)),o=c.get(r,"data.success.body");if(o)return o;throw new Error("[ft-client]: Failed to fetch project info.")}async moveFolder(e,t,n,r,o){const i=await this._requestWithRetry(this._getsMoveFolderRequestData(e,t,n,r,o),"HUB",0,s.shouldRetryMoveFolder),a=c.get(i,"data.success.body");if(a)return a;{const e=c.get(i,"data");throw new Error("[ft-client]: Failed to move Folder. data:"+JSON.stringify(e||{message:"response without data."}))}}async copyFolder(e,t,n,r,o){const i=await this._requestWithRetry(this._getsCopyFolderRequestData(e,t,n,r,o),"HUB",0,s.shouldRetryMoveFolder),a=c.get(i,"data.success.body");if(a)return Object.assign(Object.assign({},a),{status:i.status});{const e=c.get(i,"data");throw new Error("[ft-client]: Failed to move Folder. data:"+JSON.stringify(e||{message:"response without data."}))}}async moveFile(e,t,n,r,o){const i=await this._requestWithRetry(this._getsMoveFileRequestData(e,t,n,r,o)),s=c.get(i,"data.success.body");if(s)return s;throw new Error("[ft-client]: Failed to move Folder.")}async getAllProjects(e,t){return await this.recursivelyFetchAllProjects([],a.DEFAULT_ALL_PROJECT_PARAMS,e,t)}async recursivelyFetchAllProjects(e=[],t=a.DEFAULT_ALL_PROJECT_PARAMS,n,r){const o=this._getAllProjectRequestData(t,n,r),s=await this._requestWithRetry(o);if(s&&s.data&&s.data.success){e=e.concat(c.get(s,"data.success.body.objects",[]));const t=c.get(s,"data.success.body.links.link");if(t&&"nextPage"===t.rel){const o=t.href.split("?")[1],s=o?i.parse(o):{};return this.recursivelyFetchAllProjects(e,s,n,r)}return e}throw new Error("[ft-client]: Failed to fetch all Projects.")}_getProjectRequestData(e,t,n){const r=this._getRequestHeaderBasedOnToken(t,n);return{url:a.PROJECT_URL,method:"GET",headers:r,params:{mode:"all",community:e}}}_getsMoveFolderRequestData(e,t,n,r,o){const i=this._getRequestHeaderBasedOnToken(r,o),s=u.default(e);return{url:`${a.FOLDERS_URL}/${s}/move`,method:"POST",headers:i,params:{"csrf-token":r},data:{parent:t,name:n}}}_getsCopyFolderRequestData(e,t,n,r,o){const i=this._getRequestHeaderBasedOnToken(r,o),s=u.default(e);return{url:`${a.FOLDERS_URL}/${s}/copy`,method:"POST",headers:i,params:{"csrf-token":r},data:{parent:t,name:n}}}_getsMoveFileRequestData(e,t,n,r,o){const i=this._getRequestHeaderBasedOnToken(r,o),s=u.default(e);return{url:`${a.FILES_URL}/${s}/move`,method:"POST",headers:i,params:{"csrf-token":r},data:{parent:t,name:n}}}_getHubInfoRequestData(e,t,n){const r=this._getRequestHeaderBasedOnToken(e,t);let o,i;return n?(o=a.HUB_INFO_URL+"/"+n,i={}):(o=a.HUB_INFO_URL,i={mode:"all"}),{url:o,method:"GET",headers:r,params:i}}_getSystemInfoRequestData(e,t){const n=this._getRequestHeaderBasedOnToken(e,t);return{url:a.SYSTEM_INFO_URL,headers:Object.assign(Object.assign({},n),{"Content-Type":"application/json","User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36"}),method:"GET"}}_getAllProjectRequestData(e,t,n){const r=this._getRequestHeaderBasedOnToken(t,n);return{url:a.ALL_PROJECTS_URL,method:"GET",headers:r,params:e}}_getRequestHeaderBasedOnToken(e,t){const n={Authorization:"Bearer "+e};return t&&(n["x-user-id"]=t),n}async _requestWithRetry(e,t="HUB",n=0,r){let o;await s.retryDelay(n*a.RETRY_REQUEST_DELAY);try{const n="HUB"===t?this.apiInstance:this.apiLoginInstance;o=await n.request(e)}catch(e){o=e.response}return n+=1,(r?r(o):s.shouldRetry(o))&&n<a.MAX_REQUEST_RETRIES&&(o=await this._requestWithRetry(e,t,n,r)),o}}t.FTClient=FTClient,t.default=FTClient},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(62)),i=n(539);function shouldRetry(e){return e&&e.status&&e.status>=500}t.default=function ApiClient(e){return o.default.create(e)},t.retryDelay=function retryDelay(e){return new Promise(t=>{setTimeout(t,e)})},t.shouldRetry=shouldRetry,t.shouldRetryMoveFolder=function shouldRetryMoveFolder(e){let t=shouldRetry(e);return t&&(t=void 0!==i.get(e,"data.success.body")),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROJECT_URL="/communities/api/user/community",t.FOLDERS_URL="/data/api/folders",t.FILES_URL="/data/api/files",t.ALL_PROJECTS_URL="/communities/api/projects",t.HUB_INFO_URL="/login/api/hubs",t.SYSTEM_INFO_URL="/login/api/system/info",t.MAX_REQUEST_RETRIES=5,t.RETRY_REQUEST_DELAY=100,t.DEFAULT_ALL_PROJECT_PARAMS={mode:"all",count:"300"}},function(e,t){!function(){"use strict";e.exports=function btoa(e){return(e instanceof Buffer?e:Buffer.from(e.toString(),"binary")).toString("base64")}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8);class WipVersionToSnapshotManager{constructor(){WipVersionToSnapshotManager.wipVersionToSnapshotMap=new Map}static getInstance(){return WipVersionToSnapshotManager.instance||(WipVersionToSnapshotManager.instance=new WipVersionToSnapshotManager),WipVersionToSnapshotManager.instance}async getVersionSnapshotIdForWipVersion(e,t,n){if(WipVersionToSnapshotManager.wipVersionToSnapshotMap.has(n))return console.log("Using cached value for wipVersionUrn "+n),WipVersionToSnapshotManager.wipVersionToSnapshotMap.get(n);const o=(await e.getSpaceCollection(t,{fetch:!0})).getSnapshots({filter:{"attribute.wipVersionUrn":n}}),i=await r.getAllPages(o,"getSnapshots"),s=[];if(await Promise.all(i.map(async e=>{await e.fetch(),e.getComponent("version")&&s.push(e)})),!s.length)throw new Error("Could not find a snapshot for WIP Version URN "+n);if(s.length>1)throw new Error("Found more than one version snapshot for WIP Version URN "+n);const a=s[0].getId();return WipVersionToSnapshotManager.wipVersionToSnapshotMap.set(n,a),a}clearCachedWipVersion(e){WipVersionToSnapshotManager.wipVersionToSnapshotMap.delete(e)}}t.wipVersionToSnapshotManager=WipVersionToSnapshotManager.getInstance()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),o=n(71),i=n(117);t.onPostSave=async function onPostSave(e,t,n){const{pimsdk:s,options:a}=t,{spaceCollectionId:c}=e;if(!a||!a.documentIdentityService)throw new Error("[onPostSaveCommand]: No DocumentIdentityService found. Cannot complete command.");const{design:u,clobber:l,lineageUrn:d,docId:p,localFileVersion:h,projectUrn:m,milestone:y,milestoneName:g,milestoneDescription:_}=n,v=await a.documentIdentityService.generateInvariantId(e,a,n.docId,n.lineageUrn);if(!v)throw new Error("[onPostSaveCommand]: InvariantId could not be generated. Cannot complete command.");y&&a.pimStateService.setMilestone(v,{create:y,name:g,description:_});const E=await i.makeOrGetIsolationJournal(t,v,h,p,l,d),I=E.getId(),b=await s.getNewInstanceExperimental({journalMappings:{collections:{[c]:I}}});let S;if(d){const e=await b.pimGetLatestVersionSnapshot(c,d);if(e){S=e.getId();const t={baseSnapshotId:S};await i.addTagsToJournal(E,t)}}const C=await i.getLocalSnapshotTag(E),w=await i.getRootItemInIsolationJournal(E),{snapshot:A,rootProductId:O,newSpaceIds:P}=await r.updatePIMDataFromF3DStructure(b,c,u,{localSnapshot:C,description:n.description,lineageUrn:d,projectUrn:m,rootProductId:w},(...n)=>o.rootProductAndVersionSnapshotFetcher(e,t,...n));await i.updateNewSpacesInJournal(E,P),await i.addLocalSnapshotTagToJournal(E,A.getId());const D={milestone:y||!1,milestoneName:g,milestoneDescription:_};return await i.addTagsToJournal(E,D),w!==O&&await i.setRootItemInIsolationJournal(E,O),{invariantId:v,localFileVersion:h,snapshotId:A.getId(),rootProductId:O}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(6),i=n(8),s=n(1276),a=n(5),c=n(49),u=n(71);t.onPostUpload=async function onPostUpload(e,t,n,l){const{pimsdk:d,options:p}=t,{spaceCollectionId:h}=e;if(!p||!p.documentIdentityService)throw new Error("[onPostUpload]: No DocumentIdentityService found. Cannot complete command.");const m=u.createTimeLogger("Upload PIM data for WIP Version "+l.newVersionUrn);m("Phase 1: Get Journal");const{lineageUrn:y,docId:g,localFileVersion:_,newLineageUrn:v,newVersionUrn:E}=l,I=await p.documentIdentityService.generateInvariantId(e,p,l.docId,l.lineageUrn);if(!I)throw new Error("[onPostUpload]: InvariantId could not be generated. Cannot complete command.");const{sdk:b,journal:S}=await u.getSdkForSpaceCollectionId(e.spaceCollectionId,p,y,g,_);if(!S||!b)return console.info(`[onPostUpload]: Can't find a journal for the local design file ${I} / ${l.localFileVersion}`),{};const C=await S.getProperties(),w={create:!0===C.milestone,name:C.milestoneName?C.milestoneName.toString():"",description:C.milestoneDescription?C.milestoneDescription.toString():""},A=await i.toSpaceCollection(b,h,{fetch:!1});if(m("Phase 2: Find snapshot and root item"),S.getType()!==r.JournalType.ISOLATED)throw new Error("Can only handle isolation journals");const O=await a.selectJournal(t,r.JournalType.MAIN);if(!s.isFirstWipVersionId(l.newVersionUrn)){const e=s.getPreviousWipVersionUrn(l.newVersionUrn);if(!await O.pimFindRootItemAndVersionSnapshot(A,e))throw new Error(`PIM data for previous versionUrn ${e} not found in PIM / doc id(${I}). Disabling PIM for this document [current version urn is ${l.newVersionUrn}]`)}const P=await u.getLocalSnapshotTag(S);if(!P)throw new Error("Can not find localSnapshotId on the journal: "+S.getId());const D=await b.getSnapshot(P,A,{fetch:!0});if(console.info("[onPostUpload]: Local snapshot of the isolation journal",D?D.getId():"not found"),!D)throw new Error("[onPostUpload]: Could not find the snapshot from isolation joural");const x=await u.getRootItemIdTag(S);if(!x)throw new Error("[onPostUpload]: Could not find the root item id from isolation journal");m("Phase 3: Update model/sheets assets with lineage information + version components and attributes");const R=await i.getAllPages(D.getAssets(),"getAssets");await Promise.all(R.map(e=>e.fetch()));const N=n===i.DOCUMENT_TYPE.Design?R.filter(u.isModel):R.filter(u.isSheets);b.beginBatch();const M=N.map(e=>{if(!e.listComponents().includes("wipReference")&&n===i.DOCUMENT_TYPE.Design&&(e.createComponent("wipReference",i.getSchemaManager(b.pimGetSchemasVersion()).getFamilyTypeId(i.PIM_COMPONENT_FAMILY.WIP_REFERENCE)),b.pimGetSchemasVersion()===i.PIM_SCHEMAS_VERSIONS.VERSION_0_1_0)){b.pimGetComponentProxy(e,"wipReference").lineageURN=v}const t=e.getAttribute(i.AttributeKeys.WIP_LINEAGE_URN);return t&&t===v?null:(i.setEntityAttribute(e,i.AttributeKeys.WIP_LINEAGE_URN,v),i.setEntityAttribute(e,i.AttributeKeys.DM_LINEAGE_ID,v),e)}).filter(e=>e);m("Phase 3b: Update version snapshot with updated assets"),M.forEach(e=>{D.removeAsset(e),D.addVersionedAssetWithEventualRevision(e)}),m("Phase 4: Set space security");const L=await u.getTagValueFromJournal(S,u.JOURNAL_PIM_PROPERTIES.NEW_SPACES);if(!l.newLineageUrn)throw new Error("newLineageUrn not set");for(const e of L){(await b.getSpace(e,A)).addPermissionContext(r.PermissionContextName.PIM_CONTEXT,r.PermissionContextType.WIP_URN,l.newLineageUrn)}m("Phase 5: Update version snapshot, make it official"),i.setVersionSnapshot(D,{wipVersionUrn:E,incompleteState:"fremont-complete"});const j=await b.endBatch();i.validateBatchResult(j);let k=S;for(;k&&k.getType()!==r.JournalType.REMOTE;){let e=await k.getParent();if(k&&k.getType()===r.JournalType.MAIN){m("Phase 6a: Main Journal - Collect spaces / Closure");const e={startAssets:[{asset:x}],maxDepth:1,relationshipFilters:[{type:{name:i.PIM_CONTAINS_RELATIONSHIP_TYPENAME},direction:"OUT"}],include:{assetComponents:!0}},n=await r.AssetGraph.getClosureV2(O,h,e),s=new Set;for(const e of n.getAssets())s.add(o.extractId(e.spaceId));m("Phase 6b: Publish to remote");try{await k.publishOnly()}catch(e){throw await p.pimStateService.disableDocument(I,A,d,t.journalService.getSdk(),e),await u.resetJournal(k,t.journalService.getSdk()),await a.documentRootSync(d,A,x),e}c.reportTelemetry({componentName:"onPostUpload",componentAttributes:{extInfo:c.ReportType.DocumentPublished,misc:"PIM Data is published in L2",lineageUrn:l.newLineageUrn,wipVersionUrn:l.newVersionUrn,documentId:l.docId},logLocation:c.LogLocation.Console,logLevel:c.LogLevel.Info}),m("Phase 6c: convert to permanent ids");const y=new Set;for(const e of s){const n=await a.getPermanentIds(k,t.journalService.getSdk().store,e);n.entityPermanentId&&y.add(n.entityPermanentId)}m("Phase 6d: synchronize spaces"),await a.synchronizeSpaces(d,h,Array.from(y))}else{if(k&&(null==e?void 0:e.getType())!==r.JournalType.MAIN&&p.pimStateService.isJournalReorderingEnabled()){const t=await d.getJournals().getMain(A.getId());await k.setParent(t.getId(),{mode:"single",rebase:!1,recursiveRebase:!1}),e=await k.getParent()}m("Phase 6a: Publish to main");try{await k.publish()}catch(e){throw await p.pimStateService.disableDocument(I,A,d,t.journalService.getSdk(),e),e}m("Phase 6b: Journal cleanup"),await u.removeTagFromJournal(k,u.JournalTagNames.IN_USE_UPLOAD)}if(k.getType()===r.JournalType.ISOLATED){if(m("Phase 7: Delete journals"),k&&(null==e?void 0:e.getType())!==r.JournalType.MAIN)throw new Error("Cannot publish nested journal until its parent has been publish.");await u.deleteJournal(k,t.journalService.getSdk())}k=e}if(w.create){m("Phase 8: Create milestone");const e=await O.pimGetVersionSnapshot(A.getId(),E);if(!e)throw new Error(`[onPostUpload]: Cannot find snapshot for versionUrn ${E}.`);u.createMilestoneAndSendResponse(d,p.messageService,h,w,l.newVersionUrn,i.MILESTONE_SCOPES.ALL,e.getId()),p.pimStateService.setMilestone(I,{create:!1})}return m(),{newLineageUrn:v,newVersionUrn:E,snapshot:D.getId(),spaceCollection:A.getId()}}},function(e,t,n){"use strict";function __export(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),__export(n(92)),__export(n(1277))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseWipVersionUrn=e=>{const t=/urn:adsk\.(\w*):fs\.file:vf\.([^?]*)\?version=(\d*)/.exec(e);if(!t)return void console.error("Failed to parse versionUrn string");return{urn:`urn:adsk.${t[1]}:fs.file:vf.${t[2]}`,version:parseInt(t[3],10)}},t.getPreviousWipVersionUrn=e=>{const n=t.parseWipVersionUrn(e);if(!n||!n.urn||!n.version)return"";const{urn:r,version:o}=n;return`${r}?version=${o-1}`},t.isFirstWipVersionId=e=>{const{version:n}=t.parseWipVersionUrn(e);return 1===n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(8),i=n(91),s=n(5),a=n(71);t.onPreUpload=async function onPreUpload(e,t,n,c){const{pimsdk:u,options:l,spaceCollectionId:d}=t;if(!l||!l.documentIdentityService)throw new Error("[onPreUpload]: No DocumentIdentityService found. Cannot complete command.");const p=a.createTimeLogger("Conflict Resolution for document id "+c.originalDocId);p("Phase 1: Find local journal");const{lineageUrn:h,docId:m,localFileVersion:y,originalDocId:g}=c,_=await l.documentIdentityService.generateInvariantId(e,l,c.docId,c.lineageUrn);if(!_)throw new Error("[onPreUpload]: InvariantId could not be generated. Cannot complete command.");const{sdk:v,journal:E}=await a.getSdkForSpaceCollectionId(e.spaceCollectionId,l,h,m,y);if(!E||!v){if(!h&&m!==g)throw i.pimStateService.disableDocument(g,d,t.pimsdk,t.journalService.getSdk(),new Error("Disabling Save-as document")),new Error("Journal for saved-as document not found");return console.info(`[onPreUpload]: Can't find a journal for the local file ${_} / ${y} - Ignoring event`),{}}if(await a.addTagsToJournal(E,{[a.JournalTagNames.IN_USE_UPLOAD]:!0}),c.overwritingRemoteVersion){p("Phase 2: Synchronize with remote");const e=await o.toSpaceCollection(u,d,{fetch:!1});if(void 0!==h){let i;const m=await s.selectJournal(t,r.JournalType.MAIN);if(i=await m.pimFindRootItem(e,h),!i){const n=await s.selectJournal(t,r.JournalType.REMOTE);if(i=await n.pimFindRootItem(e,h),!i)throw new Error(`[onPreUpload] Can not find the root product for the local file ${_} / ${y}`)}const g=await v.getJournals().getMain(d);if(await s.documentRootSync(u,e,i),await g.rebaseOnly(),E.getType()===r.JournalType.ISOLATED){const t=[];let i=await E.getParent();if(i&&i.getType()===r.JournalType.ISOLATED&&l.pimStateService.isJournalReorderingEnabled()){const t=await u.getJournals().getMain(e.getId());await E.setParent(t.getId(),{mode:"single",rebase:!0,recursiveRebase:!1}),i=await E.getParent()}for(;i&&i.getType()===r.JournalType.ISOLATED;)await a.addTagsToJournal(E,{[a.JournalTagNames.IN_USE_UPLOAD]:!0}),t.push(i),i=await i.getParent();p("Phase 3: Rebase isolation journal");for(const e of t.reverse())await e.rebase();p("Phase 4: Perform conflict resolution");const s=await a.getLocalSnapshotTag(E);if(!s)throw new Error("Can not find localSnapshotId on the journal: "+E.getId());const h=await v.getSnapshot(s,e,{fetch:!0});if(console.info("Local snapshot of the isolation journal",h?h.getId():"not found"),!h)throw new Error("onPreUpload: No local snapshot found in isolation journal "+E.getId());if(!i)throw new Error("onPreUpload: No parent journal to rebase from");const m=await v.getNewInstanceExperimental({journalMappings:{collections:{[d]:i.getId()}}}),y=c.lineageUrn;y&&await o.rebaseAndResolveConflicts(m,v,d,E,h,y,n)}}}return p(),{}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(8),i=n(5),s=n(521),a=n(117);t.onDrawingPostSave=async function onDrawingPostSave(e,t,n){const{pimsdk:c,options:u}=t,l=e.spaceCollectionId;if(!u||!u.documentIdentityService)throw new Error("[onDrawingPostSaveCommand]: No DocumentIdentityService found. Cannot complete command.");const{drawing:d,describes:p,clobber:h,lineageUrn:m,docId:y,localFileVersion:g,milestone:_,milestoneName:v,milestoneDescription:E}=n,I=await u.documentIdentityService.generateInvariantId(e,u,n.docId,n.lineageUrn);if(!I)throw new Error("[onDrawingPostSaveCommand]: InvariantId could not be generated. Cannot complete command.");_&&u.pimStateService.setMilestone(I,{create:_,name:v,description:E});const b=await a.makeOrGetIsolationJournal(t,I,g,y,h,m),S=b.getId(),C=await c.getNewInstanceExperimental({journalMappings:{collections:{[l]:S}}});let w;if(m){const e=await C.pimGetLatestVersionSnapshot(l,m);if(e){w=e.getId();const t={baseSnapshotId:w};await a.addTagsToJournal(b,t)}}const A=await a.getLocalSnapshotTag(b),O={};if(p.length)for(const n of p){let d,p,h=!1;const m=n.wipVersionUrn;if(u.pimStateService.isJournalReorderingEnabled())d=await s.findLocalRootProductAndSnapshot(t,l,n.docId,n.wipLineageUrn,n.localFileVersion);else{if("localFile"==n.toKind)throw new Error("[onDrawingPostSaveCommand] Describes relationship points to local file");if("string"!=typeof m)throw new Error("[onDrawingPostSaveCommand] Bad type of wipVersionUrn in describes");const t=(await a.getSdkForSpaceCollectionId(e.spaceCollectionId,u,n.wipLineageUrn,n.docId,n.localFileVersion)).journal;if(void 0!==t&&t.getType()===r.JournalType.ISOLATED)throw new Error("[onDrawingPostSave]: Does not support local references yet");d=await C.pimFindRootProductAndVersionSnapshot(l,m)}if(d)p=await C.pimGetModelFromProduct(l,d.rootProduct,d.snapshot);else{if(!m)throw new Error("[onDrawingPostSaveCommand] Cannot sync local design");let e=C.getNewInstanceExperimental({journalMappings:{default:r.JournalType.MAIN}});if(d=await e.pimFindRootProductAndVersionSnapshot(l,m),!d){const e=C.getNewInstanceExperimental({journalMappings:{default:r.JournalType.REMOTE}});if(d=await e.pimFindRootProductAndVersionSnapshot(l,m),!d)throw new Error(`No snapshot found for ${m} for describes`);h=!0}p=await e.pimGetModelFromProduct(l,d.rootProduct,d.snapshot)}if(!p)throw new Error("No model found to build describes relationship to: "+m);if(h){const e=p.getAttribute(o.AttributeKeys.WIP_LINEAGE_URN);if(void 0===e)throw new Error(`Missing ${o.AttributeKeys.WIP_LINEAGE_URN} for document refered by version: ${m}`);let t=i.getDocumentSyncFromLineage(e);void 0===t&&(t=i.documentRootSync(c,l,d.rootProduct)),await t}O[p.getId()]=d.snapshot.getId()}const{rootItem:P,snapshot:D,newSpaceIds:x}=await o.createPIMDataFromF2DStructure(C,l,d,O,A,{lineageUrn:m,projectUrn:n.projectFolderUrn,description:n.description});await a.updateNewSpacesInJournal(b,x),await a.addLocalSnapshotTagToJournal(b,D.getId()),await a.addRootItemIdTag(b,P.getId());const R={milestone:_,milestoneName:v,milestoneDesc:E};return await a.addTagsToJournal(b,R),{invariantId:I,localFileVersion:g,snapshotId:D.getId()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),o=n(5),i=n(49),s=n(71);t.onOpen=async function onOpen(e,t,n){if(!n.lineageUrn)throw new Error("Missing lineage urn.");if(!n.wipVersionUrn)throw new Error("Missing version urn.");const{pimsdk:a,options:c}=t,{spaceCollectionId:u}=e,l=await c.documentIdentityService.generateInvariantId(e,c,n.docId,n.lineageUrn),d=s.createTimeLogger("Open document with version urn "+n.wipVersionUrn);d("Phase 1: Get root asset + version snapshot");const p=await a.getJournals().getMain(u),h=a.getNewInstanceExperimental({journalMappings:{collections:{[u]:await p.getId()}}});let m,y=a;try{m=await a.pimFindRootItemAndVersionSnapshot(u,n.wipVersionUrn)}catch(e){console.log(`[onOpen] Error while trying to find ${n.wipVersionUrn} on remote. Will try to find it locally.`)}if(m){i.reportTelemetry({componentName:"rpcFremontEventQueue",componentAttributes:{extInfo:i.ReportType.DocumentSync,misc:"Starting sync of PIM data for document",lineageUrn:n.lineageUrn,wipVersionUrn:n.wipVersionUrn,documentId:n.docId},logLocation:i.LogLocation.Console,logLevel:i.LogLevel.Debug});const e=Date.now();d("Phase 2: Full document sync");try{await o.fullDocumentSync(a,u,n.lineageUrn,{asset:m.rootItem,snapshotContext:m.snapshot})}catch(e){throw d(),i.reportTelemetry({componentName:"rpcFremontEventQueue",componentAttributes:{extInfo:i.ReportType.DocumentSync,misc:"Failed sync of PIM data for document",lineageUrn:n.lineageUrn,wipVersionUrn:n.wipVersionUrn,documentId:n.docId},logLocation:i.LogLocation.Console,logLevel:i.LogLevel.Severe}),e}i.reportTelemetry({componentName:"rpcFremontEventQueue",componentAttributes:{extInfo:i.ReportType.DocumentSync,misc:"Finished sync of PIM data for document",lineageUrn:n.lineageUrn,wipVersionUrn:n.wipVersionUrn,documentId:n.docId,duration:Date.now()-e},logLocation:i.LogLocation.Console,logLevel:i.LogLevel.Debug})}else{if(d("Phase 1 bis: Could not get remote data, try locally"),m=await h.pimFindRootItemAndVersionSnapshot(u,n.wipVersionUrn),!m)throw d(),new Error(`No PIM data found for document versionUrn ${n.wipVersionUrn} / document id(${l}). Disabling PIM for this document`);y=h}if(d("Phase 3: Find snapshot in sychronized data"),void 0===await h.getSnapshot(m.snapshot.getId(),u))throw d(),new Error(`No local snapshot found with id ${m.snapshot.getId()} / document id(${l}). Disabling PIM for this document`);d("Phase 4: Validate schema version");const g=r.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0,{isCompatible:_,dataVersion:v}=await y.pimValidateSchemasVersion(u,n.lineageUrn,g);if(!_)throw d(),new Error(`PIM data schema version for document id(${l}) is ${v} which is incompatible with current sdk schema version: ${g}. Disabling PIM for this document`);return d(),{invariantId:l,snapshotId:m.snapshot.getId()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onOpenWritesDisabled=async function onOpenWritesDisabled(e,t,n){if(!n.wipVersionUrn)throw new Error("Missing version urn.");const{pimsdk:r,options:o}=t,{spaceCollectionId:i}=e,s=await r.pimFindRootItemAndVersionSnapshot(i,n.wipVersionUrn);if(!s)throw new Error("Could not find PIM data associated with "+n.wipVersionUrn);const a=await o.documentIdentityService.generateInvariantId(e,o,n.docId,n.lineageUrn);return console.log(`[DocumentOpened]: Found data for ${n.lineageUrn} ${n.wipVersionUrn}`),{invariantId:a,snapshotId:s.snapshot.getId()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(119),o=n(44),i=n(5),s=n(53),a=n(72),c=n(540),u=n(92);async function drawingPostSaveExecutor(e){if(!await c.validateCanUsePimForDocumentSave(e))throw new Error("[drawingSaved]: Cannot use PIM for the document");const t=await i.getOrCreateSdkInstance(e.context,e.options);return t?r.onDrawingPostSave(e.context,t,e.data):(console.log("[drawingSaved]: No SDKInstance found. Cannot handle event."),{})}t.drawingSavedHandler=async function drawingSavedHandler(e,t,n){const r=e.spaceCollectionId,i=await t.documentIdentityService.generateInvariantId(e,t,n.docId,n.lineageUrn);a.updateDocumentLastOperation("documentSaved",i,t.pimStateService,s.DocumentOperationState.SAVING);const c=o.queueFremontCommand(e,t,drawingPostSaveExecutor,{scId:r,data:n,context:e,options:t,lineageUrn:n.lineageUrn,docId:n.docId},{documentDisabledExecutor:drawingPostSaveExecutor});return u.invokeStateHandler("documentSaved",s.DocumentOperationState.SAVED,e,t,c,i).catch(e=>{console.log(`[documentSaved]: Failed while trying to update state for\n       document id: ${i}. Error - `,e)}),c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(252),o=n(8);t.drawingUploadedHandler=async function drawingUploadedHandler(e,t,n){return await r.queueDocumentUploaded(e,t,n,o.DOCUMENT_TYPE.Drawing)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),o=n(253);t.preDrawingUploadHandler=async function preDrawingUploadHandler(e,t,n){return await o.queuePreDocumentUpload(e,t,n,r.DOCUMENT_TYPE.Drawing)}},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(175)),i=n(5);t.featureFlagsDownloadedHandler=async function featureFlagsDownloadedHandler(e,t,n){const r={};for(const e in n.featureFlags)r[e]="false"!==n.featureFlags[e];t.pimStateService.getSpaceCollection(e.spaceCollectionId).setFeatureFlags(r),console.log("[featureFlagsDownloaded]: Received event"),console.info(`[featureFlagsDownloaded]: Feature flags on hub ${n.hubId} with tenant ${n.tenantId}: ${JSON.stringify(n.featureFlags)}`);try{let r;try{n.hubId&&n.tenantId&&(r=await o.getSpaceCollectionForHub(t,n.hubId,n.tenantId),r&&(e.spaceCollectionId=r))}catch(e){}return await i.getPIMSDK(e,t),t.documentIdentityService.clearCurrentState(),t.documentIdentityService.rehydrateState(e,t),console.info("Space collection id is : "+e.spaceCollectionId),{spaceCollectionId:e.spaceCollectionId,state:t.pimStateService.state()}}catch(e){return{state:e.message}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);t.hubSwitchedHandler=async function hubSwitchedHandler(e,t,n){const o={};return console.log("[hubSwitched]: Received event"),t&&r.getJournalService(e,t)?(console.log(`[hubSwitched]: Switching to hub ${n.hubId} with tenant ${n.tenantId}. Taking no further action.`),o):(console.error("[hubSwitched]: Journaling service is not defined. Cannot handle event."),o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(44),o=n(5),i=n(8),s=n(520);async function queueCreateMilestone(e,t,n){async function createMilestoneExecutor(e){const{data:t,context:n,options:r}=e,a=t.wipVersionUrn,c=n.spaceCollectionId,u=await o.getPIMSDK(n,r),l={create:!0,name:t.name,description:t.description?t.description.toString():""},d=await u.pimGetVersionSnapshot(c,a);let p;d?p=d.getId():console.log(`[createMilestone]: Cannot find snapshot for versionUrn ${a}.`);return await s.createMilestone(u,c,l,a,i.MILESTONE_SCOPES.ALL,p)}return r.queueFremontCommand(e,t,createMilestoneExecutor,{scId:e.spaceCollectionId,data:n,context:e,options:t,lineageUrn:n.lineageUrn,docId:n.docId?n.docId:"",hubFallbackMigrationTrigger:!0},{spaceCollectionDisabledExecutor:createMilestoneExecutor,documentDisabledExecutor:createMilestoneExecutor})}t.queueCreateMilestone=queueCreateMilestone,t.createMilestoneHandler=async function createMilestoneHandler(e,t,n){const o=await queueCreateMilestone(e,t,n),i=await r.awaitCommand(e,t,o);if("ERROR"==i.progress)throw new Error(i.error);return i.result}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.documentClosedHandler=async function documentClosedHandler(e,t,n){let r;console.log("[documentClosed]: Received event");try{r=await t.documentIdentityService.generateInvariantId(e,t,n.docId,n.lineageUrn)}catch(e){console.log("[documentClosed]: Caught error while trying to get invariant id")}return r?t.pimStateService.removeDocument(r):console.log("[documentClosed]: Missing invariant id. Unable to remove document from state model on document close."),{}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);t.documentDeletedHandler=async function documentDeletedHandler(e,t,n){const o={};return console.log("[documentDeleted]: Received event"),t&&r.getJournalService(e,t)?(console.log("[documentDeleted]: Journal based event handler has not been implemented yet."),o):(console.error("[documentDeleted]: Journaling service is not defined. Cannot handle event."),o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(44),o=n(91),i=n(5),s=n(174),a="documentFileUploaded";async function triggerMigrationOnFileUploaded(e){if(!e.lineageUrn)return{};const t=await i.getSpaceCollectionStateAppropriatePimSDK(e.context,e.options),n=await e.options.documentIdentityService.generateInvariantId(e.context,e.options,void 0,e.data.lineageUrn);n&&await e.options.pimStateService.disableDocument(n,e.context.spaceCollectionId,t,void 0,new Error("Migration was triggered after upload"));const r=e.options.applicationType&&[o.APPLICATION_TYPES.FDEV,o.APPLICATION_TYPES.DEV,o.APPLICATION_TYPES.STAGING].includes(e.options.applicationType),c=await s.triggerLineageMigration({bearerToken:e.options.bearerToken,baseServerUrl:e.options.migrationServerUrl,spaceCollection:e.context.spaceCollectionId,wipLineageUrn:null==e?void 0:e.lineageUrn,testing:e.context.testing,migrationContext:"documentFileUploaded",reason:`PIM data for WIP version ${e.data.versionUrn} can not be found in L2`,shouldMonitor:r});return console.log(`[${a}]: JobId for lineage migration is ${c}.`),{}}async function documentFileUploadedExecutor(e){const{context:t,options:n,data:r}=e,o=t.spaceCollectionId;if(console.log(`[${a}]: Received event`),!r.versionUrn)return{};const s=await i.getSpaceCollectionStateAppropriatePimSDK(t,n);if(!await s.pimFindRootItemAndVersionSnapshot(o,r.versionUrn)){if(!r.lineageUrn)return console.log(`[${a}]: No lineage Urn passed, cannot trigger migration`),{};console.log(`[${a}]: Can not find PIM data for ${r.versionUrn} - will attempt to trigger a partial migration`),await triggerMigrationOnFileUploaded(e)}return{}}t.documentFileUploadedExecutor=documentFileUploadedExecutor,t.documentFileUploadedHandler=async function documentFileUploadedHandler(e,t,n){return r.queueFremontCommand(e,t,documentFileUploadedExecutor,{context:e,options:t,data:n,docId:void 0,lineageUrn:n.lineageUrn},{spaceCollectionDisabledExecutor:triggerMigrationOnFileUploaded,documentDisabledExecutor:triggerMigrationOnFileUploaded})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(175),o=n(5);t.documentFullyOpenedHandler=async function documentFullyOpenedHandler(e,t,n){const i=await o.getPIMSDK(e,t),s={};return n.isTip||(s.snapshotId=await r.wipVersionToSnapshotManager.getVersionSnapshotIdForWipVersion(i,e.spaceCollectionId,n.wipVersionUrn)),console.log("[documentFullyOpened]: Event received."),t&&o.getJournalService(e,t)?(console.log("[documentFullyOpened]: Journal based event handler has not been implemented yet."),s):(console.error("[documentFullyOpened]: Journaling service is not defined. Cannot handle event."),s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(119),o=n(44),i=n(91),s=n(5),a=n(53),c=n(49),u=n(174),l=n(72),d=n(92),p="documentOpened";async function pimWritesDisabledDocumentOpenedExecutor(e){const{data:t,context:n,options:o}=e,a=o.pimStateService.getSpaceCollection(n.spaceCollectionId);if(!a.propertiesEnabled()||a.writesEnabled())return{};try{const e=await s.getOrCreateSdkInstance(n,o);return await r.onOpenWritesDisabled(n,e,t)}catch(r){console.log(`[${p}]: Error opening ${t.lineageUrn} - will attempt to trigger a partial migration`),c.reportTelemetry({componentName:p,componentAttributes:{extInfo:c.ReportType.HandlerCompletion,misc:"Error opening document: "+r.message,lineageUrn:t.lineageUrn,wipVersionUrn:t.wipVersionUrn},logLocation:c.LogLocation.All,logLevel:c.LogLevel.Info});const s=o.applicationType&&[i.APPLICATION_TYPES.FDEV,i.APPLICATION_TYPES.DEV,i.APPLICATION_TYPES.STAGING].includes(o.applicationType),a=await u.triggerLineageMigration({bearerToken:o.bearerToken,baseServerUrl:o.migrationServerUrl,spaceCollection:n.spaceCollectionId,wipLineageUrn:t.lineageUrn,testing:e.context.testing,migrationContext:"documentOpened",reason:`PIM data for WIP lineage ${t.lineageUrn} not found [Error is ${r.message}]`,shouldMonitor:s});throw console.log(`[${p}]: JobId for lineage migration is ${a}. Will now continue with error handling`),r}}async function documentOpenedExecutor(e){let t={};const{data:n,context:o,options:a}=e;try{if(console.log("[documentOpened]: Received event"),!a||!await s.getJournalService(o,a))return console.error("[documentOpened]: Journaling service is not defined. Cannot handle event."),t;const e=s.getSDKInstance(o,a);return t=await r.onOpen(o,e,n),console.log("[documentOpened] has finished for "+t.invariantId),t}catch(e){console.log(`[${p}]: Error opening document ${n.lineageUrn} - will attempt to trigger a lineage migration`),c.reportTelemetry({componentName:p,componentAttributes:{extInfo:c.ReportType.HandlerCompletion,misc:"Error opening document: "+e.message,lineageUrn:n.lineageUrn,wipVersionUrn:n.wipVersionUrn},logLocation:c.LogLocation.All,logLevel:c.LogLevel.Info});const t=a.applicationType&&[i.APPLICATION_TYPES.FDEV,i.APPLICATION_TYPES.DEV,i.APPLICATION_TYPES.STAGING].includes(a.applicationType),r=await u.triggerLineageMigration({bearerToken:a.bearerToken,baseServerUrl:a.migrationServerUrl,spaceCollection:o.spaceCollectionId,wipLineageUrn:n.lineageUrn,testing:o.testing,migrationContext:"documentOpened",reason:`PIM data for WIP lineage ${n.lineageUrn} not found [Error is ${e.message}]`,shouldMonitor:t});throw console.log(`[${p}]: JobId for lineage migration is ${r}. Will now continue with error handling`),e}}t.pimWritesDisabledDocumentOpenedExecutor=pimWritesDisabledDocumentOpenedExecutor,t.documentOpenedHandler=async function documentOpenedHandler(e,t,n){const r=e.spaceCollectionId,i=await t.documentIdentityService.generateInvariantId(e,t,n.docId,n.lineageUrn);if(l.updateDocumentLastOperation(p,i,t.pimStateService,a.DocumentOperationState.OPENING),!i)throw new Error("Missing invariant id.");const s=o.queueFremontCommand(e,t,documentOpenedExecutor,{scId:r,invariantId:i,data:n,context:e,options:t,lineageUrn:n.lineageUrn,docId:n.docId,hubFallbackMigrationTrigger:!0},{spaceCollectionDisabledExecutor:pimWritesDisabledDocumentOpenedExecutor,documentDisabledExecutor:pimWritesDisabledDocumentOpenedExecutor});return d.invokeStateHandler(p,a.DocumentOperationState.OPENED,e,t,s,i).catch(e=>{console.log(`[${p}]: Failed while trying to update state for\n       document id: ${i}. Error - `,e)}),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);t.preDocumentCloseHandler=async function preDocumentCloseHandler(e,t,n){const o={};return console.log("[preDocumentClose]: Received event"),t&&r.getJournalService(e,t)?(console.log("[preDocumentClose]: Journal based event handler has not been implemented yet."),o):(console.error("[preDocumentClose]: Journaling service is not defined. Cannot handle event."),o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);t.preDocumentDeleteHandler=async function preDocumentDeleteHandler(e,t,n){const o={};return console.log("[preDocumentDelete]: Received event"),t&&r.getJournalService(e,t)?(console.log("[preDocumentDelete]: Journal based event handler has not been implemented yet."),o):(console.error("[preDocumentDelete]: Journaling service is not defined. Cannot handle event."),o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);t.preDocumentSaveHandler=async function preDocumentSaveHandler(e,t,n){const o={};return console.log("[preDocumentSave]: Received event"),t&&r.getJournalService(e,t)?(console.log("[preDocumentSave]: Journal based event handler has not been implemented yet."),o):(console.error("[preDocumentSave]: Journaling service is not defined. Cannot handle event."),o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(12);t.fremontEventStub=function fremontEventStub(e){return async(t,n,o)=>(console.log(`[${e}]: Received event ${r.inspect(o)}`),{})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(8),i=n(5),s=n(56);t.createAssemblyRefHandler=async function createAssemblyRefHandler(e,t,n,r,o,a,c,u){const l=await i.getPIMSDK(e,t),d=await l.pimCreateAssemblyRef(await l.getSpaceCollection(e.spaceCollectionId),n,r,{fromModelSnapshot:a,toModelSnapshot:c,assemblyRef:{typeid:o,components:u,attributes:{name:{typeid:"String",value:"AssemblyRef"}}}});await d.assemblyRef.save();const p=s.getLegacyRepresentation(l,d.assemblyRef);return p.toAssetUrn=r,p.fromAssetUrn=n,p},t.batchCreateAssemblyRefs=async function batchCreateAssemblyRefs(e,t,n){const r=await i.getPIMSDK(e,t),a=e.spaceCollectionId,c=new Array(Math.ceil(n.length/20)).fill([]).map(()=>n.splice(0,20)),u=[];await Promise.all(c.map(async e=>{const t=r.getNewInstanceExperimental();t.beginBatch(),await Promise.all(e.map(async e=>{const n=await Promise.all([t.getAsset(e.fromUrn,a,{fetch:!1}),t.getAsset(e.toUrn,a,{fetch:!1})]),r=n[0].createPinnedRelationship(n[1],{toSnapshotId:e.toModelSnapshot,fromSnapshotId:e.fromModelSnapshot,typeId:e.typeId});o.populateEntity(r,e.assemblyRef),u.push(r)})),await t.endBatch().catch(e=>{throw new Error("Failed to create AssemblyRefs: "+e)})}));const l=[];return await Promise.all(u.map(async e=>{await e.fetch();const t=s.getLegacyRepresentation(r,e);t.toAssetUrn=e.toId,t.fromAssetUrn=e.fromId,l.push(t)})),l},t.readAssemblyRefHandler=async function readAssemblyRefHandler(e,t,n){const r=await i.getPIMSDK(e,t),o=await r.getRelationship(n,e.spaceCollectionId),a=s.getLegacyRepresentation(r,o);return a.toAssetUrn=o.toId,a.fromAssetUrn=o.fromId,a},t.findAssemblyRefsHandler=async function findAssemblyRefsHandler(e,t,n){console.log("Get relationships assetUrn="+n);const a=await i.getPIMSDK(e,t),c=await a.getAsset(n,e.spaceCollectionId),u=await o.getAllPages(await c.getRelationships({direction:r.RelationshipDirection.outgoing}),"getRelationships"),l=[];return await Promise.all(u.map(async e=>{if(o.getFamilyFromTypeid(e.getTypeId()).family===o.PIM_FAMILY.ASSEMBLY_REF){const t=s.getLegacyRepresentation(a,e);t.toAssetUrn=e.toId,t.fromAssetUrn=n,l.push(t)}})),l},t.deleteAssemblyRefHandler=async function deleteAssemblyRefHandler(e,t,n){const r=await i.getPIMSDK(e,t),o=await r.getRelationship(n,e.spaceCollectionId,{fetch:!1});return await o.delete()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),o=n(56),i=n(5);t.createAssetHandler=async function createAssetHandler(e,t,n,s,a,c){console.log(`Create asset of type ${s} productUrn=${n}`);const u=await i.getPIMSDK(e,t),l={name:{typeid:"String",value:a}};let d;switch(r.getFamilyFromTypeid(s).family){case r.PIM_FAMILY.DESIGN:d=await async function createDesignAsset(e,t,n,r,o,i,s,a){const c=e.spaceCollectionId;return(await n.pimCreateDesign(c,await n.getAsset(r,c,{fetch:!0}),{design:{components:s,attributes:a}})).design}(e,0,u,n,0,0,c,l);break;case r.PIM_FAMILY.MODEL:d=await async function createModelAsset(e,t,n,o,i,s,a,c){const u=await n.getAsset(o,e.spaceCollectionId);await u.fetch();const l=await u.getSpace(),d=(await r.getAllPages(l.getAssets(),"getAssets")).filter(e=>r.getFamilyFromTypeid(e.getTypeId()).family===r.PIM_FAMILY.DESIGN);if(!d||1!=d.length)throw new Error(`Could not find design asset for product ${o} in order to make model`);return(await n.pimCreateModel(e.spaceCollectionId,d[0],{model:{components:a,attributes:c}})).model}(e,0,u,n,0,0,c,l);break;default:d=await async function createGenericAsset(e,t,n,o,i,s,a,c){n.beginBatch();const u=await n.getAsset(o,e.spaceCollectionId,{fetch:!0}),l=await u.getSpace(),d=i,p=r.schemaTypes.Product_RelationshipContained_V2_0_0.typeid,h=l.createAsset(d),m=u.createRelationship(h,p);return r.populateEntity(h,{typeid:d,components:a,attributes:c}),r.populateEntity(m),await n.endBatch(),h}(e,0,u,n,s,0,c,l)}return o.getLegacyRepresentation(u,d)},t.getAssetHandler=async function getAssetHandler(e,t,n,r){console.log("Get asset assetUrn="+n);const s=await i.getPIMSDK(e,t);let a;if(r){const t=await s.getSnapshot(r,e.spaceCollectionId);a=await o.getAssetFromSnapshot(s,e.spaceCollectionId,n,t),await a.fetch()}else a=await s.getAsset(n,e.spaceCollectionId,{fetch:!0});return o.getLegacyRepresentation(s,a)},t.patchAssetHandler=async function patchAssetHandler(e,t,n,r,s){const a=await i.getPIMSDK(e,t);return await o.patchAsset(a,e.spaceCollectionId,n,r,s)},t.deleteAssetHandler=async function deleteAssetHandler(e,t,n){const r=await i.getPIMSDK(e,t),o=await r.getAsset(n,e.spaceCollectionId);return await o.delete()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0);n(8);const o=n(5),i=n(56),s=n(8);t.batchSaveHandler=async function batchSaveHandler(e,t,n){if(!n.rootProduct)throw new Error("Root product is missing during batch save");if(!n.rootProduct.product||!n.rootProduct.design||!n.rootProduct.model)throw new Error("Missing asset data for the root product");if(!n.lineageUrn)throw console.log("[BatchSave]: No lineage urn found when doing a batch save."),new Error("Missing lineage urn when doing a batch save");const a=await o.getPIMSDK(e,t),c=e.spaceCollectionId,u={},l=[{name:r.PermissionContextName.PIM_CONTEXT,type:r.PermissionContextType.WIP_URN,value:n.lineageUrn}];let d;d="true"===n.securityContext?await a.pimCreateProductStructure(c,n.rootProduct,l):await a.pimCreateProductStructure(c,n.rootProduct);const p={product:i.getLegacyRepresentation(a,d.product),design:i.getLegacyRepresentation(a,d.design),model:i.getLegacyRepresentation(a,d.model)},h=p.model.components.wipReference.value.targetComponent;h&&(u[h]=p.model.urn);const m=[];n.subcomponents&&await Promise.all(n.subcomponents.map(async e=>{if(!e.product||!e.design||!e.model)throw new Error("Missing asset data for subcomponent");const t=a.getNewInstanceExperimental();let r;r="true"===n.securityContext?await t.pimCreateChildProductStructure(c,d.product.getId(),e,l):await t.pimCreateChildProductStructure(c,d.product.getId(),e,void 0);const o={product:i.getLegacyRepresentation(t,r.product),design:i.getLegacyRepresentation(t,r.design),model:i.getLegacyRepresentation(t,r.model),relationship:i.getLegacyRepresentation(t,r.productProductContains)};m.push(o);const s=o.model.components.wipReference.value.targetComponent;s&&(u[s]=o.model.urn)}));const y=await a.pimCreateVersionSnapshot(c,d.product.getId(),{initStatus:s.PIMEntityInitStatus.Pending});return{rootProduct:p,subcomponents:m,assemblyRefs:[],snapshot:y.snapshot.getId()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),o=n(56),i=n(0);t.batchCreateProduct=async function batchCreateProduct(e,t,n){const s=await r.getPIMSDK(e,t),a=e.spaceCollectionId;let c;if("true"===n.securityContext){const e=[{name:i.PermissionContextName.PIM_CONTEXT,type:i.PermissionContextType.WIP_URN,value:n.lineageUrn?n.lineageUrn:""}];c=await s.pimCreateProductStructure(a,n,e)}else c=await s.pimCreateProductStructure(a,n);const u={product:o.getLegacyRepresentation(s,c.product),design:o.getLegacyRepresentation(s,c.design),model:o.getLegacyRepresentation(s,c.model)};if(n.rootProductUrn){const e=await s.pimCreateChildProductRelationship(a,n.rootProductUrn,c.product,n),t=o.getLegacyRepresentation(s,e.contains);t.fromAssetUrn=n.rootProductUrn,t.toAssetUrn=u.product.urn,u.relationship=t}return u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),o=n(8),i=n(0);t.getLatestReleaseDataHandler=async function getLatestReleaseDataHandler(e,t,n,s,a){const c=await r.getSpaceCollectionStateAppropriatePimSDK(e,t),u=await c.getSpaceCollection(e.spaceCollectionId),l=(await o.getAllPages(u.getAssets({filter:"attribute.wipLineageUrn=="+n}),"getAssets")).filter(e=>{const t=e.getComponent("wipReference");if(!t)return!1;const n=t.getValues();return!!n&&n.targetComponent===s});if(1!==l.length)throw new Error(`Found an unexpected number of model assets when getting release data: WIP Lineage ${n} Component ID ${s} Number of models ${l.length}`);const d=l[0],p={startAssets:[{asset:d}],maxDepth:1,relationshipFilters:[{type:{name:o.PIM_CONTAINS_RELATIONSHIP_TYPENAME},direction:"IN"}]},h=(await d.getSpace({fetch:!1,assumeTypeId:i.assetGraphTypeId})).getClosureV2Traverser(p),m=[];if(await h.traverse(p.startAssets,void 0,(e,t,n)=>{if(o.getFamilyFromTypeid(e.getTypeId()).family!==o.PIM_FAMILY.CONTAINS)return Promise.resolve(i.TraversalAction.AbortThis);const r=o.getFamilyFromTypeid(n.asset.getTypeId()).family,s=o.getFamilyFromTypeid(t.asset.getTypeId()).family;return r===o.PIM_FAMILY.MODEL&&s===o.PIM_FAMILY.DESIGN?(m.push(t.asset),Promise.resolve(i.TraversalAction.Abort)):Promise.resolve(i.TraversalAction.AbortThis)},{direction:"IN"}),1!==m.length)throw new Error(`Found an unexpected number of designs assets when getting release data: WIP Lineage ${n} Component ID ${s} Number of designs ${m.length}`);const y=m[0],g=await c.pimGetLatestReleaseData(e.spaceCollectionId,y.getId(),a),_={};return g.lifecycleAsset&&(_.lifecycleAsset=c.pimGetRepresentation(g.lifecycleAsset)),g.releaseAsset&&(_.releaseAsset=c.pimGetRepresentation(g.releaseAsset)),_}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDocumentStatus=async function getDocumentStatus(e,t,n){return t.pimStateService.getDocument(await t.documentIdentityService.generateInvariantId(e,t,n)||n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);t.getAuditInfo=async function getAuditInfo(e,t,n){const o=await r.getSpaceCollectionStateAppropriatePimSDK(e,t),i=e.spaceCollectionId,s=await o.pimFindRootItemAndVersionSnapshot(i,n);if(!s)throw new Error("No item and snapshot found");const a=await s.rootItem.fetch(!0),c=await s.snapshot.fetch(!0);return{assetAuditInfo:a.getCreatedBy(),snapshotAuditInfo:c.getCreatedBy()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5);t.getRootProductHandler=async function getRootProductHandler(e,t,n,o){const i=await r.getSpaceCollectionStateAppropriatePimSDK(e,t),s=await i.pimFindRootProduct(e.spaceCollectionId,n);if(!s)throw new Error("Could not find root product for "+n);return o&&await s.fetch(),i.pimGetRepresentation(s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),o=n(5),i=n(56);t.createItemHandler=async function createItemHandler(e,t,n,r,s){const a=await o.getPIMSDK(e,t),c=await a.pimCreateItem(e.spaceCollectionId,{item:{typeid:n,components:s,attributes:{name:{typeid:"String",value:r}}}}),u=i.getLegacyRepresentation(a,c.item);return console.log("Created Item urn "+u.urn),u},t.getItemHandler=async function getItemHandler(e,t,n,s){const a=await o.getPIMSDK(e,t),c=e.spaceCollectionId;let u,l;if(s){const e=await a.getSnapshot(s,c);l=await i.getAssetFromSnapshot(a,c,n,e),await l.fetch(),u=i.getLegacyRepresentation(a,l)}else l=await a.getAsset(n,c),u=i.getLegacyRepresentation(a,l);const d=Object.assign({},u),p=await l.getSpace(),h=await r.getAllPages(p.getAssets(),"getAssets");return d.links=await Promise.all(h.filter(e=>e.getId()!=n).map(async e=>({rel:r.getFamilyFromTypeid(e.getTypeId()).family,urn:e.getId()}))),d},t.patchItemHandler=async function patchItemHandler(e,t,n,r,s){const a=await o.getPIMSDK(e,t);return await i.patchAsset(a,e.spaceCollectionId,n,r,s)},t.deleteItemHandler=async function deleteItemHandler(e,t,n){const r=await o.getPIMSDK(e,t),i=await r.getAsset(n,e.spaceCollectionId);return await i.delete()},t.softDeleteHandler=async function softDeleteHandler(e,t,n,r){const i=await o.getPIMSDK(e,t),s=e.spaceCollectionId;r?await i.pimSoftDelete(await i.getSpaceCollection(s),await i.getAsset(n,s)):await i.pimRestore(await i.getSpaceCollection(s),await i.getAsset(n,s))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(21)),s=o(n(57)),a=r(n(1307)),c=/.*\[PIMTEST\] (TEST|EVENT) (\S*)\s{1,2}(?:id:(\S*))?\s{1,2}?(START|FINISH) (SUCCESS|FAILURE|NA) (.*)/;function getIdLabel(e){return e.eventName+":"+e.eventId}async function processLogFile(e,t,n,r){return new Promise(o=>{const u={},l=i.default.createReadStream(e),d=a.default.createInterface({input:l,crlfDelay:1/0});let p=!1;d.on("line",(async function(e){const n=e.match(c);if(n){const e=function processEvent(e){return{eventType:e[1],eventName:e[2],eventId:e[3],transition:e[4],result:e[5],date:Date.parse(e[6])}}(n);if("TEST"===e.eventType&&e.eventName===t&&"START"===e.transition)return void(p=!0);if("TEST"===e.eventType&&e.eventName===t&&"FINISH"===e.transition)return p=!1,void d.close();p&&"EVENT"===e.eventType&&(console.debug("Matched line from the log: "+n),u[getIdLabel(e)]?(u[getIdLabel(e)][e.transition]=e.date,u[getIdLabel(e)].result=e.result):u[getIdLabel(e)]={[e.transition]:e.date,result:e.result})}})),d.on("close",(async function(){const e={},i=new Set,a=[];Object.entries(u).forEach(t=>{a.push(new Promise(n=>{const r=function removeLabel(e){return e.split(":",1)[0]}(t[0]);i.add(r+":SUCCESS"),i.add(r+":FAILURE");const o=t[1],s=function getResultLabel(e,t){return e+":"+t.result}(r,o);if(o&&o.START&&o.FINISH){const t=o.FINISH-o.START;if(e[s]){e[s].numEvents+=1;const n=e[s].numEvents;e[s].runningAverage=e[s].runningAverage*(n-1)/n+t/n}else e[s]={runningAverage:t,numEvents:1}}n()}))}),await Promise.all(a);const c={FusionPIMPerformance:{[t]:e}};let l="SELECT ";for(const e of i)l+=`average(\`FusionPIMPerformance.${t}.${e}.runningAverage\`) as '${e}', `;l=l.substring(0,l.length-2),l+=" FROM Log TIMESERIES 1 day SINCE 7 days ago";const d=s.request(n,{method:"POST",headers:{"X-License-Key":r,"Content-Type":"application/json"}},e=>{console.log(e)});d.write(JSON.stringify(c)),d.end(),o(l)}))})}t.processLogFile=processLogFile,t.performanceTestHandler=async function performanceTestHandler(e,t,n,r,o,i){return{query:await processLogFile(n,r,o,i)}}},function(e,t){e.exports=require("readline")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(551),o=n(0),i=n(8),s=n(5),a=n(56);t.createRelationshipHandler=async function createRelationshipHandler(e,t,n,r,o,i,c){console.log(`Create relationship of type ${o} from=${n}, to=${r}`);const u=await s.getPIMSDK(e,t),l=await u.pimCreateChildProductRelationship(e.spaceCollectionId,n,r,{productProductContains:{typeid:o,components:c,attributes:{name:{typeid:"String",value:i}}}});return a.getLegacyRepresentation(u,l.contains)},t.getRelationshipHandler=async function getRelationshipHandler(e,t,n){console.log("Get relationship relationshipUrn="+n);const r=await s.getPIMSDK(e,t),o=await r.getRelationship(n,e.spaceCollectionId);return a.getLegacyRepresentation(r,o)},t.getRelationshipsHandler=async function getRelationshipsHandler(e,t,n,r){console.log("Get relationships assetUrn="+n);const c=await s.getPIMSDK(e,t),u=await c.getAsset(n,e.spaceCollectionId,{fetch:!0}),l=await i.getAllPages(await u.getRelationships({direction:o.RelationshipDirection.outgoing}),"getRelationships"),d=[];return await Promise.all(l.map(async e=>{const t=await e.getTo({fetch:!0});if(t&&(!r||i.isCompatibleWith(r,t.getTypeId()))){const r=a.getLegacyRepresentation(c,e);r.toAssetUrn=t.getId(),r.fromAssetUrn=n,d.push(r)}})),d},t.patchRelationshipHandler=async function patchRelationshipHandler(e,t,n,o,c){const u=await s.getPIMSDK(e,t),l=await u.getRelationship(n,e.spaceCollectionId),d=a.getLegacyRepresentation(u,l);r.applyPatch(d,o,!0);const p=Object.keys(d.components);for(const e of p)i.setComponent(l,e,d.components[e]);return c&&await l.save(),d},t.deleteRelationshipHandler=async function deleteRelationshipHandler(e,t,n){const r=await s.getPIMSDK(e,t),o=await r.getRelationship(n,e.spaceCollectionId);return await o.delete()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),o=n(175),i=n(8);t.snapshotHandler=async function snapshotHandler(e,t,n){const o=await r.getPIMSDK(e,t);return{urn:(await o.pimCreateVersionSnapshot(e.spaceCollectionId,n,{initStatus:i.PIMEntityInitStatus.Pending})).snapshot.getId()}},t.getVersionSnapshotIdHandler=async function getVersionSnapshotIdHandler(e,t,n){const i=await r.getSpaceCollectionStateAppropriatePimSDK(e,t);return{id:await o.wipVersionToSnapshotManager.getVersionSnapshotIdForWipVersion(i,e.spaceCollectionId,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(517),i=n(8);t.createRepoHandler=async function createRepoHandler(e,t){const n=Object.assign({server:t.serverUrl,getBearerToken:async()=>t.bearerToken},i.DEFAULT_JOURNALING_CONFIGURATION),s=new o.NoJournalingSDK(n),a={serverUrl:t.serverUrl,getToken:async()=>t.bearerToken,journalSDK:s,schemasVersion:i.PIM_SCHEMAS_VERSIONS.VERSION_1_0_0},c=await r.FDModelingSDK.initializeWithPIM(a),u=await c.pimCreateFullAccessSpaceCollection();return await u.save(),{spaceCollectionId:u.getId()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(551),o=n(8);function getLegacyRepresentation(e,t){const n=e.pimGetRepresentation(t),r=Object.assign(Object.assign({},n),{urn:n.id});return n.attributes&&n.attributes.name&&(r.name=n.attributes.name.value),delete r.revisionId,delete r.id,r}t.getLegacyRepresentation=getLegacyRepresentation,t.getAssetFromSnapshot=async function getAssetFromSnapshot(e,t,n,r){const i=(await o.getAllPages(r.getAssets(),"getAssets")).filter(e=>e.getId()===n);if(0===i.length)throw new Error(`Asset ${n} is missing on the snapshot`);if(i.length>1)throw new Error(`Asset ${n} appears more than once in snapshot; cannot determine which is the desired asset`);return i[0]},t.patchAsset=async function patchAsset(e,t,n,i,s){const a=await e.getAsset(n,t),c=getLegacyRepresentation(e,a);let u=Object.keys(c.attributes);const l=[],d={};i.forEach(e=>{if(e.path.startsWith("/attributes/")){const t=e.path.split("/"),n=t[2],r=t[3];if(u.includes(n))l.push(e);else{d[n]||(d[n]={typeid:"",value:void 0});const t=e.value;"typeid"===r?d[n].typeid=String(t):d[n].value=t}}else l.push(e)}),r.applyPatch(c,l,!0);const p=Object.keys(c.components);for(const e of p)o.setComponent(a,e,c.components[e]);Object.assign(c.attributes,d),u=Object.keys(c.attributes);for(const e of u)o.setEntityAttribute(a,e,c.attributes[e].value,c.attributes[e].typeid);return s&&await a.save(),c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(522);t.getVersionInfoHandler=async function getVersionInfoHandler(){return r.ADSK_PACKAGE_INFO}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),o=n(5);async function _getEntityAttributeHandlerImpl(e,t,n,i,s){if(s===r.PIM_ENTITY_INIT_STATUS_KEY){const r=await o.getCachedEntityInitStatus(e,t,n);if(r)return{value:r}}const a=await o.getPIMSDK(e,t),c=e.spaceCollectionId;let u=void 0;switch(i){case r.EntityTypes.SNAPSHOT:u=await a.getSnapshot(n,c);break;case r.EntityTypes.RELATIONSHIP:u=await a.getRelationship(n,c);break;case r.EntityTypes.ASSET:u=await a.getAsset(n,c);break;default:throw new Error("Entity type ["+i+"] not supported!")}let l=u.getAttribute(s);if("string"!=typeof l)throw new Error("Entity attribute value ["+l+"] for name ["+s+"] is not of type string: ["+l+"]!");return l||(l=""),Promise.resolve({attributeValue:l})}t.getEntityInitStatusHandler=async function getEntityInitStatusHandler(e,t,n,o){return await _getEntityAttributeHandlerImpl(e,t,n,o,r.PIM_ENTITY_INIT_STATUS_KEY)},t.getEntityAttributeHandler=async function getEntityAttributeHandler(e,t,n,r,o){return await _getEntityAttributeHandlerImpl(e,t,n,r,o)},t.setEntityAttributeHandler=async function setEntityAttributeHandler(e,t,n,i,s,a){const c=await o.getPIMSDK(e,t),u=e.spaceCollectionId;let l=void 0;switch(i){case r.EntityTypes.SNAPSHOT:l=await c.getSnapshot(n,u);break;case r.EntityTypes.RELATIONSHIP:l=await c.getRelationship(n,u);break;case r.EntityTypes.ASSET:l=await c.getAsset(n,u);break;default:throw new Error("Entity type ["+i+"] not supported!")}r.setEntityAttribute(l,s,a),await l.save(),s===r.PIM_ENTITY_INIT_STATUS_KEY&&await o.setCachedEntityInitStatus(e,t,n,a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(5),i=n(8);async function getParentRelationship(e){let t=void 0;if(!e)return console.error("[reconcileCache]: Source asset cannot be empty when trying to find parent relationship."),t;const n=e.getRelationships({direction:r.RelationshipDirection.incoming});await n.nextPage();const o=n.getPage();if(!o)return console.error("[reconcileCache]: Failed when querying for parent relationships. AssetId: "+e.getId()),t;const i=o.getRelationships();return i.length>0?t=i[0]:console.log("[reconcileCache]: Root Product asset found. Root product asset id:"+e.getId()),t}t.reconcileCacheHandler=async function reconcileCacheHandler(e,t,n){const s=await o.getPIMSDK(e,t),a=await s.getSpaceCollection(e.spaceCollectionId),c=await async function getModelAsset(e,t){let n=[];if(!e)return console.log("[reconcileCache: Cannot query for model asset with empty space collection id."),n;if(!t)return console.log("[reconcileCache]: Cannot query for model asset with empty lineage urn."),n;const r=e.getAssets({filter:{"attribute.wipLineageUrn":t}});await r.nextPage();const o=r.getPage();return o&&(n=o.getAssets()),n}(a,n);if(0==c.length)return console.log("[reconcileCache]: No matching model assets found. Cannot reconcile cache."),{};const u=c[0],l=await async function findRootProduct(e){if(!e)return console.log("[reconcileCache]: Model asset cannot be empty when trying to find root product asset."),e;let t,n=e;do{t=await getParentRelationship(n),t&&(n=await t.getFrom())}while(void 0!==t&&n);return n}(u);return l?(await async function getAssetSubgraph(e){if(!e)return void console.log("[reconcileCache]: Asset cannot be empty when trying to get subgraph.");const t={startAssets:[{asset:e}],relationshipFilters:[{type:{name:i.PIM_CONTAINS_RELATIONSHIP_TYPENAME},direction:"OUT"}],maxDepth:0},n=(await e.getSpace({fetch:!1,assumeTypeId:r.assetGraphTypeId})).getClosureV2Traverser(t);await n.traverse(t.startAssets,async()=>r.TraversalAction.Continue)}(l),{lineageUrn:n}):(console.log("[reconcileCache]: Model asset cannot be empty when trying to get root product asset."),{})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),o=n(8);t.assignItemNumber=async function assignItemNumber(e,t,n){const i=await r.getPIMSDK(e,t),s=e.spaceCollectionId,a=new o.GenerateItemNumberCommandDefinition(n);return await i.pimExecuteCommand(s,a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),o=n(8);t.quickRelease=async function quickRelease(e,t,n){const i=await r.getPIMSDK(e,t),s=e.spaceCollectionId,a=new o.QuickReleaseCommandDefinition(n);return await i.pimExecuteCommand(s,a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setProxyHandler=async function setProxyHandler(e,t,n){return n.host&&n.host.length>0?(console.log(`Setting proxy settings to host ${n.host}:${n.port}`),n.sslUsePeerVerify?delete process.env.NODE_TLS_REJECT_UNAUTHORIZED:process.env.NODE_TLS_REJECT_UNAUTHORIZED="0",process.env.https_proxy=process.env.http_proxy=`http://${n.proxyUser?n.proxyUser+":"+(n.proxyPassword||"")+"@":""}${n.host}:${n.port}`):(console.log("Disabling proxy"),delete process.env.NODE_TLS_REJECT_UNAUTHORIZED,delete process.env.https_proxy,delete process.env.http_proxy),{}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),o=n(8);t.getAssemblyPIMDataHandler=async function getAssemblyPIMDataHandler(e,t,n,i){const s=await r.getSpaceCollectionStateAppropriatePimSDK(e,t),a=e.spaceCollectionId,c=await s.pimFindRootItemAndVersionSnapshot(a,n);if(!c)throw new Error("No item and snapshot found");const u=await s.pimGetAssemblyAssetData(a,c.rootItem,c.snapshot,i);return await o.stringifyRelatedAssets(s,u)}},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(543)),i=n(174),s=o.object({migrationType:o.string().only().allow(i.MigrationType.HUB,i.MigrationType.LINEAGE).required(),WIPUrn:o.string().required(),priority:o.string().only().allow("HIGH","MEDIUM","LOW").optional(),maxLastModifiedDays:o.number().optional(),includeAllTimeData:o.boolean().optional()});t.triggerMigration=async function triggerMigration(e,t,n){const{error:r,value:o}=s.validate(n,{convert:!0});if(r)throw new Error("[triggerMigration] Invalid parameters when trying to request migration: "+r);const a=Object.assign({},o);return a.migrationContext="triggerMigrationHandler",{jobId:await i.triggerMigrationJob(t.migrationServerUrl,t.bearerToken,e.spaceCollectionId,a)}}},function(e,t,n){"use strict";const r={arrayType:Symbol("array"),bufferType:Symbol("buffer"),dateType:Symbol("date"),errorType:Symbol("error"),genericType:Symbol("generic"),mapType:Symbol("map"),regexType:Symbol("regex"),setType:Symbol("set"),weakMapType:Symbol("weak-map"),weakSetType:Symbol("weak-set"),mismatched:Symbol("mismatched")};r.typeMap={"[object Array]":r.arrayType,"[object Date]":r.dateType,"[object Error]":r.errorType,"[object Map]":r.mapType,"[object RegExp]":r.regexType,"[object Set]":r.setType,"[object WeakMap]":r.weakMapType,"[object WeakSet]":r.weakSetType},r.SeenEntry=class{constructor(e,t){this.obj=e,this.ref=t}isSame(e,t){return this.obj===e&&this.ref===t}},r.getInternalType=function(e){const{typeMap:t,bufferType:n,genericType:o}=r;if(e instanceof Buffer)return n;return t[Object.prototype.toString.call(e)]||o},r.getSharedType=function(e,t,n){if(n)return Object.getPrototypeOf(e)!==Object.getPrototypeOf(t)?r.mismatched:r.getInternalType(e);const o=r.getInternalType(e);return o!==r.getInternalType(t)?r.mismatched:o},r.valueOf=function(e){const t=e.valueOf;if(void 0===t)return e;try{return t.call(e)}catch(e){return e}},r.hasOwnEnumerableProperty=function(e,t){return Object.prototype.propertyIsEnumerable.call(e,t)},r.isSetSimpleEqual=function(e,t){for(const n of e)if(!t.has(n))return!1;return!0},r.isDeepEqualObj=function(e,t,n,o,i){const{isDeepEqual:s,valueOf:a,hasOwnEnumerableProperty:c}=r,{keys:u,getOwnPropertySymbols:l}=Object;if(e===r.arrayType){if(!o.part){if(t.length!==n.length)return!1;for(let e=0;e<t.length;++e)if(!s(t[e],n[e],o,i))return!1;return!0}for(let e=0;e<t.length;++e){const r=t[e];for(let e=0;e<n.length;++e)if(s(r,n[e],o,i))return!0}}else if(e===r.setType){if(t.size!==n.size)return!1;if(!r.isSetSimpleEqual(t,n)){const e=new Set(n);for(const n of t){if(e.delete(n))continue;let t=!1;for(const r of e)if(s(n,r,o,i)){e.delete(r),t=!0;break}if(!t)return!1}}}else if(e===r.mapType){if(t.size!==n.size)return!1;for(const[e,r]of t){if(void 0===r&&!n.has(e))return!1;if(!s(r,n.get(e),o,i))return!1}}else if(e===r.errorType&&(t.name!==n.name||t.message!==n.message))return!1;const d=a(t),p=a(n);if((t!==d||n!==p)&&!s(d,p,o,i))return!1;const h=u(t);if(!o.part&&h.length!==u(n).length)return!1;for(let e=0;e<h.length;++e){const r=h[e];if(!c(n,r))return!1;if(!s(t[r],n[r],o,i))return!1}if(o.symbols){const e=l(t),r=new Set(l(n));for(let a=0;a<e.length;++a){const u=e[a];if(c(t,u)){if(!c(n,u))return!1;if(!s(t[u],n[u],o,i))return!1}else if(c(n,u))return!1;r.delete(u)}for(const e of r)if(c(n,e))return!1}return!0},r.isDeepEqual=function(e,t,n,o){if(e===t)return 0!==e||1/e==1/t;const i=typeof e;if(i!==typeof t)return!1;if("object"!==i||null===e||null===t)return e!=e&&t!=t;const s=r.getSharedType(e,t,!!n.prototype);switch(s){case r.bufferType:return Buffer.prototype.equals.call(e,t);case r.regexType:return e.toString()===t.toString();case r.mismatched:return!1}for(let n=o.length-1;n>=0;--n)if(o[n].isSame(e,t))return!0;o.push(new r.SeenEntry(e,t));try{return!!r.isDeepEqualObj(s,e,t,n,o)}finally{o.pop()}},e.exports=function(e,t,n){return n=n||{prototype:!0},!!r.isDeepEqual(e,t,n,[])}},function(e,t,n){"use strict";const r={};t.escapeHtml=function(e){if(!e)return"";let t="";for(let n=0;n<e.length;++n){const o=e.charCodeAt(n);r.isSafe(o)?t+=e[n]:t+=r.escapeHtmlChar(o)}return t},t.escapeJson=function(e){if(!e)return"";let t;return e.replace(/[<>&\u2028\u2029]/g,e=>(t=e.charCodeAt(0),60===t?"\\u003c":62===t?"\\u003e":38===t?"\\u0026":8232===t?"\\u2028":"\\u2029"))},r.escapeHtmlChar=function(e){const t=r.namedHtml[e];if(void 0!==t)return t;if(e>=256)return"&#"+e+";";return`&#x${Buffer.from(String.fromCharCode(e),"ascii").toString("hex")};`},r.isSafe=function(e){return void 0!==r.safeCharCodes[e]},r.namedHtml={38:"&amp;",60:"&lt;",62:"&gt;",34:"&quot;",160:"&nbsp;",162:"&cent;",163:"&pound;",164:"&curren;",169:"&copy;",174:"&reg;"},r.safeCharCodes=function(){const e={};for(let t=32;t<123;++t)(t>=97||t>=65&&t<=90||t>=48&&t<=57||32===t||46===t||44===t||45===t||58===t||95===t)&&(e[t]=null);return e}()},function(e,t,n){"use strict";t.errors={root:"value",key:'"{{!label}}" ',messages:{wrapArrays:!0},any:{unknown:"is not allowed",invalid:"contains an invalid value",empty:"is not allowed to be empty",required:"is required",allowOnly:"must be one of {{valids}}",default:"threw an error when running default method"},alternatives:{base:"not matching any of the allowed alternatives",child:null},array:{base:"must be an array",includes:"at position {{pos}} does not match any of the allowed types",includesSingle:'single value of "{{!label}}" does not match any of the allowed types',includesOne:"at position {{pos}} fails because {{reason}}",includesOneSingle:'single value of "{{!label}}" fails because {{reason}}',includesRequiredUnknowns:"does not contain {{unknownMisses}} required value(s)",includesRequiredKnowns:"does not contain {{knownMisses}}",includesRequiredBoth:"does not contain {{knownMisses}} and {{unknownMisses}} other required value(s)",excludes:"at position {{pos}} contains an excluded value",excludesSingle:'single value of "{{!label}}" contains an excluded value',hasKnown:'does not contain at least one required match for type "{{!patternLabel}}"',hasUnknown:"does not contain at least one required match",min:"must contain at least {{limit}} items",max:"must contain less than or equal to {{limit}} items",length:"must contain {{limit}} items",ordered:"at position {{pos}} fails because {{reason}}",orderedLength:"at position {{pos}} fails because array must contain at most {{limit}} items",ref:'references "{{ref}}" which is not a positive integer',sparse:"must not be a sparse array",unique:"position {{pos}} contains a duplicate value"},boolean:{base:"must be a boolean"},binary:{base:"must be a buffer or a string",min:"must be at least {{limit}} bytes",max:"must be less than or equal to {{limit}} bytes",length:"must be {{limit}} bytes"},date:{base:"must be a number of milliseconds or valid date string",strict:"must be a valid date",min:'must be larger than or equal to "{{limit}}"',max:'must be less than or equal to "{{limit}}"',less:'must be less than "{{limit}}"',greater:'must be greater than "{{limit}}"',isoDate:"must be a valid ISO 8601 date",timestamp:{javascript:"must be a valid timestamp or number of milliseconds",unix:"must be a valid timestamp or number of seconds"},ref:'references "{{ref}}" which is not a date'},function:{base:"must be a Function",arity:"must have an arity of {{n}}",minArity:"must have an arity greater or equal to {{n}}",maxArity:"must have an arity lesser or equal to {{n}}",ref:"must be a Joi reference",class:"must be a class"},lazy:{base:"!!schema error: lazy schema must be set",schema:"!!schema error: lazy schema function must return a schema"},object:{base:"must be an object",child:'!!child "{{!child}}" fails because {{reason}}',min:"must have at least {{limit}} children",max:"must have less than or equal to {{limit}} children",length:"must have {{limit}} children",allowUnknown:'!!"{{!child}}" is not allowed',with:'!!"{{mainWithLabel}}" missing required peer "{{peerWithLabel}}"',without:'!!"{{mainWithLabel}}" conflict with forbidden peer "{{peerWithLabel}}"',missing:"must contain at least one of {{peersWithLabels}}",xor:"contains a conflict between exclusive peers {{peersWithLabels}}",oxor:"contains a conflict between optional exclusive peers {{peersWithLabels}}",and:"contains {{presentWithLabels}} without its required peers {{missingWithLabels}}",nand:'!!"{{mainWithLabel}}" must not exist simultaneously with {{peersWithLabels}}',assert:'!!"{{ref}}" validation failed because "{{ref}}" failed to {{message}}',rename:{multiple:'cannot rename child "{{from}}" because multiple renames are disabled and another key was already renamed to "{{to}}"',override:'cannot rename child "{{from}}" because override is disabled and target "{{to}}" exists',regex:{multiple:'cannot rename children {{from}} because multiple renames are disabled and another key was already renamed to "{{to}}"',override:'cannot rename children {{from}} because override is disabled and target "{{to}}" exists'}},type:'must be an instance of "{{type}}"',schema:"must be a Joi instance"},number:{base:"must be a number",unsafe:"must be a safe number",min:"must be larger than or equal to {{limit}}",max:"must be less than or equal to {{limit}}",less:"must be less than {{limit}}",greater:"must be greater than {{limit}}",integer:"must be an integer",negative:"must be a negative number",positive:"must be a positive number",precision:"must have no more than {{limit}} decimal places",ref:'references "{{ref}}" which is not a number',multiple:"must be a multiple of {{multiple}}",port:"must be a valid port"},string:{base:"must be a string",min:"length must be at least {{limit}} characters long",max:"length must be less than or equal to {{limit}} characters long",length:"length must be {{limit}} characters long",alphanum:"must only contain alpha-numeric characters",token:"must only contain alpha-numeric and underscore characters",regex:{base:'with value "{{!value}}" fails to match the required pattern: {{pattern}}',name:'with value "{{!value}}" fails to match the {{name}} pattern',invert:{base:'with value "{{!value}}" matches the inverted pattern: {{pattern}}',name:'with value "{{!value}}" matches the inverted {{name}} pattern'}},email:"must be a valid email",uri:"must be a valid uri",uriRelativeOnly:"must be a valid relative uri",uriCustomScheme:"must be a valid uri with a scheme matching the {{scheme}} pattern",isoDate:"must be a valid ISO 8601 date",guid:"must be a valid GUID",hex:"must only contain hexadecimal characters",hexAlign:"hex decoded representation must be byte aligned",base64:"must be a valid base64 string",dataUri:"must be a valid dataUri string",hostname:"must be a valid hostname",normalize:"must be unicode normalized in the {{form}} form",lowercase:"must only contain lowercase characters",uppercase:"must only contain uppercase characters",trim:"must not have leading or trailing whitespace",creditCard:"must be a credit card",ref:'references "{{ref}}" which is not a number',ip:"must be a valid ip address with a {{cidr}} CIDR",ipVersion:"must be a valid ip address of one of the following versions {{version}} with a {{cidr}} CIDR"},symbol:{base:"must be a symbol",map:"must be one of {{map}}"}}},function(e,t,n){"use strict";const r=n(543);t.options=r.object({abortEarly:r.boolean(),convert:r.boolean(),allowUnknown:r.boolean(),skipFunctions:r.boolean(),stripUnknown:[r.boolean(),r.object({arrays:r.boolean(),objects:r.boolean()}).or("arrays","objects")],language:r.object(),presence:r.string().only("required","optional","forbidden","ignore"),raw:r.boolean(),context:r.object(),strip:r.boolean(),noDefaults:r.boolean(),escapeHtml:r.boolean()}).strict()},function(e,t,n){"use strict";const r=n(45),o=n(20),i={};i.Lazy=class extends r{constructor(){super(),this._type="lazy",this._flags.once=!0,this._cache=null}_init(e,t){return this.set(e,t)}_base(e,t,n){let o;if(this._cache)o=this._cache;else{const i={value:e},s=this._flags.lazy;if(!s)return i.errors=this.createError("lazy.base",null,t,n),i;if(o=s(),!(o instanceof r))return i.errors=this.createError("lazy.schema",{schema:o},t,n),i;this._flags.once&&(this._cache=o)}return o._validate(e,t,n)}set(e,t){if(o.assert("function"==typeof e,"You must provide a function as first argument"),o.assert(void 0===t||t&&"object"==typeof t&&!Array.isArray(t),"Options must be an object"),t){const e=Object.keys(t).filter(e=>!["once"].includes(e));o.assert(0===e.length,"Options contain unknown keys: "+e),o.assert(void 0===t.once||"boolean"==typeof t.once,'Option "once" must be a boolean')}const n=this.clone();return n._flags.lazy=e,t&&t.once!==n._flags.once&&(n._flags.once=t.once),n}},e.exports=new i.Lazy},function(e,t,n){"use strict";const r=n(20),o=n(45),i=n(120),s=n(50),a=n(255),c={fastSplice:function(e,t){let n=t;for(;n<e.length;)e[n++]=e[n];--e.length}};c.Array=class extends o{constructor(){super(),this._type="array",this._inner.items=[],this._inner.ordereds=[],this._inner.inclusions=[],this._inner.exclusions=[],this._inner.requireds=[],this._flags.sparse=!1}_base(e,t,n){const r={value:e};"string"==typeof e&&n.convert&&c.safeParse(e,r);let o=Array.isArray(r.value);const i=o;if(n.convert&&this._flags.single&&!o&&(r.value=[r.value],o=!0),!o)return r.errors=this.createError("array.base",null,t,n),r;if((this._inner.inclusions.length||this._inner.exclusions.length||this._inner.requireds.length||this._inner.ordereds.length||!this._flags.sparse)&&(i&&(r.value=r.value.slice(0)),r.errors=this._checkItems(r.value,i,t,n),r.errors&&i&&n.convert&&this._flags.single)){const e=r.errors;r.value=[r.value],r.errors=this._checkItems(r.value,i,t,n),r.errors&&(r.errors=e,r.value=r.value[0])}return r}_checkItems(e,t,n,r){const o=[];let i;const s=this._inner.requireds.slice(),u=this._inner.ordereds.slice(),l=[...this._inner.inclusions,...s];let d=e.length;for(let p=0;p<d;++p){i=!1;const h=e[p];let m=!1;const y=t?p:n.key,g=t?[...n.path,p]:n.path,_=new a(y,g,n.parent,n.reference);let v;if(!this._flags.sparse&&void 0===h){if(o.push(this.createError("array.sparse",null,{key:n.key,path:_.path,pos:p},r)),r.abortEarly)return o;u.shift();continue}for(let e=0;e<this._inner.exclusions.length;++e)if(v=this._inner.exclusions[e]._validate(h,_,{}),!v.errors){if(o.push(this.createError(t?"array.excludes":"array.excludesSingle",{pos:p,value:h},{key:n.key,path:_.path},r)),i=!0,r.abortEarly)return o;u.shift();break}if(i)continue;if(this._inner.ordereds.length){if(u.length>0){const t=u.shift();if(v=t._validate(h,_,r),v.errors){if(o.push(this.createError("array.ordered",{pos:p,reason:v.errors,value:h},{key:n.key,path:_.path},r)),r.abortEarly)return o}else if(t._flags.strip)c.fastSplice(e,p),--p,--d;else{if(!this._flags.sparse&&void 0===v.value){if(o.push(this.createError("array.sparse",null,{key:n.key,path:_.path,pos:p},r)),r.abortEarly)return o;continue}e[p]=v.value}continue}if(!this._inner.items.length){if(o.push(this.createError("array.orderedLength",{pos:p,limit:this._inner.ordereds.length},{key:n.key,path:_.path},r)),r.abortEarly)return o;continue}}const E=[];let I=s.length;for(let t=0;t<I;++t)if(v=E[t]=s[t]._validate(h,_,r),!v.errors){if(e[p]=v.value,m=!0,c.fastSplice(s,t),--t,--I,!this._flags.sparse&&void 0===v.value&&(o.push(this.createError("array.sparse",null,{key:n.key,path:_.path,pos:p},r)),r.abortEarly))return o;break}if(m)continue;const b=r.stripUnknown&&!!r.stripUnknown.arrays||!1;I=l.length;for(let a=0;a<I;++a){const u=l[a],y=s.indexOf(u);if(-1!==y)v=E[y];else if(v=u._validate(h,_,r),!v.errors){u._flags.strip?(c.fastSplice(e,p),--p,--d):this._flags.sparse||void 0!==v.value?e[p]=v.value:(o.push(this.createError("array.sparse",null,{key:n.key,path:_.path,pos:p},r)),i=!0),m=!0;break}if(1===I){if(b){c.fastSplice(e,p),--p,--d,m=!0;break}if(o.push(this.createError(t?"array.includesOne":"array.includesOneSingle",{pos:p,reason:v.errors,value:h},{key:n.key,path:_.path},r)),i=!0,r.abortEarly)return o;break}}if(!i&&(this._inner.inclusions.length&&!m)){if(b){c.fastSplice(e,p),--p,--d;continue}if(o.push(this.createError(t?"array.includes":"array.includesSingle",{pos:p,value:h},{key:n.key,path:_.path},r)),r.abortEarly)return o}}return s.length&&this._fillMissedErrors(o,s,n,r),u.length&&this._fillOrderedErrors(o,u,n,r),o.length?o:null}describe(){const e=super.describe();if(this._inner.ordereds.length){e.orderedItems=[];for(let t=0;t<this._inner.ordereds.length;++t)e.orderedItems.push(this._inner.ordereds[t].describe())}if(this._inner.items.length){e.items=[];for(let t=0;t<this._inner.items.length;++t)e.items.push(this._inner.items[t].describe())}if(e.rules)for(let t=0;t<e.rules.length;++t){const n=e.rules[t];"has"===n.name&&(n.arg=n.arg.describe())}return e}items(...e){const t=this.clone();return r.flatten(e).forEach((e,n)=>{try{e=i.schema(this._currentJoi,e)}catch(e){throw e.hasOwnProperty("path")?e.path=n+"."+e.path:e.path=n,e.message=`${e.message}(${e.path})`,e}t._inner.items.push(e),"required"===e._flags.presence?t._inner.requireds.push(e):"forbidden"===e._flags.presence?t._inner.exclusions.push(e.optional()):t._inner.inclusions.push(e)}),t}ordered(...e){const t=this.clone();return r.flatten(e).forEach((e,n)=>{try{e=i.schema(this._currentJoi,e)}catch(e){throw e.hasOwnProperty("path")?e.path=n+"."+e.path:e.path=n,e.message=`${e.message}(${e.path})`,e}t._inner.ordereds.push(e)}),t}min(e){const t=s.isRef(e);return r.assert(Number.isSafeInteger(e)&&e>=0||t,"limit must be a positive integer or reference"),this._testUnique("min",e,(function(n,r,o){let i;if(t){if(i=e(r.reference||r.parent,o),!(Number.isSafeInteger(i)&&i>=0))return this.createError("array.ref",{ref:e,value:i},r,o)}else i=e;return n.length>=i?n:this.createError("array.min",{limit:e,value:n},r,o)}))}max(e){const t=s.isRef(e);return r.assert(Number.isSafeInteger(e)&&e>=0||t,"limit must be a positive integer or reference"),this._testUnique("max",e,(function(n,r,o){let i;if(t){if(i=e(r.reference||r.parent,o),!(Number.isSafeInteger(i)&&i>=0))return this.createError("array.ref",{ref:e.key},r,o)}else i=e;return n.length<=i?n:this.createError("array.max",{limit:e,value:n},r,o)}))}length(e){const t=s.isRef(e);return r.assert(Number.isSafeInteger(e)&&e>=0||t,"limit must be a positive integer or reference"),this._testUnique("length",e,(function(n,r,o){let i;if(t){if(i=e(r.reference||r.parent,o),!(Number.isSafeInteger(i)&&i>=0))return this.createError("array.ref",{ref:e.key},r,o)}else i=e;return n.length===i?n:this.createError("array.length",{limit:e,value:n},r,o)}))}has(e){try{e=i.schema(this._currentJoi,e)}catch(e){throw e.hasOwnProperty("path")&&(e.message=`${e.message}(${e.path})`),e}return this._test("has",e,(function(t,n,r){if(t.some((t,o)=>{const i=new a(o,[...n.path,o],n.key,n.reference);return!e._validate(t,i,r).errors}))return t;const o=e._getLabel();return o?this.createError("array.hasKnown",{patternLabel:o},n,r):this.createError("array.hasUnknown",null,n,r)}))}unique(e,t){r.assert(void 0===e||"function"==typeof e||"string"==typeof e,"comparator must be a function or a string"),r.assert(void 0===t||"object"==typeof t,"configs must be an object");const n={ignoreUndefined:t&&t.ignoreUndefined||!1};return"string"==typeof e?n.path=e:"function"==typeof e&&(n.comparator=e),this._test("unique",n,(function(e,t,o){const i={string:Object.create(null),number:Object.create(null),undefined:Object.create(null),boolean:Object.create(null),object:new Map,function:new Map,custom:new Map},s=n.comparator||r.deepEqual,c=n.ignoreUndefined;for(let u=0;u<e.length;++u){const l=n.path?r.reach(e[u],n.path):e[u],d=n.comparator?i.custom:i[typeof l];if(d)if(d instanceof Map){const r=d.entries();let i;for(;!(i=r.next()).done;)if(s(i.value[0],l)){const r=new a(t.key,[...t.path,u],t.parent,t.reference),s={pos:u,value:e[u],dupePos:i.value[1],dupeValue:e[i.value[1]]};return n.path&&(s.path=n.path),this.createError("array.unique",s,r,o)}d.set(l,u)}else{if((!c||void 0!==l)&&void 0!==d[l]){const r=new a(t.key,[...t.path,u],t.parent,t.reference),i={pos:u,value:e[u],dupePos:d[l],dupeValue:e[d[l]]};return n.path&&(i.path=n.path),this.createError("array.unique",i,r,o)}d[l]=u}}return e}))}sparse(e){const t=void 0===e||!!e;if(this._flags.sparse===t)return this;const n=this.clone();return n._flags.sparse=t,n}single(e){const t=void 0===e||!!e;if(this._flags.single===t)return this;const n=this.clone();return n._flags.single=t,n}_fillMissedErrors(e,t,n,r){const o=[];let i=0;for(let e=0;e<t.length;++e){const n=t[e]._getLabel();n?o.push(n):++i}o.length?i?e.push(this.createError("array.includesRequiredBoth",{knownMisses:o,unknownMisses:i},{key:n.key,path:n.path},r)):e.push(this.createError("array.includesRequiredKnowns",{knownMisses:o},{key:n.key,path:n.path},r)):e.push(this.createError("array.includesRequiredUnknowns",{unknownMisses:i},{key:n.key,path:n.path},r))}_fillOrderedErrors(e,t,n,o){const i=[];for(let e=0;e<t.length;++e){"required"===r.reach(t[e],"_flags.presence")&&i.push(t[e])}i.length&&this._fillMissedErrors(e,i,n,o)}},c.safeParse=function(e,t){try{const n=JSON.parse(e);Array.isArray(n)&&(t.value=n)}catch(e){}},e.exports=new c.Array},function(e,t,n){"use strict";const r=n(45),o=n(20),i={Set:n(546)};i.Boolean=class extends r{constructor(){super(),this._type="boolean",this._flags.insensitive=!0,this._inner.truthySet=new i.Set,this._inner.falsySet=new i.Set}_base(e,t,n){const r={value:e};if("string"==typeof e&&n.convert){const t=this._flags.insensitive?e.toLowerCase():e;r.value="true"===t||"false"!==t&&e}return"boolean"!=typeof r.value&&(r.value=!!this._inner.truthySet.has(e,null,null,this._flags.insensitive)||!this._inner.falsySet.has(e,null,null,this._flags.insensitive)&&e),r.errors="boolean"==typeof r.value?null:this.createError("boolean.base",{value:e},t,n),r}truthy(...e){const t=this.clone();e=o.flatten(e);for(let n=0;n<e.length;++n){const r=e[n];o.assert(void 0!==r,"Cannot call truthy with undefined"),t._inner.truthySet.add(r)}return t}falsy(...e){const t=this.clone();e=o.flatten(e);for(let n=0;n<e.length;++n){const r=e[n];o.assert(void 0!==r,"Cannot call falsy with undefined"),t._inner.falsySet.add(r)}return t}insensitive(e){const t=void 0===e||!!e;if(this._flags.insensitive===t)return this;const n=this.clone();return n._flags.insensitive=t,n}describe(){const e=super.describe();return e.truthy=[!0,...this._inner.truthySet.values()],e.falsy=[!1,...this._inner.falsySet.values()],e}},e.exports=new i.Boolean},function(e,t,n){"use strict";const r=n(45),o=n(20),i={};i.Binary=class extends r{constructor(){super(),this._type="binary"}_base(e,t,n){const r={value:e};if("string"==typeof e&&n.convert)try{r.value=Buffer.from(e,this._flags.encoding)}catch(e){}return r.errors=Buffer.isBuffer(r.value)?null:this.createError("binary.base",null,t,n),r}encoding(e){if(o.assert(Buffer.isEncoding(e),"Invalid encoding:",e),this._flags.encoding===e)return this;const t=this.clone();return t._flags.encoding=e,t}min(e){return o.assert(Number.isSafeInteger(e)&&e>=0,"limit must be a positive integer"),this._test("min",e,(function(t,n,r){return t.length>=e?t:this.createError("binary.min",{limit:e,value:t},n,r)}))}max(e){return o.assert(Number.isSafeInteger(e)&&e>=0,"limit must be a positive integer"),this._test("max",e,(function(t,n,r){return t.length<=e?t:this.createError("binary.max",{limit:e,value:t},n,r)}))}length(e){return o.assert(Number.isSafeInteger(e)&&e>=0,"limit must be a positive integer"),this._test("length",e,(function(t,n,r){return t.length===e?t:this.createError("binary.length",{limit:e,value:t},n,r)}))}},e.exports=new i.Binary},function(e,t,n){"use strict";const r=n(20),o=n(549),i=n(50),s={};s.Func=class extends o.constructor{constructor(){super(),this._flags.func=!0}arity(e){return r.assert(Number.isSafeInteger(e)&&e>=0,"n must be a positive integer"),this._test("arity",e,(function(t,n,r){return t.length===e?t:this.createError("function.arity",{n:e},n,r)}))}minArity(e){return r.assert(Number.isSafeInteger(e)&&e>0,"n must be a strict positive integer"),this._test("minArity",e,(function(t,n,r){return t.length>=e?t:this.createError("function.minArity",{n:e},n,r)}))}maxArity(e){return r.assert(Number.isSafeInteger(e)&&e>=0,"n must be a positive integer"),this._test("maxArity",e,(function(t,n,r){return t.length<=e?t:this.createError("function.maxArity",{n:e},n,r)}))}ref(){return this._test("ref",null,(function(e,t,n){return i.isRef(e)?e:this.createError("function.ref",{value:e},t,n)}))}class(){return this._test("class",null,(function(e,t,n){return/^\s*class\s/.test(e.toString())?e:this.createError("function.class",{value:e},t,n)}))}},e.exports=new s.Func},function(e,t,n){"use strict";const r=n(20),o={};e.exports=class Topo{constructor(){this._items=[],this.nodes=[]}add(e,t){const n=[].concat((t=t||{}).before||[]),o=[].concat(t.after||[]),i=t.group||"?",s=t.sort||0;r.assert(!n.includes(i),"Item cannot come before itself: "+i),r.assert(!n.includes("?"),"Item cannot come before unassociated items"),r.assert(!o.includes(i),"Item cannot come after itself: "+i),r.assert(!o.includes("?"),"Item cannot come after unassociated items"),[].concat(e).forEach((e,t)=>{const r={seq:this._items.length,sort:s,before:n,after:o,group:i,node:e};this._items.push(r)});const a=this._sort();return r.assert(!a,"item","?"!==i?"added into group "+i:"","created a dependencies error"),this.nodes}merge(e){e=[].concat(e);for(let t=0;t<e.length;++t){const n=e[t];if(n)for(let e=0;e<n._items.length;++e){const t=Object.assign({},n._items[e]);this._items.push(t)}}this._items.sort(o.mergeSort);for(let e=0;e<this._items.length;++e)this._items[e].seq=e;const t=this._sort();return r.assert(!t,"merge created a dependencies error"),this.nodes}_sort(){const e={},t=Object.create(null),n=Object.create(null);for(let r=0;r<this._items.length;++r){const o=this._items[r],i=o.seq,s=o.group;n[s]=n[s]||[],n[s].push(i),e[i]=o.before;const a=o.after;for(let e=0;e<a.length;++e)t[a[e]]=(t[a[e]]||[]).concat(i)}let r=Object.keys(e);for(let t=0;t<r.length;++t){const o=r[t],i=[],s=Object.keys(e[o]);for(let t=0;t<s.length;++t){const r=e[o][s[t]];n[r]=n[r]||[];for(let e=0;e<n[r].length;++e)i.push(n[r][e])}e[o]=i}const o=Object.keys(t);for(let r=0;r<o.length;++r){const i=o[r];if(n[i])for(let r=0;r<n[i].length;++r){const o=n[i][r];e[o]=e[o].concat(t[i])}}let i;const s={};r=Object.keys(e);for(let t=0;t<r.length;++t){const n=r[t];i=e[n];for(let e=0;e<i.length;++e)s[i[e]]=(s[i[e]]||[]).concat(n)}const a={},c=[];for(let e=0;e<this._items.length;++e){let t=e;if(s[e]){t=null;for(let e=0;e<this._items.length;++e){if(!0===a[e])continue;s[e]||(s[e]=[]);const n=s[e].length;let r=0;for(let t=0;t<n;++t)a[s[e][t]]&&++r;if(r===n){t=e;break}}}null!==t&&(a[t]=!0,c.push(t))}if(c.length!==this._items.length)return new Error("Invalid dependencies");const u={};for(let e=0;e<this._items.length;++e){const t=this._items[e];u[t.seq]=t}const l=[];this._items=c.map(e=>{const t=u[e];return l.push(t.node),t}),this.nodes=l}},o.mergeSort=(e,t)=>e.sort===t.sort?0:e.sort<t.sort?-1:1},function(e,t,n){"use strict";const r=n(45),o=n(50),i=n(20),s={precisionRx:/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/,normalizeExponent:e=>e.replace(/\.?0+e/,"e").replace(/e\+/,"e").replace(/^\+/,"").replace(/^(-?)0+([1-9])/,"$1$2"),normalizeDecimal:e=>((e=e.replace(/^\+/,"").replace(/\.0+$/,"").replace(/^(-?)0+([1-9])/,"$1$2")).includes(".")&&e.endsWith("0")&&(e=e.replace(/0+$/,"")),e)};s.Number=class extends r{constructor(){super(),this._type="number",this._flags.unsafe=!1,this._invalids.add(1/0),this._invalids.add(-1/0)}_base(e,t,n){const r={errors:null,value:e};if("string"==typeof e&&n.convert){const o=e.match(/^\s*[+-]?\d+(?:\.\d+)?(?:e([+-]?\d+))?\s*$/i);if(o&&(e=e.trim(),r.value=parseFloat(e),!this._flags.unsafe))if(e.includes("e")){if(s.normalizeExponent(`${r.value/Math.pow(10,o[1])}e${o[1]}`)!==s.normalizeExponent(e))return r.errors=this.createError("number.unsafe",{value:e},t,n),r}else if(r.value.toString()!==s.normalizeDecimal(e))return r.errors=this.createError("number.unsafe",{value:e},t,n),r}const o="number"==typeof r.value&&!isNaN(r.value);if(n.convert&&"precision"in this._flags&&o){const e=Math.pow(10,this._flags.precision);r.value=Math.round(r.value*e)/e}return o?!this._flags.unsafe&&(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)&&(r.errors=this.createError("number.unsafe",{value:e},t,n)):r.errors=this.createError("number.base",{value:e},t,n),r}multiple(e){const t=o.isRef(e);return t||(i.assert("number"==typeof e&&isFinite(e),"multiple must be a number"),i.assert(e>0,"multiple must be greater than 0")),this._test("multiple",e,(function(n,r,o){const i=t?e(r.reference||r.parent,o):e;return!t||"number"==typeof i&&isFinite(i)?n%i==0?n:this.createError("number.multiple",{multiple:e,value:n},r,o):this.createError("number.ref",{ref:e.key},r,o)}))}integer(){return this._test("integer",void 0,(function(e,t,n){return Math.trunc(e)-e==0?e:this.createError("number.integer",{value:e},t,n)}))}unsafe(e=!0){if(i.assert("boolean"==typeof e,"enabled must be a boolean"),this._flags.unsafe===e)return this;const t=this.clone();return t._flags.unsafe=e,t}negative(){return this._test("negative",void 0,(function(e,t,n){return e<0?e:this.createError("number.negative",{value:e},t,n)}))}positive(){return this._test("positive",void 0,(function(e,t,n){return e>0?e:this.createError("number.positive",{value:e},t,n)}))}precision(e){i.assert(Number.isSafeInteger(e),"limit must be an integer"),i.assert(!("precision"in this._flags),"precision already set");const t=this._test("precision",e,(function(t,n,r){const o=t.toString().match(s.precisionRx);return Math.max((o[1]?o[1].length:0)-(o[2]?parseInt(o[2],10):0),0)<=e?t:this.createError("number.precision",{limit:e,value:t},n,r)}));return t._flags.precision=e,t}port(){return this._test("port",void 0,(function(e,t,n){return!Number.isSafeInteger(e)||e<0||e>65535?this.createError("number.port",{value:e},t,n):e}))}},s.compare=function(e,t){return function(n){const r=o.isRef(n),s="number"==typeof n&&!isNaN(n);return i.assert(s||r,"limit must be a number or reference"),this._test(e,n,(function(o,i,s){let a;if(r){if(a=n(i.reference||i.parent,s),"number"!=typeof a||isNaN(a))return this.createError("number.ref",{ref:n.key},i,s)}else a=n;return t(o,a)?o:this.createError("number."+e,{limit:a,value:o},i,s)}))}},s.Number.prototype.min=s.compare("min",(e,t)=>e>=t),s.Number.prototype.max=s.compare("max",(e,t)=>e<=t),s.Number.prototype.greater=s.compare("greater",(e,t)=>e>t),s.Number.prototype.less=s.compare("less",(e,t)=>e<t),e.exports=new s.Number},function(e,t,n){"use strict";const r=n(273),o=n(20),i=n(45),s=n(50),a=n(548),c=n(1332),u=n(1333);let l;const d={uriRegex:c.createUriRegex(),ipRegex:u.createIpRegex(["ipv4","ipv6","ipvfuture"],"optional"),guidBrackets:{"{":"}","[":"]","(":")","":""},guidVersions:{uuidv1:"1",uuidv2:"2",uuidv3:"3",uuidv4:"4",uuidv5:"5"},cidrPresences:["required","optional","forbidden"],normalizationForms:["NFC","NFD","NFKC","NFKD"]};d.String=class extends i{constructor(){super(),this._type="string",this._invalids.add("")}_base(e,t,n){if("string"==typeof e&&n.convert){if(this._flags.normalize&&(e=e.normalize(this._flags.normalize)),this._flags.case&&(e="upper"===this._flags.case?e.toLocaleUpperCase():e.toLocaleLowerCase()),this._flags.trim&&(e=e.trim()),this._inner.replacements)for(let t=0;t<this._inner.replacements.length;++t){const n=this._inner.replacements[t];e=e.replace(n.pattern,n.replacement)}if(this._flags.truncate)for(let t=0;t<this._tests.length;++t){const n=this._tests[t];if("max"===n.name){e=e.slice(0,n.arg);break}}this._flags.byteAligned&&e.length%2!=0&&(e="0"+e)}return{value:e,errors:"string"==typeof e?null:this.createError("string.base",{value:e},t,n)}}insensitive(){if(this._flags.insensitive)return this;const e=this.clone();return e._flags.insensitive=!0,e}creditCard(){return this._test("creditCard",void 0,(function(e,t,n){let r=e.length,o=0,i=1;for(;r--;){const t=e.charAt(r)*i;o+=t-9*(t>9),i^=3}return o%10==0&&o>0?e:this.createError("string.creditCard",{value:e},t,n)}))}regex(e,t){o.assert(e instanceof RegExp,"pattern must be a RegExp"),o.assert(!e.flags.includes("g")&&!e.flags.includes("y"),"pattern should not use global or sticky mode");const n={pattern:e};"string"==typeof t?n.name=t:"object"==typeof t&&(n.invert=!!t.invert,t.name&&(n.name=t.name));const r=["string.regex",n.invert?".invert":"",n.name?".name":".base"].join("");return this._test("regex",n,(function(e,t,o){return n.pattern.test(e)^n.invert?e:this.createError(r,{name:n.name,pattern:n.pattern,value:e},t,o)}))}alphanum(){return this._test("alphanum",void 0,(function(e,t,n){return/^[a-zA-Z0-9]+$/.test(e)?e:this.createError("string.alphanum",{value:e},t,n)}))}token(){return this._test("token",void 0,(function(e,t,n){return/^\w+$/.test(e)?e:this.createError("string.token",{value:e},t,n)}))}email(e){return e&&(o.assert("object"==typeof e,"email options must be an object"),o.assert(void 0===e.checkDNS,"checkDNS option is not supported"),o.assert(void 0===e.tldWhitelist||"object"==typeof e.tldWhitelist,"tldWhitelist must be an array or object"),o.assert(void 0===e.minDomainAtoms||Number.isSafeInteger(e.minDomainAtoms)&&e.minDomainAtoms>0,"minDomainAtoms must be a positive integer"),o.assert(void 0===e.errorLevel||"boolean"==typeof e.errorLevel||Number.isSafeInteger(e.errorLevel)&&e.errorLevel>=0,"errorLevel must be a non-negative integer or boolean")),this._test("email",e,(function(t,r,o){l=l||n(1334);try{const n=l.validate(t,e);if(!0===n||0===n)return t}catch(e){}return this.createError("string.email",{value:t},r,o)}))}ip(e={}){let t,n=d.ipRegex;if(o.assert("object"==typeof e,"options must be an object"),e.cidr?(o.assert("string"==typeof e.cidr,"cidr must be a string"),e.cidr=e.cidr.toLowerCase(),o.assert(o.contain(d.cidrPresences,e.cidr),"cidr must be one of "+d.cidrPresences.join(", ")),e.version||"optional"===e.cidr||(n=u.createIpRegex(["ipv4","ipv6","ipvfuture"],e.cidr))):e.cidr="optional",e.version){Array.isArray(e.version)||(e.version=[e.version]),o.assert(e.version.length>=1,"version must have at least 1 version specified"),t=[];for(let n=0;n<e.version.length;++n){let r=e.version[n];o.assert("string"==typeof r,"version at position "+n+" must be a string"),r=r.toLowerCase(),o.assert(u.versions[r],"version at position "+n+" must be one of "+Object.keys(u.versions).join(", ")),t.push(r)}t=Array.from(new Set(t)),n=u.createIpRegex(t,e.cidr)}return this._test("ip",e,(function(r,o,i){return n.test(r)?r:t?this.createError("string.ipVersion",{value:r,cidr:e.cidr,version:t},o,i):this.createError("string.ip",{value:r,cidr:e.cidr},o,i)}))}uri(e){let t="",n=!1,r=!1,i=!1,s=d.uriRegex;if(e){o.assert("object"==typeof e,"options must be an object");const s=Object.keys(e).filter(e=>!["scheme","allowRelative","relativeOnly","allowQuerySquareBrackets"].includes(e));if(o.assert(0===s.length,"options contain unknown keys: "+s),e.scheme){o.assert(e.scheme instanceof RegExp||"string"==typeof e.scheme||Array.isArray(e.scheme),"scheme must be a RegExp, String, or Array"),Array.isArray(e.scheme)||(e.scheme=[e.scheme]),o.assert(e.scheme.length>=1,"scheme must have at least 1 scheme specified");for(let n=0;n<e.scheme.length;++n){const r=e.scheme[n];o.assert(r instanceof RegExp||"string"==typeof r,"scheme at position "+n+" must be a RegExp or String"),t+=t?"|":"",r instanceof RegExp?t+=r.source:(o.assert(/[a-zA-Z][a-zA-Z0-9+-\.]*/.test(r),"scheme at position "+n+" must be a valid scheme"),t+=o.escapeRegex(r))}}e.allowRelative&&(n=!0),e.relativeOnly&&(r=!0),e.allowQuerySquareBrackets&&(i=!0)}return(t||n||r||i)&&(s=c.createUriRegex(t,n,r,i)),this._test("uri",e,(function(e,n,o){return s.test(e)?e:r?this.createError("string.uriRelativeOnly",{value:e},n,o):t?this.createError("string.uriCustomScheme",{scheme:t,value:e},n,o):this.createError("string.uri",{value:e},n,o)}))}isoDate(){return this._test("isoDate",void 0,(function(e,t,n){if(a._isIsoDate(e)){if(!n.convert)return e;const t=new Date(e);if(!isNaN(t.getTime()))return t.toISOString()}return this.createError("string.isoDate",{value:e},t,n)}))}guid(e){let t="";if(e&&e.version){Array.isArray(e.version)||(e.version=[e.version]),o.assert(e.version.length>=1,"version must have at least 1 valid version specified");const n=new Set;for(let r=0;r<e.version.length;++r){let i=e.version[r];o.assert("string"==typeof i,"version at position "+r+" must be a string"),i=i.toLowerCase();const s=d.guidVersions[i];o.assert(s,"version at position "+r+" must be one of "+Object.keys(d.guidVersions).join(", ")),o.assert(!n.has(s),"version at position "+r+" must not be a duplicate."),t+=s,n.add(s)}}const n=new RegExp(`^([\\[{\\(]?)[0-9A-F]{8}([:-]?)[0-9A-F]{4}\\2?[${t||"0-9A-F"}][0-9A-F]{3}\\2?[${t?"89AB":"0-9A-F"}][0-9A-F]{3}\\2?[0-9A-F]{12}([\\]}\\)]?)$`,"i");return this._test("guid",e,(function(e,t,r){const o=n.exec(e);return o?d.guidBrackets[o[1]]!==o[o.length-1]?this.createError("string.guid",{value:e},t,r):e:this.createError("string.guid",{value:e},t,r)}))}hex(e={}){o.assert("object"==typeof e,"hex options must be an object"),o.assert(void 0===e.byteAligned||"boolean"==typeof e.byteAligned,"byteAligned must be boolean");const t=!0===e.byteAligned,n=/^[a-f0-9]+$/i,r=this._test("hex",n,(function(e,r,o){return n.test(e)?t&&e.length%2!=0?this.createError("string.hexAlign",{value:e},r,o):e:this.createError("string.hex",{value:e},r,o)}));return t&&(r._flags.byteAligned=!0),r}base64(e={}){o.assert("object"==typeof e,"base64 options must be an object"),o.assert(void 0===e.paddingRequired||"boolean"==typeof e.paddingRequired,"paddingRequired must be boolean");const t=(!1===e.paddingRequired?e.paddingRequired:e.paddingRequired||!0)?/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/:/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}(==)?|[A-Za-z0-9+\/]{3}=?)?$/;return this._test("base64",t,(function(e,n,r){return t.test(e)?e:this.createError("string.base64",{value:e},n,r)}))}dataUri(e={}){const t=/^data:[\w+.-]+\/[\w+.-]+;((charset=[\w-]+|base64),)?(.*)$/,n=(!1===e.paddingRequired?e.paddingRequired:e.paddingRequired||!0)?/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/:/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}(==)?|[A-Za-z0-9+\/]{3}=?)?$/;return this._test("dataUri",t,(function(e,r,o){const i=e.match(t);if(i){if(!i[2])return e;if("base64"!==i[2])return e;if(n.test(i[3]))return e}return this.createError("string.dataUri",{value:e},r,o)}))}hostname(){const e=/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9])$/;return this._test("hostname",void 0,(function(t,n,o){return t.length<=255&&e.test(t)||r.isIPv6(t)?t:this.createError("string.hostname",{value:t},n,o)}))}normalize(e="NFC"){o.assert(o.contain(d.normalizationForms,e),"normalization form must be one of "+d.normalizationForms.join(", "));const t=this._test("normalize",e,(function(t,n,r){return r.convert||t===t.normalize(e)?t:this.createError("string.normalize",{value:t,form:e},n,r)}));return t._flags.normalize=e,t}lowercase(){const e=this._test("lowercase",void 0,(function(e,t,n){return n.convert||e===e.toLocaleLowerCase()?e:this.createError("string.lowercase",{value:e},t,n)}));return e._flags.case="lower",e}uppercase(){const e=this._test("uppercase",void 0,(function(e,t,n){return n.convert||e===e.toLocaleUpperCase()?e:this.createError("string.uppercase",{value:e},t,n)}));return e._flags.case="upper",e}trim(e=!0){if(o.assert("boolean"==typeof e,"option must be a boolean"),this._flags.trim&&e||!this._flags.trim&&!e)return this;let t;return e?t=this._test("trim",void 0,(function(e,t,n){return n.convert||e===e.trim()?e:this.createError("string.trim",{value:e},t,n)})):(t=this.clone(),t._tests=t._tests.filter(e=>"trim"!==e.name)),t._flags.trim=e,t}replace(e,t){"string"==typeof e&&(e=new RegExp(o.escapeRegex(e),"g")),o.assert(e instanceof RegExp,"pattern must be a RegExp"),o.assert("string"==typeof t,"replacement must be a String");const n=this.clone();return n._inner.replacements||(n._inner.replacements=[]),n._inner.replacements.push({pattern:e,replacement:t}),n}truncate(e){const t=void 0===e||!!e;if(this._flags.truncate===t)return this;const n=this.clone();return n._flags.truncate=t,n}},d.compare=function(e,t){return function(n,r){const i=s.isRef(n);return o.assert(Number.isSafeInteger(n)&&n>=0||i,"limit must be a positive integer or reference"),o.assert(!r||Buffer.isEncoding(r),"Invalid encoding:",r),this._test(e,n,(function(o,s,a){let c;if(i){if(c=n(s.reference||s.parent,a),!Number.isSafeInteger(c))return this.createError("string.ref",{ref:n,value:c},s,a)}else c=n;return t(o,c,r)?o:this.createError("string."+e,{limit:c,value:o,encoding:r},s,a)}))}},d.String.prototype.min=d.compare("min",(e,t,n)=>(n?Buffer.byteLength(e,n):e.length)>=t),d.String.prototype.max=d.compare("max",(e,t,n)=>(n?Buffer.byteLength(e,n):e.length)<=t),d.String.prototype.length=d.compare("length",(e,t,n)=>(n?Buffer.byteLength(e,n):e.length)===t),d.String.prototype.uuid=d.String.prototype.guid,e.exports=new d.String},function(e,t,n){"use strict";const r=n(550),o={Uri:{createUriRegex:function(e,t,n,o){let i,s=r.scheme;if(n)i="(?:"+r.relativeRef+")";else{e&&(s="(?:"+e+")");const n="(?:"+s+":"+r.hierPart+")";i=t?"(?:"+n+"|"+r.relativeRef+")":n}return new RegExp("^"+i+"(?:\\?"+(o?r.queryWithSquareBrackets:r.query)+")?(?:#"+r.fragment+")?$")}}};e.exports=o.Uri},function(e,t,n){"use strict";const r=n(550),o={Ip:{cidrs:{ipv4:{required:"\\/(?:"+r.ipv4Cidr+")",optional:"(?:\\/(?:"+r.ipv4Cidr+"))?",forbidden:""},ipv6:{required:"\\/"+r.ipv6Cidr,optional:"(?:\\/"+r.ipv6Cidr+")?",forbidden:""},ipvfuture:{required:"\\/"+r.ipv6Cidr,optional:"(?:\\/"+r.ipv6Cidr+")?",forbidden:""}},versions:{ipv4:r.IPv4address,ipv6:r.IPv6address,ipvfuture:r.IPvFuture}}};o.Ip.createIpRegex=function(e,t){let n;for(let r=0;r<e.length;++r){const i=e[r];n?n+="|"+o.Ip.versions[i]+o.Ip.cidrs[i][t]:n="^(?:"+o.Ip.versions[i]+o.Ip.cidrs[i][t]}return new RegExp(n+")$")},e.exports=o.Ip},function(e,t,n){"use strict";const r=n(1335),o=n(12),i={hasOwn:Object.prototype.hasOwnProperty,indexOf:Array.prototype.indexOf,defaultThreshold:16,maxIPv6Groups:8,categories:{valid:1,dnsWarn:7,rfc5321:15,cfws:31,deprecated:63,rfc5322:127,error:255},diagnoses:{valid:0,rfc5321TLD:9,rfc5321TLDNumeric:10,rfc5321QuotedString:11,rfc5321AddressLiteral:12,cfwsComment:17,cfwsFWS:18,undesiredNonAscii:25,deprecatedLocalPart:33,deprecatedFWS:34,deprecatedQTEXT:35,deprecatedQP:36,deprecatedComment:37,deprecatedCTEXT:38,deprecatedIPv6:39,deprecatedCFWSNearAt:49,rfc5322Domain:65,rfc5322TooLong:66,rfc5322LocalTooLong:67,rfc5322DomainTooLong:68,rfc5322LabelTooLong:69,rfc5322DomainLiteral:70,rfc5322DomainLiteralOBSDText:71,rfc5322IPv6GroupCount:72,rfc5322IPv62x2xColon:73,rfc5322IPv6BadCharacter:74,rfc5322IPv6MaxGroups:75,rfc5322IPv6ColonStart:76,rfc5322IPv6ColonEnd:77,errExpectingDTEXT:129,errNoLocalPart:130,errNoDomain:131,errConsecutiveDots:132,errATEXTAfterCFWS:133,errATEXTAfterQS:134,errATEXTAfterDomainLiteral:135,errExpectingQPair:136,errExpectingATEXT:137,errExpectingQTEXT:138,errExpectingCTEXT:139,errBackslashEnd:140,errDotStart:141,errDotEnd:142,errDomainHyphenStart:143,errDomainHyphenEnd:144,errUnclosedQuotedString:145,errUnclosedComment:146,errUnclosedDomainLiteral:147,errFWSCRLFx2:148,errFWSCRLFEnd:149,errCRNoLF:150,errUnknownTLD:160,errDomainTooShort:161,errDotAfterDomainLiteral:162},components:{localpart:0,domain:1,literal:2,contextComment:3,contextFWS:4,contextQuotedString:5,contextQuotedPair:6}};i.specials=function(){const e=new Array(256);e.fill(!1);for(let t=0;t<'()<>[]:;@\\,."'.length;++t)e['()<>[]:;@\\,."'.codePointAt(t)]=!0;return function(t){return e[t]}}(),i.c0Controls=function(){const e=new Array(256);e.fill(!1);for(let t=0;t<33;++t)e[t]=!0;return function(t){return e[t]}}(),i.c1Controls=function(){const e=new Array(256);e.fill(!1);for(let t=127;t<160;++t)e[t]=!0;return function(t){return e[t]}}(),i.regex={ipV4:/\b(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipV6:/^[a-fA-F\d]{0,4}$/},i.normalizeSupportsNul="\0"==="\0".normalize("NFC"),i.nulNormalize=function(e){return e.split("\0").map(e=>e.normalize("NFC")).join("\0")},i.normalize=function(e){return e.normalize("NFC")},i.normalizeSupportsNul||(i.normalize=function(e){return e.indexOf("\0")>=0?i.nulNormalize(e):e.normalize("NFC")}),i.checkIpV6=function(e){return e.every(e=>i.regex.ipV6.test(e))},i.isIterable=Array.isArray,"undefined"!=typeof Symbol&&(i.isIterable=e=>Array.isArray(e)||!!e&&"object"==typeof e&&"function"==typeof e[Symbol.iterator]),i._isSet=e=>e instanceof Set,i._isMap=e=>e instanceof Map,i.isSet=o.types&&o.types.isSet||i._isSet,i.isMap=o.types&&o.types.isMap||i._isMap,i.normalizeTable=function(e){return i.isSet(e)||Array.isArray(e)?e:i.isMap(e)?e.keys():Object.keys(e)},i.canonicalizeAtom=function(e){return r.toASCII(e).toLowerCase()},i.includesMapped=function(e,t,n){for(const r of e)if(n===t(r))return!0;return!1},i.validDomain=function(e,t){const n=i.canonicalizeAtom(e);return t.tldBlacklist?!i.includesMapped(i.normalizeTable(t.tldBlacklist),i.canonicalizeAtom,n):i.includesMapped(i.normalizeTable(t.tldWhitelist),i.canonicalizeAtom,n)},i.hasDomainLiteralThenAtom=function(e){let t=!1;for(let n=0;n<e.length;++n)if("["===e[n][0])t=!0;else if(t)return!0;return!1},t.validate=i.validate=function(e,t,n){if(t=t||{},"string"!=typeof e)throw new TypeError("expected string email");let o,s;if(e=i.normalize(e),"function"==typeof t&&(n=t,t={}),"function"!=typeof n&&(n=null),"number"==typeof t.errorLevel?(o=!0,s=t.errorLevel):(o=!!t.errorLevel,s=i.diagnoses.valid),t.tldWhitelist)if("string"==typeof t.tldWhitelist)t.tldWhitelist=[t.tldWhitelist];else if("object"!=typeof t.tldWhitelist)throw new TypeError("expected array or object tldWhitelist");if(t.tldBlacklist)if("string"==typeof t.tldBlacklist)t.tldBlacklist=[t.tldBlacklist];else if("object"!=typeof t.tldBlacklist)throw new TypeError("expected array or object tldBlacklist");if(t.minDomainAtoms&&(t.minDomainAtoms!==(0|+t.minDomainAtoms)||t.minDomainAtoms<0))throw new TypeError("expected positive integer minDomainAtoms");if(t.excludeDiagnoses){if(!i.isIterable(t.excludeDiagnoses))throw new TypeError("expected iterable excludeDiagnoses");i.isSet(t.excludeDiagnoses)||(t.excludeDiagnoses=new Set(t.excludeDiagnoses))}let a=i.diagnoses.valid;const updateResult=e=>{!(e>a)||t.excludeDiagnoses&&t.excludeDiagnoses.has(e)||(a=e)};!(void 0===t.allowUnicode||!!t.allowUnicode)&&/[^\x00-\x7f]/.test(e)&&updateResult(i.diagnoses.undesiredNonAscii);const c={now:i.components.localpart,prev:i.components.localpart,stack:[i.components.localpart]};let u="";const l={local:"",domain:""},d={locals:[""],domains:[""]};let p,h=0,m=0,y=0,g=!1,_=!1;const v=e.length;let E;for(let t=0;t<v;t+=E.length){switch(E=String.fromCodePoint(e.codePointAt(t)),c.now){case i.components.localpart:switch(E){case"(":0===m?updateResult(0===h?i.diagnoses.cfwsComment:i.diagnoses.deprecatedComment):(updateResult(i.diagnoses.cfwsComment),_=!0),c.stack.push(c.now),c.now=i.components.contextComment;break;case".":0===m?updateResult(0===h?i.diagnoses.errDotStart:i.diagnoses.errConsecutiveDots):(_&&updateResult(i.diagnoses.deprecatedLocalPart),_=!1,m=0,++h,l.local+=E,d.locals[h]="");break;case'"':0===m?(updateResult(0===h?i.diagnoses.rfc5321QuotedString:i.diagnoses.deprecatedLocalPart),l.local+=E,d.locals[h]+=E,m+=Buffer.byteLength(E,"utf8"),_=!0,c.stack.push(c.now),c.now=i.components.contextQuotedString):updateResult(i.diagnoses.errExpectingATEXT);break;case"\r":if(v===++t||"\n"!==e[t]){updateResult(i.diagnoses.errCRNoLF);break}case" ":case"\t":0===m?updateResult(0===h?i.diagnoses.cfwsFWS:i.diagnoses.deprecatedFWS):_=!0,c.stack.push(c.now),c.now=i.components.contextFWS,u=E;break;case"@":if(1!==c.stack.length)throw new Error("unexpected item on context stack");0===l.local.length?updateResult(i.diagnoses.errNoLocalPart):0===m?updateResult(i.diagnoses.errDotEnd):Buffer.byteLength(l.local,"utf8")>64?updateResult(i.diagnoses.rfc5322LocalTooLong):c.prev!==i.components.contextComment&&c.prev!==i.components.contextFWS||updateResult(i.diagnoses.deprecatedCFWSNearAt),c.now=i.components.domain,c.stack[0]=i.components.domain,h=0,m=0,_=!1;break;default:if(_)switch(c.prev){case i.components.contextComment:case i.components.contextFWS:updateResult(i.diagnoses.errATEXTAfterCFWS);break;case i.components.contextQuotedString:updateResult(i.diagnoses.errATEXTAfterQS);break;default:throw new Error("more atext found where none is allowed, but unrecognized prev context: "+c.prev)}else c.prev=c.now,p=E.codePointAt(0),(i.specials(p)||i.c0Controls(p)||i.c1Controls(p))&&updateResult(i.diagnoses.errExpectingATEXT),l.local+=E,d.locals[h]+=E,m+=Buffer.byteLength(E,"utf8")}break;case i.components.domain:switch(E){case"(":0===m?updateResult(0===h?i.diagnoses.deprecatedCFWSNearAt:i.diagnoses.deprecatedComment):(_=!0,updateResult(i.diagnoses.cfwsComment)),c.stack.push(c.now),c.now=i.components.contextComment;break;case".":const n=r.toASCII(d.domains[h]).length;0===m?updateResult(0===h?i.diagnoses.errDotStart:i.diagnoses.errConsecutiveDots):g?updateResult(i.diagnoses.errDomainHyphenEnd):n>63&&updateResult(i.diagnoses.rfc5322LabelTooLong),_=!1,m=0,++h,d.domains[h]="",l.domain+=E;break;case"[":0===d.domains[h].length?(l.domain.length&&updateResult(i.diagnoses.errDotAfterDomainLiteral),_=!0,m+=Buffer.byteLength(E,"utf8"),c.stack.push(c.now),c.now=i.components.literal,l.domain+=E,d.domains[h]+=E,l.literal=""):updateResult(i.diagnoses.errExpectingATEXT);break;case"\r":if(v===++t||"\n"!==e[t]){updateResult(i.diagnoses.errCRNoLF);break}case" ":case"\t":0===m?updateResult(0===h?i.diagnoses.deprecatedCFWSNearAt:i.diagnoses.deprecatedFWS):(updateResult(i.diagnoses.cfwsFWS),_=!0),c.stack.push(c.now),c.now=i.components.contextFWS,u=E;break;default:if(_)switch(c.prev){case i.components.contextComment:case i.components.contextFWS:updateResult(i.diagnoses.errATEXTAfterCFWS);break;case i.components.literal:updateResult(i.diagnoses.errATEXTAfterDomainLiteral);break;default:throw new Error("more atext found where none is allowed, but unrecognized prev context: "+c.prev)}p=E.codePointAt(0),g=!1,i.specials(p)||i.c0Controls(p)||i.c1Controls(p)?updateResult(i.diagnoses.errExpectingATEXT):"-"===E?(0===m&&updateResult(i.diagnoses.errDomainHyphenStart),g=!0):(p<48||p>122&&p<192||p>57&&p<65||p>90&&p<97)&&updateResult(i.diagnoses.rfc5322Domain),l.domain+=E,d.domains[h]+=E,m+=Buffer.byteLength(E,"utf8")}break;case i.components.literal:switch(E){case"]":if(a<i.categories.deprecated){let e=-1,t=l.literal;const n=i.regex.ipV4.exec(t);if(n&&(e=n.index,0!==e&&(t=t.slice(0,e)+"0:0")),0===e)updateResult(i.diagnoses.rfc5321AddressLiteral);else if("ipv6:"!==t.slice(0,5).toLowerCase())updateResult(i.diagnoses.rfc5322DomainLiteral);else{const n=t.slice(5);let r=i.maxIPv6Groups;const o=n.split(":");e=n.indexOf("::"),~e?e!==n.lastIndexOf("::")?updateResult(i.diagnoses.rfc5322IPv62x2xColon):(0!==e&&e!==n.length-2||++r,o.length>r?updateResult(i.diagnoses.rfc5322IPv6MaxGroups):o.length===r&&updateResult(i.diagnoses.deprecatedIPv6)):o.length!==r&&updateResult(i.diagnoses.rfc5322IPv6GroupCount),":"===n[0]&&":"!==n[1]?updateResult(i.diagnoses.rfc5322IPv6ColonStart):":"===n[n.length-1]&&":"!==n[n.length-2]?updateResult(i.diagnoses.rfc5322IPv6ColonEnd):i.checkIpV6(o)?updateResult(i.diagnoses.rfc5321AddressLiteral):updateResult(i.diagnoses.rfc5322IPv6BadCharacter)}}else updateResult(i.diagnoses.rfc5322DomainLiteral);l.domain+=E,d.domains[h]+=E,m+=Buffer.byteLength(E,"utf8"),c.prev=c.now,c.now=c.stack.pop();break;case"\\":updateResult(i.diagnoses.rfc5322DomainLiteralOBSDText),c.stack.push(c.now),c.now=i.components.contextQuotedPair;break;case"\r":if(v===++t||"\n"!==e[t]){updateResult(i.diagnoses.errCRNoLF);break}case" ":case"\t":updateResult(i.diagnoses.cfwsFWS),c.stack.push(c.now),c.now=i.components.contextFWS,u=E;break;default:if(p=E.codePointAt(0),127!==p&&i.c1Controls(p)||0===p||"["===E){updateResult(i.diagnoses.errExpectingDTEXT);break}(i.c0Controls(p)||127===p)&&updateResult(i.diagnoses.rfc5322DomainLiteralOBSDText),l.literal+=E,l.domain+=E,d.domains[h]+=E,m+=Buffer.byteLength(E,"utf8")}break;case i.components.contextQuotedString:switch(E){case"\\":c.stack.push(c.now),c.now=i.components.contextQuotedPair;break;case"\r":if(v===++t||"\n"!==e[t]){updateResult(i.diagnoses.errCRNoLF);break}case"\t":l.local+=" ",d.locals[h]+=" ",m+=Buffer.byteLength(E,"utf8"),updateResult(i.diagnoses.cfwsFWS),c.stack.push(c.now),c.now=i.components.contextFWS,u=E;break;case'"':l.local+=E,d.locals[h]+=E,m+=Buffer.byteLength(E,"utf8"),c.prev=c.now,c.now=c.stack.pop();break;default:p=E.codePointAt(0),127!==p&&i.c1Controls(p)||0===p||10===p?updateResult(i.diagnoses.errExpectingQTEXT):(i.c0Controls(p)||127===p)&&updateResult(i.diagnoses.deprecatedQTEXT),l.local+=E,d.locals[h]+=E,m+=Buffer.byteLength(E,"utf8")}break;case i.components.contextQuotedPair:p=E.codePointAt(0),127!==p&&i.c1Controls(p)?updateResult(i.diagnoses.errExpectingQPair):(p<31&&9!==p||127===p)&&updateResult(i.diagnoses.deprecatedQP),c.prev=c.now,c.now=c.stack.pop();const n="\\"+E;switch(c.now){case i.components.contextComment:break;case i.components.contextQuotedString:l.local+=n,d.locals[h]+=n,m+=2;break;case i.components.literal:l.domain+=n,d.domains[h]+=n,m+=2;break;default:throw new Error("quoted pair logic invoked in an invalid context: "+c.now)}break;case i.components.contextComment:switch(E){case"(":c.stack.push(c.now),c.now=i.components.contextComment;break;case")":c.prev=c.now,c.now=c.stack.pop();break;case"\\":c.stack.push(c.now),c.now=i.components.contextQuotedPair;break;case"\r":if(v===++t||"\n"!==e[t]){updateResult(i.diagnoses.errCRNoLF);break}case" ":case"\t":updateResult(i.diagnoses.cfwsFWS),c.stack.push(c.now),c.now=i.components.contextFWS,u=E;break;default:if(p=E.codePointAt(0),0===p||10===p||127!==p&&i.c1Controls(p)){updateResult(i.diagnoses.errExpectingCTEXT);break}(i.c0Controls(p)||127===p)&&updateResult(i.diagnoses.deprecatedCTEXT)}break;case i.components.contextFWS:if("\r"===u){if("\r"===E){updateResult(i.diagnoses.errFWSCRLFx2);break}++y>1?updateResult(i.diagnoses.deprecatedFWS):y=1}switch(E){case"\r":v!==++t&&"\n"===e[t]||updateResult(i.diagnoses.errCRNoLF);break;case" ":case"\t":break;default:"\r"===u&&updateResult(i.diagnoses.errFWSCRLFEnd),y=0,c.prev=c.now,c.now=c.stack.pop(),--t}u=E;break;default:throw new Error("unknown context: "+c.now)}if(a>i.categories.rfc5322)break}if(a<i.categories.rfc5322){const e=r.toASCII(l.domain).length;if(c.now===i.components.contextQuotedString)updateResult(i.diagnoses.errUnclosedQuotedString);else if(c.now===i.components.contextQuotedPair)updateResult(i.diagnoses.errBackslashEnd);else if(c.now===i.components.contextComment)updateResult(i.diagnoses.errUnclosedComment);else if(c.now===i.components.literal)updateResult(i.diagnoses.errUnclosedDomainLiteral);else if("\r"===E)updateResult(i.diagnoses.errFWSCRLFEnd);else if(0===l.domain.length)updateResult(i.diagnoses.errNoDomain);else if(0===m)updateResult(i.diagnoses.errDotEnd);else if(g)updateResult(i.diagnoses.errDomainHyphenEnd);else if(e>255)updateResult(i.diagnoses.rfc5322DomainTooLong);else if(Buffer.byteLength(l.local,"utf8")+e+1>254)updateResult(i.diagnoses.rfc5322TooLong);else if(m>63)updateResult(i.diagnoses.rfc5322LabelTooLong);else if(t.minDomainAtoms&&d.domains.length<t.minDomainAtoms&&(1!==d.domains.length||"["!==d.domains[0][0]))updateResult(i.diagnoses.errDomainTooShort);else if(i.hasDomainLiteralThenAtom(d.domains))updateResult(i.diagnoses.errDotAfterDomainLiteral);else if(t.tldWhitelist||t.tldBlacklist){const e=d.domains[h];i.validDomain(e,t)||updateResult(i.diagnoses.errUnknownTLD)}}if(a<i.categories.dnsWarn){d.domains[h].codePointAt(0)<=57&&updateResult(i.diagnoses.rfc5321TLDNumeric)}a<s&&(a=i.diagnoses.valid);const I=o?a:a<i.defaultThreshold;return n&&n(I),I},t.diagnoses=i.validate.diagnoses=function(){const e={},t=Object.keys(i.diagnoses);for(let n=0;n<t.length;++n){const r=t[n];e[r]=i.diagnoses[r]}return e}(),t.normalize=i.normalize},function(e,t){e.exports=require("punycode")},function(e,t,n){"use strict";const r=n(12),o=n(45),i=n(20),s={};s.Map=class extends Map{slice(){return new s.Map(this)}toString(){return r.inspect(this)}},s.Symbol=class extends o{constructor(){super(),this._type="symbol",this._inner.map=new s.Map}_base(e,t,n){if(n.convert){const r=this._inner.map.get(e);if(r&&(e=r),this._flags.allowOnly)return{value:e,errors:"symbol"==typeof e?null:this.createError("symbol.map",{value:e,map:this._inner.map},t,n)}}return{value:e,errors:"symbol"==typeof e?null:this.createError("symbol.base",{value:e},t,n)}}map(e){e&&!e[Symbol.iterator]&&"object"==typeof e&&(e=Object.entries(e)),i.assert(e&&e[Symbol.iterator],"Iterable must be an iterable or object");const t=this.clone(),n=[];for(const r of e){i.assert(r&&r[Symbol.iterator],"Entry must be an iterable");const[e,o]=r;i.assert("object"!=typeof e&&"function"!=typeof e&&"symbol"!=typeof e,"Key must not be an object, function, or Symbol"),i.assert("symbol"==typeof o,"Value must be a Symbol"),t._inner.map.set(e,o),n.push(o)}return t.valid(...n)}describe(){const e=super.describe();return e.map=new Map(this._inner.map),e}},e.exports=new s.Symbol},function(e){e.exports=JSON.parse('{"_from":"joi@14.3.1","_id":"joi@14.3.1","_inBundle":false,"_integrity":"sha1-FkomLsC4VUZuDDXuoqiFrotscDw=","_location":"/joi","_phantomChildren":{},"_requested":{"type":"version","registry":true,"raw":"joi@14.3.1","name":"joi","escapedName":"joi","rawSpec":"14.3.1","saveSpec":null,"fetchSpec":"14.3.1"},"_requiredBy":["/","/@rush-temp/fremont-js-lib"],"_resolved":"https://art-bobcat.autodesk.com:443/artifactory/api/npm/autodesk-npm-virtual/joi/-/joi-14.3.1.tgz","_shasum":"164a262ec0b855466e0c35eea2a885ae8b6c703c","_spec":"joi@14.3.1","_where":"/mnt/data/jenkins/workspace/ono_release_fremont-js-lib_21-03/common/temp","bugs":{"url":"https://github.com/hapijs/joi/issues"},"bundleDependencies":false,"dependencies":{"hoek":"6.x.x","isemail":"3.x.x","topo":"3.x.x"},"deprecated":"This module has moved and is now available at @hapi/joi. Please update your dependencies as this version is no longer maintained an may contain bugs and security issues.","description":"Object schema validation","devDependencies":{"code":"5.x.x","hapitoc":"1.x.x","lab":"18.x.x"},"homepage":"https://github.com/hapijs/joi","keywords":["hapi","schema","validation"],"license":"BSD-3-Clause","main":"lib/index.js","name":"joi","repository":{"type":"git","url":"git://github.com/hapijs/joi.git"},"scripts":{"test":"lab -t 100 -a code -L","test-cov-html":"lab -r html -o coverage.html -a code","test-debug":"lab -a code","toc":"hapitoc && node docs/check-errors-list.js","version":"npm run toc && git add API.md README.md"},"version":"14.3.1"}')},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.waitSynchronization=async function waitSynchronization(e,t){console.warn("[waitSynchronization]: This function is deprecated")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),o=n(537),i=n(538),s=n(56);t.PIMDrawingService={name:"PIMDrawingService",constants:{EntityType:r.EntityTypes,AttributeKey:o.AttributeKeys},functions:{drawingOpened:{handler:i.documentOpenedHandler,arguments:["data:object"]},drawingSaved:{handler:i.drawingSavedHandler,arguments:["data:object"]},drawingUploaded:{handler:i.drawingUploadedHandler,arguments:["data:object"]},drawingFileUploaded:{handler:i.documentFileUploadedHandler,arguments:["data:object"]},preDrawingUpload:{handler:i.preDrawingUploadHandler,arguments:["data:object"]},getDocumentStatus:{handler:s.getDocumentStatus,arguments:["documentId:string"]}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1341),o={string:"const Ns::HString&",istring:"const Ns::IString&",boolean:"bool",ComponentMap:"const Ns::JSONNode&",JSONPatch:"const Ns::JSONNode&",object:"const Ns::JSONNode&"},i={string:"string",istring:"string",boolean:"boolean",ComponentMap:"ComponentMap",JSONPatch:"Operation[]",object:"object"},s={string:e=>e+";\n",istring:e=>`Ns::ToHString(${e});\n`,boolean:e=>e+";\n",ComponentMap:e=>e+".stringify();\n",JSONPatch:e=>e+".stringify();\n",object:e=>e+".stringify();\n"};t.generateCode=function generateCode(e){let t=""+r.HeaderTemplate,n=""+r.CodeTemplate,a=""+r.TSCodeTemplate,c=""+r.PIMLocalUtilsTemplate;const u=e.name;n=n.replace(/<<CLASS>>/g,u),a=a.replace(/<<CLASS>>/g,u),t=t.replace(/<<CLASS>>/g,u);let l="";switch(u){case"PIMDrawingService":l+="#include <Fusion/Server/Fusion/PIM/FremontJs/SocketService.h>\n#include <Fusion/Server/Fusion/PIM/PIMExternalService.h> // Options";break;default:l+='#include "../FremontJs/SocketService.h"\n#include "../PIMExternalService.h" // Options'}t=t.replace(/<<INCLUDES>>/g,l);let d="";switch(u){case"PIMLocalService":d+='#include "Pch/FusionPch.h"\n';break;case"PIMDrawingService":d+='#include "Pch/FusionDocPch.h"\n'}d+=d+="#include <Fusion/Server/Fusion/PIM/PIMLogMgr.h>\n#include <Server/Base/Status/Status.h>\n#include <Server/Base/Tests/TestMgr.h>",n=n.replace(/<<INCLUDES>>/g,d);let p="",h="",m="",y="",g="";return Object.keys(e.constants).forEach(t=>{let n="",r="",o="";const i=`\n      enum class ${t}\n      {\n          <<Enum>>\n      };\n    `,s=t.charAt(0).toLowerCase()+t.slice(1),a=`\n      static Ns::HString ${s}ToString(${t} ${s})\n      {\n          switch(${s})\n          {\n          <<Switches>>}\n          return "";\n      };\n    `,c=`\n      static ${t} stringTo${t}(const Ns::HString& ${s})\n      {\n          <<Switches>>\n          throw std::invalid_argument(${s}.c_str());\n      };\n    `;Object.keys(e.constants[t]).forEach(i=>{const a=e.constants[t][i];n+=i+", ",r+=` case ${t}::${i}:\n              return "${a}";\n          `,o+=` if(${s} == "${a}")\n              return ${t}::${i};\n          `}),n=n.slice(0,n.length-2),y+=i.replace(/<<Enum>>/,n),g+=a.replace(/<<Switches>>/,r),g+=c.replace(/<<Switches>>/,o)}),c=c.replace(/<<EnumBodies>>/g,y).replace(/<<SwitchBodies>>/,g),Object.keys(e.functions).forEach(t=>{const n=e.functions[t],r=n.arguments,a=r.map(e=>{const t=e.split(":"),n=t[0];return o[t[1]]+" "+n}).concat([!0===n.noPayload?"ServiceCallback callback":"ServiceCallbackJSON callback"]).join(", "),c=r.map(e=>{const t=e.split(":");return t[0]+": "+i[t[1]]}).join(", "),l=r.map(e=>e.split(":")[0]).join(", ");p+=`\n      void ${t}(${a});\n`,h+=`\nvoid ${u}::${t}(${a})\n{\n  auto command = "${u}:${t}";\n  Ns::JSONNode payload;\n  addContextToPayload(payload);\n`,r.forEach(e=>{const t=e.split(":"),n=t[1],r=t[0];h+=`\tpayload["args"]["${r}"] = `+s[n](r)}),h+=`\n  return ${!0===n.noPayload?"emitNoPayload":"emit"}(command, payload, callback);\n}`,m+=`\n  async ${t}(${c}):${!0===n.noPayload?"Promise<void>":"Promise<any>"} {\n    return this.${!0===n.noPayload?"emitNoPayload":"emit"}('${u}:${t}', {\n      'context': {\n        'clientId': this.clientId_,\n        'bearerToken': this.bearerToken_,\n        'expiryTimeEpochSec': this.expiryTimeEpochSec_,\n        'testing': this.testing_\n      },\n      'args': { ${l} }\n    });\n  }`}),t=t.replace(/<<HEADERS>>/,p),n=n.replace(/<<CODE>>/g,h),n=n.replace(/<<VERSION>>/g,"TODO"),a=a.replace(/<<CODE>>/g,m),a=a.replace(/<<VERSION>>/g,"TODO"),{className:u,header:t,code:n,tscode:a,utils:c}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderTemplate=`\n/* This file is automatically generated, do not edit it */\n/* This file is generated from the template located here : ${e} */\n/* Generation date : ${(new Date).toISOString()} */\n#pragma once\n\n<<INCLUDES>>\n\n#ifdef NA_FUSION_EXPORTS\n# ifdef __COMPILING_NA_<<CLASS>>_CPP__\n#  define NA_FUSION_API NS_EXPORT\n# else\n#  define NA_FUSION_API\n# endif\n#else\n# define NA_FUSION_API NS_IMPORT\n#endif\n\n#include <Server/Base/JSON/JSONNode.h>\n#include <future>\n\nnamespace FremontJS {\n  class <<CLASS>>\n  {\n    public:\n      typedef std::function<void(Ns::Status, const Ns::JSONNode&)> ServiceCallbackJSON;\n      typedef std::function<void(Ns::Status)> ServiceCallback;\n      <<CLASS>>();\n      void initialize(const std::shared_ptr<Na::FremontJs::SocketService> socket, const Na::PIM::Options& options, ServiceCallbackJSON callback);\n\n      void updateBearerToken(Ns::HString& bearerToken, unsigned int expireTime, bool sendResponse = false, Ns::HString id = 0);\n\n      void addContextToPayload(Ns::JSONNode& payload) const;\n      <<HEADERS>>\n    private:\n      static void logResponseError(const std::string& command, const Ns::JSONNode& payload, const Ns::JSONNode& response);\n      void emit(const Ns::HString& command, const Ns::JSONNode& payload, ServiceCallbackJSON callback);\n      void emitNoPayload(const std::string& command, const Ns::JSONNode& payload, ServiceCallback callback);\n      std::shared_ptr<Na::FremontJs::SocketService> socket_;\n      Ns::HString clientId_;\n      Ns::HString bearerToken_;\n      unsigned int expiryTime_ = 0;\n  };\n}\n#undef NA_FUSION_API\n\n`,t.CodeTemplate=`\n/* This file is automatically generated, do not edit it */\n/* This file is generated from the template located here : ${e} */\n/* Generation date : ${(new Date).toISOString()} */\n\n<<INCLUDES>>\n\n#define  __COMPILING_NA_<<CLASS>>_CPP__\n#include "<<CLASS>>.h"\n#undef __COMPILING_NA_<<CLASS>>_CPP__\n\nusing namespace FremontJS;\n\n<<CLASS>>::<<CLASS>>()\n{\n}\n\nvoid <<CLASS>>::initialize(const std::shared_ptr<Na::FremontJs::SocketService> socket, const Na::PIM::Options& options, ServiceCallbackJSON callback)\n{\n  this->socket_ = socket;\n  clientId_ = options.clientId;\n  bearerToken_ = options.bearerToken;\n  expiryTime_ = options.bearerTokenExpTime;\n  Ns::JSONNode initArgs;\n  initArgs["version"] = "<<VERSION>>"; // Need to add support for passing version\n  initArgs["serverUrl"] = options.serverUrl;\n  initArgs["commandServerUrl"] = options.commandServerUrl;\n  initArgs["migrationServerUrl"] = options.migrationServerUrl;\n  initArgs["fusionTeamUrl"] = options.fusionTeamUrl;\n  initArgs["clientId"] = options.clientId;\n  initArgs["bearerToken"] = options.bearerToken;\n  initArgs["expiryTimeEpochSec"] = (double) options.bearerTokenExpTime;\n  initArgs["spaceCollectionId"] = options.spaceCollectionId;\n  initArgs["pid"] = options.fremontPid;\n  initArgs["journaling"] = true;\n  initArgs["userFolder"] = options.userFolder;\n  auto copy = options.featureFlags.duplicate();\n  initArgs["featureFlags"] = copy;\n  initArgs["testing"] = Ns::Test::TestMgr::testing();\n  initArgs["applicationType"] = options.applicationType;\n  emit("<<CLASS>>:__initialize", initArgs, callback);\n}\n\nvoid <<CLASS>>::updateBearerToken(Ns::HString& bearerToken, unsigned int expireTime, bool sendResponse, Ns::HString id)\n{\n  bearerToken_ = bearerToken;\n  expiryTime_ = expireTime;\n  if(sendResponse) {\n    Ns::JSONNode payload;\n    if (!socket_)\n    {\n      Na::PIM::PIMLogMgr::get().severe("<<CLASS>>/updateBearerToken", "Socket connection in <<CLASS>> has not been established");\n      return;\n    }\n\n    payload["bearerToken"] = bearerToken;\n    payload["expiryTime"] = (double) expiryTime_;\n    socket_->emit(id, "<<CLASS>>:refreshBearerToken", payload, [](const std::string& message) {\n      Na::PIM::PIMLogMgr::get().debug("<<CLASS>>::emit", "Sent bearer token response");\n    });\n  }\n}\n\nvoid <<CLASS>>::addContextToPayload(Ns::JSONNode& payload) const {\n  payload["context"]["clientId"] = clientId_;\n  payload["context"]["bearerToken"] = bearerToken_;\n  payload["context"]["expiryTimeEpochSec"] = (double) expiryTime_;\n  payload["context"]["testing"] = Ns::Test::TestMgr::testing();\n}\n\nvoid <<CLASS>>::emitNoPayload(const std::string& command, const Ns::JSONNode& payload, ServiceCallback callback)\n{\n  emit(command, payload, [=](Ns::Status status, const Ns::JSONNode& /* ignored */) {\n    callback(status);\n  });\n}\n\nvoid <<CLASS>>::logResponseError(\n    const std::string& command,\n    const Ns::JSONNode& payload,\n    const Ns::JSONNode& response) {\n  Ns::HString clientId = payload["context"]["clientId"].stringify();\n  Ns::HString args = payload["args"].stringify(true);\n\n  Ns::HString message =\n    _DNGH("<<CLASS>>::emit() -> response error\\n- clientId: ") + clientId +\n    _DNGH("\\n- command: ") + command +\n    _DNGH("\\n- args: ") + args +\n    _DNGH("\\n- response: ") + response.stringify();\n\n  Na::PIM::PIMLogMgr::get().severe("<<CLASS>>/logResponseError", message);\n}\n\nvoid <<CLASS>>::emit(const std::string &command, const Ns::JSONNode &payload, ServiceCallbackJSON callback) {\n  std::string inMessage = payload.stringify();\n  if (!socket_)\n  {\n    Ns::HString errorMessage = "Socket connection in <<CLASS>> has not been established";\n    Na::PIM::PIMLogMgr::get().severe("<<CLASS>>/emit", errorMessage);\n    Ns::Status status;\n    status.addError(Ns::ToIString(errorMessage));\n    Ns::JSONNode payload;\n    callback(status, payload);\n    return;\n  }\n\n  socket_->emit(\n      command,\n      payload,\n      [command, callback, inMessage](const std::string &retMessage) mutable\n      {\n        Ns::IString error;\n        Ns::JSONNode parsedResponse = retMessage;\n\n        Ns::Status status;\n        if (parsedResponse["error"].get(error) && error != _DNGI(""))\n        {\n          status.addError(error);\n          const Ns::JSONNode payloadClone = inMessage;\n          <<CLASS>>::logResponseError(command, payloadClone, parsedResponse);\n        }\n\n        Ns::HString payloadStr = "{}";\n        if (parsedResponse["payload"].isValid())\n        {\n          parsedResponse["payload"].get(payloadStr);\n        }\n\n        Ns::JSONNode payload = std::string(payloadStr);\n        callback(status, payload);\n      });\n\n  Na::PIM::PIMLogMgr::get().debug("<<CLASS>>/emit", command + " message sent ...");\n}\n\n<<CODE>>\n`,t.TSCodeTemplate=`\n/* This file is automatically generated, do not edit it */\n/* This file is generated from the template located here : ${e} */\n/* Generation date : ${(new Date).toISOString()} */\n\n// @ts-ignore\nimport { ComponentMap } from '@adsk/pim-sdk';\n// @ts-ignore\nimport { Operation } from 'fast-json-patch';\ntype Options = {\n  bearerToken: string;\n  serverUrl: string;\n  pid: number;\n  fusionTeamUrl: string;\n  clientId: string;\n  spaceCollectionId: string;\n  expiryTimeEpochSec: number;\n  journaling?: boolean;\n  featureFlags?: { [name:string]: boolean };\n  testing?: boolean;\n  applicationType?: string;\n  userFolder: string;\n  clearUserCache?: boolean;\n};\n\nexport class <<CLASS>> {\n  private socket_?: any;\n  private clientId_?: string;\n  private bearerToken_?: string;\n  private expiryTimeEpochSec_?: number;\n  private testing_?: boolean;\n  async initialize(socket: any, options: Options): Promise<void> {\n    this.socket_ = socket;\n    this.bearerToken_ = options.bearerToken;\n    this.clientId_ = options.clientId;\n    this.expiryTimeEpochSec_ = options.expiryTimeEpochSec;\n    // TODO : Act as a RPC call ?\n    await this.emit('<<CLASS>>:__initialize', {\n      version: '<<VERSION>>',\n      serverUrl: options.serverUrl,\n      fusionTeamUrl: options.fusionTeamUrl,\n      clientId: this.clientId_,\n      pid: options.pid,\n      bearerToken: options.bearerToken,\n      expiryTimeEpochSec: options.expiryTimeEpochSec,\n      spaceCollectionId: options.spaceCollectionId,\n      journaling: options.journaling,\n      featureFlags: options.featureFlags,\n      testing: options.testing,\n      applicationType: options.applicationType,\n      userFolder: options.userFolder,\n      clearUserCache: options.clearUserCache\n    });\n  }\n\n  updateBearerToken(bearerToken: string): void {\n    this.bearerToken_ = bearerToken;\n  }\n\n  // @ts-ignore\n  private async emitNoPayload(command: string, payload: any): Promise<void> {\n    return this.emit(command, payload);\n  }\n\n  private async emit(command: string, payload: any): Promise<any> {\n    return new Promise((resolve, reject) =>\n      this.socket_.emit(command, payload, (error:string, response:string) => {\n        if (error) {\n          reject(error);\n        } else {\n          resolve(JSON.parse(response));\n        }\n      })\n    );\n  }\n<<CODE>>\n}`,t.PIMLocalUtilsTemplate=`\n/* This file is automatically generated, do not edit it */\n/* This file is generated from the template located here : ${e} */\n/* Generation date : ${(new Date).toISOString()} */\n#pragma once\n\n#include <Server/Base/Globals.h>\n#ifdef ERROR\n#define GLOBAL_ERROR ERROR\n#undef ERROR\n#endif\n\nnamespace Na { namespace PIM {\n    <<EnumBodies>>\n\n    class PIMLocalServiceUtils\n    {\n    public:<<SwitchBodies>>\n    };\n\n}}\n\n#ifdef GLOBAL_ERROR\n#define ERROR GLOBAL_ERROR\n#endif\n`}).call(this,"/")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SioAdaptor=class SioAdaptor{constructor(e){this.sioClient=e,this.closed=!1}emit(e,t,n){this.sioClient.emit(e,t,n)}on(e,t){this.sioClient.on(e,t)}use(e){this.sioClient.use(e)}onDisconnect(e){this.closed=!0,this.sioClient.on("disconnect",e)}disconnect(){this.closed=!0,this.sioClient.disconnect()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(245);class WsAdaptor{constructor(e){this.timeoutMillis=180,this.ws=e,this.handlerMap={},this.responseCallbacks={},this.middleware=[],this.setMessageListener(),this.closed=!1,this.ws.onerror=function(e){console.error("WebSocket error observed:",e)},this.timeoutMillis=1e3*function _getTimeoutInSeconds(){const e=process.env.PIM_FREMONTJS_WS_TIMEOUT;if(!e)return 180;const t=parseFloat(e);return isNaN(t)?180:t}(),this.maxRetries=WsAdaptor.MAX_RETRIES}setMaxRetries(e){this.maxRetries=e}use(e){this.middleware.push(e)}on(e,t){this.handlerMap[e]=t}emit(e,t,n){const o=r.v4();this.responseCallbacks[o]=n;const i=JSON.stringify({type:WsAdaptor.REQUEST_TYPE,requestId:o,action:e,payload:t});this.emitRetry(o,i,this.maxRetries-1,this.timeoutMillis)}onDisconnect(e){this.ws.onclose=(...t)=>{this.closed=!0,e(...t)}}disconnect(){this.closed=!0,this.ws.close()}shutdown(){this.ws.terminate()}emitRetry(e,t,n,r){this.ws.send(t),setTimeout(()=>{this.responseCallbacks[e]&&(console.log(`I have ${n} attempts remaining to get a response to ${e}`),0==n?this.responseCallbacks[e](WsAdaptor.ERROR_TIMEOUT,{}):this.emitRetry(e,t,--n,r*WsAdaptor.TIMEOUT_MULTIPLIER))},r)}setMessageListener(){this.ws.on("message",async e=>{await this.handleMessage(e)})}async handleMessage(e){let t;try{t=JSON.parse(e)}catch(t){return void console.log(`Failed parsing message ${e}. Will be unable to respond.`)}if(t.type===WsAdaptor.REQUEST_TYPE)await this.handleIncomingRequest(e,t);else{if(t.type!==WsAdaptor.RESPONSE_TYPE)return void console.log(`Malformed message ${e}. Will be unable to respond.`);await this.handleIncomingResponse(t)}}async handleIncomingRequest(e,t){if(await this.executeMiddleware(e),!t||!t.requestId)return void console.log(`Cannot access the request id for ${JSON.stringify(t)}. Will be unable to respond.`);const n=this.handlerMap[t.action];if(n)try{n(t.payload,(e,n)=>{const r=JSON.stringify({type:WsAdaptor.RESPONSE_TYPE,requestId:t.requestId,error:e,payload:n||"{}"});this.ws.send(r)})}catch(e){const n=JSON.stringify({type:WsAdaptor.RESPONSE_TYPE,requestId:t.requestId,error:JSON.stringify(e)});return console.log(`Unexpected error processing message ${JSON.stringify(t)}. Will send error response ${n}`),void this.ws.send(n)}else{console.info(`[WsAdaptor]: Handler ${t.action} not implemented`);const e=JSON.stringify({type:WsAdaptor.RESPONSE_TYPE,requestId:t.requestId,error:WsAdaptor.ERROR_NOT_IMPLEMENTED});this.ws.send(e)}}async executeMiddleware(e){await Promise.all(this.middleware.map(t=>{t(e,()=>{})}))}handleIncomingResponse(e){const t=e.requestId;if(!t)return void console.log("No requestId in the received response: "+JSON.stringify(e));const n=this.responseCallbacks[t];delete this.responseCallbacks[t],n?n(e.error,e.payload):console.log(`No callback exists for ${t}, but received this response: ${JSON.stringify(e)}`)}}t.WsAdaptor=WsAdaptor,WsAdaptor.REQUEST_TYPE="request",WsAdaptor.RESPONSE_TYPE="response",WsAdaptor.ERROR_NOT_IMPLEMENTED="That action has not been implemented",WsAdaptor.ERROR_TIMEOUT="Timed out while awaiting response",WsAdaptor.TIMEOUT_MULTIPLIER=1.25,WsAdaptor.MAX_RETRIES=10},function(e,t,n){"use strict";n.r(t),n.d(t,"Mutex",(function(){return o})),n.d(t,"Semaphore",(function(){return r})),n.d(t,"withTimeout",(function(){return withTimeout}));function __awaiter(e,t,n,r){return new(n||(n=Promise))((function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())}))}function __generator(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function verb(i){return function(a){return function step(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}Object.create;Object.create;var r=function(){function Semaphore(e){if(this._maxConcurrency=e,this._queue=[],e<=0)throw new Error("semaphore must be initialized to a positive value");this._value=e}return Semaphore.prototype.acquire=function(){var e=this,t=this.isLocked(),n=new Promise((function(t){return e._queue.push(t)}));return t||this._dispatch(),n},Semaphore.prototype.runExclusive=function(e){return __awaiter(this,void 0,void 0,(function(){var t,n,r;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.acquire()];case 1:t=o.sent(),n=t[0],r=t[1],o.label=2;case 2:return o.trys.push([2,,4,5]),[4,e(n)];case 3:return[2,o.sent()];case 4:return r(),[7];case 5:return[2]}}))}))},Semaphore.prototype.isLocked=function(){return this._value<=0},Semaphore.prototype.release=function(){if(this._maxConcurrency>1)throw new Error("this method is unavailabel on semaphores with concurrency > 1; use the scoped release returned by acquire instead");if(this._currentReleaser){var e=this._currentReleaser;this._currentReleaser=void 0,e()}},Semaphore.prototype._dispatch=function(){var e=this,t=this._queue.shift();if(t){var n=!1;this._currentReleaser=function(){n||(n=!0,e._value++,e._dispatch())},t([this._value--,this._currentReleaser])}},Semaphore}(),o=function(){function Mutex(){this._semaphore=new r(1)}return Mutex.prototype.acquire=function(){return __awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return[4,this._semaphore.acquire()];case 1:return e=t.sent(),[2,e[1]]}}))}))},Mutex.prototype.runExclusive=function(e){return this._semaphore.runExclusive((function(){return e()}))},Mutex.prototype.isLocked=function(){return this._semaphore.isLocked()},Mutex.prototype.release=function(){this._semaphore.release()},Mutex}();function withTimeout(e,t,n){var r=this;return void 0===n&&(n=new Error("timeout")),{acquire:function(){return new Promise((function(o,i){return __awaiter(r,void 0,void 0,(function(){var r,s;return __generator(this,(function(a){switch(a.label){case 0:return r=!1,setTimeout((function(){r=!0,i(n)}),t),[4,e.acquire()];case 1:return s=a.sent(),r?(Array.isArray(s)?s[1]:s)():o(s),[2]}}))}))}))},runExclusive:function(e){return __awaiter(this,void 0,void 0,(function(){var t,n;return __generator(this,(function(r){switch(r.label){case 0:t=function(){},r.label=1;case 1:return r.trys.push([1,,7,8]),[4,this.acquire()];case 2:return n=r.sent(),Array.isArray(n)?(t=n[1],[4,e(n[0])]):[3,4];case 3:return[2,r.sent()];case 4:return t=n,[4,e()];case 5:return[2,r.sent()];case 6:return[3,8];case 7:return t(),[7];case 8:return[2]}}))}))},release:function(){e.release()},isLocked:function(){return e.isLocked()}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"nanoid",(function(){return nanoid})),n.d(t,"customAlphabet",(function(){return customAlphabet})),n.d(t,"customRandom",(function(){return customRandom})),n.d(t,"urlAlphabet",(function(){return i})),n.d(t,"random",(function(){return random}));var r=n(16),o=n.n(r);let i="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW";let s,a,random=e=>{!s||s.length<e?(s=Buffer.allocUnsafe(32*e),o.a.randomFillSync(s),a=0):a+e>s.length&&(o.a.randomFillSync(s),a=0);let t=s.subarray(a,a+e);return a+=e,t},customRandom=(e,t,n)=>{let r=(2<<31-Math.clz32(e.length-1|1))-1,o=Math.ceil(1.6*r*t/e.length);return()=>{let i="";for(;;){let s=n(o),a=o;for(;a--;)if(i+=e[s[a]&r]||"",i.length===t)return i}}},customAlphabet=(e,t)=>customRandom(e,t,random),nanoid=(e=21)=>{let t=random(e),n="";for(;e--;)n+=i[63&t[e]];return n}}]);
//# sourceMappingURL=lib.fremont.prod.nodejs.js.map